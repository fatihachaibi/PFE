(window.discover_bundle_jsonpfunction=window.discover_bundle_jsonpfunction||[]).push([[11],{104:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var i=s(3);const r=({initialPageSize:e,totalItems:t})=>{const[s,r]=Object(i.useState)(e),[n,o]=Object(i.useState)(0),a=Object(i.useMemo)((()=>{const e=Math.ceil(t/s);return{totalPages:e,startIndex:s*n,hasNextPage:n+1<e}}),[n,s,t]),c=Object(i.useCallback)((e=>o(e)),[]),u=Object(i.useCallback)((e=>r(e)),[]);return Object(i.useEffect)((()=>{a.totalPages<n+1&&c(0)}),[n,a.totalPages,c]),Object(i.useMemo)((()=>({...a,curPageIndex:n,pageSize:s,changePageIndex:c,changePageSize:u})),[c,u,n,a,s])}},263:function(e,t,s){switch(window.__kbnThemeTag__){case"v8dark":return s(264);case"v8light":return s(266)}},264:function(e,t,s){var i=s(64),r=s(265);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);i(r,{insert:"head",singleton:!1}),e.exports=r.locals||{}},265:function(e,t,s){(t=s(65)(!1)).push([e.i,".euiDataGrid__restrictBody .embPanel .embPanel__content{z-index:unset !important}\n",""]),e.exports=t},266:function(e,t,s){var i=s(64),r=s(267);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);i(r,{insert:"head",singleton:!1}),e.exports=r.locals||{}},267:function(e,t,s){(t=s(65)(!1)).push([e.i,".euiDataGrid__restrictBody .embPanel .embPanel__content{z-index:unset !important}\n",""]),e.exports=t},287:function(e,t,s){"use strict";s.r(t),s.d(t,"SavedSearchEmbeddable",(function(){return saved_search_embeddable_SavedSearchEmbeddable}));var i=s(1),r=s.n(i),n=s(21),o=s(42),a=s(3),c=s.n(a),u=s(44),l=s.n(u),d=s(0),h=s(9),p=s(38),v=s(8),b=s(63),g=s(15),m=s(20),f=s(11),S=s(66),j=s.n(S),x=s(14),O=s(124),P=s(5);const C=({totalHitCount:e})=>Object(P.jsx)(x.EuiText,{grow:!1,size:"s",style:{paddingRight:2}},Object(P.jsx)(p.FormattedMessage,{id:"discover.docTable.totalDocuments",defaultMessage:"{totalDocuments} documents",values:{totalDocuments:Object(P.jsx)("strong",null,e)}}));s(263);const T=Object(a.memo)(O.a);function E(e){const[t,s]=Object(a.useState)(void 0);return Object(P.jsx)(x.EuiFlexGroup,{style:{width:"100%"},direction:"column",gutterSize:"xs",responsive:!1,"data-test-subj":"embeddedSavedSearchDocTable"},0!==e.totalHitCount&&Object(P.jsx)(x.EuiFlexItem,{grow:!1,style:{alignSelf:"flex-end"}},Object(P.jsx)(C,{totalHitCount:e.totalHitCount})),Object(P.jsx)(x.EuiFlexItem,{style:{minHeight:0}},Object(P.jsx)(T,j()({},e,{setExpandedDoc:s,expandedDoc:t}))))}s(113);var y=s(7),I=s(104);const w={marginLeft:"auto",marginRight:s(43).euiLightVars.euiSizeL},F=({pageSize:e,pageCount:t,activePage:s,onPageSizeChange:i,onPageClick:r})=>{const[n,o]=Object(a.useState)(!1),c=d.i18n.translate("discover.docTable.rows",{defaultMessage:"rows"}),u=()=>o(!1),l=[25,50,100].map((t=>{return Object(P.jsx)(x.EuiContextMenuItem,{key:`${t} rows`,icon:(s=t,s===e?"check":"empty"),onClick:()=>{u(),i(t)}},t," ",c);var s}));return Object(P.jsx)(x.EuiFlexGroup,{alignItems:"center",gutterSize:"xs",responsive:!1},Object(P.jsx)(x.EuiFlexItem,{grow:!1},Object(P.jsx)(x.EuiPopover,{button:Object(P.jsx)(x.EuiButtonEmpty,{size:"xs",color:"text",iconType:"arrowDown",iconSide:"right",onClick:()=>o((e=>!e))},Object(P.jsx)(p.FormattedMessage,{id:"discover.docTable.rowsPerPage",defaultMessage:"Rows per page: {pageSize}",values:{pageSize:e}})),isOpen:n,closePopover:u,panelPaddingSize:"none"},Object(P.jsx)(x.EuiContextMenuPanel,{items:l}))),Object(P.jsx)(x.EuiFlexItem,{grow:!1,style:w},Object(P.jsx)(x.EuiPagination,{"aria-label":d.i18n.translate("discover.docTable.documentsNavigation",{defaultMessage:"Documents navigation"}),pageCount:t,activePage:s,onPageClick:r,compressed:!0})))};var _=s(125),R=s(19);const M=Object(a.memo)(_.a),A=e=>{const t=Object(R.a)(),s=Object(a.useRef)(null),{curPageIndex:i,pageSize:r,totalPages:n,startIndex:o,hasNextPage:c,changePageIndex:u,changePageSize:l}=Object(I.a)({initialPageSize:50,totalItems:e.rows.length}),d=0!==n,h=Object(a.useCallback)((()=>{s.current&&s.current.scrollTo(0,0)}),[]),v=Object(a.useMemo)((()=>e.rows.slice(o,r+o)),[r,o,e.rows]),b=Object(a.useCallback)((e=>{h(),u(e)}),[u,h]),g=Object(a.useCallback)((e=>{h(),l(e)}),[l,h]),m=Object(a.useMemo)((()=>!c&&e.rows.length<e.totalHitCount),[c,e.rows.length,e.totalHitCount]),f=Object(a.useMemo)((()=>t.uiSettings.get(y.SAMPLE_SIZE_SETTING,500)),[t]),S=Object(a.useCallback)((e=>Object(P.jsx)("div",{className:"kbnDocTable__container"},Object(P.jsx)("table",{className:"kbnDocTable table","data-test-subj":"docTable"},Object(P.jsx)("thead",null,e.renderHeader()),Object(P.jsx)("tbody",null,e.renderRows(v))))),[v]);return Object(P.jsx)(x.EuiFlexGroup,{style:{width:"100%"},direction:"column",gutterSize:"xs",responsive:!1},Object(P.jsx)(x.EuiFlexItem,{grow:!1},Object(P.jsx)(x.EuiFlexGroup,{justifyContent:"flexEnd",alignItems:"center",gutterSize:"xs",responsive:!1,wrap:!0},m&&Object(P.jsx)(x.EuiFlexItem,{grow:!1},Object(P.jsx)(x.EuiText,{grow:!1,size:"s",color:"subdued"},Object(P.jsx)(p.FormattedMessage,{id:"discover.docTable.limitedSearchResultLabel",defaultMessage:"Limited to {resultCount} results. Refine your search.",values:{resultCount:f}}))),0!==e.totalHitCount&&Object(P.jsx)(x.EuiFlexItem,{grow:!1,"data-test-subj":"toolBarTotalDocsText"},Object(P.jsx)(C,{totalHitCount:e.totalHitCount})))),Object(P.jsx)(x.EuiFlexItem,{style:{minHeight:0}},Object(P.jsx)(M,j()({ref:s},e,{render:S}))),d&&Object(P.jsx)(x.EuiFlexItem,{grow:!1},Object(P.jsx)(F,{pageSize:r,pageCount:n,activePage:i,onPageClick:b,onPageSizeChange:g})))};function D(e){return Object(P.jsx)(p.I18nProvider,null,Object(P.jsx)(A,{columns:e.columns,rows:e.rows,totalHitCount:e.totalHitCount,indexPattern:e.indexPattern,onSort:e.onSort,onAddColumn:e.onAddColumn,onMoveColumn:e.onMoveColumn,onRemoveColumn:e.onRemoveColumn,sort:e.sort,onFilter:e.onFilter,useNewFieldsApi:e.useNewFieldsApi,searchDescription:e.searchDescription,sharedItemTitle:e.sharedItemTitle,isLoading:e.isLoading,dataTestSubj:"embeddedSavedSearchDocTable"}))}const L=c.a.memo(D),H=c.a.memo(E);function z({searchProps:e,useLegacyTable:t}){return t?Object(P.jsx)(L,e):Object(P.jsx)(H,j()({},e,{className:"dscDiscoverGrid"}))}var N=s(131),q=s(79),G=s(72),k=s(88),U=s(142);class saved_search_embeddable_SavedSearchEmbeddable extends v.Embeddable{constructor({savedSearch:e,editUrl:t,editPath:s,indexPatterns:i,editable:o,filterManager:a,services:c},u,l,h){super(u,{defaultTitle:e.title,editUrl:t,editPath:s,editApp:"discover",indexPatterns:i,editable:o},h),r()(this,"savedSearch",void 0),r()(this,"inspectorAdapters",void 0),r()(this,"panelTitle",""),r()(this,"filtersSearchSource",void 0),r()(this,"subscription",void 0),r()(this,"type",f.a),r()(this,"filterManager",void 0),r()(this,"abortController",void 0),r()(this,"services",void 0),r()(this,"prevTimeRange",void 0),r()(this,"prevFilters",void 0),r()(this,"prevQuery",void 0),r()(this,"prevSearchSessionId",void 0),r()(this,"searchProps",void 0),r()(this,"node",void 0),r()(this,"fetch",(async()=>{const e=this.input.searchSessionId,t=!this.services.uiSettings.get(y.SEARCH_FIELDS_FROM_SOURCE,!1);if(!this.searchProps)return;const{searchSource:s}=this.savedSearch;this.abortController&&this.abortController.abort(),this.abortController=new AbortController,((e,t,s,i,r)=>{const{sampleSize:n,defaultSort:o}=r;if(e.setField("size",n),e.setField("sort",Object(G.c)(s,t,o)),i){e.removeField("fieldsFromSource");const t={field:"*",include_unmapped:"true"};e.setField("fields",[t])}else e.removeField("fields")})(s,this.searchProps.indexPattern,this.searchProps.sort,t,{sampleSize:this.services.uiSettings.get(y.SAMPLE_SIZE_SETTING),defaultSort:this.services.uiSettings.get(y.SORT_DEFAULT_ORDER_SETTING)}),this.inspectorAdapters.requests.reset(),this.searchProps.isLoading=!0,this.updateOutput({loading:!0,error:void 0});const i=this.input.executionContext,r={type:this.type,name:"discover",id:this.savedSearch.id,description:this.output.title||this.output.defaultTitle||"",url:this.output.editUrl},o=i?{...i,child:r}:r;try{const{rawResponse:t}=await Object(n.lastValueFrom)(s.fetch$({abortSignal:this.abortController.signal,sessionId:e,inspector:{adapter:this.inspectorAdapters.requests,title:d.i18n.translate("discover.embeddable.inspectorRequestDataTitle",{defaultMessage:"Data"}),description:d.i18n.translate("discover.embeddable.inspectorRequestDescription",{defaultMessage:"This request queries Elasticsearch to fetch the data for the search."})},executionContext:o}));this.updateOutput({loading:!1,error:void 0}),this.searchProps.rows=t.hits.hits,this.searchProps.totalHitCount=t.hits.total,this.searchProps.isLoading=!1}catch(e){this.destroyed||(this.updateOutput({loading:!1,error:e}),this.searchProps.isLoading=!1)}})),this.executeTriggerActions=l,this.services=c,this.filterManager=a,this.savedSearch=e,this.inspectorAdapters={requests:new b.RequestAdapter},this.initializeSearchEmbeddableProps(),this.subscription=this.getUpdated$().subscribe((()=>{this.panelTitle=this.output.title||"",this.searchProps&&this.pushContainerStateParamsToProps(this.searchProps)}))}getDefaultSort(e){const t=this.services.uiSettings.get(y.SORT_DEFAULT_ORDER_SETTING,"desc"),s=this.services.uiSettings.get(y.DOC_HIDE_TIME_COLUMN_SETTING,!1);return Object(G.a)(e,t,s)}initializeSearchEmbeddableProps(){const{searchSource:e}=this.savedSearch,t=e.getField("index");if(!t)return;this.savedSearch.sort&&this.savedSearch.sort.length||(this.savedSearch.sort=this.getDefaultSort(t));const s={columns:this.savedSearch.columns,indexPattern:t,isLoading:!1,sort:this.getDefaultSort(t),rows:[],searchDescription:this.savedSearch.description,description:this.savedSearch.description,inspectorAdapters:this.inspectorAdapters,searchTitle:this.savedSearch.title,services:this.services,onAddColumn:e=>{if(!s.columns)return;const t=N.a(s.columns,e,!0);this.updateInput({columns:t})},onRemoveColumn:e=>{if(!s.columns)return;const t=N.d(s.columns,e,!0);this.updateInput({columns:t})},onMoveColumn:(e,t)=>{if(!s.columns)return;const i=N.c(s.columns,e,t);this.updateInput({columns:i})},onSetColumns:e=>{this.updateInput({columns:e})},onSort:e=>{const t=[];e.forEach((e=>{t.push(e)})),this.updateInput({sort:t})},sampleSize:500,onFilter:async(e,s,i)=>{let r=Object(g.generateFilters)(this.filterManager,e,s,i,t.id);r=r.map((e=>({...e,$state:{store:g.FilterStateStore.APP_STATE}}))),await this.executeTriggerActions(g.APPLY_FILTER_TRIGGER,{embeddable:this,filters:r})},useNewFieldsApi:!this.services.uiSettings.get(y.SEARCH_FIELDS_FROM_SOURCE,!1),showTimeCol:!this.services.uiSettings.get(y.DOC_HIDE_TIME_COLUMN_SETTING,!1),ariaLabelledBy:"documentsAriaLabel",rowHeightState:this.input.rowHeight||this.savedSearch.rowHeight,onUpdateRowHeight:e=>{this.updateInput({rowHeight:e})}},i=e.create();i.setField("filter",(()=>{if(this.searchProps&&this.input.timeRange)return this.services.timefilter.createFilter(t,this.input.timeRange)})),this.filtersSearchSource=e.create(),this.filtersSearchSource.setParent(i),e.setParent(this.filtersSearchSource),this.pushContainerStateParamsToProps(s),s.isLoading=!0,this.savedSearch.grid&&(s.settings=this.savedSearch.grid)}async pushContainerStateParamsToProps(e,{forceFetch:t=!1}={forceFetch:!1}){var s;const i=!(Object(o.onlyDisabledFiltersChanged)(this.input.filters,this.prevFilters)&&Object(h.isEqual)(this.prevQuery,this.input.query)&&Object(h.isEqual)(this.prevTimeRange,this.input.timeRange)&&Object(h.isEqual)(e.sort,this.input.sort||this.savedSearch.sort)&&this.prevSearchSessionId===this.input.searchSessionId);e.columns=Object(q.a)({columns:this.input.columns||this.savedSearch.columns},this.services.core.uiSettings).columns;const r=this.savedSearch.sort&&this.savedSearch.sort.length?this.savedSearch.sort:this.getDefaultSort(null===(s=this.searchProps)||void 0===s?void 0:s.indexPattern);var n,a;e.sort=this.input.sort||r,e.sharedItemTitle=this.panelTitle,e.rowHeightState=this.input.rowHeight||this.savedSearch.rowHeight,t||i?(this.filtersSearchSource.setField("filter",this.input.filters),this.filtersSearchSource.setField("query",this.input.query),null!==(n=this.input.query)&&void 0!==n&&n.query||null!==(a=this.input.filters)&&void 0!==a&&a.length?this.filtersSearchSource.setField("highlightAll",!0):this.filtersSearchSource.removeField("highlightAll"),this.prevFilters=this.input.filters,this.prevQuery=this.input.query,this.prevTimeRange=this.input.timeRange,this.prevSearchSessionId=this.input.searchSessionId,this.searchProps=e,await this.fetch()):this.searchProps&&this.node&&(this.searchProps=e),this.node&&this.renderReactComponent(this.node,this.searchProps)}async render(e){if(!this.searchProps)throw new Error("Search props not defined");this.node&&l.a.unmountComponentAtNode(this.node),this.node=e}renderReactComponent(e,t){if(!this.searchProps)return;if(!0===this.services.uiSettings.get(y.SHOW_FIELD_STATISTICS)&&this.savedSearch.viewMode===k.b.AGGREGATED_LEVEL&&t.services&&t.indexPattern&&Array.isArray(t.columns))return void l.a.render(Object(P.jsx)(p.I18nProvider,null,Object(P.jsx)(m.KibanaThemeProvider,{theme$:t.services.core.theme.theme$},Object(P.jsx)(m.KibanaContextProvider,{services:t.services},Object(P.jsx)(U.a,{indexPattern:t.indexPattern,columns:t.columns,savedSearch:this.savedSearch,filters:this.input.filters,query:this.input.query,onAddFilter:t.onFilter,searchSessionId:this.input.searchSessionId})))),e);const s=this.services.uiSettings.get(y.DOC_TABLE_LEGACY),i={savedSearch:this.savedSearch,searchProps:t,useLegacyTable:s};t.services&&l.a.render(Object(P.jsx)(p.I18nProvider,null,Object(P.jsx)(m.KibanaThemeProvider,{theme$:t.services.core.theme.theme$},Object(P.jsx)(m.KibanaContextProvider,{services:t.services},Object(P.jsx)(z,i)))),e)}reload(){this.searchProps&&this.pushContainerStateParamsToProps(this.searchProps,{forceFetch:!0})}getSavedSearch(){return this.savedSearch}getInspectorAdapters(){return this.inspectorAdapters}getDescription(){return this.savedSearch.description}destroy(){var e;super.destroy(),this.searchProps&&delete this.searchProps,null===(e=this.subscription)||void 0===e||e.unsubscribe(),this.abortController&&this.abortController.abort()}}},64:function(e,t,s){"use strict";var i,r=function(){var e={};return function(t){if(void 0===e[t]){var s=document.querySelector(t);if(window.HTMLIFrameElement&&s instanceof window.HTMLIFrameElement)try{s=s.contentDocument.head}catch(e){s=null}e[t]=s}return e[t]}}(),n=[];function o(e){for(var t=-1,s=0;s<n.length;s++)if(n[s].identifier===e){t=s;break}return t}function a(e,t){for(var s={},i=[],r=0;r<e.length;r++){var a=e[r],c=t.base?a[0]+t.base:a[0],u=s[c]||0,l="".concat(c," ").concat(u);s[c]=u+1;var d=o(l),h={css:a[1],media:a[2],sourceMap:a[3]};-1!==d?(n[d].references++,n[d].updater(h)):n.push({identifier:l,updater:b(h,t),references:1}),i.push(l)}return i}function c(e){var t=document.createElement("style"),i=e.attributes||{};if(void 0===i.nonce){var n=s.nc;n&&(i.nonce=n)}if(Object.keys(i).forEach((function(e){t.setAttribute(e,i[e])})),"function"==typeof e.insert)e.insert(t);else{var o=r(e.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}return t}var u,l=(u=[],function(e,t){return u[e]=t,u.filter(Boolean).join("\n")});function d(e,t,s,i){var r=s?"":i.media?"@media ".concat(i.media," {").concat(i.css,"}"):i.css;if(e.styleSheet)e.styleSheet.cssText=l(t,r);else{var n=document.createTextNode(r),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(n,o[t]):e.appendChild(n)}}function h(e,t,s){var i=s.css,r=s.media,n=s.sourceMap;if(r?e.setAttribute("media",r):e.removeAttribute("media"),n&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(n))))," */")),e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}var p=null,v=0;function b(e,t){var s,i,r;if(t.singleton){var n=v++;s=p||(p=c(t)),i=d.bind(null,s,n,!1),r=d.bind(null,s,n,!0)}else s=c(t),i=h.bind(null,s,t),r=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(s)};return i(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;i(e=t)}else r()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===i&&(i=Boolean(window&&document&&document.all&&!window.atob)),i));var s=a(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var i=0;i<s.length;i++){var r=o(s[i]);n[r].references--}for(var c=a(e,t),u=0;u<s.length;u++){var l=o(s[u]);0===n[l].references&&(n[l].updater(),n.splice(l,1))}s=c}}}},65:function(e,t,s){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var s=function(e,t){var s,i,r,n=e[1]||"",o=e[3];if(!o)return n;if(t&&"function"==typeof btoa){var a=(s=o,i=btoa(unescape(encodeURIComponent(JSON.stringify(s)))),r="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(i),"/*# ".concat(r," */")),c=o.sources.map((function(e){return"/*# sourceURL=".concat(o.sourceRoot||"").concat(e," */")}));return[n].concat(c).concat([a]).join("\n")}return[n].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(s,"}"):s})).join("")},t.i=function(e,s,i){"string"==typeof e&&(e=[[null,e,""]]);var r={};if(i)for(var n=0;n<this.length;n++){var o=this[n][0];null!=o&&(r[o]=!0)}for(var a=0;a<e.length;a++){var c=[].concat(e[a]);i&&r[c[0]]||(s&&(c[2]?c[2]="".concat(s," and ").concat(c[2]):c[2]=s),t.push(c))}},t}},66:function(e,t,s){e.exports=s(25)(3)},71:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var i=s(15);function r(e,t,s,r,n,o){const a=null!=o?o:"html";return r&&n?r.getFormatterForField(n).convert(e,a,{hit:t,field:n}):s.getDefaultInstance(i.KBN_FIELD_TYPES.STRING).convert(e,a,{hit:t,field:n})}},77:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var i=s(40);const r=(e,t,s)=>{const r={},n=e=>t.fields.getByName(e);return e.forEach((e=>{var t;const s=n(e),o=s&&Object(i.getFieldSubtypeMulti)(s.spec);s&&null!=o&&null!==(t=o.multi)&&void 0!==t&&t.parent&&(r[s.name]=o.multi.parent)})),e.filter((t=>{const o=n(t),a=o&&Object(i.getFieldSubtypeMulti)(o.spec);if(null==a||!a.multi)return!0;const c=r[t];return s||c&&!e.includes(c)}))}}}]);