(window.controls_bundle_jsonpfunction=window.controls_bundle_jsonpfunction||[]).push([[5],{36:function(e,t,i){"use strict";var n,a=function(){var e={};return function(t){if(void 0===e[t]){var i=document.querySelector(t);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(e){i=null}e[t]=i}return e[t]}}(),r=[];function o(e){for(var t=-1,i=0;i<r.length;i++)if(r[i].identifier===e){t=i;break}return t}function s(e,t){for(var i={},n=[],a=0;a<e.length;a++){var s=e[a],d=t.base?s[0]+t.base:s[0],l=i[d]||0,c="".concat(d," ").concat(l);i[d]=l+1;var u=o(c),h={css:s[1],media:s[2],sourceMap:s[3]};-1!==u?(r[u].references++,r[u].updater(h)):r.push({identifier:c,updater:m(h,t),references:1}),n.push(c)}return n}function d(e){var t=document.createElement("style"),n=e.attributes||{};if(void 0===n.nonce){var r=i.nc;r&&(n.nonce=r)}if(Object.keys(n).forEach((function(e){t.setAttribute(e,n[e])})),"function"==typeof e.insert)e.insert(t);else{var o=a(e.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}return t}var l,c=(l=[],function(e,t){return l[e]=t,l.filter(Boolean).join("\n")});function u(e,t,i,n){var a=i?"":n.media?"@media ".concat(n.media," {").concat(n.css,"}"):n.css;if(e.styleSheet)e.styleSheet.cssText=c(t,a);else{var r=document.createTextNode(a),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(r,o[t]):e.appendChild(r)}}function h(e,t,i){var n=i.css,a=i.media,r=i.sourceMap;if(a?e.setAttribute("media",a):e.removeAttribute("media"),r&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}var p=null,g=0;function m(e,t){var i,n,a;if(t.singleton){var r=g++;i=p||(p=d(t)),n=u.bind(null,i,r,!1),a=u.bind(null,i,r,!0)}else i=d(t),n=h.bind(null,i,t),a=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(i)};return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else a()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===n&&(n=Boolean(window&&document&&document.all&&!window.atob)),n));var i=s(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var n=0;n<i.length;n++){var a=o(i[n]);r[a].references--}for(var d=s(e,t),l=0;l<i.length;l++){var c=o(i[l]);0===r[c].references&&(r[c].updater(),r.splice(c,1))}i=d}}}},37:function(e,t,i){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var i=function(e,t){var i,n,a,r=e[1]||"",o=e[3];if(!o)return r;if(t&&"function"==typeof btoa){var s=(i=o,n=btoa(unescape(encodeURIComponent(JSON.stringify(i)))),a="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(n),"/*# ".concat(a," */")),d=o.sources.map((function(e){return"/*# sourceURL=".concat(o.sourceRoot||"").concat(e," */")}));return[r].concat(d).concat([s]).join("\n")}return[r].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(i,"}"):i})).join("")},t.i=function(e,i,n){"string"==typeof e&&(e=[[null,e,""]]);var a={};if(n)for(var r=0;r<this.length;r++){var o=this[r][0];null!=o&&(a[o]=!0)}for(var s=0;s<e.length;s++){var d=[].concat(e[s]);n&&a[d[0]]||(i&&(d[2]?d[2]="".concat(i," and ").concat(d[2]):d[2]=i),t.push(d))}},t}},41:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i(11);const a=(e,t)=>{const[i,a]=Object(n.useState)(t);return Object(n.useEffect)((()=>{const t=e.subscribe((e=>a(e)));return()=>t.unsubscribe()}),[e]),i}},59:function(e,t,i){switch(window.__kbnThemeTag__){case"v8dark":return i(60);case"v8light":return i(62)}},60:function(e,t,i){var n=i(36),a=i(61);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);n(a,{insert:"head",singleton:!1}),e.exports=a.locals||{}},61:function(e,t,i){(t=i(37)(!1)).push([e.i,".rangeSlider__popoverOverride{height:100%;max-width:100%;width:100%}@media only screen and (min-width: 768px) and (max-width: 991px){.rangeSlider__panelOverride{min-width:480px}}@media only screen and (min-width: 992px) and (max-width: 1199px){.rangeSlider__panelOverride{min-width:480px}}@media only screen and (min-width: 1200px){.rangeSlider__panelOverride{min-width:480px}}.rangeSlider__anchorOverride>div{height:100%}.rangeSliderAnchor__button{display:flex;align-items:center;width:100%;height:100%;justify-content:space-between;background-color:#16171c;border-radius:0 5px 5px 0}.rangeSliderAnchor__button .euiToolTipAnchor{width:100%}.rangeSliderAnchor__button .rangeSliderAnchor__delimiter{background-color:unset;padding:12px 0}.rangeSliderAnchor__button .rangeSliderAnchor__fieldNumber{font-weight:700;box-shadow:none;text-align:center;background-color:unset}.rangeSliderAnchor__button .rangeSliderAnchor__fieldNumber::placeholder{font-weight:400;color:#535966;text-decoration:none}.rangeSliderAnchor__button .rangeSliderAnchor__fieldNumber--invalid{text-decoration:line-through;font-weight:400;color:#535966}.rangeSliderAnchor__button .rangeSliderAnchor__spinner{padding-right:8px}\n",""]),e.exports=t},62:function(e,t,i){var n=i(36),a=i(63);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);n(a,{insert:"head",singleton:!1}),e.exports=a.locals||{}},63:function(e,t,i){(t=i(37)(!1)).push([e.i,".rangeSlider__popoverOverride{height:100%;max-width:100%;width:100%}@media only screen and (min-width: 768px) and (max-width: 991px){.rangeSlider__panelOverride{min-width:480px}}@media only screen and (min-width: 992px) and (max-width: 1199px){.rangeSlider__panelOverride{min-width:480px}}@media only screen and (min-width: 1200px){.rangeSlider__panelOverride{min-width:480px}}.rangeSlider__anchorOverride>div{height:100%}.rangeSliderAnchor__button{display:flex;align-items:center;width:100%;height:100%;justify-content:space-between;background-color:#fbfcfd;border-radius:0 5px 5px 0}.rangeSliderAnchor__button .euiToolTipAnchor{width:100%}.rangeSliderAnchor__button .rangeSliderAnchor__delimiter{background-color:unset;padding:12px 0}.rangeSliderAnchor__button .rangeSliderAnchor__fieldNumber{font-weight:700;box-shadow:none;text-align:center;background-color:unset}.rangeSliderAnchor__button .rangeSliderAnchor__fieldNumber::placeholder{font-weight:400;color:#98A2B3;text-decoration:none}.rangeSliderAnchor__button .rangeSliderAnchor__fieldNumber--invalid{text-decoration:line-through;font-weight:400;color:#98A2B3}.rangeSliderAnchor__button .rangeSliderAnchor__spinner{padding-right:8px}\n",""]),e.exports=t},87:function(e,t,i){"use strict";i.r(t),i.d(t,"RangeSliderEmbeddable",(function(){return range_slider_embeddable_RangeSliderEmbeddable}));var n=i(1),a=i.n(n),r=i(16),o=i(39),s=i(11),d=i(29),l=i.n(d),c=i(4),u=i.n(c),h=i(8),p=i(31),g=i(2),m=i(27),b=i(28),f=i(20),v=i(41),S=i(12),_=i(17),x=i(7);const w="rangeSliderAnchor__fieldNumber--invalid",j=({id:e,isInvalid:t,isLoading:i,min:n,max:a,title:r,value:o,onChange:d,fieldFormatter:l})=>{const[c,u]=Object(s.useState)(!1),[h,p]=Object(s.useState)(-1/0),[g,m]=Object(s.useState)(1/0),b=Object(s.useRef)(null);let f="",v="";const j=""!==n&&""!==a;j?t&&(v=_.a.popover.getNoDataHelpText()):v=_.a.popover.getNoAvailableDataHelpText();const O=""!==o[0],y=""!==o[1],F=parseFloat(o[0]),N=parseFloat(o[1]),A=parseFloat(n),E=parseFloat(a),C=j?Math.floor(A):A,V=j?Math.ceil(E):E;F>N&&(f=_.a.errors.getUpperLessThanLowerErrorMessage());const I=[O?String(F):j?String(C):"",y?String(N):j?String(V):""],R=[],T=[];j&&c&&(R.push({value:h,label:l(String(h))}),R.push({value:g,label:l(String(g))}),T.push({min:C,max:V,color:"success"}));const M=Object(x.jsx)("button",{onClick:()=>{c||(p(Math.min(C,isNaN(F)?1/0:F,isNaN(N)?1/0:N)),m(Math.max(V,isNaN(F)?-1/0:F,isNaN(N)?-1/0:N))),u((e=>!e))},className:"rangeSliderAnchor__button","data-test-subj":`range-slider-control-${e}`},Object(x.jsx)(S.EuiFlexGroup,{gutterSize:"none",responsive:!1},Object(x.jsx)(S.EuiFlexItem,null,Object(x.jsx)(S.EuiFieldNumber,{controlOnly:!0,fullWidth:!0,className:`rangeSliderAnchor__fieldNumber ${O&&t?w:""}`,value:O?F:"",onChange:e=>{d([e.target.value,isNaN(N)?"":String(N)])},disabled:i,placeholder:`${j?C:""}`,isInvalid:t,"data-test-subj":"rangeSlider__lowerBoundFieldNumber"})),Object(x.jsx)(S.EuiFlexItem,{grow:!1},Object(x.jsx)(S.EuiText,{className:"rangeSliderAnchor__delimiter",size:"s",color:"subdued"},"â†’")),Object(x.jsx)(S.EuiFlexItem,null,Object(x.jsx)(S.EuiFieldNumber,{controlOnly:!0,fullWidth:!0,className:`rangeSliderAnchor__fieldNumber ${y&&t?w:""}`,value:y?N:"",onChange:e=>{d([isNaN(F)?"":String(F),e.target.value])},disabled:i,placeholder:`${j?V:""}`,isInvalid:t,"data-test-subj":"rangeSlider__upperBoundFieldNumber"})),i?Object(x.jsx)(S.EuiFlexItem,{grow:!1,className:"rangeSliderAnchor__spinner","data-test-subj":"range-slider-loading-spinner"},Object(x.jsx)(S.EuiLoadingSpinner,null)):void 0));return Object(x.jsx)(S.EuiInputPopover,{input:M,isOpen:c,display:"block",panelPaddingSize:"s",className:"rangeSlider__popoverOverride",anchorClassName:"rangeSlider__anchorOverride",panelClassName:"rangeSlider__panelOverride",closePopover:()=>u(!1),anchorPosition:"downCenter",attachToAnchor:!1,disableFocusTrap:!0,onPanelResize:()=>{null!=b&&b.current&&b.current.onResize()}},Object(x.jsx)(S.EuiPopoverTitle,{paddingSize:"s"},r),Object(x.jsx)(S.EuiFlexGroup,{className:"rangeSlider__actions",gutterSize:"none","data-test-subj":"rangeSlider-control-actions",responsive:!1},Object(x.jsx)(S.EuiFlexItem,null,Object(x.jsx)(S.EuiDualRange,{id:e,min:j?h:void 0,max:j?g:void 0,onChange:([e,t])=>{const i="number"==typeof e?String(e):o[0],n="number"==typeof t?String(t):o[1];d([i,n])},value:I,ticks:j?R:void 0,levels:j?T:void 0,showTicks:j,disabled:!j,fullWidth:!0,ref:b,"data-test-subj":"rangeSlider__slider"}),Object(x.jsx)(S.EuiText,{size:"s",color:f?"danger":"default","data-test-subj":"rangeSlider__helpText"},f||v)),Object(x.jsx)(S.EuiFlexItem,{grow:!1},Object(x.jsx)(S.EuiToolTip,{content:_.a.popover.getClearRangeButtonTitle()},Object(x.jsx)(S.EuiButtonIcon,{iconType:"eraser",color:"danger",onClick:()=>d(["",""]),"aria-label":_.a.popover.getClearRangeButtonTitle(),"data-test-subj":"rangeSlider__clearRangeButton"})))))};i(59);const O=({componentStateSubject:e,ignoreValidation:t})=>{const{useEmbeddableDispatch:i,useEmbeddableSelector:n,actions:{selectRange:a}}=Object(g.useReduxEmbeddableContext)(),r=i(),{loading:o,min:d,max:l,fieldFormatter:c,isInvalid:u}=Object(v.a)(e,e.getValue()),{value:h,id:p,title:m}=n((e=>e)),b=Object(s.useCallback)((e=>{r(a(e))}),[a,r]);return Object(x.jsx)(j,{id:p,isLoading:o,min:d,max:l,title:m,value:null!=h?h:["",""],onChange:b,fieldFormatter:c,isInvalid:!t&&u})},y={selectRange:(e,t)=>{e.value=t.payload}};var F=i(22);const N=Object(g.withSuspense)(g.LazyReduxEmbeddableWrapper),A=(e,t)=>{if(!e||!t)return!1;const{filters:i,...n}=e,{filters:a,...r}=t;return!!u()(n,r)&&!!Object(o.f)(null!=a?a:[],null!=i?i:[],o.a)};class range_slider_embeddable_RangeSliderEmbeddable extends m.Embeddable{constructor(e,t,i){super(e,t,i),a()(this,"type",F.a),a()(this,"deferEmbeddableLoad",!0),a()(this,"subscriptions",new h.Subscription),a()(this,"node",void 0),a()(this,"dataService",void 0),a()(this,"dataViewsService",void 0),a()(this,"dataView",void 0),a()(this,"field",void 0),a()(this,"componentState",void 0),a()(this,"componentStateSubject$",new h.BehaviorSubject({min:"",max:"",loading:!0,fieldFormatter:e=>e})),a()(this,"initialize",(async()=>{const e=this.getInput().value;e||this.setInitializationFinished(),this.runRangeSliderQuery().then((async()=>{e&&this.setInitializationFinished(),this.setupSubscriptions()}))})),a()(this,"setupSubscriptions",(()=>{const e=this.getInput$().pipe(Object(p.map)((e=>{var t;return{validate:!Boolean(null===(t=e.ignoreParentSettings)||void 0===t?void 0:t.ignoreValidations),lastReloadRequestTime:e.lastReloadRequestTime,dataViewId:e.dataViewId,fieldName:e.fieldName,timeRange:e.timeRange,filters:e.filters,query:e.query}})),Object(p.distinctUntilChanged)(A),Object(p.skip)(1));this.subscriptions.add(e.subscribe(this.runRangeSliderQuery)),this.subscriptions.add(this.getInput$().pipe(Object(p.debounceTime)(400),Object(p.distinctUntilChanged)(((e,t)=>Object(r.isEqual)(e.value,t.value))),Object(p.skip)(1)).subscribe(this.buildFilter))})),a()(this,"getCurrentDataViewAndField",(async()=>{const{dataViewId:e,fieldName:t}=this.getInput();if(!this.dataView||this.dataView.id!==e)try{if(this.dataView=await this.dataViewsService.get(e),!this.dataView)throw new Error(_.a.errors.getDataViewNotFoundError(e))}catch(e){this.onFatalError(e)}var i,n;return this.field&&this.field.name===t||(this.field=null===(i=this.dataView)||void 0===i?void 0:i.getFieldByName(t),void 0===this.field&&this.onFatalError(new Error(_.a.errors.getDataViewNotFoundError(t))),this.updateComponentState({field:this.field,fieldFormatter:this.field?null===(n=this.dataView)||void 0===n?void 0:n.getFormatterForField(this.field).getConverterFor("text"):e=>e})),{dataView:this.dataView,field:this.field}})),a()(this,"runRangeSliderQuery",(async()=>{this.updateComponentState({loading:!0}),this.updateOutput({loading:!0});const{dataView:e,field:t}=await this.getCurrentDataViewAndField();if(!e||!t)return;const i=this.getInput(),{ignoreParentSettings:n,fieldName:a,query:r,timeRange:o}=i;let{filters:s=[]}=i;if(!t)throw this.updateComponentState({loading:!1}),this.updateOutput({filters:[],loading:!1}),(e=>new Error(`field ${e} not found in index pattern`))(a);if(null!=n&&n.ignoreFilters&&(s=[]),(null==n||!n.ignoreTimerange)&&o){const t=this.dataService.timefilter.createFilter(e,o);t&&(s=s.concat(t))}const{min:d,max:l}=await this.fetchMinMax({dataView:e,field:t,filters:s,query:r});this.updateComponentState({min:`${null!=d?d:""}`,max:`${null!=l?l:""}`}),await this.buildFilter()})),a()(this,"fetchMinMax",(async({dataView:e,field:t,filters:i,query:n})=>{const a=await this.dataService.searchSource.create();a.setField("size",0),a.setField("index",e),a.setField("filter",i),n&&a.setField("query",n);const o={};t&&(t.scripted?o.script={source:t.script,lang:t.lang}:o.field=t.name);const s={maxAgg:{max:o},minAgg:{min:o}};a.setField("aggs",s);const d=await Object(h.lastValueFrom)(a.fetch$());return{min:Object(r.get)(d,"rawResponse.aggregations.minAgg.value",""),max:Object(r.get)(d,"rawResponse.aggregations.maxAgg.value","")}})),a()(this,"buildFilter",(async()=>{const{value:[e,t]=["",""],query:i,timeRange:n,filters:a=[],ignoreParentSettings:s}=this.getInput(),d=this.componentState.min,l=this.componentState.max,c=!Object(r.isEmpty)(d)&&!Object(r.isEmpty)(l),u=!Object(r.isEmpty)(e),p=!Object(r.isEmpty)(t),g=u||p,{dataView:m,field:b}=await this.getCurrentDataViewAndField();if(!m||!b)return;if(!c||!g)return this.updateComponentState({loading:!1,isInvalid:!(null!=s&&s.ignoreValidations)&&g}),void this.updateOutput({filters:[],dataViews:m&&[m],loading:!1});const f={};e&&(f.gte=Math.max(parseFloat(e),parseFloat(d))),t&&(f.lte=Math.min(parseFloat(t),parseFloat(l)));const v=Object(o.e)(b,f,m);if(v.meta.key=null==b?void 0:b.name,v.meta.type="range",v.meta.params=f,null==s||!s.ignoreValidations){const e=await this.dataService.searchSource.create();a.push(v);const t=this.dataService.timefilter.createFilter(m,n);t&&a.push(t),e.setField("size",0),e.setField("index",m),e.setField("filter",a),i&&e.setField("query",i);const{rawResponse:{hits:{total:r}}}=await Object(h.lastValueFrom)(e.fetch$());if(!("number"==typeof r?r:null==r?void 0:r.value))return this.updateComponentState({loading:!1,isInvalid:!0}),void this.updateOutput({filters:[],dataViews:[m],loading:!1})}this.updateComponentState({loading:!1,isInvalid:!1}),this.updateOutput({filters:[v],dataViews:[m],loading:!1})})),a()(this,"reload",(()=>{this.runRangeSliderQuery()})),a()(this,"destroy",(()=>{super.destroy(),this.subscriptions.unsubscribe()})),a()(this,"render",(e=>{var t,i;this.node&&l.a.unmountComponentAtNode(this.node),this.node=e,l.a.render(Object(x.jsx)(b.KibanaThemeProvider,{theme$:f.a.getServices().theme.theme$},Object(x.jsx)(N,{embeddable:this,reducers:y},Object(x.jsx)(O,{componentStateSubject:this.componentStateSubject$,ignoreValidation:void 0!==this.getInput().ignoreParentSettings&&void 0!==(null===(t=this.getInput().ignoreParentSettings)||void 0===t?void 0:t.ignoreValidations)&&(null===(i=this.getInput().ignoreParentSettings)||void 0===i?void 0:i.ignoreValidations)}))),e)})),({data:this.dataService,dataViews:this.dataViewsService}=f.a.getServices()),this.componentState={min:"",max:"",loading:!0,fieldFormatter:e=>e,isInvalid:!1},this.updateComponentState(this.componentState),this.initialize()}updateComponentState(e){this.componentState={...this.componentState,...e},this.componentStateSubject$.next(this.componentState)}}}}]);