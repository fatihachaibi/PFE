(window.unifiedSearch_bundle_jsonpfunction=window.unifiedSearch_bundle_jsonpfunction||[]).push([[4,5],{100:function(e,t,a){var r=a(21),s=a(101);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[e.i,s,""]]);r(s,{insert:"head",singleton:!1}),e.exports=s.locals||{}},101:function(e,t,a){(t=a(22)(!1)).push([e.i,".kbnSavedQueryManagement__listWrapper{max-height:416px;overflow-y:hidden}.kbnSavedQueryManagement__text{padding:12px 12px 6px 12px}.kbnSavedQueryManagement__list{scrollbar-color:rgba(152,162,179,0.5) rgba(0,0,0,0);scrollbar-width:thin;height:100%;overflow-y:auto;overflow-x:hidden;-webkit-mask-image:linear-gradient(to bottom, rgba(255,0,0,0.1) 0%,red 7.5px,red calc(100% - 7.5px),rgba(255,0,0,0.1) 100%);mask-image:linear-gradient(to bottom, rgba(255,0,0,0.1) 0%,red 7.5px,red calc(100% - 7.5px),rgba(255,0,0,0.1) 100%);max-height:inherit;padding:6px 4px !important}.kbnSavedQueryManagement__list::-webkit-scrollbar{width:16px;height:16px}.kbnSavedQueryManagement__list::-webkit-scrollbar-thumb{background-color:rgba(152,162,179,0.5);background-clip:content-box;border-radius:16px;border:6px solid rgba(0,0,0,0)}.kbnSavedQueryManagement__list::-webkit-scrollbar-corner,.kbnSavedQueryManagement__list::-webkit-scrollbar-track{background-color:rgba(0,0,0,0)}.kbnSavedQueryManagement__list:focus{outline:none}.kbnSavedQueryManagement__list[tabindex='0']:focus:focus-visible{outline-style:auto}\n",""]),e.exports=t},102:function(e,t,a){var r=a(21),s=a(103);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[e.i,s,""]]);r(s,{insert:"head",singleton:!1}),e.exports=s.locals||{}},103:function(e,t,a){(t=a(22)(!1)).push([e.i,".kbnSavedQueryManagement__listWrapper{max-height:416px;overflow-y:hidden}.kbnSavedQueryManagement__text{padding:12px 12px 6px 12px}.kbnSavedQueryManagement__list{scrollbar-color:rgba(105,112,125,0.5) rgba(0,0,0,0);scrollbar-width:thin;height:100%;overflow-y:auto;overflow-x:hidden;-webkit-mask-image:linear-gradient(to bottom, rgba(255,0,0,0.1) 0%,red 7.5px,red calc(100% - 7.5px),rgba(255,0,0,0.1) 100%);mask-image:linear-gradient(to bottom, rgba(255,0,0,0.1) 0%,red 7.5px,red calc(100% - 7.5px),rgba(255,0,0,0.1) 100%);max-height:inherit;padding:6px 4px !important}.kbnSavedQueryManagement__list::-webkit-scrollbar{width:16px;height:16px}.kbnSavedQueryManagement__list::-webkit-scrollbar-thumb{background-color:rgba(105,112,125,0.5);background-clip:content-box;border-radius:16px;border:6px solid rgba(0,0,0,0)}.kbnSavedQueryManagement__list::-webkit-scrollbar-corner,.kbnSavedQueryManagement__list::-webkit-scrollbar-track{background-color:rgba(0,0,0,0)}.kbnSavedQueryManagement__list:focus{outline:none}.kbnSavedQueryManagement__list[tabindex='0']:focus:focus-visible{outline-style:auto}\n",""]),e.exports=t},104:function(e,t,a){"use strict";var r=Number.isNaN||function(e){return"number"==typeof e&&e!=e};function s(e,t){if(e.length!==t.length)return!1;for(var a=0;a<e.length;a++)if(!((s=e[a])===(n=t[a])||r(s)&&r(n)))return!1;var s,n;return!0}e.exports=function(e,t){void 0===t&&(t=s);var a=null;function r(){for(var r=[],s=0;s<arguments.length;s++)r[s]=arguments[s];if(a&&a.lastThis===this&&t(r,a.lastArgs))return a.lastResult;var n=e.apply(this,r);return a={lastResult:n,lastArgs:r,lastThis:this},n}return r.clear=function(){a=null},r}},110:function(e,t,a){"use strict";a.r(t);var r=a(7),s=a.n(r),n=a(4),i=a(2),o=a(35),l=a.n(o),u=a(1),d=a.n(u),c=a(3),p=a(104),h=a.n(p),b=a(14),g=a(6),f=a(5),y=a(0);function v({savedQuery:e,savedQueryService:t,onSave:a,onClose:r,showFilterOption:s=!0,showTimeFilterOption:i=!0}){var o,l,p;const[h,b]=Object(u.useState)(null!==(o=null==e?void 0:e.attributes.title)&&void 0!==o?o:""),[g,v]=Object(u.useState)([]),[m,j]=Object(u.useState)(Boolean(null===(l=null==e?void 0:e.attributes.filters)||void 0===l||l)),[S,F]=Object(u.useState)(Boolean(null!==(p=null==e?void 0:e.attributes.timefilter)&&void 0!==p&&p)),[O,x]=Object(u.useState)([]),w=f.i18n.translate("unifiedSearch.search.searchBar.savedQueryForm.titleConflictText",{defaultMessage:"Name conflicts with an existing saved query"}),B=f.i18n.translate("unifiedSearch.search.searchBar.savedQueryForm.titleExistsText",{defaultMessage:"Name is required."});Object(u.useEffect)((()=>{(async()=>{const e=await t.getAllSavedQueries(),a=Object(n.sortBy)(e,"attributes.title");v(a)})()}),[t]);const Q=Object(u.useCallback)((()=>{const t=[];return g.find((t=>!e&&t.attributes.title===h))&&t.push(w),h||t.push(B),Object(n.isEqual)(t,O)?!O.length:(x(t),!1)}),[g,O,h,e,w,B]),C=Object(u.useCallback)((()=>{Q()&&(a({id:null==e?void 0:e.id,title:h,description:"",shouldIncludeFilters:m,shouldIncludeTimefilter:S}),r())}),[Q,a,r,null==e?void 0:e.id,h,m,S]),P=Object(u.useCallback)((e=>{x([]),b(e.target.value)}),[]),R=Object(u.useCallback)((()=>{const e=h.trim();h.length>e.length&&b(e)}),[h]),q=O.length>0,T=Object(y.jsx)(c.EuiForm,{isInvalid:q,error:O,"data-test-subj":"saveQueryForm"},Object(y.jsx)(c.EuiFormRow,{label:f.i18n.translate("unifiedSearch.search.searchBar.savedQueryNameLabelText",{defaultMessage:"Name"}),helpText:f.i18n.translate("unifiedSearch.search.searchBar.savedQueryNameHelpText",{defaultMessage:"Name cannot contain a leading or trailing whitespace and must be unique."}),isInvalid:q,display:"rowCompressed"},Object(y.jsx)(c.EuiFieldText,{disabled:!!e,value:h,name:"title",onChange:P,"data-test-subj":"saveQueryFormTitle",isInvalid:q,onBlur:R,compressed:!0})),s&&Object(y.jsx)(c.EuiFormRow,{display:"rowCompressed"},Object(y.jsx)(c.EuiSwitch,{name:"shouldIncludeFilters",label:f.i18n.translate("unifiedSearch.search.searchBar.savedQueryIncludeFiltersLabelText",{defaultMessage:"Include filters"}),checked:m,onChange:()=>{j(!m)},"data-test-subj":"saveQueryFormIncludeFiltersOption"})),i&&Object(y.jsx)(c.EuiFormRow,{display:"rowCompressed"},Object(y.jsx)(c.EuiSwitch,{name:"shouldIncludeTimefilter",label:f.i18n.translate("unifiedSearch.search.searchBar.savedQueryIncludeTimeFilterLabelText",{defaultMessage:"Include time filter"}),checked:S,onChange:()=>{F(!S)},"data-test-subj":"saveQueryFormIncludeTimeFilterOption"})),Object(y.jsx)(c.EuiFormRow,null,Object(y.jsx)(c.EuiButton,{fullWidth:!0,size:"s",onClick:C,fill:!0,"data-test-subj":"savedQueryFormSaveButton",disabled:q},f.i18n.translate("unifiedSearch.search.searchBar.savedQueryFormSaveButtonText",{defaultMessage:"Save saved query"}))));return Object(y.jsx)(d.a.Fragment,null,T)}a(99);const m=[{start:"now/d",end:"now/d",label:"Today"},{start:"now/w",end:"now/w",label:"This week"},{start:"now/M",end:"now/M",label:"This month"},{start:"now/y",end:"now/y",label:"This year"},{start:"now-1d/d",end:"now-1d/d",label:"Yesterday"},{start:"now/w",end:"now",label:"Week to date"},{start:"now/M",end:"now",label:"Month to date"},{start:"now/y",end:"now",label:"Year to date"}],j=(e,t)=>{let a=e.title;const r=c.usePrettyDuration;var s,n;return e.description&&(a+=`; ${e.description}`),e.timefilter&&(a+=`; ${r({timeFrom:null===(s=e.timefilter)||void 0===s?void 0:s.from,timeTo:null===(n=e.timefilter)||void 0===n?void 0:n.to,quickRanges:m,dateFormat:t})}`),a};var S={name:"11qlldo",styles:"opacity:0.2;filter:grayscale(100%);&:hover,&:focus:focus-visible{opacity:1;filter:grayscale(0%);}"};function F({showSaveQuery:e,loadedSavedQuery:t,onLoad:a,onClearSavedQuery:r,savedQueryService:s,onClose:i,hasFiltersOrQuery:o}){const l=Object(g.useKibana)(),[p,h]=Object(u.useState)([]),[b,v]=Object(u.useState)(null),[m,F]=Object(u.useState)(null),[O,x]=Object(u.useState)(!1),w=Object(u.useRef)((()=>{})),{uiSettings:B,http:Q,application:C}=l.services,P=B.get("dateFormat");Object(u.useEffect)((()=>{(async()=>{w.current();let e=!1;w.current=()=>{e=!0};const{queries:t}=await s.findSavedQueries();if(e)return;const a=Object(n.sortBy)(t,"attributes.title");h(a)})()}),[s]);const R=Object(u.useCallback)((()=>{b&&(a(b),i())}),[a,b,i]),q=Object(u.useCallback)((e=>{v(e)}),[]),T=Object(u.useCallback)((e=>{x(!0),F(e)}),[]),k=Object(u.useCallback)((e=>{(async e=>{w.current(),h(p.filter((t=>t.id!==e))),t&&t.id===e&&r(),await s.deleteSavedQuery(e)})(e)}),[t,r,p,s]),E=f.i18n.translate("unifiedSearch.search.searchBar.savedQueryDescriptionText",{defaultMessage:"Save query text and filters that you want to use again."}),M=f.i18n.translate("unifiedSearch.search.searchBar.savedQueryNoSavedQueriesText",{defaultMessage:"No saved queries."})+" "+E,_=C.capabilities.savedObjectsManagement.edit;return Object(y.jsx)(d.a.Fragment,null,p.length>0?Object(y.jsx)(d.a.Fragment,null,Object(y.jsx)("div",{className:"kbnSavedQueryManagement__listWrapper","data-test-subj":"saved-query-management-list"},Object(y.jsx)(c.EuiSelectable,{"aria-label":"Basic example",options:(()=>{const a=p.filter((e=>!t||e.id!==t.id));return(t&&a.length!==p.length?[t,...a]:[...a]).map((a=>({key:a.id,label:a.attributes.title,title:j(a.attributes,P),"data-test-subj":`load-saved-query-${a.attributes.title}-button`,value:a.id,checked:t&&a.id===t.id||b&&a.id===b.id?"on":void 0,data:{attributes:a.attributes},append:!!e&&Object(y.jsx)(c.EuiButtonIcon,{css:S,iconType:"trash","aria-label":`Delete ${a.attributes.title}`,"data-test-subj":`delete-saved-query-${a.attributes.title}-button`,title:`Delete ${a.attributes.title}`,onClick:()=>T(a),color:"danger"})})))})(),searchable:!0,singleSelection:"always",onChange:e=>{const t=e.find((({checked:e})=>e));t&&q(p.find((e=>e.id===t.value)))},searchProps:{compressed:!0,placeholder:f.i18n.translate("unifiedSearch.query.queryBar.indexPattern.findFilterSet",{defaultMessage:"Find a saved query"})},listProps:{isVirtualized:!0},renderOption:e=>Object(y.jsx)(d.a.Fragment,null,e.attributes?(e=>{let t=e.title;return e.description&&(t=Object(y.jsx)(d.a.Fragment,null,t," ",Object(y.jsx)(c.EuiIcon,{type:"iInCircle",color:"subdued",size:"s"}))),e.timefilter&&(t=Object(y.jsx)(d.a.Fragment,null,t," ",Object(y.jsx)(c.EuiIcon,{type:"clock",color:"subdued",size:"s"}))),t})(e.attributes):e.label)},((e,t)=>Object(y.jsx)(d.a.Fragment,null,Object(y.jsx)(c.EuiPanel,{style:{paddingBottom:0},color:"transparent",paddingSize:"s"},t),e))))):Object(y.jsx)(d.a.Fragment,null,Object(y.jsx)(c.EuiText,{size:"s",color:"subdued",className:"kbnSavedQueryManagement__text","data-test-subj":"saved-query-management-empty"},Object(y.jsx)("p",null,M))),Object(y.jsx)(c.EuiPopoverFooter,{paddingSize:"s"},Object(y.jsx)(c.EuiFlexGroup,{gutterSize:"s",justifyContent:_?"spaceBetween":"flexEnd"},_&&Object(y.jsx)(c.EuiFlexItem,{grow:!1},Object(y.jsx)(c.EuiButtonEmpty,{href:Q.basePath.prepend('/app/management/kibana/objects?initialQuery=type:("query")'),size:"s"},"Manage")),Object(y.jsx)(c.EuiFlexItem,{grow:!1},Object(y.jsx)(c.EuiButton,{size:"s",fill:!0,onClick:R,disabled:!b,"aria-label":f.i18n.translate("unifiedSearch.search.searchBar.savedQueryPopoverApplyFilterSetLabel",{defaultMessage:"Apply saved query"}),"data-test-subj":"saved-query-management-apply-changes-button"},o?f.i18n.translate("unifiedSearch.search.searchBar.savedQueryPopoverReplaceFilterSetLabel",{defaultMessage:"Replace with selected saved query"}):f.i18n.translate("unifiedSearch.search.searchBar.savedQueryPopoverApplyFilterSetLabel",{defaultMessage:"Apply saved query"}))))),O&&m&&Object(y.jsx)(c.EuiConfirmModal,{title:f.i18n.translate("unifiedSearch.search.searchBar.savedQueryPopoverConfirmDeletionTitle",{defaultMessage:'Delete "{savedQueryName}"?',values:{savedQueryName:m.attributes.title}}),confirmButtonText:f.i18n.translate("unifiedSearch.search.searchBar.savedQueryPopoverConfirmDeletionConfirmButtonText",{defaultMessage:"Delete"}),cancelButtonText:f.i18n.translate("unifiedSearch.search.searchBar.savedQueryPopoverConfirmDeletionCancelButtonText",{defaultMessage:"Cancel"}),onConfirm:()=>{k(m.id),x(!1)},buttonColor:"danger",onCancel:()=>{x(!1)}}))}var O=a(9),x=a.n(O),w=a(44),B=a(15),Q=a(65),C=a(66);const P={"filter-sets-pinAllFilters":"pinFilter","filter-sets-unpinAllFilters":"pinFilter","filter-sets-enableAllFilters":"disableFilter","filter-sets-disableAllFilters":"disableFilter","filter-sets-invertAllFilters":"negateFilter","filter-sets-removeAllFilters":"deleteFilter"};var R=a(47);function q({language:e,nonKqlMode:t,dateRangeFrom:a,dateRangeTo:r,onQueryChange:s,onQueryBarSubmit:i,savedQueryService:o,saveAsNewQueryFormComponent:l,saveFormComponent:p,manageFilterSetComponent:h,hiddenPanelOptions:v,openQueryBarMenu:m,toggleFilterBarMenuPopover:j,onFiltersUpdated:S,filters:F,query:O,savedQuery:q,onClearSavedQuery:T,showQueryInput:k,showFilterBar:E,showSaveQuery:M,indexPatterns:_,timeRangeForSuggestionsOverride:I,buttonProps:A}){const[L,D]=Object(u.useState)("menu");Object(u.useEffect)((()=>{m&&D("menu")}),[m]);const N=Object(c.useGeneratedHtmlId)({prefix:"normalContextMenuPopover"}),U=()=>{j(!1)},z=f.i18n.translate("unifiedSearch.filter.options.filterSetButtonLabel",{defaultMessage:"Saved query menu"}),K=Object(y.jsx)(c.EuiToolTip,{delay:"long",content:z},Object(y.jsx)(c.EuiButtonIcon,x()({size:"m",display:"empty",onClick:()=>{j(!m)}},A,{iconType:"filter","aria-label":z,"data-test-subj":"showQueryBarMenu"}))),W=function({filters:e,savedQuery:t,language:a,dateRangeFrom:r,dateRangeTo:s,query:i,showSaveQuery:o,showFilterBar:l,showQueryInput:p,savedQueryService:h,saveAsNewQueryFormComponent:v,manageFilterSetComponent:m,hiddenPanelOptions:j,nonKqlMode:S,closePopover:F,onQueryBarSubmit:O,onFiltersUpdated:x,onClearSavedQuery:R,onQueryChange:q,setRenderedComponent:T}){const k=Object(g.useKibana)(),{appName:E,usageCollection:M,uiSettings:_,http:I,storage:A}=k.services,L=null==M?void 0:M.reportUiCounter.bind(M,E),D=Object(u.useRef)((()=>{})),[N,U]=Object(u.useState)([]),[z,K]=Object(u.useState)(!1),[W,Y]=Object(u.useState)(!1);Object(u.useEffect)((()=>{p&&l&&(async()=>{D.current();let e=!1;D.current=()=>{e=!0};const{queries:t}=await h.findSavedQueries("");e||U(t.reverse().slice(0,5))})()}),[h,t,p,l]),Object(u.useEffect)((()=>{if(t){var a,r,s,o;let l=(null==e?void 0:e.length)!==(null===(a=t.attributes)||void 0===a||null===(r=a.filters)||void 0===r?void 0:r.length);(null==e?void 0:e.length)===(null===(s=t.attributes)||void 0===s||null===(o=s.filters)||void 0===o?void 0:o.length)&&(l=Boolean(null==e?void 0:e.some(((e,a)=>{var r,s,i;return!Object(n.isEqual)(e.query,null===(r=t.attributes)||void 0===r||null===(s=r.filters)||void 0===s||null===(i=s[a])||void 0===i?void 0:i.query)})))),l||!Object(n.isEqual)(i,null==t?void 0:t.attributes.query)?Y(!0):Y(!1)}}),[e,i,t,null==t?void 0:t.attributes.filters,null==t?void 0:t.attributes.query]),Object(u.useEffect)((()=>{const t=Boolean(e&&e.length>0),a=Boolean(i&&i.query);K(t||a)}),[e,R,i,t]);const G=()=>{const e=_.get(B.UI_SETTINGS.TIMEPICKER_TIME_DEFAULTS);return{from:r||e.from,to:s||e.to}},$=Object(u.useCallback)((()=>{T("saveAsNewForm")}),[T]),V=Object(u.useCallback)((()=>{T("saveForm")}),[T]),H=f.i18n.translate("unifiedSearch.query.queryBar.luceneLanguageName",{defaultMessage:"Lucene"}),J=f.i18n.translate("unifiedSearch.query.queryBar.kqlLanguageName",{defaultMessage:"KQL"}),X=[{name:f.i18n.translate("unifiedSearch.filter.options.addFilterButtonLabel",{defaultMessage:"Add filter"}),icon:"plus",onClick:()=>{T("addFilter")}},{name:f.i18n.translate("unifiedSearch.filter.options.applyAllFiltersButtonLabel",{defaultMessage:"Apply to all"}),icon:"filter",panel:2,disabled:!Boolean(e&&e.length>0),"data-test-subj":"filter-sets-applyToAllFilters"}],Z=[{name:t?f.i18n.translate("unifiedSearch.filter.options.loadOtherFilterSetLabel",{defaultMessage:"Load other saved query"}):f.i18n.translate("unifiedSearch.filter.options.loadCurrentFilterSetLabel",{defaultMessage:"Load saved query"}),panel:4,width:350,icon:"filter","data-test-subj":"saved-query-management-load-button",disabled:!N.length},{name:t?f.i18n.translate("unifiedSearch.filter.options.saveAsNewFilterSetLabel",{defaultMessage:"Save as new"}):f.i18n.translate("unifiedSearch.filter.options.saveFilterSetLabel",{defaultMessage:"Save saved query"}),icon:"save",disabled:!Boolean(o)||!z||t&&!W,panel:1,"data-test-subj":"saved-query-management-save-button"},{isSeparator:!0}],ee=[];l&&ee.push(...X),(l||p)&&ee.push({name:f.i18n.translate("unifiedSearch.filter.options.clearllFiltersButtonLabel",{defaultMessage:"Clear all"}),disabled:!z&&!Boolean(t),icon:"crossInACircleFilled","data-test-subj":"filter-sets-removeAllFilters",onClick:()=>{F(),O({query:{query:"",language:a},dateRange:G()}),null==L||L(b.METRIC_TYPE.CLICK,"filter:remove_all"),null==x||x([]),null==R||R()}},{isSeparator:!0}),p&&l&&ee.push(...Z),p&&ee.push({name:`Language: ${"kuery"===a?J:H}`,panel:3,"data-test-subj":"switchQueryLanguageButton"});let te=[{id:0,title:Object(y.jsx)(d.a.Fragment,null,Object(y.jsx)(c.EuiFlexGroup,{direction:"column",gutterSize:"s"},Object(y.jsx)(c.EuiFlexItem,{grow:!1},Object(y.jsx)(c.EuiText,{color:t?"primary":"default",size:"s","data-test-subj":"savedQueryTitle"},Object(y.jsx)("strong",null,t?t.attributes.title:f.i18n.translate("unifiedSearch.search.searchBar.savedQuery",{defaultMessage:"Saved query"})))),t&&W&&Boolean(o)&&z&&Object(y.jsx)(c.EuiFlexItem,{grow:!1},Object(y.jsx)(c.EuiFlexGroup,{direction:"row",gutterSize:"s",alignItems:"center",justifyContent:"center",responsive:!1,wrap:!1},Object(y.jsx)(c.EuiFlexItem,{grow:!1},Object(y.jsx)(c.EuiButton,{size:"s",fill:!0,onClick:V,"aria-label":f.i18n.translate("unifiedSearch.search.searchBar.savedQueryPopoverSaveChangesButtonAriaLabel",{defaultMessage:"Save changes to {title}",values:{title:null==t?void 0:t.attributes.title}}),"data-test-subj":"saved-query-management-save-changes-button"},f.i18n.translate("unifiedSearch.search.searchBar.savedQueryPopoverSaveChangesButtonText",{defaultMessage:"Save changes"}))),Object(y.jsx)(c.EuiFlexItem,{grow:!1},Object(y.jsx)(c.EuiButton,{size:"s",onClick:$,"aria-label":f.i18n.translate("unifiedSearch.search.searchBar.savedQueryPopoverSaveAsNewButtonAriaLabel",{defaultMessage:"Save as new saved query"}),"data-test-subj":"saved-query-management-save-as-new-button"},f.i18n.translate("unifiedSearch.search.searchBar.savedQueryPopoverSaveAsNewButtonText",{defaultMessage:"Save as new"}))))))),items:ee},{id:1,title:f.i18n.translate("unifiedSearch.filter.options.saveCurrentFilterSetLabel",{defaultMessage:"Save current saved query"}),disabled:!Boolean(o),content:Object(y.jsx)("div",{style:{padding:16}},v)},{id:2,initialFocusedItemIndex:1,title:f.i18n.translate("unifiedSearch.filter.options.applyAllFiltersButtonLabel",{defaultMessage:"Apply to all"}),items:[{name:f.i18n.translate("unifiedSearch.filter.options.enableAllFiltersButtonLabel",{defaultMessage:"Enable all"}),icon:"eye","data-test-subj":"filter-sets-enableAllFilters",onClick:()=>{F(),(()=>{null==L||L(b.METRIC_TYPE.CLICK,"filter:enable_all");const t=null==e?void 0:e.map(w.enableFilter);t&&(null==x||x(t))})()}},{name:f.i18n.translate("unifiedSearch.filter.options.disableAllFiltersButtonLabel",{defaultMessage:"Disable all"}),"data-test-subj":"filter-sets-disableAllFilters",icon:"eyeClosed",onClick:()=>{F(),(()=>{null==L||L(b.METRIC_TYPE.CLICK,"filter:disable_all");const t=null==e?void 0:e.map(w.disableFilter);t&&(null==x||x(t))})()}},{name:f.i18n.translate("unifiedSearch.filter.options.invertNegatedFiltersButtonLabel",{defaultMessage:"Invert inclusion"}),"data-test-subj":"filter-sets-invertAllFilters",icon:"invert",onClick:()=>{F(),(()=>{null==L||L(b.METRIC_TYPE.CLICK,"filter:invert_all");const t=null==e?void 0:e.map(w.toggleFilterNegated);t&&(null==x||x(t))})()}},{name:f.i18n.translate("unifiedSearch.filter.options.pinAllFiltersButtonLabel",{defaultMessage:"Pin all"}),"data-test-subj":"filter-sets-pinAllFilters",icon:"pin",onClick:()=>{F(),(()=>{null==L||L(b.METRIC_TYPE.CLICK,"filter:pin_all");const t=null==e?void 0:e.map(w.pinFilter);t&&(null==x||x(t))})()}},{name:f.i18n.translate("unifiedSearch.filter.options.unpinAllFiltersButtonLabel",{defaultMessage:"Unpin all"}),"data-test-subj":"filter-sets-unpinAllFilters",icon:"pin",onClick:()=>{F(),(()=>{null==L||L(b.METRIC_TYPE.CLICK,"filter:unpin_all");const t=null==e?void 0:e.map(w.unpinFilter);t&&(null==x||x(t))})()}}]},{id:3,title:f.i18n.translate("unifiedSearch.filter.options.filterLanguageLabel",{defaultMessage:"Filter language"}),content:Object(y.jsx)(C.a,{language:a,onSelectLanguage:e=>{I.post("/api/kibana/kql_opt_in_stats",{body:JSON.stringify({opt_in:"kuery"===e})});const t=B.KIBANA_USER_QUERY_LANGUAGE_KEY;A.set(t,e);const r={query:"",language:e};q({query:{query:r.query,language:a},dateRange:G()}),O({query:{query:Object(Q.a)(r.query),language:r.language},dateRange:G()})},nonKqlMode:S,isOnTopBarMenu:!0})},{id:4,title:f.i18n.translate("unifiedSearch.filter.options.loadCurrentFilterSetLabel",{defaultMessage:"Load saved query"}),width:400,content:Object(y.jsx)("div",null,m)}];return j&&j.length>0&&(te=te.map((e=>{var t;return{...e,items:null===(t=e.items)||void 0===t?void 0:t.filter((e=>{if(!e["data-test-subj"])return!0;const t=P[e["data-test-subj"]];return!t||!j.includes(t)}))}}))),te}({filters:F,savedQuery:q,language:e,dateRangeFrom:a,dateRangeTo:r,query:O,showSaveQuery:M,showFilterBar:E,showQueryInput:k,savedQueryService:o,saveAsNewQueryFormComponent:l,manageFilterSetComponent:h,hiddenPanelOptions:v,nonKqlMode:t,closePopover:U,onQueryBarSubmit:i,onFiltersUpdated:S,onClearSavedQuery:T,onQueryChange:s,setRenderedComponent:D});return Object(y.jsx)(d.a.Fragment,null,Object(y.jsx)(c.EuiPopover,{id:N,button:K,isOpen:m,closePopover:U,panelPaddingSize:"none",anchorPosition:"downLeft",repositionOnScroll:!0,"data-test-subj":"queryBarMenuPopover"},(()=>{switch(L){case"menu":default:return Object(y.jsx)(c.EuiContextMenu,{initialPanelId:0,panels:W,"data-test-subj":"queryBarMenuPanel"});case"saveForm":return Object(y.jsx)(c.EuiContextMenuPanel,{items:[Object(y.jsx)("div",{style:{padding:16}},p)]});case"saveAsNewForm":return Object(y.jsx)(c.EuiContextMenuPanel,{items:[Object(y.jsx)("div",{style:{padding:16}},l)]});case"addFilter":return Object(y.jsx)(c.EuiContextMenuPanel,{items:[Object(y.jsx)(R.a,{indexPatterns:_,filters:F,timeRangeForSuggestionsOverride:I,onFiltersUpdated:S,closePopover:U})]})}})()))}var T=a(73),k=a(17),E={name:"eivff4",styles:"display:none"},M={name:"1hcx8jb",styles:"padding:0"};class search_bar_SearchBarUI extends u.Component{constructor(...e){super(...e),s()(this,"services",this.props.kibana.services),s()(this,"savedQueryService",this.services.data.query.savedQueries),s()(this,"state",{isFiltersVisible:!0,openQueryBarMenu:!1,showSavedQueryPopover:!1,currentProps:this.props,query:this.props.query?{...this.props.query}:void 0,dateRangeFrom:Object(n.get)(this.props,"dateRangeFrom","now-15m"),dateRangeTo:Object(n.get)(this.props,"dateRangeTo","now")}),s()(this,"isDirty",(()=>!this.props.showDatePicker&&this.state.query&&this.props.query?this.state.query.query!==this.props.query.query:this.state.query&&this.props.query&&this.state.query.query!==this.props.query.query||this.state.dateRangeFrom!==this.props.dateRangeFrom||this.state.dateRangeTo!==this.props.dateRangeTo)),s()(this,"onSave",(async(e,t=!1)=>{if(!this.state.query)return;const a={title:e.title,description:e.description,query:this.state.query};e.shouldIncludeFilters&&(a.filters=this.props.filters),e.shouldIncludeTimefilter&&void 0!==this.state.dateRangeTo&&void 0!==this.state.dateRangeFrom&&void 0!==this.props.refreshInterval&&void 0!==this.props.isRefreshPaused&&(a.timefilter={from:this.state.dateRangeFrom,to:this.state.dateRangeTo,refreshInterval:{value:this.props.refreshInterval,pause:this.props.isRefreshPaused}});try{let r;r=this.props.savedQuery&&!t?await this.savedQueryService.updateQuery(e.id,a):await this.savedQueryService.createQuery(a),this.services.notifications.toasts.addSuccess(`Your query "${r.attributes.title}" was saved`),this.props.onSaved&&this.props.onSaved(r)}catch(e){throw this.services.notifications.toasts.addDanger(`An error occured while saving your query: ${e.message}`),e}})),s()(this,"onQueryBarChange",(e=>{this.setState({query:e.query,dateRangeFrom:e.dateRange.from,dateRangeTo:e.dateRange.to}),this.props.onQueryChange&&this.props.onQueryChange(e)})),s()(this,"toggleFilterBarMenuPopover",(e=>{this.setState({openQueryBarMenu:e})})),s()(this,"onQueryBarSubmit",(e=>{this.setState({query:e.query,dateRangeFrom:e.dateRange&&e.dateRange.from||this.state.dateRangeFrom,dateRangeTo:e.dateRange&&e.dateRange.to||this.state.dateRangeTo},(()=>{var e;this.props.onQuerySubmit&&this.props.onQuerySubmit({query:this.state.query,dateRange:{from:this.state.dateRangeFrom,to:this.state.dateRangeTo}}),null===(e=this.services.usageCollection)||void 0===e||e.reportUiCounter(this.services.appName,b.METRIC_TYPE.CLICK,"query_submitted")}))})),s()(this,"onLoadSavedQuery",(e=>{const t=Object(n.get)(e,"attributes.timefilter.from",this.state.dateRangeFrom),a=Object(n.get)(e,"attributes.timefilter.to",this.state.dateRangeTo);this.setState({query:e.attributes.query,dateRangeFrom:t,dateRangeTo:a}),this.props.onSavedQueryUpdated&&this.props.onSavedQueryUpdated(e)})),s()(this,"renderSavedQueryManagement",h()(((e,t,a)=>e&&Object(y.jsx)(F,{showSaveQuery:t,loadedSavedQuery:a,onLoad:this.onLoadSavedQuery,savedQueryService:this.savedQueryService,onClearSavedQuery:e,onClose:()=>this.setState({openQueryBarMenu:!1}),hasFiltersOrQuery:this.hasFiltersOrQuery()}))))}static getDerivedStateFromProps(e,t){if(Object(n.isEqual)(t.currentProps,e))return null;let a=null;e.query&&e.query.query!==Object(n.get)(t,"currentProps.query.query")?a={query:e.query.query,language:e.query.language}:e.query&&t.query&&e.query.language!==t.query.language&&(a={query:"",language:e.query.language});let r=null;e.dateRangeFrom===Object(n.get)(t,"currentProps.dateRangeFrom")&&e.dateRangeTo===Object(n.get)(t,"currentProps.dateRangeTo")||(r={dateRangeFrom:e.dateRangeFrom,dateRangeTo:e.dateRangeTo});const s={currentProps:e};return a&&(s.query=a),r&&(s.dateRangeFrom=r.dateRangeFrom,s.dateRangeTo=r.dateRangeTo),s}componentWillUnmount(){this.renderSavedQueryManagement.clear()}shouldRenderFilterBar(){return this.props.showFilterBar&&this.props.filters&&this.props.indexPatterns&&Object(n.compact)(this.props.indexPatterns).length>0}shouldRenderTimeFilterInSavedQueryForm(){const{dateRangeFrom:e,dateRangeTo:t,showDatePicker:a,indexPatterns:r}=this.props;return!(!a&&void 0!==e&&void 0!==t)&&(null==r||!r.length||r.some((e=>Boolean(e.timeFieldName))))}shouldShowDatePickerAsBadge(){return this.shouldRenderFilterBar()&&!this.props.showQueryInput}render(){var e,t,a;const{theme:r}=this.props,s=!0===this.props.isScreenshotMode,n=(({euiTheme:e})=>({uniSearchBar:Object(y.css)("padding:",e.size.s,";",""),detached:Object(y.css)("border-bottom:",e.border.thin,";",""),inPage:M,hidden:E}))(r),i=[n.uniSearchBar,this.props.displayStyle&&n[this.props.displayStyle],s&&n.hidden],o=l()("uniSearchBar",{"uniSearchBar--hidden":s,[`uniSearchBar--${this.props.displayStyle}`]:this.props.displayStyle}),u=!!this.props.showDatePicker&&void 0,d=Object(y.jsx)(v,{savedQueryService:this.savedQueryService,onSave:e=>this.onSave(e,!0),onClose:()=>this.setState({openQueryBarMenu:!1}),showFilterOption:this.props.showFilterBar,showTimeFilterOption:this.shouldRenderTimeFilterInSavedQueryForm()}),c=Object(y.jsx)(v,{savedQuery:this.props.savedQuery?this.props.savedQuery:void 0,savedQueryService:this.savedQueryService,onSave:this.onSave,onClose:()=>this.setState({openQueryBarMenu:!1}),showFilterOption:this.props.showFilterBar,showTimeFilterOption:this.shouldRenderTimeFilterInSavedQueryForm()}),p=Object(y.jsx)(q,{nonKqlMode:this.props.nonKqlMode,language:null!==(e=null===(t=this.state)||void 0===t||null===(a=t.query)||void 0===a?void 0:a.language)&&void 0!==e?e:"kuery",onQueryChange:this.onQueryBarChange,onQueryBarSubmit:this.onQueryBarSubmit,dateRangeFrom:this.state.dateRangeFrom,dateRangeTo:this.state.dateRangeTo,savedQueryService:this.savedQueryService,saveAsNewQueryFormComponent:d,saveFormComponent:c,toggleFilterBarMenuPopover:this.toggleFilterBarMenuPopover,openQueryBarMenu:this.state.openQueryBarMenu,onFiltersUpdated:this.props.onFiltersUpdated,filters:this.props.filters,hiddenPanelOptions:this.props.hiddenFilterPanelOptions,query:this.state.query,savedQuery:this.props.savedQuery,onClearSavedQuery:this.props.onClearSavedQuery,showQueryInput:this.props.showQueryInput,showFilterBar:this.props.showFilterBar,showSaveQuery:this.props.showSaveQuery,buttonProps:{size:this.shouldShowDatePickerAsBadge()?"s":"m"},indexPatterns:this.props.indexPatterns,timeRangeForSuggestionsOverride:u,manageFilterSetComponent:this.props.showFilterBar&&this.state.query?this.renderSavedQueryManagement(this.props.onClearSavedQuery,this.props.showSaveQuery,this.props.savedQuery):void 0});let h;return this.shouldRenderFilterBar()&&(h=this.shouldShowDatePickerAsBadge()?Object(y.jsx)(k.c,{filters:this.props.filters,onFiltersUpdated:this.props.onFiltersUpdated,indexPatterns:this.props.indexPatterns,timeRangeForSuggestionsOverride:u,hiddenPanelOptions:this.props.hiddenFilterPanelOptions}):Object(y.jsx)(k.a,{afterQueryBar:!0,filters:this.props.filters,onFiltersUpdated:this.props.onFiltersUpdated,indexPatterns:this.props.indexPatterns,timeRangeForSuggestionsOverride:u,hiddenPanelOptions:this.props.hiddenFilterPanelOptions,"data-test-subj":"unifiedFilterBar"})),Object(y.jsx)("div",{className:o,css:i,"data-test-subj":"globalQueryBar"},Object(y.jsx)(T.default,{timeHistory:this.props.timeHistory,query:this.state.query,screenTitle:this.props.screenTitle,onSubmit:this.onQueryBarSubmit,indexPatterns:this.props.indexPatterns,isLoading:this.props.isLoading,fillSubmitButton:this.props.fillSubmitButton||!1,prepend:this.props.showFilterBar||this.props.showQueryInput?p:void 0,showDatePicker:this.props.showDatePicker,dateRangeFrom:this.state.dateRangeFrom,dateRangeTo:this.state.dateRangeTo,isRefreshPaused:this.props.isRefreshPaused,refreshInterval:this.props.refreshInterval,showAutoRefreshOnly:this.props.showAutoRefreshOnly,showQueryInput:this.props.showQueryInput,showAddFilter:this.props.showFilterBar,onRefresh:this.props.onRefresh,onRefreshChange:this.props.onRefreshChange,onChange:this.onQueryBarChange,isDirty:this.isDirty(),customSubmitButton:this.props.customSubmitButton?this.props.customSubmitButton:void 0,showSubmitButton:this.props.showSubmitButton,dataTestSubj:this.props.dataTestSubj,indicateNoData:this.props.indicateNoData,placeholder:this.props.placeholder,isClearable:this.props.isClearable,iconType:this.props.iconType,nonKqlMode:this.props.nonKqlMode,timeRangeForSuggestionsOverride:u,filters:this.props.filters,onFiltersUpdated:this.props.onFiltersUpdated,dataViewPickerComponentProps:this.props.dataViewPickerComponentProps,showDatePickerAsBadge:this.shouldShowDatePickerAsBadge(),filterBar:h,suggestionsSize:this.props.suggestionsSize,isScreenshotMode:this.props.isScreenshotMode}))}hasFiltersOrQuery(){const e=Boolean(this.props.filters&&this.props.filters.length>0),t=Boolean(this.state.query&&this.state.query.query);return e||t}}s()(search_bar_SearchBarUI,"defaultProps",{showQueryBar:!0,showFilterBar:!0,showDatePicker:!0,showSubmitButton:!0,showAutoRefreshOnly:!1}),t.default=Object(i.injectI18n)(Object(c.withEuiTheme)(Object(g.withKibana)(search_bar_SearchBarUI)))},47:function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));var r=a(1),s=a.n(r),n=a(44),i=a(14),o=a(6),l=a(15),u=a(36),d=a(64),c=a(50),p=a(0);const h=s.a.memo((function({indexPatterns:e,filters:t,timeRangeForSuggestionsOverride:a,closePopover:s,onFiltersUpdated:h}){const b=Object(o.useKibana)(),{uiSettings:g,data:f,usageCollection:y,appName:v}=b.services,m=null==y?void 0:y.reportUiCounter.bind(y,v),[j,S]=Object(r.useState)([]),[F,O]=Object(r.useState)(void 0),x=g.get(l.UI_SETTINGS.FILTERS_PINNED_BY_DEFAULT);return Object(r.useEffect)((()=>{e&&(async()=>{const t=null==e?void 0:e.filter((e=>"string"==typeof e)),a=null==e?void 0:e.filter((e=>"string"!=typeof e)),r=await Object(c.a)(f.dataViews,t);S([...a,...r]);const[s]=[...a,...r],i=s&&s.id,o=Object(n.buildEmptyFilter)(x,i);O(o)})()}),[f.dataViews,e,x]),Object(p.jsx)("div",{style:{width:u.FILTER_EDITOR_WIDTH,maxWidth:"100%"}},F&&Object(p.jsx)(d.a,{filter:F,indexPatterns:j,onSubmit:function(e){null==m||m(i.METRIC_TYPE.CLICK,"filter:added"),null==s||s();const a=[...t,e];null==h||h(a)},onCancel:()=>null==s?void 0:s(),key:JSON.stringify(F),timeRangeForSuggestionsOverride:a,mode:"add"}))}))},49:function(e,t,a){"use strict";e.exports=function e(t,a){if(t===a)return!0;if(t&&a&&"object"==typeof t&&"object"==typeof a){if(t.constructor!==a.constructor)return!1;var r,s,n;if(Array.isArray(t)){if((r=t.length)!=a.length)return!1;for(s=r;0!=s--;)if(!e(t[s],a[s]))return!1;return!0}if(t.constructor===RegExp)return t.source===a.source&&t.flags===a.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===a.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===a.toString();if((r=(n=Object.keys(t)).length)!==Object.keys(a).length)return!1;for(s=r;0!=s--;)if(!Object.prototype.hasOwnProperty.call(a,n[s]))return!1;for(s=r;0!=s--;){var i=n[s];if(!e(t[i],a[i]))return!1}return!0}return t!=t&&a!=a}},57:function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(58);case"v8light":return a(60)}},58:function(e,t,a){var r=a(21),s=a(59);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[e.i,s,""]]);r(s,{insert:"head",singleton:!1}),e.exports=s.locals||{}},59:function(e,t,a){(t=a(22)(!1)).push([e.i,".kbnQueryBar__datePickerWrapper .euiDatePopoverButton-isInvalid{background-image:linear-gradient(to top, #F86B63, #F86B63 2px, transparent 2px, transparent 100%)}.kbnQueryBar__datePickerWrapper .euiDatePopoverButton-isInvalid:focus{color:#DFE5EF;background-color:#16171c;background-image:linear-gradient(to top, #36A2EF, #36A2EF 2px, transparent 2px, transparent 100%)}\n",""]),e.exports=t},60:function(e,t,a){var r=a(21),s=a(61);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[e.i,s,""]]);r(s,{insert:"head",singleton:!1}),e.exports=s.locals||{}},61:function(e,t,a){(t=a(22)(!1)).push([e.i,".kbnQueryBar__datePickerWrapper .euiDatePopoverButton-isInvalid{background-image:linear-gradient(to top, #BD271E, #BD271E 2px, transparent 2px, transparent 100%)}.kbnQueryBar__datePickerWrapper .euiDatePopoverButton-isInvalid:focus{color:#343741;background-color:#fbfcfd;background-image:linear-gradient(to top, #07C, #07C 2px, transparent 2px, transparent 100%)}\n",""]),e.exports=t},62:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(37),s=a(1),n=r.__importDefault(a(63));t.default=function(e,t){var a=s.useState(t),r=a[0],i=a[1];return n.default((function(){var t=e.subscribe(i);return function(){return t.unsubscribe()}}),[e]),r}},63:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(1),s="undefined"!=typeof window?r.useLayoutEffect:r.useEffect;t.default=s},73:function(e,t,a){"use strict";a.r(t),a.d(t,"QueryBarTopRow",(function(){return E}));var r=a(9),s=a.n(r),n=a(18),i=a.n(n),o=a(35),l=a.n(o),u=a(1),d=a.n(u),c=a(49),p=a.n(c),h=a(62),b=a.n(h),g=a(13),f=a(25),y=a(3),v=a(10),m=a(5),j=a(6),S=a(15),F=a(72),O=a(0);const x="data.noDataPopover";function w({showNoDataPopover:e,storage:t,children:a}){const[r,s]=Object(u.useState)((()=>Boolean(t.get(x)))),[n,i]=Object(u.useState)(!1);return Object(u.useEffect)((()=>{e&&!r&&i(!0)}),[r,e]),Object(O.jsx)(y.EuiTourStep,{onFinish:()=>{},closePopover:()=>{i(!1)},content:Object(O.jsx)(y.EuiText,{size:"s"},Object(O.jsx)("p",{style:{maxWidth:300}},m.i18n.translate("unifiedSearch.noDataPopover.content",{defaultMessage:"This time range doesn't contain any data. Increase or adjust the time range to see more fields and create charts."}))),minWidth:300,anchorPosition:"downCenter",anchorClassName:"eui-displayBlock",step:1,stepsTotal:1,isStepOpen:n,subtitle:m.i18n.translate("unifiedSearch.noDataPopover.subtitle",{defaultMessage:"Tip"}),title:m.i18n.translate("unifiedSearch.noDataPopover.title",{defaultMessage:"Empty dataset"}),footerAction:Object(O.jsx)(y.EuiButtonEmpty,{size:"xs",flush:"right",color:"text","data-test-subj":"noDataPopoverDismissButton",onClick:()=>{t.set(x,!0),s(!0),i(!1)}},m.i18n.translate("unifiedSearch.noDataPopover.dismissAction",{defaultMessage:"Don't show again"}))},Object(O.jsx)("div",{onFocus:()=>{i(!1)}},a))}var B=a(46),Q=a(47);const C=d.a.memo((function({indexPatterns:e,filters:t,timeRangeForSuggestionsOverride:a,onFiltersUpdated:r,buttonProps:n}){const[i,o]=Object(u.useState)(!1),l=m.i18n.translate("unifiedSearch.filter.filterBar.addFilterButtonLabel",{defaultMessage:"Add filter"}),d=Object(O.jsx)(y.EuiToolTip,{delay:"long",content:l},Object(O.jsx)(y.EuiButtonIcon,s()({display:"base",iconType:"plusInCircleFilled","aria-label":l,"data-test-subj":"addFilter",onClick:()=>o(!i),size:"m"},n)));return Object(O.jsx)(y.EuiFlexItem,{grow:!1},Object(O.jsx)(y.EuiPopover,{id:"addFilterPopover",button:d,isOpen:i,closePopover:()=>o(!1),anchorPosition:"downLeft",panelPaddingSize:"none",initialFocus:".filterEditor__hiddenItem",ownFocus:!0,repositionOnScroll:!0},Object(O.jsx)(Q.a,{indexPatterns:e,filters:t,timeRangeForSuggestionsOverride:a,onFiltersUpdated:r,closePopover:()=>o(!1)})))}));var P=a(24),R=a(51);a(57);const q=d.a.memo(y.EuiSuperDatePicker),T=Object(j.withKibana)(F.default),k=d.a.memo((function({from:e,to:t,dateFormat:a}){function r(e,t=!1){const a=i.a.parse(e,{roundUp:t});return a?a.toISOString():e}const s=Object(y.usePrettyDuration)({timeFrom:r(e),timeTo:r(t),quickRanges:[],dateFormat:a});return Object(O.jsx)("div",{"data-shared-timefilter-duration":s,"data-test-subj":"dataSharedTimefilterDuration"})})),E=d.a.memo((function(e){var t;const a=Object(y.useIsWithinBreakpoints)(["xs","s"]),[r,n]=Object(u.useState)(!1);Object(u.useEffect)((()=>{function e(){n(window.innerWidth>=1440)}return window.removeEventListener("resize",e),window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)}),[]);const{showQueryInput:i=!0,showDatePicker:o=!0,showAutoRefreshOnly:c=!1,showSubmitButton:p=!0}=e,[h,F]=Object(u.useState)(!1),[x,B]=Object(u.useState)(!1),Q=Object(j.useKibana)(),{uiSettings:E,storage:M,appName:_}=Q.services,I=e.query&&e.query.language,A=Object(u.useRef)(e.query);A.current=e.query;const L=d.a.useMemo((()=>I&&E&&M&&_?Object(v.getQueryLog)(E,M,_,I):void 0),[_,I,E,M]),D=function(){const t=E.get(S.UI_SETTINGS.TIMEPICKER_TIME_DEFAULTS);return{from:e.dateRangeFrom||t.from,to:e.dateRangeTo||t.to}}(),N=Object(u.useRef)(D);N.current=D;const U=e.onSubmit,z=e=>e.map((({from:e,to:t})=>({start:e,end:t}))),K=e.timeHistory,W=Object(u.useMemo)((()=>{var e;return null!==(e=null==K?void 0:K.get$().pipe(Object(f.map)(z)))&&void 0!==e?e:g.EMPTY}),[K]),Y=b()(W,z(null!==(t=null==K?void 0:K.get())&&void 0!==t?t:[])),[G]=Object(u.useState)((()=>{var e,t;return null!==(e=null==E||null===(t=E.get(S.UI_SETTINGS.TIMEPICKER_QUICK_RANGES))||void 0===t?void 0:t.map((({from:e,to:t,display:a})=>({start:e,end:t,label:a}))))&&void 0!==e?e:[]})),$=Object(u.useCallback)((({query:e,dateRange:t})=>{K&&K.add(t),U({query:e,dateRange:t})}),[K,U]),V=Object(u.useCallback)((e=>{L&&A.current&&L.add(A.current.query),e.preventDefault(),$({query:A.current,dateRange:N.current})}),[L,$]),H=e.onChange,J=Object(u.useCallback)((e=>H({query:e,dateRange:N.current})),[H]),X=Object(u.useCallback)((e=>{B(e)}),[]),Z=Object(u.useCallback)((({start:e,end:t,isInvalid:a,isQuickSelection:r})=>{F(a);const s={query:A.current,dateRange:{from:e,to:t}};r?$(s):H(s)}),[H,$]),ee=e.onRefresh,te=Object(u.useCallback)((({start:e,end:t})=>{ee&&ee({dateRange:{from:e,to:t}})}),[ee]),ae=Object(u.useCallback)((e=>{$({query:e,dateRange:N.current})}),[$]);function re(){return Boolean(i&&e.indexPatterns&&e.query&&M)}function se(){return Boolean(o||c)}function ne(){return!Boolean(e.showAddFilter)&&Boolean(e.prepend)}function ie(){return Boolean(e.showDatePickerAsBadge)&&!re()}function oe(){return(Boolean(e.showAddFilter)||Boolean(e.prepend))&&Object(O.jsx)(y.EuiFlexItem,{grow:!1},Object(O.jsx)(R.a,{items:[e.prepend,Boolean(e.showAddFilter)&&Object(O.jsx)(y.EuiFlexItem,{grow:!1},Object(O.jsx)(C,{indexPatterns:e.indexPatterns,filters:e.filters,timeRangeForSuggestionsOverride:e.timeRangeForSuggestionsOverride,onFiltersUpdated:e.onFiltersUpdated,buttonProps:{size:ie()?"s":"m",display:"empty"}}))],attached:ne(),size:ie()?"s":"m"}))}const le=!0===e.isScreenshotMode;return Object(O.jsx)(d.a.Fragment,null,Object(O.jsx)(k,{from:D.from,to:D.to,dateFormat:E.get("dateFormat")}),!le&&Object(O.jsx)(d.a.Fragment,null,Object(O.jsx)(y.EuiFlexGroup,{className:"kbnQueryBar",direction:a&&!ie()?"column":"row",responsive:!1,gutterSize:"s",justifyContent:ie()?"flexStart":"flexEnd",wrap:!0},function(){if(e.dataViewPickerComponentProps)return Object(O.jsx)(y.EuiFlexItem,{style:{maxWidth:"100%"},grow:a},Object(O.jsx)(P.a,s()({showNewMenuTour:!0},e.dataViewPickerComponentProps,{trigger:{fullWidth:a,...e.dataViewPickerComponentProps.trigger}})))}(),Object(O.jsx)(y.EuiFlexItem,{grow:!ie(),style:{minWidth:ie()?"auto":320}},Object(O.jsx)(y.EuiFlexGroup,{gutterSize:"s",responsive:!1},!ne()&&oe(),re()&&Object(O.jsx)(y.EuiFlexItem,{"data-test-subj":"unifiedQueryInput"},Object(O.jsx)(T,{disableAutoFocus:e.disableAutoFocus,indexPatterns:e.indexPatterns,query:e.query,screenTitle:e.screenTitle,onChange:J,onChangeQueryInputFocus:X,onSubmit:ae,persistedLog:L,dataTestSubj:e.dataTestSubj,placeholder:e.placeholder,isClearable:e.isClearable,iconType:e.iconType,nonKqlMode:e.nonKqlMode,timeRangeForSuggestionsOverride:e.timeRangeForSuggestionsOverride,disableLanguageSwitcher:!0,prepend:ne()&&oe(),size:e.suggestionsSize})))),ie()&&e.filterBar,function(){if(!Boolean(p)||!Boolean(i||o||c))return null;const t=m.i18n.translate("unifiedSearch.queryBarTopRow.submitButton.update",{defaultMessage:"Needs updating"}),s=m.i18n.translate("unifiedSearch.queryBarTopRow.submitButton.refresh",{defaultMessage:"Refresh query"}),n=e.customSubmitButton?d.a.cloneElement(e.customSubmitButton,{onClick:V}):Object(O.jsx)(y.EuiFlexItem,{grow:!1},Object(O.jsx)(y.EuiSuperUpdateButton,{iconType:e.isDirty?"kqlFunction":"refresh",iconOnly:!r,"aria-label":e.isLoading?t:s,isDisabled:h,isLoading:e.isLoading,onClick:V,size:ie()?"s":"m",color:e.isDirty?"success":"primary",fill:e.isDirty,"data-test-subj":"querySubmitButton",toolTipProps:{content:e.isDirty?t:s,delay:"long",position:"bottom"}}));return se()?Object(O.jsx)(y.EuiFlexItem,{grow:!1},Object(O.jsx)(w,{storage:M,showNoDataPopover:e.indicateNoData},Object(O.jsx)(y.EuiFlexGroup,{alignItems:"center",responsive:!1,gutterSize:"s"},function(){if(!se())return null;const t=l()("kbnQueryBar__datePickerWrapper");return Object(O.jsx)(y.EuiFlexItem,{className:t},Object(O.jsx)(q,{start:e.dateRangeFrom,end:e.dateRangeTo,isPaused:e.isRefreshPaused,refreshInterval:e.refreshInterval,onTimeChange:Z,onRefresh:te,onRefreshChange:e.onRefreshChange,showUpdateButton:!1,recentlyUsedRanges:Y,commonlyUsedRanges:G,dateFormat:E.get("dateFormat"),isAutoRefreshOnly:c,className:"kbnQueryBar__datePicker",isQuickSelectOnly:!a&&x,width:a?"full":"auto",compressed:ie()}))}(),n))):n}()),!ie()&&e.filterBar))}),(({query:e,...t},{query:a,...r})=>{let s=!0;return e!==a&&(p()(e,a)||(s=!1)),s&&Object(B.a)(t,r)}));t.default=E},99:function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(100);case"v8light":return a(102)}}}]);