(window.unifiedSearch_bundle_jsonpfunction=window.unifiedSearch_bundle_jsonpfunction||[]).push([[5],{47:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(1),o=n.n(r),a=n(44),i=n(14),s=n(6),u=n(15),c=n(36),l=n(64),d=n(50),p=n(0);const f=o.a.memo((function({indexPatterns:e,filters:t,timeRangeForSuggestionsOverride:n,closePopover:o,onFiltersUpdated:f}){const b=Object(s.useKibana)(),{uiSettings:g,data:j,usageCollection:m,appName:O}=b.services,y=null==m?void 0:m.reportUiCounter.bind(m,O),[v,h]=Object(r.useState)([]),[x,S]=Object(r.useState)(void 0),F=g.get(u.UI_SETTINGS.FILTERS_PINNED_BY_DEFAULT);return Object(r.useEffect)((()=>{e&&(async()=>{const t=null==e?void 0:e.filter((e=>"string"==typeof e)),n=null==e?void 0:e.filter((e=>"string"!=typeof e)),r=await Object(d.a)(j.dataViews,t);h([...n,...r]);const[o]=[...n,...r],i=o&&o.id,s=Object(a.buildEmptyFilter)(F,i);S(s)})()}),[j.dataViews,e,F]),Object(p.jsx)("div",{style:{width:c.FILTER_EDITOR_WIDTH,maxWidth:"100%"}},x&&Object(p.jsx)(l.a,{filter:x,indexPatterns:v,onSubmit:function(e){null==y||y(i.METRIC_TYPE.CLICK,"filter:added"),null==o||o();const n=[...t,e];null==f||f(n)},onCancel:()=>null==o?void 0:o(),key:JSON.stringify(x),timeRangeForSuggestionsOverride:n,mode:"add"}))}))},49:function(e,t,n){"use strict";e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var r,o,a;if(Array.isArray(t)){if((r=t.length)!=n.length)return!1;for(o=r;0!=o--;)if(!e(t[o],n[o]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((r=(a=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(o=r;0!=o--;)if(!Object.prototype.hasOwnProperty.call(n,a[o]))return!1;for(o=r;0!=o--;){var i=a[o];if(!e(t[i],n[i]))return!1}return!0}return t!=t&&n!=n}},57:function(e,t,n){switch(window.__kbnThemeTag__){case"v8dark":return n(58);case"v8light":return n(60)}},58:function(e,t,n){var r=n(21),o=n(59);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);r(o,{insert:"head",singleton:!1}),e.exports=o.locals||{}},59:function(e,t,n){(t=n(22)(!1)).push([e.i,".kbnQueryBar__datePickerWrapper .euiDatePopoverButton-isInvalid{background-image:linear-gradient(to top, #F86B63, #F86B63 2px, transparent 2px, transparent 100%)}.kbnQueryBar__datePickerWrapper .euiDatePopoverButton-isInvalid:focus{color:#DFE5EF;background-color:#16171c;background-image:linear-gradient(to top, #36A2EF, #36A2EF 2px, transparent 2px, transparent 100%)}\n",""]),e.exports=t},60:function(e,t,n){var r=n(21),o=n(61);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);r(o,{insert:"head",singleton:!1}),e.exports=o.locals||{}},61:function(e,t,n){(t=n(22)(!1)).push([e.i,".kbnQueryBar__datePickerWrapper .euiDatePopoverButton-isInvalid{background-image:linear-gradient(to top, #BD271E, #BD271E 2px, transparent 2px, transparent 100%)}.kbnQueryBar__datePickerWrapper .euiDatePopoverButton-isInvalid:focus{color:#343741;background-color:#fbfcfd;background-image:linear-gradient(to top, #07C, #07C 2px, transparent 2px, transparent 100%)}\n",""]),e.exports=t},62:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(37),o=n(1),a=r.__importDefault(n(63));t.default=function(e,t){var n=o.useState(t),r=n[0],i=n[1];return a.default((function(){var t=e.subscribe(i);return function(){return t.unsubscribe()}}),[e]),r}},63:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o="undefined"!=typeof window?r.useLayoutEffect:r.useEffect;t.default=o},73:function(e,t,n){"use strict";n.r(t),n.d(t,"QueryBarTopRow",(function(){return C}));var r=n(9),o=n.n(r),a=n(18),i=n.n(a),s=n(35),u=n.n(s),c=n(1),l=n.n(c),d=n(49),p=n.n(d),f=n(62),b=n.n(f),g=n(13),j=n(25),m=n(3),O=n(10),y=n(5),v=n(6),h=n(15),x=n(72),S=n(0);const F="data.noDataPopover";function E({showNoDataPopover:e,storage:t,children:n}){const[r,o]=Object(c.useState)((()=>Boolean(t.get(F)))),[a,i]=Object(c.useState)(!1);return Object(c.useEffect)((()=>{e&&!r&&i(!0)}),[r,e]),Object(S.jsx)(m.EuiTourStep,{onFinish:()=>{},closePopover:()=>{i(!1)},content:Object(S.jsx)(m.EuiText,{size:"s"},Object(S.jsx)("p",{style:{maxWidth:300}},y.i18n.translate("unifiedSearch.noDataPopover.content",{defaultMessage:"This time range doesn't contain any data. Increase or adjust the time range to see more fields and create charts."}))),minWidth:300,anchorPosition:"downCenter",anchorClassName:"eui-displayBlock",step:1,stepsTotal:1,isStepOpen:a,subtitle:y.i18n.translate("unifiedSearch.noDataPopover.subtitle",{defaultMessage:"Tip"}),title:y.i18n.translate("unifiedSearch.noDataPopover.title",{defaultMessage:"Empty dataset"}),footerAction:Object(S.jsx)(m.EuiButtonEmpty,{size:"xs",flush:"right",color:"text","data-test-subj":"noDataPopoverDismissButton",onClick:()=>{t.set(F,!0),o(!0),i(!1)}},y.i18n.translate("unifiedSearch.noDataPopover.dismissAction",{defaultMessage:"Don't show again"}))},Object(S.jsx)("div",{onFocus:()=>{i(!1)}},n))}var P=n(46),w=n(47);const B=l.a.memo((function({indexPatterns:e,filters:t,timeRangeForSuggestionsOverride:n,onFiltersUpdated:r,buttonProps:a}){const[i,s]=Object(c.useState)(!1),u=y.i18n.translate("unifiedSearch.filter.filterBar.addFilterButtonLabel",{defaultMessage:"Add filter"}),l=Object(S.jsx)(m.EuiToolTip,{delay:"long",content:u},Object(S.jsx)(m.EuiButtonIcon,o()({display:"base",iconType:"plusInCircleFilled","aria-label":u,"data-test-subj":"addFilter",onClick:()=>s(!i),size:"m"},a)));return Object(S.jsx)(m.EuiFlexItem,{grow:!1},Object(S.jsx)(m.EuiPopover,{id:"addFilterPopover",button:l,isOpen:i,closePopover:()=>s(!1),anchorPosition:"downLeft",panelPaddingSize:"none",initialFocus:".filterEditor__hiddenItem",ownFocus:!0,repositionOnScroll:!0},Object(S.jsx)(w.a,{indexPatterns:e,filters:t,timeRangeForSuggestionsOverride:n,onFiltersUpdated:r,closePopover:()=>s(!1)})))}));var k=n(24),I=n(51);n(57);const T=l.a.memo(m.EuiSuperDatePicker),_=Object(v.withKibana)(x.default),R=l.a.memo((function({from:e,to:t,dateFormat:n}){function r(e,t=!1){const n=i.a.parse(e,{roundUp:t});return n?n.toISOString():e}const o=Object(m.usePrettyDuration)({timeFrom:r(e),timeTo:r(t),quickRanges:[],dateFormat:n});return Object(S.jsx)("div",{"data-shared-timefilter-duration":o,"data-test-subj":"dataSharedTimefilterDuration"})})),C=l.a.memo((function(e){var t;const n=Object(m.useIsWithinBreakpoints)(["xs","s"]),[r,a]=Object(c.useState)(!1);Object(c.useEffect)((()=>{function e(){a(window.innerWidth>=1440)}return window.removeEventListener("resize",e),window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)}),[]);const{showQueryInput:i=!0,showDatePicker:s=!0,showAutoRefreshOnly:d=!1,showSubmitButton:p=!0}=e,[f,x]=Object(c.useState)(!1),[F,P]=Object(c.useState)(!1),w=Object(v.useKibana)(),{uiSettings:C,storage:D,appName:q}=w.services,M=e.query&&e.query.language,A=Object(c.useRef)(e.query);A.current=e.query;const N=l.a.useMemo((()=>M&&C&&D&&q?Object(O.getQueryLog)(C,D,q,M):void 0),[q,M,C,D]),L=function(){const t=C.get(h.UI_SETTINGS.TIMEPICKER_TIME_DEFAULTS);return{from:e.dateRangeFrom||t.from,to:e.dateRangeTo||t.to}}(),U=Object(c.useRef)(L);U.current=L;const z=e.onSubmit,Q=e=>e.map((({from:e,to:t})=>({start:e,end:t}))),W=e.timeHistory,K=Object(c.useMemo)((()=>{var e;return null!==(e=null==W?void 0:W.get$().pipe(Object(j.map)(Q)))&&void 0!==e?e:g.EMPTY}),[W]),G=b()(K,Q(null!==(t=null==W?void 0:W.get())&&void 0!==t?t:[])),[V]=Object(c.useState)((()=>{var e,t;return null!==(e=null==C||null===(t=C.get(h.UI_SETTINGS.TIMEPICKER_QUICK_RANGES))||void 0===t?void 0:t.map((({from:e,to:t,display:n})=>({start:e,end:t,label:n}))))&&void 0!==e?e:[]})),Y=Object(c.useCallback)((({query:e,dateRange:t})=>{W&&W.add(t),z({query:e,dateRange:t})}),[W,z]),H=Object(c.useCallback)((e=>{N&&A.current&&N.add(A.current.query),e.preventDefault(),Y({query:A.current,dateRange:U.current})}),[N,Y]),J=e.onChange,$=Object(c.useCallback)((e=>J({query:e,dateRange:U.current})),[J]),X=Object(c.useCallback)((e=>{P(e)}),[]),Z=Object(c.useCallback)((({start:e,end:t,isInvalid:n,isQuickSelection:r})=>{x(n);const o={query:A.current,dateRange:{from:e,to:t}};r?Y(o):J(o)}),[J,Y]),ee=e.onRefresh,te=Object(c.useCallback)((({start:e,end:t})=>{ee&&ee({dateRange:{from:e,to:t}})}),[ee]),ne=Object(c.useCallback)((e=>{Y({query:e,dateRange:U.current})}),[Y]);function re(){return Boolean(i&&e.indexPatterns&&e.query&&D)}function oe(){return Boolean(s||d)}function ae(){return!Boolean(e.showAddFilter)&&Boolean(e.prepend)}function ie(){return Boolean(e.showDatePickerAsBadge)&&!re()}function se(){return(Boolean(e.showAddFilter)||Boolean(e.prepend))&&Object(S.jsx)(m.EuiFlexItem,{grow:!1},Object(S.jsx)(I.a,{items:[e.prepend,Boolean(e.showAddFilter)&&Object(S.jsx)(m.EuiFlexItem,{grow:!1},Object(S.jsx)(B,{indexPatterns:e.indexPatterns,filters:e.filters,timeRangeForSuggestionsOverride:e.timeRangeForSuggestionsOverride,onFiltersUpdated:e.onFiltersUpdated,buttonProps:{size:ie()?"s":"m",display:"empty"}}))],attached:ae(),size:ie()?"s":"m"}))}const ue=!0===e.isScreenshotMode;return Object(S.jsx)(l.a.Fragment,null,Object(S.jsx)(R,{from:L.from,to:L.to,dateFormat:C.get("dateFormat")}),!ue&&Object(S.jsx)(l.a.Fragment,null,Object(S.jsx)(m.EuiFlexGroup,{className:"kbnQueryBar",direction:n&&!ie()?"column":"row",responsive:!1,gutterSize:"s",justifyContent:ie()?"flexStart":"flexEnd",wrap:!0},function(){if(e.dataViewPickerComponentProps)return Object(S.jsx)(m.EuiFlexItem,{style:{maxWidth:"100%"},grow:n},Object(S.jsx)(k.a,o()({showNewMenuTour:!0},e.dataViewPickerComponentProps,{trigger:{fullWidth:n,...e.dataViewPickerComponentProps.trigger}})))}(),Object(S.jsx)(m.EuiFlexItem,{grow:!ie(),style:{minWidth:ie()?"auto":320}},Object(S.jsx)(m.EuiFlexGroup,{gutterSize:"s",responsive:!1},!ae()&&se(),re()&&Object(S.jsx)(m.EuiFlexItem,{"data-test-subj":"unifiedQueryInput"},Object(S.jsx)(_,{disableAutoFocus:e.disableAutoFocus,indexPatterns:e.indexPatterns,query:e.query,screenTitle:e.screenTitle,onChange:$,onChangeQueryInputFocus:X,onSubmit:ne,persistedLog:N,dataTestSubj:e.dataTestSubj,placeholder:e.placeholder,isClearable:e.isClearable,iconType:e.iconType,nonKqlMode:e.nonKqlMode,timeRangeForSuggestionsOverride:e.timeRangeForSuggestionsOverride,disableLanguageSwitcher:!0,prepend:ae()&&se(),size:e.suggestionsSize})))),ie()&&e.filterBar,function(){if(!Boolean(p)||!Boolean(i||s||d))return null;const t=y.i18n.translate("unifiedSearch.queryBarTopRow.submitButton.update",{defaultMessage:"Needs updating"}),o=y.i18n.translate("unifiedSearch.queryBarTopRow.submitButton.refresh",{defaultMessage:"Refresh query"}),a=e.customSubmitButton?l.a.cloneElement(e.customSubmitButton,{onClick:H}):Object(S.jsx)(m.EuiFlexItem,{grow:!1},Object(S.jsx)(m.EuiSuperUpdateButton,{iconType:e.isDirty?"kqlFunction":"refresh",iconOnly:!r,"aria-label":e.isLoading?t:o,isDisabled:f,isLoading:e.isLoading,onClick:H,size:ie()?"s":"m",color:e.isDirty?"success":"primary",fill:e.isDirty,"data-test-subj":"querySubmitButton",toolTipProps:{content:e.isDirty?t:o,delay:"long",position:"bottom"}}));return oe()?Object(S.jsx)(m.EuiFlexItem,{grow:!1},Object(S.jsx)(E,{storage:D,showNoDataPopover:e.indicateNoData},Object(S.jsx)(m.EuiFlexGroup,{alignItems:"center",responsive:!1,gutterSize:"s"},function(){if(!oe())return null;const t=u()("kbnQueryBar__datePickerWrapper");return Object(S.jsx)(m.EuiFlexItem,{className:t},Object(S.jsx)(T,{start:e.dateRangeFrom,end:e.dateRangeTo,isPaused:e.isRefreshPaused,refreshInterval:e.refreshInterval,onTimeChange:Z,onRefresh:te,onRefreshChange:e.onRefreshChange,showUpdateButton:!1,recentlyUsedRanges:G,commonlyUsedRanges:V,dateFormat:C.get("dateFormat"),isAutoRefreshOnly:d,className:"kbnQueryBar__datePicker",isQuickSelectOnly:!n&&F,width:n?"full":"auto",compressed:ie()}))}(),a))):a}()),!ie()&&e.filterBar))}),(({query:e,...t},{query:n,...r})=>{let o=!0;return e!==n&&(p()(e,n)||(o=!1)),o&&Object(P.a)(t,r)}));t.default=C}}]);