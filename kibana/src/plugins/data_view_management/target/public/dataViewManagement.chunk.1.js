(window.dataViewManagement_bundle_jsonpfunction=window.dataViewManagement_bundle_jsonpfunction||[]).push([[1],Array(22).concat([function(e,t,a){"use strict";a.r(t),a.d(t,"mountManagementSection",(function(){return Rn}));var n={};a.r(n),a.d(n,"buildNode",(function(){return Xt})),a.d(n,"toElasticsearchQuery",(function(){return ea}));var i={};a.r(i),a.d(i,"wildcardSymbol",(function(){return ta})),a.d(i,"buildNode",(function(){return ia})),a.d(i,"test",(function(){return sa})),a.d(i,"toElasticsearchQuery",(function(){return ra})),a.d(i,"toQueryStringQuery",(function(){return la})),a.d(i,"hasLeadingWildcard",(function(){return da}));var s={};a.r(s),a.d(s,"buildNodeParams",(function(){return ma})),a.d(s,"toElasticsearchQuery",(function(){return ba}));var r={};a.r(r),a.d(r,"buildNodeParams",(function(){return ja})),a.d(r,"toElasticsearchQuery",(function(){return ha}));var l={};a.r(l),a.d(l,"buildNodeParams",(function(){return xa})),a.d(l,"toElasticsearchQuery",(function(){return va}));var d={};a.r(d),a.d(d,"buildNodeParams",(function(){return Oa})),a.d(d,"toElasticsearchQuery",(function(){return ya}));var o={};a.r(o),a.d(o,"buildNodeParams",(function(){return Ma})),a.d(o,"toElasticsearchQuery",(function(){return Fa}));var c={};a.r(c),a.d(c,"buildNodeParams",(function(){return Pa})),a.d(c,"toElasticsearchQuery",(function(){return Ea}));var u={};a.r(u),a.d(u,"buildNodeParams",(function(){return Ta})),a.d(u,"toElasticsearchQuery",(function(){return Sa}));var p={};a.r(p),a.d(p,"buildNode",(function(){return Ca})),a.d(p,"buildNodeWithArgumentNodes",(function(){return Ia})),a.d(p,"toElasticsearchQuery",(function(){return La}));var f=a(5),g=a.n(f),m=a(15),b=a.n(m),j=a(12),h=a(0),x=a(9),v=a(10),O=a(7);const y=h.i18n.translate("indexPatternManagement.editIndexPattern.list.defaultIndexPatternListName",{defaultMessage:"Default"}),M=h.i18n.translate("indexPatternManagement.editIndexPattern.list.rollupIndexPatternListName",{defaultMessage:"Rollup"}),F=(e="")=>"rollup"===e,P=(e,t)=>{const a=[];return t&&a.push({key:"default",name:y}),F(e.type)&&a.push({key:"rollup",name:M}),a},E=(e,t)=>{var a;if(!F(e.type))return[];const n=null===(a=e.typeMeta)||void 0===a?void 0:a.aggs,i=n&&Object.keys(n).filter((e=>n[e][t.name]));return i&&i.length?["Rollup aggregations:"].concat(i.map((e=>{const a=n[e][t.name];switch(e){case"date_histogram":return h.i18n.translate("indexPatternManagement.editIndexPattern.list.dateHistogramSummary",{defaultMessage:"{aggName} (interval: {interval}, {delay} {time_zone})",values:{aggName:e,interval:a.fixed_interval,delay:a.delay?h.i18n.translate("indexPatternManagement.editIndexPattern.list.DateHistogramDelaySummary",{defaultMessage:"delay: {delay},",values:{delay:a.delay}}):"",time_zone:a.time_zone}});case"histogram":return h.i18n.translate("indexPatternManagement.editIndexPattern.list.histogramSummary",{defaultMessage:"{aggName} (interval: {interval})",values:{aggName:e,interval:a.interval}});default:return e}}))):[]};function T(){return[{text:h.i18n.translate("indexPatternManagement.dataViews.listBreadcrumb",{defaultMessage:"Data views"}),href:"/"}]}function S(e){return[...T(),{text:e.title,href:`/patterns/${e.id}`}]}var w=a(25),C=a.n(w),I=a(13),L=a(6);const D=h.i18n.translate("indexPatternManagement.indexPatternTable.savedObjectName",{defaultMessage:"data view"}),A=({spacesApi:e,capabilities:t,spaceIds:a,id:n,title:i,refresh:s})=>{const[r,l]=Object(f.useState)(!1),d=e.ui.components.getSpaceList,o=e.ui.components.getShareToSpaceFlyout,c={savedObjectTarget:{type:I.DATA_VIEW_SAVED_OBJECT_TYPE,namespaces:a,id:n,title:i,noun:D},onUpdate:s,onClose:function(){l(!1)}},u=!t||t.savedObjectsManagement.shareIntoSpace?{cursorStyle:"pointer",listOnClick:()=>l(!0)}:{cursorStyle:"not-allowed"};return Object(L.jsx)(g.a.Fragment,null,Object(L.jsx)(d,C()({namespaces:a,displayLimit:8,behaviorContext:"outside-space"},u)),r&&Object(L.jsx)(o,c))};var _=a(14),N=a(16);const k="indexedFields",R="scriptedFields",B="sourceFilters",V="relationships";var U=a(23),q=a.n(U),H=a(29);const z=h.i18n.translate("indexPatternManagement.editIndexPattern.sourcePlaceholder",{defaultMessage:"field filter, accepts wildcards (e.g., `user*` to filter fields starting with 'user')"}),G=({onAddFilter:e})=>{const[t,a]=Object(f.useState)(""),n=Object(f.useCallback)((()=>{e(t),a("")}),[t,e]);return Object(L.jsx)(O.EuiFlexGroup,null,Object(L.jsx)(O.EuiFlexItem,{grow:10},Object(L.jsx)(O.EuiFieldText,{fullWidth:!0,value:t,onChange:e=>a(e.target.value.trim()),placeholder:z})),Object(L.jsx)(O.EuiFlexItem,null,Object(L.jsx)(O.EuiButton,{isDisabled:0===t.length,onClick:n},Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.source.addButtonLabel",defaultMessage:"Add"}))))},W=({filterToDeleteValue:e,onCancelConfirmationModal:t,onDeleteFilter:a})=>Object(L.jsx)(O.EuiConfirmModal,{title:Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.source.deleteSourceFilterLabel",defaultMessage:"Delete field filter '{value}'?",values:{value:e}}),onCancel:t,onConfirm:a,cancelButtonText:Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.source.deleteFilter.cancelButtonLabel",defaultMessage:"Cancel"}),buttonColor:"danger",confirmButtonText:Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.source.deleteFilter.deleteButtonLabel",defaultMessage:"Delete"}),defaultFocusedButton:O.EUI_MODAL_CONFIRM_BUTTON}),K=()=>Object(L.jsx)(g.a.Fragment,null,Object(L.jsx)(O.EuiText,{size:"s"},Object(L.jsx)("p",null,Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.sourceLabel",defaultMessage:"Field filters can be used to exclude one or more fields when fetching a document. This happens when viewing a document in the Discover app, or with a table displaying results from a saved search in the Dashboard app. If you have documents with large or unimportant fields you may benefit from filtering those out at this lower level."})),Object(L.jsx)("p",null,Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.source.noteLabel",defaultMessage:"Note that multi-fields will incorrectly appear as matches in the table below. These filters only actually apply to fields in the original source document, so matching multi-fields are not actually being filtered."}))),Object(L.jsx)(O.EuiSpacer,{size:"s"})),$=h.i18n.translate("indexPatternManagement.editIndexPattern.source.table.filterHeader",{defaultMessage:"Filter"}),Q=h.i18n.translate("indexPatternManagement.editIndexPattern.source.table.filterDescription",{defaultMessage:"Filter name"}),Y=h.i18n.translate("indexPatternManagement.editIndexPattern.source.table.matchesHeader",{defaultMessage:"Matches"}),J=h.i18n.translate("indexPatternManagement.editIndexPattern.source.table.matchesDescription",{defaultMessage:"Language used for the field"}),Z=h.i18n.translate("indexPatternManagement.editIndexPattern.source.table.editAria",{defaultMessage:"Edit"}),X=h.i18n.translate("indexPatternManagement.editIndexPattern.source.table.saveAria",{defaultMessage:"Save"}),ee=h.i18n.translate("indexPatternManagement.editIndexPattern.source.table.deleteAria",{defaultMessage:"Delete"}),te=h.i18n.translate("indexPatternManagement.editIndexPattern.source.table.cancelAria",{defaultMessage:"Cancel"});class table_Table extends f.Component{constructor(e){super(e),q()(this,"startEditingFilter",((e,t)=>this.setState({editingFilterId:e,editingFilterValue:t}))),q()(this,"stopEditingFilter",(()=>this.setState({editingFilterId:""}))),q()(this,"onEditingFilterChange",(e=>this.setState({editingFilterValue:e.target.value}))),q()(this,"onEditFieldKeyDown",(({key:e})=>{O.keys.ENTER===e&&this.state.editingFilterId&&this.state.editingFilterValue&&(this.props.saveFilter({clientId:this.state.editingFilterId,value:this.state.editingFilterValue}),this.stopEditingFilter()),O.keys.ESCAPE===e&&this.stopEditingFilter()})),this.state={editingFilterId:"",editingFilterValue:""}}getColumns(){const{deleteFilter:e,fieldWildcardMatcher:t,indexPattern:a,saveFilter:n}=this.props;return[{field:"value",name:$,description:Q,dataType:"string",sortable:!0,render:(e,t)=>this.state.editingFilterId&&this.state.editingFilterId===t.clientId?Object(L.jsx)(O.EuiFieldText,{autoFocus:!0,value:this.state.editingFilterValue,onChange:this.onEditingFilterChange,onKeyDown:this.onEditFieldKeyDown}):Object(L.jsx)("span",null,e)},{field:"value",name:Y,description:J,dataType:"string",sortable:!0,render:(e,n)=>{const i=t([this.state.editingFilterId===n.clientId?this.state.editingFilterValue:e]),s=a.getNonScriptedFields().map((e=>e.name)).filter(i).sort();return s.length?Object(L.jsx)("span",null,s.join(", ")):Object(L.jsx)("em",null,Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.source.table.notMatchedLabel",defaultMessage:"The source filter doesn't match any known fields."}))}},{name:"",align:O.RIGHT_ALIGNMENT,width:"100",render:t=>this.state.editingFilterId===t.clientId?Object(L.jsx)(g.a.Fragment,null,Object(L.jsx)(O.EuiButtonIcon,{size:"s",onClick:()=>{n({clientId:this.state.editingFilterId,value:this.state.editingFilterValue}),this.stopEditingFilter()},iconType:"checkInCircleFilled","aria-label":X}),Object(L.jsx)(O.EuiButtonIcon,{size:"s",onClick:()=>{this.stopEditingFilter()},iconType:"cross","aria-label":te})):Object(L.jsx)(g.a.Fragment,null,Object(L.jsx)(O.EuiButtonIcon,{size:"s",onClick:()=>this.startEditingFilter(t.clientId,t.value),iconType:"pencil","aria-label":Z}),Object(L.jsx)(O.EuiButtonIcon,{size:"s",color:"danger",onClick:()=>e(t),iconType:"trash","aria-label":ee}))}]}render(){const{items:e,isSaving:t}=this.props,a=this.getColumns();return Object(L.jsx)(O.EuiInMemoryTable,{loading:t,items:e,columns:a,pagination:{initialPageSize:10,pageSizeOptions:[5,10,25,50]},sorting:!0})}}class source_filters_table_SourceFiltersTable extends f.Component{constructor(e){super(e),q()(this,"clientSideId",0),q()(this,"updateFilters",(()=>{const e=(this.props.indexPattern.sourceFilters||[]).map((e=>({...e,clientId:++this.clientSideId})));this.setState({filters:e})})),q()(this,"getFilteredFilters",Object(H.createSelector)((e=>e.filters),((e,t)=>t.filterFilter),((e,t)=>{if(t){const a=t.toLowerCase();return e.filter((e=>e.value.toLowerCase().includes(a)))}return e}))),q()(this,"startDeleteFilter",(e=>{this.setState({filterToDelete:e,isDeleteConfirmationModalVisible:!0})})),q()(this,"hideDeleteConfirmationModal",(()=>{this.setState({filterToDelete:void 0,isDeleteConfirmationModalVisible:!1})})),q()(this,"deleteFilter",(async()=>{const{indexPattern:e,onAddOrRemoveFilter:t,saveIndexPattern:a}=this.props,{filterToDelete:n,filters:i}=this.state;e.sourceFilters=i.filter((e=>e.clientId!==n.clientId)),this.setState({isSaving:!0}),await a(e),t&&t(),this.updateFilters(),this.setState({isSaving:!1}),this.hideDeleteConfirmationModal()})),q()(this,"onAddFilter",(async e=>{const{indexPattern:t,onAddOrRemoveFilter:a,saveIndexPattern:n}=this.props;t.sourceFilters=[...t.sourceFilters||[],{value:e}],this.setState({isSaving:!0}),await n(t),a&&a(),this.updateFilters(),this.setState({isSaving:!1})})),q()(this,"saveFilter",(async({clientId:e,value:t})=>{const{indexPattern:a,saveIndexPattern:n}=this.props,{filters:i}=this.state;a.sourceFilters=i.map((a=>a.clientId===e?{value:t,clientId:e}:a)),this.setState({isSaving:!0}),await n(a),this.updateFilters(),this.setState({isSaving:!1})})),this.state={filterToDelete:void 0,isDeleteConfirmationModalVisible:!1,isSaving:!1,filters:[]}}UNSAFE_componentWillMount(){this.updateFilters()}render(){const{indexPattern:e,fieldWildcardMatcher:t}=this.props,{isSaving:a,filterToDelete:n}=this.state,i=this.getFilteredFilters(this.state,this.props);return Object(L.jsx)(g.a.Fragment,null,Object(L.jsx)(K,null),Object(L.jsx)(G,{onAddFilter:this.onAddFilter}),Object(L.jsx)(O.EuiSpacer,{size:"l"}),Object(L.jsx)(table_Table,{isSaving:a,indexPattern:e,items:i,fieldWildcardMatcher:t,deleteFilter:this.startDeleteFilter,saveFilter:this.saveFilter}),n&&Object(L.jsx)(W,{filterToDeleteValue:n.value,onCancelConfirmationModal:this.hideDeleteConfirmationModal,onDeleteFilter:this.deleteFilter}))}}const ae=e=>{var t;return!e.isMapped&&e.isUserEditable&&"composite"!==(null===(t=e.runtimeField)||void 0===t?void 0:t.type)},ne=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.additionalInfoAriaLabel",{defaultMessage:"Additional field information"}),ie=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.conflictDetailIconAria",{defaultMessage:"Conflict Detail"}),se=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.primaryTimeAriaLabel",{defaultMessage:"Primary time field"}),re=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.primaryTimeTooltip",{defaultMessage:"This field represents the time that events occurred."}),le=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.nameHeader",{defaultMessage:"Name"}),de=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.typeHeader",{defaultMessage:"Type"}),oe=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.formatHeader",{defaultMessage:"Format"}),ce=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.searchableHeader",{defaultMessage:"Searchable"}),ue=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.searchableDescription",{defaultMessage:"These fields can be used in the filter bar"}),pe=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.isSearchableAria",{defaultMessage:"Is searchable"}),fe=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.aggregatableLabel",{defaultMessage:"Aggregatable"}),ge=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.aggregatableDescription",{defaultMessage:"These fields can be used in visualization aggregations"}),me=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.isAggregatableAria",{defaultMessage:"Is aggregatable"}),be=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.excludedLabel",{defaultMessage:"Excluded"}),je=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.excludedDescription",{defaultMessage:"Fields that are excluded from _source when it is fetched"}),he=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.isExcludedAria",{defaultMessage:"Is excluded"}),xe=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.editLabel",{defaultMessage:"Edit"}),ve=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.editDescription",{defaultMessage:"Edit"}),Oe=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.deleteLabel",{defaultMessage:"Delete"}),ye=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.deleteDescription",{defaultMessage:"Delete"}),Me=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.customLabelTooltip",{defaultMessage:"A custom label for the field."}),Fe=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.runtimeIconTipTitle",{defaultMessage:"Runtime field"}),Pe=h.i18n.translate("indexPatternManagement.editDataView.fields.table.runtimeIconTipText",{defaultMessage:"This field exists on the data view only."}),Ee=h.i18n.translate("indexPatternManagement.editDataView.fields.table.conflictType",{defaultMessage:"Conflict"}),Te=e=>{const t=[];return Object.keys(e).forEach((a=>{t.push({type:a,indices:e[a].slice(0,99).join(", ")})})),t},Se=[{field:"type",name:h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.conflictModalTypeColumn",{defaultMessage:"Type"})},{field:"indices",name:h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.conflictModalIndicesColumn",{defaultMessage:"Indices"})}];class table_table_Table extends f.PureComponent{renderBooleanTemplate(e,t){return e?Object(L.jsx)(O.EuiIcon,{type:"dot",color:"success","aria-label":t}):Object(L.jsx)("span",null)}renderFieldType(e,t){const a=t.conflictDescriptions&&t.conflictDescriptions[t.name];return Object(L.jsx)("span",null,"conflict"===e&&a?"":e,t.conflictDescriptions?((e,t,a,n)=>{const i=()=>{const i=a(Object(v.toMountPoint)((({closeFn:e,fieldName:t,conflictDescriptions:a})=>Object(L.jsx)(g.a.Fragment,null,Object(L.jsx)(O.EuiModalHeader,null,Object(L.jsx)(O.EuiModalHeaderTitle,null,Object(L.jsx)("h1",null,Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.fields.conflictModal.title",defaultMessage:"This field has a type conflict"})))),Object(L.jsx)(O.EuiModalBody,null,Object(L.jsx)(O.EuiText,null,Object(L.jsx)("p",null,Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.fields.conflictModal.description",defaultMessage:"The type of the {fieldName} field changes across indices and might not be available for search, visualizations, and other analysis.",values:{fieldName:Object(L.jsx)(O.EuiCode,null,t)}})),Object(L.jsx)(O.EuiBasicTable,{tableCaption:"Demo of EuiBasicTable",items:Te(a),rowHeader:"firstName",columns:Se,tableLayout:"auto"}))),Object(L.jsx)(O.EuiModalFooter,null,Object(L.jsx)(O.EuiButton,{onClick:e,fill:!0},Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.fields.conflictModal.closeBtn",defaultMessage:"Close"})))))({closeFn:()=>{i.close()},fieldName:e,conflictDescriptions:t}),{theme$:n.theme$}))};return Object(L.jsx)("span",null,Object(L.jsx)(O.EuiBadge,{color:"warning",iconType:"alert",onClick:i,iconOnClick:i,iconOnClickAriaLabel:ie,onClickAriaLabel:ie},Ee))})(t.name,t.conflictDescriptions,this.props.openModal,this.props.theme):"")}render(){const{items:e,editField:t,deleteField:a,indexPattern:n}=this.props,i=[{field:"displayName",name:le,dataType:"string",sortable:!0,render:(e,t)=>((e,t)=>Object(L.jsx)("span",null,e.name,e.info&&e.info.length?Object(L.jsx)("span",null," ",Object(L.jsx)(O.EuiIconTip,{type:"questionInCircle",color:"primary","aria-label":ne,content:e.info.map(((e,t)=>Object(L.jsx)("div",{key:t},e)))})):null,t===e.name?Object(L.jsx)("span",null," ",Object(L.jsx)(O.EuiIconTip,{type:"clock",color:"primary","aria-label":se,content:re})):null,!e.isMapped&&e.hasRuntime?Object(L.jsx)("span",null," ",Object(L.jsx)(O.EuiIconTip,{type:"indexRuntime",title:Fe,content:Object(L.jsx)("span",null,Pe)})):null,e.customLabel&&e.customLabel!==e.name?Object(L.jsx)("div",null,Object(L.jsx)(O.EuiToolTip,{content:Me},Object(L.jsx)(O.EuiBadge,{iconType:"flag",iconSide:"left"},e.customLabel))):null))(t,n.timeFieldName),width:"38%","data-test-subj":"indexedFieldName"},{field:"type",name:de,dataType:"string",sortable:!0,render:(e,t)=>this.renderFieldType(e,t),"data-test-subj":"indexedFieldType"},{field:"format",name:oe,dataType:"string",sortable:!0},{field:"searchable",name:ce,description:ue,dataType:"boolean",sortable:!0,render:e=>this.renderBooleanTemplate(e,pe)},{field:"aggregatable",name:fe,description:ge,dataType:"boolean",sortable:!0,render:e=>this.renderBooleanTemplate(e,me)},{field:"excluded",name:be,description:je,dataType:"boolean",sortable:!0,render:e=>this.renderBooleanTemplate(e,he)},{name:"",actions:[{name:xe,description:ve,icon:"pencil",onClick:t,type:"icon","data-test-subj":"editFieldFormat",available:e=>e.isUserEditable}],width:"40px"},{name:"",actions:[{name:Oe,description:ye,icon:"trash",onClick:e=>a(e.name),type:"icon","data-test-subj":"deleteField",available:ae}],width:"40px"}];return Object(L.jsx)(O.EuiInMemoryTable,{items:e,columns:i,pagination:{initialPageSize:10,pageSizeOptions:[5,10,25,50]},sorting:{sort:{field:"displayName",direction:"asc"}}})}}class indexed_fields_table_IndexedFieldsTable extends f.Component{constructor(e){super(e),q()(this,"getFilteredFields",Object(H.createSelector)((e=>e.fields),((e,t)=>t.fieldFilter),((e,t)=>t.indexedFieldTypeFilter),((e,t)=>t.schemaFieldTypeFilter),((e,t,a,n)=>{if(t){const a=t.toLowerCase();e=e.filter((e=>e.name.toLowerCase().includes(a)||e.displayName&&e.displayName.toLowerCase().includes(a)))}return a.length&&(e=e.filter((e=>{var t,n,i;return!(!a.includes("conflict")||"conflict"!==e.kbnType)||!!("runtimeField"in e&&null!==(t=e.runtimeField)&&void 0!==t&&t.type&&a.includes(null===(n=e.runtimeField)||void 0===n?void 0:n.type))||(null===(i=e.esTypes)||void 0===i?void 0:i.length)&&e.esTypes.filter((e=>a.includes(e))).length}))),n.length&&(e=e.filter((e=>n.includes("runtime")&&"runtimeField"in e||n.includes("indexed")&&!("runtimeField"in e)))),e}))),this.state={fields:this.mapFields(this.props.fields)}}UNSAFE_componentWillReceiveProps(e){e.fields!==this.props.fields&&this.setState({fields:this.mapFields(e.fields)})}mapFields(e){const{indexPattern:t,fieldWildcardMatcher:a,helpers:n,userEditPermission:i}=this.props,s=a(t.sourceFilters&&t.sourceFilters.map((e=>e.value))||[]);return e&&e.map((e=>{var a,r,l;return{...e.spec,type:(null===(a=e.esTypes)||void 0===a?void 0:a.join(", "))||"",kbnType:e.type,displayName:e.displayName,format:(null===(r=t.getFormatterForFieldNoDefault(e.name))||void 0===r||null===(l=r.type)||void 0===l?void 0:l.title)||"",excluded:!!s&&s(e.name),info:n.getFieldInfo&&n.getFieldInfo(t,e),isMapped:!!e.isMapped,isUserEditable:i,hasRuntime:!!e.runtimeField}}))||[]}render(){const{indexPattern:e}=this.props,t=this.getFilteredFields(this.state,this.props);return Object(L.jsx)("div",null,Object(L.jsx)(table_table_Table,{indexPattern:e,items:t,editField:e=>this.props.helpers.editField(e.name),deleteField:e=>this.props.helpers.deleteField(e),openModal:this.props.openModal,theme:this.props.theme}))}}var we=a(8),Ce=a.n(we);class components_table_table_Table extends f.PureComponent{constructor(...e){super(...e),q()(this,"renderFormatCell",(e=>{const{indexPattern:t}=this.props,a=Object(we.get)(t,["fieldFormatMap",e,"type","title"],"");return Object(L.jsx)("span",null,a)}))}render(){const{items:e,editField:t,deleteField:a}=this.props,n=[{field:"displayName",name:h.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.nameHeader",{defaultMessage:"Name"}),description:h.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.nameDescription",{defaultMessage:"Name of the field"}),dataType:"string",sortable:!0,width:"38%"},{field:"lang",name:h.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.langHeader",{defaultMessage:"Lang"}),description:h.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.langDescription",{defaultMessage:"Language used for the field"}),dataType:"string",sortable:!0,"data-test-subj":"scriptedFieldLang"},{field:"script",name:h.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.scriptHeader",{defaultMessage:"Script"}),description:h.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.scriptDescription",{defaultMessage:"Script for the field"}),dataType:"string",sortable:!0},{field:"name",name:h.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.formatHeader",{defaultMessage:"Format"}),description:h.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.formatDescription",{defaultMessage:"Format used for the field"}),render:this.renderFormatCell,sortable:!1},{name:"",actions:[{type:"icon",name:h.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.editHeader",{defaultMessage:"Edit"}),description:h.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.editDescription",{defaultMessage:"Edit this field"}),icon:"pencil",onClick:t,available:e=>!!e.isUserEditable},{type:"icon",name:h.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.deleteHeader",{defaultMessage:"Delete"}),description:h.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.deleteDescription",{defaultMessage:"Delete this field"}),icon:"trash",color:"danger",onClick:a,available:e=>!!e.isUserEditable}],width:"40px"}];return Object(L.jsx)(O.EuiInMemoryTable,{items:e,columns:n,pagination:{initialPageSize:10,pageSizeOptions:[5,10,25,50]},sorting:!0})}}const Ie=Object(j.withRouter)((({indexPatternId:e,history:t})=>{const{dataViews:a,docLinks:n}=Object(v.useKibana)().services,i=null==n?void 0:n.links,s=a.getCanSaveSync();return Object(L.jsx)(O.EuiFlexGroup,{alignItems:"center"},Object(L.jsx)(O.EuiFlexItem,null,Object(L.jsx)(O.EuiText,{size:"s"},Object(L.jsx)("p",null,Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.scriptedLabel",defaultMessage:"Scripted fields can be used in visualizations and displayed in documents. However, they cannot be searched."}),Object(L.jsx)("br",null),Object(L.jsx)(O.EuiIcon,{type:"alert",color:"warning",style:{marginRight:"4px"}}),Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.deprecation",defaultMessage:"Scripted fields are deprecated. Use {runtimeDocs} instead.",values:{runtimeDocs:Object(L.jsx)(O.EuiLink,{target:"_blank",href:i.runtimeFields.overview},Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.header.runtimeLink",defaultMessage:"runtime fields"}))}})))),s&&Object(L.jsx)(O.EuiFlexItem,{grow:!1},Object(L.jsx)(O.EuiButton,C()({"data-test-subj":"addScriptedFieldLink"},Object(v.reactRouterNavigate)(t,`patterns/${e}/create-field/`)),Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.scripted.addFieldButton",defaultMessage:"Add scripted field"}))))})),Le=({deprecatedLangsInUse:e,painlessDocLink:t})=>e.length?Object(L.jsx)(g.a.Fragment,null,Object(L.jsx)(O.EuiCallOut,{title:Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.scripted.deprecationLangHeader",defaultMessage:"Deprecation languages in use"}),color:"danger",iconType:"cross"},Object(L.jsx)("p",null,Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.scripted.deprecationLangLabel.deprecationLangDetail",defaultMessage:"The following deprecated languages are in use: {deprecatedLangsInUse}. Support for these languages will be removed in the next major version of Kibana and Elasticsearch. Convert you scripted fields to {link} to avoid any problems.",values:{deprecatedLangsInUse:e.join(", "),link:Object(L.jsx)(O.EuiLink,{href:t},Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.scripted.deprecationLangLabel.painlessDescription",defaultMessage:"Painless"}))}}))),Object(L.jsx)(O.EuiSpacer,{size:"m"})):null,De=({field:e,hideDeleteConfirmationModal:t,deleteField:a})=>{const n=h.i18n.translate("indexPatternManagement.editIndexPattern.scripted.deleteFieldLabel",{defaultMessage:"Delete scripted field '{fieldName}'?",values:{fieldName:e.name}}),i=h.i18n.translate("indexPatternManagement.editIndexPattern.scripted.deleteField.cancelButton",{defaultMessage:"Cancel"}),s=h.i18n.translate("indexPatternManagement.editIndexPattern.scripted.deleteField.deleteButton",{defaultMessage:"Delete"});return Object(L.jsx)(O.EuiConfirmModal,{title:n,onCancel:t,onConfirm:a,cancelButtonText:i,confirmButtonText:s,defaultFocusedButton:O.EUI_MODAL_CONFIRM_BUTTON})};class scripted_fields_table_ScriptedFieldsTable extends f.Component{constructor(e){super(e),q()(this,"fetchFields",(async()=>{const e=await this.props.indexPattern.getScriptedFields(),t=[],a=[],n=["painless"];for(const i of e){const e=i.lang;!a.includes(e)&&n.includes(e)||t.push(e)}this.setState({fields:e,deprecatedLangsInUse:t})})),q()(this,"getFilteredItems",(()=>{const{fields:e}=this.state,{fieldFilter:t,scriptedFieldLanguageFilter:a,userEditPermission:n}=this.props;let i=e;a.length&&(i=e.filter((e=>a.includes(e.lang))));let s=i;if(t){const e=t.toLowerCase();s=i.filter((t=>t.name.toLowerCase().includes(e)))}return s.forEach((e=>e.isUserEditable=n)),s})),q()(this,"startDeleteField",(e=>{this.setState({fieldToDelete:e,isDeleteConfirmationModalVisible:!0})})),q()(this,"hideDeleteConfirmationModal",(()=>{this.setState({fieldToDelete:void 0,isDeleteConfirmationModalVisible:!1})})),q()(this,"deleteField",(()=>{const{indexPattern:e,onRemoveField:t,saveIndexPattern:a}=this.props,{fieldToDelete:n}=this.state;e.removeScriptedField(n.name),a(e),t&&t(),this.fetchFields(),this.hideDeleteConfirmationModal()})),this.state={deprecatedLangsInUse:[],fieldToDelete:void 0,isDeleteConfirmationModalVisible:!1,fields:[]}}UNSAFE_componentWillMount(){this.fetchFields()}render(){const{indexPattern:e,painlessDocLink:t}=this.props,{fieldToDelete:a,deprecatedLangsInUse:n}=this.state,i=this.getFilteredItems();return Object(L.jsx)(g.a.Fragment,null,Object(L.jsx)(Ie,{indexPatternId:e.id||""}),Object(L.jsx)(Le,{deprecatedLangsInUse:n,painlessDocLink:t}),Object(L.jsx)(O.EuiSpacer,{size:"l"}),Object(L.jsx)(components_table_table_Table,{indexPattern:e,items:i,editField:e=>this.props.helpers.redirectToRoute(e),deleteField:this.startDeleteField}),a&&Object(L.jsx)(De,{deleteField:this.deleteField,field:a,hideDeleteConfirmationModal:this.hideDeleteConfirmationModal}))}}var Ae=a(27),_e=a.n(Ae),Ne=a(24),ke=a.n(Ne),Re=a(34),Be=a.n(Re),Ve=["children"],Ue=g.a.createContext(null),qe=function(e){var t=e.children,a=_e()(e,Ve);return Object(L.jsx)(Ue.Provider,{value:ke()({},a)},t)},He=function(e){var t=e.children,a=e.coreStart.application,n=a.navigateToUrl,i=a.currentAppId$,s=Be()(i,void 0);return Object(L.jsx)(Ue.Provider,{value:{navigateToUrl:n,currentAppId:s}},t)},ze=["children","navigateToUrl","currentAppId"],Ge=function(e){var t=e.children,a=e.navigateToUrl,n=e.currentAppId,i=_e()(e,ze),s=Object(f.useRef)(null),r=Object(f.useCallback)((function(e){return function(e){var t=e.event,a=e.container,n=e.navigateToUrl,i=e.currentAppId;if(a&&i){var s=function(e,t){var a=e;do{var n,i;if("a"===(null===(n=a)||void 0===n?void 0:n.tagName.toLowerCase()))return a;var s=null===(i=a)||void 0===i?void 0:i.parentElement;if(!s||s===document.body||s===t)break;a=s}while(parent||parent!==document.body||parent!==t)}(t.target,a);if(s){var r=s.href,l=""===s.target||"_self"===s.target,d=0===t.button;r&&l&&d&&!t.defaultPrevented&&!function(e){return e.metaKey||e.altKey||e.ctrlKey||e.shiftKey}(t)&&(t.preventDefault(),n(s.href))}}}({event:e,currentAppId:n,navigateToUrl:a,container:s.current})}),[n,a]);return Object(L.jsx)("div",C()({},i,{ref:s,onClick:r}),t)},We=function(e){return Object(L.jsx)(Ge,C()({},function(){var e=Object(f.useContext)(Ue);if(!e)throw new Error("RedirectAppLinksContext is missing.  Ensure your component or React root is wrapped with RedirectAppLinksProvider.");return e}(),e))},Ke=["children"],$e=function(e){var t=e.children,a=_e()(e,Ke),n=Object(L.jsx)(We,null,t);return function(e){return void 0!==e.coreStart}(a)?Object(L.jsx)(He,a,n):Object(L.jsx)(qe,a,n)},Qe=a(1);const Ye=h.i18n.translate("indexPatternManagement.objectsTable.relationships.columnTypeName",{defaultMessage:"Type"}),Je=h.i18n.translate("indexPatternManagement.objectsTable.relationships.columnTypeDescription",{defaultMessage:"Type of the saved object"}),Ze=h.i18n.translate("indexPatternManagement.objectsTable.relationships.columnTitleName",{defaultMessage:"Title"}),Xe=h.i18n.translate("indexPatternManagement.objectsTable.relationships.columnTitleDescription",{defaultMessage:"Title of the saved object"}),et=h.i18n.translate("indexPatternManagement.objectsTable.relationships.search.filters.type.name",{defaultMessage:"Type"}),tt=({basePath:e,capabilities:t,id:a,navigateToUrl:n,getDefaultTitle:i,getSavedObjectLabel:s,relationships:r,allowedTypes:l})=>{const d=[{field:"type",name:Ye,width:"50px",align:"center",description:Je,sortable:!1,render:(e,t)=>{const a=s(e,l);return Object(L.jsx)(O.EuiToolTip,{position:"top",content:a},Object(L.jsx)(O.EuiIcon,{"aria-label":a,type:t.meta.icon||"apps",size:"s","data-test-subj":"relationshipsObjectType"}))}},{field:"title",name:Ze,description:Xe,dataType:"string",sortable:!1,render:(a,n)=>{var s;const r=(null===(s=n.meta.inAppUrl)||void 0===s?void 0:s.path)||"",l=((e,t)=>{const{inAppUrl:a}=e.meta;return!!a&&(!a.uiCapabilitiesPath||Boolean(Object(we.get)(t,a.uiCapabilitiesPath)))})(n,t),d=a||i(n);return l?Object(L.jsx)(O.EuiLink,{href:e.prepend(r),"data-test-subj":"relationshipsTitle"},d):Object(L.jsx)(O.EuiText,{size:"s","data-test-subj":"relationshipsTitle"},d)}}],o=new Map(r.map((e=>[e.type,{value:e.type,name:e.type,view:e.type}]))),c={box:{incremental:!0,schema:!0},filters:[{type:"field_value_selection",field:"type",name:et,multiSelect:"or",options:[...o.values()]}]};return Object(L.jsx)($e,{currentAppId:Qe.a,navigateToUrl:n},Object(L.jsx)(O.EuiInMemoryTable,{items:r,columns:d,pagination:!0,search:c,rowProps:()=>({"data-test-subj":"relationshipsTableRow"})}))};function at(e,t,a=""){const n=Object(we.countBy)(function(e,t){const a=(t||"").toLowerCase();return e.filter((e=>e.name.toLowerCase().includes(a)))}(e,a),(function(e){return e.scripted?"scripted":"indexed"}));return Object(we.defaults)(n,{indexed:0,scripted:0,sourceFilters:t.excludes?t.excludes.filter((e=>e.toLowerCase().includes(a.toLowerCase()))).length:0}),n}function nt(e,t,a){let n="";switch(e){case"indexed":n=h.i18n.translate("indexPatternManagement.editIndexPattern.tabs.fieldsHeader",{defaultMessage:"Fields"});break;case"scripted":n=h.i18n.translate("indexPatternManagement.editIndexPattern.tabs.scriptedHeader",{defaultMessage:"Scripted fields"});break;case"sourceFilters":n=h.i18n.translate("indexPatternManagement.editIndexPattern.tabs.sourceHeader",{defaultMessage:"Field filters"})}return n+` (${t[e]===a[e]?t[e]:t[e]+" / "+a[e]})`}function it(e){return Object(we.uniq)(e).map((e=>({value:e,name:e})))}const st=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.searchAria",{defaultMessage:"Search fields"}),rt=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.filter",{defaultMessage:"Field type"}),lt=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.filterAria",{defaultMessage:"Filter field types"}),dt=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.schema",{defaultMessage:"Schema type"}),ot=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.schemaAria",{defaultMessage:"Filter schema types"}),ct=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.scriptedFieldFilter",{defaultMessage:"All languages"}),ut=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.scriptedFieldFilterAria",{defaultMessage:"Filter scripted field languages"}),pt=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.runtime",{defaultMessage:"Runtime"}),ft=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.indexed",{defaultMessage:"Indexed"}),gt=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.filterPlaceholder",{defaultMessage:"Search"}),mt=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.addFieldButtonLabel",{defaultMessage:"Add field"});function bt({indexPattern:e,saveIndexPattern:t,fields:a,history:n,location:i,refreshFields:s,relationships:r,allowedTypes:l}){const{uiSettings:d,docLinks:o,dataViewFieldEditor:c,overlays:u,theme:p,dataViews:m,http:b,application:j,savedObjectsManagement:x}=Object(v.useKibana)().services,[y,M]=Object(f.useState)(""),[P,T]=Object(f.useState)({getCurrentTab:()=>k}),[S,w]=Object(f.useState)([]),[C,D]=Object(f.useState)(!1),[A,U]=Object(f.useState)([]),[q,H]=Object(f.useState)([]),[z,G]=Object(f.useState)(!1),[W,K]=Object(f.useState)([]),[$,Q]=Object(f.useState)([]),[Y,J]=Object(f.useState)(!1),[Z,X]=Object(f.useState)([{value:"runtime",name:pt},{value:"indexed",name:ft}]),ee=Object(f.useRef)(),{DeleteRuntimeFieldProvider:te}=c,ae=(e,t,a)=>{if(!e[t])return;const n=[...e];"on"===n[t].checked?n[t].checked=void 0:n[t].checked="on",a(n)},ne=Object(f.useCallback)((()=>{const t=[],a=[];e.fields.getAll().forEach((e=>{e.scripted?e.lang&&a.push(e.lang):("conflict"===e.type&&t.push("conflict"),e.esTypes&&e.esTypes.forEach((e=>t.push(e))))})),K(it(t)),U(it(a))}),[e]),ie=Object(f.useCallback)((()=>{ee.current&&ee.current()}),[]),se=Object(f.useCallback)((t=>{ee.current=c.openEditor({ctx:{dataView:e},onSave:s,fieldName:t})}),[c,e,s]);Object(f.useEffect)((()=>{ne()}),[e,e.fields,ne]),Object(f.useEffect)((()=>()=>{ie()}),[ie]);const re=Object(f.useCallback)((e=>Object(_.fieldWildcardMatcher)(e,d.get(I.META_FIELDS))),[d]),le=m.getCanSaveSync(),de=Object(f.useCallback)((e=>Object(L.jsx)(O.EuiFlexGroup,null,Object(L.jsx)(O.EuiFlexItem,{grow:!0},Object(L.jsx)(O.EuiFieldSearch,{fullWidth:!0,placeholder:gt,value:y,onChange:e=>M(e.target.value),"data-test-subj":"indexPatternFieldFilter","aria-label":st})),e===k&&W.length>0&&Object(L.jsx)(g.a.Fragment,null,Object(L.jsx)(O.EuiFlexItem,{grow:!1},Object(L.jsx)(O.EuiFilterGroup,null,Object(L.jsx)(O.EuiPopover,{anchorPosition:"downCenter","data-test-subj":"indexedFieldTypeFilterDropdown-popover",button:Object(L.jsx)(O.EuiFilterButton,{"aria-label":lt,"data-test-subj":"indexedFieldTypeFilterDropdown",iconType:"arrowDown",onClick:()=>G(!z),isSelected:z,numFilters:W.length,hasActiveFilters:!!W.find((e=>"on"===e.checked)),numActiveFilters:W.filter((e=>"on"===e.checked)).length},rt),isOpen:z,closePopover:()=>G(!1)},W.map(((e,t)=>Object(L.jsx)(O.EuiFilterSelectItem,{checked:e.checked,key:e.value,onClick:()=>{H(e.checked?q.filter((t=>t!==e.value)):[...q,e.value]),ae(W,t,K)},"data-test-subj":`indexedFieldTypeFilterDropdown-option-${e.value}${e.checked?"-checked":""}`},e.name)))),Object(L.jsx)(O.EuiPopover,{anchorPosition:"downCenter","data-test-subj":"schemaFieldTypeFilterDropdown-popover",button:Object(L.jsx)(O.EuiFilterButton,{"aria-label":ot,"data-test-subj":"schemaFieldTypeFilterDropdown",iconType:"arrowDown",onClick:()=>J(!Y),isSelected:Y,numFilters:Z.length,hasActiveFilters:!!Z.find((e=>"on"===e.checked)),numActiveFilters:Z.filter((e=>"on"===e.checked)).length},dt),isOpen:Y,closePopover:()=>J(!1)},Z.map(((e,t)=>Object(L.jsx)(O.EuiFilterSelectItem,{checked:e.checked,key:e.value,onClick:()=>{Q(e.checked?$.filter((t=>t!==e.value)):[...$,e.value]),ae(Z,t,X)},"data-test-subj":`schemaFieldTypeFilterDropdown-option-${e.value}${e.checked?"-checked":""}`},e.name)))))),le&&Object(L.jsx)(O.EuiFlexItem,{grow:!1},Object(L.jsx)(O.EuiButton,{fill:!0,onClick:()=>se(),"data-test-subj":"addField"},mt))),e===R&&A.length>0&&Object(L.jsx)(O.EuiFlexItem,{grow:!1},Object(L.jsx)(O.EuiFilterGroup,null,Object(L.jsx)(O.EuiPopover,{anchorPosition:"downCenter","data-test-subj":"scriptedFieldLanguageFilterDropdown-popover",button:Object(L.jsx)(O.EuiFilterButton,{"aria-label":ut,"data-test-subj":"scriptedFieldLanguageFilterDropdown",iconType:"arrowDown",onClick:()=>D(!C),isSelected:C,numFilters:A.length,hasActiveFilters:!!A.find((e=>"on"===e.checked)),numActiveFilters:A.filter((e=>"on"===e.checked)).length},ct),isOpen:C,closePopover:()=>D(!1)},A.map(((e,t)=>Object(L.jsx)(O.EuiFilterSelectItem,{checked:e.checked,key:e.value,onClick:()=>{w(e.checked?S.filter((t=>t!==e.value)):[...S,e.value]),ae(A,t,U)},"data-test-subj":`scriptedFieldLanguageFilterDropdown-option-${e.value}${e.checked?"-checked":""}`},e.name)))))))),[y,q,W,z,S,A,C,Z,$,Y,se,le]),oe=Object(f.useCallback)((i=>{switch(i){case k:return Object(L.jsx)(f.Fragment,null,Object(L.jsx)(O.EuiSpacer,{size:"m"}),de(i),Object(L.jsx)(O.EuiSpacer,{size:"m"}),Object(L.jsx)(te,{dataView:e,onDelete:s},(t=>Object(L.jsx)(indexed_fields_table_IndexedFieldsTable,{fields:a,indexPattern:e,fieldFilter:y,fieldWildcardMatcher:re,indexedFieldTypeFilter:q,schemaFieldTypeFilter:$,helpers:{editField:se,deleteField:t,getFieldInfo:E},openModal:u.openModal,theme:p,userEditPermission:m.getCanSaveSync()}))));case R:return Object(L.jsx)(f.Fragment,null,Object(L.jsx)(O.EuiSpacer,{size:"m"}),de(i),Object(L.jsx)(O.EuiSpacer,{size:"m"}),Object(L.jsx)(scripted_fields_table_ScriptedFieldsTable,{indexPattern:e,saveIndexPattern:t,fieldFilter:y,scriptedFieldLanguageFilter:S,helpers:{redirectToRoute:t=>{n.push(function(e,t){return`/dataView/${null==t?void 0:t.id}/field/${encodeURIComponent(e.name)}`}(t,e))}},onRemoveField:ne,painlessDocLink:o.links.scriptedFields.painless,userEditPermission:m.getCanSaveSync()}));case B:return Object(L.jsx)(f.Fragment,null,Object(L.jsx)(O.EuiSpacer,{size:"m"}),de(i),Object(L.jsx)(O.EuiSpacer,{size:"m"}),Object(L.jsx)(source_filters_table_SourceFiltersTable,{saveIndexPattern:t,indexPattern:e,filterFilter:y,fieldWildcardMatcher:re,onAddOrRemoveFilter:ne}));case V:return Object(L.jsx)(f.Fragment,null,Object(L.jsx)(O.EuiSpacer,{size:"m"}),Object(L.jsx)(tt,{basePath:b.basePath,id:e.id,capabilities:j.capabilities,relationships:r,allowedTypes:l,navigateToUrl:j.navigateToUrl,getDefaultTitle:x.getDefaultTitle,getSavedObjectLabel:x.getSavedObjectLabel}))}}),[o.links.scriptedFields.painless,y,re,a,de,n,e,q,$,ne,S,t,se,te,s,u,p,m,b,j,x,l,r]),ce=Object(f.useMemo)((()=>function(e,t,a=0){const n=at(e.fields.getAll(),e.getSourceFiltering()),i=at(e.fields.getAll(),e.getSourceFiltering(),t),s=[];return s.push({name:nt("indexed",i,n),id:k,"data-test-subj":"tab-indexedFields"}),(e=>!F(e.type))(e)&&s.push({name:nt("scripted",i,n),id:R,"data-test-subj":"tab-scriptedFields"}),s.push({name:nt("sourceFilters",i,n),id:B,"data-test-subj":"tab-sourceFilters"}),s.push({name:h.i18n.translate("indexPatternManagement.editIndexPattern.tabs.relationshipsHeader",{defaultMessage:"Relationships ({count})",values:{count:a}}),id:V,"data-test-subj":"tab-relationships"}),s}(e,y,r.length).map((e=>({...e,content:oe(e.id)})))),[y,oe,e,r]),[ue,pe]=Object(f.useState)(ce[0].id);return Object(f.useEffect)((()=>{const{startSyncingState:e,stopSyncingState:t,setCurrentTab:a,getCurrentTab:n}=function({defaultTab:e,useHashedUrl:t}){const a=Object(N.createHashHistory)(),n="_a",i={tab:e},s=Object(_.createKbnUrlStateStorage)({useHash:t,history:a}),r=s.get(n),l=Object(_.createStateContainer)({...i,...r},{setTab:e=>t=>({...e,tab:t})},{tab:e=>()=>e.tab}),{start:d,stop:o}=Object(_.syncState)({storageKey:n,stateContainer:{...l,set:e=>e&&l.set(e)},stateStorage:s});return s.set(n,l.getState(),{replace:!0}),{startSyncingState:d,stopSyncingState:o,setCurrentTab:e=>l.transitions.setTab(e),getCurrentTab:()=>l.selectors.tab()}}({useHashedUrl:d.get("state:storeInSessionStorage"),defaultTab:k});return e(),T({setCurrentTab:a,getCurrentTab:n}),pe(n()),()=>{t()}}),[d]),Object(L.jsx)(O.EuiTabbedContent,{tabs:ce,selectedTab:ce.find((e=>e.id===ue)),onTabClick:e=>{pe(e.id),P.setCurrentTab(e.id)}})}const jt=h.i18n.translate("indexPatternManagement.editDataView.setDefaultAria",{defaultMessage:"Set as default data view."}),ht=h.i18n.translate("indexPatternManagement.editDataView.setDefaultTooltip",{defaultMessage:"Set as default data view."}),xt=h.i18n.translate("indexPatternManagement.editDataView.removeAria",{defaultMessage:"Delete data view."}),vt=h.i18n.translate("indexPatternManagement.editDataView.removeTooltip",{defaultMessage:"Delete data view."}),Ot=({defaultIndex:e,indexPattern:t,setDefault:a,deleteIndexPatternClick:n,children:i,canSave:s})=>Object(L.jsx)(O.EuiPageHeader,{pageTitle:Object(L.jsx)("span",{"data-test-subj":"indexPatternTitle"},t.title),rightSideItems:[e!==t.id&&a&&s&&Object(L.jsx)(O.EuiToolTip,{content:ht},Object(L.jsx)(O.EuiButtonIcon,{color:"text",onClick:a,iconType:"starFilled","aria-label":jt,"data-test-subj":"setDefaultIndexPatternButton"})),s&&Object(L.jsx)(O.EuiToolTip,{content:vt},Object(L.jsx)(O.EuiButtonIcon,{color:"danger",onClick:n,iconType:"trash","aria-label":xt,"data-test-subj":"deleteIndexPatternButton"}))].filter(Boolean)},i);var yt=a(18);const Mt={confirmButtonText:h.i18n.translate("indexPatternManagement.editIndexPattern.deleteButton",{defaultMessage:"Delete"}),title:h.i18n.translate("indexPatternManagement.editDataView.deleteHeader",{defaultMessage:"Delete data view"}),buttonColor:"danger"},Ft=({dataViews:e,overlays:t,onDelete:a})=>(n,i)=>{t.openConfirm(Object(v.toMountPoint)(i),Mt).then((async t=>{t&&(await Object(yt.asyncForEach)(n,(async({id:t})=>e.delete(t))),a())}))},Pt=h.i18n.translate("indexPatternManagement.editIndexPattern.timeFilterLabel.mappingAPILink",{defaultMessage:"field mappings"}),Et=h.i18n.translate("indexPatternManagement.editIndexPattern.mappingConflictHeader",{defaultMessage:"Mapping conflict"}),Tt=h.i18n.translate("indexPatternManagement.editIndexPattern.badge.securityDataViewTitle",{defaultMessage:"Security Data View"}),St=Object(j.withRouter)((({indexPattern:e,history:t,location:a})=>{const{uiSettings:n,overlays:i,chrome:s,dataViews:r,savedObjectsManagement:l}=Object(v.useKibana)().services,[d,o]=Object(f.useState)(e.getNonScriptedFields()),[c,u]=Object(f.useState)(e.fields.getAll().filter((e=>"conflict"===e.type))),[p,m]=Object(f.useState)(n.get("defaultIndex")),[b,j]=Object(f.useState)([]),[y,M]=Object(f.useState)([]),[F,E]=Object(f.useState)([]);Object(f.useEffect)((()=>{l.getAllowedTypes().then((e=>{E(e)}))}),[l]),Object(f.useEffect)((()=>{if(0===F.length)return;const t=F.map((e=>e.name));l.getRelationships(I.DATA_VIEW_SAVED_OBJECT_TYPE,e.id,t).then((e=>{M(e.relations.map((e=>({...e,title:e.meta.title}))))}))}),[l,e,F]),Object(f.useEffect)((()=>{o(e.getNonScriptedFields()),u(e.fields.getAll().filter((e=>"conflict"===e.type)))}),[e]),Object(f.useEffect)((()=>{j(P(e,e.id===p))}),[p,e]);const T=Object(f.useCallback)((()=>{n.set("defaultIndex",e.id),m(e.id||"")}),[n,e.id]),S=Ft({dataViews:r,uiSettings:n,overlays:i,onDelete:()=>{t.push("")}}),w=h.i18n.translate("indexPatternManagement.editIndexPattern.timeFilterHeader",{defaultMessage:"Time field: '{timeFieldName}'",values:{timeFieldName:e.timeFieldName}}),C=h.i18n.translate("indexPatternManagement.editIndexPattern.mappingConflictLabel",{defaultMessage:"{conflictFieldsLength, plural, one {A field is} other {# fields are}} defined as several types (string, integer, etc) across the indices that match this pattern. You may still be able to use these conflict fields in parts of Kibana, but they will be unavailable for functions that require Kibana to know their type. Correcting this issue will require reindexing your data.",values:{conflictFieldsLength:c.length}}),D=h.i18n.translate("indexPatternManagement.editDataView.detailsAria",{defaultMessage:"Data view details"});s.docTitle.change(e.title);const A=Boolean(e.timeFieldName||b&&b.length>0),_=Object(v.useKibana)().services.docLinks.links.elasticsearch.mapping,N=r.getCanSaveSync(),k=e.namespaces&&e.namespaces.length>1||e.namespaces.includes("*")?Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.editDataView.deleteWarningWithNamespaces",defaultMessage:"Delete the data view {dataViewName} from every space it is shared in. You can't undo this action.",values:{dataViewName:Object(L.jsx)(O.EuiCode,null,e.title)}}):Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.editDataView.deleteWarning",defaultMessage:"The data view {dataViewName} will be deleted. You can't undo this action.",values:{dataViewName:Object(L.jsx)(O.EuiCode,null,e.title)}});return Object(L.jsx)("div",{"data-test-subj":"editIndexPattern",role:"region","aria-label":D},Object(L.jsx)(Ot,{indexPattern:e,setDefault:T,deleteIndexPatternClick:()=>S([e],Object(L.jsx)("div",null,k)),defaultIndex:p,canSave:N},A&&Object(L.jsx)(O.EuiFlexGroup,{wrap:!0,gutterSize:"s"},Boolean(e.timeFieldName)&&Object(L.jsx)(O.EuiFlexItem,{grow:!1},Object(L.jsx)(O.EuiBadge,{color:"warning"},w)),e.id&&0===e.id.indexOf("security-solution")&&Object(L.jsx)(O.EuiFlexItem,{grow:!1},Object(L.jsx)(O.EuiBadge,null,Tt)),b.map((e=>Object(L.jsx)(O.EuiFlexItem,{grow:!1,key:e.key},Object(L.jsx)(O.EuiBadge,{color:"hollow"},e.name))))),Object(L.jsx)(O.EuiSpacer,{size:"m"}),Object(L.jsx)(O.EuiText,null,Object(L.jsx)("p",null,Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.timeFilterLabel.timeFilterDetail",defaultMessage:"View and edit fields in {indexPatternTitle}. Field attributes, such as type and searchability, are based on {mappingAPILink} in Elasticsearch.",values:{indexPatternTitle:Object(L.jsx)("strong",null,e.title),mappingAPILink:Object(L.jsx)(O.EuiLink,{href:_,target:"_blank",external:!0},Pt)}})," ")),c.length>0&&Object(L.jsx)(g.a.Fragment,null,Object(L.jsx)(O.EuiSpacer,null),Object(L.jsx)(O.EuiCallOut,{title:Et,color:"warning",iconType:"alert"},Object(L.jsx)("p",null,C)))),Object(L.jsx)(O.EuiSpacer,null),Object(L.jsx)(bt,{indexPattern:e,saveIndexPattern:r.updateSavedObject.bind(r),fields:d,relationships:y,allowedTypes:F,history:t,location:a,refreshFields:()=>{o(e.getNonScriptedFields())}}))})),wt=Object(j.withRouter)((({...e})=>{const{dataViews:t,setBreadcrumbs:a}=Object(v.useKibana)().services,[n,i]=Object(f.useState)();return Object(f.useEffect)((()=>{t.get(e.match.params.id).then((e=>{i(e),a(S(e))}))}),[t,e.match.params.id,a]),n?Object(L.jsx)(St,{indexPattern:n}):Object(L.jsx)(g.a.Fragment,null)}));var Ct=a(19);const It=({isVisible:e=!1})=>e?Object(L.jsx)(f.Fragment,null,Object(L.jsx)(O.EuiCallOut,{title:Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.disabledCallOutHeader",defaultMessage:"Scripting disabled",description:"Showing the status that scripting is disabled in Elasticsearch. Not an update message, that it JUST got disabled."}),color:"danger",iconType:"alert"},Object(L.jsx)("p",null,Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.disabledCallOutLabel",defaultMessage:"All inline scripting has been disabled in Elasticsearch. You must enable inline scripting for at least one language in order to use scripted fields in Kibana."}))),Object(L.jsx)(O.EuiSpacer,{size:"m"})):null;It.displayName="ScriptingDisabledCallOut";const Lt=({isVisible:e=!1})=>{var t;const a=null===(t=Object(v.useKibana)().services.docLinks)||void 0===t?void 0:t.links;return e?Object(L.jsx)(f.Fragment,null,Object(L.jsx)(O.EuiText,{size:"s"},Object(L.jsx)("p",null,Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.warningCallOutLabel.callOutDetail",defaultMessage:"Familiarize yourself with {scripFields} and {scriptsInAggregation} before using this feature. Scripted fields can be used to display and aggregate calculated values. As such, they can be very slow and, if done incorrectly, can cause Kibana to become unusable.",values:{scripFields:Object(L.jsx)(O.EuiLink,{target:"_blank",href:a.scriptedFields.scriptFields},Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.warningCallOutLabel.scripFieldsLink",defaultMessage:"scripted fields"})),scriptsInAggregation:Object(L.jsx)(O.EuiLink,{target:"_blank",href:a.scriptedFields.scriptAggs},Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.warningCallOutLabel.scriptsInAggregationLink",defaultMessage:"scripts in aggregations"}))}}))),Object(L.jsx)(O.EuiSpacer,{size:"m"}),Object(L.jsx)(O.EuiCallOut,{color:"warning",iconType:"alert",title:Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.scriptedFieldsDeprecatedTitle",defaultMessage:"Scripted fields are deprecated",description:"Deprecation warning title within scripted field editor"})},Object(L.jsx)(O.EuiText,{size:"s"},Object(L.jsx)("p",null,Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.scriptedFieldsDeprecatedBody",defaultMessage:"For greater flexibility and Painless script support, use {runtimeDocs}.",values:{runtimeDocs:Object(L.jsx)(O.EuiLink,{target:"_blank",href:a.runtimeFields.overview},Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.warningCallOutLabel.runtimeLink",defaultMessage:"runtime fields"}))}})))),Object(L.jsx)(O.EuiSpacer,{size:"m"})):null};Lt.displayName="ScriptingWarningCallOut";const Dt=()=>{var e;const t=null===(e=Object(v.useKibana)().services.docLinks)||void 0===e?void 0:e.links.scriptedFields;return Object(L.jsx)(f.Fragment,null,Object(L.jsx)(O.EuiSpacer,null),Object(L.jsx)(O.EuiText,null,Object(L.jsx)("h3",null,Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.syntaxHeader",defaultMessage:"Syntax"})),Object(L.jsx)("p",null,Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.syntax.defaultLabel.defaultDetail",defaultMessage:"By default, Kibana scripted fields use {painless}, a simple and secure scripting language designed specifically for use with Elasticsearch, to access values in the document use the following format:",values:{painless:Object(L.jsx)(O.EuiLink,{target:"_blank",href:t.painless},Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.syntax.defaultLabel.painlessLink",defaultMessage:"Painless"})," ",Object(L.jsx)(O.EuiIcon,{type:"link"}))}})),Object(L.jsx)("p",null,Object(L.jsx)(O.EuiCode,null,Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.syntax.default.formatLabel",defaultMessage:"doc['some_field'].value"}))),Object(L.jsx)("p",null,Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.syntax.painlessLabel.painlessDetail",defaultMessage:"Painless is powerful but easy to use. It provides access to many {javaAPIs}. Read up on its {syntax} and you'll be up to speed in no time!",values:{javaAPIs:Object(L.jsx)(O.EuiLink,{target:"_blank",href:t.painlessApi},Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.syntax.painlessLabel.javaAPIsLink",defaultMessage:"native Java APIs"})," ",Object(L.jsx)(O.EuiIcon,{type:"link"})),syntax:Object(L.jsx)(O.EuiLink,{target:"_blank",href:t.painlessSyntax},Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.syntax.painlessLabel.syntaxLink",defaultMessage:"syntax"})," ",Object(L.jsx)(O.EuiIcon,{type:"link"}))}})),Object(L.jsx)("p",null,Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.syntax.kibanaLabel",defaultMessage:"Kibana currently imposes one special limitation on the painless scripts you write. They cannot contain named functions."})),Object(L.jsx)("p",null,Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.commonLabel.commonDetail",defaultMessage:"Coming from an older version of Kibana? The {lucene} you know and love are still available. Lucene expressions are a lot like JavaScript, but limited to basic arithmetic, bitwise and comparison operations.",values:{lucene:Object(L.jsx)(O.EuiLink,{target:"_blank",href:t.luceneExpressions},Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.commonLabel.luceneLink",defaultMessage:"Lucene Expressions"})," ",Object(L.jsx)(O.EuiIcon,{type:"link"}))}})),Object(L.jsx)("p",null,Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.limitsLabel",defaultMessage:"There are a few limitations when using Lucene Expressions:"})),Object(L.jsx)("ul",null,Object(L.jsx)("li",null,Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.limits.typesLabel",defaultMessage:"Only numeric, boolean, date, and geo_point fields may be accessed"})),Object(L.jsx)("li",null,Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.limits.fieldsLabel",defaultMessage:"Stored fields are not available"})),Object(L.jsx)("li",null,Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.limits.sparseLabel",defaultMessage:"If a field is sparse (only some documents contain a value), documents missing the field will have a value of 0"}))),Object(L.jsx)("p",null,Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.operationsLabel",defaultMessage:"Here are all the operations available to lucene expressions:"})),Object(L.jsx)("ul",null,Object(L.jsx)("li",null,Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.operations.arithmeticLabel",defaultMessage:"Arithmetic operators: {operators}",values:{operators:Object(L.jsx)("code",null,"+ - * / %")}})),Object(L.jsx)("li",null,Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.operations.bitwiseLabel",defaultMessage:"Bitwise operators: {operators}",values:{operators:Object(L.jsx)("code",null,"| & ^ ~ << >> >>>")}})),Object(L.jsx)("li",null,Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.operations.booleanLabel",defaultMessage:"Boolean operators (including the ternary operator): {operators}",values:{operators:Object(L.jsx)("code",null,"&& || ! ?:")}})),Object(L.jsx)("li",null,Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.operations.comparisonLabel",defaultMessage:"Comparison operators: {operators}",values:{operators:Object(L.jsx)("code",null,"< <= == >= >")}})),Object(L.jsx)("li",null,Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.operations.mathLabel",defaultMessage:"Common mathematic functions: {operators}",values:{operators:Object(L.jsx)("code",null,"abs ceil exp floor ln log10 logn max min sqrt pow")}})),Object(L.jsx)("li",null,Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.operations.trigLabel",defaultMessage:"Trigonometric library functions: {operators}",values:{operators:Object(L.jsx)("code",null,"acosh acos asinh asin atanh atan atan2 cosh cos sinh sin tanh tan")}})),Object(L.jsx)("li",null,Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.operations.distanceLabel",defaultMessage:"Distance functions: {operators}",values:{operators:Object(L.jsx)("code",null,"haversin")}})),Object(L.jsx)("li",null,Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.operations.miscellaneousLabel",defaultMessage:"Miscellaneous functions: {operators}",values:{operators:Object(L.jsx)("code",null,"min, max")}})))))};var At,_t,Nt=a(30),kt=a.n(Nt),Rt=function(e,t){if("boolean"!=typeof t&&"boolean"===e.type){if([1,"true"].includes(t))return!0;if([0,"false"].includes(t))return!1;throw new Error("".concat(t," is not a valid boolean value for boolean field ").concat(e.name))}return"number"!=typeof t&&"number"===e.type?Number(t):t},Bt=function(e,t){var a=Rt(e,t);return{script:{source:Vt(e),lang:e.lang,params:{value:a}}}},Vt=function(e){return"painless"===e.lang?"boolean compare(Supplier s, def v) {return s.get() == v;}"+"compare(() -> { ".concat(e.script," }, params.value);"):"(".concat(e.script,") == value")};!function(e){e.CUSTOM="custom",e.PHRASES="phrases",e.PHRASE="phrase",e.EXISTS="exists",e.MATCH_ALL="match_all",e.QUERY_STRING="query_string",e.RANGE="range",e.RANGE_FROM_VALUE="range_from_value",e.SPATIAL_FILTER="spatial_filter"}(At||(At={})),function(e){e.APP_STATE="appState",e.GLOBAL_STATE="globalState"}(_t||(_t={}));var Ut={gt:">",gte:">=",lte:"<=",lt:"<"},qt={gt:"boolean gt(Supplier s, def v) {return s.get() > v}",gte:"boolean gte(Supplier s, def v) {return s.get() >= v}",lte:"boolean lte(Supplier s, def v) {return s.get() <= v}",lt:"boolean lt(Supplier s, def v) {return s.get() < v}"},Ht={gt:"boolean gt(Supplier s, def v) {return s.get().toInstant().isAfter(Instant.parse(v))}",gte:"boolean gte(Supplier s, def v) {return !s.get().toInstant().isBefore(Instant.parse(v))}",lte:"boolean lte(Supplier s, def v) {return !s.get().toInstant().isAfter(Instant.parse(v))}",lt:"boolean lt(Supplier s, def v) {return s.get().toInstant().isBefore(Instant.parse(v))}"},zt=function(e,t){var a=Object(we.mapValues)(Object(we.pickBy)(t,(function(e,t){return t in Ut})),(function(t){return"number"===e.type&&"string"==typeof t?parseFloat(t):t})),n=Object(we.map)(a,(function(t,a){return"("+e.script+")"+Object(we.get)(Ut,a)+a})).join(" && ");if("painless"===e.lang){var i="date"===e.type?Ht:qt,s=Object(we.reduce)(a,(function(e,t,a){return e.concat(Object(we.get)(i,a))}),[]).join(" "),r=Object(we.map)(a,(function(t,a){return"".concat(a,"(() -> { ").concat(e.script," }, params.").concat(a,")")})).join(" && ");n="".concat(s).concat(r)}return{script:{source:n,params:a,lang:e.lang}}},Gt=function(e){return function(e){return Object(we.has)(e,"query.exists")}(e)?function(e){return e.query.exists&&e.query.exists.field}(e):function(e){var t=Object(we.has)(e,"query.match_phrase"),a=Object(we.get)(e,"query.match",[]),n=void 0!==Object.values(a).find((function(e){return"phrase"===e.type}));return t||n}(e)?function(e){var t,a,n=null!==(t=null!==(a=e.query.match_phrase)&&void 0!==a?a:e.query.match)&&void 0!==t?t:{};return Object.keys(n)[0]}(e):function(e){var t;return(null==e||null===(t=e.meta)||void 0===t?void 0:t.type)===At.PHRASES}(e)?function(e){return e.meta.key}(e):function(e){return Object(we.has)(e,"query.range")}(e)?function(e){return e.query.range&&Object.keys(e.query.range)[0]}(e):void 0},Wt=function(e){return Object(we.get)(e,"meta.disabled",!1)},Kt=function(e){return Object(we.omit)(e,["meta","$state"])};function $t(e,t){if(function(e){var t,a,n=Object.keys(null!==(t=e.match||(null===(a=e.query)||void 0===a?void 0:a.match))&&void 0!==t?t:{})[0];return Boolean(n&&("phrase"===Object(we.get)(e,["query","match",n,"type"])||"phrase"===Object(we.get)(e,["match",n,"type"])))}(e)){var a=e.match||e.query.match,n=Object.keys(a)[0],i=Object(we.get)(a,[n]),s=i.query;if(t){var r=t.fields.find((function(e){return e.name===n}));r&&(s=Rt(r,i.query))}return{meta:e.meta,$state:e.$state,query:{match_phrase:q()({},n,Object(we.omit)(ke()(ke()({},i),{},{query:s}),"type"))}}}return e.query?e=Object(we.pick)(e,["meta","query","$state"]):e.query={},e.exists&&(e.query.exists=e.exists,delete e.exists),e.range&&(e.query.range=e.range,delete e.range),e.match_all&&(e.query.match_all=e.match_all,delete e.match_all),Object.keys(e).forEach((function(t){"meta"!==t&&"query"!==t&&"$state"!==t&&(e.query[t]=e[t],delete e[t])})),e}var Qt=a(28),Yt=a.n(Qt),Jt=a(26),Zt=a.n(Jt);function Xt(e){return{type:"literal",value:e}}function ea(e){return e.value}var ta="@kuery-wildcard@";function aa(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function na(e){return e.replace(/[+-=&|><!(){}[\]^"~*?:\\/]/g,"\\$&")}function ia(e){return e.includes(ta)?{type:"wildcard",value:e}:Ja(e)}function sa(e,t){var a=e.value.split(ta).map(aa).join("[\\s\\S]*");return new RegExp("^".concat(a,"$")).test(t)}function ra(e){return e.value.split(ta).join("*")}function la(e){return e.value.split(ta).map(na).join("*")}function da(e){var t=e.value;return t.startsWith(ta)&&t.replace(ta,"").length>0}function oa(e,t){if(!t)return[];if("literal"===e.type){var a=ea(e),n=t.fields.find((function(e){return e.name===a}));return n?[n]:[]}return"wildcard"===e.type?t.fields.filter((function(t){return sa(e,t.name)})):void 0}var ca=a(20),ua=a.n(ca);function pa(e){var t=ua.a.tz.guess();return"Browser"===e?t:e}function fa(e){return function(e){var t,a=null==e?void 0:e.subType;return!(null==a||null===(t=a.nested)||void 0===t||!t.path)}(e)?e.subType:void 0}function ga(e,t,a){var n=ke()(ke()({},e),{},{value:a?"".concat(a,".").concat(e.value):e.value});if(!t||"wildcard"===n.type&&!a)return n;var i=oa(n,t).reduce((function(e,t){var n=fa(t),i=null==n?void 0:n.nested.path;return a&&!i?[].concat(Yt()(e),["".concat(t.name,' is not a nested field but is in nested group "').concat(a,'" in the KQL expression.')]):i&&!a?[].concat(Yt()(e),["".concat(t.name," is a nested field, but is not in a nested group in the KQL expression.")]):i!==a?[].concat(Yt()(e),["Nested field ".concat(t.name," is being queried with the incorrect nested path. The correct path is ").concat(null==n?void 0:n.nested.path,".")]):e}),[]);if(i.length>0)throw new Error(i.join("\n"));return n}function ma(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Object(we.isUndefined)(e))throw new Error("fieldName is a required argument");if(Object(we.isUndefined)(t))throw new Error("value is a required argument");var n="string"==typeof e?Ja(e):Xt(e),i="string"==typeof t?Ja(t):Xt(t),s=Xt(a);return{arguments:[n,i,s]}}function ba(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=Zt()(e.arguments,3),s=i[0],r=i[1],l=i[2],d="wildcard"===r.type&&r.value===ta,o="wildcard"===s.type&&s.value===ta,c=d&&o;if(c)return{match_all:{}};var u=ga(s,t,null!=n&&n.nested?n.nested.path:void 0),p=Object(we.isUndefined)(r)?r:Xa(r),f=l.value?"phrase":"best_fields";if(null===u.value)return"wildcard"===r.type?{query_string:{query:la(r)}}:{multi_match:{type:f,query:p,lenient:!0}};var g=t?oa(u,t):[];if(g&&0===g.length&&g.push({name:Xa(u),scripted:!1,type:""}),d&&(null==g||!g.length||(null==g?void 0:g.length)===(null==t?void 0:t.fields.length)))return{match_all:{}};var m=g.reduce((function(e,t){var i=function(e){var a=fa(t);return"wildcard"!==u.type||null==a||!a.nested||null!=n&&n.nested?e:{nested:{path:a.nested.path,query:e,score_mode:"none"}}};if(!t.scripted){if(d)return[].concat(Yt()(e),[i({exists:{field:t.name}})]);if("wildcard"===r.type)return[].concat(Yt()(e),[i({query_string:{fields:[t.name],query:la(r)}})]);if("date"===t.type){var s=a.dateFormatTZ?{time_zone:pa(a.dateFormatTZ)}:{};return[].concat(Yt()(e),[i({range:q()({},t.name,ke()({gte:p,lte:p},s))})])}var l="phrase"===f?"match_phrase":"match";return[].concat(Yt()(e),[i(q()({},l,q()({},t.name,p)))])}if(!d)return[].concat(Yt()(e),[{script:ke()({},Bt(t,p))}])}),[]);return{bool:{should:m||[],minimum_should_match:1}}}function ja(e){return{arguments:e}}function ha(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=a.filtersInMustClause,s=e.arguments||[],r=i?"must":"filter";return{bool:q()({},r,s.map((function(e){return Xa(e,t,a,n)})))}}function xa(e){return{arguments:e}}function va(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=e.arguments||[];return{bool:{should:i.map((function(e){return Xa(e,t,a,n)})),minimum_should_match:1}}}function Oa(e){return{arguments:[e]}}function ya(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=Zt()(e.arguments,1),s=i[0];return{bool:{must_not:Xa(s,t,a,n)}}}function Ma(e,t,a){return{arguments:[Ja(e),t,Da.literal.buildNode(a)]}}function Fa(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=Zt()(e.arguments,3),s=i[0],r=i[1],l=i[2],d=ga(s,t,null!=n&&n.nested?n.nested.path:void 0),o=t?oa(d,t):[];o&&0===o.length&&o.push({name:Xa(d),scripted:!1,type:""});var c=o.map((function(e){var t=function(t){var a=fa(e);return"wildcard"!==d.type||null==a||!a.nested||n.nested?t:{nested:{path:a.nested.path,query:t,score_mode:"none"}}},i=q()({},r,Xa(l));if(e.scripted)return{script:zt(e,i)};if("date"===e.type){var s=a.dateFormatTZ?{time_zone:pa(a.dateFormatTZ)}:{};return t({range:q()({},e.name,ke()(ke()({},i),s))})}return t({range:q()({},e.name,i)})}));return{bool:{should:c,minimum_should_match:1}}}function Pa(e){return{arguments:[Xt(e)]}}function Ea(e,t){var a,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=Zt()(e.arguments,1),s=i[0],r=ke()(ke()({},s),{},{value:null!=n&&n.nested?"".concat(n.nested.path,".").concat(s.value):s.value}),l=ea(r),d=null==t||null===(a=t.fields)||void 0===a?void 0:a.find((function(e){return e.name===l}));if(null!=d&&d.scripted)throw new Error("Exists query does not support scripted fields");return{exists:{field:l}}}function Ta(e,t){return{arguments:["string"==typeof e?Ja(e):Xt(e),t]}}function Sa(e,t){var a,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=Zt()(e.arguments,2),r=s[0],l=s[1],d=Xa(r),o=null!=i&&null!==(a=i.nested)&&void 0!==a&&a.path?"".concat(i.nested.path,".").concat(d):d;return{nested:{path:o,query:Xa(l,t,n,ke()(ke()({},i),{},{nested:{path:o}})),score_mode:"none"}}}var wa={is:s,and:r,or:l,not:d,range:o,exists:c,nested:u};function Ca(e){var t=wa[e];if(Ce.a.isUndefined(t))throw new Error('Unknown function "'.concat(e,'"'));for(var a=arguments.length,n=new Array(a>1?a-1:0),i=1;i<a;i++)n[i-1]=arguments[i];return ke()({type:"function",function:e},t.buildNodeParams.apply(t,n))}function Ia(e,t){if(Ce.a.isUndefined(wa[e]))throw new Error('Unknown function "'.concat(e,'"'));return{type:"function",function:e,arguments:t}}function La(e,t,a,n){return wa[e.function].toElasticsearchQuery(e,t,a,n)}var Da={function:p,literal:n,wildcard:i},Aa=a(31),_a=a.n(Aa),Na=a(32),ka=a.n(Na),Ra=a(36),Ba=a.n(Ra),Va=a(37),Ua=a.n(Va),qa=a(38),Ha=a.n(qa),za=a(39),Ga=a.n(za),Wa=h.i18n.translate("esQuery.kql.errors.endOfInputText",{defaultMessage:"end of input"}),Ka={fieldName:h.i18n.translate("esQuery.kql.errors.fieldNameText",{defaultMessage:"field name"}),value:h.i18n.translate("esQuery.kql.errors.valueText",{defaultMessage:"value"}),literal:h.i18n.translate("esQuery.kql.errors.literalText",{defaultMessage:"literal"}),whitespace:h.i18n.translate("esQuery.kql.errors.whitespaceText",{defaultMessage:"whitespace"})},$a=function(e){Ua()(a,e);var t=Ha()(a);function a(e,n){var i;ka()(this,a);var s=e.message;if(e.expected){var r=e.expected.map((function(e){var t,a="other"===(t=e).type?t.description:"literal"===t.type?'"'.concat(t.text,'"'):"end"===t.type?"end of input":t.text||t.description||"";return Ka[a]||a})),l=Object(we.uniq)(r).filter((function(e){return void 0!==e})).sort().join(", ");s=h.i18n.translate("esQuery.kql.errors.syntaxError",{defaultMessage:"Expected {expectedList} but {foundInput} found.",values:{expectedList:l,foundInput:e.found?'"'.concat(e.found,'"'):Wa}})}var d=[s,n,Object(we.repeat)("-",e.location.start.offset)+"^"].join("\n");return i=t.call(this,d),q()(Ba()(i),"shortMessage",void 0),i.name="KQLSyntaxError",i.shortMessage=s,i}return _a()(a)}(Ga()(Error)),Qa=a(33),Ya=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Qa.parse;if(void 0===e)throw new Error("expression must be a string, got undefined instead");return a(e,ke()(ke()({},t),{},{helpers:{nodeTypes:Da}}))},Ja=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Ya(e,ke()(ke()({},t),{},{startRule:"Literal"}),Qa.parse)},Za=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return Ya(e,t,Qa.parse)}catch(t){throw"SyntaxError"===t.name?new $a(t,e):t}},Xa=function e(t,a){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0;if(!t||!t.type||!Da[t.type])return e(Da.function.buildNode("and",[]),a);var s=Da[t.type];return s.toElasticsearchQuery(t,a,n,i)};Object(we.flow)((function(e){return e.replace(/[\\():<>"*]/g,"\\$&")}),(function(e){return e.replace(/(\s+)(and|or)(\s+)/gi,"$1\\$2$3")}),(function(e){return e.replace(/not(\s+)/gi,"\\$&")}),(function(e){return e.replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/\n/g,"\\n")}));var en=function(){return Xa.apply(void 0,arguments)};function tn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3?arguments[3]:void 0,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=t.map((function(e){return Za(e.query,{allowLeadingWildcards:a})}));return an(e,s,{dateFormatTZ:n,filtersInMustClause:i})}function an(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=Da.function.buildNode("and",t),i=en(n,e,a);return Object.assign({must:[],filter:[],should:[],must_not:[]},i.bool)}function nn(e,t){var a,n;return null===(a=e.meta)||void 0===a||!a.key||!t||("custom"===(null===(n=e.meta)||void 0===n?void 0:n.type)?e.meta.index===t.id:t.fields.some((function(t){return t.name===e.meta.key})))}var sn=function(e,t){if(!t)return e;var a=Gt(e);if(!a)return e;var n=t.fields.find((function(e){return e.name===a})),i=n&&fa(n);if(!i)return e;var s=Kt(e);return{meta:e.meta,query:{nested:{path:i.nested.path,query:s.query||s}}}},rn=function(e){return function(t){return Object(we.isUndefined)(t.meta)||Object(we.isUndefined)(t.meta.negate)?!e:t.meta&&t.meta.negate===e}},ln=function(e){return e.query||e},dn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e=e.filter((function(e){return e&&!Wt(e)}));var n=function(n){return e.filter((function(e){return!!e})).filter(rn(n)).filter((function(e){return!a||nn(e,t)})).map((function(e){return $t(e,t)})).map((function(e){return sn(e,t)})).map(Kt).map(ln)};return{must:[],filter:n(!1),should:[],must_not:n(!0)}};function on(e,t,a){return{must:(e||[]).map((function(e){var n=function(e){return Object(we.isString)(e)?""===e.trim()?{match_all:{}}:{query_string:{query:e}}:e}(e.query);return function(e,t,a){return function(e){return Object(we.has)(e,"query_string.query")}(e)&&("string"==typeof t&&(t=JSON.parse(t)),Object(we.extend)(e.query_string,t),a&&Object(we.defaults)(e.query_string,{time_zone:pa(a)})),e}(n,t,a)})),filter:[],should:[],must_not:[]}}function cn(e){return e.filter((function(e){return!e||"object"!==kt()(e)||!Object(we.isEqual)(e,{match_all:{}})}))}var un=a(21);class test_script_TestScript extends f.Component{constructor(...e){super(...e),q()(this,"defaultProps",{name:"myScriptedField"}),q()(this,"state",{isLoading:!1,additionalFields:[],previewData:void 0}),q()(this,"previewScript",(async e=>{var t;const{indexPattern:a,name:n,script:i,executeScript:s}=this.props;if(!i||0===i.length)return;let r;if(this.setState({isLoading:!0}),e){const t=Object(un.getEsQueryConfig)(this.context.services.uiSettings);r=function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{allowLeadingWildcards:!1,queryStringOptions:{},ignoreFilterIfFieldNotInIndex:!1};t=Array.isArray(t)?t:[t],a=Array.isArray(a)?a:[a];var i=t.filter((function(e){return Object(we.has)(e,"query")})),s=Object(we.groupBy)(i,"language"),r=tn(e,s.kuery,n.allowLeadingWildcards,n.dateFormatTZ,n.filtersInMustClause),l=on(s.lucene,n.queryStringOptions,n.dateFormatTZ),d=dn(a,e,n.ignoreFilterIfFieldNotInIndex);return{bool:{must:cn([].concat(Yt()(r.must),Yt()(l.must),Yt()(d.must))),filter:cn([].concat(Yt()(r.filter),Yt()(l.filter),Yt()(d.filter))),should:cn([].concat(Yt()(r.should),Yt()(l.should),Yt()(d.should))),must_not:[].concat(Yt()(r.must_not),Yt()(l.must_not),Yt()(d.must_not))}}}(this.props.indexPattern,e.query||[],[],t)}const l=await s({name:n,script:i,indexPatternTitle:a.title,query:r,additionalFields:this.state.additionalFields.map((e=>e.value)),http:this.context.services.http});200===l.status?this.setState({isLoading:!1,previewData:null===(t=l.hits)||void 0===t?void 0:t.hits.map((e=>({_id:e._id,...e._source,...e.fields})))}):this.setState({isLoading:!1,previewData:l})})),q()(this,"onAdditionalFieldsChange",(e=>{this.setState({additionalFields:e})}))}componentDidMount(){this.props.script&&this.previewScript()}renderPreview(e){return e?e.error?Object(L.jsx)(O.EuiCallOut,{title:h.i18n.translate("indexPatternManagement.testScript.errorMessage",{defaultMessage:"There's an error in your script"}),color:"danger",iconType:"cross"},Object(L.jsx)(O.EuiCodeBlock,{language:"json",className:"scriptPreviewCodeBlock","data-test-subj":"scriptedFieldPreview"},JSON.stringify(e.error,null," "))):Object(L.jsx)(f.Fragment,null,Object(L.jsx)(O.EuiTitle,{size:"xs"},Object(L.jsx)("p",null,Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.testScript.resultsLabel",defaultMessage:"First 10 results"}))),Object(L.jsx)(O.EuiSpacer,{size:"s"}),Object(L.jsx)(O.EuiCodeBlock,{language:"json",className:"scriptPreviewCodeBlock","data-test-subj":"scriptedFieldPreview"},JSON.stringify(e,null," "))):null}renderToolbar(){const e=new Map,t=[];return this.props.indexPattern.fields.getAll().filter((e=>{const t=e.isSubtypeMulti();return!e.name.startsWith("_")&&!t&&!e.scripted})).forEach((t=>{if(e.has(t.type)){const a=e.get(t.type);a.push(t.name),e.set(t.type,a)}else e.set(t.type,[t.name])})),e.forEach(((e,a)=>{t.push({label:a,options:e.sort().map((e=>({value:e,label:e})))})})),t.sort(((e,t)=>e.label<t.label?-1:e.label>t.label?1:0)),Object(L.jsx)(f.Fragment,null,Object(L.jsx)(O.EuiFormRow,{label:h.i18n.translate("indexPatternManagement.testScript.fieldsLabel",{defaultMessage:"Additional fields"}),fullWidth:!0},Object(L.jsx)(O.EuiComboBox,{placeholder:h.i18n.translate("indexPatternManagement.testScript.fieldsPlaceholder",{defaultMessage:"Select..."}),options:t,selectedOptions:this.state.additionalFields,onChange:e=>this.onAdditionalFieldsChange(e),"data-test-subj":"additionalFieldsSelect",fullWidth:!0})),Object(L.jsx)(O.EuiSpacer,{size:"s"}),Object(L.jsx)("div",{className:"testScript__searchBar"},Object(L.jsx)(this.context.services.unifiedSearch.ui.SearchBar,{displayStyle:"inPage",appName:"indexPatternManagement",showFilterBar:!1,showDatePicker:!1,showQueryInput:!0,query:this.context.services.data.query.queryString.getDefaultQuery(),onQuerySubmit:this.previewScript,indexPatterns:[this.props.indexPattern],customSubmitButton:Object(L.jsx)(O.EuiButton,{disabled:!this.props.script,isLoading:this.state.isLoading,"data-test-subj":"runScriptButton"},Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.testScript.submitButtonLabel",defaultMessage:"Run script"}))})))}render(){return Object(L.jsx)(f.Fragment,null,Object(L.jsx)(O.EuiSpacer,null),Object(L.jsx)(O.EuiText,null,Object(L.jsx)("h3",null,Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.testScript.resultsTitle",defaultMessage:"Preview results"})),Object(L.jsx)("p",null,Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.testScript.instructions",defaultMessage:"Run your script to preview the first 10 results. You can also select some additional fields to include in your results to gain more context or add a query to filter on specific documents."}))),Object(L.jsx)(O.EuiSpacer,null),this.renderToolbar(),Object(L.jsx)(O.EuiSpacer,null),this.renderPreview(this.state.previewData))}}q()(test_script_TestScript,"contextType",v.context);const pn=({isVisible:e=!1,onClose:t=(()=>{}),indexPattern:a,lang:n,name:i,script:s,executeScript:r})=>{const l=[{id:"syntax",name:"Syntax","data-test-subj":"syntaxTab",content:Object(L.jsx)(Dt,null)},{id:"test",name:"Preview results","data-test-subj":"testTab",content:Object(L.jsx)(test_script_TestScript,{indexPattern:a,lang:n,name:i,script:s,executeScript:r})}];return e?Object(L.jsx)(O.EuiFlyout,{onClose:t,"data-test-subj":"scriptedFieldsHelpFlyout"},Object(L.jsx)(O.EuiFlyoutBody,null,Object(L.jsx)(O.EuiTabbedContent,{tabs:l,initialSelectedTab:l[0]}))):null};pn.displayName="ScriptingHelpFlyout";const fn=Object(we.memoize)((e=>e?g.a.lazy((()=>e().then((e=>({default:e}))))):null));class field_format_editor_FieldFormatEditor extends f.PureComponent{constructor(e){super(e),this.state={EditorComponent:fn(e.fieldFormatEditors.getById(e.fieldFormatId))}}static getDerivedStateFromProps(e){return{EditorComponent:fn(e.fieldFormatEditors.getById(e.fieldFormatId))}}render(){const{EditorComponent:e}=this.state,{fieldType:t,fieldFormat:a,fieldFormatParams:n,onChange:i,onError:s}=this.props;return Object(L.jsx)(g.a.Fragment,null,e?Object(L.jsx)(g.a.Suspense,{fallback:Object(L.jsx)("div",{style:{minHeight:430,marginTop:8}},Object(L.jsx)(O.EuiDelayRender,null,Object(L.jsx)(O.EuiLoadingContent,{lines:4})))},Object(L.jsx)(e,{fieldType:t,format:a,formatParams:n,onChange:i,onError:s})):null)}}var gn,mn;!function(e){e._ID="_id",e._INDEX="_index",e._SOURCE="_source",e._TYPE="_type",e.STRING="string",e.TEXT="text",e.MATCH_ONLY_TEXT="match_only_text",e.KEYWORD="keyword",e.VERSION="version",e.BOOLEAN="boolean",e.OBJECT="object",e.DATE="date",e.DATE_NANOS="date_nanos",e.DATE_RANGE="date_range",e.GEO_POINT="geo_point",e.GEO_SHAPE="geo_shape",e.FLOAT="float",e.HALF_FLOAT="half_float",e.SCALED_FLOAT="scaled_float",e.DOUBLE="double",e.INTEGER="integer",e.LONG="long",e.SHORT="short",e.UNSIGNED_LONG="unsigned_long",e.FLOAT_RANGE="float_range",e.DOUBLE_RANGE="double_range",e.INTEGER_RANGE="integer_range",e.LONG_RANGE="long_range",e.NESTED="nested",e.BYTE="byte",e.IP="ip",e.IP_RANGE="ip_range",e.ATTACHMENT="attachment",e.TOKEN_COUNT="token_count",e.MURMUR3="murmur3",e.HISTOGRAM="histogram"}(gn||(gn={})),function(e){e._SOURCE="_source",e.ATTACHMENT="attachment",e.BOOLEAN="boolean",e.DATE="date",e.DATE_RANGE="date_range",e.GEO_POINT="geo_point",e.GEO_SHAPE="geo_shape",e.IP="ip",e.IP_RANGE="ip_range",e.MURMUR3="murmur3",e.NUMBER="number",e.NUMBER_RANGE="number_range",e.STRING="string",e.UNKNOWN="unknown",e.CONFLICT="conflict",e.OBJECT="object",e.NESTED="nested",e.HISTOGRAM="histogram",e.MISSING="missing"}(mn||(mn={}));var bn=_a()((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ka()(this,e),q()(this,"name",void 0),q()(this,"sortable",void 0),q()(this,"filterable",void 0),q()(this,"esTypes",void 0),this.name=t.name||mn.UNKNOWN,this.sortable=t.sortable||!1,this.filterable=t.filterable||!1,this.esTypes=Object.freeze((t.esTypes||[]).slice())})),jn=new bn({name:mn.UNKNOWN}),hn=[new bn({name:mn.STRING,sortable:!0,filterable:!0,esTypes:[gn.STRING,gn.TEXT,gn.MATCH_ONLY_TEXT,gn.KEYWORD,gn.VERSION,gn._TYPE,gn._ID]}),new bn({name:mn.NUMBER,sortable:!0,filterable:!0,esTypes:[gn.FLOAT,gn.HALF_FLOAT,gn.SCALED_FLOAT,gn.DOUBLE,gn.INTEGER,gn.LONG,gn.UNSIGNED_LONG,gn.SHORT,gn.BYTE,gn.TOKEN_COUNT]}),new bn({name:mn.NUMBER_RANGE,sortable:!0,filterable:!0,esTypes:[gn.FLOAT_RANGE,gn.DOUBLE_RANGE,gn.INTEGER_RANGE,gn.LONG_RANGE]}),new bn({name:mn.DATE,sortable:!0,filterable:!0,esTypes:[gn.DATE,gn.DATE_NANOS]}),new bn({name:mn.DATE_RANGE,sortable:!0,filterable:!0,esTypes:[gn.DATE_RANGE]}),new bn({name:mn.IP,sortable:!0,filterable:!0,esTypes:[gn.IP]}),new bn({name:mn.IP_RANGE,sortable:!0,filterable:!0,esTypes:[gn.IP_RANGE]}),new bn({name:mn.BOOLEAN,sortable:!0,filterable:!0,esTypes:[gn.BOOLEAN]}),new bn({name:mn.OBJECT,esTypes:[gn.OBJECT]}),new bn({name:mn.NESTED,esTypes:[gn.NESTED]}),new bn({name:mn.GEO_POINT,esTypes:[gn.GEO_POINT]}),new bn({name:mn.GEO_SHAPE,esTypes:[gn.GEO_SHAPE]}),new bn({name:mn.ATTACHMENT,esTypes:[gn.ATTACHMENT]}),new bn({name:mn.MURMUR3,esTypes:[gn.MURMUR3]}),new bn({name:mn._SOURCE,esTypes:[gn._SOURCE]}),new bn({name:mn.HISTOGRAM,filterable:!0,esTypes:[gn.HISTOGRAM]}),new bn({name:mn.CONFLICT}),jn];const xn={painless:["number","string","date","boolean"],expression:["number"]},vn=hn.filter((function(e){return e.name})).map((function(e){return e.name})),On=async({name:e,script:t,indexPatternTitle:a,query:n,additionalFields:i=[],http:s})=>s.post("/internal/index-pattern-management/preview_scripted_field",{body:JSON.stringify({index:a,name:e,script:t,query:n,additionalFields:i})}).then((e=>({status:e.statusCode,hits:e.body.hits}))).catch((e=>({status:e.statusCode,error:e.body.attributes.error}))),yn=(e,t,a)=>{const n=a.getByFieldType(e.type).map((({id:e,title:t})=>({id:e,title:t})));return[{id:"",defaultFieldFormat:t,title:h.i18n.translate("indexPatternManagement.defaultFormatDropDown",{defaultMessage:"- Default -"})},...n]};class field_editor_FieldEditor extends f.PureComponent{constructor(e,t){super(e,t),q()(this,"supportedLangs",[]),q()(this,"deprecatedLangs",[]),q()(this,"onFieldChange",((e,t)=>{const{spec:a}=this.state;a[e]=t,this.forceUpdate()})),q()(this,"onTypeChange",(e=>{const{fieldFormats:t}=this.context.services,{spec:a,format:n}=this.state,i=t.getDefaultType(e);a.type=e,this.setState({fieldTypeFormats:yn(a,i,t),fieldFormatId:i.id,fieldFormatParams:n.params()})})),q()(this,"onLangChange",(e=>{const{spec:t}=this.state,a=Object(we.get)(xn,e,vn);t.lang=e,t.type=a.includes(t.type)?t.type:a[0],this.setState({fieldTypes:a})})),q()(this,"onFormatChange",((e,t)=>{const{fieldTypeFormats:a}=this.state,{uiSettings:n,fieldFormats:i}=this.context.services,s=new(i.getType(e||a[0].defaultFieldFormat.id))(t,(e=>n.get(e)));this.setState({fieldFormatId:e,fieldFormatParams:t,format:s})})),q()(this,"onFormatParamsChange",(e=>{const{fieldFormatId:t}=this.state;this.onFormatChange(t,e)})),q()(this,"onFormatParamsError",(e=>{this.setState({hasFormatError:!!e})})),q()(this,"onScriptChange",(e=>{this.setState({hasScriptError:!1}),this.onFieldChange("script",e)})),q()(this,"showScriptingHelp",(()=>{this.setState({showScriptingHelp:!0})})),q()(this,"hideScriptingHelp",(()=>{this.setState({showScriptingHelp:!1})})),q()(this,"renderDeleteModal",(()=>{const{spec:e}=this.state;return this.state.showDeleteModal?Object(L.jsx)(O.EuiConfirmModal,{title:h.i18n.translate("indexPatternManagement.deleteFieldHeader",{defaultMessage:"Delete field '{fieldName}'",values:{fieldName:e.name}}),onCancel:this.hideDeleteModal,onConfirm:()=>{this.hideDeleteModal(),this.deleteField()},cancelButtonText:h.i18n.translate("indexPatternManagement.deleteField.cancelButton",{defaultMessage:"Cancel"}),confirmButtonText:h.i18n.translate("indexPatternManagement.deleteField.deleteButton",{defaultMessage:"Delete"}),buttonColor:"danger",defaultFocusedButton:O.EUI_MODAL_CONFIRM_BUTTON},Object(L.jsx)("p",null,Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.deleteFieldLabel",defaultMessage:"You can't recover a deleted field.{separator}Are you sure you want to do this?",values:{separator:Object(L.jsx)("span",null,Object(L.jsx)("br",null),Object(L.jsx)("br",null))}}))):null})),q()(this,"showDeleteModal",(()=>{this.setState({showDeleteModal:!0})})),q()(this,"hideDeleteModal",(()=>{this.setState({showDeleteModal:!1})})),q()(this,"renderScriptingPanels",(()=>{const{scriptingLangs:e,spec:t,showScriptingHelp:a}=this.state;if(t.scripted)return Object(L.jsx)(f.Fragment,null,Object(L.jsx)(It,{isVisible:!e.length}),Object(L.jsx)(Lt,{isVisible:!0}),Object(L.jsx)(pn,{isVisible:a,onClose:this.hideScriptingHelp,indexPattern:this.props.indexPattern,lang:t.lang,name:t.name,script:t.script,executeScript:On}))})),q()(this,"deleteField",(()=>{const{redirectAway:e,indexPatternService:t}=this.props.services,{indexPattern:a}=this.props,{spec:n}=this.state;a.removeScriptedField(n.name),t.updateSavedObject(a).then((()=>{const t=h.i18n.translate("indexPatternManagement.deleteField.deletedHeader",{defaultMessage:"Deleted '{fieldName}'",values:{fieldName:n.name}});this.context.services.notifications.toasts.addSuccess(t),e()}))})),q()(this,"saveField",(async()=>{const e=this.state.spec,{indexPattern:t}=this.props,{fieldFormatId:a,fieldFormatParams:n,customLabel:i}=this.state;if(e.scripted&&(this.setState({isSaving:!0}),!await(async({name:e,script:t,indexPatternTitle:a,http:n})=>200===(await On({name:e,script:t,indexPatternTitle:a,http:n})).status)({name:e.name,script:e.script,indexPatternTitle:t.title,http:this.context.services.http})))return void this.setState({hasScriptError:!0,isSaving:!1});const{redirectAway:s,indexPatternService:r}=this.props.services;let l;return t.fields.getByName(e.name)?(l=t.fields.getByName(e.name).spec,t.fields.update(e)):t.fields.add(e),a?t.setFieldFormat(e.name,{id:a,params:n}):t.deleteFieldFormat(e.name),e.customLabel!==i&&(e.customLabel=i,t.fields.update(e)),r.updateSavedObject(t).then((()=>{const t=h.i18n.translate("indexPatternManagement.deleteField.savedHeader",{defaultMessage:"Saved '{fieldName}'",values:{fieldName:e.name}});this.context.services.notifications.toasts.addSuccess(t),s()})).catch((()=>{l?t.fields.update(l):t.fields.remove(e)}))}));const{spec:a,indexPattern:n}=e;this.state={isReady:!1,isCreating:!1,isDeprecatedLang:!1,scriptingLangs:[],fieldTypes:[],fieldTypeFormats:[],existingFieldNames:n.fields.getAll().map((e=>e.name)),fieldFormatId:void 0,fieldFormatParams:{},showScriptingHelp:!1,showDeleteModal:!1,hasFormatError:!1,hasScriptError:!1,isSaving:!1,format:e.indexPattern.getFormatterForField(a),spec:{...a},customLabel:""},this.supportedLangs=["painless"],this.deprecatedLangs=[],this.init(t)}async init(e){var t,a;const{http:n,notifications:i,fieldFormats:s}=e.services,{format:r,spec:l}=this.state,{indexPattern:d}=this.props,o=await((e,t)=>e.get("/api/kibana/scripts/languages").catch((()=>(t.addDanger(h.i18n.translate("indexPatternManagement.scriptingLanguages.errorFetchingToastDescription",{defaultMessage:"Error getting available scripting languages from Elasticsearch"})),[]))))(n,i.toasts),c=Object(we.intersection)(o,Object(we.union)(this.supportedLangs,this.deprecatedLangs));l.lang=l.lang&&c.includes(l.lang)?l.lang:void 0,l.scripted&&!l.lang&&(l.lang=c[0]);const u=Object(we.get)(xn,l.lang||"",vn);l.type=u.includes(l.type)?l.type:u[0];const p=s.getDefaultType(l.type,l.esTypes);this.setState({isReady:!0,isCreating:!d.fields.getByName(l.name),isDeprecatedLang:this.deprecatedLangs.includes(l.lang||""),errors:[],scriptingLangs:c,fieldTypes:u,fieldTypeFormats:yn(l,p,s),fieldFormatId:null===(t=d.getFormatterForFieldNoDefault(l.name))||void 0===t||null===(a=t.type)||void 0===a?void 0:a.id,customLabel:l.customLabel||"",fieldFormatParams:r.params()})}isDuplicateName(){const{isCreating:e,spec:t,existingFieldNames:a}=this.state;return e&&a.includes(t.name)}renderName(){var e;const{isCreating:t,spec:a}=this.state,n=null==a||null===(e=a.name)||void 0===e?void 0:e.includes("*"),i=!a.name||!a.name.trim()||n;return t?Object(L.jsx)(O.EuiFormRow,{label:h.i18n.translate("indexPatternManagement.nameLabel",{defaultMessage:"Name"}),helpText:this.isDuplicateName()?Object(L.jsx)("span",null,Object(L.jsx)(O.EuiIcon,{type:"alert",color:"warning",size:"s"})," ",Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.mappingConflictLabel.mappingConflictDetail",defaultMessage:"{mappingConflict} You already have a field with the name {fieldName}. Naming your scripted field with the same name means you won't be able to query both fields at the same time.",values:{mappingConflict:Object(L.jsx)("strong",null,Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.mappingConflictLabel.mappingConflictLabel",defaultMessage:"Mapping Conflict:"})),fieldName:Object(L.jsx)(O.EuiCode,null,a.name)}})):null,isInvalid:i,error:i&&(n?h.i18n.translate("indexPatternManagement.starCharacterNotAllowedValidationErrorMessage",{defaultMessage:"The field cannot have * in the name."}):h.i18n.translate("indexPatternManagement.nameErrorMessage",{defaultMessage:"Name is required"}))},Object(L.jsx)(O.EuiFieldText,{value:a.name||"",placeholder:h.i18n.translate("indexPatternManagement.namePlaceholder",{defaultMessage:"New scripted field"}),"data-test-subj":"editorFieldName",onChange:e=>{this.onFieldChange("name",e.target.value)},isInvalid:i})):null}renderLanguage(){const{spec:e,scriptingLangs:t,isDeprecatedLang:a}=this.state;return e.scripted?Object(L.jsx)(O.EuiFormRow,{label:h.i18n.translate("indexPatternManagement.languageLabel",{defaultMessage:"Language"}),helpText:a?Object(L.jsx)("span",null,Object(L.jsx)(O.EuiIcon,{type:"alert",color:"warning",size:"s"})," ",Object(L.jsx)("strong",null,Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.warningHeader",defaultMessage:"Deprecation Warning:"}))," ",Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.warningLabel.warningDetail",defaultMessage:"{language} is deprecated and support will be removed in the next major version of Kibana and Elasticsearch. We recommend using {painlessLink} for new scripted fields.",values:{language:Object(L.jsx)(O.EuiCode,null,e.lang),painlessLink:Object(L.jsx)(O.EuiLink,{target:"_blank",href:this.context.services.docLinks.links.scriptedFields.painless},Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.warningLabel.painlessLinkLabel",defaultMessage:"Painless"}))}})):null},Object(L.jsx)(O.EuiSelect,{value:e.lang,options:t.map((e=>({value:e,text:e}))),"data-test-subj":"editorFieldLang",onChange:e=>{this.onLangChange(e.target.value)}})):null}renderType(){const{spec:e,fieldTypes:t}=this.state;return Object(L.jsx)(O.EuiFormRow,{label:h.i18n.translate("indexPatternManagement.typeLabel",{defaultMessage:"Type"})},Object(L.jsx)(O.EuiSelect,{value:e.type,disabled:!e.scripted,options:t.map((e=>({value:e,text:e}))),"data-test-subj":"editorFieldType",onChange:e=>{this.onTypeChange(e.target.value)}}))}renderCustomLabel(){const{customLabel:e,spec:t}=this.state;return Object(L.jsx)(O.EuiFormRow,{label:h.i18n.translate("indexPatternManagement.customLabel",{defaultMessage:"Custom label"}),helpText:Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.labelHelpText",defaultMessage:"Set a custom label to use when this field is displayed in Discover, Maps, and Visualize. Queries and filters don't currently support a custom label and will use the original field name."})},Object(L.jsx)(O.EuiFieldText,{value:e||"",placeholder:t.name,"data-test-subj":"editorFieldCustomLabel",onChange:e=>{this.setState({customLabel:e.target.value})}}))}renderTypeConflict(){const{spec:e}=this.state;if(!e.conflictDescriptions||"object"!=typeof e.conflictDescriptions)return null;const t=[{field:"type",name:h.i18n.translate("indexPatternManagement.typeLabel",{defaultMessage:"Type"}),width:"100px"},{field:"indices",name:h.i18n.translate("indexPatternManagement.indexNameLabel",{defaultMessage:"Index names"})}],a=Object.entries(e.conflictDescriptions).map((([e,t])=>({type:e,indices:Array.isArray(t)?t.join(", "):"Index names unavailable"})));return Object(L.jsx)("div",null,Object(L.jsx)(O.EuiSpacer,{size:"m"}),Object(L.jsx)(O.EuiCallOut,{color:"warning",iconType:"alert",title:Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.fieldTypeConflict",defaultMessage:"Field type conflict"}),size:"s"},Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.multiTypeLabelDesc",defaultMessage:"The type of this field changes across indices. It is unavailable for many analysis functions. The indices per type are as follows:"})),Object(L.jsx)(O.EuiSpacer,{size:"m"}),Object(L.jsx)(O.EuiBasicTable,{items:a,columns:t}),Object(L.jsx)(O.EuiSpacer,{size:"m"}))}renderFormat(){const{spec:e,fieldTypeFormats:t,fieldFormatId:a,fieldFormatParams:n,format:i}=this.state,{fieldFormatEditors:s}=this.context.services,r=t[0].defaultFieldFormat.title,l=r?Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.defaultFormatHeader",defaultMessage:"Format (Default: {defaultFormat})",values:{defaultFormat:Object(L.jsx)(O.EuiCode,null,r)}}):Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.formatHeader",defaultMessage:"Format"});return Object(L.jsx)(f.Fragment,null,Object(L.jsx)(O.EuiFormRow,{label:l,helpText:Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.formatLabel",defaultMessage:"Formatting controls how values are displayed. Changing this setting might also affect the field value and highlighting in Discover."})},Object(L.jsx)(O.EuiSelect,{value:a,options:t.map((e=>({value:e.id||"",text:e.title}))),"data-test-subj":"editorSelectedFormatId",onChange:e=>{this.onFormatChange(e.target.value)}})),a?Object(L.jsx)(field_format_editor_FieldFormatEditor,{fieldType:e.type,fieldFormat:i,fieldFormatId:a,fieldFormatParams:n||{},fieldFormatEditors:s,onChange:this.onFormatParamsChange,onError:this.onFormatParamsError}):null)}renderPopularity(){const{spec:e}=this.state;return Object(L.jsx)(O.EuiFormRow,{label:h.i18n.translate("indexPatternManagement.popularityLabel",{defaultMessage:"Popularity",description:'"Popularity" refers to Kibana\'s measurement how popular a field is (i.e. how commonly it is used).'})},Object(L.jsx)(O.EuiFieldNumber,{value:e.count,"data-test-subj":"editorFieldCount",onChange:e=>{this.onFieldChange("count",e.target.value?Number(e.target.value):"")}}))}renderScript(){var e;const{spec:t,hasScriptError:a}=this.state,n=!t.script||!t.script.trim()||a,i=a?Object(L.jsx)("span",{"data-test-subj":"invalidScriptError"},Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.scriptInvalidErrorMessage",defaultMessage:"Script is invalid. View script preview for details"})):Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.scriptRequiredErrorMessage",defaultMessage:"Script is required"});return t.scripted?Object(L.jsx)(f.Fragment,null,Object(L.jsx)(O.EuiFormRow,{fullWidth:!0,label:h.i18n.translate("indexPatternManagement.scriptLabel",{defaultMessage:"Script"}),isInvalid:n,error:n?i:null},Object(L.jsx)(v.CodeEditor,{languageId:Ct.PainlessLang.ID,width:"100%",height:"300px",value:null!==(e=t.script)&&void 0!==e?e:"",onChange:this.onScriptChange,"data-test-subj":"editorFieldScript","aria-label":h.i18n.translate("indexPatternManagement.scriptLabelAriaLabel",{defaultMessage:"Script editor"})})),Object(L.jsx)(O.EuiFormRow,null,Object(L.jsx)(f.Fragment,null,Object(L.jsx)(O.EuiText,null,Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.script.accessWithLabel",defaultMessage:"Access fields with {code}.",values:{code:Object(L.jsx)("code",null,"doc['some_field'].value")}})),Object(L.jsx)("br",null),Object(L.jsx)(O.EuiLink,{onClick:this.showScriptingHelp,"data-test-subj":"scriptedFieldsHelpLink"},Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.script.getHelpLabel",defaultMessage:"Get help with the syntax and preview the results of your script."}))))):null}renderActions(){const{isCreating:e,spec:t,isSaving:a}=this.state,{redirectAway:n}=this.props.services;return Object(L.jsx)(O.EuiFormRow,null,Object(L.jsx)(O.EuiFlexGroup,null,Object(L.jsx)(O.EuiFlexItem,{grow:!1},Object(L.jsx)(O.EuiButton,{fill:!0,onClick:this.saveField,isDisabled:this.isSavingDisabled(),isLoading:a,"data-test-subj":"fieldSaveButton"},e?Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.actions.createButton",defaultMessage:"Create field"}):Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.actions.saveButton",defaultMessage:"Save field"}))),Object(L.jsx)(O.EuiFlexItem,{grow:!1},Object(L.jsx)(O.EuiButtonEmpty,{onClick:n,"data-test-subj":"fieldCancelButton"},Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.actions.cancelButton",defaultMessage:"Cancel"}))),!e&&t.scripted?Object(L.jsx)(O.EuiFlexItem,null,Object(L.jsx)(O.EuiFlexGroup,{justifyContent:"flexEnd"},Object(L.jsx)(O.EuiFlexItem,{grow:!1},Object(L.jsx)(O.EuiButtonEmpty,{color:"danger",onClick:this.showDeleteModal},Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.actions.deleteButton",defaultMessage:"Delete"}))))):null))}isSavingDisabled(){const{spec:e,hasFormatError:t,hasScriptError:a}=this.state;return!(!t&&!a&&e.name&&e.name.trim()&&(!e.scripted||e.script&&e.script.trim()))}render(){const{isReady:e,isCreating:t,spec:a}=this.state;return e?Object(L.jsx)("div",null,Object(L.jsx)(O.EuiText,null,Object(L.jsx)("h3",null,t?Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.createHeader",defaultMessage:"Create scripted field"}):Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.editHeader",defaultMessage:"Edit {fieldName}",values:{fieldName:a.name}}))),Object(L.jsx)(O.EuiSpacer,{size:"m"}),Object(L.jsx)(O.EuiForm,null,this.renderScriptingPanels(),this.renderName(),this.renderCustomLabel(),this.renderLanguage(),this.renderType(),this.renderTypeConflict(),this.renderFormat(),this.renderPopularity(),this.renderScript(),this.renderActions(),this.renderDeleteModal()),Object(L.jsx)(O.EuiSpacer,{size:"l"})):null}}q()(field_editor_FieldEditor,"contextType",v.context);const Mn=h.i18n.translate("indexPatternManagement.editIndexPattern.scripted.newFieldPlaceholder",{defaultMessage:"New Scripted Field"}),Fn=Object(j.withRouter)((({indexPattern:e,mode:t,fieldName:a,history:n})=>{var i;const{uiSettings:s,chrome:r,notifications:l,dataViews:d}=Object(v.useKibana)().services,o="edit"===t&&a?null===(i=e.fields.getByName(a))||void 0===i?void 0:i.spec:{scripted:!0,type:"number",name:void 0},c=`/dataView/${e.id}`;if("edit"===t&&!o){const t=h.i18n.translate("indexPatternManagement.editDataView.scripted.noFieldLabel",{defaultMessage:"'{dataViewTitle}' data view doesn't have a scripted field called '{fieldName}'",values:{dataViewTitle:e.title,fieldName:a}});l.toasts.addWarning(t),n.push(c)}const u=(null==o?void 0:o.name)||Mn;r.docTitle.change([u,e.title]);return o?Object(L.jsx)(g.a.Fragment,null,Object(L.jsx)(Ot,{indexPattern:e,defaultIndex:s.get("defaultIndex"),canSave:d.getCanSaveSync()}),Object(L.jsx)(O.EuiSpacer,{size:"l"}),Object(L.jsx)(field_editor_FieldEditor,{indexPattern:e,spec:o,services:{indexPatternService:d,redirectAway:()=>{n.push(`${c}#/?_a=(tab:${null!=o&&o.scripted?R:k})`)}}})):Object(L.jsx)(g.a.Fragment,null)})),Pn=Object(j.withRouter)((({...e})=>{const{setBreadcrumbs:t,dataViews:a}=Object(v.useKibana)().services,[n,i]=Object(f.useState)(),s=e.match.params.fieldName&&decodeURIComponent(e.match.params.fieldName);return Object(f.useEffect)((()=>{a.get(e.match.params.id).then((e=>{i(e),e&&t(s?function(e,t){return[...S(e),{text:t}]}(e,s):function(e){return[...S(e),{text:h.i18n.translate("indexPatternManagement.indexPatterns.createFieldBreadcrumb",{defaultMessage:"Create field"})}]}(e))}))}),[e.match.params.id,s,t,a]),n?Object(L.jsx)(Fn,{indexPattern:n,mode:s?"edit":"create",fieldName:s}):Object(L.jsx)(g.a.Fragment,null)})),En=h.i18n.translate("indexPatternManagement.dataViewTable.spaceCountAll",{defaultMessage:"all"}),Tn=h.i18n.translate("indexPatternManagement.dataViewTable.dataViewColumnName",{defaultMessage:"Data view"}),Sn=h.i18n.translate("indexPatternManagement.dataViewTable.spacesColumnName",{defaultMessage:"Spaces"}),wn=h.i18n.translate("indexPatternManagement.dataViewTable.tableTitle",{defaultMessage:"Data views selected for deletion"}),Cn=(e,t)=>{const a=[{field:"title",name:Tn,sortable:!0}];return t&&a.push({field:"namespaces",name:Sn,sortable:!0,width:"100px",align:"right",render:e=>-1!==e.indexOf("*")?En:e.length}),Object(L.jsx)("div",null,Object(L.jsx)(O.EuiCallOut,{color:"warning",iconType:"alert",title:"Data views are deleted from every space they are shared in."}),Object(L.jsx)(O.EuiSpacer,{size:"m"}),Object(L.jsx)("div",null,Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.dataViewTable.deleteConfirmSummary",defaultMessage:"You'll permanently delete {count, number} {count, plural, one {data view} other {data views}\n}.",values:{count:e.length}})),Object(L.jsx)(O.EuiSpacer,{size:"m"}),Object(L.jsx)(O.EuiBasicTable,{tableCaption:wn,items:e,columns:a}))},In={initialPageSize:10,pageSizeOptions:[5,10,25,50]},Ln={sort:{field:"title",direction:"asc"}},Dn=h.i18n.translate("indexPatternManagement.dataViewTable.title",{defaultMessage:"Data Views"}),An=h.i18n.translate("indexPatternManagement.indexPatternTable.badge.securityDataViewTitle",{defaultMessage:"Security Data View"}),_n=({children:e})=>Object(L.jsx)(g.a.Fragment,null,e),Nn=Object(j.withRouter)((({history:e,canSave:t,showCreateDialog:a=!1})=>{const{setBreadcrumbs:n,uiSettings:i,indexPatternManagementStart:s,application:r,chrome:l,dataViews:d,IndexPatternEditor:o,spaces:c,overlays:u}=Object(v.useKibana)().services,[p,m]=Object(f.useState)(""),[b,y]=Object(f.useState)([]),[M,F]=Object(f.useState)(!0),[E,S]=Object(f.useState)(a),[w,C]=Object(f.useState)([]),I=(()=>{const e=Ft({dataViews:d,overlays:u,uiSettings:i,onDelete:()=>{C([]),_()}});if(0!==w.length)return Object(L.jsx)(O.EuiButton,{color:"danger",iconType:"trash",onClick:()=>e(w,Cn(w,!!c))},Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.dataViewTable.deleteButtonLabel",defaultMessage:"Delete {selectedItems, number} {selectedItems, plural, one {Data View} other {Data Views}\n}",values:{selectedItems:w.length}}))})(),D={toolsLeft:I&&[I],query:p,onChange:({queryText:e,error:t})=>{t||m(e)},box:{incremental:!0,schema:{fields:{title:{type:"string"}}}}},_=Object(f.useCallback)((async()=>{F(!0);const e=await async function(e,t){return(await t.getIdsWithTitle(!0)).map((t=>{const{id:a,title:n,namespaces:i}=t,s=e===a;return{id:a,namespaces:i,title:n,default:s,tags:P(t,s),sort:`${s?"0":"1"}${n}`}})).sort(((e,t)=>e.sort<t.sort?-1:e.sort>t.sort?1:0))||[]}(i.get("defaultIndex"),d);return y(e),F(!1),e}),[d,i]);n(T()),Object(f.useEffect)((()=>{!async function(){0!==(await _()).length&&await d.hasUserDataView().catch((()=>!1))||S(!0)}()}),[s,i,d,_]),l.docTitle.change(Dn);const N="rollup"===new URLSearchParams(Object(j.useLocation)().search).get("type"),k=Object(f.useMemo)((()=>c?c.ui.components.getSpacesContextProvider:_n),[c]),R=Ft({dataViews:d,uiSettings:i,overlays:u,onDelete:()=>_()}),B={name:"Actions",field:"id",width:"10%",actions:[{name:h.i18n.translate("indexPatternManagement.dataViewTable.columnDelete",{defaultMessage:"Delete"}),description:h.i18n.translate("indexPatternManagement.dataViewTable.columnDeleteDescription",{defaultMessage:"Delete this data view"}),icon:"trash",color:"danger",type:"icon",onClick:e=>R([e],Cn([e],!!c)),isPrimary:!0,"data-test-subj":"action-delete"}]},V=[{field:"title",name:h.i18n.translate("indexPatternManagement.dataViewTable.nameColumn",{defaultMessage:"Name"}),width:"70%",render:(t,a)=>{var n,i;return Object(L.jsx)("div",null,Object(L.jsx)(O.EuiLink,Object(v.reactRouterNavigate)(e,`patterns/${a.id}`),t),0===(null==a||null===(n=a.id)||void 0===n?void 0:n.indexOf("security-solution"))&&Object(L.jsx)(g.a.Fragment,null," ",Object(L.jsx)(O.EuiBadge,null,An)),null==a||null===(i=a.tags)||void 0===i?void 0:i.map((({key:e,name:t})=>Object(L.jsx)(g.a.Fragment,null," ",Object(L.jsx)(O.EuiBadge,{key:e},t)))))},dataType:"string",sortable:({sort:e})=>e},{field:"namespaces",name:h.i18n.translate("indexPatternManagement.dataViewTable.spacesColumn",{defaultMessage:"Spaces"}),width:"20%",render:(e,t)=>c?Object(L.jsx)(A,{spacesApi:c,capabilities:null==r?void 0:r.capabilities,spaceIds:t.namespaces||[],id:t.id,title:t.title,refresh:()=>{d.clearCache(t.id),_()}}):Object(L.jsx)(g.a.Fragment,null)}];d.getCanSaveSync()&&V.push(B);const U=t?Object(L.jsx)(O.EuiButton,{fill:!0,iconType:"plusInCircle",onClick:()=>S(!0),"data-test-subj":"createIndexPatternButton"},Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.dataViewTable.createBtn",defaultMessage:"Create data view"})):Object(L.jsx)(g.a.Fragment,null);if(M)return Object(L.jsx)(g.a.Fragment,null);const q=E?Object(L.jsx)(o,{onSave:t=>{e.push(`patterns/${t.id}`)},onCancel:()=>S(!1),defaultTypeIsRollup:N}):Object(L.jsx)(g.a.Fragment,null),H={onSelectionChange:C};return Object(L.jsx)("div",{"data-test-subj":"indexPatternTable",role:"region","aria-label":Dn},Object(L.jsx)(O.EuiPageHeader,{pageTitle:Dn,description:Object(L.jsx)(x.FormattedMessage,{id:"indexPatternManagement.dataViewTable.indexPatternExplanation",defaultMessage:"Create and manage the data views that help you retrieve your data from Elasticsearch."}),bottomBorder:!0,rightSideItems:[U]}),Object(L.jsx)(O.EuiSpacer,{size:"l"}),Object(L.jsx)(k,null,Object(L.jsx)(O.EuiInMemoryTable,{allowNeutralSort:!1,itemId:"id",isSelectable:d.getCanSaveSync(),items:b,columns:V,pagination:In,sorting:Ln,search:D,selection:d.getCanSaveSync()?H:void 0})),q)})),kn={text:h.i18n.translate("indexPatternManagement.indexPatterns.badge.readOnly.text",{defaultMessage:"Read only"}),tooltip:h.i18n.translate("indexPatternManagement.dataViews.badge.readOnly.tooltip",{defaultMessage:"Unable to save data views"}),iconType:"glasses"};async function Rn(e,t){const[{application:a,chrome:n,uiSettings:i,notifications:s,overlays:r,http:l,docLinks:d,theme:o},{data:c,dataViewFieldEditor:u,dataViewEditor:p,dataViews:f,fieldFormats:g,unifiedSearch:m,spaces:h,savedObjectsManagement:O},y]=await e(),M=f.getCanSaveSync();M||n.setBadge(kn);const F={application:a,chrome:n,uiSettings:i,notifications:s,overlays:r,unifiedSearch:m,http:l,docLinks:d,data:c,dataViewFieldEditor:u,dataViews:f,indexPatternManagementStart:y,setBreadcrumbs:t.setBreadcrumbs,fieldFormatEditors:u.fieldFormatEditors,IndexPatternEditor:p.IndexPatternEditorComponent,fieldFormats:g,spaces:h,theme:o,savedObjectsManagement:O};return b.a.render(Object(L.jsx)(v.KibanaContextProvider,{services:F},Object(L.jsx)(v.KibanaThemeProvider,{theme$:o.theme$},Object(L.jsx)(x.I18nProvider,null,Object(L.jsx)(j.Router,{history:t.history},Object(L.jsx)(j.Switch,null,Object(L.jsx)(j.Route,{path:["/create"]},Object(L.jsx)(Nn,{canSave:M,showCreateDialog:!0})),Object(L.jsx)(j.Route,{path:["/dataView/:id/field/:fieldName","/dataView/:id/create-field/"]},Object(L.jsx)(Pn,null)),Object(L.jsx)(j.Route,{path:["/dataView/:id"]},Object(L.jsx)(wt,null)),Object(L.jsx)(j.Redirect,{path:"/patterns*",to:"dataView*"}),Object(L.jsx)(j.Route,{path:["/"]},Object(L.jsx)(Nn,{canSave:M}))))))),t.element),()=>{n.docTitle.reset(),b.a.unmountComponentAtNode(t.element)}}},function(e,t,a){e.exports=a(11)(2)},function(e,t,a){e.exports=a(11)(2567)},function(e,t,a){e.exports=a(11)(3)},function(e,t,a){e.exports=a(11)(9)},function(e,t,a){e.exports=a(11)(6)},function(e,t,a){e.exports=a(11)(23)},function(e,t,a){"use strict";function n(e,t){return e===t}function i(e,t,a){if(null===t||null===a||t.length!==a.length)return!1;for(var n=t.length,i=0;i<n;i++)if(!e(t[i],a[i]))return!1;return!0}function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n,a=null,s=null;return function(){return i(t,a,arguments)||(s=e.apply(null,arguments)),a=arguments,s}}function r(e){var t=Array.isArray(e[0])?e[0]:e;if(!t.every((function(e){return"function"==typeof e}))){var a=t.map((function(e){return typeof e})).join(", ");throw new Error("Selector creators expect all input-selectors to be functions, instead received the following types: ["+a+"]")}return t}function l(e){for(var t=arguments.length,a=Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n];return function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];var s=0,l=n.pop(),d=r(n),o=e.apply(void 0,[function(){return s++,l.apply(null,arguments)}].concat(a)),c=e((function(){for(var e=[],t=d.length,a=0;a<t;a++)e.push(d[a].apply(null,arguments));return o.apply(null,e)}));return c.resultFunc=l,c.dependencies=d,c.recomputations=function(){return s},c.resetRecomputations=function(){return s=0},c}}t.__esModule=!0,t.defaultMemoize=s,t.createSelectorCreator=l,t.createStructuredSelector=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d;if("object"!=typeof e)throw new Error("createStructuredSelector expects first argument to be an object where each property is a selector, instead received a "+typeof e);var a=Object.keys(e);return t(a.map((function(t){return e[t]})),(function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((function(e,t,n){return e[a[n]]=t,e}),{})}))};var d=t.createSelector=l(s)},function(e,t,a){e.exports=a(11)(45)},function(e,t,a){e.exports=a(11)(15)},function(e,t,a){e.exports=a(11)(13)},function(e,t,a){"use strict";function n(e,t,a,i){var s=Error.call(this,e);return Object.setPrototypeOf&&Object.setPrototypeOf(s,n.prototype),s.expected=t,s.found=a,s.location=i,s.name="SyntaxError",s}function i(e,t,a){return a=a||" ",e.length>t?e:(t-=e.length,e+(a+=a.repeat(t)).slice(0,t))}!function(e,t){function a(){this.constructor=e}a.prototype=t.prototype,e.prototype=new a}(n,Error),n.prototype.format=function(e){var t="Error: "+this.message;if(this.location){var a,n=null;for(a=0;a<e.length;a++)if(e[a].source===this.location.source){n=e[a].text.split(/\r\n|\n|\r/g);break}var s=this.location.start,r=this.location.source+":"+s.line+":"+s.column;if(n){var l=this.location.end,d=i("",s.line.toString().length),o=n[s.line-1],c=s.line===l.line?l.column:o.length+1;t+="\n --\x3e "+r+"\n"+d+" |\n"+s.line+" | "+o+"\n"+d+" | "+i("",s.column-1)+i("",c-s.column,"^")}else t+="\n at "+r}return t},n.buildMessage=function(e,t){var a={literal:function(e){return'"'+i(e.text)+'"'},class:function(e){var t=e.parts.map((function(e){return Array.isArray(e)?s(e[0])+"-"+s(e[1]):s(e)}));return"["+(e.inverted?"^":"")+t+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(e){return e.description}};function n(e){return e.charCodeAt(0).toString(16).toUpperCase()}function i(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}function s(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}function r(e){return a[e.type](e)}return"Expected "+function(e){var t,a,n=e.map(r);if(n.sort(),n.length>0){for(t=1,a=1;t<n.length;t++)n[t-1]!==n[t]&&(n[a]=n[t],a++);n.length=a}switch(n.length){case 1:return n[0];case 2:return n[0]+" or "+n[1];default:return n.slice(0,-1).join(", ")+", or "+n[n.length-1]}}(e)+" but "+function(e){return e?'"'+i(e)+'"':"end of input"}(t)+" found."},e.exports={SyntaxError:n,parse:function(e,t){var a,i={},s=(t=void 0!==t?t:{}).grammarSource,r={start:ue,Literal:Fe},l=ue,d='"',o="\\",c="@kuery-cursor@",u=/^[\\"]/,p=/^[^"]/,f=/^[\\():<>"*{}]/,g=/^[0-9a-f]/i,m=/^[ \t\r\n\xA0]/,b=se("(",!1),j=se(")",!1),h=se(":",!1),x=se("{",!1),v=se("}",!1),O=le("fieldName"),y=le("value"),M=le("OR"),F=se("or",!0),P=le("AND"),E=se("and",!0),T=le("NOT"),S=se("not",!0),w=le("literal"),C=se('"',!1),I=se("\\",!1),L=re(["\\",'"'],!1,!1),D=re(['"'],!0,!1),A={type:"any"},_=se("*",!1),N=se("\\t",!1),k=se("\\r",!1),R=se("\\n",!1),B=re(["\\","(",")",":","<",">",'"',"*","{","}"],!1,!1),V=se("u",!1),U=re([["0","9"],["a","f"]],!1,!0),q=se("<=",!1),H=se(">=",!1),z=se("<",!1),G=se(">",!1),W=le("whitespace"),K=re([" ","\t","\r","\n"," "],!1,!1),$=se("@kuery-cursor@",!1),Q=function(e,t){return t},Y=function(e,t){return t},J=function(){return Ne},Z=function(t,a,n){const{start:i,end:s}=oe(ee,X);return{type:"cursor",start:i.offset,end:s.offset-a.length,prefix:t.join(""),suffix:n.join(""),text:e.substring(ee,X).replace(a,"")}},X=0,ee=0,te=[{line:1,column:1}],ae=0,ne=[],ie=0;if("startRule"in t){if(!(t.startRule in r))throw new Error("Can't start parsing from rule \""+t.startRule+'".');l=r[t.startRule]}function se(e,t){return{type:"literal",text:e,ignoreCase:t}}function re(e,t,a){return{type:"class",parts:e,inverted:t,ignoreCase:a}}function le(e){return{type:"other",description:e}}function de(t){var a,n=te[t];if(n)return n;for(a=t-1;!te[a];)a--;for(n={line:(n=te[a]).line,column:n.column};a<t;)10===e.charCodeAt(a)?(n.line++,n.column=1):n.column++,a++;return te[t]=n,n}function oe(e,t){var a=de(e),n=de(t);return{source:s,start:{offset:e,line:a.line,column:a.column},end:{offset:t,line:n.line,column:n.column}}}function ce(e){X<ae||(X>ae&&(ae=X,ne=[]),ne.push(e))}function ue(){var e,t,a,n,s,r;for(e=X,t=[],a=Ae();a!==i;)t.push(a),a=Ae();return(a=pe())===i&&(a=null),(n=we())!==i?(ee=e,s=a,e="cursor"===(r=n).type?{...r,suggestionTypes:["conjunction"]}:null!==s?s:Be.function.buildNode("is","*","*")):(X=e,e=i),e}function pe(){var e,t,a,n,s;if(e=X,(t=fe())!==i){if(a=[],n=X,Oe()!==i&&(s=fe())!==i?(ee=n,n=Q(0,s)):(X=n,n=i),n!==i)for(;n!==i;)a.push(n),n=X,Oe()!==i&&(s=fe())!==i?(ee=n,n=Q(0,s)):(X=n,n=i);else a=i;a!==i?(ee=e,e=function(e,t){const a=[e,...t];return Ne&&a.find((e=>"cursor"===e.type))||Ve("or",a)}(t,a)):(X=e,e=i)}else X=e,e=i;return e===i&&(e=fe()),e}function fe(){var e,t,a,n,s;if(e=X,(t=ge())!==i){if(a=[],n=X,ye()!==i&&(s=ge())!==i?(ee=n,n=Q(0,s)):(X=n,n=i),n!==i)for(;n!==i;)a.push(n),n=X,ye()!==i&&(s=ge())!==i?(ee=n,n=Q(0,s)):(X=n,n=i);else a=i;a!==i?(ee=e,e=function(e,t){const a=[e,...t];return Ne&&a.find((e=>"cursor"===e.type))||Ve("and",a)}(t,a)):(X=e,e=i)}else X=e,e=i;return e===i&&(e=ge()),e}function ge(){var e,t,a;return e=X,Me()!==i&&(t=me())!==i?(ee=e,e="cursor"===(a=t).type?a:Ve("not",[a])):(X=e,e=i),e===i&&(e=me()),e}function me(){var t,a,n,s,r,l,d,o;if(t=X,40===e.charCodeAt(X)?(a="(",X++):(a=i,0===ie&&ce(b)),a!==i){for(n=[],s=Ae();s!==i;)n.push(s),s=Ae();(s=pe())!==i&&(r=we())!==i?(41===e.charCodeAt(X)?(l=")",X++):(l=i,0===ie&&ce(j)),l!==i?(ee=t,d=s,t="cursor"===(o=r).type?{...o,suggestionTypes:["conjunction"]}:d):(X=t,t=i)):(X=t,t=i)}else X=t,t=i;return t===i&&(t=function(){var t,a,n,s,r,l,d,o,c,u;if(t=X,(a=be())!==i){for(n=[],s=Ae();s!==i;)n.push(s),s=Ae();if(58===e.charCodeAt(X)?(s=":",X++):(s=i,0===ie&&ce(h)),s!==i){for(r=[],l=Ae();l!==i;)r.push(l),l=Ae();if(123===e.charCodeAt(X)?(l="{",X++):(l=i,0===ie&&ce(x)),l!==i){for(d=[],o=Ae();o!==i;)d.push(o),o=Ae();(o=pe())!==i&&(c=we())!==i?(125===e.charCodeAt(X)?(u="}",X++):(u=i,0===ie&&ce(v)),u!==i?(ee=t,t=function(e,t,a){return"cursor"===t.type?{...t,nestedPath:t.nestedPath?`${e.value}.${t.nestedPath}`:e.value}:"cursor"===a.type?{...a,suggestionTypes:["conjunction"]}:Ve("nested",[e,t])}(a,o,c)):(X=t,t=i)):(X=t,t=i)}else X=t,t=i}else X=t,t=i}else X=t,t=i;return t===i&&(t=function(){var t;return t=function(){var t,a,n,s,r,l,d,o,c;if(t=X,(a=be())!==i){for(n=[],s=Ae();s!==i;)n.push(s),s=Ae();if(s=function(){var t,a;return t=X,"<="===e.substr(X,2)?(a="<=",X+=2):(a=i,0===ie&&ce(q)),a!==i&&(ee=t,a="lte"),(t=a)===i&&(t=X,">="===e.substr(X,2)?(a=">=",X+=2):(a=i,0===ie&&ce(H)),a!==i&&(ee=t,a="gte"),(t=a)===i&&(t=X,60===e.charCodeAt(X)?(a="<",X++):(a=i,0===ie&&ce(z)),a!==i&&(ee=t,a="lt"),(t=a)===i&&(t=X,62===e.charCodeAt(X)?(a=">",X++):(a=i,0===ie&&ce(G)),a!==i&&(ee=t,a="gt"),t=a))),t}(),s!==i){for(r=[],l=Ae();l!==i;)r.push(l),l=Ae();(l=Fe())!==i?(ee=t,d=a,o=s,t="cursor"===(c=l).type?{...c,suggestionTypes:["conjunction"]}:Ve("range",[d,o,c])):(X=t,t=i)}else X=t,t=i}else X=t,t=i;return t}(),t===i&&(t=function(){var t,a,n,s,r,l,d,o;if(t=X,(a=be())!==i){for(n=[],s=Ae();s!==i;)n.push(s),s=Ae();if(58===e.charCodeAt(X)?(s=":",X++):(s=i,0===ie&&ce(h)),s!==i){for(r=[],l=Ae();l!==i;)r.push(l),l=Ae();(l=je())!==i?(ee=t,d=a,t="cursor"===(o=l).type?{...o,fieldName:d.value,suggestionTypes:["value","conjunction"]}:o(d)):(X=t,t=i)}else X=t,t=i}else X=t,t=i;return t}(),t===i&&(t=function(){var e,t;return e=X,(t=ve())!==i&&(ee=e,t=function(e){if("cursor"===e.type){const t=`${e.prefix}${e.suffix}`.trim();return{...e,fieldName:t,suggestionTypes:["field","operator","conjunction"]}}return e(Ue(null))}(t)),t}())),t}()),t}()),t}function be(){var e;return ie++,e=Fe(),ie--,e===i&&0===ie&&ce(O),e}function je(){var t,a,n,s,r,l,d,o;if(t=X,40===e.charCodeAt(X)?(a="(",X++):(a=i,0===ie&&ce(b)),a!==i){for(n=[],s=Ae();s!==i;)n.push(s),s=Ae();s=function(){var e,t,a,n,s;if(e=X,(t=he())!==i){if(a=[],n=X,Oe()!==i&&(s=he())!==i?(ee=n,n=Y(0,s)):(X=n,n=i),n!==i)for(;n!==i;)a.push(n),n=X,Oe()!==i&&(s=he())!==i?(ee=n,n=Y(0,s)):(X=n,n=i);else a=i;a!==i?(ee=e,e=function(e,t){const a=[e,...t],n=Ne&&a.find((e=>"cursor"===e.type));return n?{...n,suggestionTypes:["value"]}:e=>Ve("or",a.map((t=>t(e))))}(t,a)):(X=e,e=i)}else X=e,e=i;return e===i&&(e=he()),e}(),s!==i&&(r=we())!==i?(41===e.charCodeAt(X)?(l=")",X++):(l=i,0===ie&&ce(j)),l!==i?(ee=t,d=s,t="cursor"===(o=r).type?{...o,suggestionTypes:["conjunction"]}:d):(X=t,t=i)):(X=t,t=i)}else X=t,t=i;return t===i&&(t=ve()),t}function he(){var e,t,a,n,s;if(e=X,(t=xe())!==i){if(a=[],n=X,ye()!==i&&(s=xe())!==i?(ee=n,n=Y(0,s)):(X=n,n=i),n!==i)for(;n!==i;)a.push(n),n=X,ye()!==i&&(s=xe())!==i?(ee=n,n=Y(0,s)):(X=n,n=i);else a=i;a!==i?(ee=e,e=function(e,t){const a=[e,...t],n=Ne&&a.find((e=>"cursor"===e.type));return n?{...n,suggestionTypes:["value"]}:e=>Ve("and",a.map((t=>t(e))))}(t,a)):(X=e,e=i)}else X=e,e=i;return e===i&&(e=xe()),e}function xe(){var e,t,a;return e=X,Me()!==i&&(t=je())!==i?(ee=e,e="cursor"===(a=t).type?{...list,suggestionTypes:["value"]}:e=>Ve("not",[a(e)])):(X=e,e=i),e===i&&(e=je()),e}function ve(){var e,t;return ie++,e=X,(t=Pe())!==i&&(ee=e,t=function(e){if("cursor"===e.type)return e;const t=Ue(!0);return a=>Ve("is",[a,e,t])}(t)),(e=t)===i&&(e=X,(t=Te())!==i&&(ee=e,t=function(e){if("cursor"===e.type)return e;!Re&&"wildcard"===e.type&&Be.wildcard.hasLeadingWildcard(e)&&function(e,t){throw function(e,t){return new n("Leading wildcards are disabled. See query:allowLeadingWildcards in Advanced Settings.",null,null,t)}(0,t=void 0!==t?t:oe(ee,X))}();const t=Ue(!1);return a=>Ve("is",[a,e,t])}(t)),e=t),ie--,e===i&&(t=i,0===ie&&ce(y)),e}function Oe(){var t,a,n,s,r;if(ie++,t=X,a=[],(n=Ae())!==i)for(;n!==i;)a.push(n),n=Ae();else a=i;if(a!==i)if("or"===e.substr(X,2).toLowerCase()?(n=e.substr(X,2),X+=2):(n=i,0===ie&&ce(F)),n!==i){if(s=[],(r=Ae())!==i)for(;r!==i;)s.push(r),r=Ae();else s=i;s!==i?t=a=[a,n,s]:(X=t,t=i)}else X=t,t=i;else X=t,t=i;return ie--,t===i&&(a=i,0===ie&&ce(M)),t}function ye(){var t,a,n,s,r;if(ie++,t=X,a=[],(n=Ae())!==i)for(;n!==i;)a.push(n),n=Ae();else a=i;if(a!==i)if("and"===e.substr(X,3).toLowerCase()?(n=e.substr(X,3),X+=3):(n=i,0===ie&&ce(E)),n!==i){if(s=[],(r=Ae())!==i)for(;r!==i;)s.push(r),r=Ae();else s=i;s!==i?t=a=[a,n,s]:(X=t,t=i)}else X=t,t=i;else X=t,t=i;return ie--,t===i&&(a=i,0===ie&&ce(P)),t}function Me(){var t,a,n,s;if(ie++,t=X,"not"===e.substr(X,3).toLowerCase()?(a=e.substr(X,3),X+=3):(a=i,0===ie&&ce(S)),a!==i){if(n=[],(s=Ae())!==i)for(;s!==i;)n.push(s),s=Ae();else n=i;n!==i?t=a=[a,n]:(X=t,t=i)}else X=t,t=i;return ie--,t===i&&(a=i,0===ie&&ce(T)),t}function Fe(){var e;return ie++,(e=Pe())===i&&(e=Te()),ie--,e===i&&0===ie&&ce(w),e}function Pe(){var t,a,n,s,r,l,o;if(t=X,ee=X,(a=(a=J())?void 0:i)!==i)if(34===e.charCodeAt(X)?(n=d,X++):(n=i,0===ie&&ce(C)),n!==i){for(s=[],r=Ee();r!==i;)s.push(r),r=Ee();if((r=_e())!==i){for(l=[],o=Ee();o!==i;)l.push(o),o=Ee();34===e.charCodeAt(X)?(o=d,X++):(o=i,0===ie&&ce(C)),o!==i?(ee=t,t=Z(s,r,l)):(X=t,t=i)}else X=t,t=i}else X=t,t=i;else X=t,t=i;if(t===i)if(t=X,34===e.charCodeAt(X)?(a=d,X++):(a=i,0===ie&&ce(C)),a!==i){for(n=[],s=Ee();s!==i;)n.push(s),s=Ee();34===e.charCodeAt(X)?(s=d,X++):(s=i,0===ie&&ce(C)),s!==i?(ee=t,t=Ue(n.join(""))):(X=t,t=i)}else X=t,t=i;return t}function Ee(){var t,a,n;return(t=Ce())===i&&(t=Le())===i&&(t=X,92===e.charCodeAt(X)?(a=o,X++):(a=i,0===ie&&ce(I)),a!==i?(u.test(e.charAt(X))?(n=e.charAt(X),X++):(n=i,0===ie&&ce(L)),n!==i?(ee=t,t=n):(X=t,t=i)):(X=t,t=i),t===i&&(t=X,a=X,ie++,n=_e(),ie--,n===i?a=void 0:(X=a,a=i),a!==i?(p.test(e.charAt(X))?(n=e.charAt(X),X++):(n=i,0===ie&&ce(D)),n!==i?(ee=t,t=n):(X=t,t=i)):(X=t,t=i))),t}function Te(){var e,t,a,n,s,r;if(e=X,ee=X,(t=(t=J())?void 0:i)!==i){for(a=[],n=Se();n!==i;)a.push(n),n=Se();if((n=_e())!==i){for(s=[],r=Se();r!==i;)s.push(r),r=Se();ee=e,e=Z(a,n,s)}else X=e,e=i}else X=e,e=i;if(e===i){if(e=X,t=[],(a=Se())!==i)for(;a!==i;)t.push(a),a=Se();else t=i;t!==i&&(ee=e,t=function(e){const t=e.join("").trim();return"null"===t?Ue(null):"true"===t?Ue(!0):"false"===t?Ue(!1):e.includes(He)?qe(t):Ue(t)}(t)),e=t}return e}function Se(){var t,a,n,s,r;return(t=Ce())===i&&(t=function(){var t,a,n;return t=X,92===e.charCodeAt(X)?(a=o,X++):(a=i,0===ie&&ce(I)),a!==i&&(n=Ie())!==i?(ee=t,t=n):(X=t,t=i),t}(),t===i&&(t=Le())===i&&(t=function(){var t,a,n;return t=X,92===e.charCodeAt(X)?(a=o,X++):(a=i,0===ie&&ce(I)),a!==i?("or"===e.substr(X,2).toLowerCase()?(n=e.substr(X,2),X+=2):(n=i,0===ie&&ce(F)),n===i&&("and"===e.substr(X,3).toLowerCase()?(n=e.substr(X,3),X+=3):(n=i,0===ie&&ce(E)),n===i&&("not"===e.substr(X,3).toLowerCase()?(n=e.substr(X,3),X+=3):(n=i,0===ie&&ce(S)))),n!==i?(ee=t,t=n):(X=t,t=i)):(X=t,t=i),t}(),t===i&&(t=function(){var t,a;return t=X,42===e.charCodeAt(X)?(a="*",X++):(a=i,0===ie&&ce(_)),a!==i&&(ee=t,a=He),a}(),t===i&&(t=X,a=X,ie++,n=Ie(),ie--,n===i?a=void 0:(X=a,a=i),a!==i?(n=X,ie++,s=function(){var e;return(e=Oe())===i&&(e=ye())===i&&(e=Me()),e}(),ie--,s===i?n=void 0:(X=n,n=i),n!==i?(s=X,ie++,r=_e(),ie--,r===i?s=void 0:(X=s,s=i),s!==i?(e.length>X?(r=e.charAt(X),X++):(r=i,0===ie&&ce(A)),r!==i?(ee=t,t=r):(X=t,t=i)):(X=t,t=i)):(X=t,t=i)):(X=t,t=i))))),t}function we(){var e,t,a,n,s,r;if(e=X,ee=X,(t=(t=J())?void 0:i)!==i){for(a=[],n=Ae();n!==i;)a.push(n),n=Ae();if((n=_e())!==i){for(s=[],r=Ae();r!==i;)s.push(r),r=Ae();ee=e,e=Z(a,n,s)}else X=e,e=i}else X=e,e=i;if(e===i)for(e=[],t=Ae();t!==i;)e.push(t),t=Ae();return e}function Ce(){var t,a;return t=X,"\\t"===e.substr(X,2)?(a="\\t",X+=2):(a=i,0===ie&&ce(N)),a!==i&&(ee=t,a="\t"),(t=a)===i&&(t=X,"\\r"===e.substr(X,2)?(a="\\r",X+=2):(a=i,0===ie&&ce(k)),a!==i&&(ee=t,a="\r"),(t=a)===i&&(t=X,"\\n"===e.substr(X,2)?(a="\\n",X+=2):(a=i,0===ie&&ce(R)),a!==i&&(ee=t,a="\n"),t=a)),t}function Ie(){var t;return f.test(e.charAt(X))?(t=e.charAt(X),X++):(t=i,0===ie&&ce(B)),t}function Le(){var t,a,n;return t=X,92===e.charCodeAt(X)?(a=o,X++):(a=i,0===ie&&ce(I)),a!==i?(n=function(){var t,a,n,s,r,l,d,o,c;return t=X,117===e.charCodeAt(X)?(a="u",X++):(a=i,0===ie&&ce(V)),a!==i?(n=X,s=X,(r=De())!==i&&(l=De())!==i&&(d=De())!==i&&(o=De())!==i?s=r=[r,l,d,o]:(X=s,s=i),(n=s!==i?e.substring(n,X):s)!==i?(ee=t,c=n,t=String.fromCharCode(parseInt(c,16))):(X=t,t=i)):(X=t,t=i),t}(),n!==i?(ee=t,t=n):(X=t,t=i)):(X=t,t=i),t}function De(){var t;return g.test(e.charAt(X))?(t=e.charAt(X),X++):(t=i,0===ie&&ce(U)),t}function Ae(){var t;return ie++,m.test(e.charAt(X))?(t=e.charAt(X),X++):(t=i,0===ie&&ce(K)),ie--,t===i&&0===ie&&ce(W),t}function _e(){var t,a;return t=X,ee=X,(J()?void 0:i)!==i?(e.substr(X,14)===c?(a=c,X+=14):(a=i,0===ie&&ce($)),a!==i?(ee=t,t=ke):(X=t,t=i)):(X=t,t=i),t}const{parseCursor:Ne,cursorSymbol:ke,allowLeadingWildcards:Re=!0,helpers:{nodeTypes:Be}}=t,Ve=Be.function.buildNodeWithArgumentNodes,Ue=Be.literal.buildNode,qe=Be.wildcard.buildNode,{wildcardSymbol:He}=Be.wildcard;if((a=l())!==i&&X===e.length)return a;throw a!==i&&X<e.length&&ce({type:"end"}),ze=ne,Ge=ae<e.length?e.charAt(ae):null,We=ae<e.length?oe(ae,ae+1):oe(ae,ae),new n(n.buildMessage(ze,Ge),ze,Ge,We);var ze,Ge,We}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(17),i=a(5),s=n.__importDefault(a(35));t.default=function(e,t){var a=i.useState(t),n=a[0],r=a[1];return s.default((function(){var t=e.subscribe(r);return function(){return t.unsubscribe()}}),[e]),n}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),i="undefined"!=typeof window?n.useLayoutEffect:n.useEffect;t.default=i},function(e,t,a){e.exports=a(11)(4)},function(e,t,a){e.exports=a(11)(18)},function(e,t,a){e.exports=a(11)(2564)},function(e,t,a){e.exports=a(11)(2572)}])]);