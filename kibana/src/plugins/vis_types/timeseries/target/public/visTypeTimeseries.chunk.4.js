(window.visTypeTimeseries_bundle_jsonpfunction=window.visTypeTimeseries_bundle_jsonpfunction||[]).push([[4],{100:function(e,t,s){switch(window.__kbnThemeTag__){case"v8dark":return s(101);case"v8light":return s(103)}},101:function(e,t,s){var i=s(51),a=s(102);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);i(a,{insert:"head",singleton:!1}),e.exports=a.locals||{}},102:function(e,t,s){(t=s(52)(!1)).push([e.i,".tvbLastValueModePopover{height:auto}.tvbLastValueModePopoverBody{width:360px}\n",""]),e.exports=t},103:function(e,t,s){var i=s(51),a=s(104);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);i(a,{insert:"head",singleton:!1}),e.exports=a.locals||{}},104:function(e,t,s){(t=s(52)(!1)).push([e.i,".tvbLastValueModePopover{height:auto}.tvbLastValueModePopoverBody{width:360px}\n",""]),e.exports=t},142:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s(5),a=s(143),l=function(){};t.default=function(e,t,s){if(!a.isClient)return[t,l,l];if(!e)throw new Error("useLocalStorage key may not be falsy");var n=s?s.raw?function(e){return e}:s.deserializer:JSON.parse,r=i.useState((function(){try{var i=s?s.raw?String:s.serializer:JSON.stringify,a=localStorage.getItem(e);return null!==a?n(a):(t&&localStorage.setItem(e,i(t)),t)}catch(e){return t}})),o=r[0],d=r[1],u=i.useCallback((function(t){try{var i="function"==typeof t?t(o):t;if(void 0===i)return;var a;a=s?s.raw?"string"==typeof i?i:JSON.stringify(i):s.serializer?s.serializer(i):JSON.stringify(i):JSON.stringify(i),localStorage.setItem(e,a),d(n(a))}catch(e){}}),[e,d]),c=i.useCallback((function(){try{localStorage.removeItem(e),d(void 0)}catch(e){}}),[e,d]);return[o,u,c]}},143:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDeepEqual=t.off=t.on=t.isClient=void 0;var i=s(35).__importDefault(s(144));t.isClient="object"==typeof window,t.on=function(e){for(var t=[],s=1;s<arguments.length;s++)t[s-1]=arguments[s];return e.addEventListener.apply(e,t)},t.off=function(e){for(var t=[],s=1;s<arguments.length;s++)t[s-1]=arguments[s];return e.removeEventListener.apply(e,t)},t.isDeepEqual=i.default},144:function(e,t,s){"use strict";e.exports=function e(t,s){if(t===s)return!0;if(t&&s&&"object"==typeof t&&"object"==typeof s){if(t.constructor!==s.constructor)return!1;var i,a,l;if(Array.isArray(t)){if((i=t.length)!=s.length)return!1;for(a=i;0!=a--;)if(!e(t[a],s[a]))return!1;return!0}if(t.constructor===RegExp)return t.source===s.source&&t.flags===s.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===s.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===s.toString();if((i=(l=Object.keys(t)).length)!==Object.keys(s).length)return!1;for(a=i;0!=a--;)if(!Object.prototype.hasOwnProperty.call(s,l[a]))return!1;for(a=i;0!=a--;){var n=l[a];if(!("_owner"===n&&t.$$typeof||e(t[n],s[n])))return!1}return!0}return t!=t&&s!=s}},200:function(e,t,s){"use strict";s.r(t),s.d(t,"VisEditor",(function(){return vis_editor_VisEditor})),s.d(t,"default",(function(){return vis_editor_VisEditor}));var i=s(17),a=s.n(i),l=s(5),n=s.n(l),r=s(39),o=s(34),d=s(9),u=s.n(d),c=s(10),b=s(3),g=s(15),j=s(16),p=s(1);class vis_editor_visualization_VisEditorVisualizationUI extends l.Component{constructor(e){super(e),a()(this,"handleMouseDown",(()=>{window.addEventListener("mouseup",this.handleMouseUp),this.setState({dragging:!0})})),a()(this,"handleMouseUp",(()=>{window.removeEventListener("mouseup",this.handleMouseUp),this.setState({dragging:!1})})),a()(this,"handleMouseMove",(e=>{this.state.dragging&&this.setState((t=>({height:Math.max(300,t.height+e.movementY)})))})),a()(this,"onSizeHandleKeyDown",(e=>{const{key:t}=e;t!==g.keys.ARROW_UP&&t!==g.keys.ARROW_DOWN||(e.preventDefault(),this.setState((e=>{const s=e.height+(t===g.keys.ARROW_UP?-15:15);return{height:Math.max(300,s)}})))})),this.state={height:300,dragging:!1},this._visEl=n.a.createRef(),this._subscription=null}async _loadVisualization(){if(!this._visEl.current)return;const{onDataChange:e,embeddableHandler:t}=this.props;this._handler=t,await this._handler.render(this._visEl.current),this.props.eventEmitter.emit("embeddableRendered"),this._subscription=this._handler.handler.data$.pipe(Object(o.pluck)("result")).subscribe((t=>e(t.value)))}componentWillUnmount(){window.removeEventListener("mousemove",this.handleMouseMove),window.removeEventListener("mouseup",this.handleMouseUp),this._handler&&this._handler.destroy(),this._subscription&&this._subscription.unsubscribe()}componentDidMount(){window.addEventListener("mousemove",this.handleMouseMove),this._loadVisualization()}componentDidUpdate(){if(this._handler){const{timeRange:e,filters:t,query:s}=this.props;this._handler.updateInput({timeRange:e,filters:t,query:s})}}render(){const{dirty:e,autoApply:t,title:s,description:i,onToggleAutoApply:a,onCommit:l}=this.props,n={height:this.state.height};this.state.dragging&&(n.userSelect="none");let r=Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.visEditorVisualization.changesSuccessfullyAppliedMessage",defaultMessage:"The latest changes have been applied."});e&&(r=Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.visEditorVisualization.changesHaveNotBeenAppliedMessage",defaultMessage:"The changes to this visualization have not been applied."})),t&&(r=Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.visEditorVisualization.changesWillBeAutomaticallyAppliedMessage",defaultMessage:"The changes will be automatically applied."}));const o=Object(p.jsx)(g.EuiFlexGroup,{className:"tvbEditorVisualization__apply",alignItems:"center"},Object(p.jsx)(g.EuiFlexItem,{grow:!0},Object(p.jsx)(g.EuiSwitch,{id:"tsvbAutoApplyInput",label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.visEditorVisualization.autoApplyLabel",defaultMessage:"Auto apply"}),checked:t,onChange:a})),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiText,{color:e?"default":"subdued",size:"xs"},Object(p.jsx)("p",null,r))),!t&&Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiButton,{iconType:"play",fill:!0,size:"s",onClick:l,disabled:!e,"data-test-subj":"applyBtn"},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.visEditorVisualization.applyChangesLabel",defaultMessage:"Apply changes"}))));return Object(p.jsx)("div",null,Object(p.jsx)("div",{style:n,className:"tvbEditorVisualization","data-shared-items-container":!0,"data-title":s,"data-description":i,ref:this._visEl}),Object(p.jsx)("div",{className:"tvbEditor--hideForReporting"},o,Object(p.jsx)("button",{className:"tvbEditorVisualization__draghandle",onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,onKeyDown:this.onSizeHandleKeyDown,"aria-label":this.props.intl.formatMessage({id:"visTypeTimeseries.colorRules.adjustChartSizeAriaLabel",defaultMessage:"Press up/down to adjust the chart size"})},Object(p.jsx)("i",{className:"fa fa-ellipsis-h"}))))}}const m=Object(j.injectI18n)(vis_editor_visualization_VisEditorVisualizationUI),x=n.a.createContext({}),v=n.a.createContext({}),O=n.a.createContext(null);var h=s(2),T=s(44),f=s.n(T);const E=/[^0-9,]/g;function y({name:e,value:t,disableTrash:s=!1,onChange:i}){const a=null!=t&&t.includes("rgba")?t.replace(E,""):t,[n,r]=Object(l.useState)(a||""),o=t?h.i18n.translate("visTypeTimeseries.colorPicker.notAccessibleWithValueAriaLabel",{defaultMessage:"Color picker ({value}), not accessible",values:{value:t}}):h.i18n.translate("visTypeTimeseries.colorPicker.notAccessibleAriaLabel",{defaultMessage:"Color picker, not accessible"});return Object(p.jsx)("div",{className:"tvbColorPicker","data-test-subj":"tvbColorPicker"},Object(p.jsx)(g.EuiColorPicker,{onChange:(t,{rgba:s,hex:a})=>{r(t),i({[e]:a?`rgba(${s.join(",")})`:""})},color:n,secondaryInputDisplay:"top",showAlpha:!0,button:Object(p.jsx)(g.EuiColorPickerSwatch,{color:n,"aria-label":o})}),!s&&Object(p.jsx)("div",{className:"tvbColorPicker__clear",onClick:()=>{r(""),i({[e]:null})}},Object(p.jsx)(g.EuiIconTip,{size:"s",type:"cross",color:"danger",content:h.i18n.translate("visTypeTimeseries.colorPicker.clearIconLabel",{defaultMessage:"Clear"})})))}function M(e){const{testSubj:t}=e,s=e.disableDelete?null:Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiToolTip,{content:e.deleteTooltip},Object(p.jsx)(g.EuiButtonIcon,{"data-test-subj":`${t}DeleteBtn`,"aria-label":e.deleteTooltip,color:"danger",iconType:"trash",onClick:e.onDelete}))),i=e.disableAdd?null:Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiToolTip,{content:e.addTooltip},Object(p.jsx)(g.EuiButtonIcon,{"data-test-subj":`${t}AddBtn`,"aria-label":e.addTooltip,iconType:"plusInCircle",onClick:e.onAdd}))),a=(()=>{let s=null;return e.onClone&&!e.disableAdd&&(s=Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiToolTip,{content:e.cloneTooltip},Object(p.jsx)(g.EuiButtonIcon,{"data-test-subj":`${t}CloneBtn`,"aria-label":e.cloneTooltip,iconType:"copy",onClick:e.onClone})))),s})(),l=(()=>{let s=null;if(Object(d.isBoolean)(e.isPanelActive)){const i=e.isPanelActive?e.deactivatePanelTooltip:e.activatePanelTooltip,a=e.isPanelActive?"eye":"eyeClosed";s=Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiToolTip,{content:i},Object(p.jsx)(g.EuiButtonIcon,{"data-test-subj":`${t}ActivatePanelBtn`,"aria-label":i,iconType:a,onClick:e.togglePanelActivation})))}return s})();return Object(p.jsx)(g.EuiFlexGroup,{gutterSize:"s",responsive:e.responsive,justifyContent:"flexEnd"},l,a,i,s)}M.defaultProps={testSubj:"Add",activeTooltip:h.i18n.translate("visTypeTimeseries.addDeleteButtons.addButtonDefaultTooltip",{defaultMessage:"Add"}),addTooltip:h.i18n.translate("visTypeTimeseries.addDeleteButtons.addButtonDefaultTooltip",{defaultMessage:"Add"}),deleteTooltip:h.i18n.translate("visTypeTimeseries.addDeleteButtons.deleteButtonDefaultTooltip",{defaultMessage:"Delete"}),cloneTooltip:h.i18n.translate("visTypeTimeseries.addDeleteButtons.cloneButtonDefaultTooltip",{defaultMessage:"Clone"}),activatePanelTooltip:h.i18n.translate("visTypeTimeseries.addDeleteButtons.reEnableTooltip",{defaultMessage:"Re-enable"}),deactivatePanelTooltip:h.i18n.translate("visTypeTimeseries.addDeleteButtons.temporarilyDisableTooltip",{defaultMessage:"Temporarily Disable"})};class series_drag_handler_SeriesDragHandler extends l.PureComponent{render(){const{dragHandleProps:e,hideDragHandler:t}=this.props;return Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)("div",e,!t&&Object(p.jsx)(g.EuiToolTip,{content:h.i18n.translate("visTypeTimeseries.sort.dragToSortTooltip",{defaultMessage:"Drag to sort"})},Object(p.jsx)(g.EuiIcon,{className:"tvbSeries__sortHandle","aria-label":h.i18n.translate("visTypeTimeseries.sort.dragToSortAriaLabel",{defaultMessage:"Drag to sort"}),type:"grab"}))))}}function F(e){let t="eyeClosed",s="subdued";return Object(d.last)(e.siblings).id===e.model.id&&(t="eye",s="text"),Object(p.jsx)("div",{className:"tvbAggRow"},Object(p.jsx)(g.EuiFlexGroup,{"data-test-subj":"aggRow",gutterSize:"s",alignItems:"flexStart",responsive:!1},Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiIcon,{className:"tvbAggRow__visibilityIcon",type:t,color:s})),Object(p.jsx)(g.EuiFlexItem,{className:"tvbAggRow__children"},e.children),Object(p.jsx)(series_drag_handler_SeriesDragHandler,{dragHandleProps:e.dragHandleProps,hideDragHandler:e.disableDelete}),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(M,{testSubj:"addMetric",addTooltip:h.i18n.translate("visTypeTimeseries.aggRow.addMetricButtonTooltip",{defaultMessage:"Add Metric"}),deleteTooltip:h.i18n.translate("visTypeTimeseries.aggRow.deleteMetricButtonTooltip",{defaultMessage:"Delete Metric"}),onAdd:e.onAdd,onDelete:e.onDelete,disableDelete:e.disableDelete}))))}a()(series_drag_handler_SeriesDragHandler,"defaultProps",{hideDragHandler:!0});var C=s(46),_=s.n(C),I=s(4);let S;!function(e){e.WHITE_LISTED_GROUP_BY_FIELDS="whiteListedGroupByFields",e.WHITE_LISTED_METRICS="whiteListedMetrics",e.WHITE_LISTED_TIMERANGE_MODES="whiteListedTimerangeModes",e.WHITE_LISTED_CONFIGURATION_FEATURES="whiteListedConfigurationFeatures"}(S||(S={}));const w={"*":!0},L={[I.e.GAUGE]:1,[I.e.METRIC]:2},P=(e,t,s=w)=>Object(d.get)(s,`${t}.*`,!0)||Boolean(Object(d.get)(s,[t,e],!1)),A=(e,t)=>P(e,S.WHITE_LISTED_METRICS,t),D=(e,t)=>P(e,S.WHITE_LISTED_GROUP_BY_FIELDS,t),R=(e,t)=>P(e,S.WHITE_LISTED_TIMERANGE_MODES,t);var N=s(63);const k=({id:e,meta:t})=>({value:e,label:t.label}),{metric:B,parent_pipeline:G,sibling_pipeline:z,special:H}=Object(N.d)(k),V=[...B,...G,...z,...H];function W(e){var t;const{siblings:s,panelType:i,value:a,onChange:n,...r}=e,{uiRestrictions:o}=null!==(t=Object(l.useContext)(v))&&void 0!==t?t:{},d=V.filter((e=>a===e.value&&A(e.value,o)));let u,c=s.some((e=>!!B.find((t=>t.value===e.type))));if(s.length<=1&&(c=!1),"metrics"===i)u=B;else if("filter_ratio"===i)u=Object(N.c)({meta:{isFilterRatioSupported:!0}}).map(k);else if("histogram"===i)u=Object(N.c)({meta:{isHistogramSupported:!0}}).map(k);else{const e=e=>({...e,disabled:!c||!A(e.value,o)});u=[{label:h.i18n.translate("visTypeTimeseries.aggSelect.aggGroups.metricAggLabel",{defaultMessage:"Metric Aggregations"}),options:B.map((e=>({...e,disabled:!A(e.value,o)})))},{label:h.i18n.translate("visTypeTimeseries.aggSelect.aggGroups.parentPipelineAggLabel",{defaultMessage:"Parent Pipeline Aggregations"}),options:G.map(e)},{label:h.i18n.translate("visTypeTimeseries.aggSelect.aggGroups.siblingPipelineAggLabel",{defaultMessage:"Sibling Pipeline Aggregations"}),options:z.map(e)},{label:h.i18n.translate("visTypeTimeseries.aggSelect.aggGroups.specialAggLabel",{defaultMessage:"Special Aggregations"}),options:H.map(e)}]}return Object(p.jsx)("div",{"data-test-subj":"aggSelector"},Object(p.jsx)(g.EuiComboBox,_()({isClearable:!1,placeholder:h.i18n.translate("visTypeTimeseries.aggSelect.selectAggPlaceholder",{defaultMessage:"Select aggregation"}),options:u,selectedOptions:d,onChange:e=>{!e||e.length<=0||n(e)},singleSelection:{asPlainText:!0}},r)))}var U=s(29),q=s(50);const $=["cumulative_sum","derivative","moving_average","avg_bucket","sum_bucket","min_bucket","max_bucket","std_deviation_bucket","variance_bucket","sum_of_squares_bucket","serial_diff","positive_only"],K=(e,t=[],s=[],i=!0)=>{if(!e)return h.i18n.translate("visTypeTimeseries.calculateLabel.unknownLabel",{defaultMessage:"Unknown"});if(e.alias)return e.alias;switch(e.type){case U.METRIC_TYPES.COUNT:return h.i18n.translate("visTypeTimeseries.calculateLabel.countLabel",{defaultMessage:"Count"});case I.i.CALCULATION:return h.i18n.translate("visTypeTimeseries.calculateLabel.bucketScriptsLabel",{defaultMessage:"Bucket Script"});case I.i.MATH:return h.i18n.translate("visTypeTimeseries.calculateLabel.mathLabel",{defaultMessage:"Math"});case I.i.SERIES_AGG:return h.i18n.translate("visTypeTimeseries.calculateLabel.seriesAggLabel",{defaultMessage:"Series Agg ({metricFunction})",values:{metricFunction:e.function}});case I.i.FILTER_RATIO:return h.i18n.translate("visTypeTimeseries.calculateLabel.filterRatioLabel",{defaultMessage:"Filter Ratio"});case I.i.POSITIVE_RATE:return h.i18n.translate("visTypeTimeseries.calculateLabel.positiveRateLabel",{defaultMessage:"Counter Rate of {field}",values:{field:Object(q.c)(s,e.field,i)}});case I.i.STATIC:return h.i18n.translate("visTypeTimeseries.calculateLabel.staticValueLabel",{defaultMessage:"Static Value of {metricValue}",values:{metricValue:e.value}})}const a=Object(N.e)(e.type);if(Object(d.includes)($,e.type)){const l=t.find((t=>Object(d.startsWith)(e.field,t.id))),n=K(l,t,s,i);if(l&&"percentile"===l.type){const t=/\[([0-9\.]+)\]$/,s=e.field.match(t);if(s)return h.i18n.translate("visTypeTimeseries.calculateLabel.metricTypeOfTargetWithAdditionalLabel",{defaultMessage:"{metricTypeLabel} of {targetLabel} ({additionalLabel})",values:{metricTypeLabel:a,targetLabel:n,additionalLabel:s[1]}})}return h.i18n.translate("visTypeTimeseries.calculateLabel.metricTypeOfTargetLabel",{defaultMessage:"{metricTypeLabel} of {targetLabel}",values:{metricTypeLabel:a,targetLabel:n}})}return h.i18n.translate("visTypeTimeseries.calculateLabel.metricTypeOfMetricFieldRankLabel",{defaultMessage:"{metricTypeLabel} of {metricField}",values:{metricTypeLabel:a,metricField:Object(q.c)(s,e.field,i)}})};var Y=s(70);const Q=/\d+\.\d+/,X=e=>Q.test(`${e}`)?e:`${e}.0`;function J(e){const{additionalOptions:t,restrict:s,metric:i,fields:a,metrics:l,onChange:n,value:r,exclude:o,includeSiblings:d,clearable:c,...b}=e,j=l.filter(function(e,t=[]){return s=>!t.includes(s.type)&&("basic"!==e||Y.a.includes(s.type))}(s,o)),m=((e,t)=>{const s=function(e,t){const s=t.id&&[t.id]||[];return e.forEach((e=>{u.a.includes(s,e.field)&&s.push(e.id)})),s}(e,t);return e.filter((e=>!u.a.includes(s,e.id)))})(j,i),x=m.filter((e=>/^percentile/.test(e.type))).reduce(((e,t)=>{const s=K(t,j,a,!1);switch(t.type){case I.i.PERCENTILE_RANK:(t.values||[]).forEach((i=>{const a=X(i);e.push({value:`${t.id}[${a}]`,label:`${s} (${a})`})}));case I.i.PERCENTILE:(t.percentiles||[]).forEach((i=>{if(i.value){const a=X(i.value);e.push({value:`${t.id}[${a}]`,label:`${s} (${a})`})}}))}return e}),[]),v=m.filter(function(e){return t=>e?!/^series/.test(t.type)&&!/^percentile/.test(t.type)&&"math"!==t.type:!/_bucket$/.test(t.type)&&!/^series/.test(t.type)&&!/^percentile/.test(t.type)&&"math"!==t.type}(d)).map((e=>{const t=K(e,j,a,!1);return{value:e.id,label:t}})),O=[...v,...t,...x],T=O.find((e=>r===e.value)),f=T?[T]:[];return Object(p.jsx)(g.EuiComboBox,_()({placeholder:h.i18n.translate("visTypeTimeseries.metricSelect.selectMetricPlaceholder",{defaultMessage:"Select metric…"}),options:O,selectedOptions:f,onChange:n,singleSelection:{asPlainText:!0},isClearable:c},b))}J.defaultProps={additionalOptions:[],exclude:[],metric:{},restrict:"none",includeSiblings:!1};const Z=(e,t)=>s=>{const i=u.a.assign({},t,s);e(i)},ee=e=>t=>(s=[])=>{var i,a;return null==e?void 0:e({[t]:null!==(i=null===(a=s[0])||void 0===a?void 0:a.value)&&void 0!==i?i:null})},te=e=>(t,s)=>i=>{var a;return null==e?void 0:e({[t]:null!=s&&s.isClearable&&!i.target.value?void 0:Number(null!==(a=i.target.value)&&void 0!==a?a:null==s?void 0:s.defaultValue)})};var se=s(12);const ie={model_type:I.c.UNWEIGHTED,alpha:.3,beta:.1,gamma:.3,period:1,multiplicative:!0,window:5},ae=({model_type:e,window:t,period:s})=>e===I.c.WEIGHTED_EXPONENTIAL_TRIPLE&&2*s>t,le=e=>(t,s)=>i=>{var a;return e({[t]:null!==(a=i.target.value)&&void 0!==a?a:s})},ne=()=>({id:f.a.v1()});function re(e,t){const{model:s,name:i}=e,a={[i]:(s[i]||[]).map((e=>e.id===t.id?t:e))};e.onChange({...s,...a})}function oe(e,t){var s;const{model:i,name:a}=e,l={[a]:(i[a]||[]).filter((e=>e.id!==t.id))};null===(s=e.onChange)||void 0===s||s.call(e,{...i,...l})}function de(e,t=ne){var s;const{model:i,name:a}=e,l={[a]:(i[a]||[]).concat([t()])};null===(s=e.onChange)||void 0===s||s.call(e,{...i,...l})}const ue={handleAdd:de,handleDelete:oe,handleChange:re},ce=e=>({id:f.a.v1(),name:"",field:"",...e});class vars_CalculationVars extends l.Component{constructor(e){super(e),this.renderRow=this.renderRow.bind(this)}handleChange(e,t){return s=>{const i=ue.handleChange.bind(null,this.props),a={};a[t]=u.a.get(s,"[0].value",u.a.get(s,"target.value")),i(u.a.assign({},e,a))}}renderRow(e,t,s){const i=ue.handleAdd.bind(null,this.props,ce),a=ue.handleDelete.bind(null,this.props,e);return Object(p.jsx)(g.EuiFlexItem,{key:e.id,"data-test-subj":"varRow"},Object(p.jsx)(g.EuiFlexGroup,{alignItems:"center",responsive:!1,gutterSize:"s"},Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFieldText,{className:"tvbAggs__varName","aria-label":h.i18n.translate("visTypeTimeseries.vars.variableNameAriaLabel",{defaultMessage:"Variable name"}),placeholder:h.i18n.translate("visTypeTimeseries.vars.variableNamePlaceholder",{defaultMessage:"Variable name"}),onChange:this.handleChange(e,"name"),value:e.name})),Object(p.jsx)(g.EuiFlexItem,{className:"tvbAggs__varMetricWrapper"},Object(p.jsx)(J,{onChange:this.handleChange(e,"field"),metrics:this.props.metrics,metric:this.props.model,value:e.field,fields:this.props.fields[Object(se.c)(this.props.indexPattern)],includeSiblings:this.props.includeSiblings,exclude:this.props.exclude})),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(M,{onAdd:i,onDelete:a,disableDelete:s.length<2,responsive:!1}))))}render(){const{model:e,name:t}=this.props;if(!e[t])return Object(p.jsx)("div",null);const s=e[t].map(this.renderRow);return Object(p.jsx)(g.EuiFlexGroup,{direction:"column",gutterSize:"s"},s)}}vars_CalculationVars.defaultProps={name:"variables",includeSiblings:!1};const be="INVALID_FIELD",ge=(e,t)=>(e||[]).map((e=>e.options)).flat().find((e=>(null==e?void 0:e.value)===t)),je=h.i18n.translate("visTypeTimeseries.fieldSelect.selectFieldPlaceholder",{defaultMessage:"Select field..."});function pe({options:e,selectedOptions:t,placeholder:s=je,disabled:i,disableAdd:a,disableDelete:l,onChange:n,onDeleteItem:r,onNewItemAdd:o}){const d=Boolean(null==t?void 0:t.find((e=>e.id===be)));return Object(p.jsx)(g.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},Object(p.jsx)(g.EuiFlexItem,{grow:!0},Object(p.jsx)(g.EuiComboBox,{placeholder:s,isDisabled:i,options:e,selectedOptions:t,onChange:n,singleSelection:{asPlainText:!0},isInvalid:d,fullWidth:!0,"data-test-subj":"fieldSelectItem"})),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(M,{onAdd:o,onDelete:r,disableDelete:l,disableAdd:a,responsive:!1,testSubj:"fieldSelectItem"})))}const me=h.i18n.translate("visTypeTimeseries.fieldSelect.dragAriaLabel",{defaultMessage:"Drag field"});function xe(e){return Object(p.jsx)(g.EuiDragDropContext,{onDragEnd:e.onDragEnd},Object(p.jsx)(g.EuiDroppable,{droppableId:"onDragEnd",spacing:"none"},e.values.map(((t,s)=>Object(p.jsx)(g.EuiDraggable,{spacing:"m",key:s,index:s,draggableId:`${s}`,customDragHandle:!0},(i=>Object(p.jsx)(g.EuiFlexGroup,{alignItems:"center"},Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiPanel,_()({color:"transparent",paddingSize:"s"},i.dragHandleProps,{"aria-label":me}),Object(p.jsx)(g.EuiIcon,{type:"grab"}))),Object(p.jsx)(g.EuiFlexItem,{grow:!0},Object(p.jsx)(e.WrappedComponent,{value:t,index:s})))))))))}const ve=(e,t)=>{var s;return e&&(null===(s=ge(t,e))||void 0===s?void 0:s.label)};function Oe({label:e,fullWidth:t,type:s,value:i,fields:a,indexPattern:n,uiRestrictions:r,restrict:o,onChange:d,disabled:u,placeholder:c,allowMultiSelect:b=!1,"data-test-subj":j}){const m=Object(g.htmlIdGenerator)(),x=Object(se.c)(n),v=Object(l.useMemo)((()=>[null!=i?i:null].flat()),[i]),O=Object(l.useMemo)((()=>((e,t,s=[],i,a=[])=>{const l=(e,t)=>{const s=e=>(e.label||"").toLowerCase();return s(e).localeCompare(s(t))},n=Object.values(s.reduce(((s,l)=>{if(o=l.type,(!a.length||a.includes(o))&&((e,t,s)=>!!A(t,s)&&P(e,t,null==s?void 0:s[S.WHITE_LISTED_METRICS]))(l.name,e,i)){var n,r;const e={value:l.name,label:null!==(n=l.label)&&void 0!==n?n:l.name,disabled:t.includes(l.name)},i=null===(r=s[l.type])||void 0===r?void 0:r.options;i?i.push(e):s[l.type]={options:[e],label:l.type}}var o;return s}),{}));return n.sort(l),n.forEach((e=>{Array.isArray(e.options)&&e.options.sort(l)})),n})(s,v,a[x],r,o)),[a,x,o,v,s,r]),T=Object(l.useMemo)((()=>{const e=new Map;if(v){const t=t=>{const s=ge(O,t);s?e.set(t,[s]):e.set(t,[{label:t,id:be}])};v.forEach((e=>e&&t(e)))}return e}),[O,v]),f=Object(l.useMemo)((()=>[...T.values()].flat().filter((e=>(null==e?void 0:e.label)&&(null==e?void 0:e.id)===be)).map((e=>e.label))),[T]),E=Object(l.useCallback)(((e=0,[t])=>{d(((e,t=null,s=0)=>{const i=[...e];return i[s]=t,i})(v,null==t?void 0:t.value,e))}),[v,d]),y=Object(l.useCallback)((e=>d(((e,t=0)=>{const s=[...e];return s.splice(t+1,0,null),s})(v,e))),[v,d]),M=Object(l.useCallback)((e=>d(((e,t=0)=>e.filter(((e,s)=>s!==t)))(v,e))),[d,v]),F=Object(l.useCallback)((({source:e,destination:t})=>{t&&e.index!==(null==t?void 0:t.index)&&d(((e,t=0,s=0)=>{const i=[...e];return i.splice(s,0,i.splice(t,1)[0]),i})(v,e.index,t.index))}),[d,v]),C=Object(l.useMemo)((()=>e=>{var t;return Object(p.jsx)(pe,{options:O,selectedOptions:null!==(t=e.value?T.get(e.value):void 0)&&void 0!==t?t:[],disabled:u,onNewItemAdd:y.bind(void 0,e.index),onDeleteItem:M.bind(void 0,e.index),onChange:E.bind(void 0,e.index),placeholder:ve(c,O),disableAdd:!b||(null==v?void 0:v.length)>=4,disableDelete:!b||(null==v?void 0:v.length)<=1})}),[O,T,u,y,M,E,c,b,null==v?void 0:v.length]);return Object(p.jsx)(g.EuiFormRow,{id:m("fieldSelect"),label:e,error:h.i18n.translate("visTypeTimeseries.fieldSelect.fieldIsNotValid",{defaultMessage:'The "{fieldParameter}" selection is not valid for use with the current index.',values:{fieldParameter:f.join(", ")}}),fullWidth:t,isInvalid:Boolean(f.length),"data-test-subj":null!=j?j:"metricsIndexPatternFieldsSelect"},(null==v?void 0:v.length)>1?Object(p.jsx)(xe,{values:v,onDragEnd:F,WrappedComponent:C}):Object(p.jsx)(C,{value:null==v?void 0:v[0]}))}var he=s(18);function Te(e){switch(e){case U.METRIC_TYPES.CARDINALITY:return Object.values(he.KBN_FIELD_TYPES).filter((e=>e!==he.KBN_FIELD_TYPES.HISTOGRAM));case I.i.VALUE_COUNT:return Object.values(he.KBN_FIELD_TYPES);case U.METRIC_TYPES.AVG:case U.METRIC_TYPES.SUM:case U.METRIC_TYPES.MIN:case U.METRIC_TYPES.MAX:return[he.KBN_FIELD_TYPES.NUMBER,he.KBN_FIELD_TYPES.HISTOGRAM];default:return[he.KBN_FIELD_TYPES.NUMBER]}}function fe(e){const{model:t,panel:s,series:i,fields:a,uiRestrictions:l}=e,n=Z(e.onChange,t),r=ee(n),o=Te(t.type),d=i.override_index_pattern?i.series_index_pattern:s.index_pattern,u=Object(g.htmlIdGenerator)();return Object(p.jsx)(F,{disableDelete:e.disableDelete,model:e.model,onAdd:e.onAdd,onDelete:e.onDelete,siblings:e.siblings,dragHandleProps:e.dragHandleProps},Object(p.jsx)(g.EuiFlexGroup,{gutterSize:"s"},Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormLabel,{htmlFor:u("aggregation")},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.stdAgg.aggregationLabel",defaultMessage:"Aggregation"})),Object(p.jsx)(g.EuiSpacer,{size:"xs"}),Object(p.jsx)(W,{id:u("aggregation"),panelType:e.panel.type,siblings:e.siblings,value:t.type,onChange:r("type"),fullWidth:!0})),"count"!==t.type?Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(Oe,{label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.stdAgg.fieldLabel",defaultMessage:"Field"}),fields:a,type:t.type,restrict:o,indexPattern:d,value:t.field,onChange:e=>n({field:null==e?void 0:e[0]}),uiRestrictions:l,fullWidth:!0})):null))}var Ee=s(8);const ye=e=>u.a.assign({id:f.a.v1(),mode:"line",shade:.2,color:Ee.d},e);class percentile_ui_Percentiles extends l.Component{constructor(...e){super(...e),a()(this,"renderRow",((e,t,s)=>{const i={value:"",percentile:"",shade:"",color:Ee.d,...e},{panel:a,seriesId:l}=this.props,n={minWidth:100},r=a.series.find((e=>e.id===l))||a.series[0],o=a.series.length>0&&"everything"!==r.split_mode,d=Object(p.jsx)(g.EuiFlexItem,{style:n},Object(p.jsx)(g.EuiFormRow,{label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.percentile.percentile",defaultMessage:"Percentile"})},Object(p.jsx)(g.EuiFieldNumber,{"aria-label":h.i18n.translate("visTypeTimeseries.percentile.percentileAriaLabel",{defaultMessage:"Percentile"}),placeholder:0,max:100,min:0,step:1,onChange:this.handleTextChange(i,"value"),value:""===i.value?"":Number(i.value)})));if("table"===a.type)return d;const u=ue.handleAdd.bind(null,this.props,ye),c=ue.handleDelete.bind(null,this.props,i),b=[{label:h.i18n.translate("visTypeTimeseries.percentile.modeOptions.lineLabel",{defaultMessage:"Line"}),value:"line"},{label:h.i18n.translate("visTypeTimeseries.percentile.modeOptions.bandLabel",{defaultMessage:"Band"}),value:"band"}],m={...n};"line"===i.mode&&(m.display="none");const x=Object(g.htmlIdGenerator)(i.id),v=b.find((e=>i.mode===e.value));return Object(p.jsx)(g.EuiFlexItem,{key:i.id},Object(p.jsx)(g.EuiPanel,null,Object(p.jsx)(g.EuiFlexGroup,{key:i.id,alignItems:"center"},Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFlexGrid,{columns:3},!o&&!["table","metric","markdown"].includes(a.type)&&Object(p.jsx)(g.EuiFlexItem,{grow:!1,style:{justifyContent:"center"}},Object(p.jsx)(y,{disableTrash:!0,onChange:this.handleColorChange(i),value:i.color,name:"color"})),d,Object(p.jsx)(g.EuiFlexItem,{style:n},Object(p.jsx)(g.EuiFormRow,{label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.percentile.modeLabel",defaultMessage:"Mode:"})},Object(p.jsx)(g.EuiComboBox,{isClearable:!1,id:x("mode"),options:b,selectedOptions:v?[v]:[],onChange:this.handleTextChange(i,"mode"),singleSelection:{asPlainText:!0}}))),Object(p.jsx)(g.EuiFlexItem,{style:m},Object(p.jsx)(g.EuiFormRow,{label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.percentile.fillToLabel",defaultMessage:"Fill to:"})},Object(p.jsx)(g.EuiFieldNumber,{id:x("fillTo"),min:0,max:100,step:1,onChange:this.handleTextChange(i,"percentile"),value:Number(i.percentile)}))),Object(p.jsx)(g.EuiFlexItem,{style:m},Object(p.jsx)(g.EuiFormRow,{label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.percentile.shadeLabel",defaultMessage:"Shade (0 to 1):"})},Object(p.jsx)(g.EuiFieldNumber,{id:x("shade"),step:.1,onChange:this.handleTextChange(i,"shade"),value:Number(i.shade)}))))),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(M,{onAdd:u,onDelete:c,disableDelete:s.length<2,responsive:!1})))))}))}handleTextChange(e,t){return s=>{const i=ue.handleChange.bind(null,this.props),a={};a[t]=u.a.get(s,"[0].value",u.a.get(s,"target.value")),i(u.a.assign({},e,a))}}handleColorChange(e){return t=>{ue.handleChange.bind(null,this.props)(u.a.assign({},e,t))}}render(){const{model:e,name:t,panel:s}=this.props;if(!e[t])return Object(p.jsx)("div",null);let i;return i="table"===s.type?this.renderRow(u.a.last(e[t])):e[t].map(this.renderRow),Object(p.jsx)(g.EuiFlexGroup,{direction:"column",gutterSize:"s"},i)}}percentile_ui_Percentiles.defaultProps={name:"percentile"};const Me=({value:e,onChange:t})=>Object(p.jsx)(g.EuiFormRow,{label:Object(p.jsx)(n.a.Fragment,null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.percentileHdr.numberOfSignificantValueDigits",defaultMessage:"Number of significant value digits (HDR histogram)"})," ",Object(p.jsx)(g.EuiIconTip,{position:"right",content:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.percentileHdr.numberOfSignificantValueDigits.hint",defaultMessage:"HDR Histogram (High Dynamic Range Histogram) is an alternative implementation that can be useful when calculating percentile ranks for latency measurements as it can be faster than the t-digest implementation with the trade-off of a larger memory footprint. Number of significant value digits parameter specifies the resolution of values for the histogram in number of significant digits"}),type:"questionInCircle"}))},Object(p.jsx)(g.EuiFieldNumber,{min:1,value:e||"",onChange:t})),Fe=[he.KBN_FIELD_TYPES.NUMBER,he.KBN_FIELD_TYPES.HISTOGRAM],Ce=he.KBN_FIELD_TYPES.NUMBER,_e=Object(j.injectI18n)((e=>{const{series:t,panel:s,fields:i,intl:a}=e,l={sigma:"",...e.model},n=[{label:a.formatMessage({id:"visTypeTimeseries.stdDeviation.modeOptions.rawLabel",defaultMessage:"Raw"}),value:"raw"},{label:a.formatMessage({id:"visTypeTimeseries.stdDeviation.modeOptions.upperBoundLabel",defaultMessage:"Upper Bound"}),value:"upper"},{label:a.formatMessage({id:"visTypeTimeseries.stdDeviation.modeOptions.lowerBoundLabel",defaultMessage:"Lower Bound"}),value:"lower"}];"table"!==s.type&&n.push({label:a.formatMessage({id:"visTypeTimeseries.stdDeviation.modeOptions.boundsBandLabel",defaultMessage:"Bounds Band"}),value:"band"});const r=Z(e.onChange,l),o=ee(r),d=le(r),u=t.override_index_pattern?t.series_index_pattern:s.index_pattern,c=Object(g.htmlIdGenerator)(),b=n.find((e=>l.mode===e.value));return Object(p.jsx)(F,{disableDelete:e.disableDelete,model:e.model,onAdd:e.onAdd,onDelete:e.onDelete,siblings:e.siblings,dragHandleProps:e.dragHandleProps},Object(p.jsx)(g.EuiFlexGroup,{gutterSize:"s"},Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormLabel,{htmlFor:c("aggregation")},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.stdDeviation.aggregationLabel",defaultMessage:"Aggregation"})),Object(p.jsx)(g.EuiSpacer,{size:"xs"}),Object(p.jsx)(W,{id:c("aggregation"),panelType:e.panel.type,siblings:e.siblings,value:l.type,onChange:o("type")})),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(Oe,{label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.stdDeviation.fieldLabel",defaultMessage:"Field"}),fields:i,type:l.type,restrict:Ce,indexPattern:u,value:l.field,onChange:e=>r({field:null==e?void 0:e[0]})})),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormRow,{id:c("sigma"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.stdDeviation.sigmaLabel",defaultMessage:"Sigma"})},Object(p.jsx)(g.EuiFieldText,{value:l.sigma,onChange:d("sigma")}))),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:c("mode"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.stdDeviation.modeLabel",defaultMessage:"Mode"})},Object(p.jsx)(g.EuiComboBox,{options:n,selectedOptions:b?[b]:[],onChange:o("mode"),singleSelection:{asPlainText:!0}})))))})),Ie=Object(j.injectI18n)((e=>{const{siblings:t,intl:s,fields:i,indexPattern:a}=e,l={sigma:"",...e.model},n=Object(g.htmlIdGenerator)(),r=Z(e.onChange,l),o=ee(r),d=le(r),u={};if("std_deviation_bucket"===l.type){u.sigma=Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormRow,{id:n("sigma"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.stdSibling.sigmaLabel",defaultMessage:"Sigma"})},Object(p.jsx)(g.EuiFieldText,{value:l.sigma,onChange:d("sigma")})));const e=[{label:s.formatMessage({id:"visTypeTimeseries.stdSibling.modeOptions.rawLabel",defaultMessage:"Raw"}),value:"raw"},{label:s.formatMessage({id:"visTypeTimeseries.stdSibling.modeOptions.upperBoundLabel",defaultMessage:"Upper Bound"}),value:"upper"},{label:s.formatMessage({id:"visTypeTimeseries.stdSibling.modeOptions.lowerBoundLabel",defaultMessage:"Lower Bound"}),value:"lower"},{label:s.formatMessage({id:"visTypeTimeseries.stdSibling.modeOptions.boundsBandLabel",defaultMessage:"Bounds Band"}),value:"band"}],t=e.find((e=>l.mode===e.value));u.mode=Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:n("mode"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.stdSibling.modeLabel",defaultMessage:"Mode"})},Object(p.jsx)(g.EuiComboBox,{options:e,selectedOptions:t?[t]:[],onChange:o("mode"),singleSelection:{asPlainText:!0}})))}return Object(p.jsx)(F,{disableDelete:e.disableDelete,model:e.model,onAdd:e.onAdd,onDelete:e.onDelete,siblings:e.siblings,dragHandleProps:e.dragHandleProps},Object(p.jsx)(g.EuiFlexGroup,{gutterSize:"s"},Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormLabel,{htmlFor:n("aggregation")},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.stdSibling.aggregationLabel",defaultMessage:"Aggregation"})),Object(p.jsx)(g.EuiSpacer,{size:"xs"}),Object(p.jsx)(W,{id:n("aggregation"),panelType:e.panel.type,siblings:e.siblings,value:l.type,onChange:o("type")})),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:n("metric"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.stdSibling.metricLabel",defaultMessage:"Metric"})},Object(p.jsx)(J,{onChange:o("field"),exclude:[I.i.PERCENTILE,I.i.TOP_HIT],metrics:t,fields:i[Object(se.c)(a)],metric:l,value:l.field}))),u.sigma,u.mode))})),Se=Object(j.injectI18n)((function(e){const{panel:t,model:s,intl:i}=e,a=Z(e.onChange,s),l=ee(a),n=Object(g.htmlIdGenerator)(),r=[{label:i.formatMessage({id:"visTypeTimeseries.seriesAgg.functionOptions.sumLabel",defaultMessage:"Sum"}),value:"sum"},{label:i.formatMessage({id:"visTypeTimeseries.seriesAgg.functionOptions.maxLabel",defaultMessage:"Max"}),value:"max"},{label:i.formatMessage({id:"visTypeTimeseries.seriesAgg.functionOptions.minLabel",defaultMessage:"Min"}),value:"min"},{label:i.formatMessage({id:"visTypeTimeseries.seriesAgg.functionOptions.avgLabel",defaultMessage:"Avg"}),value:"mean"},{label:i.formatMessage({id:"visTypeTimeseries.seriesAgg.functionOptions.countLabel",defaultMessage:"Series count"}),value:"count"},{label:i.formatMessage({id:"visTypeTimeseries.seriesAgg.functionOptions.overallSumLabel",defaultMessage:"Overall Sum"}),value:"overall_sum"},{label:i.formatMessage({id:"visTypeTimeseries.seriesAgg.functionOptions.overallMaxLabel",defaultMessage:"Overall Max"}),value:"overall_max"},{label:i.formatMessage({id:"visTypeTimeseries.seriesAgg.functionOptions.overallMinLabel",defaultMessage:"Overall Min"}),value:"overall_min"},{label:i.formatMessage({id:"visTypeTimeseries.seriesAgg.functionOptions.overallAvgLabel",defaultMessage:"Overall Avg"}),value:"overall_avg"},{label:i.formatMessage({id:"visTypeTimeseries.seriesAgg.functionOptions.cumulativeSumLabel",defaultMessage:"Cumulative Sum"}),value:"cumulative_sum"}],o=r.find((e=>s.function===e.value));return"table"===t.type?Object(p.jsx)(F,{disableDelete:e.disableDelete,model:e.model,onAdd:e.onAdd,onDelete:e.onDelete,siblings:e.siblings,dragHandleProps:e.dragHandleProps},Object(p.jsx)(g.EuiTitle,{className:"tvbAggRow__unavailable",size:"xxxs"},Object(p.jsx)("span",null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.seriesAgg.seriesAggIsNotCompatibleLabel",defaultMessage:"Series Agg is not compatible with the table visualization."})))):Object(p.jsx)(F,{disableDelete:e.disableDelete,model:e.model,onAdd:e.onAdd,onDelete:e.onDelete,siblings:e.siblings,dragHandleProps:e.dragHandleProps},Object(p.jsx)(g.EuiFlexGroup,{gutterSize:"s"},Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormLabel,{htmlFor:n("aggregation")},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.seriesAgg.aggregationLabel",defaultMessage:"Aggregation"})),Object(p.jsx)(g.EuiSpacer,{size:"xs"}),Object(p.jsx)(W,{id:n("aggregation"),panelType:t.type,siblings:e.siblings,value:s.type,onChange:l("type")})),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:n("function"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.seriesAgg.functionLabel",defaultMessage:"Function"})},Object(p.jsx)(g.EuiComboBox,{options:r,selectedOptions:o?[o]:[],onChange:l("function"),singleSelection:{asPlainText:!0}})))))}));var we=s(0),Le=s(40);const Pe=n.a.createContext(null);function Ae({query:e,onChange:t,isInvalid:s,indexPatterns:i,"data-test-subj":a}){const n=Object(we.d)(),[r,o]=Object(l.useState)([]),d=Object(l.useContext)(Pe);return Object(l.useEffect)((()=>{!async function(){const e=[];for(const t of null!=i?i:[])if(t){if(Object(se.d)(t))e.push(t);else if(null!=t&&t.id){const{indexPattern:s}=await Object(se.b)(t,n);s&&e.push(s)}}else{const t=await n.getDefault();t&&e.push(t)}o(e)}()}),[i,n]),Object(p.jsx)(Le.QueryStringInput,_()({query:e,onChange:t,isInvalid:s,indexPatterns:r},d,{dataTestSubj:a}))}Pe.Provider;const De=(e,t,s)=>{const i=e[Object(se.c)(t)];if(!i)return!1;const a=i.find((e=>e.name===s));return!!a&&a.type===he.KBN_FIELD_TYPES.HISTOGRAM},Re=({model:e,onChange:t,onDelete:s,onAdd:i,disableAdd:a,disableDelete:l,enableColorPicker:n})=>Object(p.jsx)(g.EuiPanel,{paddingSize:"s",className:"tvbAggRow__multiValueRow"},Object(p.jsx)(g.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},n&&Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(y,{disableTrash:!0,onChange:s=>t({...e,color:(null==s?void 0:s.color)||Ee.d}),value:e.color,name:"color"})),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFieldNumber,{value:""===e.value?"":Number(e.value),placeholder:"0",onChange:s=>t({...e,value:Object(d.get)(s,"target.value")})})),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(M,{onAdd:i,onDelete:()=>s(e),disableDelete:l,disableAdd:a,responsive:!1}))));Re.defaultProps={model:{id:null,value:""}};const Ne=e=>{const t=e.values||[],s=e.colors||[],{onChange:i,disableAdd:a,disableDelete:l,showOnlyLastRow:n,enableColorPicker:r}=e,o=({value:e,id:a,color:l})=>{t[a]=e,s[a]=l,i(t,s)},u=({id:e})=>i(t.filter(((t,s)=>e!==s)),s.filter(((t,s)=>e!==s))),c=()=>i([...t,""],[...s,Ee.d]),b=({rowModel:e,disableDeleteRow:t,disableAddRow:s})=>Object(p.jsx)(g.EuiFlexItem,{key:`percentileRankValue__item${e.id}`},Object(p.jsx)(Re,{onAdd:c,onChange:o,onDelete:u,disableDelete:t,disableAdd:s,model:e,enableColorPicker:r}));return Object(p.jsx)(g.EuiFlexGroup,{direction:"column",gutterSize:"s"},n&&b({rowModel:{id:t.length-1,value:Object(d.last)(t)||"",color:Object(d.last)(s)||Ee.d},disableAddRow:!0,disableDeleteRow:!0}),!n&&t.map(((e,t,i)=>b({rowModel:{id:t,value:e||"",color:s[t]||Ee.d},disableAddRow:a,disableDeleteRow:l||i.length<2}))))},ke=[he.KBN_FIELD_TYPES.NUMBER,he.KBN_FIELD_TYPES.HISTOGRAM],Be="agg_with",Ge=[he.KBN_FIELD_TYPES.DATE],ze=Object(j.injectI18n)((e=>{var t;const{fields:s,series:i,panel:a}=e,n=Object(l.useMemo)((()=>({size:1,order:"desc",[Be]:"noop",...e.model})),[e.model]),r=i.override_index_pattern?i.series_index_pattern:a.index_pattern,o=[I.e.TABLE,I.e.METRIC,I.e.MARKDOWN].includes(a.type)?[he.KBN_FIELD_TYPES.NUMBER,he.KBN_FIELD_TYPES.STRING,he.KBN_FIELD_TYPES.DATE]:[he.KBN_FIELD_TYPES.NUMBER],d=Z(e.onChange,n),u=ee(d),c=le(d),b=Object(se.c)(r),m=((e={},t)=>{if(s=t,i=e.type,!s.length||s.includes(i))switch(e.type){case he.KBN_FIELD_TYPES.NUMBER:return[{label:h.i18n.translate("visTypeTimeseries.topHit.aggWithOptions.averageLabel",{defaultMessage:"Avg"}),value:"avg"},{label:h.i18n.translate("visTypeTimeseries.topHit.aggWithOptions.maxLabel",{defaultMessage:"Max"}),value:"max"},{label:h.i18n.translate("visTypeTimeseries.topHit.aggWithOptions.minLabel",{defaultMessage:"Min"}),value:"min"},{label:h.i18n.translate("visTypeTimeseries.topHit.aggWithOptions.sumLabel",{defaultMessage:"Sum"}),value:"sum"}];case he.KBN_FIELD_TYPES.STRING:case he.KBN_FIELD_TYPES.DATE:return[{label:h.i18n.translate("visTypeTimeseries.topHit.aggWithOptions.concatenate",{defaultMessage:"Concatenate"}),value:"concat"}]}var s,i;return[]})(null==s||null===(t=s[b])||void 0===t?void 0:t.find((e=>e.name===n.field)),o),x=[{label:h.i18n.translate("visTypeTimeseries.topHit.orderOptions.ascLabel",{defaultMessage:"Asc"}),value:"asc"},{label:h.i18n.translate("visTypeTimeseries.topHit.orderOptions.descLabel",{defaultMessage:"Desc"}),value:"desc"}],v=Object(g.htmlIdGenerator)(),O=m.find((e=>n.agg_with===e.value)),T=x.find((e=>n.order===e.value));return Object(l.useEffect)((()=>{var e;const t=null==m||null===(e=m[0])||void 0===e?void 0:e.value,s=n.agg_with;s&&t&&s!==t&&!O&&d({[Be]:t})}),[n,O,m,d]),Object(p.jsx)(F,{disableDelete:e.disableDelete,model:e.model,onAdd:e.onAdd,onDelete:e.onDelete,siblings:e.siblings,dragHandleProps:e.dragHandleProps},Object(p.jsx)(g.EuiFlexGroup,{gutterSize:"s"},Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormLabel,{htmlFor:v("aggregation")},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.topHit.aggregationLabel",defaultMessage:"Aggregation"})),Object(p.jsx)(g.EuiSpacer,{size:"xs"}),Object(p.jsx)(W,{id:v("aggregation"),panelType:e.panel.type,siblings:e.siblings,value:n.type,onChange:u("type")})),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(Oe,{label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.topHit.fieldLabel",defaultMessage:"Field"}),fields:s,type:n.type,restrict:o,indexPattern:r,value:n.field,onChange:e=>d({field:null==e?void 0:e[0]})}))),Object(p.jsx)(g.EuiSpacer,{size:"m"}),Object(p.jsx)(g.EuiFlexGroup,{gutterSize:"s"},Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormRow,{id:v("size"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.topHit.sizeLabel",defaultMessage:"Size"})},Object(p.jsx)("input",{className:"tvbAgg__input",value:n.size,onChange:c("size")}))),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:v(Be),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.topHit.aggregateWithLabel",defaultMessage:"Aggregate with"})},Object(p.jsx)(g.EuiComboBox,{isClearable:!1,placeholder:h.i18n.translate("visTypeTimeseries.topHit.aggregateWith.selectPlaceholder",{defaultMessage:"Select..."}),options:m,selectedOptions:O?[O]:[],onChange:u(Be),singleSelection:{asPlainText:!0},"data-test-subj":"topHitAggregateWithComboBox"}))),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(Oe,{label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.topHit.orderByLabel",defaultMessage:"Order by"}),restrict:Ge,value:n.order_by,onChange:e=>d({order_by:null==e?void 0:e[0]}),indexPattern:r,fields:s,"data-test-subj":"topHitOrderByFieldSelect"})),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:v("order"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.topHit.orderLabel",defaultMessage:"Order"})},Object(p.jsx)(g.EuiComboBox,{isClearable:!1,placeholder:h.i18n.translate("visTypeTimeseries.topHit.order.selectPlaceholder",{defaultMessage:"Select..."}),options:x,selectedOptions:T?[T]:[],onChange:u("order"),singleSelection:{asPlainText:!0}})))))})),He=[{label:h.i18n.translate("visTypeTimeseries.units.auto",{defaultMessage:"auto"}),value:""},{label:h.i18n.translate("visTypeTimeseries.units.perMillisecond",{defaultMessage:"per millisecond"}),value:"1ms"},{label:h.i18n.translate("visTypeTimeseries.units.perSecond",{defaultMessage:"per second"}),value:"1s"},{label:h.i18n.translate("visTypeTimeseries.units.perMinute",{defaultMessage:"per minute"}),value:"1m"},{label:h.i18n.translate("visTypeTimeseries.units.perHour",{defaultMessage:"per hour"}),value:"1h"},{label:h.i18n.translate("visTypeTimeseries.units.perDay",{defaultMessage:"per day"}),value:"1d"}],Ve={count:fe,avg:fe,max:fe,min:fe,sum:fe,std_deviation:_e,sum_of_squares:fe,variance:fe,avg_bucket:Ie,max_bucket:Ie,min_bucket:Ie,sum_bucket:Ie,variance_bucket:Ie,sum_of_squares_bucket:Ie,std_deviation_bucket:Ie,percentile:function(e){const{series:t,model:s,panel:i,fields:a}=e,n=Object(g.htmlIdGenerator)(),r=Z(e.onChange,s),o=ee(r),d=te(r),u=t.override_index_pattern?t.series_index_pattern:i.index_pattern;return Object(l.useEffect)((()=>{(e=>Array.isArray(e.percentiles))(s)||r({percentiles:[ye({value:50})]})}),[r,s]),Object(p.jsx)(F,{disableDelete:e.disableDelete,model:e.model,onAdd:e.onAdd,onDelete:e.onDelete,siblings:e.siblings,dragHandleProps:e.dragHandleProps},Object(p.jsx)(g.EuiFlexGrid,{gutterSize:"s",columns:2},Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormLabel,{htmlFor:n("aggregation")},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.percentile.aggregationLabel",defaultMessage:"Aggregation"})),Object(p.jsx)(g.EuiSpacer,{size:"xs"}),Object(p.jsx)(W,{id:n("aggregation"),panelType:e.panel.type,siblings:e.siblings,value:s.type,onChange:o("type")})),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(Oe,{label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.percentile.fieldLabel",defaultMessage:"Field"}),fields:a,type:s.type,restrict:Fe,indexPattern:u,value:s.field,onChange:e=>r({field:null==e?void 0:e[0]})})),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.percentile.percents",defaultMessage:"Percents"})},Object(p.jsx)(percentile_ui_Percentiles,{onChange:r,name:"percentiles",model:s,panel:i,seriesId:t.id}))),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(Me,{value:s.numberOfSignificantValueDigits,onChange:d("numberOfSignificantValueDigits")}))))},percentile_rank:e=>{var t;const{panel:s,fields:i,indexPattern:a}=e,l={values:[""],colors:[Ee.d],...e.model},n=Object(g.htmlIdGenerator)(),r="table"===s.type,o=Z(e.onChange,l),d=ee(o),u=te(o),c=s.series.find((t=>t.id===e.series.id))||s.series[0],b=!(s.series.length>0&&"everything"!==c.split_mode||["table","metric","markdown"].includes(s.type));return Object(p.jsx)(F,{disableDelete:e.disableDelete,model:e.model,onAdd:e.onAdd,onDelete:e.onDelete,siblings:e.siblings,dragHandleProps:e.dragHandleProps},Object(p.jsx)(g.EuiFlexGrid,{gutterSize:"s",columns:2},Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormLabel,{htmlFor:n("aggregation")},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.percentileRank.aggregationLabel",defaultMessage:"Aggregation"})),Object(p.jsx)(g.EuiSpacer,{size:"xs"}),Object(p.jsx)(W,{id:n("aggregation"),panelType:e.panel.type,siblings:e.siblings,value:l.type,onChange:d("type")})),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(Oe,{label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.percentileRank.fieldLabel",defaultMessage:"Field"}),fields:i,type:l.type,restrict:ke,indexPattern:a,value:null!==(t=l.field)&&void 0!==t?t:"",onChange:e=>o({field:null==e?void 0:e[0]})})),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.percentileRank.values",defaultMessage:"Values"})},Object(p.jsx)(Ne,{disableAdd:r,disableDelete:r,showOnlyLastRow:r,values:l.values,colors:l.colors,onChange:(e,t)=>{o({...l,values:e,colors:t})},enableColorPicker:b}))),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(Me,{value:l.numberOfSignificantValueDigits,onChange:u("numberOfSignificantValueDigits")}))))},cardinality:fe,value_count:fe,calculation:function(e){const t=Object(g.htmlIdGenerator)(),{siblings:s,model:i,indexPattern:a,fields:n}=e,r=Z(e.onChange,i),o=ee(r),d=le(r);return Object(l.useEffect)((()=>{(e=>Array.isArray(e.variables)&&void 0!==e.script)(i)||r({variables:[ce()],script:""})}),[r,i]),Object(p.jsx)(F,{disableDelete:e.disableDelete,model:e.model,onAdd:e.onAdd,onDelete:e.onDelete,siblings:e.siblings,dragHandleProps:e.dragHandleProps},Object(p.jsx)(g.EuiFlexGroup,{direction:"column",gutterSize:"l"},Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormLabel,{htmlFor:t("aggregation")},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.calculation.aggregationLabel",defaultMessage:"Aggregation"})),Object(p.jsx)(g.EuiSpacer,{size:"xs"}),Object(p.jsx)(W,{id:t("aggregation"),panelType:e.panel.type,siblings:e.siblings,value:i.type,onChange:o("type")})),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormLabel,{htmlFor:t("variables")},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.calculation.variablesLabel",defaultMessage:"Variables"})),Object(p.jsx)(g.EuiSpacer,{size:"xs"}),Object(p.jsx)(vars_CalculationVars,{id:t("variables"),metrics:s,indexPattern:a,fields:n,onChange:r,name:"variables",model:i,exclude:[I.i.TOP_HIT]})),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:t("painless"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.calculation.painlessScriptLabel",defaultMessage:"Painless Script"}),fullWidth:!0,helpText:Object(p.jsx)("div",null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.calculation.painlessScriptDescription",defaultMessage:"Variables are keys on the {params} object, i.e. {paramsName}. To access the bucket interval (in milliseconds) use {paramsInterval}.",values:{params:Object(p.jsx)(g.EuiCode,null,"params"),paramsName:Object(p.jsx)(g.EuiCode,null,"params.<name>"),paramsInterval:Object(p.jsx)(g.EuiCode,null,"params._interval")}}))},Object(p.jsx)(g.EuiTextArea,{onChange:d("script"),value:i.script,fullWidth:!0})))))},cumulative_sum:function(e){const{model:t,siblings:s,fields:i,indexPattern:a}=e,l=Object(g.htmlIdGenerator)(),n=Z(e.onChange,t),r=ee(n);return Object(p.jsx)(F,{disableDelete:e.disableDelete,model:e.model,onAdd:e.onAdd,onDelete:e.onDelete,siblings:e.siblings,dragHandleProps:e.dragHandleProps},Object(p.jsx)(g.EuiFlexGroup,{gutterSize:"s"},Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormLabel,{htmlFor:l("aggregation")},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.cumulativeSum.aggregationLabel",defaultMessage:"Aggregation"})),Object(p.jsx)(g.EuiSpacer,{size:"xs"}),Object(p.jsx)(W,{id:l("aggregation"),panelType:e.panel.type,siblings:e.siblings,value:t.type,onChange:r("type")})),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:l("metric"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.cumulativeSum.metricLabel",defaultMessage:"Metric"})},Object(p.jsx)(J,{onChange:r("field"),metrics:s,metric:t,fields:i[Object(se.c)(a)],value:t.field,exclude:[I.i.TOP_HIT]})))))},moving_average:e=>{const{siblings:t,fields:s,indexPattern:i}=e,[a,n]=Object(l.useState)({...ie,...e.model}),r=Object(l.useCallback)((t=>{e.onChange(t),n(t)}),[e]),o=[{label:h.i18n.translate("visTypeTimeseries.movingAverage.modelOptions.simpleLabel",{defaultMessage:"Simple"}),value:I.c.UNWEIGHTED},{label:h.i18n.translate("visTypeTimeseries.movingAverage.modelOptions.linearLabel",{defaultMessage:"Linear"}),value:I.c.WEIGHTED_LINEAR},{label:h.i18n.translate("visTypeTimeseries.movingAverage.modelOptions.exponentiallyWeightedLabel",{defaultMessage:"Exponentially Weighted"}),value:I.c.WEIGHTED_EXPONENTIAL},{label:h.i18n.translate("visTypeTimeseries.movingAverage.modelOptions.holtLinearLabel",{defaultMessage:"Holt-Linear"}),value:I.c.WEIGHTED_EXPONENTIAL_DOUBLE},{label:h.i18n.translate("visTypeTimeseries.movingAverage.modelOptions.holtWintersLabel",{defaultMessage:"Holt-Winters"}),value:I.c.WEIGHTED_EXPONENTIAL_TRIPLE}],d=Z(r,a),u=ee(d),c=te(d),b=Object(g.htmlIdGenerator)(),j=o.find((({value:e})=>a.model_type===e)),m=[{label:h.i18n.translate("visTypeTimeseries.movingAverage.multiplicativeOptions.true",{defaultMessage:"True"}),value:!0},{label:h.i18n.translate("visTypeTimeseries.movingAverage.multiplicativeOptions.false",{defaultMessage:"False"}),value:!1}],x=m.find((({value:e})=>a.multiplicative===e));return Object(p.jsx)(F,{disableDelete:e.disableDelete,model:e.model,onAdd:e.onAdd,onDelete:e.onDelete,siblings:e.siblings,dragHandleProps:e.dragHandleProps},Object(p.jsx)(g.EuiFlexGroup,{gutterSize:"s"},Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormLabel,{htmlFor:b("aggregation")},h.i18n.translate("visTypeTimeseries.movingAverage.aggregationLabel",{defaultMessage:"Aggregation"})),Object(p.jsx)(g.EuiSpacer,{size:"xs"}),Object(p.jsx)(W,{id:b("aggregation"),panelType:e.panel.type,siblings:e.siblings,value:a.type,onChange:u("type")})),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:b("metric"),label:h.i18n.translate("visTypeTimeseries.movingAverage.metricLabel",{defaultMessage:"Metric"})},Object(p.jsx)(J,{onChange:u("field"),metrics:t,metric:a,fields:s[Object(se.c)(i)],value:a.field,exclude:[I.i.TOP_HIT]})))),Object(p.jsx)(g.EuiSpacer,{size:"m"}),Object(p.jsx)(g.EuiFlexGroup,{gutterSize:"s"},Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:b("model_type"),label:h.i18n.translate("visTypeTimeseries.movingAverage.modelLabel",{defaultMessage:"Model"})},Object(p.jsx)(g.EuiComboBox,{isClearable:!1,placeholder:h.i18n.translate("visTypeTimeseries.movingAverage.model.selectPlaceholder",{defaultMessage:"Select"}),options:o,selectedOptions:j?[j]:[],onChange:u("model_type"),singleSelection:{asPlainText:!0}}))),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:b("windowSize"),label:h.i18n.translate("visTypeTimeseries.movingAverage.windowSizeLabel",{defaultMessage:"Window Size"}),helpText:ae(a)&&h.i18n.translate("visTypeTimeseries.movingAverage.windowSizeHint",{defaultMessage:"Window must always be at least twice the size of your period"})},Object(p.jsx)(g.EuiFieldNumber,{className:"tvbAgg__input",onChange:c("window",{isClearable:!0}),value:a.window,min:1,isInvalid:!a.window})))),(a.model_type===I.c.WEIGHTED_EXPONENTIAL||a.model_type===I.c.WEIGHTED_EXPONENTIAL_DOUBLE||a.model_type===I.c.WEIGHTED_EXPONENTIAL_TRIPLE)&&Object(p.jsx)(l.Fragment,null,Object(p.jsx)(g.EuiSpacer,{size:"m"}),Object(p.jsx)(g.EuiFlexGroup,{gutterSize:"s"},Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:b("alpha"),label:h.i18n.translate("visTypeTimeseries.movingAverage.alpha",{defaultMessage:"Alpha"})},Object(p.jsx)(g.EuiFieldNumber,{step:.1,onChange:c("alpha"),value:a.alpha}))),(a.model_type===I.c.WEIGHTED_EXPONENTIAL_DOUBLE||a.model_type===I.c.WEIGHTED_EXPONENTIAL_TRIPLE)&&Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:b("beta"),label:h.i18n.translate("visTypeTimeseries.movingAverage.beta",{defaultMessage:"Beta"})},Object(p.jsx)(g.EuiFieldNumber,{step:.1,onChange:c("beta"),value:a.beta}))),a.model_type===I.c.WEIGHTED_EXPONENTIAL_TRIPLE&&Object(p.jsx)(l.Fragment,null,Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:b("gamma"),label:h.i18n.translate("visTypeTimeseries.movingAverage.gamma",{defaultMessage:"Gamma"})},Object(p.jsx)(g.EuiFieldNumber,{step:.1,onChange:c("gamma"),value:a.gamma}))),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:b("period"),label:h.i18n.translate("visTypeTimeseries.movingAverage.period",{defaultMessage:"Period"})},Object(p.jsx)(g.EuiFieldNumber,{step:1,onChange:c("period"),value:a.period}))),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:b("multiplicative"),label:h.i18n.translate("visTypeTimeseries.movingAverage.multiplicative",{defaultMessage:"Multiplicative"})},Object(p.jsx)(g.EuiComboBox,{placeholder:h.i18n.translate("visTypeTimeseries.movingAverage.multiplicative.selectPlaceholder",{defaultMessage:"Select"}),options:m,selectedOptions:x?[x]:[],onChange:u("multiplicative"),singleSelection:{asPlainText:!0}})))))))},derivative:e=>{const{siblings:t,fields:s,indexPattern:i}=e,a={unit:"",...e.model},l=Z(e.onChange,a),n=ee(l),r=le(l),o=Object(g.htmlIdGenerator)();return Object(p.jsx)(F,{disableDelete:e.disableDelete,model:e.model,onAdd:e.onAdd,onDelete:e.onDelete,siblings:e.siblings,dragHandleProps:e.dragHandleProps},Object(p.jsx)(g.EuiFlexGroup,{gutterSize:"s"},Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormLabel,{htmlFor:o("aggregation")},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.derivative.aggregationLabel",defaultMessage:"Aggregation"})),Object(p.jsx)(g.EuiSpacer,{size:"xs"}),Object(p.jsx)(W,{id:o("aggregation"),panelType:e.panel.type,siblings:e.siblings,value:a.type,onChange:n("type"),fullWidth:!0})),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:o("metric"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.derivative.metricLabel",defaultMessage:"Metric"}),fullWidth:!0},Object(p.jsx)(J,{onChange:n("field"),metrics:t,metric:a,fields:s[Object(se.c)(i)],value:a.field,exclude:[I.i.TOP_HIT],fullWidth:!0}))),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:o("units"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.derivative.unitsLabel",defaultMessage:"Units (1s, 1m, etc)",description:"1s and 1m are required values and must not be translated."}),fullWidth:!0},Object(p.jsx)(g.EuiFieldText,{onChange:r("unit"),value:a.unit,fullWidth:!0})))))},series_agg:Se,serial_diff:e=>{const{siblings:t,fields:s,indexPattern:i,model:a}=e,l=Z(e.onChange,a),r=ee(l),o=te(l),d=Object(g.htmlIdGenerator)();return Object(p.jsx)(F,{disableDelete:e.disableDelete,model:e.model,onAdd:e.onAdd,onDelete:e.onDelete,siblings:e.siblings,dragHandleProps:e.dragHandleProps},Object(p.jsx)(g.EuiFlexGroup,{gutterSize:"s"},Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormLabel,{htmlFor:d("aggregation")},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.serialDiff.aggregationLabel",defaultMessage:"Aggregation"})),Object(p.jsx)(g.EuiSpacer,{size:"xs"}),Object(p.jsx)(W,{id:d("aggregation"),panelType:e.panel.type,siblings:e.siblings,value:a.type,onChange:r("type")})),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:d("metric"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.serialDiff.metricLabel",defaultMessage:"Metric"})},Object(p.jsx)(J,{onChange:r("field"),metrics:t,metric:a,fields:s[Object(se.c)(i)],value:a.field,exclude:[I.i.TOP_HIT]}))),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:d("lag"),label:Object(p.jsx)(n.a.Fragment,null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.serialDiff.lagLabel",defaultMessage:"Lag",description:"'Lag' refers to the parameter name of the serial diff translation https://www.elastic.co/guide/en/elasticsearch/reference/current/search-aggregations-pipeline-serialdiff-aggregation.html. This should only be translated if there is a reasaonable word explaining what that parameter does."})," ",Object(p.jsx)(g.EuiIconTip,{position:"right",content:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.serialDiff.lagLabel.hint",defaultMessage:"The historical bucket to subtract from the current value. Must be a positive, non-zero integer"}),type:"questionInCircle"}))},Object(p.jsx)(g.EuiFieldNumber,{className:"tvbAgg__input",placeholder:1,onChange:o("lag",{isClearable:!0}),value:a.lag,min:1})))))},filter_ratio:e=>{const{series:t,fields:s,panel:i}=e,a=Object(l.useMemo)((()=>Z(e.onChange,e.model)),[e.model,e.onChange]),n=ee(a),r=Object(l.useCallback)((e=>a({numerator:e})),[a]),o=Object(l.useCallback)((e=>a({denominator:e})),[a]),d=t.override_index_pattern?t.series_index_pattern:i.index_pattern,u={numerator:Object(we.c)().query.queryString.getDefaultQuery(),denominator:Object(we.c)().query.queryString.getDefaultQuery(),metric_agg:"count",...e.model},c=Object(g.htmlIdGenerator)();return Object(p.jsx)(F,{disableDelete:e.disableDelete,model:e.model,onAdd:e.onAdd,onDelete:e.onDelete,siblings:e.siblings,dragHandleProps:e.dragHandleProps},Object(p.jsx)(g.EuiFlexGroup,{gutterSize:"s"},Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormLabel,{htmlFor:c("aggregation")},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.filterRatio.aggregationLabel",defaultMessage:"Aggregation"})),Object(p.jsx)(g.EuiSpacer,{size:"xs"}),Object(p.jsx)(W,{id:c("aggregation"),panelType:e.panel.type,siblings:e.siblings,value:u.type,onChange:n("type")})),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:c("numerator"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.filterRatio.numeratorLabel",defaultMessage:"Numerator"})},Object(p.jsx)(Ae,{query:u.numerator,onChange:r,indexPatterns:[d],"data-test-subj":"filterRatioNumeratorInput"}))),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:c("denominator"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.filterRatio.denominatorLabel",defaultMessage:"Denominator"})},Object(p.jsx)(Ae,{query:u.denominator,onChange:o,indexPatterns:[d],"data-test-subj":"filterRatioDenominatorInput"})))),Object(p.jsx)(g.EuiSpacer,{size:"m"}),Object(p.jsx)(g.EuiFlexGroup,{gutterSize:"s"},Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormLabel,{htmlFor:c("metric")},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.filterRatio.metricAggregationLabel",defaultMessage:"Metric Aggregation"})),Object(p.jsx)(g.EuiSpacer,{size:"xs"}),Object(p.jsx)(W,{id:c("metric"),siblings:e.siblings,panelType:De(s,d,u.field)?"histogram":"filter_ratio",value:u.metric_agg,onChange:n("metric_agg")})),"count"!==u.metric_agg?Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(Oe,{label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.filterRatio.fieldLabel",defaultMessage:"Field"}),fields:s,type:u.metric_agg,restrict:Te(u.metric_agg),indexPattern:d,value:u.field,onChange:e=>a({field:null==e?void 0:e[0]})})):null))},positive_only:e=>{const{siblings:t,fields:s,indexPattern:i}=e,a={unit:"",...e.model},l=Object(g.htmlIdGenerator)(),n=Z(e.onChange,a),r=ee(n);return Object(p.jsx)(F,{disableDelete:e.disableDelete,model:e.model,onAdd:e.onAdd,onDelete:e.onDelete,siblings:e.siblings,dragHandleProps:e.dragHandleProps},Object(p.jsx)(g.EuiFlexGroup,{gutterSize:"s"},Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormLabel,{htmlFor:l("aggregation")},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.positiveOnly.aggregationLabel",defaultMessage:"Aggregation"})),Object(p.jsx)(g.EuiSpacer,{size:"xs"}),Object(p.jsx)(W,{id:l("aggregation"),panelType:e.panel.type,siblings:e.siblings,value:a.type,onChange:r("type")})),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:l("metric"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.positiveOnly.metricLabel",defaultMessage:"Metric"})},Object(p.jsx)(J,{onChange:r("field"),metrics:t,metric:a,fields:s[Object(se.c)(i)],value:a.field,exclude:[I.i.TOP_HIT]})))))},static:e=>{const t=Z(e.onChange,e.model),s=ee(t),i=le(t),a={numerator:"*",denominator:"*",metric_agg:"count",value:"",...e.model},l=Object(g.htmlIdGenerator)();return Object(p.jsx)(F,{disableDelete:e.disableDelete,model:e.model,onAdd:e.onAdd,onDelete:e.onDelete,siblings:e.siblings,dragHandleProps:e.dragHandleProps},Object(p.jsx)(g.EuiFlexGroup,{gutterSize:"s"},Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormLabel,{htmlFor:l("aggregation")},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.static.aggregationLabel",defaultMessage:"Aggregation"})),Object(p.jsx)(g.EuiSpacer,{size:"xs"}),Object(p.jsx)(W,{id:l("aggregation"),panelType:e.panel.type,siblings:e.siblings,value:a.type,onChange:s("type")})),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:l("staticValue"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.static.staticValuesLabel",defaultMessage:"Static Value"})},Object(p.jsx)(g.EuiFieldNumber,{onChange:i("value"),value:""===a.value?"":Number(a.value),step:.1})))))},math:function(e){const{siblings:t,model:s,fields:i,indexPattern:a}=e,n=Object(g.htmlIdGenerator)(),r=Z(e.onChange,s),o=ee(r),d=le(r);return Object(l.useEffect)((()=>{(e=>Array.isArray(e.variables)&&void 0!==e.script)(s)||r({variables:[ce()],script:""})}),[r,s]),Object(p.jsx)(F,{disableDelete:e.disableDelete,model:e.model,onAdd:e.onAdd,onDelete:e.onDelete,siblings:e.siblings,dragHandleProps:e.dragHandleProps},Object(p.jsx)(g.EuiFlexGroup,{direction:"column",gutterSize:"l"},Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormLabel,{htmlFor:n("aggregation")},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.math.aggregationLabel",defaultMessage:"Aggregation"})),Object(p.jsx)(g.EuiSpacer,{size:"xs"}),Object(p.jsx)(W,{id:n("aggregation"),siblings:e.siblings,value:s.type,panelType:e.panel.type,onChange:o("type")})),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormLabel,{htmlFor:n("variables")},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.math.variablesLabel",defaultMessage:"Variables"})),Object(p.jsx)(g.EuiSpacer,{size:"xs"}),Object(p.jsx)(vars_CalculationVars,{id:n("variables"),metrics:t,fields:i,indexPattern:a,onChange:r,name:"variables",model:s,includeSiblings:!0})),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:"mathExpressionInput",label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.math.expressionLabel",defaultMessage:"Expression"}),fullWidth:!0,helpText:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.math.expressionDescription",defaultMessage:"This field uses basic math expressions (see {link}) - Variables are keys on the {params} object, i.e. {paramsName} To access all the data use {paramsValues} for an array of the values and {paramsTimestamps} for an array of the timestamps. {paramsTimestamp} is available for the current bucket's timestamp, {paramsIndex} is available for the current bucket's index, and {paramsInterval}s available for the interval in milliseconds.",values:{link:Object(p.jsx)(g.EuiLink,{href:"https://github.com/elastic/kibana/blob/main/packages/kbn-tinymath/docs/functions.md",target:"_blank"},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.math.expressionDescription.tinyMathLinkText",defaultMessage:"TinyMath"})),params:Object(p.jsx)(g.EuiCode,null,"params"),paramsName:Object(p.jsx)(g.EuiCode,null,"params.<name>"),paramsValues:Object(p.jsx)(g.EuiCode,null,"params._all.<name>.values"),paramsTimestamps:Object(p.jsx)(g.EuiCode,null,"params._all.<name>.timestamps"),paramsTimestamp:Object(p.jsx)(g.EuiCode,null,"params._timestamp"),paramsIndex:Object(p.jsx)(g.EuiCode,null,"params._index"),paramsInterval:Object(p.jsx)(g.EuiCode,null,"params._interval")}})},Object(p.jsx)(g.EuiTextArea,{"data-test-subj":"mathExpression",onChange:d("script"),fullWidth:!0,value:s.script})))))},top_hit:ze,positive_rate:e=>{const t={unit:"",...e.model},s=Z(e.onChange,t),i=ee(s),a=Object(g.htmlIdGenerator)(),l=e.series.override_index_pattern?e.series.series_index_pattern:e.panel.index_pattern,n=He.filter((e=>e.value===t.unit));return Object(p.jsx)(F,{disableDelete:e.disableDelete,model:e.model,onAdd:e.onAdd,onDelete:e.onDelete,siblings:e.siblings,dragHandleProps:e.dragHandleProps},Object(p.jsx)(g.EuiFlexGroup,{gutterSize:"s"},Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormLabel,{htmlFor:a("aggregation")},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.positiveRate.aggregationLabel",defaultMessage:"Aggregation"})),Object(p.jsx)(g.EuiSpacer,{size:"xs"}),Object(p.jsx)(W,{id:a("aggregation"),panelType:e.panel.type,siblings:e.siblings,value:t.type,onChange:i("type"),fullWidth:!0})),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(Oe,{label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.postiveRate.fieldLabel",defaultMessage:"Field"}),fields:e.fields,type:t.type,restrict:[he.KBN_FIELD_TYPES.NUMBER],indexPattern:l,value:t.field,onChange:e=>s({field:null==e?void 0:e[0]}),uiRestrictions:e.uiRestrictions,fullWidth:!0})),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:a("units"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.positiveRate.unitsLabel",defaultMessage:"Scale"}),fullWidth:!0},Object(p.jsx)(g.EuiComboBox,{placeholder:h.i18n.translate("visTypeTimeseries.positiveRate.unitSelectPlaceholder",{defaultMessage:"Select scale..."}),options:He,onChange:i("unit"),singleSelection:{asPlainText:!0},selectedOptions:n})))),Object(p.jsx)(g.EuiSpacer,{size:"s"}),Object(p.jsx)(g.EuiText,{size:"xs",color:"subdued"},Object(p.jsx)("p",null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.positiveRate.helpText",defaultMessage:"This aggregation should only be applied to {link}, it is a shortcut for applying max, derivative and positive only to a field.",values:{link:Object(p.jsx)(g.EuiLink,{href:"https://en.wikipedia.org/wiki/Monotonic_function",target:"_BLANK"},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.positiveRate.helpTextLink",defaultMessage:"monotonically increasing numbers"}))}}))))}},We=e=>t=>Object(p.jsx)(F,{disableDelete:t.disableDelete,model:t.model,onAdd:t.onAdd,onDelete:t.onDelete,siblings:t.siblings,dragHandleProps:t.dragHandleProps},Object(p.jsx)(g.EuiTitle,{className:"tvbAggRow__unavailable",size:"xxxs","data-test-subj":"invalid_agg"},Object(p.jsx)("span",null,e))),Ue=()=>({id:f.a.v1(),type:U.METRIC_TYPES.COUNT}),qe=(e,t,s)=>{if((null==e?void 0:e.type)===I.i.TOP_HIT){var i;const a=null===(i=t[Object(se.c)(s)])||void 0===i?void 0:i.find((({name:t})=>t===(null==e?void 0:e.field)));return(null==a?void 0:a.type)===he.KBN_FIELD_TYPES.NUMBER}return!0};var $e=s(71);const Ke=e=>[I.b.NUMBER,I.b.BYTES,I.b.PERCENT,I.b.DEFAULT].includes(e)?e:e&&Object($e.e)(e)?I.b.DURATION:I.b.CUSTOM;function Ye(e){const{model:t,uiRestrictions:s,series:i,name:a,onModelChange:n,fields:r,siblings:o}=e;let d=Ve[t.type];d?A(t.type,s)||(d=We(Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.agg.aggIsUnsupportedForPanelConfigDescription",defaultMessage:"The {modelType} aggregation is not supported for existing panel configuration.",values:{modelType:Object(p.jsx)(g.EuiCode,null,e.model.type)}}))):d=We(Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.agg.aggIsNotSupportedDescription",defaultMessage:"The {modelType} aggregation is no longer supported.",values:{modelType:Object(p.jsx)(g.EuiCode,null,e.model.type)}}));const u={cursor:"default",...e.style},c=e.series.override_index_pattern?e.series.series_index_pattern:e.panel.index_pattern,b=e.panel.use_kibana_indexes||""===c,m=Object(l.useMemo)((()=>((e,t)=>s=>{1!==t.length||Object(N.f)(s)?re.call(null,e,s):de.call(null,e,(()=>{const e=Ue();return e.type=s.type,["calculation","series_agg"].includes(s.type)||(e.field=s.id),e}))})({name:a,model:i,onChange:n},o)),[a,n,o,i]);return Object(l.useEffect)((()=>{var e;if((null===(e=o[o.length-1])||void 0===e?void 0:e.id)===t.id){const e=Ke(i.formatter),s=qe(t,r,c);![I.b.DEFAULT,I.b.CUSTOM].includes(e)&&!s&&n({formatter:I.b.DEFAULT}),e!==I.b.DEFAULT||b||n({formatter:s?I.b.NUMBER:""})}}),[c,t,n,r,i.formatter,b,o]),Object(p.jsx)("div",{className:e.className,style:u},Object(p.jsx)(d,{fields:e.fields,disableDelete:e.disableDelete,model:e.model,onAdd:e.onAdd,onChange:m,onDelete:e.onDelete,panel:e.panel,series:e.series,siblings:e.siblings,indexPattern:c,uiRestrictions:e.uiRestrictions,dragHandleProps:e.dragHandleProps}))}class aggs_Aggs extends l.PureComponent{render(){const{panel:e,model:t,fields:s,name:i,uiRestrictions:a,onChange:l}=this.props,n=t.metrics;return Object(p.jsx)(g.EuiDroppable,{droppableId:`aggs_dnd:${t.id}`,type:"MICRO",spacing:"s"},n.map(((r,o)=>Object(p.jsx)(g.EuiDraggable,{spacing:"s",key:r.id,index:o,customDragHandle:!0,draggableId:`aggs_dnd:${t.id}:${r.id}`},(o=>Object(p.jsx)(Ye,{key:r.id,disableDelete:n.length<2,fields:s,name:i,model:r,onAdd:()=>de(this.props,Ue),onModelChange:l,onDelete:()=>oe(this.props,r),panel:e,series:t,siblings:n,uiRestrictions:a,dragHandleProps:o.dragHandleProps}))))))}}const Qe="2",Xe="0,0.[000]",Je=h.i18n.translate("visTypeTimeseries.dataFormatPicker.defaultLabel",{defaultMessage:"Default"}),Ze=Object(g.htmlIdGenerator)(),et=({formatterValue:e,changeModelFormatter:t,shouldIncludeDefaultOption:s,shouldIncludeNumberOptions:i})=>{const a=Object(l.useMemo)((()=>((e,t)=>{const s=[];return e&&s.push({value:I.b.DEFAULT,inputDisplay:Je,dropdownDisplay:Object(p.jsx)(n.a.Fragment,null,Object(p.jsx)("span",null,Je),Object(p.jsx)(g.EuiText,{size:"s",color:"subdued"},Object(p.jsx)("p",{className:"euiTextColor--subdued"},h.i18n.translate("visTypeTimeseries.dataFormatPicker.defaultLabelDescription",{defaultMessage:"Applies common formatting"})))),"data-test-subj":`tsvbDataFormatPicker-${I.b.DEFAULT}`}),t&&s.push({value:I.b.NUMBER,inputDisplay:h.i18n.translate("visTypeTimeseries.dataFormatPicker.numberLabel",{defaultMessage:"Number"}),"data-test-subj":`tsvbDataFormatPicker-${I.b.NUMBER}`},{value:I.b.BYTES,inputDisplay:h.i18n.translate("visTypeTimeseries.dataFormatPicker.bytesLabel",{defaultMessage:"Bytes"}),"data-test-subj":`tsvbDataFormatPicker-${I.b.BYTES}`},{value:I.b.PERCENT,inputDisplay:h.i18n.translate("visTypeTimeseries.dataFormatPicker.percentLabel",{defaultMessage:"Percent"}),"data-test-subj":`tsvbDataFormatPicker-${I.b.PERCENT}`},{value:I.b.DURATION,inputDisplay:h.i18n.translate("visTypeTimeseries.dataFormatPicker.durationLabel",{defaultMessage:"Duration"}),"data-test-subj":`tsvbDataFormatPicker-${I.b.DURATION}`}),[...s,{value:I.b.CUSTOM,inputDisplay:h.i18n.translate("visTypeTimeseries.dataFormatPicker.customLabel",{defaultMessage:"Custom"}),"data-test-subj":`tsvbDataFormatPicker-${I.b.CUSTOM}`}]})(s,i)),[s,i]),[r,o]=Object(l.useState)(Ke(e)),[d,u]=Object(l.useState)(r===I.b.CUSTOM?e:""),[c,b]=Object(l.useState)(Object($e.c)(r===I.b.DURATION?e:"ms,ms,"));Object(l.useEffect)((()=>{if(!a.find((({value:e})=>e===r))){const[{value:e}]=a;o(e),t(e)}}),[a,r,t]);const m=Object(l.useCallback)((e=>{if(o(e),e===I.b.DURATION){const{from:e,to:s,decimals:i}=c;t(`${e},${s},${i}`)}else e===I.b.CUSTOM?t(d):t(e)}),[t,d,c]),x=Object(l.useCallback)((e=>{const s=e.target.value;t(s),u(s)}),[t]),v=Object(l.useCallback)(((e,s)=>{const i={...c,[e]:s};b(i);const{from:a,to:l,decimals:n}=i;t(`${a},${l},${n}`)}),[t,c]),O=Object(l.useCallback)((e=>([{value:t}])=>v(e,t)),[v]),T=Object(l.useCallback)((e=>v("decimals",e.target.value)),[v]);let f,E;if(r===I.b.DURATION){const{from:e,to:t,decimals:s=Qe}=c,i=$e.a.find((({value:t})=>t===e)),a=$e.b.find((({value:e})=>e===t));f=Object(p.jsx)(n.a.Fragment,null,Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormRow,{id:Ze("from"),label:h.i18n.translate("visTypeTimeseries.dataFormatPicker.fromLabel",{defaultMessage:"From"})},Object(p.jsx)(g.EuiComboBox,{isClearable:!1,options:$e.a,selectedOptions:i?[i]:[],onChange:O("from"),singleSelection:{asPlainText:!0},"data-test-subj":"dataFormatPickerDurationFrom"}))),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormRow,{id:Ze("to"),label:h.i18n.translate("visTypeTimeseries.dataFormatPicker.toLabel",{defaultMessage:"To"})},Object(p.jsx)(g.EuiComboBox,{isClearable:!1,options:$e.b,selectedOptions:a?[a]:[],onChange:O("to"),singleSelection:{asPlainText:!0},"data-test-subj":"dataFormatPickerDurationTo"}))),"humanize"!==(null==a?void 0:a.value)&&Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormRow,{id:Ze("decimal"),label:h.i18n.translate("visTypeTimeseries.dataFormatPicker.decimalPlacesLabel",{defaultMessage:"Decimal places"})},Object(p.jsx)(g.EuiFieldText,{defaultValue:s,placeholder:Qe,onChange:T,"data-test-subj":"dataFormatPickerDurationDecimal"}))))}return r===I.b.CUSTOM&&i&&(E=Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormRow,{label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.dataFormatPicker.formatPatternLabel",defaultMessage:"Numeral.js format pattern (Default: {defaultPattern})",values:{defaultPattern:Object(p.jsx)(g.EuiCode,null,Xe)}}),helpText:Object(p.jsx)("span",null,Object(p.jsx)(g.EuiLink,{target:"_blank",href:"http://numeraljs.com/#format"},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.dataFormatPicker.formatPatternHelpText",defaultMessage:"Documentation"})))},Object(p.jsx)(g.EuiFieldText,{placeholder:Xe,value:d,onChange:x})))),Object(p.jsx)(n.a.Fragment,null,Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{label:h.i18n.translate("visTypeTimeseries.defaultDataFormatterLabel",{defaultMessage:"Data formatter"}),fullWidth:!0},Object(p.jsx)(g.EuiSuperSelect,{options:a,valueOfSelected:r,onChange:m,"data-test-subj":"tsvbDataFormatPicker",fullWidth:!0,hasDividers:!0}))),r===I.b.DURATION&&f,r===I.b.CUSTOM&&E)};function tt({name:e,value:t,disabled:s,"data-test-subj":i,onChange:a}){const n=Object(l.useCallback)((t=>()=>a({[e]:t})),[a,e]),r=Object(g.htmlIdGenerator)(),o=r(e);return Object(p.jsx)("div",null,Object(p.jsx)(g.EuiRadio,{id:r("yes"),"data-test-subj":`${i}-yes`,label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.yesButtonLabel",defaultMessage:"Yes",description:"The 'yes' in a yes/no answer choice."}),className:"eui-displayInlineBlock",name:o,checked:Boolean(t),value:"yes",onChange:n(1),disabled:s})," ",Object(p.jsx)(g.EuiRadio,{id:r("no"),"data-test-subj":`${i}-no`,label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.noButtonLabel",defaultMessage:"No",description:"The 'no' in a yes/no answer choice."}),className:"eui-displayInlineBlock",name:o,checked:!Boolean(t),value:"no",onChange:n(0),disabled:s}))}var st=s(98),it=s.n(st);const at=h.i18n.translate("visTypeTimeseries.indexPatternSelect.switchModePopover.allowStringIndices",{defaultMessage:"Allow string indices in TSVB"}),lt=({onModeChange:e,useKibanaIndices:t})=>{const[s,i]=Object(l.useState)(!1),a=Object(l.useCallback)((()=>i(!1)),[]),n=Object(l.useCallback)((()=>i((e=>!e))),[]),r=Object(l.useCallback)((()=>{e(!t)}),[e,t]),{application:o}=Object(we.b)(),d=o.capabilities.advancedSettings.save,u=Object(l.useCallback)((()=>o.navigateToApp("management",{path:`/kibana/settings?query=${Ee.e.ALLOW_STRING_INDICES}`})),[o]),c=Object(we.g)().get(Ee.e.ALLOW_STRING_INDICES),b=t&&!c;let m;return c||(m=Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.indexPatternSelect.switchModePopover.enableAllowStringIndices",defaultMessage:"To query Elasticsearch indices, you must enable the {allowStringIndices} setting.",values:{allowStringIndices:d?Object(p.jsx)(g.EuiLink,{color:"accent",onClick:u},at):Object(p.jsx)("strong",null,at)}})),Object(p.jsx)(g.EuiPopover,{button:Object(p.jsx)(g.EuiButtonIcon,{iconType:"gear","aria-label":h.i18n.translate("visTypeTimeseries.indexPatternSelect.switchModePopover.areaLabel",{defaultMessage:"Configure data view selection mode"}),onClick:n,"data-test-subj":"switchIndexPatternSelectionModePopoverButton"}),isOpen:s,closePopover:a,style:{height:"auto"},initialFocus:!1},Object(p.jsx)("div",{style:{width:"360px"},"data-test-subj":"switchIndexPatternSelectionModePopoverContent"},Object(p.jsx)(g.EuiPopoverTitle,null,h.i18n.translate("visTypeTimeseries.indexPatternSelect.switchModePopover.title",{defaultMessage:"Data view mode"})),Object(p.jsx)(g.EuiText,null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.indexPatternSelect.switchModePopover.text",defaultMessage:"A data view groups and retrieves data from Elasticsearch. Disable this mode to directly query Elasticsearch indices instead. {allowStringIndicesLabel}",values:{allowStringIndicesLabel:m}})),Object(p.jsx)(g.EuiSpacer,null),Object(p.jsx)(g.EuiSwitch,{checked:t,label:h.i18n.translate("visTypeTimeseries.indexPatternSelect.switchModePopover.useKibanaIndices",{defaultMessage:"Use Kibana data views"}),onChange:r,disabled:b,"data-test-subj":"switchIndexPatternSelectionMode"})))},nt=({fetchedIndex:e,onIndexChange:t,disabled:s,placeholder:i,onModeChange:a,allowSwitchMode:n,"data-test-subj":r})=>{const[o,d]=Object(l.useState)(),{indexPatternString:u}=e,c=Object(l.useCallback)((e=>{d(e.target.value)}),[]);return Object(l.useEffect)((()=>{void 0===o&&d(null!=u?u:"")}),[u,o]),it()((()=>{(null!=o?o:"")!==(null!=u?u:"")&&t(o)}),150,[o,t]),Object(p.jsx)(g.EuiFieldText,_()({disabled:s,onChange:c,value:null!=o?o:"",placeholder:i,"data-test-subj":r},n&&{append:Object(p.jsx)(lt,{onModeChange:a,fetchedIndex:e,useKibanaIndices:!1})}))},rt=({fetchedIndex:e,onIndexChange:t,onModeChange:s,disabled:i,placeholder:a,allowSwitchMode:n,"data-test-subj":r})=>{const[o,d]=Object(l.useState)([]),[u,c]=Object(l.useState)([]),b=Object(l.useCallback)((([e])=>{t(e?{id:e.id}:"")}),[t]);return Object(l.useEffect)((()=>{let t=[];const{indexPattern:s,indexPatternString:i}=e;(s||i)&&(t=s?[{id:s.id,label:s.title}]:[{label:null!=i?i:""}]),c(t)}),[e]),Object(l.useEffect)((()=>{!async function(){d(await Object(we.d)().getIdsWithTitle())}()}),[]),Object(p.jsx)(g.EuiComboBox,_()({singleSelection:{asPlainText:!0},onChange:b,options:(j=o,j.map((({title:e,id:t})=>({label:e,id:t})))),selectedOptions:u,isDisabled:i,placeholder:a,"data-test-subj":r},n&&{append:Object(p.jsx)(lt,{onModeChange:s,fetchedIndex:e,useKibanaIndices:!0})}));var j},ot=Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.indexPatternSelect.queryAllIndicesText",defaultMessage:"To query all indices, use {asterisk}.",values:{asterisk:Object(p.jsx)("strong",null,"*")}}),dt=e=>Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.indexPatternSelect.defaultDataViewText",defaultMessage:"Using the default data view. {queryAllIndicesHelpText}",values:{queryAllIndicesHelpText:e?"":ot}}),ut=h.i18n.translate("visTypeTimeseries.indexPatternSelect.label",{defaultMessage:"Data view"}),ct=({indexPatternName:e,onChange:t,disabled:s,fetchedIndex:i,allowIndexSwitchingMode:a})=>{var n,r;const o=Object(g.htmlIdGenerator)(),d=Object(l.useContext)(O),u=Boolean(null==d?void 0:d[Ee.f]),c=u?rt:nt,b=Object(l.useCallback)((s=>{t({[e]:s})}),[e,t]),m=Object(l.useCallback)(((s,i)=>{var a;t({[Ee.f]:s,[e]:null!=i&&null!==(a=i.indexPattern)&&void 0!==a&&a.id?{id:i.indexPattern.id}:""})}),[t,e]),x=Object(l.useCallback)((()=>{var e;Object(we.b)().application.navigateToApp("management",{path:`/kibana/indexPatterns/create?name=${null!==(e=i.indexPatternString)&&void 0!==e?e:""}`})}),[i]);return i?Object(p.jsx)(g.EuiFormRow,{id:o("indexPattern"),label:ut,helpText:i.defaultIndex&&dt(u),labelAppend:u||!i.indexPatternString||i.indexPattern?null:Object(p.jsx)(g.EuiLink,{onClick:x},Object(p.jsx)(g.EuiText,{size:"xs"},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.indexPatternSelect.createDataViewText",defaultMessage:"Create data view"})))},Object(p.jsx)(c,{fetchedIndex:i,disabled:s,allowSwitchMode:a,onIndexChange:b,onModeChange:m,placeholder:null!==(n=null===(r=i.defaultIndex)||void 0===r?void 0:r.title)&&void 0!==n?n:"","data-test-subj":"metricsIndexPatternInput"})):null};s(100);const bt=({isIndicatorDisplayed:e,toggleIndicatorDisplay:t})=>{const[s,i]=Object(l.useState)(!1),a=Object(l.useCallback)((()=>i((e=>!e))),[]),n=Object(l.useCallback)((()=>i(!1)),[]);return Object(p.jsx)(g.EuiPopover,{className:"tvbLastValueModePopover",button:Object(p.jsx)(g.EuiButtonIcon,{iconType:"gear",onClick:a,"aria-label":h.i18n.translate("visTypeTimeseries.lastValueModePopover.gearButton",{defaultMessage:"Change last value indicator display option"})}),isOpen:s,closePopover:n},Object(p.jsx)("div",{className:"tvbLastValueModePopoverBody"},Object(p.jsx)(g.EuiPopoverTitle,null,h.i18n.translate("visTypeTimeseries.lastValueModePopover.title",{defaultMessage:"Last value options"})),Object(p.jsx)(g.EuiSwitch,{checked:e,label:h.i18n.translate("visTypeTimeseries.lastValueModePopover.switch",{defaultMessage:"Show label when using Last value mode"}),onChange:t})))};var gt=s(62);const jt=[he.KBN_FIELD_TYPES.DATE],pt=Object(g.htmlIdGenerator)(),mt=(e,t)=>!t&&e[I.g]===I.f.ENTIRE_TIME_RANGE,xt=({fields:e,prefix:t,onChange:s,disabled:i,model:a,allowLevelOfDetail:r,allowIndexSwitchingMode:o,baseIndexPattern:u})=>{var c,b,m;const T=Object(we.g)(),f=`${t}time_field`,E=`${t}index_pattern`,y=`${t}interval`,M=`${t}max_bars`,F=`${t}drop_last_bucket`,C=Object(l.useContext)(x),S=Object(l.useContext)(O),w=Object(d.get)(Object(l.useContext)(v),"uiRestrictions"),L=T.get(U.UI_SETTINGS.HISTOGRAM_MAX_BARS),[P,A]=Object(l.useState)(null),D=S.type===I.e.TIMESERIES,N=Object(l.useCallback)((({target:e})=>{s({[M]:Math.max(1,e.value)})}),[s,M]),k=ee(s),B=le(s),G=[{label:h.i18n.translate("visTypeTimeseries.indexPattern.timeRange.entireTimeRange",{defaultMessage:"Entire time range"}),value:I.f.ENTIRE_TIME_RANGE,disabled:!R(I.f.ENTIRE_TIME_RANGE,w)},{label:h.i18n.translate("visTypeTimeseries.indexPattern.timeRange.lastValue",{defaultMessage:"Last value"}),value:I.f.LAST_VALUE,disabled:!R(I.f.LAST_VALUE,w)}],z={[E]:"",[y]:Ee.a,[F]:0,[M]:T.get(U.UI_SETTINGS.HISTOGRAM_BAR_TARGET),[I.g]:G[0].value,...a},H=z[E],V=(W=z[y],Object(gt.d)(W)||Object(gt.c)(W)?{isValid:!0}:Object(gt.e)(W));var W;const q=G.find((({value:e})=>z[I.g]===e)),$=!i&&q&&!R(q.value,w);Object(l.useEffect)((()=>{C(y,V.isValid)}),[y,V.isValid,C]),Object(l.useEffect)((()=>{!async function(){const e=Object(we.d)();let t={indexPattern:void 0,indexPatternString:void 0};const s=H||u;try{t=s?await Object(se.b)(s,e,{fetchKibanaIndexForStringIndexes:!0}):{...t,defaultIndex:await e.getDefault()}}catch{}A(t)}()}),[H,u]);const K=Object(l.useCallback)((()=>s({hide_last_value_indicator:!z.hide_last_value_indicator})),[z.hide_last_value_indicator,s]);return Object(p.jsx)("div",{className:"index-pattern"},!D&&Object(p.jsx)(g.EuiFlexGroup,null,Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:pt("timeRange"),label:Object(p.jsx)(n.a.Fragment,null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.indexPattern.timeRange.label",defaultMessage:"Data timerange mode"})," ",Object(p.jsx)(g.EuiIconTip,{position:"right",content:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.indexPattern.timeRange.hint",defaultMessage:'This setting controls the timespan used for matching documents. "Entire timerange" will match all the documents selected in the timepicker. "Last value" will match only the documents for the specified interval from the end of the timerange.'}),type:"questionInCircle"})),isInvalid:$,error:h.i18n.translate("visTypeTimeseries.indexPattern.timeRange.error",{defaultMessage:'You cannot use "{mode}" with the current index type.',values:{mode:null==q?void 0:q.label}})},Object(p.jsx)(g.EuiComboBox,_()({"data-test-subj":"dataTimeRangeMode",isClearable:!1,isInvalid:$,placeholder:h.i18n.translate("visTypeTimeseries.indexPattern.timeRange.selectTimeRange",{defaultMessage:"Select"}),options:G,error:h.i18n.translate("visTypeTimeseries.indexPattern.timeRange.entireTimeRange",{defaultMessage:"Entire time range"}),selectedOptions:q?[q]:[],onChange:k(I.g),singleSelection:{asPlainText:!0},isDisabled:i},!mt(z,D)&&{append:Object(p.jsx)(bt,{isIndicatorDisplayed:!z.hide_last_value_indicator,toggleIndicatorDisplay:K})}))))),Object(p.jsx)(g.EuiFlexGroup,null,Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(ct,{fetchedIndex:P,indexPatternName:E,onChange:s,disabled:i,allowIndexSwitchingMode:o})),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(Oe,{label:h.i18n.translate("visTypeTimeseries.indexPattern.timeFieldLabel",{defaultMessage:"Time field"}),restrict:jt,value:z[f],disabled:i,onChange:e=>s({[f]:null==e?void 0:e[0]}),indexPattern:z[E],fields:e,placeholder:null!==(c=null==P||null===(b=P.indexPattern)||void 0===b?void 0:b.timeFieldName)&&void 0!==c?c:null==P||null===(m=P.defaultIndex)||void 0===m?void 0:m.timeFieldName})),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormRow,{isInvalid:!V.isValid,error:V.errorMessage,id:pt("interval"),label:h.i18n.translate("visTypeTimeseries.indexPattern.intervalLabel",{defaultMessage:"Interval"}),helpText:h.i18n.translate("visTypeTimeseries.indexPattern.intervalHelpText",{defaultMessage:"Examples: auto, 1m, 1d, 7d, 1y, >=1m",description:"auto, 1m, 1d, 7d, 1y, >=1m are required values and must not be translated."})},Object(p.jsx)(g.EuiFieldText,{"data-test-subj":"metricsIndexPatternInterval",isInvalid:!V.isValid,disabled:i||mt(z,D),onChange:B(y,Ee.a),value:z[y],placeholder:Ee.a}))),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormRow,{id:pt("dropLastBucket"),label:h.i18n.translate("visTypeTimeseries.indexPattern.dropLastBucketLabel",{defaultMessage:"Drop last bucket?"})},Object(p.jsx)(tt,{"data-test-subj":"metricsDropLastBucket",value:z[F],name:F,onChange:s,disabled:i||mt(z,D)})))),r&&Object(p.jsx)(g.EuiFlexGroup,null,Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:pt("detailLevel"),label:Object(p.jsx)(n.a.Fragment,null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.indexPattern.detailLevel",defaultMessage:"Level of detail"})," ",Object(p.jsx)(g.EuiIconTip,{position:"right",content:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.indexPattern.detailLevelHelpText",defaultMessage:"Controls the auto and gte intervals based on the time range. The default interval is affected by the advanced settings {histogramTargetBars} and {histogramMaxBars}.",values:{histogramTargetBars:U.UI_SETTINGS.HISTOGRAM_MAX_BARS,histogramMaxBars:U.UI_SETTINGS.HISTOGRAM_BAR_TARGET}}),type:"questionInCircle"}))},Object(p.jsx)(g.EuiFlexGroup,{responsive:!1,alignItems:"center"},Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormLabel,null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.indexPattern.сoarse",defaultMessage:"Coarse"}))),Object(p.jsx)(g.EuiFlexItem,{grow:!0},Object(p.jsx)(g.EuiRange,{id:Object(g.htmlIdGenerator)()(),value:z[M],onChange:N,disabled:i||mt(z,D)||!(Object(gt.c)(z[y])||Object(gt.d)(z[y])),min:0,max:L,step:L/10,"aria-label":h.i18n.translate("visTypeTimeseries.indexPattern.detailLevelAriaLabel",{defaultMessage:"Level of detail"})})),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormLabel,null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.indexPattern.finest",defaultMessage:"Finest"}))))))))};function vt(){return Object(we.g)().get(he.UI_SETTINGS.SEARCH_QUERY_LANGUAGE)}function Ot({panel:e,model:t,onChange:s,indexPatternForQuery:i}){const a=Object(g.htmlIdGenerator)(),l=Object(p.jsx)(tt,{disabled:e.ignore_global_filter,value:t.ignore_global_filter,name:"ignore_global_filter",onChange:s});return Object(p.jsx)(g.EuiFlexGroup,{margin:"s"},Object(p.jsx)(g.EuiFlexItem,{grow:!0},Object(p.jsx)(g.EuiFormRow,{id:a("filterInput"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.seriesConfig.filterLabel",defaultMessage:"Filter"}),fullWidth:!0},Object(p.jsx)(Ae,{query:{language:t.filter&&t.filter.language?t.filter.language:vt(),query:t.filter&&t.filter.query?t.filter.query:""},onChange:e=>s({filter:e}),indexPatterns:[i],"data-test-subj":"seriesConfigQueryBar"}))),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormRow,{id:a("seriesIgnoreGlobalFilter"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.seriesConfig.ignoreGlobalFilterLabel",defaultMessage:"Ignore global filter?"}),fullWidth:!0},e.ignore_global_filter?Object(p.jsx)(g.EuiToolTip,{content:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.seriesConfig.ignoreGlobalFilterDisabledTooltip",defaultMessage:"This is disabled because the global filters are being ignored in the panel options."})},l):l)))}xt.defaultProps={prefix:"",disabled:!1};var ht=s(54),Tt=s(55);function ft({activePalette:e,palettes:t,setPalette:s,color:i}){const a=Object(Tt.a)(i);return Object(p.jsx)(g.EuiColorPalettePicker,{fullWidth:!0,"data-test-subj":"visEditorPalettePicker",compressed:!0,palettes:[...t.getAll().filter((({internal:e})=>!e)).map((({id:e,title:t,getCategoricalColors:s})=>({value:e,title:t,type:"fixed",palette:s(10)}))),{value:I.d.GRADIENT,title:h.i18n.translate("visTypeTimeseries.timeSeries.gradientLabel",{defaultMessage:"Gradient"}),type:"fixed",palette:t.get("custom").getCategoricalColors(10,{colors:[i,a],gradient:!0})},{value:I.d.RAINBOW,title:h.i18n.translate("visTypeTimeseries.timeSeries.rainbowLabel",{defaultMessage:"Rainbow"}),type:"fixed",palette:t.get("custom").getCategoricalColors(10,{colors:ht.a.slice(0,10),gradient:!1})}],onChange:e=>{e===I.d.RAINBOW?s({type:"palette",name:I.d.RAINBOW,params:{colors:ht.a,gradient:!1}}):e===I.d.GRADIENT?s({type:"palette",name:I.d.GRADIENT,params:{colors:[i,a],gradient:!0}}):s({type:"palette",name:e})},valueOfSelected:(null==e?void 0:e.name)||"default",selectionDisplay:"palette"})}const Et=e=>e<2;var yt=s(57);const Mt=Object(j.injectI18n)((function(e){var t;const s=ee(e.onChange),i=le(e.onChange),a={value_template:"{{value}}",offset_time:"",axis_min:"",axis_max:"",stacked:yt.c.NONE,steps:0,...e.model},n=Object(g.htmlIdGenerator)(),{intl:r}=e,o=[{label:r.formatMessage({id:"visTypeTimeseries.timeSeries.noneLabel",defaultMessage:"None"}),value:yt.c.NONE},{label:r.formatMessage({id:"visTypeTimeseries.timeSeries.stackedLabel",defaultMessage:"Stacked"}),value:yt.c.STACKED},{label:r.formatMessage({id:"visTypeTimeseries.timeSeries.stackedWithinSeriesLabel",defaultMessage:"Stacked within series"}),value:yt.c.STACKED_WITHIN_SERIES},{label:r.formatMessage({id:"visTypeTimeseries.timeSeries.percentLabel",defaultMessage:"Percent"}),value:yt.c.PERCENT,disabled:Et(e.seriesQuantity[a.id])}],u=o.find((e=>a.stacked===e.value)),c=[{label:r.formatMessage({id:"visTypeTimeseries.timeSeries.rightLabel",defaultMessage:"Right"}),value:"right"},{label:r.formatMessage({id:"visTypeTimeseries.timeSeries.leftLabel",defaultMessage:"Left"}),value:"left"}],b=c.find((e=>a.axis_position===e.value)),m=[{label:r.formatMessage({id:"visTypeTimeseries.timeSeries.barLabel",defaultMessage:"Bar"}),value:"bar"},{label:r.formatMessage({id:"visTypeTimeseries.timeSeries.lineLabel",defaultMessage:"Line"}),value:"line"}],x=m.find((e=>a.chart_type===e.value)),{palettes:v}=Object(we.a)(),[O,T]=Object(l.useState)(null);let f;Object(l.useEffect)((()=>{(async()=>{const e=await v.getPalettes();T(e)})()}),[v]),"line"===a.chart_type&&(f=Object(p.jsx)(g.EuiFlexGroup,{gutterSize:"s",responsive:!1,wrap:!0},Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormRow,{id:n("chartType"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.timeSeries.chartLine.chartTypeLabel",defaultMessage:"Chart type"})},Object(p.jsx)(g.EuiComboBox,{isClearable:!1,options:m,selectedOptions:x?[x]:[],onChange:s("chart_type"),singleSelection:{asPlainText:!0},"data-test-subj":"seriesChartTypeComboBox"}))),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormRow,{id:n("stacked"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.timeSeries.chartLine.stackedLabel",defaultMessage:"Stacked"})},Object(p.jsx)(g.EuiComboBox,{isClearable:!1,options:o,selectedOptions:u?[u]:[],onChange:s("stacked"),singleSelection:{asPlainText:!0},"data-test-subj":"seriesStackedComboBox"}))),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormRow,{id:n("fill"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.timeSeries.chartLine.fillLabel",defaultMessage:"Fill (0 to 1)"})},Object(p.jsx)(g.EuiFieldNumber,{step:.1,onChange:i("fill"),value:Number(a.fill)}))),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormRow,{id:n("lineWidth"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.timeSeries.chartLine.lineWidthLabel",defaultMessage:"Line width"})},Object(p.jsx)(g.EuiFieldNumber,{onChange:i("line_width"),value:Number(a.line_width)}))),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormRow,{id:n("pointSize"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.timeSeries.chartLine.pointSizeLabel",defaultMessage:"Point size"})},Object(p.jsx)(g.EuiFieldNumber,{onChange:i("point_size"),value:Number(a.point_size)}))),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormRow,{label:h.i18n.translate("visTypeTimeseries.timeSeries.chartLine.stepsLabel",{defaultMessage:"Steps"})},Object(p.jsx)(tt,{value:a.steps,name:"steps",onChange:e.onChange}))))),"bar"===a.chart_type&&(f=Object(p.jsx)(g.EuiFlexGroup,{gutterSize:"s",responsive:!1,wrap:!0},Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormRow,{id:n("chartType"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.timeSeries.chartBar.chartTypeLabel",defaultMessage:"Chart type"})},Object(p.jsx)(g.EuiComboBox,{isClearable:!1,options:m,selectedOptions:x?[x]:[],onChange:s("chart_type"),singleSelection:{asPlainText:!0},"data-test-subj":"seriesChartTypeComboBox"}))),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormRow,{id:n("stacked"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.timeSeries.chartBar.stackedLabel",defaultMessage:"Stacked"})},Object(p.jsx)(g.EuiComboBox,{isClearable:!1,options:o,selectedOptions:u?[u]:[],onChange:s("stacked"),singleSelection:{asPlainText:!0},"data-test-subj":"seriesStackedComboBox"}))),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormRow,{id:n("fill"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.timeSeries.chartBar.fillLabel",defaultMessage:"Fill (0 to 1)"})},Object(p.jsx)(g.EuiFieldNumber,{step:.1,onChange:i("fill"),value:Number(a.fill)}))),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormRow,{id:n("lineWidth"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.timeSeries.chartBar.lineWidthLabel",defaultMessage:"Line width"})},Object(p.jsx)(g.EuiFieldNumber,{onChange:i("line_width"),value:Number(a.line_width)})))));const E=!a.separate_axis,y=e.model.override_index_pattern?e.model.series_index_pattern:e.indexPatternForQuery,M=Object(l.useCallback)((t=>e.onChange({formatter:t})),[e]),F=Object(l.useMemo)((()=>qe(Object(d.last)(a.metrics),e.fields,y)),[a.metrics,e.fields,y]),C=e.panel.use_kibana_indexes||""===y,{indexPatternForQuery:S,onChange:w}=e,L=Object(l.useCallback)((e=>{const t={...e};e.override_index_pattern&&!a.series_index_pattern&&(t.series_index_pattern=S),w(t)}),[a.series_index_pattern,S,w]),P=null!==(t=a.palette)&&void 0!==t?t:{type:"palette",name:"default"},A={...P,name:"kibana"===a.split_color_mode?"kibana_palette":a.split_color_mode||P.name};return Object(p.jsx)("div",{className:"tvbAggRow"},Object(p.jsx)(g.EuiFlexGroup,{gutterSize:"s"},Object(p.jsx)(et,{formatterValue:a.formatter,changeModelFormatter:M,shouldIncludeDefaultOption:C,shouldIncludeNumberOptions:F}),Object(p.jsx)(g.EuiFlexItem,{grow:3},Object(p.jsx)(g.EuiFormRow,{id:n("template"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.timeSeries.templateLabel",defaultMessage:"Template"}),helpText:Object(p.jsx)("span",null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.timeSeries.templateHelpText",defaultMessage:"eg.{templateExample}",values:{templateExample:Object(p.jsx)(g.EuiCode,null,"{{value}}/s")}})),fullWidth:!0},Object(p.jsx)(g.EuiFieldText,{onChange:i("value_template"),value:a.value_template,disabled:a.formatter===I.b.DEFAULT,fullWidth:!0,"data-test-subj":"tsvb_series_value"})))),Object(p.jsx)(g.EuiHorizontalRule,{margin:"s"}),Object(p.jsx)(Ot,{model:a,onChange:e.onChange,panel:e.panel,indexPatternForQuery:y}),Object(p.jsx)(g.EuiHorizontalRule,{margin:"s"}),f,Object(p.jsx)(g.EuiHorizontalRule,{margin:"s"}),Object(p.jsx)(g.EuiFlexGroup,{responsive:!1,wrap:!0},Object(p.jsx)(g.EuiFlexItem,{grow:!0},Object(p.jsx)(g.EuiFormRow,{id:n("offset"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.timeSeries.offsetSeriesTimeLabel",defaultMessage:"Offset series time by (1m, 1h, 1w, 1d)",description:"1m, 1h, 1w, 1d are required values and must not be translated."})},Object(p.jsx)(g.EuiFieldText,{"data-test-subj":"offsetTimeSeries",onChange:i("offset_time"),value:a.offset_time}))),Object(p.jsx)(g.EuiFlexItem,{grow:!0},Object(p.jsx)(g.EuiFormRow,{label:h.i18n.translate("visTypeTimeseries.timeSeries.hideInLegendLabel",{defaultMessage:"Hide in legend"})},Object(p.jsx)(tt,{value:a.hide_in_legend,name:"hide_in_legend",onChange:e.onChange}))),O&&Object(p.jsx)(g.EuiFlexItem,{grow:!0},Object(p.jsx)(g.EuiFormRow,{id:n("splitColor"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.timeSeries.splitColorThemeLabel",defaultMessage:"Split color theme"})},Object(p.jsx)(ft,{palettes:O,activePalette:A,setPalette:t=>{e.onChange({split_color_mode:null,palette:t})},color:a.color})))),Object(p.jsx)(g.EuiHorizontalRule,{margin:"s"}),Object(p.jsx)(g.EuiFlexGroup,{responsive:!1,wrap:!0},Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormRow,{label:h.i18n.translate("visTypeTimeseries.timeSeries.separateAxisLabel",{defaultMessage:"Separate axis?"})},Object(p.jsx)(tt,{value:a.separate_axis,name:"separate_axis",onChange:e.onChange}))),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormRow,{id:n("axisMin"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.timeSeries.axisMinLabel",defaultMessage:"Axis min"})},Object(p.jsx)("input",{className:"tvbAgg__input",type:"number",disabled:E,onChange:i("axis_min"),value:a.axis_min}))),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormRow,{id:n("axisMax"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.timeSeries.axisMaxLabel",defaultMessage:"Axis max"})},Object(p.jsx)("input",{className:"tvbAgg__input",disabled:E,onChange:i("axis_max"),value:a.axis_max}))),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormRow,{id:n("axisPos"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.timeSeries.axisPositionLabel",defaultMessage:"Axis position"})},Object(p.jsx)(g.EuiComboBox,{isClearable:!1,isDisabled:E,options:c,selectedOptions:b?[b]:[],onChange:s("axis_position"),singleSelection:{asPlainText:!0}})))),Object(p.jsx)(g.EuiHorizontalRule,{margin:"s"}),Object(p.jsx)(g.EuiFlexGroup,{gutterSize:"s",responsive:!1,wrap:!0},Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormRow,{label:h.i18n.translate("visTypeTimeseries.timeSeries.overrideDataViewLabel",{defaultMessage:"Override data view?"})},Object(p.jsx)(tt,{value:a.override_index_pattern,name:"override_index_pattern",onChange:L,"data-test-subj":"seriesOverrideIndexPattern"}))),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(xt,_()({},e,{prefix:"series_",disabled:!a.override_index_pattern,allowLevelOfDetail:!0,baseIndexPattern:S})))))})),Ft=({id:e,onChange:t,value:s="everything",uiRestrictions:i})=>{const a=[{label:h.i18n.translate("visTypeTimeseries.splits.groupBySelect.modeOptions.everythingLabel",{defaultMessage:"Everything"}),value:"everything"},{label:h.i18n.translate("visTypeTimeseries.splits.groupBySelect.modeOptions.filterLabel",{defaultMessage:"Filter"}),value:"filter"},{label:h.i18n.translate("visTypeTimeseries.splits.groupBySelect.modeOptions.filtersLabel",{defaultMessage:"Filters"}),value:"filters"},{label:h.i18n.translate("visTypeTimeseries.splits.groupBySelect.modeOptions.termsLabel",{defaultMessage:"Terms"}),value:"terms"}].map((e=>({...e,disabled:!D(e.value,i)}))),l=a.find((e=>s===e.value));return Object(p.jsx)(g.EuiComboBox,{id:e,isClearable:!1,options:a,selectedOptions:l?[l]:void 0,onChange:t,singleSelection:{asPlainText:!0},"data-test-subj":"groupBySelect"})};var Ct=s(47);const _t={terms_direction:"desc",terms_size:10,terms_order_by:"_count"},It={terms_field:void 0,terms_include:void 0,terms_exclude:void 0,terms_direction:void 0,terms_size:void 0,terms_order_by:void 0},St=Object(j.injectI18n)((({onChange:e,indexPattern:t,intl:s,model:i,fields:a,uiRestrictions:n,seriesQuantity:r})=>{var o,u;const c=Object(g.htmlIdGenerator)(),b=le(e),m=ee(e),x={..._t,...i},{metrics:v}=x,O={value:"_count",label:s.formatMessage({id:"visTypeTimeseries.splits.terms.defaultCountLabel",defaultMessage:"Doc Count (default)"})},h={value:"_key",label:s.formatMessage({id:"visTypeTimeseries.splits.terms.termsLabel",defaultMessage:"Terms"})},T=[{value:"desc",label:s.formatMessage({id:"visTypeTimeseries.splits.terms.dirOptions.descendingLabel",defaultMessage:"Descending"})},{value:"asc",label:s.formatMessage({id:"visTypeTimeseries.splits.terms.dirOptions.ascendingLabel",defaultMessage:"Ascending"})}],f=Object(se.c)(t),E=T.find((e=>x.terms_direction===e.value)),y=Object(d.find)(a[f],(({name:e})=>e===x.terms_field)),M=Object(d.get)(y,"type"),F=Object(l.useCallback)((t=>{e({terms_field:1===t.length?t[0]:t,terms_include:void 0,terms_exclude:void 0})}),[e]);return r&&x.stacked===Ct.c.PERCENT&&Et(r[x.id])&&e({stacked:Ct.c.NONE}),Object(p.jsx)("div",null,Object(p.jsx)(g.EuiFlexGroup,null,Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:c("group"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.splits.terms.groupByLabel",defaultMessage:"Group by"})},Object(p.jsx)(Ft,{value:x.split_mode,onChange:([{value:t=null}])=>{e({split_mode:t,...It})},uiRestrictions:n}))),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(Oe,{label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.splits.terms.byLabel",defaultMessage:"By",description:"This labels a field selector allowing the user to chose 'by' which field to group."}),restrict:[he.KBN_FIELD_TYPES.NUMBER,he.KBN_FIELD_TYPES.BOOLEAN,he.KBN_FIELD_TYPES.DATE,he.KBN_FIELD_TYPES.IP,he.KBN_FIELD_TYPES.STRING],"data-test-subj":"groupByField",indexPattern:t,onChange:F,value:x.terms_field,fields:a,uiRestrictions:n,type:"terms",allowMultiSelect:!0}))),M===he.KBN_FIELD_TYPES.STRING&&Object(p.jsx)(g.EuiFlexGroup,null,Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:c("include"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.splits.terms.includeLabel",defaultMessage:"Include"})},Object(p.jsx)(g.EuiFieldText,{value:null!==(o=x.terms_include)&&void 0!==o?o:"",onChange:b("terms_include"),"data-test-subj":"groupByInclude"}))),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:c("exclude"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.splits.terms.excludeLabel",defaultMessage:"Exclude"})},Object(p.jsx)(g.EuiFieldText,{value:null!==(u=x.terms_exclude)&&void 0!==u?u:"",onChange:b("terms_exclude"),"data-test-subj":"groupByExclude"})))),Object(p.jsx)(g.EuiFlexGroup,null,Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:c("top"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.splits.terms.topLabel",defaultMessage:"Top"})},Object(p.jsx)(g.EuiFieldNumber,{placeholder:s.formatMessage({id:"visTypeTimeseries.splits.terms.sizePlaceholder",defaultMessage:"Size"}),value:Number(x.terms_size),onChange:b("terms_size")}))),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:c("order"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.splits.terms.orderByLabel",defaultMessage:"Order by"})},Object(p.jsx)(J,{metrics:v,clearable:!1,additionalOptions:[O,h],fields:a[f],onChange:m("terms_order_by"),restrict:"basic",value:x.terms_order_by}))),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:c("direction"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.splits.terms.directionLabel",defaultMessage:"Direction"})},Object(p.jsx)(g.EuiComboBox,{isClearable:!1,options:T,selectedOptions:E?[E]:[],onChange:m("terms_direction"),singleSelection:{asPlainText:!0}})))))})),wt={filter:void 0},Lt=e=>{const{onChange:t,uiRestrictions:s,indexPattern:i}=e,a={filter:{language:vt(),query:""},...e.model},l=Object(g.htmlIdGenerator)();return Object(p.jsx)(g.EuiFlexGroup,{alignItems:"center"},Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:l("group"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.splits.filter.groupByLabel",defaultMessage:"Group by"})},Object(p.jsx)(Ft,{value:a.split_mode,onChange:([{value:e=null}])=>{t({split_mode:e,...wt})},uiRestrictions:s}))),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:l("query"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.splits.filter.queryStringLabel",defaultMessage:"Query string"})},Object(p.jsx)(Ae,{query:{language:a.filter.language||vt(),query:a.filter.query||""},onChange:e=>t({filter:e}),indexPatterns:[i]}))))};class filter_items_FilterItemsUi extends l.Component{constructor(e){super(e),a()(this,"handleQueryChange",((e,t)=>{const s={filter:t};ue.handleChange(this.props,u.a.assign({},e,s))})),this.renderRow=this.renderRow.bind(this)}handleChange(e,t){return s=>{ue.handleChange.bind(null,this.props)(u.a.assign({},e,{[t]:u.a.get(s,"value",u.a.get(s,"target.value"))}))}}renderRow(e,t,s){const i=this.props.indexPatterns,a={filter:"",label:"",...e},l=ue.handleAdd.bind(null,this.props,(()=>({color:this.props.model.color,id:f.a.v1(),filter:{language:a.filter.language||vt(),query:""}}))),n=ue.handleDelete.bind(null,this.props,a),{intl:r}=this.props;return Object(p.jsx)(g.EuiFlexGroup,{gutterSize:"s",className:"tvbAggRow",alignItems:"center",key:a.id},Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(y,{disableTrash:!0,onChange:e=>{ue.handleChange.bind(null,this.props)(u.a.assign({},a,e))},name:"color",value:a.color})),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(Ae,{query:{language:a.filter.language||vt(),query:a.filter.query||""},onChange:e=>this.handleQueryChange(a,e),indexPatterns:[i],"data-test-subj":"filterItemsQueryBar"})),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFieldText,{placeholder:r.formatMessage({id:"visTypeTimeseries.splits.filterItems.labelPlaceholder",defaultMessage:"Label"}),"aria-label":r.formatMessage({id:"visTypeTimeseries.splits.filterItems.labelAriaLabel",defaultMessage:"Label"}),onChange:this.handleChange(a,"label"),value:a.label,fullWidth:!0,"data-test-subj":"filterItemsLabel"})),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(M,{onAdd:l,onDelete:n,disableDelete:s.length<2,responsive:!1,testSubj:"filterRow"})))}render(){const{model:e,name:t}=this.props;if(!e[t])return Object(p.jsx)("div",null);const s=e[t].map(this.renderRow);return Object(p.jsx)("div",null,s)}}const Pt=Object(j.injectI18n)(filter_items_FilterItemsUi),At={split_filters:void 0},Dt=e=>{const{onChange:t,model:s,uiRestrictions:i,indexPattern:a}=e,l=Object(g.htmlIdGenerator)();return Object(p.jsx)("div",null,Object(p.jsx)(g.EuiFlexGroup,{alignItems:"center"},Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:l("group"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.splits.filters.groupByLabel",defaultMessage:"Group by"})},Object(p.jsx)(Ft,{value:s.split_mode,onChange:([{value:e=null}])=>{t({split_mode:e,...At})},uiRestrictions:i})))),Object(p.jsx)(Pt,{name:"split_filters",model:s,onChange:t,indexPatterns:a}))},Rt=e=>{const{onChange:t,model:s,uiRestrictions:i}=e,a=Object(g.htmlIdGenerator)(),l=ee(t);return Object(p.jsx)(g.EuiFlexGroup,{alignItems:"center"},Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:a("group"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.splits.everything.groupByLabel",defaultMessage:"Group by"})},Object(p.jsx)(Ft,{value:s.split_mode,onChange:l("split_mode"),uiRestrictions:i}))))},Nt=e=>{const{onChange:t,model:s,uiRestrictions:i}=e,a=Object(g.htmlIdGenerator)(),l=ee(t);return Object(p.jsx)(g.EuiFlexGroup,{alignItems:"center"},Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:a("group"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.splits.everything.groupByLabel",defaultMessage:"Group by"})},Object(p.jsx)(Ft,{value:s.split_mode,onChange:l("split_mode"),uiRestrictions:i}))),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiTitle,{className:"tvbAggRow__unavailable",size:"xxxs"},Object(p.jsx)("span",null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.unsupportedSplit.splitIsUnsupportedDescription",defaultMessage:"Split by {modelType} is unsupported.",values:{modelType:Object(p.jsx)(g.EuiCode,null,s.split_mode)}})))))};class split_Split extends l.Component{UNSAFE_componentWillReceiveProps(e){const{model:t}=e;"filters"!==t.split_mode||t.split_filters||this.props.onChange({split_filters:[{color:t.color,id:f.a.v1(),filter:{query:"",language:vt()}}]})}getComponent(e,t){if(!D(e,t))return Nt;switch(e){case"terms":return St;case"filter":return Lt;case"filters":return Dt;default:return Rt}}render(){const{model:e,panel:t,uiRestrictions:s,seriesQuantity:i}=this.props,a=e.override_index_pattern?e.series_index_pattern:t.index_pattern,l=Object(d.get)(this.props,"model.split_mode","everything"),n=this.getComponent(l,s);return Object(p.jsx)(n,{model:e,indexPattern:a,fields:this.props.fields,onChange:this.props.onChange,uiRestrictions:s,seriesQuantity:i})}}const kt=Object(j.injectI18n)((function(e){const{panel:t,fields:s,onAdd:i,onDelete:a,disableDelete:l,disableAdd:n,selectedTab:r,onChange:o,visible:d,intl:u,name:c,uiRestrictions:b,seriesQuantity:m}=e,x={label:"",...e.model},v=le(o);let O="arrowDown";d||(O="arrowRight");let h=null;if(d){let i;i="metrics"===r?Object(p.jsx)("div",null,Object(p.jsx)(aggs_Aggs,{onChange:e.onChange,fields:s,panel:t,model:x,name:c,uiRestrictions:b,dragHandleProps:e.dragHandleProps}),Object(p.jsx)("div",{className:"tvbAggRow tvbAggRow--split"},Object(p.jsx)(split_Split,{onChange:e.onChange,fields:s,panel:t,model:x,uiRestrictions:b,seriesQuantity:m}))):Object(p.jsx)(Mt,{fields:e.fields,panel:t,model:x,onChange:e.onChange,indexPatternForQuery:e.indexPatternForQuery,seriesQuantity:m}),h=Object(p.jsx)("div",{className:"tvbSeries__body"},Object(p.jsx)(g.EuiTabs,{size:"s"},Object(p.jsx)(g.EuiTab,{isSelected:"metrics"===r,onClick:()=>e.switchTab("metrics")},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.timeSeries.tab.metricsLabel",defaultMessage:"Metrics"})),Object(p.jsx)(g.EuiTab,{"data-test-subj":"seriesOptions",isSelected:"options"===r,onClick:()=>e.switchTab("options")},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.timeSeries.tab.optionsLabel",defaultMessage:"Options"}))),i)}const T=Object(p.jsx)(y,{disableTrash:!0,onChange:e.onChange,name:"color",value:x.color});return Object(p.jsx)("div",{className:`${e.className}`,style:e.style},Object(p.jsx)(g.EuiFlexGroup,{responsive:!1,gutterSize:"s",alignItems:"center"},Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiButtonIcon,{iconType:O,color:"text",onClick:e.toggleVisible,"aria-label":u.formatMessage({id:"visTypeTimeseries.timeSeries.toggleSeriesEditorAriaLabel",defaultMessage:"Toggle series editor"}),"aria-expanded":e.visible})),Object(p.jsx)(g.EuiFlexItem,{grow:!1},T),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFieldText,{fullWidth:!0,onChange:v("label"),placeholder:u.formatMessage({id:"visTypeTimeseries.timeSeries.labelPlaceholder",defaultMessage:"Label"}),value:x.label})),Object(p.jsx)(series_drag_handler_SeriesDragHandler,{dragHandleProps:e.dragHandleProps,hideDragHandler:e.disableDelete}),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(M,{addTooltip:u.formatMessage({id:"visTypeTimeseries.timeSeries.addSeriesTooltip",defaultMessage:"Add Series"}),deleteTooltip:u.formatMessage({id:"visTypeTimeseries.timeSeries.deleteSeriesTooltip",defaultMessage:"Delete Series"}),cloneTooltip:u.formatMessage({id:"visTypeTimeseries.timeSeries.cloneSeriesTooltip",defaultMessage:"Clone Series"}),onDelete:a,onClone:e.onClone,togglePanelActivation:e.togglePanelActivation,isPanelActive:!x.hidden,onAdd:i,disableDelete:l,disableAdd:n,responsive:!1}))),h)})),Bt=Object(j.injectI18n)(kt),Gt=e=>{const t={offset_time:"",value_template:"{{value}}",...e.model},s=le(e.onChange),i=Object(g.htmlIdGenerator)(),a=e.model.override_index_pattern?e.model.series_index_pattern:e.indexPatternForQuery,n=Object(l.useCallback)((t=>e.onChange({formatter:t})),[e]),r=Object(l.useMemo)((()=>qe(Object(d.last)(t.metrics),e.fields,a)),[t.metrics,e.fields,a]),o=e.panel.use_kibana_indexes||""===a,{indexPatternForQuery:u,onChange:c}=e,b=Object(l.useCallback)((e=>{const s={...e};e.override_index_pattern&&!t.series_index_pattern&&(s.series_index_pattern=u),c(s)}),[t.series_index_pattern,u,c]);return Object(p.jsx)("div",{className:"tvbAggRow"},Object(p.jsx)(g.EuiFlexGroup,{gutterSize:"s"},Object(p.jsx)(et,{formatterValue:t.formatter,changeModelFormatter:n,shouldIncludeDefaultOption:o,shouldIncludeNumberOptions:r}),Object(p.jsx)(g.EuiFlexItem,{grow:3},Object(p.jsx)(g.EuiFormRow,{id:i("template"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.seriesConfig.templateLabel",defaultMessage:"Template"}),helpText:Object(p.jsx)("span",null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.seriesConfig.templateHelpText",defaultMessage:"eg. {templateExample}",values:{templateExample:Object(p.jsx)(g.EuiCode,null,"{{value}}/s")}})),fullWidth:!0},Object(p.jsx)(g.EuiFieldText,{onChange:s("value_template"),value:t.value_template,disabled:t.formatter===I.b.DEFAULT,fullWidth:!0})))),Object(p.jsx)(g.EuiHorizontalRule,{margin:"s"}),Object(p.jsx)(Ot,{model:t,onChange:e.onChange,panel:e.panel,indexPatternForQuery:a}),Object(p.jsx)(g.EuiHorizontalRule,{margin:"s"}),Object(p.jsx)(g.EuiFlexGroup,{gutterSize:"s"},Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:i("offsetSeries"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.seriesConfig.offsetSeriesTimeLabel",defaultMessage:"Offset series time by (1m, 1h, 1w, 1d)",description:"1m, 1h, 1w and 1d are required values and must not be translated."})},Object(p.jsx)(g.EuiFieldText,{"data-test-subj":"offsetTimeSeries",onChange:s("offset_time"),value:t.offset_time})))),Object(p.jsx)(g.EuiHorizontalRule,{margin:"s"}),Object(p.jsx)(g.EuiFlexGroup,{gutterSize:"s",responsive:!1,wrap:!0},Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormRow,{label:h.i18n.translate("visTypeTimeseries.seriesConfig.overrideDataViewLabel",{defaultMessage:"Override data view?"})},Object(p.jsx)(tt,{value:t.override_index_pattern,name:"override_index_pattern",onChange:b}))),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(xt,{baseIndexPattern:u,onChange:e.onChange,model:e.model,fields:e.fields,prefix:"series_",disabled:!t.override_index_pattern}))))},zt=Object(j.injectI18n)((function(e){const{panel:t,fields:s,name:i,onAdd:a,onChange:l,onDelete:n,disableDelete:r,disableAdd:o,selectedTab:d,visible:u,intl:c,uiRestrictions:b}=e,m={label:"",...e.model},x=le(l);let v="arrowDown";u||(v="arrowRight");let O,h=null;if(u){let a;a="metrics"===d?Object(p.jsx)("div",null,Object(p.jsx)(aggs_Aggs,{onChange:e.onChange,fields:s,panel:t,model:m,name:i,uiRestrictions:b,dragHandleProps:e.dragHandleProps}),Object(p.jsx)("div",{className:"tvbAggRow tvbAggRow--split"},Object(p.jsx)(split_Split,{onChange:e.onChange,fields:s,panel:t,model:m,uiRestrictions:b}))):Object(p.jsx)(Gt,{panel:t,fields:e.fields,model:e.model,onChange:e.onChange,indexPatternForQuery:e.indexPatternForQuery}),h=Object(p.jsx)("div",{className:"tvbSeries__body"},Object(p.jsx)(g.EuiTabs,{size:"s"},Object(p.jsx)(g.EuiTab,{isSelected:"metrics"===d,onClick:()=>e.switchTab("metrics")},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.metric.dataTab.metricsButtonLabel",defaultMessage:"Metrics"})),Object(p.jsx)(g.EuiTab,{"data-test-subj":"seriesOptions",isSelected:"options"===d,onClick:()=>e.switchTab("options")},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.metric.optionsTab.optionsButtonLabel",defaultMessage:"Options"}))),a)}return e.colorPicker&&(O=Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(y,{disableTrash:!0,onChange:e.onChange,name:"color",value:m.color}))),Object(p.jsx)("div",{className:`${e.className}`,style:e.style},Object(p.jsx)(g.EuiFlexGroup,{responsive:!1,gutterSize:"s",alignItems:"center"},Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiButtonIcon,{iconType:v,color:"text",onClick:e.toggleVisible,"aria-label":c.formatMessage({id:"visTypeTimeseries.metric.editor.toggleEditorAriaLabel",defaultMessage:"Toggle series editor"}),"aria-expanded":e.visible})),O,Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFieldText,{fullWidth:!0,onChange:x("label"),placeholder:c.formatMessage({id:"visTypeTimeseries.metric.editor.labelPlaceholder",defaultMessage:"Label"}),value:m.label})),Object(p.jsx)(series_drag_handler_SeriesDragHandler,{dragHandleProps:e.dragHandleProps,hideDragHandler:e.disableDelete}),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(M,{addTooltip:c.formatMessage({id:"visTypeTimeseries.metric.editor.addSeriesTooltip",defaultMessage:"Add Series"}),deleteTooltip:c.formatMessage({id:"visTypeTimeseries.metric.editor.deleteSeriesTooltip",defaultMessage:"Delete Series"}),cloneTooltip:c.formatMessage({id:"visTypeTimeseries.metric.editor.cloneSeriesTooltip",defaultMessage:"Clone Series"}),onDelete:n,onClone:e.onClone,onAdd:a,togglePanelActivation:e.togglePanelActivation,isPanelActive:!m.hidden,disableDelete:r,disableAdd:o,responsive:!1}))),h)})),Ht=Object(j.injectI18n)((function(e){const{panel:t,model:s,name:i,fields:a,onAdd:l,onChange:n,onDelete:r,disableDelete:o,disableAdd:d,selectedTab:u,visible:c,intl:b,uiRestrictions:m}=e,x=le(n);let v="arrowDown";c||(v="arrowRight");let O=null;if(c){let l;l="metrics"===u?Object(p.jsx)("div",null,Object(p.jsx)(aggs_Aggs,{onChange:e.onChange,fields:a,panel:t,model:s,name:i,uiRestrictions:m,dragHandleProps:e.dragHandleProps}),Object(p.jsx)("div",{className:"tvbAggRow tvbAggRow--split"},Object(p.jsx)(split_Split,{onChange:e.onChange,fields:a,panel:t,model:s,uiRestrictions:m}))):Object(p.jsx)(Gt,{fields:e.fields,panel:e.panel,model:e.model,onChange:e.onChange,indexPatternForQuery:e.indexPatternForQuery}),O=Object(p.jsx)("div",{className:"tvbSeries__body"},Object(p.jsx)(g.EuiTabs,{size:"s"},Object(p.jsx)(g.EuiTab,{isSelected:"metrics"===u,onClick:()=>e.switchTab("metrics")},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.topN.tab.metricsLabel",defaultMessage:"Metrics"})),Object(p.jsx)(g.EuiTab,{"data-test-subj":"seriesOptions",isSelected:"options"===u,onClick:()=>e.switchTab("options")},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.topN.tab.optionsLabel",defaultMessage:"Options"}))),l)}const h=Object(p.jsx)(y,{disableTrash:!0,onChange:e.onChange,name:"color",value:s.color});return Object(p.jsx)("div",{className:`${e.className}`,style:e.style},Object(p.jsx)(g.EuiFlexGroup,{responsive:!1,gutterSize:"s",alignItems:"center"},Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiButtonIcon,{iconType:v,color:"text",onClick:e.toggleVisible,"aria-label":b.formatMessage({id:"visTypeTimeseries.topN.toggleSeriesEditorAriaLabel",defaultMessage:"Toggle series editor"}),"aria-expanded":e.visible})),Object(p.jsx)(g.EuiFlexItem,{grow:!1},h),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFieldText,{fullWidth:!0,onChange:x("label"),placeholder:b.formatMessage({id:"visTypeTimeseries.topN.labelPlaceholder",defaultMessage:"Label"}),value:s.label})),Object(p.jsx)(series_drag_handler_SeriesDragHandler,{dragHandleProps:e.dragHandleProps,hideDragHandler:e.disableDelete}),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(M,{addTooltip:b.formatMessage({id:"visTypeTimeseries.topN.addSeriesTooltip",defaultMessage:"Add Series"}),deleteTooltip:b.formatMessage({id:"visTypeTimeseries.topN.deleteSeriesTooltip",defaultMessage:"Delete Series"}),cloneTooltip:b.formatMessage({id:"visTypeTimeseries.topN.cloneSeriesTooltip",defaultMessage:"Clone Series"}),onDelete:r,onClone:e.onClone,onAdd:l,togglePanelActivation:e.togglePanelActivation,isPanelActive:!s.hidden,disableDelete:o,disableAdd:d,responsive:!1}))),O)}));var Vt=s(64);const Wt=h.i18n.translate("visTypeTimeseries.colorRules.defaultSecondaryNameLabel",{defaultMessage:"text"}),Ut=h.i18n.translate("visTypeTimeseries.colorRules.defaultPrimaryNameLabel",{defaultMessage:"background"}),qt=[{label:h.i18n.translate("visTypeTimeseries.colorRules.greaterThanLabel",{defaultMessage:"> greater than"}),method:Vt.a.Gt},{label:h.i18n.translate("visTypeTimeseries.colorRules.greaterThanOrEqualLabel",{defaultMessage:">= greater than or equal"}),method:Vt.a.Gte},{label:h.i18n.translate("visTypeTimeseries.colorRules.lessThanLabel",{defaultMessage:"< less than"}),method:Vt.a.Lt},{label:h.i18n.translate("visTypeTimeseries.colorRules.lessThanOrEqualLabel",{defaultMessage:"<= less than or equal"}),method:Vt.a.Lte},{label:h.i18n.translate("visTypeTimeseries.colorRules.emptyLabel",{defaultMessage:"empty"}),method:Vt.a.Empty,hideValueSelector:!0}],$t=qt.map((e=>({label:e.label,value:e.method})));class color_rules_ColorRules extends l.Component{constructor(e){super(e),a()(this,"handleOperatorChange",(e=>t=>{var s,i;const a=qt.find((e=>{var s;return(null===(s=t[0])||void 0===s?void 0:s.value)===e.method})),l=null!==(s=null==a?void 0:a.value)&&void 0!==s?s:null;ue.handleChange(this.props,{...e,operator:null===(i=t[0])||void 0===i?void 0:i.value,value:l})})),this.renderRow=this.renderRow.bind(this)}handleValueChange(e){return t=>{let s=Number(t.target.value);isNaN(s)&&(s=void 0),ue.handleChange(this.props,{...e,value:s})}}renderRow(e,t,s){var i,a,n,r,o;const d={value:0,...e},u=e=>{ue.handleChange(this.props,{...d,...e})},c=Object(g.htmlIdGenerator)(d.id),b=$t.find((e=>d.operator===e.value)),m=qt.find((e=>d.operator===e.method)),x=null!==(i=null==m?void 0:m.hideValueSelector)&&void 0!==i&&i,v={marginBottom:0};let O;if(!this.props.hideSecondary){var T,f;const e=null!==(T=this.props.secondaryVarName)&&void 0!==T?T:"color";O=Object(p.jsx)(l.Fragment,null,Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormLabel,{style:v},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.colorRules.setSecondaryColorLabel",defaultMessage:"and {secondaryName} to",values:{secondaryName:null!==(f=this.props.secondaryName)&&void 0!==f?f:Wt},description:"Part of a larger string: Set {primaryName} to {color} and {secondaryName} to {color} if metric is {greaterOrLessThan} {value}."}))),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(y,{onChange:u,name:e,value:d[e]})))}return Object(p.jsx)(g.EuiFlexGroup,{wrap:!0,responsive:!1,gutterSize:"s",key:d.id,alignItems:"center",className:"tvbColorRules__rule"},Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormLabel,{style:v},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.colorRules.setPrimaryColorLabel",defaultMessage:"Set {primaryName} to",values:{primaryName:null!==(a=this.props.primaryName)&&void 0!==a?a:Ut},description:"Part of a larger string: Set {primaryName} to {color} and {secondaryName} to {color} if metric is {greaterOrLessThan} {value}."}))),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(y,{onChange:u,name:null!==(n=this.props.primaryVarName)&&void 0!==n?n:"background_color",value:d[null!==(r=this.props.primaryVarName)&&void 0!==r?r:"background_color"]})),O,Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormLabel,{style:v,htmlFor:c("ifMetricIs")},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.colorRules.ifMetricIsLabel",defaultMessage:"if metric is",description:"Part of a larger string: Set {primaryName} to {color} and {secondaryName} to {color} if metric is {greaterOrLessThan} {value}."}))),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiComboBox,{id:c("ifMetricIs"),options:$t,selectedOptions:b?[b]:[],onChange:this.handleOperatorChange(d),singleSelection:{asPlainText:!0},"data-test-subj":"colorRuleOperator",fullWidth:!0})),!x&&Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFieldNumber,{"aria-label":h.i18n.translate("visTypeTimeseries.colorRules.valueAriaLabel",{defaultMessage:"Value"}),value:null!==(o=d.value)&&void 0!==o?o:"",onChange:this.handleValueChange(d),"data-test-subj":"colorRuleValue",fullWidth:!0})),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(M,{onAdd:()=>ue.handleAdd(this.props),onDelete:()=>ue.handleDelete(this.props,d),disableDelete:s.length<2,responsive:!1})))}render(){const{model:e,name:t}=this.props;return e[t]?Object(p.jsx)("div",null,e[t].map(this.renderRow)):Object(p.jsx)("div",null)}}var Kt=s(19);class config_TableSeriesConfig extends l.Component{constructor(...e){super(...e),a()(this,"changeModelFormatter",(e=>this.props.onChange({formatter:e})))}UNSAFE_componentWillMount(){const{model:e}=this.props;(!e.color_rules||e.color_rules&&0===e.color_rules.length)&&this.props.onChange({color_rules:[{id:f.a.v1()}]})}render(){var e,t,s;const i={offset_time:"",value_template:"{{value}}",...this.props.model},a=ee(this.props.onChange),l=le(this.props.onChange),n=Object(g.htmlIdGenerator)(),r=[{label:h.i18n.translate("visTypeTimeseries.table.sumLabel",{defaultMessage:"Sum"}),value:"sum"},{label:h.i18n.translate("visTypeTimeseries.table.maxLabel",{defaultMessage:"Max"}),value:"max"},{label:h.i18n.translate("visTypeTimeseries.table.minLabel",{defaultMessage:"Min"}),value:"min"},{label:h.i18n.translate("visTypeTimeseries.table.avgLabel",{defaultMessage:"Avg"}),value:"mean"},{label:h.i18n.translate("visTypeTimeseries.table.overallSumLabel",{defaultMessage:"Overall Sum"}),value:"overall_sum"},{label:h.i18n.translate("visTypeTimeseries.table.overallMaxLabel",{defaultMessage:"Overall Max"}),value:"overall_max"},{label:h.i18n.translate("visTypeTimeseries.table.overallMinLabel",{defaultMessage:"Overall Min"}),value:"overall_min"},{label:h.i18n.translate("visTypeTimeseries.table.overallAvgLabel",{defaultMessage:"Overall Avg"}),value:"overall_avg"},{label:h.i18n.translate("visTypeTimeseries.table.cumulativeSumLabel",{defaultMessage:"Cumulative Sum"}),value:"cumulative_sum"}],o=r.find((e=>i.aggregate_function===e.value)),u=qe(Object(d.last)(i.metrics),this.props.fields,this.props.indexPatternForQuery),c=this.props.panel.use_kibana_indexes||""===this.props.indexPatternForQuery,b=(null===(e=i.filter)||void 0===e?void 0:e.query)&&("filter",m=this.props.uiRestrictions,!P("filter",S.WHITE_LISTED_CONFIGURATION_FEATURES,m));var m;return Object(p.jsx)("div",{className:"tvbAggRow"},Object(p.jsx)(g.EuiFlexGroup,{gutterSize:"s"},Object(p.jsx)(et,{formatterValue:i.formatter,changeModelFormatter:this.changeModelFormatter,shouldIncludeDefaultOption:c,shouldIncludeNumberOptions:u}),Object(p.jsx)(g.EuiFlexItem,{grow:3},Object(p.jsx)(g.EuiFormRow,{id:n("template"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.table.templateLabel",defaultMessage:"Template"}),helpText:Object(p.jsx)("span",null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.table.templateHelpText",defaultMessage:"eg.{templateExample}",values:{templateExample:Object(p.jsx)(g.EuiCode,null,"{{value}}/s")}})),fullWidth:!0},Object(p.jsx)(g.EuiFieldText,{onChange:l("value_template"),value:i.value_template,disabled:i.formatter===I.b.DEFAULT,fullWidth:!0})))),Object(p.jsx)(g.EuiHorizontalRule,{margin:"s"}),Object(p.jsx)(g.EuiFlexGroup,{responsive:!1,wrap:!0},Object(p.jsx)(g.EuiFlexItem,{grow:!0},Object(p.jsx)(g.EuiFormRow,{id:n("filterInput"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.table.filterLabel",defaultMessage:"Filter"}),isInvalid:b,error:Kt.c,fullWidth:!0},Object(p.jsx)(Ae,{query:{language:(null==i||null===(t=i.filter)||void 0===t?void 0:t.language)||vt(),query:(null==i||null===(s=i.filter)||void 0===s?void 0:s.query)||""},isInvalid:b,onChange:e=>this.props.onChange({filter:e}),indexPatterns:[this.props.indexPatternForQuery]}))),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormRow,{label:h.i18n.translate("visTypeTimeseries.table.showTrendArrowsLabel",{defaultMessage:"Show trend arrows?"})},Object(p.jsx)(tt,{value:i.trend_arrows,name:"trend_arrows",onChange:this.props.onChange})))),Object(p.jsx)(g.EuiHorizontalRule,{margin:"s"}),Object(p.jsx)(g.EuiFlexGroup,{responsive:!1,wrap:!0},Object(p.jsx)(g.EuiFlexItem,{grow:!0},Object(p.jsx)(Oe,{label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.table.fieldLabel",defaultMessage:"Field"}),fields:this.props.fields,indexPattern:this.props.panel.index_pattern,value:i.aggregate_by,onChange:e=>this.props.onChange({aggregate_by:null==e?void 0:e[0]}),fullWidth:!0,restrict:[he.KBN_FIELD_TYPES.NUMBER,he.KBN_FIELD_TYPES.BOOLEAN,he.KBN_FIELD_TYPES.DATE,he.KBN_FIELD_TYPES.IP,he.KBN_FIELD_TYPES.STRING],uiRestrictions:this.props.uiRestrictions,type:"terms"})),Object(p.jsx)(g.EuiFlexItem,{grow:!0},Object(p.jsx)(g.EuiFormRow,{id:n("aggregateFunctionInput"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.table.aggregateFunctionLabel",defaultMessage:"Aggregate function"}),fullWidth:!0},Object(p.jsx)(g.EuiComboBox,{options:r,selectedOptions:o?[o]:[],onChange:a("aggregate_function"),singleSelection:{asPlainText:!0},fullWidth:!0})))),Object(p.jsx)(g.EuiHorizontalRule,{margin:"s"}),Object(p.jsx)(g.EuiTitle,{size:"xxs"},Object(p.jsx)("span",null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.table.colorRulesLabel",defaultMessage:"Color rules"}))),Object(p.jsx)(g.EuiSpacer,{size:"s"}),Object(p.jsx)(color_rules_ColorRules,{primaryName:"text",primaryVarName:"text",hideSecondary:!0,model:i,onChange:this.props.onChange,name:"color_rules"}))}}const Yt={top_n:Ht,table:Object(j.injectI18n)((function(e){const{model:t,onAdd:s,name:i,fields:a,panel:l,onChange:n,onDelete:r,disableDelete:o,disableAdd:d,selectedTab:u,visible:c,intl:b,uiRestrictions:m}=e,x=le(n);let v="arrowDown";c||(v="arrowRight");let O=null;if(c){let s;s="metrics"===u?Object(p.jsx)("div",null,Object(p.jsx)(aggs_Aggs,{onChange:e.onChange,fields:a,panel:l,model:t,name:i,uiRestrictions:m,dragHandleProps:e.dragHandleProps})):Object(p.jsx)(config_TableSeriesConfig,{panel:e.panel,fields:e.fields,model:e.model,onChange:e.onChange,indexPatternForQuery:e.indexPatternForQuery,uiRestrictions:e.uiRestrictions}),O=Object(p.jsx)("div",{className:"tvbSeries__body"},Object(p.jsx)(g.EuiTabs,{size:"s"},Object(p.jsx)(g.EuiTab,{isSelected:"metrics"===u,onClick:()=>e.switchTab("metrics")},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.table.tab.metricsLabel",defaultMessage:"Metrics"})),Object(p.jsx)(g.EuiTab,{"data-test-subj":"seriesOptions",isSelected:"options"===u,onClick:()=>e.switchTab("options")},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.table.tab.optionsLabel",defaultMessage:"Options"}))),s)}return Object(p.jsx)("div",{className:`${e.className}`,style:e.style},Object(p.jsx)(g.EuiFlexGroup,{responsive:!1,gutterSize:"s",alignItems:"center"},Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiButtonIcon,{iconType:v,color:"text",onClick:e.toggleVisible,"aria-label":b.formatMessage({id:"visTypeTimeseries.table.toggleSeriesEditorAriaLabel",defaultMessage:"Toggle series editor"}),"aria-expanded":e.visible})),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFieldText,{fullWidth:!0,"aria-label":b.formatMessage({id:"visTypeTimeseries.table.labelAriaLabel",defaultMessage:"Label"}),onChange:x("label"),placeholder:b.formatMessage({id:"visTypeTimeseries.table.labelPlaceholder",defaultMessage:"Label"}),value:t.label})),Object(p.jsx)(series_drag_handler_SeriesDragHandler,{dragHandleProps:e.dragHandleProps,hideDragHandler:e.disableDelete}),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(M,{addTooltip:b.formatMessage({id:"visTypeTimeseries.table.addSeriesTooltip",defaultMessage:"Add Series"}),deleteTooltip:b.formatMessage({id:"visTypeTimeseries.table.deleteSeriesTooltip",defaultMessage:"Delete Series"}),cloneTooltip:b.formatMessage({id:"visTypeTimeseries.table.cloneSeriesTooltip",defaultMessage:"Clone Series"}),onDelete:r,onClone:e.onClone,onAdd:s,togglePanelActivation:e.togglePanelActivation,isPanelActive:!t.hidden,disableDelete:o,disableAdd:d,responsive:!1}))),O)})),metric:zt,timeseries:Bt,gauge:Object(j.injectI18n)((function(e){const{panel:t,fields:s,onAdd:i,name:a,onChange:l,onDelete:n,disableDelete:r,disableAdd:o,selectedTab:d,visible:u,intl:c,uiRestrictions:b}=e,m={label:"",...e.model},x=le(l);let v="arrowDown";u||(v="arrowRight");let O=null;if(u){let i;i="metrics"===d?Object(p.jsx)("div",null,Object(p.jsx)(aggs_Aggs,{onChange:e.onChange,fields:s,panel:t,model:m,name:a,uiRestrictions:b,dragHandleProps:e.dragHandleProps}),Object(p.jsx)("div",{className:"tvbAggRow tvbAggRow--split"},Object(p.jsx)(split_Split,{onChange:e.onChange,fields:s,panel:t,model:m,uiRestrictions:b}))):Object(p.jsx)(Gt,{fields:e.fields,panel:t,model:e.model,onChange:e.onChange,indexPatternForQuery:e.indexPatternForQuery}),O=Object(p.jsx)("div",{className:"tvbSeries__body"},Object(p.jsx)(g.EuiTabs,{size:"s"},Object(p.jsx)(g.EuiTab,{isSelected:"metrics"===d,onClick:()=>e.switchTab("metrics")},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.gauge.dataTab.metricsButtonLabel",defaultMessage:"Metrics"})),Object(p.jsx)(g.EuiTab,{"data-test-subj":"seriesOptions",isSelected:"options"===d,onClick:()=>e.switchTab("options")},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.gauge.optionsTab.optionsButtonLabel",defaultMessage:"Options"}))),i)}const h=Object(p.jsx)(y,{disableTrash:!0,onChange:e.onChange,name:"color",value:m.color});return Object(p.jsx)("div",{className:`${e.className}`,style:e.style},Object(p.jsx)(g.EuiFlexGroup,{responsive:!1,gutterSize:"s",alignItems:"center"},Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiButtonIcon,{iconType:v,color:"text",onClick:e.toggleVisible,"aria-label":c.formatMessage({id:"visTypeTimeseries.gauge.editor.toggleEditorAriaLabel",defaultMessage:"Toggle series editor"}),"aria-expanded":e.visible})),Object(p.jsx)(g.EuiFlexItem,{grow:!1},h),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFieldText,{fullWidth:!0,onChange:x("label"),placeholder:c.formatMessage({id:"visTypeTimeseries.gauge.editor.labelPlaceholder",defaultMessage:"Label"}),value:m.label})),Object(p.jsx)(series_drag_handler_SeriesDragHandler,{dragHandleProps:e.dragHandleProps,hideDragHandler:e.disableDelete}),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(M,{addTooltip:c.formatMessage({id:"visTypeTimeseries.gauge.editor.addSeriesTooltip",defaultMessage:"Add Series"}),deleteTooltip:c.formatMessage({id:"visTypeTimeseries.gauge.editor.deleteSeriesTooltip",defaultMessage:"Delete Series"}),cloneTooltip:c.formatMessage({id:"visTypeTimeseries.gauge.editor.cloneSeriesTooltip",defaultMessage:"Clone Series"}),onDelete:n,onClone:e.onClone,onAdd:i,disableDelete:r,disableAdd:o,responsive:!1}))),O)})),markdown:Object(j.injectI18n)((function(e){const{panel:t,fields:s,onAdd:i,onChange:a,onDelete:l,disableDelete:n,disableAdd:r,selectedTab:o,visible:d,intl:u,name:c,uiRestrictions:b}=e,m={label:"",var_name:"",...e.model},x=le(a);let v="arrowDown";d||(v="arrowRight");let O=null;if(d){let i;i="metrics"===o?Object(p.jsx)("div",null,Object(p.jsx)(aggs_Aggs,{onChange:e.onChange,fields:s,panel:t,model:m,name:c,uiRestrictions:b,dragHandleProps:e.dragHandleProps}),Object(p.jsx)("div",{className:"tvbAggRow tvbAggRow--split"},Object(p.jsx)(split_Split,{onChange:e.onChange,fields:s,panel:t,model:m,uiRestrictions:b}))):Object(p.jsx)(Gt,{fields:e.fields,panel:t,model:e.model,onChange:e.onChange,indexPatternForQuery:e.indexPatternForQuery}),O=Object(p.jsx)("div",{className:"tvbSeries__body"},Object(p.jsx)(g.EuiTabs,{size:"s"},Object(p.jsx)(g.EuiTab,{isSelected:"metrics"===o,onClick:()=>e.switchTab("metrics")},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.markdown.dataTab.metricsButtonLabel",defaultMessage:"Metrics"})),Object(p.jsx)(g.EuiTab,{"data-test-subj":"seriesOptions",isSelected:"options"===o,onClick:()=>e.switchTab("options")},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.markdown.optionsTab.optionsButtonLabel",defaultMessage:"Options"}))),i)}return Object(p.jsx)("div",{className:`${e.className}`,style:e.style},Object(p.jsx)(g.EuiFlexGroup,{responsive:!1,gutterSize:"s",alignItems:"center"},Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiButtonIcon,{iconType:v,color:"text",onClick:e.toggleVisible,"aria-label":u.formatMessage({id:"visTypeTimeseries.markdown.editor.toggleEditorAriaLabel",defaultMessage:"Toggle series editor"}),"aria-expanded":e.visible})),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFieldText,{fullWidth:!0,onChange:x("label"),placeholder:u.formatMessage({id:"visTypeTimeseries.markdown.editor.labelPlaceholder",defaultMessage:"Label"}),value:m.label})),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFieldText,{fullWidth:!0,onChange:x("var_name"),placeholder:u.formatMessage({id:"visTypeTimeseries.markdown.editor.variableNamePlaceholder",defaultMessage:"Variable name"}),value:m.var_name})),Object(p.jsx)(series_drag_handler_SeriesDragHandler,{dragHandleProps:e.dragHandleProps,hideDragHandler:!0}),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(M,{addTooltip:u.formatMessage({id:"visTypeTimeseries.markdown.editor.addSeriesTooltip",defaultMessage:"Add series"}),deleteTooltip:u.formatMessage({id:"visTypeTimeseries.markdown.editor.deleteSeriesTooltip",defaultMessage:"Delete series"}),cloneTooltip:u.formatMessage({id:"visTypeTimeseries.markdown.editor.cloneSeriesTooltip",defaultMessage:"Clone series"}),onDelete:l,onClone:e.onClone,onAdd:i,disableDelete:n,disableAdd:r,responsive:!1}))),O)}))};class series_Series extends l.Component{constructor(...e){super(...e),a()(this,"state",{visible:!0,selectedTab:"metrics"}),a()(this,"switchTab",(e=>{this.setState({selectedTab:e})})),a()(this,"handleChange",(e=>{if(this.props.onChange){const{model:t}=this.props,s=Object(d.assign)({},t,e);this.props.onChange(s)}})),a()(this,"togglePanelActivation",(()=>{const{model:e}=this.props;this.handleChange({hidden:!e.hidden})})),a()(this,"toggleVisible",(e=>{e.preventDefault(),this.setState({visible:!this.state.visible})}))}render(){const{panel:e}=this.props,t=Yt[e.type];return Boolean(t)?Object(p.jsx)(v.Consumer,null,(s=>{const i=Object(d.get)(s,`${e.id}.series`,[]),a={},l=i.reduce(((e,t)=>(a[t.seriesId]=a[t.seriesId]+1||1,e[t.seriesId]=a[t.seriesId],e)),{});return Object(p.jsx)(t,{className:this.props.className,disableAdd:this.props.disableAdd,uiRestrictions:s.uiRestrictions,seriesQuantity:l,disableDelete:this.props.disableDelete,fields:this.props.fields,name:this.props.name,onAdd:this.props.onAdd,onChange:this.handleChange,onClone:this.props.onClone,onDelete:this.props.onDelete,model:this.props.model,panel:this.props.panel,selectedTab:this.state.selectedTab,style:this.props.style,switchTab:this.switchTab,toggleVisible:this.toggleVisible,togglePanelActivation:this.togglePanelActivation,visible:this.state.visible,dragHandleProps:this.props.dragHandleProps,indexPatternForQuery:e.index_pattern})})):Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.seriesConfig.missingSeriesComponentDescription",defaultMessage:"Missing Series component for panel type: {panelType}",values:{panelType:e.type}})}}series_Series.defaultProps={name:"metrics"};const Qt=(e={})=>u.a.assign({id:f.a.v1(),color:"#68BC00",split_mode:"everything",palette:{type:"palette",name:"default"},metrics:[Ue()],separate_axis:0,axis_position:"right",formatter:"default",chart_type:"line",line_width:1,point_size:1,fill:.5,stacked:Ct.c.NONE,override_index_pattern:0,series_drop_last_bucket:0},e),Xt=(e,t,s)=>{const i=Array.from(e),[a]=i.splice(t,1);return i.splice(s,0,a),i},Jt="series_editor_dnd";class series_editor_SeriesEditor extends l.Component{constructor(...e){super(...e),a()(this,"handleClone",(e=>{const t=(e=>{const t=u.a.cloneDeep(e);return t.id=f.a.v1(),t.metrics.forEach((e=>{const s=f.a.v1(),i=e.id;e.id=s,t.terms_order_by===i&&(t.terms_order_by=s),t.metrics.filter((e=>e.field===i)).forEach((e=>e.field=s)),t.metrics.filter((e=>"calculation"===e.type&&e.variables.some((e=>e.field===i)))).forEach((e=>{e.variables.filter((e=>e.field===i)).forEach((e=>{e.id=f.a.v1(),e.field=s}))}))})),t})(e);de.call(null,this.props,(()=>t))})),a()(this,"sortHandler",(({destination:e,source:t})=>{e&&t&&this.getSortFunction({destination:e,source:t})({destination:e,source:t})})),a()(this,"getSortFunction",(({destination:e,source:t})=>e.droppableId===t.droppableId&&t.droppableId===Jt?this.sortSeries:this.sortAggregations)),a()(this,"sortSeries",(({destination:e,source:t})=>{this.props.onChange({series:Xt([...this.props.model.series],t.index,e.index)})})),a()(this,"sortAggregations",(({destination:e,source:t})=>{const s=({droppableId:e})=>e.split(":")[1],i=s(t);if(i===s(e)){const s=[...this.props.model.series],a=Object(d.find)(s,{id:i});a.metrics=Xt([...a.metrics],t.index,e.index),this.props.onChange({series:s})}}))}render(){const{limit:e,model:t,name:s,fields:i,colorPicker:a}=this.props,l=t[s].filter(((t,s)=>s<(e||1/0)));return Object(p.jsx)(g.EuiDragDropContext,{onDragEnd:this.sortHandler},Object(p.jsx)(g.EuiDroppable,{droppableId:Jt,spacing:"l",type:"MACRO"},l.map(((l,n)=>Object(p.jsx)(g.EuiDraggable,{spacing:"m",key:l.id,index:n,customDragHandle:!0,draggableId:`series_editor_dnd:${l.id}`,disableInteractiveElementBlocking:!0},(n=>Object(p.jsx)(series_Series,{className:"tvbSeriesEditor",colorPicker:a,disableAdd:t[s].length>=e,disableDelete:t[s].length<2,fields:i,onAdd:()=>de(this.props,Qt),onChange:e=>re(this.props,e),onClone:()=>this.handleClone(l),onDelete:()=>oe(this.props,l),model:l,panel:t,dragHandleProps:n.dragHandleProps})))))))}}series_editor_SeriesEditor.defaultProps={name:"series",limit:1/0,colorPicker:!0};var Zt=s(61);const es=[{value:"fa-asterisk",label:h.i18n.translate("visTypeTimeseries.iconSelect.asteriskLabel",{defaultMessage:"Asterisk"})},{value:"fa-bell",label:h.i18n.translate("visTypeTimeseries.iconSelect.bellLabel",{defaultMessage:"Bell"})},{value:"fa-bolt",label:h.i18n.translate("visTypeTimeseries.iconSelect.boltLabel",{defaultMessage:"Bolt"})},{value:"fa-comment",label:h.i18n.translate("visTypeTimeseries.iconSelect.commentLabel",{defaultMessage:"Comment"})},{value:"fa-map-marker",label:h.i18n.translate("visTypeTimeseries.iconSelect.mapMarkerLabel",{defaultMessage:"Map Marker"})},{value:"fa-map-pin",label:h.i18n.translate("visTypeTimeseries.iconSelect.mapPinLabel",{defaultMessage:"Map Pin"})},{value:"fa-star",label:h.i18n.translate("visTypeTimeseries.iconSelect.starLabel",{defaultMessage:"Star"})},{value:"fa-tag",label:h.i18n.translate("visTypeTimeseries.iconSelect.tagLabel",{defaultMessage:"Tag"})},{value:"fa-bomb",label:h.i18n.translate("visTypeTimeseries.iconSelect.bombLabel",{defaultMessage:"Bomb"})},{value:"fa-bug",label:h.i18n.translate("visTypeTimeseries.iconSelect.bugLabel",{defaultMessage:"Bug"})},{value:"fa-exclamation-circle",label:h.i18n.translate("visTypeTimeseries.iconSelect.exclamationCircleLabel",{defaultMessage:"Exclamation Circle"})},{value:"fa-exclamation-triangle",label:h.i18n.translate("visTypeTimeseries.iconSelect.exclamationTriangleLabel",{defaultMessage:"Exclamation Triangle"})},{value:"fa-fire",label:h.i18n.translate("visTypeTimeseries.iconSelect.fireLabel",{defaultMessage:"Fire"})},{value:"fa-flag",label:h.i18n.translate("visTypeTimeseries.iconSelect.flagLabel",{defaultMessage:"Flag"})},{value:"fa-heart",label:h.i18n.translate("visTypeTimeseries.iconSelect.heartLabel",{defaultMessage:"Heart"})}];function ts({value:e,label:t}){return Object(p.jsx)("span",null,Object(p.jsx)(g.EuiIcon,{type:Zt.a[e]}),` ${t}`)}function ss({value:e,onChange:t}){const s=es.find((t=>e===t.value))||es[0];return Object(p.jsx)(g.EuiComboBox,{isClearable:!1,options:es,selectedOptions:[s],onChange:t,singleSelection:{asPlainText:!0},renderOption:ts})}const is=[he.KBN_FIELD_TYPES.DATE],as="time_field",ls=({annotation:e,fields:t,onChange:s,handleAdd:i,handleDelete:a})=>{const n=Object(l.useMemo)((()=>({fields:"",template:"",index_pattern:"",query_string:{query:"",language:vt()},...e})),[e]),r=Object(g.htmlIdGenerator)(n.id),[o,d]=Object(l.useState)(null);Object(l.useEffect)((()=>{(async e=>{const t=Object(we.d)();let s={indexPattern:void 0,indexPatternString:void 0};try{s=e?await Object(se.b)(e,t,{fetchKibanaIndexForStringIndexes:!0}):{...s,defaultIndex:await t.getDefault()}}catch{}d(s)})(n.index_pattern)}),[n.index_pattern]);const u=Object(l.useCallback)((()=>s({hidden:!n.hidden})),[n.hidden,s]),c=Object(l.useCallback)((e=>t=>{var i;return s({[e]:Array.isArray(t)?null==t||null===(i=t[0])||void 0===i?void 0:i.value:t.target.value})}),[s]),b=Object(l.useCallback)((e=>s({query_string:e})),[s]);return Object(p.jsx)("div",{className:"tvbAnnotationsEditor",key:n.id},Object(p.jsx)(g.EuiFlexGroup,{responsive:!1},Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(y,{disableTrash:!0,onChange:s,name:"color",value:n.color})),Object(p.jsx)(g.EuiFlexItem,{className:"tvbAggRow__children"},Object(p.jsx)(g.EuiFlexGroup,{responsive:!1,wrap:!0,gutterSize:"m"},Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(ct,{indexPatternName:"index_pattern",onChange:s,fetchedIndex:o})),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(Oe,{type:as,label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.annotationsEditor.timeFieldLabel",defaultMessage:"Time field (required)"}),restrict:is,value:n.time_field,onChange:e=>{var t;return s({[as]:null!==(t=null==e?void 0:e[0])&&void 0!==t?t:void 0})},indexPattern:n.index_pattern,fields:t}))),Object(p.jsx)(g.EuiSpacer,{size:"m"}),Object(p.jsx)(g.EuiFlexGroup,{responsive:!1,wrap:!0,gutterSize:"m"},Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:r("queryString"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.annotationsEditor.queryStringLabel",defaultMessage:"Query string"}),fullWidth:!0},Object(p.jsx)(Ae,{query:{language:n.query_string.language||vt(),query:n.query_string.query||""},onChange:b,indexPatterns:[n.index_pattern],"data-test-subj":"annotationQueryBar"}))),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormRow,{label:h.i18n.translate("visTypeTimeseries.annotationsEditor.ignoreGlobalFiltersLabel",{defaultMessage:"Ignore global filters?"})},Object(p.jsx)(tt,{value:n.ignore_global_filters,name:"ignore_global_filters",onChange:s}))),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormRow,{label:h.i18n.translate("visTypeTimeseries.annotationsEditor.ignorePanelFiltersLabel",{defaultMessage:"Ignore panel filters?"})},Object(p.jsx)(tt,{value:n.ignore_panel_filters,name:"ignore_panel_filters",onChange:s})))),Object(p.jsx)(g.EuiSpacer,{size:"m"}),Object(p.jsx)(g.EuiFlexGroup,{responsive:!1,wrap:!0,gutterSize:"m"},Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:r("icon"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.annotationsEditor.iconLabel",defaultMessage:"Icon (required)"})},Object(p.jsx)(ss,{value:n.icon,onChange:c("icon")}))),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:r("fields"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.annotationsEditor.fieldsLabel",defaultMessage:"Fields (required - comma separated paths)"}),fullWidth:!0},Object(p.jsx)(g.EuiFieldText,{onChange:c("fields"),value:n.fields,fullWidth:!0,"data-test-subj":"annotationFieldsInput"}))),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:r("rowTemplate"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.annotationsEditor.rowTemplateLabel",defaultMessage:"Row template (required)"}),helpText:Object(p.jsx)("span",null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.annotationsEditor.rowTemplateHelpText",defaultMessage:"eg.{rowTemplateExample}",values:{rowTemplateExample:Object(p.jsx)(g.EuiCode,null,"{{field}}")}})),fullWidth:!0},Object(p.jsx)(g.EuiFieldText,{onChange:c("template"),value:n.template,fullWidth:!0,"data-test-subj":"annotationRowTemplateInput"}))))),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(M,{onAdd:i,onDelete:a,togglePanelActivation:u,isPanelActive:!n.hidden}))))},ns=({handleAdd:e})=>Object(p.jsx)(g.EuiText,{textAlign:"center"},Object(p.jsx)("p",null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.annotationsEditor.howToCreateAnnotationDataSourceDescription",defaultMessage:"Click the button below to create an annotation data source."})),Object(p.jsx)(g.EuiButton,{fill:!0,onClick:e,"data-test-subj":"addDataSourceButton"},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.annotationsEditor.addDataSourceButtonLabel",defaultMessage:"Add data source"}))),rs=e=>({name:"annotations",...e}),os=e=>{const{annotations:t}=e.model,s=Object(l.useCallback)((()=>{return ue.handleAdd(rs(e),(t=e.defaultIndexPattern,()=>({id:f.a.v1(),color:"#F00",index_pattern:t&&t.id?{id:t.id}:"",time_field:"",icon:"fa-tag",ignore_global_filters:1,ignore_panel_filters:1})));var t}),[e]),i=Object(l.useCallback)((t=>()=>ue.handleDelete(rs(e),t)),[e]),a=Object(l.useCallback)((t=>s=>ue.handleChange(rs(e),{...t,...s})),[e]);return Object(p.jsx)("div",{className:"tvbAnnotationsEditor__container"},null!=t&&t.length?Object(p.jsx)("div",null,Object(p.jsx)(g.EuiTitle,{size:"s"},Object(p.jsx)("span",null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.annotationsEditor.dataSourcesLabel",defaultMessage:"Data sources"}))),Object(p.jsx)(g.EuiSpacer,{size:"m"}),t.map((t=>Object(p.jsx)(ls,{key:t.id,annotation:t,fields:e.fields,onChange:a(t),handleAdd:s,handleDelete:i(t)})))):Object(p.jsx)(ns,{handleAdd:s}))};let ds;!function(e){e.DATA="data",e.OPTIONS="options",e.ANNOTATIONS="annotations",e.MARKDOWN="markdown"}(ds||(ds={}));const us=[{label:h.i18n.translate("visTypeTimeseries.timeseries.positionOptions.rightLabel",{defaultMessage:"Right"}),value:"right"},{label:h.i18n.translate("visTypeTimeseries.timeseries.positionOptions.leftLabel",{defaultMessage:"Left"}),value:"left"}],cs=[{label:h.i18n.translate("visTypeTimeseries.timeseries.tooltipOptions.showAll",{defaultMessage:"Show all values"}),value:"show_all"},{label:h.i18n.translate("visTypeTimeseries.timeseries.tooltipOptions.showFocused",{defaultMessage:"Show focused values"}),value:"show_focused"}],bs=[{label:h.i18n.translate("visTypeTimeseries.timeseries.scaleOptions.normalLabel",{defaultMessage:"Normal"}),value:"normal"},{label:h.i18n.translate("visTypeTimeseries.timeseries.scaleOptions.logLabel",{defaultMessage:"Log"}),value:"log"}],gs=[{label:h.i18n.translate("visTypeTimeseries.timeseries.legendPositionOptions.rightLabel",{defaultMessage:"Right"}),value:"right"},{label:h.i18n.translate("visTypeTimeseries.timeseries.legendPositionOptions.leftLabel",{defaultMessage:"Left"}),value:"left"},{label:h.i18n.translate("visTypeTimeseries.timeseries.legendPositionOptions.bottomLabel",{defaultMessage:"Bottom"}),value:"bottom"}];class timeseries_TimeseriesPanelConfig extends l.Component{constructor(e){super(e),a()(this,"handleTextChange",(e=>t=>this.props.onChange({[e]:t.target.value}))),this.state={selectedTab:ds.DATA}}switchTab(e){this.setState({selectedTab:e})}render(){const e={filter:{query:"",language:vt()},axis_max:"",axis_min:"",legend_position:"right",show_grid:1,tooltip_mode:I.h.SHOW_ALL,ignore_daylight_time:!1,...this.props.model},{selectedTab:t}=this.state,s=ee(this.props.onChange),i=Object(g.htmlIdGenerator)(),a=us.find((t=>e.axis_position===t.value)),l=bs.find((t=>e.axis_scale===t.value)),r=gs.find((t=>e.legend_position===t.value)),o=cs.find((t=>e.tooltip_mode===t.value));let d;if(t===ds.DATA)d=Object(p.jsx)(series_editor_SeriesEditor,{fields:this.props.fields,model:this.props.model,onChange:this.props.onChange});else if(t===ds.ANNOTATIONS)d=Object(p.jsx)(os,{fields:this.props.fields,model:this.props.model,onChange:this.props.onChange,defaultIndexPattern:this.props.defaultIndexPattern});else{var u,c,b,m;d=Object(p.jsx)("div",{className:"tvbPanelConfig__container"},Object(p.jsx)(g.EuiPanel,null,Object(p.jsx)(g.EuiTitle,{size:"s"},Object(p.jsx)("span",null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.timeseries.optionsTab.dataLabel",defaultMessage:"Data"}))),Object(p.jsx)(g.EuiSpacer,{size:"m"}),Object(p.jsx)(xt,{fields:this.props.fields,model:this.props.model,onChange:this.props.onChange,allowLevelOfDetail:!0,allowIndexSwitchingMode:!0}),Object(p.jsx)(g.EuiHorizontalRule,null),Object(p.jsx)(g.EuiFlexGroup,{responsive:!1,wrap:!0},Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:i("panelFilter"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.timeseries.optionsTab.panelFilterLabel",defaultMessage:"Panel filter"}),fullWidth:!0},Object(p.jsx)(Ae,{query:{language:(null===(u=e.filter)||void 0===u?void 0:u.language)||vt(),query:(null===(c=e.filter)||void 0===c?void 0:c.query)||""},onChange:e=>{this.props.onChange({filter:e})},indexPatterns:[e.index_pattern],"data-test-subj":"panelFilterQueryBar"}))),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormRow,{label:h.i18n.translate("visTypeTimeseries.timeseries.optionsTab.ignoreGlobalFilterLabel",{defaultMessage:"Ignore global filter?"})},Object(p.jsx)(tt,{value:e.ignore_global_filter,name:"ignore_global_filter",onChange:this.props.onChange}))),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormRow,{label:h.i18n.translate("visTypeTimeseries.timeseries.optionsTab.ignoreDaylightTimeLabel",{defaultMessage:"Ignore daylight time?"})},Object(p.jsx)(tt,{value:e.ignore_daylight_time,name:"ignore_daylight_time",onChange:this.props.onChange}))))),Object(p.jsx)(g.EuiSpacer,null),Object(p.jsx)(g.EuiPanel,null,Object(p.jsx)(g.EuiTitle,{size:"s"},Object(p.jsx)("span",null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.timeseries.optionsTab.styleLabel",defaultMessage:"Style"}))),Object(p.jsx)(g.EuiSpacer,{size:"m"}),Object(p.jsx)(g.EuiFlexGroup,{responsive:!1,wrap:!0,alignItems:"center"},Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:i("axisMin"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.timeseries.optionsTab.axisMinLabel",defaultMessage:"Axis min"})},Object(p.jsx)(g.EuiFieldText,{onChange:this.handleTextChange("axis_min"),value:null!==(b=e.axis_min)&&void 0!==b?b:""}))),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:i("axisMax"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.timeseries.optionsTab.axisMaxLabel",defaultMessage:"Axis max"})},Object(p.jsx)(g.EuiFieldText,{onChange:this.handleTextChange("axis_max"),value:null!==(m=e.axis_max)&&void 0!==m?m:""}))),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:i("axisPos"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.timeseries.optionsTab.axisPositionLabel",defaultMessage:"Axis position"})},Object(p.jsx)(g.EuiComboBox,{isClearable:!1,options:us,selectedOptions:a?[a]:[],onChange:s("axis_position"),singleSelection:{asPlainText:!0}}))),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:i("axisScale"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.timeseries.optionsTab.axisScaleLabel",defaultMessage:"Axis scale"})},Object(p.jsx)(g.EuiComboBox,{isClearable:!1,options:bs,selectedOptions:l?[l]:[],onChange:s("axis_scale"),singleSelection:{asPlainText:!0}})))),Object(p.jsx)(g.EuiHorizontalRule,null),Object(p.jsx)(g.EuiFlexGroup,{responsive:!1,wrap:!0,alignItems:"center"},Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormLabel,null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.timeseries.optionsTab.backgroundColorLabel",defaultMessage:"Background color:"}))),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(y,{onChange:this.props.onChange,name:"background_color",value:e.background_color})),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormLabel,null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.timeseries.optionsTab.displayGridLabel",defaultMessage:"Display grid"}))),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(tt,{value:e.show_grid,name:"show_grid",onChange:this.props.onChange})),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormLabel,null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.timeseries.optionsTab.tooltipMode",defaultMessage:"Tooltip"}))),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiComboBox,{isClearable:!1,id:i("tooltipMode"),options:cs,selectedOptions:o?[o]:[],onChange:s("tooltip_mode"),singleSelection:{asPlainText:!0}}))),Object(p.jsx)(g.EuiFlexGroup,{responsive:!1,wrap:!0,alignItems:"center"},Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormLabel,null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.timeseries.optionsTab.showLegendLabel",defaultMessage:"Show legend?"}))),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(tt,{value:e.show_legend,name:"show_legend",onChange:this.props.onChange})),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormLabel,null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.timeseries.optionsTab.truncateLegendLabel",defaultMessage:"Truncate legend?"}))),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(tt,{value:e.truncate_legend,name:"truncate_legend",onChange:this.props.onChange,"data-test-subj":"timeSeriesEditorDataTruncateLegendSwitch"})),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormLabel,null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.timeseries.optionsTab.maxLinesLabel",defaultMessage:"Maximum legend lines"}))),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFieldNumber,{"data-test-subj":"timeSeriesEditorDataMaxLegendLines",value:e.max_lines_legend,min:1,max:5,compressed:!0,disabled:!Boolean(e.truncate_legend),onChange:e=>{const t=Number(e.target.value);this.props.onChange({max_lines_legend:Math.min(5,Math.max(t,1))})}})),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormLabel,{htmlFor:i("legendPos")},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.timeseries.optionsTab.legendPositionLabel",defaultMessage:"Legend position"}))),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiComboBox,{isClearable:!1,id:i("legendPos"),options:gs,selectedOptions:r?[r]:[],onChange:s("legend_position"),singleSelection:{asPlainText:!0}})))))}return Object(p.jsx)(n.a.Fragment,null,Object(p.jsx)(g.EuiTabs,{size:"s"},Object(p.jsx)(g.EuiTab,{isSelected:t===ds.DATA,onClick:()=>this.switchTab(ds.DATA),"data-test-subj":"timeSeriesEditorDataBtn"},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.timeseries.dataTab.dataButtonLabel",defaultMessage:"Data"})),Object(p.jsx)(g.EuiTab,{isSelected:t===ds.OPTIONS,onClick:()=>this.switchTab(ds.OPTIONS),"data-test-subj":"timeSeriesEditorPanelOptionsBtn"},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.timeseries.optionsTab.panelOptionsButtonLabel",defaultMessage:"Panel options"})),Object(p.jsx)(g.EuiTab,{isSelected:t===ds.ANNOTATIONS,onClick:()=>this.switchTab(ds.ANNOTATIONS),"data-test-subj":"timeSeriesEditorAnnotationsBtn"},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.timeseries.annotationsTab.annotationsButtonLabel",defaultMessage:"Annotations"}))),d)}}class metric_MetricPanelConfig extends l.Component{constructor(e){super(e),this.state={selectedTab:ds.DATA}}UNSAFE_componentWillMount(){const{model:e}=this.props;(!e.background_color_rules||e.background_color_rules&&0===e.background_color_rules.length)&&this.props.onChange({background_color_rules:[{id:f.a.v1()}]})}switchTab(e){this.setState({selectedTab:e})}render(){var e,t;const{selectedTab:s}=this.state,i={filter:{query:"",language:vt()},...this.props.model},a=Object(g.htmlIdGenerator)(),l=s===ds.DATA?Object(p.jsx)(series_editor_SeriesEditor,{colorPicker:!1,fields:this.props.fields,limit:L[I.e.METRIC],model:this.props.model,onChange:this.props.onChange}):Object(p.jsx)("div",{className:"tvbPanelConfig__container"},Object(p.jsx)(g.EuiPanel,null,Object(p.jsx)(g.EuiTitle,{size:"s"},Object(p.jsx)("span",null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.metric.optionsTab.dataLabel",defaultMessage:"Data"}))),Object(p.jsx)(g.EuiSpacer,{size:"m"}),Object(p.jsx)(xt,{fields:this.props.fields,model:this.props.model,onChange:this.props.onChange,allowIndexSwitchingMode:!0}),Object(p.jsx)(g.EuiHorizontalRule,null),Object(p.jsx)(g.EuiFlexGroup,{responsive:!1,wrap:!0},Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:a("panelFilter"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.metric.optionsTab.panelFilterLabel",defaultMessage:"Panel filter"}),fullWidth:!0},Object(p.jsx)(Ae,{query:{language:(null===(e=i.filter)||void 0===e?void 0:e.language)||vt(),query:(null===(t=i.filter)||void 0===t?void 0:t.query)||""},onChange:e=>{this.props.onChange({filter:e})},indexPatterns:[i.index_pattern]}))),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormRow,{label:h.i18n.translate("visTypeTimeseries.metric.optionsTab.ignoreGlobalFilterLabel",{defaultMessage:"Ignore global filter?"})},Object(p.jsx)(tt,{value:i.ignore_global_filter,name:"ignore_global_filter",onChange:this.props.onChange}))))),Object(p.jsx)(g.EuiSpacer,null),Object(p.jsx)(g.EuiPanel,null,Object(p.jsx)(g.EuiTitle,{size:"s"},Object(p.jsx)("span",null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.metric.optionsTab.colorRulesLabel",defaultMessage:"Color rules"}))),Object(p.jsx)(g.EuiSpacer,{size:"m"}),Object(p.jsx)(color_rules_ColorRules,{model:i,onChange:this.props.onChange,name:"background_color_rules"})));return Object(p.jsx)(n.a.Fragment,null,Object(p.jsx)(g.EuiTabs,{size:"s"},Object(p.jsx)(g.EuiTab,{isSelected:s===ds.DATA,onClick:()=>this.switchTab(ds.DATA),"data-test-subj":"metricEditorDataBtn"},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.metric.dataTab.dataButtonLabel",defaultMessage:"Data"})),Object(p.jsx)(g.EuiTab,{isSelected:s===ds.OPTIONS,onClick:()=>this.switchTab(ds.OPTIONS),"data-test-subj":"metricEditorPanelOptionsBtn"},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.metric.optionsTab.panelOptionsButtonLabel",defaultMessage:"Panel options"}))),l)}}class top_n_TopNPanelConfig extends l.Component{constructor(e){super(e),a()(this,"handleTextChange",(e=>t=>this.props.onChange({[e]:t.target.value}))),this.state={selectedTab:ds.DATA}}UNSAFE_componentWillMount(){const{model:e}=this.props;e.bar_color_rules&&e.bar_color_rules.length||this.props.onChange({bar_color_rules:[{id:f.a.v1()}]})}switchTab(e){this.setState({selectedTab:e})}render(){var e,t,s;const{selectedTab:i}=this.state,a={drilldown_url:"",filter:{query:"",language:vt()},...this.props.model},l=Object(g.htmlIdGenerator)(),r=i===ds.DATA?Object(p.jsx)(series_editor_SeriesEditor,{colorPicker:!1,fields:this.props.fields,model:this.props.model,onChange:this.props.onChange}):Object(p.jsx)("div",{className:"tvbPanelConfig__container"},Object(p.jsx)(g.EuiPanel,null,Object(p.jsx)(g.EuiTitle,{size:"s"},Object(p.jsx)("span",null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.topN.optionsTab.dataLabel",defaultMessage:"Data"}))),Object(p.jsx)(g.EuiSpacer,{size:"m"}),Object(p.jsx)(g.EuiFormRow,{id:l("itemUrl"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.topN.optionsTab.itemUrlLabel",defaultMessage:"Item url"}),helpText:Object(p.jsx)("span",null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.topN.optionsTab.itemUrlDescription",defaultMessage:"This supports mustache templating. {key} is set to the term.",values:{key:Object(p.jsx)(g.EuiCode,null,"{{key}}")}}))},Object(p.jsx)(g.EuiFieldText,{onChange:this.handleTextChange("drilldown_url"),value:null!==(e=a.drilldown_url)&&void 0!==e?e:""})),Object(p.jsx)(g.EuiHorizontalRule,null),Object(p.jsx)(xt,{fields:this.props.fields,model:this.props.model,onChange:this.props.onChange,allowIndexSwitchingMode:!0}),Object(p.jsx)(g.EuiHorizontalRule,null),Object(p.jsx)(g.EuiFlexGroup,{responsive:!1,wrap:!0},Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:l("panelFilter"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.topN.optionsTab.panelFilterLabel",defaultMessage:"Panel filter"}),fullWidth:!0},Object(p.jsx)(Ae,{query:{language:(null===(t=a.filter)||void 0===t?void 0:t.language)||vt(),query:(null===(s=a.filter)||void 0===s?void 0:s.query)||""},onChange:e=>{this.props.onChange({filter:e})},indexPatterns:[a.index_pattern]}))),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormRow,{label:h.i18n.translate("visTypeTimeseries.topN.optionsTab.ignoreGlobalFilterLabel",{defaultMessage:"Ignore global filter?"})},Object(p.jsx)(tt,{value:a.ignore_global_filter,name:"ignore_global_filter",onChange:this.props.onChange}))))),Object(p.jsx)(g.EuiSpacer,null),Object(p.jsx)(g.EuiPanel,null,Object(p.jsx)(g.EuiTitle,{size:"s"},Object(p.jsx)("span",null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.topN.optionsTab.styleLabel",defaultMessage:"Style"}))),Object(p.jsx)(g.EuiSpacer,{size:"m"}),Object(p.jsx)(g.EuiFlexGroup,{responsive:!1,wrap:!0,alignItems:"center"},Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormLabel,null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.topN.optionsTab.backgroundColorLabel",defaultMessage:"Background color:"}))),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(y,{onChange:this.props.onChange,name:"background_color",value:a.background_color}))),Object(p.jsx)(g.EuiHorizontalRule,null),Object(p.jsx)(g.EuiTitle,{size:"xxs"},Object(p.jsx)("span",null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.topN.optionsTab.colorRulesLabel",defaultMessage:"Color rules"}))),Object(p.jsx)(g.EuiSpacer,{size:"s"}),Object(p.jsx)(color_rules_ColorRules,{model:a,primaryVarName:"bar_color",primaryName:"bar",hideSecondary:!0,onChange:this.props.onChange,name:"bar_color_rules"})));return Object(p.jsx)(n.a.Fragment,null,Object(p.jsx)(g.EuiTabs,{size:"s"},Object(p.jsx)(g.EuiTab,{isSelected:i===ds.DATA,onClick:()=>this.switchTab(ds.DATA),"data-test-subj":"topNEditorDataBtn"},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.topN.dataTab.dataButtonLabel",defaultMessage:"Data"})),Object(p.jsx)(g.EuiTab,{isSelected:i===ds.OPTIONS,onClick:()=>this.switchTab(ds.OPTIONS),"data-test-subj":"topNEditorPanelOptionsBtn"},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.topN.optionsTab.panelOptionsButtonLabel",defaultMessage:"Panel options"}))),r)}}class table_TablePanelConfig extends l.Component{constructor(e){super(e),a()(this,"handlePivotChange",(e=>{const{fields:t,model:s}=this.props,i=e=>{const i=t[Object(se.c)(s.index_pattern)].find((t=>t.name===e));return Object(d.get)(i,"type",null)};this.props.onChange(1===e.length?{pivot_id:e[0]||void 0,pivot_type:i(e[0])||void 0}:{pivot_id:e,pivot_type:e.map((e=>i(e)))})})),a()(this,"handleTextChange",(e=>t=>this.props.onChange({[e]:t.target.value}))),this.state={selectedTab:ds.DATA}}UNSAFE_componentWillMount(){const{model:e}=this.props;e.bar_color_rules&&e.bar_color_rules.length||this.props.onChange({bar_color_rules:[{id:f.a.v1()}]})}switchTab(e){this.setState({selectedTab:e})}render(){var e,t,s,i,a;const{selectedTab:l}=this.state,r={drilldown_url:"",filter:{query:"",language:vt()},pivot_label:"",pivot_rows:10,pivot_type:"",...this.props.model},o=Object(g.htmlIdGenerator)(),d=l===ds.DATA?Object(p.jsx)("div",null,Object(p.jsx)("div",{className:"tvbPanelConfig__container"},Object(p.jsx)(g.EuiPanel,null,Object(p.jsx)(g.EuiText,null,Object(p.jsx)("p",null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.table.dataTab.defineFieldDescription",defaultMessage:"For the table visualization you need to define a field to group by using a terms aggregation."}))),Object(p.jsx)(g.EuiSpacer,{size:"m"}),Object(p.jsx)(g.EuiFlexGroup,{responsive:!1,wrap:!0},Object(p.jsx)(g.EuiFlexItem,{"data-test-subj":"groupByField"},Object(p.jsx)(Oe,{label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.table.dataTab.groupByFieldLabel",defaultMessage:"Group by field"}),restrict:[he.KBN_FIELD_TYPES.NUMBER,he.KBN_FIELD_TYPES.BOOLEAN,he.KBN_FIELD_TYPES.DATE,he.KBN_FIELD_TYPES.IP,he.KBN_FIELD_TYPES.STRING],fields:this.props.fields,value:r.pivot_id,indexPattern:r.index_pattern,onChange:this.handlePivotChange,uiRestrictions:this.context.uiRestrictions,type:I.a.TERMS,allowMultiSelect:!0,fullWidth:!0})),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:o("pivotLabelInput"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.table.dataTab.columnLabel",defaultMessage:"Column label"}),fullWidth:!0},Object(p.jsx)(g.EuiFieldText,{"data-test-subj":"columnLabelName",onChange:this.handleTextChange("pivot_label"),value:null!==(e=r.pivot_label)&&void 0!==e?e:"",fullWidth:!0}))),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormRow,{id:o("pivotRowsInput"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.table.dataTab.rowsLabel",defaultMessage:"Rows"})},Object(p.jsx)("input",{className:"tvbAgg__input",type:"number",onChange:this.handleTextChange("pivot_rows"),value:null!==(t=r.pivot_rows)&&void 0!==t?t:""})))))),Object(p.jsx)(series_editor_SeriesEditor,{fields:this.props.fields,model:this.props.model,onChange:this.props.onChange})):Object(p.jsx)("div",{className:"tvbPanelConfig__container"},Object(p.jsx)(g.EuiPanel,null,Object(p.jsx)(g.EuiTitle,{size:"s"},Object(p.jsx)("span",null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.table.optionsTab.dataLabel",defaultMessage:"Data"}))),Object(p.jsx)(g.EuiSpacer,{size:"m"}),Object(p.jsx)(g.EuiFormRow,{id:o("drilldownInput"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.table.optionsTab.itemUrlLabel",defaultMessage:"Item url"}),helpText:Object(p.jsx)("span",null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.table.optionsTab.itemUrlHelpText",defaultMessage:"This supports mustache templating. {key} is set to the term.",values:{key:Object(p.jsx)(g.EuiCode,null,"{{key}}")}}))},Object(p.jsx)(g.EuiFieldText,{onChange:this.handleTextChange("drilldown_url"),value:null!==(s=r.drilldown_url)&&void 0!==s?s:"","data-test-subj":"drilldownUrl"})),Object(p.jsx)(g.EuiHorizontalRule,null),Object(p.jsx)(xt,{fields:this.props.fields,model:this.props.model,onChange:this.props.onChange,allowIndexSwitchingMode:!0}),Object(p.jsx)(g.EuiHorizontalRule,null),Object(p.jsx)(g.EuiFlexGroup,{responsive:!1,wrap:!0},Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:o("panelFilterInput"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.table.optionsTab.panelFilterLabel",defaultMessage:"Panel filter"}),fullWidth:!0},Object(p.jsx)(Ae,{query:{language:(null===(i=r.filter)||void 0===i?void 0:i.language)||vt(),query:(null===(a=r.filter)||void 0===a?void 0:a.query)||""},onChange:e=>{this.props.onChange({filter:e})},indexPatterns:[r.index_pattern]}))),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormRow,{label:h.i18n.translate("visTypeTimeseries.table.optionsTab.ignoreGlobalFilterLabel",{defaultMessage:"Ignore global filter?"})},Object(p.jsx)(tt,{value:r.ignore_global_filter,name:"ignore_global_filter",onChange:this.props.onChange}))))));return Object(p.jsx)(n.a.Fragment,null,Object(p.jsx)(g.EuiTabs,{size:"s"},Object(p.jsx)(g.EuiTab,{isSelected:l===ds.DATA,onClick:()=>this.switchTab(ds.DATA),"data-test-subj":"tableEditorDataBtn"},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.table.dataTab.columnsButtonLabel",defaultMessage:"Columns"})),Object(p.jsx)(g.EuiTab,{isSelected:l===ds.OPTIONS,onClick:()=>this.switchTab(ds.OPTIONS),"data-test-subj":"tableEditorPanelOptionsBtn"},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.table.optionsTab.panelOptionsButtonLabel",defaultMessage:"Panel options"}))),d)}}a()(table_TablePanelConfig,"contextType",v);class gauge_GaugePanelConfig extends l.Component{constructor(e){super(e),a()(this,"handleTextChange",(e=>t=>this.props.onChange({[e]:t.target.value}))),this.state={selectedTab:ds.DATA}}UNSAFE_componentWillMount(){const{model:e}=this.props,t={};e.gauge_color_rules&&e.gauge_color_rules.length||(t.gauge_color_rules=[{id:f.a.v1()}]),null==e.gauge_width&&(t.gauge_width=10),null==e.gauge_inner_width&&(t.gauge_inner_width=10),null==e.gauge_style&&(t.gauge_style="half"),this.props.onChange(t)}switchTab(e){this.setState({selectedTab:e})}render(){var e,t;const{selectedTab:s}=this.state,i={gauge_max:"",filter:{query:"",language:vt()},gauge_style:"circle",gauge_inner_width:"",gauge_width:"",...this.props.model},a=ee(this.props.onChange),l=[{label:h.i18n.translate("visTypeTimeseries.gauge.styleOptions.circleLabel",{defaultMessage:"Circle"}),value:"circle"},{label:h.i18n.translate("visTypeTimeseries.gauge.styleOptions.halfCircleLabel",{defaultMessage:"Half Circle"}),value:"half"}],r=Object(g.htmlIdGenerator)(),o=l.find((e=>i.gauge_style===e.value)),d=s===ds.DATA?Object(p.jsx)(series_editor_SeriesEditor,{colorPicker:!0,fields:this.props.fields,limit:L[I.e.GAUGE],model:this.props.model,onChange:this.props.onChange}):Object(p.jsx)("div",{className:"tvbPanelConfig__container"},Object(p.jsx)(g.EuiPanel,null,Object(p.jsx)(g.EuiTitle,{size:"s"},Object(p.jsx)("span",null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.gauge.optionsTab.dataLabel",defaultMessage:"Data"}))),Object(p.jsx)(g.EuiSpacer,{size:"m"}),Object(p.jsx)(xt,{fields:this.props.fields,model:this.props.model,onChange:this.props.onChange,allowIndexSwitchingMode:!0}),Object(p.jsx)(g.EuiHorizontalRule,null),Object(p.jsx)(g.EuiFlexGroup,{responsive:!1,wrap:!0},Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:r("panelFilter"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.gauge.optionsTab.panelFilterLabel",defaultMessage:"Panel filter"}),fullWidth:!0},Object(p.jsx)(Ae,{query:{language:(null===(e=i.filter)||void 0===e?void 0:e.language)||vt(),query:(null===(t=i.filter)||void 0===t?void 0:t.query)||""},onChange:e=>{this.props.onChange({filter:e})},indexPatterns:[i.index_pattern]}))),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormRow,{label:h.i18n.translate("visTypeTimeseries.gauge.optionsTab.ignoreGlobalFilterLabel",{defaultMessage:"Ignore global filter?"})},Object(p.jsx)(tt,{value:i.ignore_global_filter,name:"ignore_global_filter",onChange:this.props.onChange}))))),Object(p.jsx)(g.EuiSpacer,null),Object(p.jsx)(g.EuiPanel,null,Object(p.jsx)(g.EuiTitle,{size:"s"},Object(p.jsx)("span",null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.gauge.optionsTab.styleLabel",defaultMessage:"Style"}))),Object(p.jsx)(g.EuiSpacer,{size:"m"}),Object(p.jsx)(g.EuiFlexGroup,{responsive:!1,wrap:!0},Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:r("gaugeMax"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.gauge.optionsTab.gaugeMaxLabel",defaultMessage:"Gauge max (empty for auto)"})},Object(p.jsx)(g.EuiFieldNumber,{onChange:this.handleTextChange("gauge_max"),value:i.gauge_max}))),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:r("gaugeStyle"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.gauge.optionsTab.gaugeStyleLabel",defaultMessage:"Gauge style"})},Object(p.jsx)(g.EuiComboBox,{isClearable:!1,options:l,selectedOptions:o?[o]:[],onChange:a("gauge_style"),singleSelection:{asPlainText:!0}}))),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:r("innerLine"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.gauge.optionsTab.innerLineWidthLabel",defaultMessage:"Inner line width"})},Object(p.jsx)(g.EuiFieldNumber,{onChange:this.handleTextChange("gauge_inner_width"),value:Number(i.gauge_inner_width)}))),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:r("gaugeLine"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.gauge.optionsTab.gaugeLineWidthLabel",defaultMessage:"Gauge line width"})},Object(p.jsx)(g.EuiFieldNumber,{onChange:this.handleTextChange("gauge_width"),value:Number(i.gauge_width)})))),Object(p.jsx)(g.EuiHorizontalRule,null),Object(p.jsx)(g.EuiFlexGroup,{responsive:!1,wrap:!0,alignItems:"center"},Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormLabel,null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.gauge.optionsTab.backgroundColorLabel",defaultMessage:"Background color:"}))),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(y,{onChange:this.props.onChange,name:"background_color",value:i.background_color})),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormLabel,null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.gauge.optionsTab.innerColorLabel",defaultMessage:"Inner color:"}))),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(y,{onChange:this.props.onChange,name:"gauge_inner_color",value:i.gauge_inner_color}))),Object(p.jsx)(g.EuiHorizontalRule,null),Object(p.jsx)(g.EuiTitle,{size:"xxs"},Object(p.jsx)("span",null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.gauge.optionsTab.colorRulesLabel",defaultMessage:"Color rules"}))),Object(p.jsx)(g.EuiSpacer,{size:"s"}),Object(p.jsx)(color_rules_ColorRules,{primaryName:"gauge color",primaryVarName:"gauge",secondaryName:"text color",secondaryVarName:"text",model:i,onChange:this.props.onChange,name:"gauge_color_rules"})));return Object(p.jsx)(n.a.Fragment,null,Object(p.jsx)(g.EuiTabs,{size:"s"},Object(p.jsx)(g.EuiTab,{isSelected:s===ds.DATA,onClick:()=>this.switchTab(ds.DATA),"data-test-subj":"gaugeEditorDataBtn"},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.gauge.dataTab.dataButtonLabel",defaultMessage:"Data"})),Object(p.jsx)(g.EuiTab,{isSelected:s===ds.OPTIONS,onClick:()=>this.switchTab(ds.OPTIONS),"data-test-subj":"gaugeEditorPanelOptionsBtn"},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.gauge.optionsTab.panelOptionsButtonLabel",defaultMessage:"Panel options"}))),d)}}var js=s(53),ps=s(76);class markdown_editor_MarkdownEditor extends l.Component{constructor(e){super(e),a()(this,"handleChange",(e=>{this.props.onChange({markdown:e})})),a()(this,"handleOnLoad",(e=>{this.editor=e})),a()(this,"handleVarClick",(e=>()=>{if(this.editor){const t=this.editor.getSelection();this.editor.executeEdits("",[{range:t,text:e}])}})),this.state={fieldFormatMap:void 0}}async componentDidMount(){const e=Object(we.d)(),{indexPattern:t}=await Object(se.b)(this.props.model.index_pattern,e);this.setState({fieldFormatMap:null==t?void 0:t.fieldFormatMap})}render(){const{visData:e,model:t,getConfig:s}=this.props;if(!e)return null;const i=u.a.get(e,`${t.id}.series`,[]),a=Object(ps.a)(i,t,s,this.state.fieldFormatMap),l=[],n=Object(js.a)("0.[0000]",null,s),r=e=>{const t=`{{ ${e} }}`;let s=u.a.get(a,e);/raw$/.test(e)&&(s=n(s)),l.push(Object(p.jsx)("tr",{key:e},Object(p.jsx)("td",null,Object(p.jsx)("a",{onClick:this.handleVarClick(t)},t)),Object(p.jsx)("td",null,Object(p.jsx)("code",null,"“",s,"”"))))},o=e=>{const t=`{{# ${e} }}{{/ ${e} }}`,s=u.a.get(a,`${e}[0][0]`);let i=u.a.get(a,`${e}[0][1]`);/raw$/.test(e)&&(i=n(i)),l.push(Object(p.jsx)("tr",{key:e},Object(p.jsx)("td",null,Object(p.jsx)("a",{onClick:this.handleVarClick(t)},`{{ ${e} }}`)),Object(p.jsx)("td",null,Object(p.jsx)("code",null,"[ [ “",s,"”, “",i,"” ], ... ]"))))};return function e(t,s=[]){for(const i in t)Array.isArray(t[i])?o(s.concat(i).join(".")):u.a.isObject(t[i])?e(t[i],s.concat(i)):r(s.concat(i).join("."))}(a),Object(p.jsx)("div",{className:"tvbMarkdownEditor"},Object(p.jsx)("div",{className:"tvbMarkdownEditor__editor"},Object(p.jsx)(c.CodeEditor,{editorDidMount:this.handleOnLoad,languageId:c.MarkdownLang,options:{fontSize:"14px",wordWrap:"on"},value:t.markdown,onChange:this.handleChange})),Object(p.jsx)("div",{className:"tvbMarkdownEditor__variables"},Object(p.jsx)(g.EuiText,null,Object(p.jsx)("p",null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.markdownEditor.howToUseVariablesInMarkdownDescription",defaultMessage:"The following variables can be used in the Markdown by using the Handlebar (mustache) syntax. {handlebarLink} on the available expressions.",values:{handlebarLink:Object(p.jsx)("a",{href:"https://ela.st/handlebars-docs",target:"_BLANK",rel:"noreferrer noopener"},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.markdownEditor.howUseVariablesInMarkdownDescription.documentationLinkText",defaultMessage:"Click here for documentation"}))}}))),Object(p.jsx)("table",{className:"table","data-test-subj":"tsvbMarkdownVariablesTable"},Object(p.jsx)("thead",null,Object(p.jsx)("tr",null,Object(p.jsx)("th",{scope:"col"},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.markdownEditor.nameLabel",defaultMessage:"Name"})),Object(p.jsx)("th",{scope:"col"},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.markdownEditor.valueLabel",defaultMessage:"Value"})))),Object(p.jsx)("tbody",null,l)),0===l.length&&Object(p.jsx)(g.EuiTitle,{size:"xxs",className:"tsvbMarkdownVariablesTable__noVariables","data-test-subj":"tvbMarkdownEditor__noVariables"},Object(p.jsx)("span",null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.markdownEditor.noVariablesAvailableDescription",defaultMessage:"No variables available for the selected data metrics."}))),Object(p.jsx)(g.EuiSpacer,null),Object(p.jsx)(g.EuiText,null,Object(p.jsx)("p",null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.markdownEditor.howToAccessEntireTreeDescription",defaultMessage:"There is also a special variable named {all} which you can use to access the entire tree. This is useful for creating lists with data from a group by:",values:{all:Object(p.jsx)("code",null,"_all")}}))),Object(p.jsx)(g.EuiSpacer,null),Object(p.jsx)(g.EuiCodeBlock,null,"# All servers:\n\n    {{#each _all}}\n    - {{ label }} {{ last.formatted }}\n    {{/each}}")))}}class markdown_MarkdownPanelConfig extends l.Component{constructor(e){super(e),this.state={selectedTab:ds.MARKDOWN},this.handleCSSChange=this.handleCSSChange.bind(this)}switchTab(e){this.setState({selectedTab:e})}handleCSSChange(e){this.props.onChange({markdown_css:e})}render(){const e={filter:{query:"",language:vt()},...this.props.model},{selectedTab:t}=this.state,s=ee(this.props.onChange),i=Object(g.htmlIdGenerator)(),a=[{label:h.i18n.translate("visTypeTimeseries.markdown.alignOptions.topLabel",{defaultMessage:"Top"}),value:"top"},{label:h.i18n.translate("visTypeTimeseries.markdown.alignOptions.middleLabel",{defaultMessage:"Middle"}),value:"middle"},{label:h.i18n.translate("visTypeTimeseries.markdown.alignOptions.bottomLabel",{defaultMessage:"Bottom"}),value:"bottom"}],l=a.find((t=>e.markdown_vertical_align===t.value));let r;if(t===ds.MARKDOWN)r=Object(p.jsx)(v.Consumer,null,(e=>Object(p.jsx)(markdown_editor_MarkdownEditor,_()({visData:e},this.props))));else if(t===ds.DATA)r=Object(p.jsx)(series_editor_SeriesEditor,{colorPicker:!1,fields:this.props.fields,model:this.props.model,onChange:this.props.onChange});else{var o,d,u;r=Object(p.jsx)("div",{className:"tvbPanelConfig__container"},Object(p.jsx)(g.EuiPanel,null,Object(p.jsx)(g.EuiTitle,{size:"s"},Object(p.jsx)("span",null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.markdown.optionsTab.dataLabel",defaultMessage:"Data"}))),Object(p.jsx)(g.EuiSpacer,{size:"m"}),Object(p.jsx)(xt,{fields:this.props.fields,model:this.props.model,onChange:this.props.onChange,allowIndexSwitchingMode:!0}),Object(p.jsx)(g.EuiHorizontalRule,null),Object(p.jsx)(g.EuiFlexGroup,{responsive:!1,wrap:!0},Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiFormRow,{id:i("panelFilter"),label:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.markdown.optionsTab.panelFilterLabel",defaultMessage:"Panel filter"}),fullWidth:!0},Object(p.jsx)(Ae,{query:{language:(null===(o=e.filter)||void 0===o?void 0:o.language)||vt(),query:(null===(d=e.filter)||void 0===d?void 0:d.query)||""},onChange:e=>{this.props.onChange({filter:e})},indexPatterns:[e.index_pattern]}))),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormRow,{label:h.i18n.translate("visTypeTimeseries.markdown.optionsTab.ignoreGlobalFilterLabel",{defaultMessage:"Ignore global filter?"})},Object(p.jsx)(tt,{value:e.ignore_global_filter,name:"ignore_global_filter",onChange:this.props.onChange}))))),Object(p.jsx)(g.EuiSpacer,null),Object(p.jsx)(g.EuiPanel,null,Object(p.jsx)(g.EuiTitle,{size:"s"},Object(p.jsx)("span",null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.markdown.optionsTab.styleLabel",defaultMessage:"Style"}))),Object(p.jsx)(g.EuiSpacer,{size:"m"}),Object(p.jsx)(g.EuiFlexGroup,{responsive:!1,wrap:!0,alignItems:"center"},Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormLabel,null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.markdown.optionsTab.backgroundColorLabel",defaultMessage:"Background color:"}))),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(y,{onChange:this.props.onChange,name:"background_color",value:e.background_color})),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormRow,{label:h.i18n.translate("visTypeTimeseries.markdown.optionsTab.showScrollbarsLabel",{defaultMessage:"Show scrollbars?"})},Object(p.jsx)(tt,{value:e.markdown_scrollbars,name:"markdown_scrollbars",onChange:this.props.onChange}))),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormRow,{label:h.i18n.translate("visTypeTimeseries.markdown.optionsTab.openLinksInNewTab",{defaultMessage:"Open links in new tab?"})},Object(p.jsx)(tt,{value:e.markdown_openLinksInNewTab,name:"markdown_openLinksInNewTab",onChange:this.props.onChange}))),Object(p.jsx)(g.EuiFlexItem,{grow:!1},Object(p.jsx)(g.EuiFormLabel,{htmlFor:i("valign")},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.markdown.optionsTab.verticalAlignmentLabel",defaultMessage:"Vertical alignment:"}))),Object(p.jsx)(g.EuiFlexItem,null,Object(p.jsx)(g.EuiComboBox,{id:i("valign"),isClearable:!1,options:a,selectedOptions:l?[l]:[],onChange:s("markdown_vertical_align"),singleSelection:{asPlainText:!0}}))),Object(p.jsx)(g.EuiHorizontalRule,null),Object(p.jsx)(g.EuiTitle,{size:"xxs"},Object(p.jsx)("span",null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.markdown.optionsTab.customCSSLabel",defaultMessage:"Custom CSS",description:"CSS is name of technology and should not be translated."}))),Object(p.jsx)(g.EuiSpacer,{size:"s"}),Object(p.jsx)(c.CodeEditor,{height:"500px",languageId:c.CssLang,options:{fontSize:14},value:null!==(u=e.markdown_css)&&void 0!==u?u:"",onChange:this.handleCSSChange})))}return Object(p.jsx)(n.a.Fragment,null,Object(p.jsx)(g.EuiTabs,{size:"s"},Object(p.jsx)(g.EuiTab,{isSelected:t===ds.MARKDOWN,onClick:()=>this.switchTab(ds.MARKDOWN),"data-test-subj":"markdown-subtab"},"Markdown"),Object(p.jsx)(g.EuiTab,{"data-test-subj":"data-subtab",isSelected:t===ds.DATA,onClick:()=>this.switchTab(ds.DATA)},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.markdown.dataTab.dataButtonLabel",defaultMessage:"Data"})),Object(p.jsx)(g.EuiTab,{isSelected:t===ds.OPTIONS,onClick:()=>this.switchTab(ds.OPTIONS),"data-test-subj":"options-subtab"},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.markdown.optionsTab.panelOptionsButtonLabel",defaultMessage:"Panel options"}))),r)}}const ms={timeseries:timeseries_TimeseriesPanelConfig,table:table_TablePanelConfig,metric:metric_MetricPanelConfig,top_n:top_n_TopNPanelConfig,gauge:gauge_GaugePanelConfig,markdown:markdown_MarkdownPanelConfig};function xs(e){const{model:t,onChange:s}=e,i=ms[t.type],a=Object(l.useRef)({}),[n,r]=Object(l.useState)({});Object(l.useEffect)((()=>{const t=e.visData$.subscribe(((e={})=>r(e)));return()=>t.unsubscribe()}),[t.id,e.visData$]);const o=Object(l.useCallback)(((e,t)=>{var i;a.current[e]=t,s({isModelInvalid:(i=a.current,!Object.values(i).every((e=>e)))})}),[s]);return i?Object(p.jsx)(x.Provider,{value:o},Object(p.jsx)(O.Provider,{value:t},Object(p.jsx)(v.Provider,{value:n},Object(p.jsx)("div",{"data-test-subj":`tvbPanelConfig__${t.type}`},Object(p.jsx)(i,e))))):Object(p.jsx)("div",null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.missingPanelConfigDescription",defaultMessage:"Missing panel config for “{modelType}”",values:{modelType:t.type}}))}const vs=[{type:I.e.TIMESERIES,label:h.i18n.translate("visTypeTimeseries.visPicker.timeSeriesLabel",{defaultMessage:"Time Series"})},{type:I.e.METRIC,label:h.i18n.translate("visTypeTimeseries.visPicker.metricLabel",{defaultMessage:"Metric"})},{type:I.e.TOP_N,label:h.i18n.translate("visTypeTimeseries.visPicker.topNLabel",{defaultMessage:"Top N"})},{type:I.e.GAUGE,label:h.i18n.translate("visTypeTimeseries.visPicker.gaugeLabel",{defaultMessage:"Gauge"})},{type:I.e.MARKDOWN,label:"Markdown"},{type:I.e.TABLE,label:h.i18n.translate("visTypeTimeseries.visPicker.tableLabel",{defaultMessage:"Table"})}],Os=({onChange:e,currentVisType:t})=>Object(p.jsx)(g.EuiTabs,{size:"l"},vs.map((({label:s,type:i})=>Object(p.jsx)(g.EuiTab,{key:i,isSelected:i===t,onClick:()=>e({type:i}),"data-test-subj":`${i}TsvbTypeBtn`},s))));async function hs(e=[],t){const s=Array.isArray(e)?e:[e],i=Object(we.b)(),a=i.uiSettings.get("defaultIndex");try{const e=await Promise.all(s.map((async e=>{try{return"string"!=typeof e&&null!=e&&e.id?Object(q.f)((await Object(we.d)().get(e.id)).getNonScriptedFields()):i.http.get(Ee.b.FIELDS,{query:{index:`${null!=e?e:""}`},signal:t})}catch(e){return[]}})));return s.reduce(((t,s,i)=>{const l=Object(se.c)(s);return{...t,[l]:e[i],...l===a?{"":e[i]}:{}}}),{})}catch(e){"AbortError"!==e.name&&Object(we.b)().notifications.toasts.addDanger({title:h.i18n.translate("visTypeTimeseries.fetchFields.loadIndexPatternFieldsErrorMessage",{defaultMessage:"Unable to load index_pattern fields"}),text:e.message})}return{}}var Ts=s(142),fs=s.n(Ts);const Es=()=>{const[e,t]=fs()("TSVB_INDEX_PATTERN_CALLOUT_HIDDEN",!1),s=Object(l.useMemo)((()=>Object(we.b)().docLinks.links.visualize.tsvbIndexPatternMode),[]),i=Object(l.useCallback)((()=>{t(!0)}),[t]);return e?null:Object(p.jsx)(g.EuiCallOut,{title:Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.visEditorVisualization.dataViewMode.notificationTitle",defaultMessage:"TSVB supports data views"}),iconType:"cheer",size:"s"},Object(p.jsx)("p",null,Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.visEditorVisualization.dataViewMode.notificationMessage",defaultMessage:"Great news! You can visualize the data from Kibana data views (recommended) or Elasticsearch indices. {indexPatternModeLink}.",values:{indexPatternModeLink:Object(p.jsx)(g.EuiLink,{href:s,target:"_blank",external:!0},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.visEditorVisualization.dataViewMode.link",defaultMessage:"Check it out."}))}})),Object(p.jsx)(g.EuiFlexGroup,{gutterSize:"none"},Object(p.jsx)(g.EuiButton,{size:"s",onClick:i},Object(p.jsx)(j.FormattedMessage,{id:"visTypeTimeseries.visEditorVisualization.dataViewMode.dismissNoticeButtonText",defaultMessage:"Dismiss"}))))};class vis_editor_VisEditor extends l.Component{constructor(e){super(e),a()(this,"abortControllerFetchFields",void 0),a()(this,"localStorage",void 0),a()(this,"visDataSubject",void 0),a()(this,"visData$",void 0),a()(this,"getConfig",(e=>this.props.config.get(e))),a()(this,"updateVisState",Object(d.debounce)((()=>{this.props.vis.params=this.state.model,this.props.embeddableHandler.reload(),this.props.eventEmitter.emit("dirtyStateChange",{isDirty:!1})}),200)),a()(this,"abortableFetchFields",(e=>{var t;return null===(t=this.abortControllerFetchFields)||void 0===t||t.abort(),this.abortControllerFetchFields=new AbortController,hs(e,this.abortControllerFetchFields.signal)})),a()(this,"handleChange",(e=>{if(Object(d.isEmpty)(e))return;const t=e.type&&this.state.model.type!==e.type;let s=!0;(this.state.autoApply||t)&&(this.updateVisState(),s=!1);const i={...this.state.model,...e},a=Object(se.a)(i,this.getDefaultIndex());Object(d.isEqual)(this.state.extractedIndexPatterns,a)||this.abortableFetchFields(a).then((e=>{this.setState({visFields:e,extractedIndexPatterns:a})})),this.setState({dirty:s,model:i})})),a()(this,"updateModel",(()=>{const{params:e}=this.props.vis.clone();this.setState({model:e})})),a()(this,"handleCommit",(()=>{this.updateVisState(),this.setState({dirty:!1})})),a()(this,"handleAutoApplyToggle",(e=>{this.setState({autoApply:e.target.checked})})),a()(this,"onDataChange",(e=>{this.visDataSubject.next(null==e?void 0:e.visData)})),this.localStorage=new b.Storage(window.localStorage),this.state={autoApply:!0,dirty:!1,model:{[I.g]:this.props.vis.title&&"timeseries"!==this.props.vis.params.type?I.f.LAST_VALUE:I.f.ENTIRE_TIME_RANGE,...this.props.vis.params,series:this.props.vis.params.series.map((e=>({[I.g]:this.props.vis.title&&"timeseries"!==this.props.vis.params.type&&e.override_index_pattern?I.f.LAST_VALUE:I.f.ENTIRE_TIME_RANGE,...e})))},extractedIndexPatterns:[""]},this.visDataSubject=new r.BehaviorSubject(void 0),this.visData$=this.visDataSubject.asObservable().pipe(Object(o.share)())}render(){const{model:e,visFields:t}=this.state;return t?Object(p.jsx)(c.KibanaContextProvider,{services:{appName:"VisEditor",storage:this.localStorage,data:Object(we.c)(),...Object(we.b)()}},Object(p.jsx)("div",{className:"tvbEditor","data-test-subj":"tvbVisEditor"},!this.props.vis.params.use_kibana_indexes&&Object(p.jsx)(Es,null),Object(p.jsx)("div",{className:"tvbEditor--hideForReporting"},Object(p.jsx)(Os,{currentVisType:e.type,onChange:this.handleChange})),Object(p.jsx)(m,{dirty:this.state.dirty,autoApply:this.state.autoApply,model:e,embeddableHandler:this.props.embeddableHandler,eventEmitter:this.props.eventEmitter,vis:this.props.vis,timeRange:this.props.timeRange,filters:this.props.filters,query:this.props.query,uiState:this.props.uiState,onCommit:this.handleCommit,onToggleAutoApply:this.handleAutoApplyToggle,title:this.props.vis.title,description:this.props.vis.description,onDataChange:this.onDataChange}),Object(p.jsx)("div",{className:"tvbEditor--hideForReporting"},Object(p.jsx)(xs,{fields:t,model:e,visData$:this.visData$,onChange:this.handleChange,getConfig:this.getConfig,defaultIndexPattern:this.props.defaultIndexPattern})))):null}async componentDidMount(){const e=Object(se.a)(this.props.vis.params,this.getDefaultIndex()),t=await hs(e);this.setState({visFields:t}),this.props.eventEmitter.on("updateEditor",this.updateModel)}componentWillUnmount(){var e;this.updateVisState.cancel(),null===(e=this.abortControllerFetchFields)||void 0===e||e.abort(),this.props.eventEmitter.off("updateEditor",this.updateModel)}getDefaultIndex(){var e;return null!==(e=this.props.config.get("defaultIndex"))&&void 0!==e?e:""}}},44:function(e,t,s){var i=s(97),a=s(11),l=a;l.v1=i,l.v4=a,e.exports=l},46:function(e,t,s){e.exports=s(23)(3)},47:function(e,t,s){"use strict";var i=s(57);s.d(t,"a",(function(){return i.b})),s.d(t,"c",(function(){return i.c})),s.d(t,"d",(function(){return i.d})),s.d(t,"e",(function(){return i.e})),s.d(t,"f",(function(){return i.f})),s.d(t,"g",(function(){return i.g}));var a=s(61);s.d(t,"b",(function(){return a.a}))},50:function(e,t,s){"use strict";s.d(t,"c",(function(){return n})),s.d(t,"f",(function(){return r})),s.d(t,"d",(function(){return o})),s.d(t,"e",(function(){return d})),s.d(t,"b",(function(){return u})),s.d(t,"a",(function(){return c}));var i=s(2),a=s(29),l=s(19);const n=(e,t,s=!0)=>{if(e.length&&t){const i=e.find((e=>e.name===t));if(i)return i.label||i.name;if(s)throw new l.b(t)}return t},r=e=>e.filter((e=>e.aggregatable&&!Object(a.isNestedField)(e))).map((e=>{var t;return{name:e.name,label:null!==(t=e.customLabel)&&void 0!==t?t:e.name,type:e.type}})),o=e=>e?[e].flat().filter(Boolean):[],d=(e,t)=>{const s=t?n(t,e[0]):e[0];return e.length>1?i.i18n.translate("visTypeTimeseries.fieldUtils.multiFieldLabel",{defaultMessage:"{firstFieldLabel} + {count} {count, plural, one {other} other {others}}",values:{firstFieldLabel:s,count:e.length-1}}):null!=s?s:""},u=(e,t,s,i,a=[])=>{const l=new Map;return(n,r,o="text")=>{var d,u;const c=l.get(n),b=e=>e.convert(r,o,i?{timezone:i.timezone}:void 0);if(c)return b(c);if(e&&!a.includes(null===(d=e.fieldFormatMap)||void 0===d||null===(u=d[n])||void 0===u?void 0:u.id)){const t=e.fields.getByName(n);if(t){const s=e.getFormatterForField(t);if(s)return l.set(n,s),b(s)}}else if(s&&t){const e=t.find((e=>e.name===n));if(e){const t=s.getDefaultInstance(e.type);if(t)return l.set(n,t),b(t)}}}},c=" › "},51:function(e,t,s){"use strict";var i,a=function(){var e={};return function(t){if(void 0===e[t]){var s=document.querySelector(t);if(window.HTMLIFrameElement&&s instanceof window.HTMLIFrameElement)try{s=s.contentDocument.head}catch(e){s=null}e[t]=s}return e[t]}}(),l=[];function n(e){for(var t=-1,s=0;s<l.length;s++)if(l[s].identifier===e){t=s;break}return t}function r(e,t){for(var s={},i=[],a=0;a<e.length;a++){var r=e[a],o=t.base?r[0]+t.base:r[0],d=s[o]||0,u="".concat(o," ").concat(d);s[o]=d+1;var c=n(u),b={css:r[1],media:r[2],sourceMap:r[3]};-1!==c?(l[c].references++,l[c].updater(b)):l.push({identifier:u,updater:p(b,t),references:1}),i.push(u)}return i}function o(e){var t=document.createElement("style"),i=e.attributes||{};if(void 0===i.nonce){var l=s.nc;l&&(i.nonce=l)}if(Object.keys(i).forEach((function(e){t.setAttribute(e,i[e])})),"function"==typeof e.insert)e.insert(t);else{var n=a(e.insert||"head");if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(t)}return t}var d,u=(d=[],function(e,t){return d[e]=t,d.filter(Boolean).join("\n")});function c(e,t,s,i){var a=s?"":i.media?"@media ".concat(i.media," {").concat(i.css,"}"):i.css;if(e.styleSheet)e.styleSheet.cssText=u(t,a);else{var l=document.createTextNode(a),n=e.childNodes;n[t]&&e.removeChild(n[t]),n.length?e.insertBefore(l,n[t]):e.appendChild(l)}}function b(e,t,s){var i=s.css,a=s.media,l=s.sourceMap;if(a?e.setAttribute("media",a):e.removeAttribute("media"),l&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(l))))," */")),e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}var g=null,j=0;function p(e,t){var s,i,a;if(t.singleton){var l=j++;s=g||(g=o(t)),i=c.bind(null,s,l,!1),a=c.bind(null,s,l,!0)}else s=o(t),i=b.bind(null,s,t),a=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(s)};return i(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;i(e=t)}else a()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===i&&(i=Boolean(window&&document&&document.all&&!window.atob)),i));var s=r(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var i=0;i<s.length;i++){var a=n(s[i]);l[a].references--}for(var o=r(e,t),d=0;d<s.length;d++){var u=n(s[d]);0===l[u].references&&(l[u].updater(),l.splice(u,1))}s=o}}}},52:function(e,t,s){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var s=function(e,t){var s,i,a,l=e[1]||"",n=e[3];if(!n)return l;if(t&&"function"==typeof btoa){var r=(s=n,i=btoa(unescape(encodeURIComponent(JSON.stringify(s)))),a="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(i),"/*# ".concat(a," */")),o=n.sources.map((function(e){return"/*# sourceURL=".concat(n.sourceRoot||"").concat(e," */")}));return[l].concat(o).concat([r]).join("\n")}return[l].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(s,"}"):s})).join("")},t.i=function(e,s,i){"string"==typeof e&&(e=[[null,e,""]]);var a={};if(i)for(var l=0;l<this.length;l++){var n=this[l][0];null!=n&&(a[n]=!0)}for(var r=0;r<e.length;r++){var o=[].concat(e[r]);i&&a[o[0]]||(s&&(o[2]?o[2]="".concat(s," and ").concat(o[2]):o[2]=s),t.push(o))}},t}},54:function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));const i=["#68BC00","#009CE0","#B0BC00","#16A5A5","#D33115","#E27300","#FCC400","#7B64FF","#FA28FF","#333333","#808080","#194D33","#0062B1","#808900","#0C797D","#9F0500","#C45100","#FB9E00","#653294","#AB149E","#0F1419","#666666"]},55:function(e,t,s){"use strict";s.d(t,"a",(function(){return l}));var i=s(56),a=s.n(i);const l=e=>{let t=new a.a(e);const s=t.hsl().object();return s.l-=100*t.luminosity(),t=a.a.hsl(s),t.rgb().toString()}},57:function(e,t,s){"use strict";s.d(t,"a",(function(){return i})),s.d(t,"b",(function(){return a})),s.d(t,"e",(function(){return l})),s.d(t,"d",(function(){return n})),s.d(t,"g",(function(){return r})),s.d(t,"f",(function(){return o})),s.d(t,"c",(function(){return d}));const i={LINE_COLOR:"rgba(105,112,125,0.2)",TEXT_COLOR:"rgba(0,0,0,0.4)",TEXT_COLOR_REVERSED:"rgba(255,255,255,0.5)",VALUE_COLOR:"rgba(0,0,0,0.7)",VALUE_COLOR_REVERSED:"rgba(255,255,255,0.8)"},a={stroke:"rgba(125,125,125,0.1)"},l=0,n=[0],r=[1],o=[2],d={NONE:"none",PERCENT:"percent",STACKED:"stacked",STACKED_WITHIN_SERIES:"stacked_within_series"}},61:function(e,t,s){"use strict";s.d(t,"a",(function(){return a})),s(5);var i=s(1);const a={"fa-asterisk":"asterisk","fa-bell":"bell","fa-bolt":"bolt","fa-bomb":()=>Object(i.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},Object(i.jsx)("path",{d:"M3.92176768,4.53361616 L3.46466635,5.59664282 L2.65302767,4.14840719 L0.999875397,3.99598886 L2.12641918,2.77654518 L1.76052549,1.15720408 L3.26840652,1.85178207 L4.69542405,1.00339256 L4.500802,2.65210905 L5.74864103,3.7471166 L4.73514583,3.9490388 L5.61669633,5.03766301 C6.0459022,4.69009896 6.67559863,4.75628272 7.02316269,5.18548858 L7.15815921,5.3521954 C7.8837785,5.06498672 8.68754455,4.943927 9.51742529,5.03115098 C12.2637217,5.31979836 14.2560398,7.78010639 13.9673924,10.5264028 C13.6787451,13.2726992 11.218437,15.2650173 8.47214065,14.9763699 C5.72584427,14.6877226 3.73352611,12.2274145 4.02217349,9.48111814 C4.10939747,8.6512374 4.39492411,7.8902053 4.82672133,7.24015658 L4.6917248,7.07344975 C4.34416075,6.64424389 4.41034451,6.01454746 4.83955037,5.6669834 L3.92176768,4.53361616 Z M5.46887076,6.44412936 L6.12580983,7.24015658 C6.03489722,7.30663504 5.87952666,7.491071 5.65969815,7.79346445 C5.30650784,8.32517447 5.08508565,8.93495668 5.01669539,9.5856466 C4.78577748,11.7826837 6.37963201,13.7509301 8.57666912,13.981848 C10.7737062,14.2127659 12.7419526,12.6189114 12.9728706,10.4218743 C13.2037885,8.2248372 11.6099339,6.25659078 9.41289682,6.02567287 C8.7622069,5.95728261 8.11971364,6.04708534 7.52619036,6.28200886 C7.24048061,6.40187373 7.0242157,6.5121707 6.87739563,6.61289978 L6.24601673,5.81480897 L5.46887076,6.44412936 Z M3.34009664,3.61834468 C3.6160708,3.60870745 3.83197954,3.37717367 3.82234231,3.10119951 C3.81270508,2.82522536 3.5811713,2.60931662 3.30519715,2.61895385 C3.02922299,2.62859108 2.81331425,2.86012485 2.82295148,3.13609901 C2.83258871,3.41207317 3.06412249,3.62798191 3.34009664,3.61834468 Z M9.2038399,8.01471666 C8.92921026,7.98585193 8.72997844,7.73982112 8.75884318,7.46519148 C8.78770792,7.19056185 9.03373872,6.99133003 9.30836836,7.02019477 C10.7411945,7.17079087 11.8319627,8.30660625 11.9782919,9.68376241 C11.9842403,9.72621687 11.9855849,9.77015886 11.9808868,9.81485847 C11.9520221,10.0894881 11.7059913,10.2887199 11.4313616,10.2598552 C11.1835304,10.2338071 10.9971003,10.0309074 10.9842889,9.78973323 C10.8859009,8.87197536 10.1588372,8.11509093 9.2038399,8.01471666 Z"})),"fa-bug":"bug","fa-comment":"editorComment","fa-exclamation-circle":"alert","fa-exclamation-triangle":"alert","fa-fire":()=>Object(i.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},Object(i.jsx)("path",{d:"M10.4285489,13.2131862 C11.3850613,12.5116211 12,11.4062861 12,10.1681623 C12,8.88948911 11.7647926,7.64522527 11.315853,6.48027409 L10.7184365,8.07936372 L9.62838732,6.51595716 C8.65161637,5.11502026 7.41222171,3.90368767 5.9820674,2.94508952 C5.99399825,3.12925457 6,3.31436795 6,3.50022638 C6,5.08794888 5.48443413,6.95085436 4.74437685,7.94154468 C4.26219055,8.5870316 4,9.35779518 4,10.1681623 C4,11.4427639 4.65170744,12.5766371 5.65687647,13.2741368 C5.73557697,13.041105 5.84196228,12.8229717 5.97161458,12.624616 C6.26836682,12.1706132 6.5,11.2280234 6.5,10.4287008 C6.5,9.92871906 6.42479348,9.44813694 6.28619258,9 C7.47628141,9.64169048 8.4897566,10.6210605 9.22434324,11.8251557 C9.23213615,11.8013168 9.2406884,11.7775998 9.25,11.7540048 C9.39656041,11.3826304 9.5,11.0805724 9.5,10.6495848 C9.5,10.6240812 9.49971537,10.5986511 9.49914944,10.5732981 C9.96875289,11.3529062 10.2928315,12.2486386 10.4285489,13.2131862 Z M10.4486865,5.94402249 C10.4642723,5.90230435 10.4813768,5.86079967 10.5,5.81950846 C10.7931208,5.16960326 11,4.64100165 11,3.88677339 C11,3.84214218 10.9994307,3.79763944 10.9982989,3.7532716 C12.2630338,5.59045545 13,7.7961396 13,10.1681623 C13,12.8367126 10.7614237,15 8,15 C5.23857625,15 3,12.8367126 3,10.1681623 C3,9.11340491 3.34972471,8.13758287 3.94322917,7.34307798 C4.53673363,6.54857309 5,4.8990409 5,3.50022638 C5,2.62525836 4.84958695,1.78423964 4.57238517,1 C6.95256283,2.12295834 8.97951321,3.83685594 10.4486865,5.94402249 Z"})),"fa-flag":"flag","fa-heart":"heart","fa-map-marker":"mapMarker","fa-map-pin":"pinFilled","fa-star":"starFilled","fa-tag":"tag"}},62:function(e,t,s){"use strict";s.d(t,"a",(function(){return p})),s.d(t,"d",(function(){return m})),s.d(t,"c",(function(){return x})),s.d(t,"e",(function(){return v})),s.d(t,"b",(function(){return O}));var i=s(31),a=s.n(i),l=s(2),n=s(9),r=s(18),o=s(36),d=s.n(o);const u=new RegExp(`^>=([\\d\\.]+\\s*(${d.a.units.join("|")}))$`);new RegExp(`^([\\d\\.]+)\\s*(${d.a.units.join("|")})$`);var c=s(8),b=s(20);const{parseEsInterval:g}=r.search.aggs,j={s:l.i18n.translate("visTypeTimeseries.getInterval.secondsLabel",{defaultMessage:"seconds"}),m:l.i18n.translate("visTypeTimeseries.getInterval.minutesLabel",{defaultMessage:"minutes"}),h:l.i18n.translate("visTypeTimeseries.getInterval.hoursLabel",{defaultMessage:"hours"}),d:l.i18n.translate("visTypeTimeseries.getInterval.daysLabel",{defaultMessage:"days"}),w:l.i18n.translate("visTypeTimeseries.getInterval.weeksLabel",{defaultMessage:"weeks"}),M:l.i18n.translate("visTypeTimeseries.getInterval.monthsLabel",{defaultMessage:"months"}),y:l.i18n.translate("visTypeTimeseries.getInterval.yearsLabel",{defaultMessage:"years"})},p=(e,t=!0)=>{const s=Object.keys(j).reverse(),i=a.a.duration(e,"ms");for(let e=0;e<s.length;e++){const a=i.as(s[e]);if(Math.abs(a)>1)return{unitValue:Math.round(Math.abs(a)),unitString:t?j[s[e]]:s[e]}}},m=e=>u.test(e),x=e=>!e||e===c.a,v=e=>{const t={};try{g(e)}catch({message:e}){t.errorMessage=e}finally{t.isValid=!t.errorMessage}return t},O=(e,t)=>Object(n.get)(e,Object(b.a)(e)?"series[0].series":`${t.id}.series`,[]).reduce(((e,t)=>{if(t.data.length>1&&"number"==typeof t.data[1][0]&&"number"==typeof t.data[0][0]){const s=t.data[1][0]-t.data[0][0];if(!e||s<e)return s}return e}),0)},64:function(e,t,s){"use strict";s.d(t,"a",(function(){return a})),s.d(t,"b",(function(){return r})),s.d(t,"c",(function(){return o}));var i=s(9);let a;!function(e){e.Gte="gte",e.Lte="lte",e.Gt="gt",e.Lt="lt",e.Empty="empty"}(a||(a={}));const l={[a.Gte]:i.gte,[a.Lte]:i.lte,[a.Gt]:i.gt,[a.Lt]:i.lt,[a.Empty]:i.isNull},n={[a.Empty]:!0},r=e=>l[e],o=(e,t)=>Object(i.isNull)(e.value)&&n[e.operator]||!Object(i.isNull)(e.value)&&!Object(i.isNull)(t)},70:function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));const i=["count","avg","max","min","sum","std_deviation","variance","sum_of_squares","value_count","cardinality"]},76:function(e,t,s){"use strict";s.d(t,"a",(function(){return j}));var i=s(37),a=s(9),l=s(4),n=s(49),r=s(45),o=s(53),d=s(58),u=s(59),c=s(31),b=s.n(c),g=s(50);const j=(e,t,s=null,c)=>{var j;const p={},m=null!==(j=null==s?void 0:s("dateFormat"))&&void 0!==j?j:"lll";return t.series.forEach((t=>{e.filter((e=>Object(a.startsWith)(e.id,t.id))).forEach((e=>{let j=Object(r.b)(e.label);j!==r.a&&(j=Object(a.snakeCase)(j));const x=[`[${j}]`,Object(a.snakeCase)(t.var_name)].filter((e=>e)).join("."),v=t.formatter===l.b.DEFAULT?Object(u.a)(Object(d.a)(t.metrics),c):Object(o.a)(t.formatter,t.value_template,s),O=Object(n.b)(e.data),h={last:{raw:O,formatted:v(O)},data:{raw:e.data,formatted:e.data.map((e=>[b()(e[0]).format(m),v(e[1])]))}};let T=e.label;if(t.split_mode===l.a.TERMS){const s=Object(g.d)(t.terms_field);1===s.length&&(T=Object(u.a)(s[0],c)(e.label))}Object(i.set)(p,x,h),Object(i.set)(p,`[${j}].label`,T)}))})),p}},97:function(e,t,s){var i,a,l=s(24),n=s(25),r=0,o=0;e.exports=function(e,t,s){var d=t&&s||0,u=t||[],c=(e=e||{}).node||i,b=void 0!==e.clockseq?e.clockseq:a;if(null==c||null==b){var g=l();null==c&&(c=i=[1|g[0],g[1],g[2],g[3],g[4],g[5]]),null==b&&(b=a=16383&(g[6]<<8|g[7]))}var j=void 0!==e.msecs?e.msecs:(new Date).getTime(),p=void 0!==e.nsecs?e.nsecs:o+1,m=j-r+(p-o)/1e4;if(m<0&&void 0===e.clockseq&&(b=b+1&16383),(m<0||j>r)&&void 0===e.nsecs&&(p=0),p>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");r=j,o=p,a=b;var x=(1e4*(268435455&(j+=122192928e5))+p)%4294967296;u[d++]=x>>>24&255,u[d++]=x>>>16&255,u[d++]=x>>>8&255,u[d++]=255&x;var v=j/4294967296*1e4&268435455;u[d++]=v>>>8&255,u[d++]=255&v,u[d++]=v>>>24&15|16,u[d++]=v>>>16&255,u[d++]=b>>>8|128,u[d++]=255&b;for(var O=0;O<6;++O)u[d+O]=c[O];return t||n(u)}},98:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s(35),a=s(5),l=i.__importDefault(s(99));t.default=function(e,t,s){void 0===t&&(t=0),void 0===s&&(s=[]);var i=l.default(e,t),n=i[0],r=i[1],o=i[2];return a.useEffect(o,s),[n,r]}},99:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s(5);t.default=function(e,t){void 0===t&&(t=0);var s=i.useRef(!1),a=i.useRef(),l=i.useRef(e),n=i.useCallback((function(){return s.current}),[]),r=i.useCallback((function(){s.current=!1,a.current&&clearTimeout(a.current),a.current=setTimeout((function(){s.current=!0,l.current()}),t)}),[t]),o=i.useCallback((function(){s.current=null,a.current&&clearTimeout(a.current)}),[]);return i.useEffect((function(){l.current=e}),[e]),i.useEffect((function(){return r(),o}),[t]),[n,o,r]}}}]);