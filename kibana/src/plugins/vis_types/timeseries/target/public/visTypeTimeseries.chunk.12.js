(window.visTypeTimeseries_bundle_jsonpfunction=window.visTypeTimeseries_bundle_jsonpfunction||[]).push([[12],{206:function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return k}));var s=r(0),a=r(58),n=r(53),o=r(59),i=r(17),l=r.n(i),c=r(5),d=r.n(c),b=r(49),u=r(45),p=r(68),j=r.n(p),m=r(1);const h="negative",f="mixed";class top_n_TopN extends c.Component{constructor(e){super(e),this.tableRef=d.a.createRef(),this.state={labelMaxWidth:150}}get labelMaxWidth(){return.35*this.tableRef.current.offsetWidth}componentDidMount(){this.setState({labelMaxWidth:this.labelMaxWidth})}componentDidUpdate(e,t){t.labelMaxWidth!==this.labelMaxWidth&&this.setState({labelMaxWidth:this.labelMaxWidth})}handleClick(e){return()=>{this.props.onClick&&this.props.onClick(e)}}renderRow({min:e,max:t}){return r=>{const s=top_n_TopN.getRenderMode(e,t),a=`${r.id||r.label}`,n=Object(b.b)(r.data),o=Object(b.c)(n)?0:n,i=r.tickFormatter||this.props.tickFormatter,l=o>=0,c=top_n_TopN.calcDomain(s,e,t),d=Math.abs(o)/c*100||0,p=Object(b.c)(n)?"1px":`${d}%`,h=r.label,f=j()({default:{innerBar:{...top_n_TopN.calcInnerBarStyles(s,l)},innerBarValue:{...top_n_TopN.calcInnerBarDivStyles(r,p,l)},label:{maxWidth:this.state.labelMaxWidth}},onClickStyle:{row:{cursor:"pointer"}}},{onClickStyle:"function"==typeof this.props.onClick});return Object(m.jsx)("tr",{key:a,onClick:this.handleClick({lastValue:n,...r}),style:f.row},Object(m.jsx)("td",{title:r.label,className:"tvbVisTopN__label",style:f.label},Object(u.b)(h)),Object(m.jsx)("td",{width:"100%",className:"tvbVisTopN__bar"},Object(m.jsx)("div",{className:"tvbVisTopN__innerBar",style:f.innerBar},Object(m.jsx)("div",{style:f.innerBarValue,"data-test-subj":"topNInnerBar"}))),Object(m.jsx)("td",{className:"tvbVisTopN__value","data-test-subj":"tsvbTopNValue"},Object(m.jsx)("span",{dangerouslySetInnerHTML:{__html:i(n)}})))}}render(){if(!this.props.series)return null;const e=this.props.series.reduce(((e,t,r)=>{var s;const a=null!==(s=Object(b.b)(t.data))&&void 0!==s?s:0;return{min:!r||a<e.min?a:e.min,max:!r||a>e.max?a:e.max}}),{min:void 0,max:void 0}),t=this.props.series.map(this.renderRow(e));let r="tvbVisTopN";return this.props.reversed&&(r+=" tvbVisTopN--reversed"),Object(m.jsx)("div",{className:r},Object(m.jsx)("table",{className:"tvbVisTopN__table","data-test-subj":"tvbVisTopNTable",ref:this.tableRef},Object(m.jsx)("tbody",null,t)))}}l()(top_n_TopN,"getRenderMode",((e,t)=>e>=0?"positive":t<0?h:f)),l()(top_n_TopN,"calcInnerBarStyles",((e,t)=>e===f?{[t?"marginLeft":"marginRight"]:"50%"}:{})),l()(top_n_TopN,"calcInnerBarDivStyles",((e,t,r)=>({backgroundColor:e.color,width:t,float:r?"left":"right"}))),l()(top_n_TopN,"calcDomain",((e,t,r)=>e===f?Math.max(r,Math.abs(t)):e===h?Math.abs(t):r)),top_n_TopN.defaultProps={tickFormatter:e=>e,direction:"desc"};var v=r(67),x=r(60),_=r(9),O=r(4),y=r(64),T=r(80),g=r(8);function k(e){const[t,r]=Object(c.useState)(null),i=Object(s.b)(),{backgroundColor:l,model:d,visData:u,fieldFormatMap:p,getConfig:j}=e,h=function(e,t){const r=Object(_.get)(e,`${t.id}.series`,[]);return t.series.reduce(((e,t)=>{const s=r.filter((e=>Object(_.first)(e.id.split(g.c))===t.id)),a=t.terms_direction||"desc";return"_key"===t.terms_order_by?e.concat(s):e.concat(function(e,t,r){return"desc"===t?Object(_.sortBy)(e,r).reverse():Object(_.sortBy)(e,r)}(s,a,(e=>Object(b.b)(e.data))))}),[])}(u,d).map((e=>{const t=Object(_.first)(e.id.split(g.c)),r=d.series.find((e=>e.id===t));if(r){const t=r.formatter===O.b.DEFAULT?Object(o.a)(Object(a.a)(r.metrics),p,"html"):Object(n.a)(r.formatter,r.value_template,j),s=Object(b.b)(e.data);let i=e.color||r.color;return d.bar_color_rules&&d.bar_color_rules.forEach((e=>{Object(y.c)(e,s)&&e.operator&&e.bar_color&&Object(y.b)(e.operator)(s,e.value)&&(i=e.bar_color)})),{...e,color:i,tickFormatter:t}}return e})),f=d.background_color||l,k={backgroundColor:f},M={series:h,reversed:Object(v.b)(f)};d.drilldown_url&&(M.onClick=e=>{const t=Object(x.a)(d.drilldown_url,{},{key:e.label},{noEscape:!0});i.http.externalUrl.validateUrl(t)?(r(null),i.application.navigateToUrl(t)):r(t)});const w=Object(c.useCallback)((()=>r(null)),[]);return Object(m.jsx)("div",{className:"tvbVis",style:k},Object(m.jsx)(top_n_TopN,M),t&&Object(m.jsx)(T.a,{url:t,handleClose:w}))}},60:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var s=r(33),a=r(65),n=r(2),o=r(45);const i=a.b.create();var l;function c(e,t={},r={},s={}){try{return i[a.a](e.split(o.a).join(`[${o.a}]`),{strict:!0,knownHelpersOnly:!0,knownHelpers:{rison:!0,encodeURIComponent:!0},...s})({...r,args:t})}catch(t){if(-1!==t.toString().indexOf("Parse error"))return e;if(-1!==t.message.indexOf("not defined in")){const e=t.message.split(/"/)[1];t.error={caused_by:{reason:n.i18n.translate("visTypeTimeseries.replaceVars.errors.unknownVarDescription",{defaultMessage:"{badVar} is an unknown variable",values:{badVar:"{{"+e+"}}"}}),title:n.i18n.translate("visTypeTimeseries.replaceVars.errors.unknownVarTitle",{defaultMessage:"Error processing your markdown"})}}}else t.error={caused_by:{reason:n.i18n.translate("visTypeTimeseries.replaceVars.errors.markdownErrorDescription",{defaultMessage:"Please verify you are only using markdown, known variables, and built-in Handlebars expressions"}),title:n.i18n.translate("visTypeTimeseries.replaceVars.errors.markdownErrorTitle",{defaultMessage:"Error processing your markdown"})}};return t}}i.registerHelper("rison",("rison",l=e=>Object(s.encode)(e),(...e)=>{const{hash:t}=e.slice(-1)[0],r=Object.keys(t).length>0,s=e.length>1;if(r&&s)throw new Error("[rison]: both value list and hash are not supported");if(r){if(Object.values(t).some((e=>void 0===e)))throw new Error("[rison]: unknown variable");return l(t)}{const t=e.slice(0,-1);if(t.some((e=>void 0===e)))throw new Error("[rison]: unknown variable");if(0===t.length)throw new Error("[rison]: unknown variable");return 1===t.length?l(t[0]):l(t)}})),i.registerHelper("encodeURIComponent",(e=>{const t=String(e);return encodeURIComponent(t)}))},80:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r(5);var s=r(16),a=r(15),n=r(1);const o=({url:e,handleClose:t})=>Object(n.jsx)(a.EuiModal,{onClose:t},Object(n.jsx)(a.EuiModalHeader,null,Object(n.jsx)(a.EuiModalHeaderTitle,null,Object(n.jsx)(s.FormattedMessage,{id:"visTypeTimeseries.externalUrlErrorModal.headerTitle",defaultMessage:"Access to this external URL is not yet enabled"}))),Object(n.jsx)(a.EuiModalBody,null,Object(n.jsx)(s.FormattedMessage,{id:"visTypeTimeseries.externalUrlErrorModal.bodyMessage",defaultMessage:"Configure {externalUrlPolicy} in your {kibanaConfigFileName} to allow access to {url}.",values:{url:Object(n.jsx)(a.EuiTextColor,{color:"warning",component:"span"},e),externalUrlPolicy:"externalUrl.policy",kibanaConfigFileName:"kibana.yml"}})),Object(n.jsx)(a.EuiModalFooter,null,Object(n.jsx)(a.EuiButton,{onClick:t,fill:!0},Object(n.jsx)(s.FormattedMessage,{id:"visTypeTimeseries.externalUrlErrorModal.closeButtonLabel",defaultMessage:"Close"}))))}}]);