/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.cases_bundle_jsonpfunction=window.cases_bundle_jsonpfunction||[]).push([[0],{101:function(e,t,n){e.exports=n(29)(3)},111:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(1),i=n(112);const s=()=>Object(a.useContext)(i.a)},112:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return r}));var a=n(1),i=n.n(a);const s=i.a.createContext(null),r=({children:e,timelineIntegration:t})=>{const[n]=Object(a.useState)(null!=t?t:null);return i.a.createElement(s.Provider,{value:n},e)}},113:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(1),i=n(70),s=n(6),r=n(38),l=n(95);const o=()=>{const{application:{currentAppId$:e},embeddable:t,storage:n}=Object(s.f)().services,[o,c]=Object(a.useState)(null),[u,d]=Object(a.useState)(!1);return Object(a.useEffect)((()=>{(async()=>{const a=await e.pipe(Object(i.first)()).toPromise();if(!a)return;const s=null==t?void 0:t.getStateTransfer().getIncomingEmbeddablePackage(a),l=n.get(r.a);d(!!s),l&&c(l)})()}),[e,t,n]),{draftComment:o,hasIncomingLensState:u,openLensModal:Object(a.useCallback)((({editorRef:e})=>{if(e&&e.textarea&&e.toolbar){var t;const n=null===(t=e.toolbar)||void 0===t?void 0:t.querySelector(`[aria-label="${l.a}"]`);n&&n.click()}}),[]),clearDraftComment:Object(a.useCallback)((()=>{n.remove(r.a),c(null)}),[n])}}},150:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(50),i=n(1),s=a.__importDefault(n(151));t.default=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=[]);var a=s.default(e,t),r=a[0],l=a[1],o=a[2];return i.useEffect(o,n),[r,l]}},151:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1);t.default=function(e,t){void 0===t&&(t=0);var n=a.useRef(!1),i=a.useRef(),s=a.useRef(e),r=a.useCallback((function(){return n.current}),[]),l=a.useCallback((function(){n.current=!1,i.current&&clearTimeout(i.current),i.current=setTimeout((function(){n.current=!0,s.current()}),t)}),[t]),o=a.useCallback((function(){n.current=null,i.current&&clearTimeout(i.current)}),[]);return a.useEffect((function(){s.current=e}),[e]),a.useEffect((function(){return l(),o}),[t]),[r,o,l]}},78:function(e,t,n){"use strict";var a=n(63);n.d(t,"i",(function(){return a.getUseField})),n.d(t,"h",(function(){return a.getFieldValidityAndErrorMessage})),n.d(t,"a",(function(){return a.FIELD_TYPES})),n.d(t,"c",(function(){return a.Form})),n.d(t,"d",(function(){return a.FormDataProvider})),n.d(t,"e",(function(){return a.UseField})),n.d(t,"j",(function(){return a.useForm})),n.d(t,"k",(function(){return a.useFormContext})),n.d(t,"l",(function(){return a.useFormData})),n.d(t,"f",(function(){return a.VALIDATION_TYPES}));var i=n(67);n.d(t,"b",(function(){return i.Field}));var s=n(69);n.d(t,"g",(function(){return s.fieldValidators}))},90:function(e,t,n){"use strict";n.d(t,"c",(function(){return a.c})),n.d(t,"a",(function(){return a.a})),n.d(t,"b",(function(){return a.b}));var a=n(20)},95:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(2).i18n.translate("xpack.cases.markdownEditor.plugins.lens.visualizationButtonLabel",{defaultMessage:"Visualization"})},98:function(e,t,n){"use strict";n.d(t,"b",(function(){return G})),n.d(t,"a",(function(){return K}));var a=n(101),i=n.n(a),s=n(1),r=n.n(s),l=n(14),o=n(12);const c=({disableLinks:e,href:t,target:n,children:a,...i})=>r.a.createElement(o.EuiToolTip,{content:t},r.a.createElement(o.EuiLink,{href:e?void 0:t,"data-test-subj":"markdown-link",rel:"nofollow",target:"_blank"},a));c.displayName="MarkdownLink";const u=Object(s.memo)(c);var d=n(111),p=n(6),m=n(70),g=n(2),b=n(64),f=n(23),h=n(34),v=n.n(h),E=n(38);const O=r.a.createContext(null),j=v()(o.EuiFlexGroup).withConfig({displayName:"ModalContainer",componentId:"sc-4107jc-0"})(["width:",";height:100%;.euiModalBody{min-height:300px;}"],(({theme:e})=>e.eui.euiBreakpoints.m));var k=n(15),y=n.n(k),P=n(10),S=n(73);class saved_objects_finder_SavedObjectFinderUi extends r.a.Component{constructor(e){super(e),y()(this,"isComponentMounted",!1),y()(this,"debouncedFetch",Object(P.debounce)((async e=>{const t=this.getSavedObjectMetaDataMap(),n=Object.values(t).map((e=>e.includeFields||[])).reduce(((e,t)=>e.concat(t)),["title"]),a=this.props.uiSettings.get(S.LISTING_LIMIT_SETTING),i=await this.props.savedObjects.client.find({type:Object.keys(t),fields:[...new Set(n)],search:e?`${e}*`:void 0,page:1,perPage:a,searchFields:["title^3","description"],defaultSearchOperator:"AND"});i.savedObjects=i.savedObjects.filter((e=>{const n=t[e.type];return!n.showSavedObject||n.showSavedObject(e)})),this.isComponentMounted&&e===this.state.query&&this.setState({isFetchingItems:!1,page:0,items:i.savedObjects.map((e=>{const{attributes:{title:t},id:n,type:a}=e;return{title:"string"==typeof t?t:"",id:n,type:a,savedObject:e}}))})}),300)),y()(this,"getPageOfItems",(()=>{const e=this.state.items.slice(),{sortDirection:t}=this.state;!t&&this.state.query||e.sort((({title:e},{title:n})=>{let a=1;return"desc"===t&&(a=-1),a*(e||"").toLowerCase().localeCompare((n||"").toLowerCase())}));const n=this.state.page*this.state.perPage,a=n+this.state.perPage;return e.filter((e=>0===this.state.filteredTypes.length||this.state.filteredTypes.includes(e.type))).slice(n,a)})),y()(this,"fetchItems",(()=>{this.setState({isFetchingItems:!0},this.debouncedFetch.bind(null,this.state.query))})),this.state={items:[],isFetchingItems:!1,page:0,perPage:e.initialPageSize||e.fixedPageSize||10,query:"",filterOpen:!1,filteredTypes:[],sortOpen:!1}}componentWillUnmount(){this.isComponentMounted=!1,this.debouncedFetch.cancel()}componentDidMount(){this.isComponentMounted=!0,this.fetchItems()}render(){return r.a.createElement(r.a.Fragment,null,this.renderSearchBar(),this.renderListing())}getSavedObjectMetaDataMap(){return this.props.savedObjectMetaData.reduce(((e,t)=>({...e,[t.type]:t})),{})}getPageCount(){return Math.ceil((0===this.state.filteredTypes.length?this.state.items.length:this.state.items.filter((e=>0===this.state.filteredTypes.length||this.state.filteredTypes.includes(e.type))).length)/this.state.perPage)}getAvailableSavedObjectMetaData(){const e=new Set;return this.state.items.forEach((t=>{e.add(t.type)})),this.props.savedObjectMetaData.filter((t=>e.has(t.type)))}getSortOptions(){const e=[r.a.createElement(o.EuiContextMenuItem,{key:"asc",icon:"asc"===this.state.sortDirection||""===this.state.query&&"desc"!==this.state.sortDirection?"check":"empty",onClick:()=>{this.setState({sortDirection:"asc"})}},g.i18n.translate("xpack.cases.markdownEditor.plugins.lens.savedObjects.finder.sortAsc",{defaultMessage:"Ascending"})),r.a.createElement(o.EuiContextMenuItem,{key:"desc",icon:"desc"===this.state.sortDirection?"check":"empty",onClick:()=>{this.setState({sortDirection:"desc"})}},g.i18n.translate("xpack.cases.markdownEditor.plugins.lens.savedObjects.finder.sortDesc",{defaultMessage:"Descending"}))];return this.state.query&&e.push(r.a.createElement(o.EuiContextMenuItem,{key:"auto",icon:this.state.sortDirection?"empty":"check",onClick:()=>{this.setState({sortDirection:void 0})}},g.i18n.translate("xpack.cases.markdownEditor.plugins.lens.savedObjects.finder.sortAuto",{defaultMessage:"Best match"}))),e}renderSearchBar(){const e=this.getAvailableSavedObjectMetaData();return r.a.createElement(o.EuiFormRow,i()({fullWidth:!0},this.props.euiFormRowProps||{}),r.a.createElement(o.EuiFlexGroup,{gutterSize:"m"},r.a.createElement(o.EuiFlexItem,{grow:!0},r.a.createElement(o.EuiFieldSearch,i()({placeholder:g.i18n.translate("xpack.cases.markdownEditor.plugins.lens.savedObjects.finder.searchPlaceholder",{defaultMessage:"Search…"}),"aria-label":g.i18n.translate("xpack.cases.markdownEditor.plugins.lens.savedObjects.finder.searchPlaceholder",{defaultMessage:"Search…"}),fullWidth:!0,value:this.state.query,onChange:e=>{this.setState({query:e.target.value},this.fetchItems)},"data-test-subj":"savedObjectFinderSearchInput",isLoading:this.state.isFetchingItems},this.props.euiFieldSearchProps||{}))),r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(o.EuiFilterGroup,null,r.a.createElement(o.EuiPopover,{id:"addPanelSortPopover",panelClassName:"euiFilterGroup__popoverPanel",panelPaddingSize:"none",isOpen:this.state.sortOpen,closePopover:()=>this.setState({sortOpen:!1}),button:r.a.createElement(o.EuiFilterButton,{onClick:()=>this.setState((({sortOpen:e})=>({sortOpen:!e}))),iconType:"arrowDown",isSelected:this.state.sortOpen,"data-test-subj":"savedObjectFinderSortButton"},g.i18n.translate("xpack.cases.markdownEditor.plugins.lens.savedObjects.finder.sortButtonLabel",{defaultMessage:"Sort"}))},r.a.createElement(o.EuiContextMenuPanel,{items:this.getSortOptions()})),this.props.showFilter&&r.a.createElement(o.EuiPopover,{id:"addPanelFilterPopover",panelClassName:"euiFilterGroup__popoverPanel",panelPaddingSize:"none",isOpen:this.state.filterOpen,closePopover:()=>this.setState({filterOpen:!1}),button:r.a.createElement(o.EuiFilterButton,{onClick:()=>this.setState((({filterOpen:e})=>({filterOpen:!e}))),iconType:"arrowDown","data-test-subj":"savedObjectFinderFilterButton",isSelected:this.state.filterOpen,numFilters:this.props.savedObjectMetaData.length,hasActiveFilters:this.state.filteredTypes.length>0,numActiveFilters:this.state.filteredTypes.length},g.i18n.translate("xpack.cases.markdownEditor.plugins.lens.savedObjects.finder.filterButtonLabel",{defaultMessage:"Types"}))},r.a.createElement(o.EuiContextMenuPanel,{items:this.props.savedObjectMetaData.map((t=>r.a.createElement(o.EuiContextMenuItem,{key:t.type,disabled:!e.includes(t),icon:this.state.filteredTypes.includes(t.type)?"check":"empty","data-test-subj":`savedObjectFinderFilter-${t.type}`,onClick:()=>{this.setState((({filteredTypes:e})=>({filteredTypes:e.includes(t.type)?e.filter((e=>e!==t.type)):[...e,t.type],page:0})))}},t.name)))})))),this.props.children?r.a.createElement(o.EuiFlexItem,{grow:!1},this.props.children):null))}renderListing(){const e=0===this.state.items.length?[]:this.getPageOfItems(),{onChoose:t,savedObjectMetaData:n}=this.props;return r.a.createElement(r.a.Fragment,null,this.state.isFetchingItems&&0===this.state.items.length&&r.a.createElement(o.EuiFlexGroup,{justifyContent:"center"},r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(o.EuiSpacer,null),r.a.createElement(o.EuiLoadingSpinner,{"data-test-subj":"savedObjectFinderLoadingIndicator"}))),e.length>0?r.a.createElement(r.a.Fragment,null,r.a.createElement(o.EuiSpacer,{size:"s"}),r.a.createElement(o.EuiListGroup,{"data-test-subj":"savedObjectFinderItemList",maxWidth:!1,flush:!0},e.map((e=>{const a=n.find((t=>t.type===e.type));if(null==a)return null;const i=a.getTooltipForSavedObject?a.getTooltipForSavedObject(e.savedObject):`${e.title} (${a.name})`,s=(a||{getIconForSavedObject:()=>"document"}).getIconForSavedObject(e.savedObject);return r.a.createElement(o.EuiListGroupItem,{key:e.id,iconType:s,label:e.title,onClick:t?()=>{t(e.id,e.type,i,e.savedObject)}:void 0,title:i,"data-test-subj":`savedObjectTitle${(e.title||"").split(" ").join("-")}`})})))):!this.state.isFetchingItems&&r.a.createElement(o.EuiEmptyPrompt,{body:this.props.noItemsMessage}),this.getPageCount()>1&&(this.props.fixedPageSize?r.a.createElement(o.EuiPagination,{activePage:this.state.page,pageCount:this.getPageCount(),onPageClick:e=>{this.setState({page:e})}}):r.a.createElement(o.EuiTablePagination,{activePage:this.state.page,pageCount:this.getPageCount(),onChangePage:e=>{this.setState({page:e})},onChangeItemsPerPage:e=>{this.setState({perPage:e})},itemsPerPage:this.state.perPage,itemsPerPageOptions:[5,10,15,25]})))}}var M=n(113),w=n(95),C=n(3),F=n(22);const x=v.a.span.withConfig({displayName:"BetaBadgeWrapper",componentId:"sc-ubq95a-0"})(["display:inline-flex;.euiToolTipAnchor{display:inline-flex;}"]),I={from:"now-7d",to:"now",mode:"relative"},T=({node:e,onCancel:t,onSave:n})=>{const a=Object(f.useLocation)(),{application:{currentAppId$:i},embeddable:l,lens:c,storage:u,savedObjects:d,uiSettings:h,data:{query:{timefilter:{timefilter:v}}}}=Object(p.f)().services,[k,y]=Object(s.useState)(void 0),{draftComment:P,clearDraftComment:S}=Object(M.a)(),w=Object(s.useContext)(O),T=Object(s.useContext)(o.EuiMarkdownContext),L=(()=>{const{appId:e}=Object(F.a)();return e===C.G})(),D=Object(s.useCallback)((()=>{k&&(null==l||l.getStateTransfer().getIncomingEmbeddablePackage(k,!0),S()),t()}),[S,k,l,t]),A=Object(s.useCallback)(((e,t)=>{n(`!{${E.b}${JSON.stringify({timeRange:t,attributes:e})}}`,{block:!0}),D()}),[D,n]),N=Object(s.useCallback)(((e,t,n)=>{T.replaceNode(n,`!{${E.b}${JSON.stringify({timeRange:t,attributes:e})}}`),D()}),[D,T]),R=Object(s.useMemo)((()=>L?`/insightsAndAlerting/cases${a.pathname}${a.search}`:`${a.pathname}${a.search}`),[L,a.pathname,a.search]),z=Object(s.useCallback)((()=>{u.set(E.a,{commentId:null==w?void 0:w.editorId,comment:null==w?void 0:w.value,position:null==e?void 0:e.position,caseTitle:null==w?void 0:w.caseTitle,caseTags:null==w?void 0:w.caseTags}),null==c||c.navigateToPrefilledEditor(void 0,{originatingApp:k,originatingPath:R})}),[u,null==w?void 0:w.editorId,null==w?void 0:w.value,null==w?void 0:w.caseTitle,null==w?void 0:w.caseTags,null==e?void 0:e.position,c,k,R]),B=Object(s.useCallback)(((t,n=I)=>{u.set(E.a,{commentId:null==w?void 0:w.editorId,comment:null==w?void 0:w.value,position:null==e?void 0:e.position,caseTitle:null==w?void 0:w.caseTitle,caseTags:null==w?void 0:w.caseTags}),null==c||c.navigateToPrefilledEditor(t||null!=e&&e.attributes?{id:"",timeRange:n,attributes:t||(null==e?void 0:e.attributes)}:void 0,{originatingApp:k,originatingPath:R})}),[u,null==w?void 0:w.editorId,null==w?void 0:w.value,null==w?void 0:w.caseTitle,null==w?void 0:w.caseTags,null==e?void 0:e.position,null==e?void 0:e.attributes,c,k,R]),_=Object(s.useCallback)(((e,t,n,a)=>{B({...a.attributes,title:"",references:a.references})}),[B]),$=Object(s.useMemo)((()=>[{type:"lens",getIconForSavedObject:()=>"lensApp",name:g.i18n.translate("xpack.cases.markdownEditor.plugins.lens.insertLensSavedObjectModal.searchSelection.savedObjectType.lens",{defaultMessage:"Lens"}),includeFields:["*"]}]),[]),q=Object(s.useMemo)((()=>({prepend:g.i18n.translate("xpack.cases.markdownEditor.plugins.lens.savedObjects.finder.searchInputPrependLabel",{defaultMessage:"Template"})})),[]),G=Object(s.useMemo)((()=>({label:g.i18n.translate("xpack.cases.markdownEditor.plugins.lens.savedObjects.finder.searchInputLabel",{defaultMessage:"Select lens"}),labelAppend:r.a.createElement(o.EuiButtonEmpty,{onClick:z,color:"primary",size:"xs"},r.a.createElement(b.FormattedMessage,{id:"xpack.cases.markdownEditor.plugins.lens.createVisualizationButtonLabel",defaultMessage:"Create visualization"})),helpText:g.i18n.translate("xpack.cases.markdownEditor.plugins.lens.savedObjects.finder.searchInputHelpText",{defaultMessage:"Insert lens from existing templates or creating a new one. You will only create lens for this comment and won’t change Visualize Library."})})),[z]);return Object(s.useEffect)((()=>{null!=e&&e.attributes&&k&&B(e.attributes,e.timeRange)}),[B,e,k]),Object(s.useEffect)((()=>{(async()=>{const e=await i.pipe(Object(m.first)()).toPromise();y(e)})()}),[i]),Object(s.useEffect)((()=>{var e,t,n;let a;if(k&&(a=null==l?void 0:l.getStateTransfer().getIncomingEmbeddablePackage(k,!0)),"lens"===(null===(e=a)||void 0===e?void 0:e.type)&&null!==(t=a)&&void 0!==t&&null!==(n=t.input)&&void 0!==n&&n.attributes){const e=v.getTime(),t=null!=e&&e.from&&null!=e&&e.to?{from:e.from,to:e.to,mode:[e.from,e.to].join("").includes("now")?"relative":"absolute"}:void 0;var i,s;if(null!=P&&P.position)return void N(null===(i=a)||void 0===i?void 0:i.input.attributes,t,P.position);P&&A(null===(s=a)||void 0===s?void 0:s.input.attributes,t)}}),[l,u,v,k,A,N,P]),r.a.createElement(j,{direction:"column",gutterSize:"none"},r.a.createElement(o.EuiModalHeader,null,r.a.createElement(o.EuiModalHeaderTitle,null,r.a.createElement(o.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(b.FormattedMessage,{id:"xpack.cases.markdownEditor.plugins.lens.addVisualizationModalTitle",defaultMessage:"Add visualization"})),r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(x,null,r.a.createElement(o.EuiBetaBadge,{label:g.i18n.translate("xpack.cases.markdownEditor.plugins.lens.betaLabel",{defaultMessage:"Beta"}),tooltipContent:g.i18n.translate("xpack.cases.markdownEditor.plugins.lens.betaDescription",{defaultMessage:"This module is not GA. You can only insert one lens per comment for now. Please help us by reporting bugs."})})))))),r.a.createElement(o.EuiModalBody,null,r.a.createElement(saved_objects_finder_SavedObjectFinderUi,{key:"searchSavedObjectFinder",onChoose:_,showFilter:!1,noItemsMessage:r.a.createElement(b.FormattedMessage,{id:"xpack.cases.markdownEditor.plugins.lens.insertLensSavedObjectModal.searchSelection.notFoundLabel",defaultMessage:"No matching lens found."}),savedObjectMetaData:$,fixedPageSize:10,uiSettings:h,savedObjects:d,euiFieldSearchProps:q,euiFormRowProps:G})),r.a.createElement(o.EuiModalFooter,null,r.a.createElement(o.EuiButton,{onClick:D,fill:!0},r.a.createElement(b.FormattedMessage,{id:"xpack.cases.markdownEditor.plugins.lens.closeButtonLabel",defaultMessage:"Close"}))))};T.displayName="LensEditor";const L=r.a.memo(T),D={name:E.b,button:{label:w.a,iconType:"lensApp"},helpText:r.a.createElement(o.EuiCodeBlock,{language:"md",paddingSize:"s",fontSize:"l"},"!{lens<config>}"),editor:L},A=function(){const e=this.Parser,t=e.prototype.blockTokenizers,n=e.prototype.blockMethods;t.lens=function(e,t,n){if(!1===t.startsWith(E.d))return!1;const a=t[6];if("{"!==a&&"}"!==a)return!1;if(n)return!0;const i="{"===a;let s=E.d,r={};if(i){let n="",a=0;for(let e=6;e<t.length;e++){const i=t[e];if("{"===i)a++,n+=i;else if("}"===i){if(a--,-1===a)break;n+=i}else n+=i}s+=n;try{r=JSON.parse(n)}catch(t){const n=e.now();this.file.fail(`Unable to parse lens JSON configuration: ${t}`,{line:n.line,column:n.column+6})}}return s+="}",e(s)({type:E.b,...r})},n.splice(n.indexOf("text"),0,E.b)};var N=n(65);const R=v.a.div.withConfig({displayName:"Container",componentId:"sc-1q3wldf-0"})(["min-height:","px;"],E.c),z=N.createGlobalStyle`
  div.euiOverlayMask.euiOverlayMask--aboveHeader ~ [id^='echTooltipPortal'] {
    z-index: ${({theme:e})=>e.eui.euiZLevel7} !important;
  }
`,B=({attributes:e,timeRange:t})=>{const{lens:{EmbeddableComponent:n}}=Object(p.f)().services;return e?r.a.createElement(R,null,r.a.createElement(n,{id:"",style:{height:E.c},timeRange:t,attributes:e,renderMode:"view",disableTriggers:!0}),r.a.createElement(z,null)):null};B.displayName="LensMarkDownRenderer";const _=r.a.memo(B),$=e=>{var t,n;const a=p.a.getConfig(),i=null===(t=Object(d.a)())||void 0===t?void 0:t.editor_plugins,r=Object(p.b)();return Object(s.useMemo)((()=>{var t;const n=Object(o.getDefaultEuiMarkdownUiPlugins)(),s=Object(o.getDefaultEuiMarkdownParsingPlugins)(),l=Object(o.getDefaultEuiMarkdownProcessingPlugins)();return i&&(n.push(i.uiPlugin),s.push(i.parsingPlugin),l[1][1].components.timeline=i.processingPluginRenderer),null==a||null===(t=a.markdownPlugins)||void 0===t||!t.lens||null!=e&&e.includes(E.b)||null==r||!r.visualize.crud||n.push(D),s.push(A),l[1][1].components.lens=_,{uiPlugins:n,parsingPlugins:s,processingPlugins:l}}),[null==r?void 0:r.visualize.crud,e,null==a||null===(n=a.markdownPlugins)||void 0===n?void 0:n.lens,i])},q=({children:e,disableLinks:t})=>{const{processingPlugins:n,parsingPlugins:a}=$(),c=Object(l.cloneDeep)(n);return c[1][1].components.a=Object(s.useMemo)((()=>(e=>{const t=Object(s.memo)((t=>r.a.createElement(u,i()({},t,{disableLinks:e}))));return t.displayName="MarkdownLinkProcessingComponent",t})(t)),[t]),r.a.createElement(o.EuiMarkdownFormat,{parsingPluginList:a,processingPluginList:c,grow:!1},e)};q.displayName="MarkdownRenderer";const G=Object(s.memo)(q);var U=n(150),V=n.n(U);const W="euiButtonIcon-isDisabled",H=Object(s.forwardRef)((({ariaLabel:e,dataTestSubj:t,editorId:n,height:a,onChange:i,value:l,disabledUiPlugins:c},u)=>{const d=Object(s.useRef)(void 0),[p,m]=Object(s.useState)([]),g=Object(s.useCallback)(((e,{messages:t,ast:n})=>{m(e?[e]:t),d.current=n}),[]),{parsingPlugins:b,processingPlugins:f,uiPlugins:h}=$(c),v=Object(s.useRef)(null);return(({astRef:e,editorRef:t,uiPlugins:n,value:a})=>{const i=Object(s.useRef)(!1),[r,l]=Object(s.useState)(!1),o=Object(s.useCallback)((()=>{var e,n;if(null!=t&&null!==(e=t.current)&&void 0!==e&&e.textarea&&null!==(n=t.current)&&void 0!==n&&n.toolbar){var a,i;const e=null===(a=t.current)||void 0===a||null===(i=a.toolbar)||void 0===i?void 0:i.querySelector(`[aria-label="${w.a}"]`);if(e){const t=e.className.includes(W),n=e.getAttribute("style");t&&n&&(e.className=e.className.replace(W,""),e.setAttribute("style",n.replace("pointer-events: none;","")))}}}),[t]),c=Object(s.useCallback)((()=>{var e;if(null!=t&&null!==(e=t.current)&&void 0!==e&&e.textarea&&t.current.toolbar){var n;const e=null===(n=t.current.toolbar)||void 0===n?void 0:n.querySelector(`[aria-label="${w.a}"]`);e&&(e.className.includes(W)||(e.className+=` ${W}`,e.setAttribute("style","pointer-events: none;")))}}),[t]);Object(s.useEffect)((()=>{i.current=Object(P.some)(n,["name","lens"])}),[n]),V()((()=>{r||null==a||!a.includes(E.d)?o():c()}),100,[a,r]),Object(s.useEffect)((()=>{var n,a;if(null==(null==t||null===(n=t.current)||void 0===n?void 0:n.textarea)||null==(null==e?void 0:e.current)||!i.current)return;const s=()=>{var n;const{selectionStart:a}=null===(n=t.current)||void 0===n?void 0:n.textarea;let i=e.current;e:for(;;){if(i.children)for(let e=0;e<i.children.length;e++){const t=i.children[e];if(t.position.start.offset<a&&a<t.position.end.offset){if("text"===t.type)break e;i=t;continue e}}break}l("lens"===i.type)},r=null===(a=t.current)||void 0===a?void 0:a.textarea;return r.addEventListener("keyup",s),r.addEventListener("mouseup",s),()=>{r.removeEventListener("keyup",s),r.removeEventListener("mouseup",s)}}),[e,t])})({astRef:d,uiPlugins:h,editorRef:u,value:l}),Object(s.useImperativeHandle)(u,(()=>{var e,t;if(!v.current)return null;const n=null===(e=v.current)||void 0===e||null===(t=e.textarea)||void 0===t?void 0:t.closest(".euiMarkdownEditor");return{...v.current,toolbar:null==n?void 0:n.querySelector(".euiMarkdownEditorToolbar")}})),r.a.createElement(o.EuiMarkdownEditor,{ref:v,"aria-label":e,editorId:n,onChange:i,value:l,uiPlugins:h,parsingPluginList:b,processingPluginList:f,onParse:g,errors:p,"data-test-subj":t,height:a})}));H.displayName="MarkdownEditor";const J=Object(s.memo)(H);var Y=n(78);const Z=v()(o.EuiFlexGroup).withConfig({displayName:"BottomContentWrapper",componentId:"sc-aza0tp-0"})(["",""],(({theme:e})=>`\n    padding: ${e.eui.euiSizeM} 0;\n  `)),K=r.a.memo(Object(s.forwardRef)((({id:e,field:t,dataTestSubj:n,idAria:a,bottomRightContent:i,caseTitle:l,caseTags:c,disabledUiPlugins:u},d)=>{const{isInvalid:p,errorMessage:m}=Object(Y.h)(t),g=Object(s.useMemo)((()=>({editorId:e,value:t.value,caseTitle:l,caseTags:c})),[e,t.value,l,c]);return r.a.createElement(O.Provider,{value:g},r.a.createElement(o.EuiFormRow,{"data-test-subj":n,describedByIds:a?[a]:void 0,fullWidth:!0,error:m,helpText:t.helpText,isInvalid:p,label:t.label,labelAppend:t.labelAppend},r.a.createElement(J,{ref:d,ariaLabel:a,editorId:e,onChange:t.setValue,value:t.value,disabledUiPlugins:u,"data-test-subj":`${n}-markdown-editor`})),i&&r.a.createElement(Z,{justifyContent:"flexEnd"},r.a.createElement(o.EuiFlexItem,{grow:!1},i)))})));K.displayName="MarkdownEditorForm"}}]);