/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.cases_bundle_jsonpfunction=window.cases_bundle_jsonpfunction||[]).push([[4],Array(75).concat([function(e,t,a){"use strict";a.r(t),a.d(t,"CasesRoutes",(function(){return Er})),a.d(t,"default",(function(){return Er}));var n=a(1),s=a.n(n),r=a(23),i=a(21),o=a(17),l=a(6),c=a(37),u=a(24),d=a(4);const m={actionLicense:null,isLoading:!0,isError:!1},p=d.o.jira,b=()=>{const[e,t]=Object(n.useState)(m),a=Object(l.i)(),s=Object(n.useRef)(!1),r=Object(n.useRef)(new AbortController),i=Object(n.useCallback)((async()=>{try{s.current=!1,r.current.abort(),r.current=new AbortController,t({...m,isLoading:!0});const a=await Object(c.d)(r.current.signal);var e;s.current||t({actionLicense:null!==(e=a.find((e=>e.id===p)))&&void 0!==e?e:null,isLoading:!1,isError:!1})}catch(e){s.current||("AbortError"!==e.name&&a.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:u.d}),t({actionLicense:null,isLoading:!1,isError:!0}))}}),[e]);return Object(n.useEffect)((()=>(i(),()=>{s.current=!0,r.current.abort()})),[]),{...e}};var g=a(22),E=a(2);const f={[o.a.cases]:E.i18n.translate("xpack.cases.breadcrumbs.all_cases",{defaultMessage:"Cases"}),[o.a.casesCreate]:E.i18n.translate("xpack.cases.breadcrumbs.create_case",{defaultMessage:"Create"}),[o.a.casesConfigure]:E.i18n.translate("xpack.cases.breadcrumbs.configure_cases",{defaultMessage:"Configure"})},h=()=>{const{chrome:{docTitle:e,setBreadcrumbs:t},application:{navigateToUrl:a}}=Object(l.f)().services;return Object(n.useCallback)((n=>{e.change(function(e){return e.map((({text:e})=>{var t;return null!==(t=null==e?void 0:e.toString())&&void 0!==t?t:""})).reverse()}(n)),t(n.map((e=>{const{href:t,onClick:n}=e;return{...e,...t&&!n?{onClick:e=>{e&&e.preventDefault(),a(t)}}:{}}})))}),[e,t,a])},y=e=>{const{appId:t,appTitle:a}=Object(g.a)(),{getAppUrl:s}=Object(l.g)(t),r=h();Object(n.useEffect)((()=>{r([{text:a,href:s()},{text:f[o.a.cases],...e!==o.a.cases?{href:s({deepLinkId:o.a.cases})}:{}},...e!==o.a.cases?[{text:f[e]}]:[]])}),[e,a,s,r])};var C=a(12),v=a(64),j=a(16);const x=E.i18n.translate("xpack.cases.caseView.lockedIncidentDesc",{defaultMessage:"No update is required"}),w=E.i18n.translate("xpack.cases.caseView.pushToService.configureConnector",{defaultMessage:"To create and update a case in an external system, select a connector."}),I=E.i18n.translate("xpack.cases.caseView.pushToServiceDisableByConfigTitle",{defaultMessage:"Enable external service in Kibana configuration file"}),O=E.i18n.translate("xpack.cases.caseView.pushToServiceDisableByLicenseTitle",{defaultMessage:"Upgrade to an appropriate license"}),k=E.i18n.translate("xpack.cases.caseView.cloudDeploymentLink",{defaultMessage:"cloud deployment"}),T="closed-case-push-error",A=()=>({id:"license-error",title:"",description:s.a.createElement(v.FormattedMessage,{defaultMessage:"Opening cases in external systems is available when you have the {appropriateLicense}, are using a {cloud}, or are testing out a Free Trial.",id:"xpack.cases.caseView.pushToServiceDisableByLicenseDescription",values:{appropriateLicense:s.a.createElement(C.EuiLink,{href:"https://www.elastic.co/subscriptions",target:"_blank"},j.B),cloud:s.a.createElement(C.EuiLink,{href:"https://www.elastic.co/cloud/elasticsearch-service/signup",target:"_blank"},k)}})}),S=()=>({id:"kibana-config-error",title:I,description:s.a.createElement(v.FormattedMessage,{defaultMessage:"The kibana.yml file is configured to only allow specific connectors. To enable opening a case in external systems, add .[actionTypeId] (ex: .servicenow | .jira)  to the xpack.actions.enabledActiontypes setting. For more information, see {link}.",id:"xpack.cases.caseView.pushToServiceDisableByConfigDescription",values:{link:s.a.createElement(C.EuiLink,{href:"#",target:"_blank"},"coming soon...")}})});var F=a(146),N=a(34),L=a.n(N),D=a(128);const M=L.a.div.withConfig({displayName:"Wrapper",componentId:"sc-1pq4ix7-0"})(["",""],(({theme:e})=>Object(N.css)(["margin-top:",";.casesSubtitle__item{color:",";font-size:",";line-height:",";@media only screen and (min-width:","){display:inline-block;margin-right:",";&:last-child{margin-right:0;}}}"],e.eui.euiSizeS,e.eui.euiTextSubduedColor,e.eui.euiFontSizeXS,e.eui.euiLineHeight,e.eui.euiBreakpoints.s,e.eui.euiSize)));M.displayName="Wrapper";const R=s.a.memo((({children:e,dataTestSubj:t="header-panel-subtitle"})=>"string"==typeof e?s.a.createElement("p",{className:"casesSubtitle__item casesSubtitle__item--text","data-test-subj":t},e):s.a.createElement("div",{className:"casesSubtitle__item casesSubtitle__item--node","data-test-subj":t},e)));R.displayName="SubtitleItem";const B=s.a.memo((({items:e})=>s.a.createElement(M,{className:"casesSubtitle"},Array.isArray(e)?e.map(((e,t)=>s.a.createElement(R,{key:t},e))):s.a.createElement(R,null,e))));B.displayName="Subtitle";var z=a(10),U=a(102);const P=E.i18n.translate("xpack.cases.header.editableTitle.save",{defaultMessage:"Save"}),_=E.i18n.translate("xpack.cases.header.editableTitle.cancel",{defaultMessage:"Cancel"}),V=e=>E.i18n.translate("xpack.cases.header.editableTitle.editButtonAria",{values:{title:e},defaultMessage:"You can edit {title} by clicking"}),$=E.i18n.translate("xpack.cases.header.badge.experimentalLabel",{defaultMessage:"Technical preview"}),H=E.i18n.translate("xpack.cases.header.badge.experimentalDesc",{defaultMessage:"This functionality is in technical preview and may be changed or removed completely in a future release. Elastic will take a best effort approach to fix any issues, but features in technical preview are not subject to the support SLA of official GA features."}),G=E.i18n.translate("xpack.cases.header.badge.betaLabel",{defaultMessage:"Beta"}),q=E.i18n.translate("xpack.cases.header.badge.betaDesc",{defaultMessage:"This feature is currently in beta. If you encounter any bugs or have feedback, please open an issue or visit our discussion forum."}),W=()=>s.a.createElement(C.EuiBetaBadge,{label:$,tooltipContent:H,tooltipPosition:"bottom"});W.displayName="ExperimentalBadge";const Q=()=>s.a.createElement(C.EuiBetaBadge,{label:G,tooltipContent:q,tooltipPosition:"bottom"});Q.displayName="BetaBadge";const K=({title:e,releasePhase:t,children:a})=>s.a.createElement(C.EuiFlexGroup,{alignItems:"baseline",gutterSize:"s",responsive:!1},s.a.createElement(C.EuiFlexItem,{grow:!1},s.a.createElement(C.EuiFlexGroup,{alignItems:"center",gutterSize:"none",responsive:!1},s.a.createElement(C.EuiFlexItem,{grow:!1},s.a.createElement(C.EuiTitle,{size:"l"},s.a.createElement("h1",{"data-test-subj":"header-page-title"},Object(z.isString)(e)?s.a.createElement(U.a,{text:e}):e))),s.a.createElement(C.EuiFlexItem,{grow:!1},a))),s.a.createElement(C.EuiFlexItem,{grow:!1},"experimental"===t&&s.a.createElement(W,null),"beta"===t&&s.a.createElement(Q,null)));K.displayName="Title";const Y=s.a.memo(K),X=L.a.header.attrs({className:"casesHeaderPage"}).withConfig({displayName:"Header",componentId:"sc-1hwri6s-0"})(["",""],(({border:e,theme:t})=>Object(N.css)(["margin-bottom:",";",""],t.eui.euiSizeL,e&&Object(N.css)(["border-bottom:",";padding-bottom:",";.euiProgress{top:",";}"],t.eui.euiBorderThin,t.eui.paddingSizes.l,t.eui.paddingSizes.l))));X.displayName="Header";const J=L()(C.EuiFlexItem).withConfig({displayName:"FlexItem",componentId:"sc-1hwri6s-1"})(["display:block;"]);J.displayName="FlexItem";const Z=L.a.div.attrs({className:"casesHeaderPage__linkBack"}).withConfig({displayName:"LinkBack",componentId:"sc-1hwri6s-2"})(["",""],(({theme:e})=>Object(N.css)(["font-size:",";line-height:",";margin-bottom:",";"],e.eui.euiFontSizeXS,e.eui.euiLineHeight,e.eui.euiSizeS)));Z.displayName="LinkBack";const ee=({showBackButton:e=!1,border:t,children:a,isLoading:r,subtitle:i,subtitle2:l,title:c,titleNode:u,"data-test-subj":d})=>{const{releasePhase:m}=Object(g.a)(),{getAllCasesUrl:p,navigateToAllCases:b}=Object(o.i)(),E=Object(n.useCallback)((e=>{e&&e.preventDefault(),b()}),[b]);return s.a.createElement(X,{border:t,"data-test-subj":d},s.a.createElement(C.EuiFlexGroup,{alignItems:"center"},s.a.createElement(J,null,e&&s.a.createElement(Z,null,s.a.createElement(D.a,{dataTestSubj:"backToCases",onClick:E,href:p(),iconType:"arrowLeft"},j.h)),u||s.a.createElement(Y,{title:c,releasePhase:m}),i&&s.a.createElement(B,{"data-test-subj":"header-page-subtitle",items:i}),l&&s.a.createElement(B,{"data-test-subj":"header-page-subtitle-2",items:l}),t&&r&&s.a.createElement(C.EuiProgress,{size:"xs",color:"accent"})),a&&s.a.createElement(J,{"data-test-subj":"header-page-supplements",grow:!1},a)))};ee.displayName="HeaderPage";const te=s.a.memo(ee);var ae=a(80),ne=a(14),se=a(82);const re=L()(C.EuiFlexGroup).withConfig({displayName:"ButtonFlexGroup",componentId:"sc-1l550c5-0"})(["",""],(({theme:e})=>Object(N.css)(["&{@media only screen and (max-width:","){flex-direction:column;}}"],e.eui.euiBreakpoints.s))),ie=({actionsErrors:e})=>{const{getCreateCaseUrl:t,navigateToCreateCase:a}=Object(o.m)(),r=Object(n.useCallback)((e=>{e.preventDefault(),a()}),[a]);return s.a.createElement(re,{responsive:!1},s.a.createElement(C.EuiFlexItem,{grow:!1},s.a.createElement(se.b,{label:ae.i,isDisabled:!Object(ne.isEmpty)(e),showToolTip:!Object(ne.isEmpty)(e),msgTooltip:Object(ne.isEmpty)(e)?s.a.createElement(s.a.Fragment,null):s.a.createElement(s.a.Fragment,null,e[0].description),titleTooltip:Object(ne.isEmpty)(e)?"":e[0].title})),s.a.createElement(C.EuiFlexItem,null,s.a.createElement(se.d,{fill:!0,onClick:r,href:t(),iconType:"plusInCircle","data-test-subj":"createNewCaseBtn"},ae.k)))};ie.displayName="NavButtons";const oe=({actionsErrors:e,userCanCrud:t})=>s.a.createElement(te,{title:ae.u,border:!0,"data-test-subj":"cases-all-title"},s.a.createElement(C.EuiFlexGroup,{alignItems:"center",gutterSize:"m",wrap:!0,"data-test-subj":"all-cases-header"},t?s.a.createElement(C.EuiFlexItem,null,s.a.createElement(ie,{actionsErrors:e})):null));oe.displayName="CasesTableHeader";const le=()=>{const{userCanCrud:e}=Object(g.a)();y(o.a.cases);const{actionLicense:t}=b(),a=Object(n.useMemo)((()=>(e=>{let t=[];return null==e||e.enabledInLicense||(t=[...t,A()]),null==e||e.enabledInConfig||(t=[...t,S()]),t})(t)),[t]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(oe,{actionsErrors:a,userCanCrud:e}),s.a.createElement(F.a,null))};le.displayName="AllCases";const ce=(e,t)=>{var a;switch(t.type){case"FETCH_INIT":return{...e,isLoading:!(null!==(a=t.payload)&&void 0!==a&&a.silent),isError:!1};case"FETCH_SUCCESS":return{...e,isLoading:!1,isError:!1,data:t.payload.case,resolveOutcome:t.payload.outcome,resolveAliasId:t.payload.aliasTargetId,resolveAliasPurpose:t.payload.aliasPurpose};case"FETCH_FAILURE":return{...e,isLoading:!1,isError:!0};case"UPDATE_CASE":return{...e,data:t.payload};default:return e}},ue=E.i18n.translate("xpack.cases.caseView.actionLabel.addedField",{defaultMessage:"added"}),de=E.i18n.translate("xpack.cases.caseView.actionLabel.changededField",{defaultMessage:"changed"}),me=E.i18n.translate("xpack.cases.caseView.actionLabel.enabledSetting",{defaultMessage:"enabled"}),pe=E.i18n.translate("xpack.cases.caseView.actionLabel.disableSetting",{defaultMessage:"disabled"}),be=E.i18n.translate("xpack.cases.caseView.actionLabel.removedThirdParty",{defaultMessage:"removed external incident management system"}),ge=E.i18n.translate("xpack.cases.caseView.actionLabel.editedField",{defaultMessage:"edited"}),Ee=E.i18n.translate("xpack.cases.caseView.actionLabel.removedField",{defaultMessage:"removed"}),fe=E.i18n.translate("xpack.cases.caseView.actionLabel.pushedNewIncident",{defaultMessage:"pushed as new incident"}),he=E.i18n.translate("xpack.cases.caseView.actionLabel.updateIncident",{defaultMessage:"updated incident"}),ye=E.i18n.translate("xpack.cases.caseView.actionLabel.addDescription",{defaultMessage:"added description"}),Ce=E.i18n.translate("xpack.cases.caseView.edit.description",{defaultMessage:"Edit description"}),ve=E.i18n.translate("xpack.cases.caseView.edit.quote",{defaultMessage:"Quote"}),je=E.i18n.translate("xpack.cases.caseView.edit.comment",{defaultMessage:"Edit comment"}),xe=E.i18n.translate("xpack.cases.caseView.delete.comment",{defaultMessage:"Delete comment"}),we=E.i18n.translate("xpack.cases.caseView.deleteTitle.comment",{defaultMessage:"Delete this comment?"}),Ie=(E.i18n.translate("xpack.cases.caseView.actionLabel.on",{defaultMessage:"on"}),E.i18n.translate("xpack.cases.caseView.statusLabel",{defaultMessage:"Status"})),Oe=E.i18n.translate("xpack.cases.caseView.case",{defaultMessage:"case"}),ke=E.i18n.translate("xpack.cases.caseView.comment",{defaultMessage:"comment"}),Te=E.i18n.translate("xpack.cases.caseView.caseRefresh",{defaultMessage:"Refresh case"}),Ae=(E.i18n.translate("xpack.cases.caseView.activity",{defaultMessage:"Activity"}),E.i18n.translate("xpack.cases.caseView.fieldChanged",{defaultMessage:"changed connector field"}),E.i18n.translate("xpack.cases.caseView.syncAlertsLabel",{defaultMessage:"Sync alerts"})),Se=E.i18n.translate("xpack.cases.caseView.syncAlertsLowercaseLabel",{defaultMessage:"sync alerts"}),Fe=E.i18n.translate("xpack.cases.caseView.doesNotExist.title",{defaultMessage:"This case does not exist"}),Ne=e=>E.i18n.translate("xpack.cases.caseView.doesNotExist.description",{values:{caseId:e},defaultMessage:"A case with id {caseId} could not be found. This likely means the case has been deleted, or the id is incorrect."}),Le=E.i18n.translate("xpack.cases.caseView.doesNotExist.button",{defaultMessage:"Back to Cases"}),De=E.i18n.translate("xpack.cases.caseView.tabs.activity",{defaultMessage:"Activity"}),Me=E.i18n.translate("xpack.cases.caseView.tabs.alerts",{defaultMessage:"Alerts"}),Re=E.i18n.translate("xpack.cases.caseView.tabs.alerts.emptyDescription",{defaultMessage:"No alerts have been added to this case."});var Be=a(112);const ze=s.a.memo((({caseId:e})=>{const{navigateToAllCases:t}=Object(o.i)();return s.a.createElement(C.EuiEmptyPrompt,{iconColor:"default",iconType:"casesApp",title:s.a.createElement("h2",null,Fe),titleSize:"xs",body:s.a.createElement("p",null,Ne(e)),actions:s.a.createElement(C.EuiButton,{onClick:t,size:"s",color:"primary",fill:!0},Le)})}));ze.displayName="DoesNotExist";const Ue=(e,t)=>{var a;switch(t.type){case"FETCH_INIT":return{...e,isLoading:!(null!==(a=t.payload)&&void 0!==a&&a.silent),isError:!1};case"FETCH_SUCCESS":return{...e,isLoading:!1,isError:!1,metrics:t.payload};case"FETCH_FAILURE":return{...e,isLoading:!1,isError:!0};default:return e}};var Pe=a(137),_e=a.n(Pe);const Ve=e=>{var t;return(null==e?void 0:e.type)===d.a.connector&&null!=(null==e||null===(t=e.payload)||void 0===t?void 0:t.connector)},$e=e=>{var t;return(null==e?void 0:e.type)===d.a.pushed&&null!=(null==e||null===(t=e.payload)||void 0===t?void 0:t.externalService)},He=e=>{var t;return(null==e?void 0:e.type)===d.a.create_case&&null!=(null==e||null===(t=e.payload)||void 0===t?void 0:t.connector)},Ge={caseServices:{},caseUserActions:[],hasDataToPush:!1,isError:!1,isLoading:!0,participants:[]},qe=e=>e.reduce(((e,t)=>{var a,n;if((Ve(t)||He(t))&&(null===(a=t.payload)||void 0===a||null===(n=a.connector)||void 0===n?void 0:n.id)!==d.p){const a=t.payload.connector;return{...e,[a.id]:[...e[a.id]||[],a.fields]}}return e}),{}),We=(e,t)=>{const a=t=>{const a=[...e].reverse(),n=a.findIndex((e=>$e(e)&&e.payload.externalService.connectorId===t));if(-1===n)return!0;const s=a.length-n-1,r=e.slice(0,s),i=e.slice(s+1,a.length),o=(({connectorFieldsBeforePush:e,connectorFieldsAfterPush:t,connectorId:a})=>{if(null==t||null==t[a])return!1;const n=t[a];if(null!=e&&null!=e[a]){const t=e[a];return!_e()(t[t.length-1],n[n.length-1])}return n.length>=2&&!_e()(n[n.length-2],n[n.length-1])})({connectorFieldsBeforePush:qe(r),connectorFieldsAfterPush:qe(i),connectorId:t});return i.some((e=>e.type!==d.a.connector&&e.type!==d.a.pushed))||o},n=e.reduce(((e,t,a)=>t.type===d.a.comment&&null!=t.commentId?[...e,{commentId:t.commentId,commentIndex:a}]:e),[]);let s=e.reduce(((e,t,n)=>{if(!$e(t))return e;const s=t.payload.externalService;return null===s?e:{...e,...null!=e[s.connectorId]?{[s.connectorId]:{...e[s.connectorId],...s,lastPushIndex:n,commentsToUpdate:[]}}:{[s.connectorId]:{...s,firstPushIndex:n,lastPushIndex:n,hasDataToPush:a(s.connectorId),commentsToUpdate:[]}}}}),{});return s=Object.keys(s).reduce(((e,t)=>({...e,[t]:{...s[t],commentsToUpdate:n.reduce(((e,a)=>a.commentIndex>s[t].lastPushIndex?e.indexOf(a.commentId)>-1?[...e.filter((e=>e!==a.commentId)),a.commentId]:[...e,a.commentId]:e),[])}})),{}),{hasDataToPush:null==s[t]||s[t].hasDataToPush,caseServices:s}};var Qe=a(88),Ke=a(109),Ye=a(122);const Xe=E.i18n.translate("xpack.cases.caseView.editActionsLinkAria",{defaultMessage:"click to see all actions"}),Je="property-actions",Ze=s.a.memo((({disabled:e=!1,onClick:t,iconType:a,label:n})=>s.a.createElement(C.EuiButtonEmpty,{"aria-label":n,color:"text","data-test-subj":`${Je}-${a}`,iconSide:"left",iconType:a,isDisabled:e,onClick:t},n)));Ze.displayName="PropertyActionButton";const et=s.a.memo((({propertyActions:e})=>{const[t,a]=Object(n.useState)(!1),r=Object(n.useCallback)((()=>{a(!t)}),[t]),i=Object(n.useCallback)((e=>{a(!1),null!=e&&e()}),[]);return s.a.createElement(C.EuiPopover,{anchorPosition:"downRight","data-test-subj":Je,ownFocus:!0,button:s.a.createElement(C.EuiButtonIcon,{"data-test-subj":`${Je}-ellipses`,"aria-label":Xe,iconType:"boxesHorizontal",onClick:r}),id:"settingsPopover",isOpen:t,closePopover:i,repositionOnScroll:!0},s.a.createElement(C.EuiFlexGroup,{alignItems:"flexStart","data-test-subj":`${Je}-group`,direction:"column",gutterSize:"none"},e.map(((e,t)=>s.a.createElement(C.EuiFlexItem,{grow:!1,key:`${e.label}${t}`},s.a.createElement("span",null,s.a.createElement(Ze,{disabled:e.disabled,iconType:e.iconType,label:e.label,onClick:()=>i(e.onClick)})))))))}));et.displayName="PropertyActions";const tt=({caseData:e,currentExternalIncident:t})=>{const{handleToggleModal:a,handleOnDeleteConfirm:r,isDeleted:i,isDisplayConfirmDeleteModal:l}=Object(Ke.a)(),{navigateToAllCases:c}=Object(o.i)(),u=Object(n.useMemo)((()=>{var e,n;return[{iconType:"trash",label:j.x(),onClick:a},...null==t||Object(ne.isEmpty)(null==t?void 0:t.externalUrl)?[]:[{iconType:"popout",label:(n=null!==(e=null==t?void 0:t.externalTitle)&&void 0!==e?e:"",E.i18n.translate("xpack.cases.caseView.actionLabel.viewIncident",{defaultMessage:"View {incidentNumber}",values:{incidentNumber:n}})),onClick:()=>window.open(null==t?void 0:t.externalUrl,"_blank")}]]}),[a,t]);return i?(c(),null):s.a.createElement(s.a.Fragment,null,s.a.createElement(et,{propertyActions:u}),s.a.createElement(Ye.a,{caseTitle:e.title,isModalVisible:l,onCancel:a,onConfirm:r.bind(null,[{id:e.id,title:e.title}])}))};tt.displayName="Actions";const at=s.a.memo(tt);var nt=a(126);const st=({disabled:e,isSynced:t=!0,showLabel:a=!1,onSwitchChange:r})=>{const[i,o]=Object(n.useState)(t),l=Object(n.useCallback)((()=>{r&&r(!i),o(!i)}),[i,r]);return s.a.createElement(C.EuiSwitch,{label:i?j.ab:j.Z,showLabel:a,checked:i,onChange:l,disabled:e,"data-test-subj":"sync-alerts-switch"})};st.displayName="SyncAlertsSwitchComponent";const rt=Object(n.memo)(st);var it=a(108),ot=a(99);const lt=L()(C.EuiDescriptionList).withConfig({displayName:"MyDescriptionList",componentId:"sc-ns1eu-0"})(["",""],(({theme:e})=>Object(N.css)(["&{padding-right:",";border-right:",";@media only screen and (max-width:","){padding-right:0;border-right:0;}}"],e.eui.euiSizeL,e.eui.euiBorderThin,e.eui.euiBreakpoints.m))),ct=({caseData:e,currentExternalIncident:t,userCanCrud:a,isLoading:r,onRefresh:i,onUpdateField:o})=>{const{isSyncAlertsEnabled:l,metricsFeatures:c}=Object(Qe.a)(),u=Object(n.useMemo)((()=>{return(t=e).status===d.h.open?t.createdAt:t.status===d.h["in-progress"]?t.updatedAt:t.status===d.h.closed?t.closedAt:null;var t}),[e]),m=Object(n.useMemo)((()=>{return t=e.status,ot.b[t].actionBar.title;var t}),[e.status]),p=Object(n.useCallback)((e=>o({key:"status",value:e})),[o]),b=Object(n.useCallback)((t=>o({key:"settings",value:{...e.settings,syncAlerts:t}})),[e.settings,o]);return s.a.createElement(C.EuiFlexGroup,{gutterSize:"l",justifyContent:"flexEnd","data-test-subj":"case-action-bar-wrapper"},s.a.createElement(C.EuiFlexItem,{grow:!1},s.a.createElement(lt,{compressed:!0},s.a.createElement(C.EuiFlexGroup,{responsive:!1,justifyContent:"spaceBetween"},s.a.createElement(C.EuiFlexItem,{grow:!1,"data-test-subj":"case-view-status"},s.a.createElement(C.EuiDescriptionListTitle,null,Ie),s.a.createElement(C.EuiDescriptionListDescription,null,s.a.createElement(nt.a,{currentStatus:e.status,disabled:!a||r,onStatusChanged:p}))),c.includes("lifespan")?null:s.a.createElement(C.EuiFlexItem,{grow:!1},s.a.createElement(C.EuiDescriptionListTitle,null,m),s.a.createElement(C.EuiDescriptionListDescription,null,s.a.createElement(it.a,{"data-test-subj":"case-action-bar-status-date",value:u})))))),s.a.createElement(C.EuiFlexItem,{grow:!1},s.a.createElement(C.EuiDescriptionList,{compressed:!0},s.a.createElement(C.EuiFlexGroup,{gutterSize:"l",alignItems:"center",responsive:!1,justifyContent:"spaceBetween"},a&&l&&s.a.createElement(C.EuiFlexItem,{grow:!1},s.a.createElement(C.EuiDescriptionListTitle,null,s.a.createElement(C.EuiFlexGroup,{component:"span",alignItems:"center",gutterSize:"xs",responsive:!1},s.a.createElement(C.EuiFlexItem,{grow:!1},s.a.createElement("span",null,Ae)),s.a.createElement(C.EuiFlexItem,{grow:!1},s.a.createElement(C.EuiIconTip,{content:j.Y})))),s.a.createElement(C.EuiDescriptionListDescription,null,s.a.createElement(rt,{disabled:r,isSynced:e.settings.syncAlerts,onSwitchChange:b}))),s.a.createElement(C.EuiFlexItem,{grow:!1},s.a.createElement("span",null,s.a.createElement(C.EuiButtonEmpty,{"data-test-subj":"case-refresh",flush:"left",iconType:"refresh",onClick:i},Te))),a&&s.a.createElement(C.EuiFlexItem,{grow:!1,"data-test-subj":"case-view-actions"},s.a.createElement(at,{caseData:e,currentExternalIncident:t}))))))};ct.displayName="CaseActionBar";const ut=s.a.memo(ct);var dt=a(3);const mt=L()(C.EuiButtonIcon).withConfig({displayName:"MyEuiButtonIcon",componentId:"sc-4bg36g-0"})(["",""],(({theme:e})=>Object(N.css)(["margin-left:",";"],e.eui.euiSize))),pt=L()(C.EuiLoadingSpinner).withConfig({displayName:"MySpinner",componentId:"sc-4bg36g-1"})(["",""],(({theme:e})=>Object(N.css)(["margin-left:",";"],e.eui.euiSize))),bt=({userCanCrud:e=!1,onSubmit:t,isLoading:a,title:r})=>{const{releasePhase:i}=Object(g.a)(),[o,l]=Object(n.useState)(!1),[c,u]=Object(n.useState)([]),[d,m]=Object(n.useState)(r),p=Object(n.useCallback)((()=>{l(!1),u([]),m(r)}),[r]),b=Object(n.useCallback)((()=>l(!0)),[]),E=Object(n.useCallback)((()=>{d.length>dt.C?u([j.E("title",dt.C)]):(d!==r&&t(d),l(!1),u([]))}),[d,t,r]),f=Object(n.useCallback)((e=>m(e.target.value)),[]),h=c.length>0;return o?s.a.createElement(C.EuiFormRow,{isInvalid:h,error:c,fullWidth:!0},s.a.createElement(C.EuiFlexGroup,{alignItems:"center",responsive:!0,gutterSize:"m",justifyContent:"spaceBetween"},s.a.createElement(C.EuiFlexItem,{grow:!0},s.a.createElement(C.EuiFieldText,{fullWidth:!0,onChange:f,value:`${d}`,"data-test-subj":"editable-title-input-field"})),s.a.createElement(C.EuiFlexItem,{grow:!1},s.a.createElement(C.EuiButton,{color:"success","data-test-subj":"editable-title-submit-btn",fill:!0,iconType:"save",onClick:E,size:"s"},P)),s.a.createElement(C.EuiFlexItem,{grow:!1},s.a.createElement(C.EuiButtonEmpty,{"data-test-subj":"editable-title-cancel-btn",iconType:"cross",onClick:p,size:"s"},_)))):s.a.createElement(Y,{title:r,releasePhase:i},a&&s.a.createElement(pt,{"data-test-subj":"editable-title-loading"}),!a&&e&&s.a.createElement(mt,{"aria-label":V(r),iconType:"pencil",onClick:b,"data-test-subj":"editable-title-edit-icon"}))};bt.displayName="EditableTitle";const gt=s.a.memo(bt);var Et=a(111),ft=a(100),ht=a(93),yt=a(78),Ct=a(130),vt=a(148);const jt={connectorId:{type:yt.a.SUPER_SELECT}},xt=(e,t)=>{for(const a of[...t].reverse())if(Ve(a)||He(a)){const t=a.payload.connector;if(t&&e===t.id)return t.fields}return null},wt=E.i18n.translate("xpack.cases.editConnector.editConnectorLinkAria",{defaultMessage:"click to edit connector"});var It=a(79),Ot=a(135);const kt=E.i18n.translate("xpack.cases.addConnector.title",{defaultMessage:"Add connector"}),Tt=E.i18n.translate("xpack.cases.caseView.pushToServiceDisableBecauseCaseClosedTitle",{defaultMessage:"Reopen the case"}),At=E.i18n.translate("xpack.cases.caseView.errorsPushServiceCallOutTitle",{defaultMessage:"Select an external connector"}),St=({handleButtonClick:e,id:t,messages:a,type:r,hasLicenseError:i})=>{const o=Object(n.useCallback)((a=>e(a,t,r)),[e,t,r]),l=Object(n.useMemo)((()=>a.map((e=>e.id)).includes(T)),[a]);return Object(ne.isEmpty)(a)?null:s.a.createElement(C.EuiCallOut,{title:l?Tt:i?O:At,color:r,iconType:"gear","data-test-subj":`case-callout-${t}`,size:"s"},s.a.createElement(C.EuiDescriptionList,{"data-test-subj":`callout-messages-${t}`,listItems:a}),!l&&!i&&s.a.createElement(C.EuiButton,{"data-test-subj":`callout-onclick-${t}`,color:"success"===r?"success":r,onClick:o},kt))};St.displayName="CallOut";const Ft=Object(n.memo)(St);var Nt=a(152),Lt=a.n(Nt);const Dt=({hasConnectors:e,hasLicenseError:t,onEditClick:a,messages:r=[]})=>{const{navigateToConfigureCases:i}=Object(o.l)(),l=Object(n.useCallback)((t=>{t.preventDefault(),e?a():i()}),[e,a,i]),c=Object(n.useMemo)((()=>r.reduce(((e,t)=>{var a,n,s,r;const i=null==t.errorType?"primary":t.errorType;return{...e,[i]:{messagesId:[...null!==(a=null===(n=e[i])||void 0===n?void 0:n.messagesId)&&void 0!==a?a:[],t.id],messages:[...null!==(s=null===(r=e[i])||void 0===r?void 0:r.messages)&&void 0!==s?s:[],t]}}}),{})),[r]);return s.a.createElement(s.a.Fragment,null,Object.keys(c).map((e=>{const a=((e,t="|")=>Lt()(e.join(t)))(c[e].messagesId);return s.a.createElement(s.a.Fragment,{key:a},s.a.createElement(Ft,{handleButtonClick:l,id:a,messages:c[e].messages,type:e,hasLicenseError:t}),s.a.createElement(C.EuiSpacer,null))})))};Dt.displayName="CaseCallOut";const Mt=Object(n.memo)(Dt),Rt=L()(C.EuiFlexGroup).withConfig({displayName:"MyFlexGroup",componentId:"sc-cj1kee-0"})(["",""],(({theme:e})=>`\n    margin-top: ${e.eui.euiSizeM};\n    p {\n      font-size: ${e.eui.euiSizeM};\n    }\n  `)),Bt=L()(C.EuiFlexItem).withConfig({displayName:"DisappearingFlexItem",componentId:"sc-cj1kee-1"})(["",""],(({$isHidden:e})=>e&&"\n      margin: 0 !important;\n      & .euiFlexItem {\n        margin: 0 !important;\n      }\n    ")),zt=(e,t)=>{switch(t.type){case"SET_CURRENT_CONNECTOR":return{...e,currentConnector:t.payload};case"SET_FIELDS":return{...e,fields:t.payload};case"SET_EDIT_CONNECTOR":return{...e,editConnector:t.payload};default:return e}},Ut={currentConnector:null,fields:null,editConnector:!1},Pt=s.a.memo((({caseData:e,caseServices:t,connectorName:a,connectors:r,hasDataToPush:i,isLoading:o,isValidConnector:c,onSubmit:u,updateCase:m,userActions:p,userCanCrud:g=!0})=>{const f=e.connector.fields,h=e.connector.id,{form:y}=Object(yt.j)({defaultValue:{connectorId:h},options:{stripEmptyFields:!1},schema:jt}),{actions:I}=Object(l.b)(),O=I.read,[k,F]=Object(n.useState)(!1),{setFieldValue:N,submit:L}=y,[{currentConnector:D,fields:M,editConnector:R},B]=Object(n.useReducer)(zt,{...Ut,fields:f});Object(n.useEffect)((()=>{const e=!(null===D&&h===d.p)&&(null==D?void 0:D.id)!==h||!_e()(M,f);F(e)}),[f,D,M,h]),Object(n.useEffect)((()=>{o||(B({type:"SET_CURRENT_CONNECTOR",payload:Object(It.a)(e.connector.id,r)}),B({type:"SET_FIELDS",payload:f}))}),[e.connector.id,r,o,f]);const z=Object(n.useCallback)((e=>{(null==D?void 0:D.id)!==e&&(B({type:"SET_CURRENT_CONNECTOR",payload:Object(It.a)(e,r)}),B({type:"SET_FIELDS",payload:xt(e,null!=p?p:[])}))}),[D,p,r]),U=Object(n.useCallback)((e=>{_e()(e,M)||B({type:"SET_FIELDS",payload:e})}),[M,B]),P=Object(n.useCallback)((()=>{N("connectorId",h),B({type:"SET_EDIT_CONNECTOR",payload:!1})}),[B,N,h]),_=Object(n.useCallback)((()=>{N("connectorId",h),B({type:"SET_FIELDS",payload:f}),B({type:"SET_EDIT_CONNECTOR",payload:!1})}),[B,h,N,f]),V=Object(n.useCallback)((async()=>{const{isValid:e,data:t}=await L();e&&t.connectorId&&(u(t.connectorId,M,P,ne.noop),B({type:"SET_EDIT_CONNECTOR",payload:!1}))}),[B,L,M,u,P]),$=Object(n.useCallback)((()=>{B({type:"SET_EDIT_CONNECTOR",payload:!0})}),[B]),H=Object(It.c)({config:jt.connectorId,connectors:r}),{pushButton:G,pushCallouts:q}=(({caseId:e,caseServices:t,caseStatus:a,connector:r,connectors:i,hasDataToPush:o,isValidConnector:l,onEditClick:c,updateCase:u,userCanCrud:m})=>{const{isLoading:p,pushCaseToExternalService:g}=Object(Ot.a)(),{isLoading:f,actionLicense:h}=b(),y=null!=h&&!h.enabledInLicense,I=Object(n.useCallback)((async()=>{if(null!=r.id&&"none"!==r.id){const t=await g({caseId:e,connector:r});null!=t&&u(t)}}),[e,r,g,u]),O=Object(n.useMemo)((()=>{const e=[];return m?y?[A()]:null==h||h.enabledInConfig?"none"!==r.id||f||y?l||f||y?a===d.h.closed?[{id:T,title:"",description:s.a.createElement(v.FormattedMessage,{defaultMessage:"Closed cases cannot be sent to external systems. Reopen the case if you want to open or update it in an external system.",id:"xpack.cases.caseView.pushToServiceDisableBecauseCaseClosedDescription"})}]:e:[{id:"connector-deleted-error",title:"",description:s.a.createElement(v.FormattedMessage,{defaultMessage:"The connector used to send updates to the external service has been deleted or you do not have the {appropriateLicense} to use it. To update cases in external systems, select a different connector or create a new one.",id:"xpack.cases.configureCases.warningMessage",values:{appropriateLicense:s.a.createElement(C.EuiLink,{href:"https://www.elastic.co/subscriptions",target:"_blank"},j.B)}}),errorType:"danger"}]:[{id:"connector-missing-error",title:"",description:w}]:[S()]:e}),[h,a,i.length,r,f,m]),k=Object(n.useMemo)((()=>{return s.a.createElement(C.EuiButtonEmpty,{"data-test-subj":"push-to-external-service",iconType:"importAction",onClick:I,disabled:p||f||O.length>0||!m||!l||!o,isLoading:p},t[r.id]?"none"===(e=r.name)?E.i18n.translate("xpack.cases.caseView.updateThirdPartyIncident",{defaultMessage:"Update external incident"}):E.i18n.translate("xpack.cases.caseView.updateNamedIncident",{values:{thirdParty:e},defaultMessage:"Update { thirdParty } incident"}):(e=>"none"===e?E.i18n.translate("xpack.cases.caseView.pushThirdPartyIncident",{defaultMessage:"Push as external incident"}):E.i18n.translate("xpack.cases.caseView.pushNamedIncident",{values:{thirdParty:e},defaultMessage:"Push as { thirdParty } incident"}))(r.name));var e}),[r,i,O,I,o,p,f,m,l]);return Object(n.useMemo)((()=>{return{pushButton:O.length>0||!o?s.a.createElement(C.EuiToolTip,{position:"top",title:O.length>0?O[0].title:(e=r.name,"none"===e?E.i18n.translate("xpack.cases.caseView.lockedIncidentTitleNone",{defaultMessage:"External incident is up to date"}):E.i18n.translate("xpack.cases.caseView.lockedIncidentTitle",{values:{thirdParty:e},defaultMessage:"{ thirdParty } incident is up to date"})),content:s.a.createElement("p",null,O.length>0?O[0].description:x)},k):s.a.createElement(s.a.Fragment,null,k),pushCallouts:O.length>0?s.a.createElement(Mt,{hasConnectors:i.length>0,hasLicenseError:y,messages:O,onEditClick:c}):null};var e}),[r.name,i.length,O,o,y,c,k])})({connector:{...e.connector,name:Object(ne.isEmpty)(a)?e.connector.name:a},caseServices:t,caseId:e.id,caseStatus:e.status,connectors:r,hasDataToPush:i,onEditClick:$,updateCase:m,userCanCrud:g,isValidConnector:c});return s.a.createElement(C.EuiText,null,s.a.createElement(Rt,{alignItems:"center",gutterSize:"xs",justifyContent:"spaceBetween",responsive:!1},s.a.createElement(C.EuiFlexItem,{grow:!1,"data-test-subj":"connector-edit-header"},s.a.createElement("h4",null,j.t)),o&&s.a.createElement(C.EuiLoadingSpinner,{"data-test-subj":"connector-loading"}),!o&&!R&&g&&O&&s.a.createElement(C.EuiFlexItem,{"data-test-subj":"connector-edit",grow:!1},s.a.createElement(C.EuiButtonIcon,{"data-test-subj":"connector-edit-button","aria-label":wt,iconType:"pencil",onClick:$}))),s.a.createElement(C.EuiHorizontalRule,{margin:"xs"}),s.a.createElement(Rt,{"data-test-subj":"edit-connectors",direction:"column"},!o&&!R&&q&&O&&s.a.createElement(C.EuiFlexItem,{"data-test-subj":"push-callouts"},q),s.a.createElement(Bt,{$isHidden:!R},s.a.createElement(yt.c,{form:y},s.a.createElement(C.EuiFlexGroup,{gutterSize:"none",direction:"row"},s.a.createElement(C.EuiFlexItem,null,s.a.createElement(yt.e,{path:"connectorId",config:H,component:Ct.a,componentProps:{connectors:r,dataTestSubj:"caseConnectors",defaultValue:h,disabled:!g,idAria:"caseConnectors",isEdit:R,isLoading:o},onChange:z}))))),s.a.createElement(C.EuiFlexItem,{"data-test-subj":"edit-connector-fields-form-flex-item"},!R&&!O&&s.a.createElement(C.EuiText,{"data-test-subj":"edit-connector-permissions-error-msg",size:"s"},s.a.createElement("span",null,j.P)),s.a.createElement(vt.a,{connector:D,fields:M,isEdit:R,onChange:U})),R&&s.a.createElement(C.EuiFlexItem,null,s.a.createElement(C.EuiFlexGroup,{gutterSize:"s",alignItems:"center",responsive:!1},s.a.createElement(C.EuiFlexItem,{grow:!1},s.a.createElement(C.EuiButton,{disabled:!k,color:"success","data-test-subj":"edit-connectors-submit",fill:!0,iconType:"save",onClick:V,size:"s"},j.T)),s.a.createElement(C.EuiFlexItem,{grow:!1},s.a.createElement(C.EuiButtonEmpty,{"data-test-subj":"edit-connectors-cancel",iconType:"cross",onClick:_,size:"s"},j.i)))),null==q&&!o&&!R&&g&&O&&s.a.createElement(C.EuiFlexItem,{"data-test-subj":"has-data-to-push-button",grow:!1},s.a.createElement("span",null,G))))}));Pt.displayName="EditConnector";var _t=a(91);const Vt=({status:e,onStatusChanged:t,isLoading:a})=>{const r=Object(n.useMemo)((()=>d.s.findIndex((t=>t===e))),[e]),i=Object(n.useMemo)((()=>(r+1)%d.s.length),[r]),o=Object(n.useCallback)((()=>{t(d.s[i])}),[i,t]);return s.a.createElement(C.EuiButton,{"data-test-subj":"case-view-status-action-button",iconType:_t.b[d.s[i]].icon,isLoading:a,onClick:o},_t.b[d.s[i]].button.label)};Vt.displayName="StatusActionButton";const $t=Object(n.memo)(Vt),Ht=E.i18n.translate("xpack.cases.caseView.editTagsLinkAria",{defaultMessage:"click to edit tags"}),Gt={tags:a(119).b};var qt=a(104);const Wt=L()(C.EuiBadge).withConfig({displayName:"MyEuiBadge",componentId:"sc-1rutbhv-0"})(["max-width:200px;"]),Qt=({tags:e,color:t="default",gutterSize:a})=>s.a.createElement(s.a.Fragment,null,e.length>0&&s.a.createElement(C.EuiBadgeGroup,{gutterSize:a},e.map((e=>s.a.createElement(Wt,{"data-test-subj":`tag-${e}`,color:t,key:e},e)))));Qt.displayName="Tags";const Kt=Object(n.memo)(Qt),Yt=Object(yt.i)({component:yt.b}),Xt=L()(C.EuiFlexGroup).withConfig({displayName:"MyFlexGroup",componentId:"sc-7s25zb-0"})(["",""],(({theme:e})=>Object(N.css)(["width:100%;margin-top:",";p{font-size:",";}"],e.eui.euiSizeM,e.eui.euiSizeM))),Jt=L()(C.EuiFlexGroup).withConfig({displayName:"ColumnFlexGroup",componentId:"sc-7s25zb-1"})(["",""],(({theme:e})=>Object(N.css)(["&{max-width:100%;@media only screen and (max-width:","){flex-direction:row;}}"],e.eui.euiBreakpoints.m))),Zt=s.a.memo((({userCanCrud:e=!0,isLoading:t,onSubmit:a,tags:r})=>{const i={tags:r},{form:o}=Object(yt.j)({defaultValue:i,options:{stripEmptyFields:!1},schema:Gt}),{submit:l}=o,[c,u]=Object(n.useState)(!1),d=Object(n.useCallback)((async()=>{const{isValid:e,data:t}=await l();e&&t.tags&&(a(t.tags),o.reset({defaultValue:t}),u(!1))}),[a,l]),{tags:m}=Object(qt.a)(),[p,b]=Object(n.useState)(m.map((e=>({label:e}))));return Object(n.useEffect)((()=>b(m.map((e=>({label:e}))))),[m]),s.a.createElement(C.EuiText,null,s.a.createElement(C.EuiFlexGroup,{alignItems:"center",gutterSize:"xs",justifyContent:"spaceBetween",responsive:!1},s.a.createElement(C.EuiFlexItem,{grow:!1},s.a.createElement("h4",null,j.bb)),t&&s.a.createElement(C.EuiLoadingSpinner,{"data-test-subj":"tag-list-loading"}),!t&&e&&s.a.createElement(C.EuiFlexItem,{"data-test-subj":"tag-list-edit",grow:!1},s.a.createElement(C.EuiButtonIcon,{"data-test-subj":"tag-list-edit-button","aria-label":Ht,iconType:"pencil",onClick:u.bind(null,!0)}))),s.a.createElement(C.EuiHorizontalRule,{margin:"xs"}),s.a.createElement(Xt,{gutterSize:"none","data-test-subj":"case-tags"},0===r.length&&!c&&s.a.createElement("p",{"data-test-subj":"no-tags"},j.I),!c&&s.a.createElement(C.EuiFlexItem,null,s.a.createElement(Kt,{tags:r,color:"hollow"})),c&&s.a.createElement(Jt,{"data-test-subj":"edit-tags",direction:"column"},s.a.createElement(C.EuiFlexItem,null,s.a.createElement(yt.c,{form:o},s.a.createElement(Yt,{path:"tags",componentProps:{idAria:"caseTags","data-test-subj":"caseTags",euiFieldProps:{fullWidth:!0,placeholder:"",options:p,noSuggestions:!1}}}),s.a.createElement(yt.d,{pathsToWatch:"tags"},(({tags:e})=>{const t=p.map((e=>e.label)),a=e.reduce(((e,t)=>e.includes(t)?e:[...e,t]),t);return Object(ne.isEqual)(t,a)||b(a.map((e=>({label:e})))),null})))),s.a.createElement(C.EuiFlexItem,null,s.a.createElement(C.EuiFlexGroup,{gutterSize:"s",alignItems:"center",responsive:!1},s.a.createElement(C.EuiFlexItem,{grow:!1},s.a.createElement(C.EuiButton,{color:"success","data-test-subj":"edit-tags-submit",fill:!0,iconType:"save",onClick:d,size:"s"},j.T)),s.a.createElement(C.EuiFlexItem,{grow:!1},s.a.createElement(C.EuiButtonEmpty,{"data-test-subj":"edit-tags-cancel",iconType:"cross",onClick:u.bind(null,!1),size:"s"},j.i)))))))}));Zt.displayName="TagList";var ea=a(41),ta=a(98);const{emptyField:aa}=yt.g,na={comment:{type:yt.a.TEXTAREA,validations:[{validator:aa(j.r)}]}};var sa=a(134);const ra=L()(C.EuiLoadingSpinner).withConfig({displayName:"MySpinner",componentId:"sc-1b6ejct-0"})(["position:absolute;top:50%;left:50%;"]),ia={comment:""},oa=s.a.memo(Object(n.forwardRef)((({id:e,caseId:t,userCanCrud:a,onCommentPosted:r,onCommentSaving:i,showLoading:o=!0,statusActionButton:l},c)=>{const u=Object(n.useRef)(null),[m,p]=Object(n.useState)(!1),{owner:b}=Object(g.a)(),{isLoading:E,createAttachments:f}=Object(ea.a)(),{form:h}=Object(yt.j)({defaultValue:ia,options:{stripEmptyFields:!1},schema:na}),y="comment",{setFieldValue:v,reset:x,submit:w}=h,[{comment:I}]=Object(yt.l)({form:h,watch:[y]}),O=Object(n.useCallback)((e=>{const t=`> ${e.replace(new RegExp("\r?\n","g"),"\n> ")} \n\n`;v(y,`${I}${I.length>0?"\n\n":""}${t}`),p(!0)}),[I,v]),k=Object(n.useCallback)((e=>{v(y,e)}),[v]);Object(n.useImperativeHandle)(c,(()=>({addQuote:O,setComment:k,editor:u.current})));const T=Object(n.useCallback)((async()=>{const{isValid:e,data:a}=await w();e&&(null!=i&&i(),f({caseId:t,data:[{...a,type:d.n.user,owner:b[0]}],updateCase:r}),x())}),[w,i,f,t,b,r,x]);return Object(n.useEffect)((()=>{var e,t;Object(z.isEmpty)(I)||null===(e=u.current)||void 0===e||null===(t=e.textarea)||void 0===t||t.focus(),m&&p(!1)}),[m]),s.a.createElement("span",{id:"add-comment-permLink"},E&&o&&s.a.createElement(ra,{"data-test-subj":"loading-spinner",size:"xl"}),a&&s.a.createElement(yt.c,{form:h},s.a.createElement(yt.e,{path:y,component:ta.a,componentProps:{ref:u,id:e,idAria:"caseComment",isDisabled:E,dataTestSubj:"add-comment",placeholder:j.c,bottomRightContent:s.a.createElement(C.EuiFlexGroup,{gutterSize:"s",alignItems:"flexEnd",responsive:!1,wrap:!0},l&&s.a.createElement(C.EuiFlexItem,{grow:!1},l),s.a.createElement(C.EuiFlexItem,{grow:!1},s.a.createElement(C.EuiButton,{"data-test-subj":"submit-comment",fill:!0,iconType:"plusInCircle",isDisabled:E,isLoading:E,onClick:T},j.b)))}}),s.a.createElement(sa.a,{fieldName:"comment"})))})));oa.displayName="AddComment";const la=e=>E.i18n.translate("xpack.cases.caseView.requiredUpdateToExternalService",{values:{externalService:e},defaultMessage:"Requires update to { externalService } incident"}),ca=E.i18n.translate("xpack.cases.caseView.copyCommentLinkAria",{defaultMessage:"Copy reference link"}),ua=E.i18n.translate("xpack.cases.caseView.moveToCommentAria",{defaultMessage:"Highlight the referenced comment"}),da=E.i18n.translate("xpack.cases.caseView.alertCommentLabelTitle",{defaultMessage:"added an alert from"}),ma=E.i18n.translate("xpack.cases.caseView.showAlertTooltip",{defaultMessage:"Show alert details"}),pa=E.i18n.translate("xpack.cases.caseView.showAlertTableTooltip",{defaultMessage:"Show alerts"}),ba=E.i18n.translate("xpack.cases.caseView.unknownRule.label",{defaultMessage:"Unknown rule"}),ga=E.i18n.translate("xpack.cases.caseView.isolatedHost",{defaultMessage:"submitted isolate request on host"}),Ea=E.i18n.translate("xpack.cases.caseView.releasedHost",{defaultMessage:"submitted release request on host"}),fa=E.i18n.translate("xpack.cases.caseView.delete.cancel",{defaultMessage:"Cancel"}),ha=E.i18n.translate("xpack.cases.caseView.delete.confirm",{defaultMessage:"Delete"}),ya=({username:e,fullName:t,size:a="m"})=>{const n=t&&t.length>0?t:null!=e?e:j.gb;return s.a.createElement(C.EuiAvatar,{name:n,"data-test-subj":"user-action-avatar",size:a})};ya.displayName="UserActionAvatar";const Ca=Object(n.memo)(ya),va=({username:e,fullName:t})=>{var a;const n=null!==(a=Object(ne.isEmpty)(t)?e:t)&&void 0!==a?a:j.gb;return s.a.createElement(C.EuiToolTip,{position:"top",content:s.a.createElement("p",null,n),"data-test-subj":"user-action-username-tooltip"},s.a.createElement("strong",null,null!=e?e:j.gb.toLowerCase()))};va.displayName="UserActionUsername";const ja=Object(n.memo)(va);var xa=a(124);const wa=({createdAt:e,updatedAt:t})=>s.a.createElement(s.a.Fragment,null,s.a.createElement(xa.a,{date:new Date(e)},s.a.createElement(v.FormattedRelative,{"data-test-subj":"user-action-title-creation-relative-time",value:e})),t&&s.a.createElement(C.EuiTextColor,{color:"subdued"}," (",ge," ",s.a.createElement(xa.a,{date:new Date(t)},s.a.createElement(v.FormattedRelative,{"data-test-subj":"user-action-title-edited-relative-time",value:t})),")"));wa.displayName="UserActionTimestamp";const Ia=Object(n.memo)(wa),Oa=({username:e,fullName:t})=>s.a.createElement(C.EuiFlexGroup,{responsive:!1,alignItems:"center",gutterSize:"s","data-test-subj":"user-action-username-with-avatar"},s.a.createElement(C.EuiFlexItem,{grow:!1},s.a.createElement(Ca,{username:e,fullName:t,size:"s"})),s.a.createElement(C.EuiFlexItem,{grow:!1},s.a.createElement(ja,{username:e,fullName:t})));Oa.displayName="UserActionUsernameWithAvatar";const ka=Object(n.memo)(Oa);var Ta=a(155),Aa=a.n(Ta);const Sa=({id:e})=>{const{getCaseViewUrl:t}=Object(o.j)(),{detailName:a}=Object(o.k)(),r=Object(n.useCallback)((()=>{Aa()(t({detailName:a,commentId:e},!0))}),[a,e,t]);return s.a.createElement(C.EuiToolTip,{position:"top",content:s.a.createElement("p",null,ca)},s.a.createElement(C.EuiButtonIcon,{"aria-label":ca,"data-test-subj":`copy-link-${e}`,onClick:r,iconType:"link",id:`${e}-permLink`}))};Sa.displayName="UserActionCopyLink";const Fa=Object(n.memo)(Sa),Na=({id:e,outlineComment:t})=>{const a=Object(n.useCallback)((()=>{t(e)}),[e,t]);return s.a.createElement(C.EuiToolTip,{position:"top",content:s.a.createElement("p",null,ua)},s.a.createElement(C.EuiButtonIcon,{"aria-label":ua,"data-test-subj":`move-to-link-${e}`,onClick:a,iconType:"arrowUp"}))};Na.displayName="UserActionMoveToReference";const La=Object(n.memo)(Na),Da=(e,t)=>e===d.b.update&&null!=t;s.a.memo((({userAction:e,handleOutlineComment:t})=>s.a.createElement(C.EuiFlexGroup,{responsive:!1},s.a.createElement(C.EuiFlexItem,{grow:!1},s.a.createElement(Fa,{id:e.actionId})),Da(e.action,e.commentId)&&s.a.createElement(C.EuiFlexItem,{grow:!1},s.a.createElement(La,{id:e.commentId,outlineComment:t}))))).displayName="CommentListActions";const Ma=({userAction:e,label:t,icon:a,handleOutlineComment:n})=>({build:()=>[{username:s.a.createElement(ka,{username:e.createdBy.username,fullName:e.createdBy.fullName}),type:"update",event:t,"data-test-subj":`${e.type}-${e.action}-action-${e.actionId}`,timestamp:s.a.createElement(Ia,{createdAt:e.createdAt}),timelineIcon:a,actions:s.a.createElement(C.EuiFlexGroup,{responsive:!1},s.a.createElement(C.EuiFlexItem,{grow:!1},s.a.createElement(Fa,{id:e.actionId})),Da(e.action,e.commentId)&&s.a.createElement(C.EuiFlexItem,{grow:!1},s.a.createElement(La,{id:e.commentId,outlineComment:n})))}]});var Ra=a(66),Ba=a.n(Ra);const{emptyField:za}=yt.g,Ua={content:{type:yt.a.TEXTAREA,validations:[{validator:za(j.S)}]}},Pa=L.a.div.withConfig({displayName:"ContentWrapper",componentId:"sc-bgw87j-0"})(["padding:",";"],(({theme:e})=>`${e.eui.euiSizeM} ${e.eui.euiSizeL}`)),_a=Object(n.forwardRef)((({id:e,content:t,isEditable:a,onChangeEditable:r,onSaveContent:i},o)=>{const l=Object(n.useRef)(),c={content:t},{form:u}=Object(yt.j)({defaultValue:c,options:{stripEmptyFields:!1},schema:Ua}),d="content",{setFieldValue:m,submit:p}=u,b=Object(n.useCallback)((()=>{r(e)}),[e,r]),g=Object(n.useCallback)((async()=>{const{isValid:a,data:n}=await p();a&&n.content!==t&&i(n.content),r(e)}),[t,e,r,i,p]),E=Object(n.useCallback)((e=>{m(d,e)}),[m]),f=Object(n.useMemo)((()=>s.a.createElement(C.EuiFlexGroup,{gutterSize:"s",alignItems:"center",responsive:!1},s.a.createElement(C.EuiFlexItem,{grow:!1},s.a.createElement(C.EuiButtonEmpty,{"data-test-subj":"user-action-cancel-markdown",size:"s",onClick:b,iconType:"cross"},j.i)),s.a.createElement(C.EuiFlexItem,{grow:!1},s.a.createElement(C.EuiButton,{"data-test-subj":"user-action-save-markdown",color:"success",fill:!0,iconType:"save",onClick:g,size:"s"},j.T)))),[b,g]);return Object(n.useImperativeHandle)(o,(()=>({setComment:E,editor:l.current}))),a?s.a.createElement(yt.c,{form:u,"data-test-subj":"user-action-markdown-form"},s.a.createElement(yt.e,{path:d,component:ta.a,componentProps:{ref:l,"aria-label":"Cases markdown editor",value:t,id:e,bottomRightContent:f}})):s.a.createElement(Pa,{className:"eui-xScroll","data-test-subj":"user-action-markdown"},s.a.createElement(ta.b,null,t))}));_a.displayName="UserActionMarkdownComponent";const Va=s.a.memo(_a);var $a=a(157),Ha=a.n($a),Ga=(a(158),a(208)),qa=a.n(Ga);const Wa="lens",Qa=function(){const e=this.Parser,t=e.prototype.blockTokenizers,a=e.prototype.blockMethods;t.lens=function(e,t,a){if(!1===t.startsWith("!{lens"))return!0;const n=t[6];if("{"!==n&&"}"!==n)return!1;if(a)return!0;let s="!{lens",r={};if("{"===n){let a="",n=0;for(let e=6;e<t.length;e++){const s=t[e];if("{"===s)n++,a+=s;else if("}"===s){if(n--,-1===n)break;a+=s}else a+=s}s+=a;try{r=JSON.parse(a)}catch(t){const a=e.now();this.file.fail(`Unable to parse lens JSON configuration: ${t}`,{line:a.line,column:a.column+6})}}return s+="}",e(s)({type:Wa,...r})},a.splice(a.indexOf("text"),0,Wa)},Ka=E.i18n.translate("xpack.cases.markdownEditor.plugins.timeline.noParenthesesErrorMsg",{defaultMessage:"Expected left parentheses"}),Ya="timeline",Xa="[",Ja=function(){const e=this.Parser,t=e.prototype.blockTokenizers,a=e.prototype.blockMethods,n=function(e,t,a){if(!1===t.startsWith(Xa)||!0===t.startsWith(Xa)&&!t.includes("timelines?timeline=(id"))return!1;let n=0;if(t[n]!==Xa)return!1;if(a)return!0;function s(e,a){if(t[n]!==e)throw new Error(Ka);n++;let s="",r=0;for(;n<t.length;n++){const i=t[n];if(i===a&&0===r)return n++,s;i===a?r--:i===e&&r++,s+=i}return""}const r=`[${s(Xa,"]")}](${s("(",")")})`;return e(r)({type:Ya,match:r})};n.locator=(e,t)=>e.indexOf(Xa,t),t.timeline=n,a.splice(a.indexOf("url"),0,Ya)},Za=({id:e,editLabel:t,quoteLabel:a,deleteLabel:r,deleteConfirmTitle:i,isLoading:o,onEdit:c,onDelete:u,onQuote:d,userCanCrud:m,commentMarkdown:p})=>{const{canUseEditor:b,actionConfig:g}=(({comment:e})=>{var t;const a=(e=>qa()().use([[Ha.a,{}],Qa,Ja]).parse(e))(e),s=(e=>null!=e&&e.length?Object(z.filter)(e,{type:Wa}):[])(null!==(t=null==a?void 0:a.children)&&void 0!==t?t:[]),{lens:{navigateToPrefilledEditor:r,canUseEditor:i}}=Object(l.f)().services,o=Object(n.useCallback)((()=>{r({id:"",timeRange:s[0].timeRange,attributes:s[0].attributes},{openInNewTab:!0})}),[s,r]);return{canUseEditor:i(),actionConfig:s.length?{iconType:"lensApp",label:E.i18n.translate("xpack.cases.markdownEditor.plugins.lens.openVisualizationButtonLabel",{defaultMessage:"Open visualization"}),onClick:o}:null}})({comment:p}),f=Object(n.useCallback)((()=>c(e)),[e,c]),h=Object(n.useCallback)((()=>d(e)),[e,d]),[y,v]=Object(n.useState)(!1),j=Object(n.useCallback)((()=>{v(!0)}),[]),x=Object(n.useCallback)((()=>{u&&u(e),v(!1)}),[e,u]),w=Object(n.useCallback)((()=>{v(!1)}),[]),I=Object(n.useMemo)((()=>[m?[{iconType:"pencil",label:t,onClick:f},...r&&u?[{iconType:"trash",label:r,onClick:j}]:[],{iconType:"quote",label:a,onClick:h}]:[],b&&g?[g]:[]].flat()),[m,t,f,r,u,j,a,h,b,g]);return I.length?s.a.createElement(s.a.Fragment,null,o&&s.a.createElement(C.EuiLoadingSpinner,{"data-test-subj":"user-action-title-loading"}),!o&&s.a.createElement(et,{propertyActions:I}),y?s.a.createElement(C.EuiConfirmModal,{title:i,onCancel:w,onConfirm:x,cancelButtonText:fa,confirmButtonText:ha,buttonColor:"danger",defaultFocusedButton:"confirm","data-test-subj":"property-actions-confirm-modal"}):null):null};Za.displayName="UserActionPropertyActions";const en=Object(n.memo)(Za),tn=({commentMarkdown:e,id:t,editLabel:a,deleteLabel:n,deleteConfirmTitle:r,quoteLabel:i,isLoading:o,onEdit:l,onQuote:c,onDelete:u,userCanCrud:d})=>s.a.createElement(C.EuiFlexGroup,{responsive:!1,alignItems:"center"},s.a.createElement(C.EuiFlexItem,{grow:!1},s.a.createElement(Fa,{id:t})),s.a.createElement(C.EuiFlexItem,{grow:!1},s.a.createElement(en,{id:t,editLabel:a,quoteLabel:i,deleteLabel:n,deleteConfirmTitle:r,isLoading:o,onEdit:l,onQuote:c,onDelete:u,userCanCrud:d,commentMarkdown:e})));tn.displayName="UserActionContentToolbar";const an=Object(n.memo)(tn);var nn=a(28);const sn=Object(n.memo)((({onRuleDetailsClick:e,getRuleDetailsHref:t,ruleId:a,ruleName:r,loadingAlertData:i,actionId:o})=>{const l=Object(n.useCallback)((t=>{t.preventDefault(),e&&e(a,t)}),[a,e]),c=null==t?void 0:t(a),u=null!=r?r:ba;return i?s.a.createElement(C.EuiLoadingSpinner,{size:"m","data-test-subj":`alert-loading-spinner-${o}`}):Object(z.isEmpty)(a)||null==c?s.a.createElement(s.a.Fragment,null,u):s.a.createElement(se.c,{onClick:l,href:c,"data-test-subj":`alert-rule-link-${o}`},u)}));sn.displayName="RuleLink";const rn=({actionId:e,getRuleDetailsHref:t,loadingAlertData:a=!1,onRuleDetailsClick:n,ruleId:r,ruleName:i})=>s.a.createElement("span",{"data-test-subj":`single-alert-user-action-${e}`},`${da} `,s.a.createElement(sn,{actionId:e,ruleId:r,ruleName:i,getRuleDetailsHref:t,onRuleDetailsClick:n,loadingAlertData:a}));rn.displayName="SingleAlertCommentEvent";const on=Object(n.memo)(rn),ln=({actionId:e,getRuleDetailsHref:t,loadingAlertData:a=!1,onRuleDetailsClick:n,ruleId:r,ruleName:i,totalAlerts:o})=>s.a.createElement("span",{"data-test-subj":`multiple-alerts-user-action-${e}`},`${(e=>E.i18n.translate("xpack.cases.caseView.generatedAlertCommentLabelTitle",{values:{totalAlerts:e},defaultMessage:"added {totalAlerts} alerts from"}))(o)}`," ",s.a.createElement(sn,{actionId:e,ruleId:r,ruleName:i,getRuleDetailsHref:t,onRuleDetailsClick:n,loadingAlertData:a}));ln.displayName="MultipleAlertsCommentEvent";const cn=Object(n.memo)(ln),un=({id:e,alertId:t,index:a,onShowAlertDetails:r})=>{const i=Object(n.useCallback)((()=>r(t,a)),[t,a,r]);return s.a.createElement(C.EuiToolTip,{position:"top",content:s.a.createElement("p",null,ma)},s.a.createElement(C.EuiButtonIcon,{"aria-label":ma,"data-test-subj":`comment-action-show-alert-${e}`,onClick:i,iconType:"arrowRight",id:`${e}-show-alert`}))};un.displayName="UserActionShowAlert";const dn=Object(n.memo)(un);var mn=a(40);const pn=()=>{const{navigateToCaseView:e}=Object(o.j)(),{detailName:t}=Object(o.k)(),a=Object(n.useCallback)((()=>{e({detailName:t,tabId:mn.a.ALERTS})}),[e,t]);return s.a.createElement(C.EuiToolTip,{position:"top",content:s.a.createElement("p",null,pa)},s.a.createElement(C.EuiButtonIcon,{"aria-label":pa,"data-test-subj":`comment-action-show-alerts-${t}`,onClick:a,iconType:"inspect",id:`${t}-show-alerts`}))};pn.displayName="ShowAlertTableLink";const bn=e=>({build:()=>{const{comment:t}=e;return 1===(Array.isArray(t.alertId)?t.alertId:[t.alertId]).length?(({userAction:e,comment:t,alertData:a,getRuleDetailsHref:n,loadingAlertData:r,onRuleDetailsClick:i,onShowAlertDetails:o})=>{const l=hn(t.alertId),c=hn(t.index);if(!l||!c)return[];const u=a[l],d=gn(t,u),m=En(t,u);return[{username:s.a.createElement(ka,{username:e.createdBy.username,fullName:e.createdBy.fullName}),className:"comment-alert",type:"update",event:s.a.createElement(on,{actionId:e.actionId,getRuleDetailsHref:n,loadingAlertData:r,onRuleDetailsClick:i,ruleId:d,ruleName:m}),"data-test-subj":`user-action-alert-${e.type}-${e.action}-action-${e.actionId}`,timestamp:s.a.createElement(Ia,{createdAt:e.createdAt}),timelineIcon:"bell",actions:s.a.createElement(C.EuiFlexGroup,{responsive:!1},s.a.createElement(C.EuiFlexItem,{grow:!1},s.a.createElement(Fa,{id:e.actionId})),s.a.createElement(C.EuiFlexItem,{grow:!1},s.a.createElement(dn,{id:e.actionId,alertId:l,index:c,onShowAlertDetails:o})))}]})(e):(({userAction:e,comment:t,alertData:a,getRuleDetailsHref:n,loadingAlertData:r,onRuleDetailsClick:i})=>{if(!Array.isArray(t.alertId))return[];const o=t.alertId.length,{ruleId:l,ruleName:c}=function(e,t){const a=hn(e.alertId);if(!a)return{ruleId:null,ruleName:null};const n=t[a];return{ruleId:gn(e,n),ruleName:En(e,n)}}(t,a);return[{username:s.a.createElement(ka,{username:e.createdBy.username,fullName:e.createdBy.fullName}),className:"comment-alert",type:"update",event:s.a.createElement(cn,{actionId:e.actionId,loadingAlertData:r,totalAlerts:o,ruleId:l,ruleName:c,getRuleDetailsHref:n,onRuleDetailsClick:i}),"data-test-subj":`user-action-alert-${e.type}-${e.action}-action-${e.actionId}`,timestamp:s.a.createElement(Ia,{createdAt:e.createdAt}),timelineIcon:"bell",actions:s.a.createElement(C.EuiFlexGroup,{responsive:!1},s.a.createElement(C.EuiFlexItem,{grow:!1},s.a.createElement(Fa,{id:e.actionId})),s.a.createElement(C.EuiFlexItem,{grow:!1},s.a.createElement(pn,null)))}]})(e)}}),gn=(e,t)=>{var a;return fn({commentRuleField:null==e||null===(a=e.rule)||void 0===a?void 0:a.id,alertData:t,signalRuleFieldPath:"signal.rule.id",kibanaAlertFieldPath:nn.b})},En=(e,t)=>{var a;return fn({commentRuleField:null==e||null===(a=e.rule)||void 0===a?void 0:a.name,alertData:t,signalRuleFieldPath:"signal.rule.name",kibanaAlertFieldPath:nn.a})},fn=({commentRuleField:e,alertData:t,signalRuleFieldPath:a,kibanaAlertFieldPath:n})=>{var s,r;return null!==(s=null!==(r=hn(e))&&void 0!==r?r:hn(Object(z.get)(t,a)))&&void 0!==s?s:hn(Object(z.get)(t,n))};function hn(e){const t=(a=e,Array.isArray(a)?a[0]:null!=a?a:null);var a;return null==t||Object(z.isEmpty)(t)?null:t}const yn=({type:e,endpoints:t,href:a,onClick:r})=>{const i=a?a(t[0].endpointId):"",o=Object(n.useCallback)((e=>{e.preventDefault(),r&&r(t[0].endpointId,e)}),[r,t]);return s.a.createElement(s.a.Fragment,null,"isolate"===e?`${ga} `:`${Ea} `,s.a.createElement(se.c,{onClick:o,href:i,"data-test-subj":`actions-link-${t[0].endpointId}`},t[0].hostname),t.length>1&&(e=>E.i18n.translate("xpack.cases.caseView.otherEndpoints",{values:{endpoints:e},defaultMessage:" and {endpoints} {endpoints, plural, =1 {other} other {others}}"}))(t.length-1))};yn.displayName="HostIsolationCommentEvent";const Cn=Object(n.memo)(yn),vn=s.a.memo((({actionType:e})=>{const t=Object(n.useContext)(N.ThemeContext);return s.a.createElement(C.EuiToken,{style:{marginTop:"8px"},iconType:"isolate"===e?"lock":"lockOpen",size:"m",shape:"circle",color:t.eui.euiColorLightestShade,"data-test-subj":"endpoint-action-icon"})}));vn.displayName="ActionIcon";const jn="description";function xn(e){return e.payload.settings.syncAlerts?`${me} ${Se}`:`${pe} ${Se}`}var wn=a(83),In=a(92);const On={connector:({userAction:e,handleOutlineComment:t})=>({build:()=>{const a=(e=>{const t=e.payload.connector;return null==t?"":t.id===d.p?be:(a=t.name,E.i18n.translate("xpack.cases.caseView.actionLabel.selectedThirdParty",{values:{thirdParty:a},defaultMessage:"selected { thirdParty } as incident management system"}));var a})(e);return Ma({userAction:e,handleOutlineComment:t,label:a,icon:"dot"}).build()}}),tags:({userAction:e,handleOutlineComment:t})=>({build:()=>{const a=(e=>{var t;const a=null!==(t=e.payload.tags)&&void 0!==t?t:[];return s.a.createElement(C.EuiFlexGroup,{alignItems:"baseline",gutterSize:"xs",component:"span",responsive:!1},s.a.createElement(C.EuiFlexItem,{"data-test-subj":"ua-tags-label",grow:!1},e.action===d.b.add&&ue,e.action===d.b.delete&&Ee," ",j.bb.toLowerCase()),s.a.createElement(C.EuiFlexItem,{grow:!1},s.a.createElement(Kt,{tags:a,gutterSize:"xs"})))})(e);return Ma({userAction:e,handleOutlineComment:t,label:a,icon:"tag"}).build()}}),title:({userAction:e,handleOutlineComment:t})=>({build:()=>{const a=(e=>`${de.toLowerCase()} ${j.l.toLowerCase()} ${j.fb} "${e.payload.title}"`)(e);return Ma({userAction:e,handleOutlineComment:t,label:a,icon:"dot"}).build()}}),status:({userAction:e,handleOutlineComment:t})=>({build:()=>{const a=(e=>{var t;const a=null!==(t=e.payload.status)&&void 0!==t?t:"";return(e=>Object.prototype.hasOwnProperty.call(ot.b,e))(a)?s.a.createElement(C.EuiFlexGroup,{gutterSize:"s",alignItems:"center","data-test-subj":`${e.actionId}-user-action-status-title`,responsive:!1},s.a.createElement(C.EuiFlexItem,{grow:!1},j.C),s.a.createElement(C.EuiFlexItem,{grow:!1},s.a.createElement(ot.a,{type:a}))):s.a.createElement(s.a.Fragment,null)})(e);return Ma({userAction:e,handleOutlineComment:t,label:a,icon:"folderClosed"}).build()}}),severity:({userAction:e,handleOutlineComment:t})=>({build:()=>{const a=(e=>{const t=e.payload.severity,a=In.a[t];return void 0===a?null:s.a.createElement(C.EuiFlexGroup,{gutterSize:"s",alignItems:"center","data-test-subj":`${e.actionId}-user-action-severity-title`,responsive:!1},s.a.createElement(C.EuiFlexItem,{grow:!1},wn.j),s.a.createElement(C.EuiFlexItem,{"data-test-subj":`${e.actionId}-user-action-severity-title-${t}`},s.a.createElement(C.EuiHealth,{color:a.color},a.label)))})(e);return Ma({userAction:e,handleOutlineComment:t,label:a,icon:"dot"}).build()}}),pushed:({userAction:e,caseServices:t,index:a,handleOutlineComment:n})=>({build:()=>{const r=e,{firstPush:i,parsedConnectorId:o,parsedConnectorName:l}=((e,t,a)=>{var n;return null!=t&&t.connectorId!==d.p?{firstPush:(null===(n=e[t.connectorId])||void 0===n?void 0:n.firstPushIndex)===a,parsedConnectorId:t.connectorId,parsedConnectorName:t.connectorName}:{firstPush:!1,parsedConnectorId:d.p,parsedConnectorName:d.p}})(t,r.payload.externalService,a);if(o===d.p)return[];const c=(({userAction:e,caseServices:t,connectorId:a,connectorName:n,index:s})=>{var r,i;const o=e.action===d.b.push_to_service&&s===(null===(r=t[a])||void 0===r?void 0:r.lastPushIndex),l=e.action===d.b.push_to_service&&s===(null===(i=t[a])||void 0===i?void 0:i.lastPushIndex)&&t[a].hasDataToPush;let c=[];var u;return o&&(c=[...c,{username:"",type:"update",event:(u=`${n}`,E.i18n.translate("xpack.cases.caseView.alreadyPushedToExternalService",{values:{externalService:u},defaultMessage:"Already pushed to { externalService } incident"})),timelineIcon:"sortUp","data-test-subj":"top-footer"}]),l&&(c=[...c,{username:"",type:"update",event:la(`${n}`),timelineIcon:"sortDown","data-test-subj":"bottom-footer"}]),c})({userAction:r,caseServices:t,connectorId:o,connectorName:l,index:a}),u=((e,t)=>{const a=e.payload.externalService;return s.a.createElement(C.EuiFlexGroup,{alignItems:"baseline",gutterSize:"xs","data-test-subj":"pushed-service-label-title",responsive:!1},s.a.createElement(C.EuiFlexItem,{"data-test-subj":"pushed-label"},`${t?fe:he} ${null==a?void 0:a.connectorName}`),s.a.createElement(C.EuiFlexItem,{grow:!1},s.a.createElement(C.EuiLink,{"data-test-subj":"pushed-value",href:null==a?void 0:a.externalUrl,target:"_blank"},null==a?void 0:a.externalTitle)))})(r,i);return[...Ma({userAction:e,handleOutlineComment:n,label:u,icon:"dot"}).build(),...c]}}),comment:({caseData:e,userAction:t,userCanCrud:a,commentRefs:n,manageMarkdownEditIds:r,selectedOutlineCommentId:i,loadingCommentIds:o,loadingAlertData:l,alertData:c,getRuleDetailsHref:u,onRuleDetailsClick:m,onShowAlertDetails:p,handleManageMarkdownEditId:b,handleSaveComment:g,handleDeleteComment:E,handleManageQuote:f,handleOutlineComment:h,actionsNavigation:y})=>({build:()=>{const C=t;if(C.action===d.b.delete)return(({userAction:e,handleOutlineComment:t})=>{const a=`${Ee} ${ke.toLowerCase()}`;return Ma({userAction:e,handleOutlineComment:t,label:a,icon:"cross"}).build()})({userAction:C,handleOutlineComment:h});const v=e.comments.find((e=>e.id===C.commentId));if(null==v)return[];if(C.action===d.b.create)return(({userAction:e,comment:t,userCanCrud:a,commentRefs:n,manageMarkdownEditIds:r,selectedOutlineCommentId:i,loadingCommentIds:o,handleManageMarkdownEditId:l,handleSaveComment:c,handleManageQuote:u,handleDeleteComment:m,getRuleDetailsHref:p,loadingAlertData:b,onRuleDetailsClick:g,alertData:E,onShowAlertDetails:f,actionsNavigation:h})=>{switch(t.type){case d.n.user:const y=(({comment:e,userCanCrud:t,outlined:a,isEdit:n,isLoading:r,commentRefs:i,handleManageMarkdownEditId:o,handleSaveComment:l,handleManageQuote:c,handleDeleteComment:u})=>({build:()=>[{username:s.a.createElement(ja,{username:e.createdBy.username,fullName:e.createdBy.fullName}),"data-test-subj":`comment-create-action-${e.id}`,timestamp:s.a.createElement(Ia,{createdAt:e.createdAt,updatedAt:e.updatedAt}),className:Ba()("userAction__comment",{outlined:a,isEdit:n}),children:s.a.createElement(Va,{key:n?e.id:void 0,ref:t=>i.current[e.id]=t,id:e.id,content:e.comment,isEditable:n,onChangeEditable:o,onSaveContent:l.bind(null,{id:e.id,version:e.version})}),timelineIcon:s.a.createElement(Ca,{username:e.createdBy.username,fullName:e.createdBy.fullName}),actions:s.a.createElement(an,{id:e.id,commentMarkdown:e.comment,editLabel:je,deleteLabel:xe,deleteConfirmTitle:we,quoteLabel:ve,isLoading:r,onEdit:o.bind(null,e.id),onQuote:c.bind(null,e.comment),onDelete:u.bind(null,e.id),userCanCrud:t})}]}))({comment:t,userCanCrud:a,outlined:t.id===i,isEdit:r.includes(t.id),commentRefs:n,isLoading:o.includes(t.id),handleManageMarkdownEditId:l,handleSaveComment:c,handleManageQuote:u,handleDeleteComment:m});return y.build();case d.n.alert:return bn({alertData:E,comment:t,userAction:e,getRuleDetailsHref:p,loadingAlertData:b,onRuleDetailsClick:g,onShowAlertDetails:f}).build();case d.n.actions:const C=(({userAction:e,comment:t,actionsNavigation:a})=>({build:()=>[{username:s.a.createElement(ka,{username:t.createdBy.username,fullName:t.createdBy.fullName}),className:Ba()("comment-action",{"empty-comment":0===t.comment.trim().length}),event:s.a.createElement(Cn,{type:t.actions.type,endpoints:t.actions.targets,href:null==a?void 0:a.href,onClick:null==a?void 0:a.onClick}),"data-test-subj":"endpoint-action",timestamp:s.a.createElement(Ia,{createdAt:e.createdAt}),timelineIcon:s.a.createElement(vn,{actionType:t.actions.type}),actions:s.a.createElement(Fa,{id:t.id}),children:t.comment.trim().length>0&&s.a.createElement(Pa,{"data-test-subj":"user-action-markdown"},s.a.createElement(ta.b,null,t.comment))}]}))({userAction:e,comment:t,actionsNavigation:h});return C.build();default:return[]}})({userAction:C,comment:v,userCanCrud:a,commentRefs:n,manageMarkdownEditIds:r,selectedOutlineCommentId:i,loadingCommentIds:o,loadingAlertData:l,alertData:c,getRuleDetailsHref:u,onRuleDetailsClick:m,onShowAlertDetails:p,handleManageMarkdownEditId:b,handleSaveComment:g,handleDeleteComment:E,handleManageQuote:f,actionsNavigation:y});const j=`${ge} ${ke.toLowerCase()}`;return Ma({userAction:t,handleOutlineComment:h,label:j,icon:"dot"}).build()}}),description:({userAction:e,handleOutlineComment:t})=>({build:()=>{const a=`${ge} ${j.y.toLowerCase()}`;return Ma({userAction:e,handleOutlineComment:t,label:a,icon:"dot"}).build()}}),settings:({userAction:e,handleOutlineComment:t})=>({build:()=>{var a,n;const s=e;return void 0!==(null==s||null===(a=s.payload)||void 0===a||null===(n=a.settings)||void 0===n?void 0:n.syncAlerts)?Ma({userAction:e,handleOutlineComment:t,label:xn(s),icon:"gear"}).build():[]}})},kn=Object.keys(Object(z.omit)(d.a,["create_case","delete_case"])),Tn="newComment";var An=a(113);const Sn=(e,t)=>{switch(t.type){case"FETCH_INIT":return{...e,isLoadingIds:[...e.isLoadingIds,t.payload],isError:!1};case"FETCH_SUCCESS":return{...e,isLoadingIds:e.isLoadingIds.filter((e=>t.payload.commentId!==e)),isError:!1};case"FETCH_FAILURE":return{...e,isLoadingIds:e.isLoadingIds.filter((e=>t.payload!==e)),isError:!0};default:return e}},Fn=(e,t)=>{switch(t.type){case"FETCH_INIT":case"FETCH_SUCCESS":return{...e,isError:!1};case"FETCH_FAILURE":return{...e,isError:!0};default:return e}},Nn=e=>null!=(null==e?void 0:e.addQuote),Ln=L()(C.EuiFlexGroup).withConfig({displayName:"MyEuiFlexGroup",componentId:"sc-15a8kb6-0"})(["margin-bottom:8px;"]),Dn=L()(C.EuiCommentList).withConfig({displayName:"MyEuiCommentList",componentId:"sc-15a8kb6-1"})(["",""],(({theme:e})=>`\n    & .userAction__comment.outlined .euiCommentEvent {\n      outline: solid 5px ${e.eui.euiColorVis1_behindText};\n      margin: 0.5em;\n      transition: 0.8s;\n    }\n\n    & .euiComment.isEdit {\n      & .euiCommentEvent {\n        border: none;\n        box-shadow: none;\n      }\n\n      & .euiCommentEvent__body {\n        padding: 0;\n      }\n\n      & .euiCommentEvent__header {\n        display: none;\n      }\n    }\n\n    & .comment-alert .euiCommentEvent {\n      background-color: ${e.eui.euiColorLightestShade};\n      border: ${e.eui.euiFlyoutBorder};\n      padding: ${e.eui.paddingSizes.s};\n      border-radius: ${e.eui.paddingSizes.xs};\n    }\n\n    & .comment-alert .euiCommentEvent__headerData {\n      flex-grow: 1;\n    }\n\n    & .comment-action.empty-comment .euiCommentEvent--regular {\n      box-shadow: none;\n      .euiCommentEvent__header {\n        padding: ${e.eui.euiSizeM} ${e.eui.paddingSizes.s};\n        border-bottom: 0;\n      }\n    }\n  `)),Mn=s.a.memo((({caseServices:e,caseUserActions:t,data:a,fetchUserActions:r,getRuleDetailsHref:i,actionsNavigation:m,isLoadingDescription:p,isLoadingUserActions:b,onRuleDetailsClick:E,onShowAlertDetails:f,onUpdateField:h,statusActionButton:y,updateCase:v,useFetchAlertData:j,userCanCrud:x})=>{const{detailName:w,commentId:I}=Object(o.k)(),[O,k]=Object(n.useState)(!0),T=Object(l.c)(),A=Object(n.useMemo)((()=>(e=>{const t=e.reduce(((e,t)=>t.type===d.n.alert&&Object(z.isEmpty)(t.rule.id)?((Array.isArray(t.alertId)?t.alertId:[t.alertId]).forEach((t=>e.add(t))),e):e),new Set);return Array.from(t)})(a.comments)),[a.comments]),[S,F]=j(A),{loadingCommentIds:N,commentRefs:L,selectedOutlineCommentId:D,manageMarkdownEditIds:M,handleManageMarkdownEditId:R,handleOutlineComment:B,handleSaveComment:U,handleManageQuote:P,handleDeleteComment:_,handleUpdate:V}=(({fetchUserActions:e,updateCase:t})=>{const{detailName:a}=Object(o.k)(),{clearDraftComment:s,draftComment:r,hasIncomingLensState:i,openLensModal:d}=Object(An.a)(),m=Object(n.useRef)(0),{isLoadingIds:p,patchComment:b}=(()=>{const[e,t]=Object(n.useReducer)(Sn,{isLoadingIds:[],isError:!1}),a=Object(l.i)(),s=Object(n.useRef)(!1),r=Object(n.useRef)(new AbortController),i=Object(g.a)().owner[0],o=Object(n.useCallback)((async({caseId:e,commentId:n,commentUpdate:o,fetchUserActions:l,updateCase:d,version:m})=>{try{s.current=!1,r.current.abort(),r.current=new AbortController,t({type:"FETCH_INIT",payload:n});const a=await Object(c.n)({caseId:e,commentId:n,commentUpdate:o,version:m,signal:r.current.signal,owner:i});s.current||(d(a),l(),t({type:"FETCH_SUCCESS",payload:{commentId:n}}))}catch(e){s.current||("AbortError"!==e.name&&a.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:u.d}),t({type:"FETCH_FAILURE",payload:n}))}}),[]);return Object(n.useEffect)((()=>()=>{s.current=!0,r.current.abort()}),[]),{...e,patchComment:o}})(),{deleteComment:E}=(()=>{const[e,t]=Object(n.useReducer)(Fn,{isError:!1}),a=Object(l.i)(),s=Object(n.useRef)(!1),r=Object(n.useRef)(new AbortController),i=Object(n.useCallback)((async({caseId:e,commentId:n,fetchUserActions:i,updateCase:o})=>{try{s.current=!1,r.current.abort(),r.current=new AbortController,t({type:"FETCH_INIT",payload:n}),await Object(c.c)({caseId:e,commentId:n,signal:r.current.signal}),s.current||(o(await Object(c.e)(e,!0,r.current.signal)),i(),t({type:"FETCH_SUCCESS",payload:{commentId:n}}))}catch(e){s.current||("AbortError"!==e.name&&a.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:u.d}),t({type:"FETCH_FAILURE",payload:n}))}}),[]);return Object(n.useEffect)((()=>()=>{s.current=!0,r.current.abort()}),[]),{...e,deleteComment:i}})(),[f,h]=Object(n.useState)(""),[y,C]=Object(n.useState)([]),v=Object(n.useRef)({}),j=Object(n.useCallback)((e=>{s(),C((t=>t.includes(e)?t.filter((t=>e!==t)):t.concat(e)))}),[s]),x=Object(n.useCallback)((({id:n,version:s},r)=>{b({caseId:a,commentId:n,commentUpdate:r,fetchUserActions:e,version:s,updateCase:t})}),[a,e,b,t]),w=Object(n.useCallback)((n=>{E({caseId:a,commentId:n,fetchUserActions:e,updateCase:t})}),[a,E,e,t]),I=Object(n.useCallback)((e=>{const t=document.getElementById(`${e}-permLink`);if(null!=t){const a=-120,n=t.getBoundingClientRect().top+window.pageYOffset+a;window.scrollTo({top:n,behavior:"smooth"}),"add-comment"===e&&t.getElementsByTagName("textarea")[0].focus()}window.clearTimeout(m.current),h(e),m.current=window.setTimeout((()=>{h(""),window.clearTimeout(m.current)}),2400)}),[m]),O=Object(n.useCallback)((e=>{const t=null==v?void 0:v.current.newComment;Nn(t)&&t.addQuote(e),I("add-comment")}),[I]),k=Object(n.useCallback)((a=>{t(a),e()}),[e,t]);return Object(n.useEffect)((()=>{if(null!=r&&r.commentId){var e,t;C((e=>Tn===(null==r?void 0:r.commentId)||e.includes(null==r?void 0:r.commentId)?e:[null==r?void 0:r.commentId]));const a=null==v||null===(e=v.current)||void 0===e?void 0:e[r.commentId];Nn(a)&&null!==(t=a.editor)&&void 0!==t&&t.textarea&&(a.setComment(r.comment),i?d({editorRef:a.editor}):s())}}),[s,r,i,d]),{loadingCommentIds:p,selectedOutlineCommentId:f,manageMarkdownEditIds:y,commentRefs:v,handleManageMarkdownEditId:j,handleOutlineComment:I,handleSaveComment:x,handleDeleteComment:w,handleManageQuote:O,handleUpdate:k}})({fetchUserActions:r,updateCase:v}),$=Object(n.useMemo)((()=>s.a.createElement(oa,{id:Tn,caseId:w,userCanCrud:x,ref:e=>L.current.newComment=e,onCommentPosted:V,onCommentSaving:R.bind(null,Tn),showLoading:!1,statusActionButton:y})),[w,x,V,R,y,L]);Object(n.useEffect)((()=>{O&&!b&&0===N.length&&(k(!1),null!=I&&B(I))}),[I,O,b,N,B]);const H=Object(n.useMemo)((()=>(({caseData:e,commentRefs:t,manageMarkdownEditIds:a,isLoadingDescription:n,userCanCrud:r,onUpdateField:i,handleManageMarkdownEditId:o,handleManageQuote:l})=>{const c=a.includes(jn);return{username:s.a.createElement(ja,{username:e.createdBy.username,fullName:e.createdBy.fullName}),event:ye,"data-test-subj":"description-action",timestamp:s.a.createElement(Ia,{createdAt:e.createdAt}),children:s.a.createElement(Va,{key:c?jn:void 0,ref:e=>t.current.description=e,id:jn,content:e.description,isEditable:c,onSaveContent:e=>{i({key:jn,value:e})},onChangeEditable:o}),timelineIcon:s.a.createElement(Ca,{username:e.createdBy.username,fullName:e.createdBy.fullName}),className:Ba()({isEdit:a.includes(jn)}),actions:s.a.createElement(an,{commentMarkdown:e.description,id:jn,editLabel:Ce,quoteLabel:ve,isLoading:n,onEdit:o.bind(null,jn),onQuote:l.bind(null,e.description),userCanCrud:r})}})({caseData:a,commentRefs:L,manageMarkdownEditIds:M,isLoadingDescription:p,userCanCrud:x,onUpdateField:h,handleManageMarkdownEditId:R,handleManageQuote:P})),[a,L,M,p,x,h,R,P]),G=Object(n.useMemo)((()=>t.reduce(((t,n,s)=>{if(r=n.type,!kn.includes(r))return t;var r;const o=On[n.type];if(null==o)return t;const l=o({caseData:a,userAction:n,caseServices:e,comments:a.comments,index:s,userCanCrud:x,commentRefs:L,manageMarkdownEditIds:M,selectedOutlineCommentId:D,loadingCommentIds:N,loadingAlertData:S,alertData:F,handleOutlineComment:B,handleManageMarkdownEditId:R,handleDeleteComment:_,handleSaveComment:U,handleManageQuote:P,onShowAlertDetails:f,actionsNavigation:m,getRuleDetailsHref:i,onRuleDetailsClick:E});return[...t,...l.build()]}),[H])),[t,H,a,e,x,L,M,D,N,S,F,B,R,_,U,P,f,m,i,E]),q=[...G,...x?[{username:s.a.createElement(ja,{username:null==T?void 0:T.username,fullName:null==T?void 0:T.fullName}),"data-test-subj":"add-comment",timelineIcon:s.a.createElement(Ca,{username:null==T?void 0:T.username,fullName:null==T?void 0:T.fullName}),className:"isEdit",children:$}]:[]];return s.a.createElement(s.a.Fragment,null,s.a.createElement(Dn,{comments:q,"data-test-subj":"user-actions"}),(b||N.includes(Tn))&&s.a.createElement(Ln,{justifyContent:"center",alignItems:"center"},s.a.createElement(C.EuiFlexItem,{grow:!1},s.a.createElement(C.EuiLoadingSpinner,{"data-test-subj":"user-actions-loading",size:"l"}))))}));Mn.displayName="UserActions";const Rn=L()(C.EuiAvatar).withConfig({displayName:"MyAvatar",componentId:"sc-2lwk7k-0"})(["top:-4px;"]),Bn=L()(C.EuiFlexGroup).withConfig({displayName:"MyFlexGroup",componentId:"sc-2lwk7k-1"})(["",""],(({theme:e})=>Object(N.css)(["margin-top:",";"],e.eui.euiSizeM))),zn=s.a.memo((({email:e,headline:t,loading:a,users:r})=>{const i=Object(n.useCallback)((t=>{t&&null!=t&&window.open(`mailto:${t}?subject=${e.subject}&body=${e.body}`,"_blank")}),[e.subject]);return r.filter((({username:e})=>null!=e&&""!==e)).length>0?s.a.createElement(C.EuiText,null,s.a.createElement("h4",null,t),s.a.createElement(C.EuiHorizontalRule,{margin:"xs"}),a&&s.a.createElement(C.EuiFlexGroup,null,s.a.createElement(C.EuiFlexItem,null,s.a.createElement(C.EuiLoadingSpinner,null))),((e,t)=>e.map((({fullName:e,username:a,email:n},r)=>{return s.a.createElement(Bn,{key:r,justifyContent:"spaceBetween",responsive:!1},s.a.createElement(C.EuiFlexItem,{grow:!1},s.a.createElement(C.EuiFlexGroup,{gutterSize:"xs",responsive:!1},s.a.createElement(C.EuiFlexItem,{grow:!1},s.a.createElement(Rn,{name:e||(null!=a?a:"")})),s.a.createElement(C.EuiFlexItem,{grow:!1},s.a.createElement(C.EuiToolTip,{position:"top",content:s.a.createElement("p",null,e||(null!=a?a:""))},s.a.createElement("p",null,s.a.createElement("strong",null,s.a.createElement("small",{"data-test-subj":"case-view-username"},a))))))),s.a.createElement(C.EuiFlexItem,{grow:!1},s.a.createElement(C.EuiButtonIcon,{"data-test-subj":"user-list-email-button",onClick:t.bind(null,n),iconType:"email","aria-label":(i=e||(null!=a?a:""),E.i18n.translate("xpack.cases.caseView.sendEmalLinkAria",{values:{user:i},defaultMessage:"click to send an email to {user}"})),isDisabled:Object(ne.isEmpty)(n)})));var i})))(r.filter((({username:e})=>null!=e&&""!==e)),i)):null}));zn.displayName="UserList";var Un=a(11);const Pn=(e,t)=>{switch(t.type){case"FETCH_INIT":return{...e,isLoading:!0,isError:!1,updateKey:t.payload};case"FETCH_SUCCESS":return{...e,isLoading:!1,isError:!1,updateKey:null};case"FETCH_FAILURE":return{...e,isLoading:!1,isError:!0,updateKey:null};default:return e}},_n=({caseData:e,caseId:t,handleUpdateField:a})=>{const{isLoading:s,updateKey:r,updateCaseProperty:i}=(({caseId:e})=>{const[t,a]=Object(n.useReducer)(Pn,{isLoading:!1,isError:!1,updateKey:null}),s=Object(l.i)(),r=Object(n.useRef)(!1),i=Object(n.useRef)(new AbortController),o=Object(n.useCallback)((async({fetchCaseUserActions:t,updateKey:n,updateValue:o,updateCase:l,caseData:d,onSuccess:m,onError:p})=>{try{r.current=!1,i.current.abort(),i.current=new AbortController,a({type:"FETCH_INIT",payload:n});const u=await Object(c.l)(e,{[n]:o},d.version,i.current.signal);r.current||(null!=t&&t(e,u[0].connector.id),null!=l&&l(u[0]),a({type:"FETCH_SUCCESS"}),s.addSuccess(Object(Un.b)(d,u[0],n,o)),m&&m())}catch(e){r.current||("AbortError"!==e.name&&s.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:u.d}),a({type:"FETCH_FAILURE"}),p&&p())}}),[e]);return Object(n.useEffect)((()=>()=>{r.current=!0,i.current.abort()}),[]),{...t,updateCaseProperty:o}})({caseId:t});return{onUpdateField:Object(n.useCallback)((({key:t,value:n,onSuccess:s,onError:r})=>{const o=(t,n)=>i({updateKey:t,updateValue:n,updateCase:e=>a(e,t),caseData:e,onSuccess:s,onError:r});switch(t){case"title":const t=Object(Un.j)(n);t.length>0&&o("title",t);break;case"connector":const a=Object(Un.j)(n);null!=a&&o("connector",a);break;case"description":const s=Object(Un.j)(n);s.length>0&&o("description",s);break;case"tags":o("tags",Object(Un.j)(n));break;case"status":const r=Object(Un.j)(n);e.status!==n&&o("status",r);break;case"settings":const i=Object(Un.j)(n);e.settings!==n&&o("settings",i);break;case"severity":const l=Object(Un.j)(n);e.severity!==n&&o("severity",l);default:return null}}),[i,a,e]),isLoading:s,loadingKey:r}};var Vn=a(114),$n=a(136),Hn=a(89);const Gn=({selectedSeverity:e,onSeverityChange:t,isLoading:a,isDisabled:n})=>s.a.createElement(C.EuiFlexItem,{grow:!1},s.a.createElement(C.EuiText,null,s.a.createElement("h4",null,Hn.f)),s.a.createElement(C.EuiHorizontalRule,{margin:"xs"}),s.a.createElement($n.a,{isLoading:a,selectedSeverity:e,onSeverityChange:t,isDisabled:n}),s.a.createElement(C.EuiSpacer,{size:"m"}));Gn.displayName="SeveritySidebarSelector";const qn=({initLoadingData:e,ruleDetailsNavigation:t,caseId:a,caseData:r,actionsNavigation:i,showAlertDetails:l,updateCase:c,fetchCaseMetrics:u,useFetchAlertData:d,getCaseUserActions:m})=>{const{userCanCrud:p}=Object(g.a)(),{getCaseViewUrl:b}=Object(o.j)(),{caseUserActions:f,fetchCaseUserActions:h,caseServices:y,hasDataToPush:v,isLoading:x,participants:w}=m,I=Object(n.useCallback)((()=>{h(a,r.connector.id)}),[a,h,r]),O=Object(n.useCallback)(((e,t)=>{l&&l(e,t)}),[l]),k=Object(n.useCallback)(((e,t)=>{c({...e,comments:r.comments}),h(a,e.connector.id),u()}),[c,r,h,a,u]),{onUpdateField:T,isLoading:A,loadingKey:S}=_n({caseId:a,caseData:r,handleUpdateField:k}),F=Object(n.useCallback)((e=>T({key:"status",value:e})),[T]),N=Object(n.useMemo)((()=>{return{subject:(t=r.title,E.i18n.translate("xpack.cases.caseView.emailSubject",{values:{caseTitle:t},defaultMessage:"Security Case - {caseTitle}"})),body:(e=b({detailName:a}),E.i18n.translate("xpack.cases.caseView.emailBody",{values:{caseUrl:e},defaultMessage:"Case reference: {caseUrl}"}))};var e,t}),[r.title,b,a]),L=Object(n.useCallback)((e=>T({key:"tags",value:e})),[T]),D=Object(n.useCallback)((e=>T({key:"severity",value:e})),[T]),{loading:M,connectors:R}=Object(ht.a)(),[B,z]=Object(n.useMemo)((()=>{var e;const t=R.find((e=>e.id===r.connector.id));return[null!==(e=null==t?void 0:t.name)&&void 0!==e?e:"",!!t]}),[R,r.connector]),U=Object(n.useCallback)((e=>{c(e),h(a,e.connector.id),u()}),[c,h,a,u]),P=Object(n.useCallback)(((e,t,a,n)=>{const s=Object(It.a)(e,R),r=s?Object(Vn.b)(s):Object(Vn.a)();T({key:"connector",value:{...r,fields:t},onSuccess:n,onError:a})}),[T,R]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(C.EuiFlexItem,{grow:6},e&&s.a.createElement(C.EuiLoadingContent,{lines:8,"data-test-subj":"case-view-loading-content"}),!e&&s.a.createElement(C.EuiFlexGroup,{direction:"column",responsive:!1,"data-test-subj":"case-view-activity"},s.a.createElement(C.EuiFlexItem,null,s.a.createElement(Mn,{getRuleDetailsHref:null==t?void 0:t.href,onRuleDetailsClick:null==t?void 0:t.onClick,caseServices:y,caseUserActions:f,data:r,actionsNavigation:i,fetchUserActions:I,isLoadingDescription:A&&"description"===S,isLoadingUserActions:x,onShowAlertDetails:O,onUpdateField:T,statusActionButton:p?s.a.createElement($t,{status:r.status,onStatusChanged:F,isLoading:A&&"status"===S}):null,updateCase:c,useFetchAlertData:d,userCanCrud:p})))),s.a.createElement(C.EuiFlexItem,{grow:2},s.a.createElement(Gn,{isDisabled:!p,isLoading:A,selectedSeverity:r.severity,onSeverityChange:D}),s.a.createElement(zn,{"data-test-subj":"case-view-user-list-reporter",email:N,headline:j.R,users:[r.createdBy]}),s.a.createElement(zn,{"data-test-subj":"case-view-user-list-participants",email:N,headline:j.O,loading:x,users:w}),s.a.createElement(Zt,{"data-test-subj":"case-view-tag-list",userCanCrud:p,tags:r.tags,onSubmit:L,isLoading:A&&"tags"===S}),s.a.createElement(Pt,{caseData:r,caseServices:y,connectorName:B,connectors:R,hasDataToPush:v&&p,isLoading:M||A&&"connector"===S,isValidConnector:!!M||z,onSubmit:P,updateCase:U,userActions:f,userCanCrud:p})))};qn.displayName="CaseViewActivity";var Wn=a(74);const Qn=e=>{const t=e.reduce(((e,t)=>t.type===d.n.alert?((Array.isArray(t.alertId)?t.alertId:[t.alertId]).forEach((t=>e.add(t))),e):e),new Set);return Array.from(t)},Kn={isLoading:!0,alertFeatureIds:[],isError:!1},Yn=()=>s.a.createElement(C.EuiEmptyPrompt,{"data-test-subj":"caseViewAlertsEmpty",iconType:"casesApp",iconColor:"default",titleSize:"xs",body:s.a.createElement("p",null,Re)});Yn.displayName="CaseViewAlertsEmpty";const Xn=({caseData:e})=>{const{triggersActionsUi:t}=Object(l.f)().services,a=Object(n.useMemo)((()=>({ids:{values:Qn(e.comments)}})),[e.comments]),r=Object(n.useMemo)((()=>(e=>{const t=e.reduce(((e,t)=>t.type===d.n.alert?((Array.isArray(t.index)?t.index:[t.index]).forEach((t=>{if(t.startsWith(".siem-signals"))e.add("security");else{const a=(e=>{const t=e.match(/\.alerts-(.*?).alerts/);return t&&t.length>1?`${t[1]}`:null})(t);a&&e.add(a)}})),e):e),new Set);return Array.from(t)})(e.comments)),[e.comments]),{isLoading:i,alertFeatureIds:o}=(e=>{const t=Object(l.i)(),a=Object(n.useRef)(!1),s=Object(n.useRef)(new AbortController),[r,i]=Object(n.useState)(Kn),o=Object(n.useCallback)((async e=>{i({isLoading:!0,alertFeatureIds:[],isError:!1});try{a.current=!1,s.current.abort(),s.current=new AbortController;const t={registrationContext:e},n=await Object(c.h)(t,s.current.signal);a.current||i({isLoading:!1,alertFeatureIds:n,isError:!1})}catch(e){a.current||(i({isLoading:!1,alertFeatureIds:[],isError:!0}),"AbortError"!==e.name&&t.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:u.d}))}}),[t]);return Object(n.useEffect)((()=>(o(e),()=>{a.current=!0,s.current.abort()})),e),r})(r),m={alertsTableConfigurationRegistry:t.alertsTableConfigurationRegistry,configurationId:e.owner,id:`case-details-alerts-${e.owner}`,flyoutState:o.includes("siem")?Wn.AlertsTableFlyoutState.internal:Wn.AlertsTableFlyoutState.external,featureIds:o,query:a,showExpandToDetails:o.includes("siem")};return 0===a.ids.values.length?s.a.createElement(Yn,null):i?s.a.createElement(C.EuiFlexGroup,null,s.a.createElement(C.EuiFlexItem,null,s.a.createElement(C.EuiProgress,{size:"xs",color:"primary"}))):t.getAlertsStateTable(m)};Xn.displayName="CaseViewAlerts";var Jn=a(65);const Zn=E.i18n.translate("xpack.cases.caseView.metrics.totalAlerts",{defaultMessage:"Total alerts"}),es=E.i18n.translate("xpack.cases.caseView.metrics.associatedUsers",{defaultMessage:"Associated users"}),ts=E.i18n.translate("xpack.cases.caseView.metrics.associatedHosts",{defaultMessage:"Associated hosts"}),as=E.i18n.translate("xpack.cases.caseView.metrics.isolatedHosts",{defaultMessage:"Isolated hosts"}),ns=E.i18n.translate("xpack.cases.caseView.metrics.totalConnectors",{defaultMessage:"Total connectors"}),ss=E.i18n.translate("xpack.cases.caseView.metrics.lifespan.caseCreated",{defaultMessage:"Case created"}),rs=E.i18n.translate("xpack.cases.caseView.metrics.lifespan.inProgressDuration",{defaultMessage:"In progress duration"}),is=E.i18n.translate("xpack.cases.caseView.metrics.lifespan.openDuration",{defaultMessage:"Open duration"}),os=E.i18n.translate("xpack.cases.caseView.metrics.lifespan.openToCloseDuration",{defaultMessage:"Duration from creation to close"}),ls=E.i18n.translate("xpack.cases.caseView.metrics.lifespan.reopened",{defaultMessage:"(reopened)"}),cs=E.i18n.translate("xpack.cases.caseView.metrics.lifespan.reopenedOn",{defaultMessage:"Reopened "}),us=s.a.memo((({metrics:e,features:t})=>{const a=ms(e,t);return s.a.createElement(s.a.Fragment,null,a.map((({id:e,title:t,value:a})=>s.a.createElement(C.EuiFlexItem,{key:t,"data-test-subj":`case-metrics-totals-${e}`},s.a.createElement(C.EuiFlexGroup,{direction:"column",gutterSize:"s",responsive:!1},s.a.createElement(C.EuiFlexItem,null,t),s.a.createElement(ds,null,a))))))}));us.displayName="CaseViewMetricItems";const ds=Object(Jn.euiStyled)(C.EuiFlexItem)`
  font-size: ${({theme:e})=>e.eui.euiSizeL};
  font-weight: bold;
`,ms=(e,t)=>{var a,s,r,i,o,l;const{alerts:c,actions:u,connectors:d}=null!=e?e:{},m=null!==(a=null==d?void 0:d.total)&&void 0!==a?a:0,p=null!==(s=null==c?void 0:c.count)&&void 0!==s?s:0,b=null!==(r=null==c||null===(i=c.users)||void 0===i?void 0:i.total)&&void 0!==r?r:0,g=null!==(o=null==c||null===(l=c.hosts)||void 0===l?void 0:l.total)&&void 0!==o?o:0,E=ps(u);return Object(n.useMemo)((()=>[["alerts.count",{title:Zn,value:p}],["alerts.users",{title:es,value:b}],["alerts.hosts",{title:ts,value:g}],["actions.isolateHost",{title:as,value:E}],["connectors",{title:ns,value:m}]].reduce(((e,[a,n])=>[...e,...t.includes(a)?[{id:a,...n}]:[]]),[])),[t,p,b,g,E,m])},ps=e=>null!=e&&e.isolateHost?Math.max(e.isolateHost.isolate.total-e.isolateHost.unisolate.total,0):0;var bs=a(129),gs=a.n(bs),Es=a(125),fs=a(121);const hs=s.a.memo((({metrics:e,features:t})=>{const a=ys(e,t);if(!a)return null;const n=[{key:"case-created",component:s.a.createElement(Is,{title:ss,value:s.a.createElement(Cs,{date:a.creationDate})}),dataTestSubject:"case-metrics-lifespan-item-creation-date"},{key:"in-progress-duration",component:s.a.createElement(Is,{title:rs,value:vs(a.statusInfo.inProgressDuration)}),dataTestSubject:"case-metrics-lifespan-item-inProgress-duration"},{key:"open-duration",component:s.a.createElement(Is,{title:is,value:js(a.statusInfo.openDuration)}),dataTestSubject:"case-metrics-lifespan-item-open-duration"},{key:"duration-from-creation-to-close",component:s.a.createElement(Os,{title:os,value:xs(a.creationDate,a.closeDate),reopens:a.statusInfo.reopenDates}),dataTestSubject:"case-metrics-lifespan-item-open-to-close-duration"}];return s.a.createElement(C.EuiFlexItem,{grow:3},s.a.createElement(C.EuiFlexGrid,{columns:2,gutterSize:"s",responsive:!1},n.map((({component:e,dataTestSubject:t,key:a})=>s.a.createElement(C.EuiFlexItem,{"data-test-subj":t,key:a},e)))))}));hs.displayName="CaseStatusMetrics";const ys=(e,t)=>Object(n.useMemo)((()=>{var a;const n=null!==(a=null==e?void 0:e.lifespan)&&void 0!==a?a:{closeDate:"",creationDate:"",statusInfo:{inProgressDuration:0,reopenDates:[],openDuration:0}};if(t.includes("lifespan"))return n}),[t,e]),Cs=s.a.memo((({date:e})=>Object(Es.a)(e).isValid()?s.a.createElement(it.a,{"data-test-subj":"case-metrics-lifespan-creation-date",value:e,stripMs:!0}):Object(fs.a)()));Cs.displayName="CreationDate";const vs=e=>e<=0?Object(fs.a)():js(e),js=e=>gs()(e,{compact:!0,verbose:!0}),xs=(e,t)=>{if(null==t)return;const a=Object(Es.a)(e),n=Object(Es.a)(t);return a.isValid()&&n.isValid()?js(n.diff(a)):void 0},ws=Object(Jn.euiStyled)(C.EuiFlexItem)`
  font-size: ${({theme:e})=>e.eui.euiSizeM};
  font-weight: bold;
`,Is=s.a.memo((({title:e,value:t})=>s.a.createElement(C.EuiFlexGroup,{direction:"column",gutterSize:"s",responsive:!1},s.a.createElement(ws,null,e),s.a.createElement(C.EuiFlexItem,null,t))));Is.displayName="CaseStatusMetricsItem";const Os=s.a.memo((({title:e,value:t,reopens:a})=>{const n=ks(t,a);return s.a.createElement(C.EuiFlexGroup,{direction:"column",gutterSize:"s",responsive:!1},s.a.createElement(ws,null,e),null!=t&&Ts(a)?s.a.createElement(As,{value:n,explanationValues:a}):s.a.createElement(C.EuiFlexItem,null,n))}));Os.displayName="OpenCloseDuration";const ks=(e,t)=>null==e?Object(fs.a)():t.length>0?`${e} ${ls}`:e,Ts=e=>e.length>0,As=s.a.memo((({value:e,explanationValues:t})=>{const a=s.a.createElement(s.a.Fragment,null,cs,t.map(((e,a)=>s.a.createElement(s.a.Fragment,{key:`explanation-value-${a}`},s.a.createElement(it.a,{"data-test-subj":`case-metrics-lifespan-reopen-${a}`,value:e,stripMs:!0}),Ss(a,t.length)?s.a.createElement(C.EuiSpacer,{size:"xs"}):null))));return s.a.createElement(C.EuiFlexItem,{"data-test-subj":"case-metrics-lifespan-reopen-icon"},s.a.createElement(C.EuiFlexGroup,{responsive:!1,gutterSize:"s",alignItems:"center"},s.a.createElement(C.EuiFlexItem,{grow:!1},e),s.a.createElement(C.EuiFlexItem,{grow:!1},s.a.createElement(C.EuiIconTip,{content:a,position:"right"}))))}));As.displayName="ValueWithExplanationIcon";const Ss=(e,t)=>e+1<t,Fs=s.a.memo((({metrics:e,features:t,isLoading:a})=>s.a.createElement(C.EuiPanel,{"data-test-subj":"case-view-metrics-panel",hasShadow:!1,hasBorder:!0},s.a.createElement(C.EuiFlexGroup,{gutterSize:"xl",wrap:!0,responsive:!1,alignItems:"center"},a?s.a.createElement(C.EuiFlexItem,null,s.a.createElement(C.EuiLoadingSpinner,{"data-test-subj":"case-view-metrics-spinner",size:"l"})):s.a.createElement(s.a.Fragment,null,s.a.createElement(us,{metrics:e,features:t}),s.a.createElement(hs,{metrics:e,features:t}))))));Fs.displayName="CaseViewMetrics";const Ns=L()(C.EuiBetaBadge).withConfig({displayName:"ExperimentalBadge",componentId:"sc-rjwjtx-0"})(["margin-left:5px;"]),Ls=s.a.memo((({caseData:e,caseId:t,fetchCase:a,onComponentInitialized:r,updateCase:i,refreshRef:d,ruleDetailsNavigation:m,actionsNavigation:p,showAlertDetails:b,useFetchAlertData:E})=>{var y;const{userCanCrud:v,features:j}=Object(g.a)(),{metricsFeatures:x}=Object(Qe.a)();(e=>{const{appId:t,appTitle:a}=Object(g.a)(),{getAppUrl:s}=Object(l.g)(t),r=h();Object(n.useEffect)((()=>{const t=[{text:a,href:s()},{text:f[o.a.cases],href:s({deepLinkId:o.a.cases})},{text:e}];r(t)}),[e,a,s,r])})(e.title);const{navigateToCaseView:w}=Object(o.j)(),{urlParams:I}=Object(o.n)(),O=Object(n.useMemo)((()=>I.tabId&&Object.values(mn.a).includes(I.tabId)?I.tabId:mn.a.ACTIVITY),[I.tabId]),[k,T]=Object(n.useState)(!0),A=Object(n.useRef)(!0),S=null===(y=Object(Et.a)())||void 0===y?void 0:y.ui,F=((e,t)=>{const[a,s]=Object(n.useState)(Ge),r=Object(n.useRef)(new AbortController),i=Object(n.useRef)(!1),o=Object(l.i)(),d=Object(n.useCallback)((async(e,t)=>{try{i.current=!1,r.current.abort(),r.current=new AbortController,s({...a,isLoading:!0});const n=await Object(c.f)(e,r.current.signal);if(!i.current){const e=Object(ne.isEmpty)(n)?[]:Object(ne.uniqBy)("createdBy.username",n).map((e=>e.createdBy)),a=Object(ne.isEmpty)(n)?[]:n;s({caseUserActions:a,...We(a,t),isLoading:!1,isError:!1,participants:e})}}catch(e){i.current||("AbortError"!==e.name&&o.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:u.d}),s({caseServices:{},caseUserActions:[],hasDataToPush:!1,isError:!0,isLoading:!1,participants:[]}))}}),[a]);return Object(n.useEffect)((()=>(Object(ne.isEmpty)(e)||d(e,t),()=>{i.current=!0,r.current.abort()})),[e]),{...a,fetchCaseUserActions:d}})(t,e.connector.id),{fetchCaseUserActions:N,caseServices:L,isLoading:D}=F,M=Object(n.useCallback)((()=>{N(t,e.connector.id)}),[t,N,e]),{metrics:R,isLoading:B,fetchCaseMetrics:z}=((e,t)=>{const[a,s]=Object(n.useReducer)(Ue,{metrics:null,isLoading:!1,isError:!1}),r=Object(l.i)(),i=Object(n.useRef)(!1),o=Object(n.useRef)(new AbortController),d=Object(n.useCallback)((async(a=!1)=>{if(0!==t.length)try{i.current=!1,o.current.abort(),o.current=new AbortController,s({type:"FETCH_INIT",payload:{silent:a}});const n=await Object(c.j)(e,t,o.current.signal);i.current||s({type:"FETCH_SUCCESS",payload:n})}catch(e){i.current||("AbortError"!==e.name&&r.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:u.d}),s({type:"FETCH_FAILURE"}))}}),[e,t,r]);return Object(n.useEffect)((()=>(d(),()=>{i.current=!0,o.current.abort()})),[d]),{...a,fetchCaseMetrics:d}})(t,x),U=Object(n.useCallback)((()=>{a(),z(),M()}),[a,M,z]),P=Object(n.useCallback)(((a,n)=>{i({...a,comments:e.comments}),N(t,a.connector.id),z()}),[i,e,N,t,z]),{onUpdateField:_,isLoading:V,loadingKey:G}=_n({caseId:t,caseData:e,handleUpdateField:P});Object(n.useEffect)((()=>{let e=!1;if(d)return d.current={refreshCase:async()=>{e||V||B||D||await Promise.all([a(!0),z(!0),M()])}},()=>{e=!0,d.current=null}}),[a,z,M,D,B,V,d,i]);const q=Object(n.useMemo)((()=>null!=L&&null!=L[e.connector.id]?L[e.connector.id]:null),[L,e.connector]),W=Object(n.useCallback)((e=>_({key:"title",value:e})),[_]);Object(n.useEffect)((()=>{k&&!D&&T(!1)}),[k,D]),Object(n.useEffect)((()=>{A.current&&(A.current=!1,r&&r())}),[r]);const Q=Object(n.useMemo)((()=>[{id:mn.a.ACTIVITY,name:De,content:s.a.createElement(qn,{getCaseUserActions:F,initLoadingData:k,ruleDetailsNavigation:m,caseId:t,caseData:e,actionsNavigation:p,showAlertDetails:b,updateCase:i,fetchCaseMetrics:z,useFetchAlertData:E})},...j.alerts.enabled?[{id:mn.a.ALERTS,name:s.a.createElement(s.a.Fragment,null,Me,s.a.createElement(Ns,{label:$,size:"s",iconType:"beaker",tooltipContent:H,tooltipPosition:"bottom"})),content:s.a.createElement(Xn,{caseData:e})}]:[]]),[p,e,t,j.alerts.enabled,z,F,k,m,b,i,E]),K=Object(n.useMemo)((()=>{var e;return null===(e=Q.find((e=>e.id===O)))||void 0===e?void 0:e.content}),[O,Q]),Y=Object(n.useCallback)((()=>Q.map(((e,a)=>s.a.createElement(C.EuiTab,{"data-test-subj":`case-view-tab-title-${e.id}`,key:a,onClick:()=>w({detailName:t,tabId:e.id}),isSelected:e.id===O},e.name)))),[O,t,w,Q]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(te,{border:!1,showBackButton:!0,"data-test-subj":"case-view-title",titleNode:s.a.createElement(gt,{userCanCrud:v,isLoading:V&&"title"===G,title:e.title,onSubmit:W}),title:e.title},s.a.createElement(ut,{caseData:e,currentExternalIncident:q,userCanCrud:v,isLoading:V&&("status"===G||"settings"===G),onRefresh:U,onUpdateField:_})),s.a.createElement(ft.d,null,!k&&x.length>0?s.a.createElement(s.a.Fragment,null,s.a.createElement(C.EuiFlexGroup,null,s.a.createElement(C.EuiFlexItem,null,s.a.createElement(Fs,{"data-test-subj":"case-view-metrics",isLoading:B,metrics:R,features:x}))),s.a.createElement(C.EuiSpacer,{size:"xs"})):null,s.a.createElement(C.EuiTabs,null,Y()),s.a.createElement(C.EuiSpacer,{size:"l"}),s.a.createElement(C.EuiFlexGroup,{"data-test-subj":`case-view-tab-content-${O}`},K)),null!=S&&S.renderTimelineDetailsPanel?S.renderTimelineDetailsPanel():null)}));Ls.displayName="CaseViewPage";const Ds=L()(C.EuiFlexGroup).withConfig({displayName:"MyEuiFlexGroup",componentId:"sc-bqd51x-0"})(["height:100%;"]),Ms=()=>s.a.createElement(Ds,{gutterSize:"none",justifyContent:"center",alignItems:"center"},s.a.createElement(C.EuiFlexItem,{grow:!1},s.a.createElement(C.EuiLoadingSpinner,{"data-test-subj":"case-view-loading",size:"xl"}))),Rs=s.a.memo((({onComponentInitialized:e,actionsNavigation:t,ruleDetailsNavigation:a,showAlertDetails:r,timelineIntegration:i,useFetchAlertData:d,refreshRef:m})=>{const{spaces:p}=Object(l.f)().services,{detailName:b}=Object(o.k)(),{basePath:E}=Object(g.a)(),{data:f,resolveOutcome:h,resolveAliasId:y,resolveAliasPurpose:C,isLoading:v,isError:j,fetchCase:x,updateCase:w}=(e=>{const[t,a]=Object(n.useReducer)(ce,{isLoading:!1,isError:!1,data:null,resolveOutcome:null}),s=Object(l.i)(),r=Object(n.useRef)(!1),i=Object(n.useRef)(new AbortController),o=Object(n.useCallback)((e=>{a({type:"UPDATE_CASE",payload:e})}),[]),d=Object(n.useCallback)((async(t=!1)=>{try{r.current=!1,i.current.abort(),i.current=new AbortController,a({type:"FETCH_INIT",payload:{silent:t}});const n=await Object(c.q)(e,!0,i.current.signal);r.current||a({type:"FETCH_SUCCESS",payload:n})}catch(e){r.current||("AbortError"!==e.name&&s.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:u.d}),a({type:"FETCH_FAILURE"}))}}),[e,s]);return Object(n.useEffect)((()=>(d(),()=>{r.current=!0,i.current.abort()})),[e]),{...t,fetchCase:d,updateCase:o}})(b);Object(n.useEffect)((()=>{if(p&&"aliasMatch"===h&&null!=y){const e=`${E}${Object(o.c)({detailName:y})}`;p.ui.redirectLegacyUrl({path:`${e}${window.location.search}${window.location.hash}`,aliasPurpose:C,objectNoun:Oe})}}),[h,y,C,E,p]);const I=Object(n.useCallback)((()=>{if(f&&p&&"conflict"===h&&null!=y){const e=`${E}${Object(o.c)({detailName:y})}${window.location.search}${window.location.hash}`;return p.ui.components.getLegacyUrlConflict({objectNoun:Oe,currentObjectId:f.id,otherObjectId:y,otherObjectPath:e})}return null}),[f,y,h,E,p]);return j?s.a.createElement(ze,{caseId:b}):v?s.a.createElement(Ms,null):f&&s.a.createElement(Be.b,{timelineIntegration:i},I(),s.a.createElement(Ls,{caseData:f,caseId:b,fetchCase:x,onComponentInitialized:e,actionsNavigation:t,ruleDetailsNavigation:a,showAlertDetails:r,updateCase:w,useFetchAlertData:d,refreshRef:m}))}));Ms.displayName="CaseViewLoading",Rs.displayName="CaseView";var Bs=a(147);Object(yt.i)({component:yt.b});const zs=s.a.memo((({afterCaseCreated:e,onCancel:t,onSuccess:a,timelineIntegration:n,withSteps:r})=>(y(o.a.casesCreate),s.a.createElement(s.a.Fragment,null,s.a.createElement(te,{showBackButton:!0,"data-test-subj":"case-create-title",title:wn.e}),s.a.createElement(Bs.a,{afterCaseCreated:e,onCancel:t,onSuccess:a,timelineIntegration:n,withSteps:r})))));zs.displayName="CreateCase";var Us=a(94),Ps=a(133),_s=a(131),Vs=a(85);const $s=({isLoading:e,casesField:t,selectedActionType:a,selectedThirdParty:r})=>{const i=Object(n.useMemo)((()=>Object(ne.capitalize)(a)),[a]);return s.a.createElement(C.EuiFlexGroup,{"data-test-subj":"static-mappings",alignItems:"center",responsive:!1},s.a.createElement(C.EuiFlexItem,null,s.a.createElement(C.EuiFlexGroup,{component:"span",justifyContent:"spaceBetween",responsive:!1},s.a.createElement(C.EuiFlexItem,{component:"span",grow:!1},s.a.createElement(C.EuiCode,{"data-test-subj":"field-mapping-source"},t)),s.a.createElement(C.EuiFlexItem,{component:"span",grow:!1},s.a.createElement(C.EuiIcon,{type:"sortRight"})))),s.a.createElement(C.EuiFlexItem,null,s.a.createElement(C.EuiFlexGroup,{component:"span",justifyContent:"spaceBetween",responsive:!1},s.a.createElement(C.EuiFlexItem,{component:"span",grow:!1},e?s.a.createElement(C.EuiLoadingSpinner,{size:"m"}):s.a.createElement(C.EuiCode,{"data-test-subj":"field-mapping-target"},r)))),s.a.createElement(C.EuiFlexItem,null,e?s.a.createElement(C.EuiLoadingSpinner,{size:"m"}):i))};$s.displayName="FieldMappingRow";const Hs=s.a.memo($s),Gs=L.a.div.withConfig({displayName:"FieldRowWrapper",componentId:"sc-lo3da2-0"})(["margin:10px 0;font-size:14px;"]),qs=({actionTypeName:e,isLoading:t,mappings:a})=>a.length?s.a.createElement(C.EuiFlexGroup,{direction:"column",gutterSize:"none"},s.a.createElement(C.EuiFlexItem,null," ",s.a.createElement(C.EuiFlexGroup,{responsive:!1},s.a.createElement(C.EuiFlexItem,null,s.a.createElement("span",{className:"euiFormLabel"},Vs.l)),s.a.createElement(C.EuiFlexItem,{"data-test-subj":"case-configure-field-mappings-second-col-label"},s.a.createElement("span",{className:"euiFormLabel"},Vs.m(e))),s.a.createElement(C.EuiFlexItem,null,s.a.createElement("span",{className:"euiFormLabel"},Vs.n)))),s.a.createElement(C.EuiFlexItem,null,s.a.createElement(Gs,{"data-test-subj":"case-configure-field-mappings-row-wrapper"},a.map((e=>{var a;return s.a.createElement(Hs,{key:`${e.source}`,casesField:e.source,isLoading:t,selectedActionType:e.actionType,selectedThirdParty:null!==(a=e.target)&&void 0!==a?a:"not_mapped"})}))))):null;qs.displayName="FieldMapping";const Ws=s.a.memo(qs),Qs=({actionTypeName:e,isLoading:t,mappings:a})=>{const r=Object(n.useMemo)((()=>a.length>0||t?{desc:Vs.j(e),color:"subdued"}:{desc:Vs.k(e),color:"danger"}),[t,a.length,e]);return s.a.createElement(C.EuiFlexGroup,{direction:"column",gutterSize:"none"},s.a.createElement(C.EuiFlexItem,{grow:!1},s.a.createElement(C.EuiText,{size:"xs","data-test-subj":"field-mapping-text"},s.a.createElement("h4",null,Vs.o(e)),s.a.createElement(C.EuiTextColor,{"data-test-subj":"field-mapping-desc",color:r.color},r.desc))),s.a.createElement(C.EuiFlexItem,{grow:!1},s.a.createElement(Ws,{actionTypeName:e,"data-test-subj":"case-mappings-field",isLoading:t,mappings:a})))};Qs.displayName="Mapping";const Ks=s.a.memo(Qs);var Ys=a(97);const Xs=L()(C.EuiFormRow).withConfig({displayName:"EuiFormRowExtended",componentId:"sc-h7jvjf-0"})([".euiFormRow__labelWrapper{.euiFormRow__label{width:100%;}}"]),Js=({actionTypes:e,connectors:t,disabled:a,handleShowEditFlyout:r,isLoading:i,mappings:o,onChangeConnector:c,selectedConnector:u,updateConnectorDisabled:m})=>{var p;const{actions:b}=Object(l.b)(),g=Object(n.useMemo)((()=>t.find((e=>e.id===u.id))),[t,u.id]),E=null!==(p=null==g?void 0:g.name)&&void 0!==p?p:"none",f=Object(n.useMemo)((()=>{var t,a;return null!==(t=null===(a=e.find((e=>e.id===u.type)))||void 0===a?void 0:a.name)&&void 0!==t?t:"Unknown"}),[e,u.type]),h=Object(n.useMemo)((()=>s.a.createElement(C.EuiFlexGroup,{justifyContent:"spaceBetween"},s.a.createElement(C.EuiFlexItem,{grow:!1},Vs.q),s.a.createElement(C.EuiFlexItem,{grow:!1},"none"!==E&&s.a.createElement(C.EuiLink,{disabled:m,onClick:r,"data-test-subj":"case-configure-update-selected-connector-button"},Vs.v(E))))),[E,r,m]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(C.EuiDescribedFormGroup,{fullWidth:!0,title:s.a.createElement("h3",null,Vs.r),description:Vs.p,"data-test-subj":"case-connectors-form-group"},s.a.createElement(Xs,{fullWidth:!0,label:h,"data-test-subj":"case-connectors-form-row"},s.a.createElement(C.EuiFlexGroup,{direction:"column"},s.a.createElement(C.EuiFlexItem,{grow:!1},b.read?s.a.createElement(_s.a,{connectors:t,disabled:a,selectedConnector:u.id,isLoading:i,onChange:c,"data-test-subj":"case-connectors-dropdown",appendAddConnectorButton:!0}):s.a.createElement(C.EuiText,{"data-test-subj":"configure-case-connector-permissions-error-msg",size:"s"},s.a.createElement("span",null,Vs.u))),u.type!==d.o.none&&Object(It.d)(g)&&s.a.createElement(C.EuiFlexItem,{grow:!1},s.a.createElement(Ys.a,null)),u.type!==d.o.none?s.a.createElement(C.EuiFlexItem,{grow:!1},s.a.createElement(Ks,{actionTypeName:f,isLoading:i,mappings:o})):null))))};Js.displayName="Connectors";const Zs=s.a.memo(Js),er=[{id:"close-by-user",label:Vs.d},{id:"close-by-pushing",label:Vs.e}],tr=({closureTypeSelected:e,disabled:t,onChangeClosureType:a})=>{const r=Object(n.useCallback)((e=>{a(e)}),[a]);return s.a.createElement(C.EuiRadioGroup,{disabled:t,options:er,idSelected:e,onChange:r,name:"closure_options","data-test-subj":"closure-options-radio-group"})};tr.displayName="ClosureOptionsRadio";const ar=s.a.memo(tr),nr=({closureTypeSelected:e,disabled:t,onChangeClosureType:a})=>s.a.createElement(C.EuiDescribedFormGroup,{fullWidth:!0,title:s.a.createElement("h3",null,Vs.f),description:s.a.createElement(s.a.Fragment,null,s.a.createElement("p",null,Vs.b)),"data-test-subj":"case-closure-options-form-group"},s.a.createElement(C.EuiFormRow,{fullWidth:!0,label:Vs.c,"data-test-subj":"case-closure-options-form-row"},s.a.createElement(ar,{closureTypeSelected:e,disabled:t,onChangeClosureType:a,"data-test-subj":"case-closure-options-radio"})));nr.displayName="ClosureOptions";const sr=s.a.memo(nr),rr=L.a.div.withConfig({displayName:"FormWrapper",componentId:"sc-1kx5o74-0"})(["",""],(({theme:e})=>Object(N.css)(["& > *{margin-top 40px;}& > :first-child{margin-top:0;}padding-top:",";padding-bottom:",";.euiFlyout{z-index:",";}"],e.eui.paddingSizes.xl,e.eui.paddingSizes.xl,e.eui.euiZNavigation+1))),ir=s.a.memo((()=>{const{userCanCrud:e}=Object(g.a)(),{triggersActionsUi:t}=Object(l.f)().services;y(o.a.casesConfigure);const[a,r]=Object(n.useState)(!0),[i,c]=Object(n.useState)(!1),[d,m]=Object(n.useState)(!1),[p,b]=Object(n.useState)(null),{connector:E,closureType:f,loading:h,mappings:j,persistLoading:x,persistCaseConfigure:w,refetchCaseConfigure:I,setConnector:O,setClosureType:k}=Object(Ps.a)(),{loading:T,connectors:A,refetchConnectors:S}=Object(ht.a)(),{loading:F,actionTypes:N,refetchActionTypes:L}=(()=>{const e=Object(l.i)(),[t,a]=Object(n.useState)(!0),[s,r]=Object(n.useState)([]),i=Object(n.useRef)(!1),o=Object(n.useRef)(new AbortController),c=Object(n.useRef)(!0),d=Object(n.useCallback)((async()=>{try{a(!0),i.current=!1,o.current.abort(),o.current=new AbortController;const e=await Object(Us.a)({signal:o.current.signal});i.current||(a(!1),r(e))}catch(t){i.current||(a(!1),r([]),e.addError(t.body&&t.body.message?new Error(t.body.message):t,{title:u.d}))}}),[e]);return Object(n.useEffect)((()=>(c.current&&(d(),c.current=!1),()=>{i.current=!0,o.current.abort(),c.current=!0})),[d]),{loading:t,actionTypes:s,refetchActionTypes:d}})(),D=Object(n.useMemo)((()=>N.filter((e=>dt.H.includes(e.id)))),[N]),M=Object(n.useCallback)((async()=>{S(),L(),I()}),[L,I,S]),R=T||x||h||F,B=R||!a||"none"===E.id,z=Object(n.useCallback)((()=>{m(!0)}),[]),U=Object(n.useCallback)((()=>c(!1)),[c]),P=Object(n.useCallback)((()=>m(!1)),[]),_=Object(n.useCallback)((e=>{if("add-connector"===e)return void c(!0);const t=Object(It.a)(e,A),a=null!=t?Object(Vn.b)(t):Object(Vn.a)();O(a),w({connector:a,closureType:f})}),[A,f,w,O]),V=Object(n.useCallback)((e=>{k(e),w({connector:E,closureType:e})}),[E,w,k]);Object(n.useEffect)((()=>{T||"none"===E.id||A.some((e=>e.id===E.id))?T||"none"!==E.id&&!A.some((e=>e.id===E.id))||r(!0):r(!1)}),[A,E,T]),Object(n.useEffect)((()=>{T||"none"===E.id||b(Object(Vn.c)(A,E))}),[A,E,T]);const $=Object(n.useMemo)((()=>i?t.getAddConnectorFlyout({consumer:"case",onClose:U,actionTypes:D,reloadConnectors:M}):null),[i,D]),H=Object(n.useMemo)((()=>p&&d?t.getEditConnectorFlyout({initialConnector:p,consumer:"case",onClose:P,reloadConnectors:M}):null),[E.id,d]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(te,{showBackButton:!0,"data-test-subj":"case-configure-title",title:Vs.g}),s.a.createElement(ft.c,null,s.a.createElement(ft.a,null,s.a.createElement(rr,null,!a&&s.a.createElement(ft.b,{style:{marginTop:0}},s.a.createElement(C.EuiCallOut,{title:Vs.w,color:"warning",iconType:"help","data-test-subj":"configure-cases-warning-callout"},s.a.createElement(v.FormattedMessage,{defaultMessage:"The selected connector has been deleted or you do not have the {appropriateLicense} to use it. Either select a different connector or create a new one.",id:"xpack.cases.configure.connectorDeletedOrLicenseWarning",values:{appropriateLicense:s.a.createElement(C.EuiLink,{href:"https://www.elastic.co/subscriptions",target:"_blank"},Vs.s)}}))),s.a.createElement(ft.b,null,s.a.createElement(sr,{closureTypeSelected:f,disabled:x||T||!e,onChangeClosureType:V})),s.a.createElement(ft.b,null,s.a.createElement(Zs,{actionTypes:N,connectors:null!=A?A:[],disabled:x||T||!e,handleShowEditFlyout:z,isLoading:R,mappings:j,onChangeConnector:_,selectedConnector:E,updateConnectorDisabled:B||!e})),$,H))))}));ir.displayName="ConfigureCases";const or=e=>E.i18n.translate("xpack.cases.noPrivileges.message",{values:{pageName:e},defaultMessage:"To view {pageName} page, you must update privileges. For more information, contact your Kibana administrator."}),lr=E.i18n.translate("xpack.cases.noPrivileges.title",{defaultMessage:"Privileges required"}),cr=E.i18n.translate("xpack.cases.noPrivileges.button",{defaultMessage:"Back to Cases"}),ur=s.a.memo((({pageName:e})=>{const{navigateToAllCases:t}=Object(o.i)();return s.a.createElement(C.EuiEmptyPrompt,{iconColor:"default",iconType:"casesApp",title:s.a.createElement("h2",null,lr),titleSize:"xs",body:s.a.createElement("p",null,or(e)),actions:s.a.createElement(C.EuiButton,{onClick:t,size:"s",color:"primary",fill:!0},cr)})}));ur.displayName="NoPrivilegesPage";const dr=E.i18n.translate("xpack.cases.createCase",{defaultMessage:"Create Case"}),mr=E.i18n.translate("xpack.cases.configureCases",{defaultMessage:"Configure Cases"}),pr=E.i18n.translate("xpack.cases.badge.readOnly.text",{defaultMessage:"Read only"}),br=E.i18n.translate("xpack.cases.badge.readOnly.tooltip",{defaultMessage:"Unable to create or edit cases"}),gr=({onComponentInitialized:e,actionsNavigation:t,ruleDetailsNavigation:a,showAlertDetails:c,useFetchAlertData:u,refreshRef:d,timelineIntegration:m})=>{const{basePath:p,userCanCrud:b}=Object(g.a)(),{navigateToAllCases:E}=Object(o.i)(),{navigateToCaseView:f}=Object(o.j)();!function(){const{userCanCrud:e}=Object(g.a)(),t=Object(l.f)().services.chrome,a=Object(n.useCallback)((()=>{e||t.setBadge({text:pr,tooltip:br,iconType:"glasses"})}),[t,e]);Object(n.useEffect)((()=>(a(),()=>{t.setBadge()})),[a,t])}();const h=Object(n.useCallback)((async({id:e})=>f({detailName:e})),[f]);return s.a.createElement(r.Switch,null,s.a.createElement(i.Route,{strict:!0,exact:!0,path:p},s.a.createElement(le,null)),s.a.createElement(i.Route,{path:Object(o.h)(p)},b?s.a.createElement(zs,{onSuccess:h,onCancel:E,timelineIntegration:m}):s.a.createElement(ur,{pageName:dr})),s.a.createElement(i.Route,{path:Object(o.f)(p)},b?s.a.createElement(ir,null):s.a.createElement(ur,{pageName:mr})),s.a.createElement(i.Route,{exact:!0,path:[Object(o.e)(p),Object(o.d)(p)]},s.a.createElement(Rs,{onComponentInitialized:e,actionsNavigation:t,ruleDetailsNavigation:a,showAlertDetails:c,useFetchAlertData:u,refreshRef:d,timelineIntegration:m})),s.a.createElement(i.Route,{path:p},s.a.createElement(r.Redirect,{to:p})))};gr.displayName="CasesRoutes";const Er=s.a.memo(gr)},,,,,,,,,function(e,t,a){e.exports=a(29)(1071)},,,,,,,,,,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(1),s=a.n(n),r=a(12),i=a(2);const o=i.i18n.translate("xpack.cases.connectors.serviceNow.deprecatedConnectorWarningTitle",{defaultMessage:"This connector type is deprecated"}),l=i.i18n.translate("xpack.cases.connectors.serviceNow.deprecatedConnectorWarningDesc",{defaultMessage:"Update this connector, or create a new one."}),c=({type:e="warning"})=>s.a.createElement(r.EuiCallOut,{title:o,color:e,iconType:"alert","data-test-subj":"deprecated-connector-warning-callout"},l);c.displayName="DeprecatedCallout";const u=s.a.memo(c)},,,function(e,t,a){"use strict";a.d(t,"c",(function(){return r})),a.d(t,"d",(function(){return i})),a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return l})),a.d(t,"e",(function(){return c}));var n=a(34),s=a.n(n);const r=s.a.div.withConfig({displayName:"WhitePageWrapper",componentId:"sc-1jiyl3r-0"})(["background-color:",";border-top:",";flex:1 1 auto;"],(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiBorderThin)),i=s.a.div.withConfig({displayName:"WhitePageWrapperNoBorder",componentId:"sc-1jiyl3r-1"})(["background-color:",";flex:1 1 auto;"],(({theme:e})=>e.eui.euiColorEmptyShade)),o=s.a.div.withConfig({displayName:"SectionWrapper",componentId:"sc-1jiyl3r-2"})(["box-sizing:content-box;margin:0 auto;max-width:1175px;width:100%;"]),l=s.a.div.withConfig({displayName:"ContentWrapper",componentId:"sc-1jiyl3r-3"})(["",";"],(({theme:e})=>`\n      padding: ${e.eui.paddingSizes.l} 0 70px 0;\n    `)),c=s.a.div.withConfig({displayName:"Wrapper",componentId:"sc-1jiyl3r-4"})(["display:flex;flex-direction:column;"])},,,,,,,,,,,,,,,function(e,t,a){e.exports=a(29)(387)},function(e,t,a){"use strict";var n=a(199);e.exports=function(e,t){return t||0===e.length||s.test(e)||n(e,"(")!==n(e,")")?"<"+e+">":e};var s=/\s/},function(e,t,a){"use strict";e.exports=function(e){var t=-1===e.indexOf('"')?'"':"'";return t+e+t}},,,,,,,,,,,,,,,,,,,,function(e,t,a){"use strict";e.exports=function e(t,a){if(t===a)return!0;if(t&&a&&"object"==typeof t&&"object"==typeof a){if(t.constructor!==a.constructor)return!1;var n,s,r;if(Array.isArray(t)){if((n=t.length)!=a.length)return!1;for(s=n;0!=s--;)if(!e(t[s],a[s]))return!1;return!0}if(t.constructor===RegExp)return t.source===a.source&&t.flags===a.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===a.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===a.toString();if((n=(r=Object.keys(t)).length)!==Object.keys(a).length)return!1;for(s=n;0!=s--;)if(!Object.prototype.hasOwnProperty.call(a,r[s]))return!1;for(s=n;0!=s--;){var i=r[s];if(!e(t[i],a[i]))return!1}return!0}return t!=t&&a!=a}},function(e,t){var a={utf8:{stringToBytes:function(e){return a.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(a.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],a=0;a<e.length;a++)t.push(255&e.charCodeAt(a));return t},bytesToString:function(e){for(var t=[],a=0;a<e.length;a++)t.push(String.fromCharCode(e[a]));return t.join("")}}};e.exports=a},function(e,t,a){"use strict";e.exports=function(e){return e}},function(e,t,a){"use strict";e.exports={gfm:!0,commonmark:!1,pedantic:!1,entities:"false",setext:!1,closeAtx:!1,tableCellPadding:!0,tablePipeAlign:!0,stringLength:function(e){return e.length},incrementListMarker:!0,tightDefinitions:!1,fences:!1,fence:"`",bullet:"-",listItemIndent:"tab",rule:"*",ruleSpaces:!0,ruleRepetition:3,strong:"*",emphasis:"_"}},function(e,t,a){e.exports=a(29)(443)},function(e,t,a){"use strict";var n=a(174);e.exports=function(e){var t;return"&"!==e.charAt(0)?0:(t=e.split("&",2).join("&")).length-n(t).length}},function(e,t,a){"use strict";var n=a(84);e.exports=function(e,t){for(var a=e.split("\n"),s=a.length,r=n(" ",4*t);s--;)0!==a[s].length&&(a[s]=r+a[s]);return a.join("\n")}},function(e,t,a){"use strict";e.exports=function(e,t){var a,n,s=0,r=0;if("string"!=typeof t||1!==t.length)throw new Error("Expected character");for(a=n=(e=String(e)).indexOf(t);-1!==n;)s++,n===a?s>r&&(r=s):s=1,a=n+1,n=e.indexOf(t,a);return r}},function(e,t,a){"use strict";e.exports=function(e){var t=e.referenceType;return"shortcut"===t?"":"["+("collapsed"===t?"":e.label||e.identifier)+"]"}},,,,,,,function(e,t,a){var n,s,r,i,o;n=a(153),s=a(138).utf8,r=a(154),i=a(138).bin,(o=function(e,t){e.constructor==String?e=t&&"binary"===t.encoding?i.stringToBytes(e):s.stringToBytes(e):r(e)?e=Array.prototype.slice.call(e,0):Array.isArray(e)||(e=e.toString());for(var a=n.bytesToWords(e),l=8*e.length,c=1732584193,u=-271733879,d=-1732584194,m=271733878,p=0;p<a.length;p++)a[p]=16711935&(a[p]<<8|a[p]>>>24)|4278255360&(a[p]<<24|a[p]>>>8);a[l>>>5]|=128<<l%32,a[14+(l+64>>>9<<4)]=l;var b=o._ff,g=o._gg,E=o._hh,f=o._ii;for(p=0;p<a.length;p+=16){var h=c,y=u,C=d,v=m;c=b(c,u,d,m,a[p+0],7,-680876936),m=b(m,c,u,d,a[p+1],12,-389564586),d=b(d,m,c,u,a[p+2],17,606105819),u=b(u,d,m,c,a[p+3],22,-1044525330),c=b(c,u,d,m,a[p+4],7,-176418897),m=b(m,c,u,d,a[p+5],12,1200080426),d=b(d,m,c,u,a[p+6],17,-1473231341),u=b(u,d,m,c,a[p+7],22,-45705983),c=b(c,u,d,m,a[p+8],7,1770035416),m=b(m,c,u,d,a[p+9],12,-1958414417),d=b(d,m,c,u,a[p+10],17,-42063),u=b(u,d,m,c,a[p+11],22,-1990404162),c=b(c,u,d,m,a[p+12],7,1804603682),m=b(m,c,u,d,a[p+13],12,-40341101),d=b(d,m,c,u,a[p+14],17,-1502002290),c=g(c,u=b(u,d,m,c,a[p+15],22,1236535329),d,m,a[p+1],5,-165796510),m=g(m,c,u,d,a[p+6],9,-1069501632),d=g(d,m,c,u,a[p+11],14,643717713),u=g(u,d,m,c,a[p+0],20,-373897302),c=g(c,u,d,m,a[p+5],5,-701558691),m=g(m,c,u,d,a[p+10],9,38016083),d=g(d,m,c,u,a[p+15],14,-660478335),u=g(u,d,m,c,a[p+4],20,-405537848),c=g(c,u,d,m,a[p+9],5,568446438),m=g(m,c,u,d,a[p+14],9,-1019803690),d=g(d,m,c,u,a[p+3],14,-187363961),u=g(u,d,m,c,a[p+8],20,1163531501),c=g(c,u,d,m,a[p+13],5,-1444681467),m=g(m,c,u,d,a[p+2],9,-51403784),d=g(d,m,c,u,a[p+7],14,1735328473),c=E(c,u=g(u,d,m,c,a[p+12],20,-1926607734),d,m,a[p+5],4,-378558),m=E(m,c,u,d,a[p+8],11,-2022574463),d=E(d,m,c,u,a[p+11],16,1839030562),u=E(u,d,m,c,a[p+14],23,-35309556),c=E(c,u,d,m,a[p+1],4,-1530992060),m=E(m,c,u,d,a[p+4],11,1272893353),d=E(d,m,c,u,a[p+7],16,-155497632),u=E(u,d,m,c,a[p+10],23,-1094730640),c=E(c,u,d,m,a[p+13],4,681279174),m=E(m,c,u,d,a[p+0],11,-358537222),d=E(d,m,c,u,a[p+3],16,-722521979),u=E(u,d,m,c,a[p+6],23,76029189),c=E(c,u,d,m,a[p+9],4,-640364487),m=E(m,c,u,d,a[p+12],11,-421815835),d=E(d,m,c,u,a[p+15],16,530742520),c=f(c,u=E(u,d,m,c,a[p+2],23,-995338651),d,m,a[p+0],6,-198630844),m=f(m,c,u,d,a[p+7],10,1126891415),d=f(d,m,c,u,a[p+14],15,-1416354905),u=f(u,d,m,c,a[p+5],21,-57434055),c=f(c,u,d,m,a[p+12],6,1700485571),m=f(m,c,u,d,a[p+3],10,-1894986606),d=f(d,m,c,u,a[p+10],15,-1051523),u=f(u,d,m,c,a[p+1],21,-2054922799),c=f(c,u,d,m,a[p+8],6,1873313359),m=f(m,c,u,d,a[p+15],10,-30611744),d=f(d,m,c,u,a[p+6],15,-1560198380),u=f(u,d,m,c,a[p+13],21,1309151649),c=f(c,u,d,m,a[p+4],6,-145523070),m=f(m,c,u,d,a[p+11],10,-1120210379),d=f(d,m,c,u,a[p+2],15,718787259),u=f(u,d,m,c,a[p+9],21,-343485551),c=c+h>>>0,u=u+y>>>0,d=d+C>>>0,m=m+v>>>0}return n.endian([c,u,d,m])})._ff=function(e,t,a,n,s,r,i){var o=e+(t&a|~t&n)+(s>>>0)+i;return(o<<r|o>>>32-r)+t},o._gg=function(e,t,a,n,s,r,i){var o=e+(t&n|a&~n)+(s>>>0)+i;return(o<<r|o>>>32-r)+t},o._hh=function(e,t,a,n,s,r,i){var o=e+(t^a^n)+(s>>>0)+i;return(o<<r|o>>>32-r)+t},o._ii=function(e,t,a,n,s,r,i){var o=e+(a^(t|~n))+(s>>>0)+i;return(o<<r|o>>>32-r)+t},o._blocksize=16,o._digestsize=16,e.exports=function(e,t){if(null==e)throw new Error("Illegal argument "+e);var a=n.wordsToBytes(o(e,t));return t&&t.asBytes?a:t&&t.asString?i.bytesToString(a):n.bytesToHex(a)}},function(e,t){var a,n;a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n={rotl:function(e,t){return e<<t|e>>>32-t},rotr:function(e,t){return e<<32-t|e>>>t},endian:function(e){if(e.constructor==Number)return 16711935&n.rotl(e,8)|4278255360&n.rotl(e,24);for(var t=0;t<e.length;t++)e[t]=n.endian(e[t]);return e},randomBytes:function(e){for(var t=[];e>0;e--)t.push(Math.floor(256*Math.random()));return t},bytesToWords:function(e){for(var t=[],a=0,n=0;a<e.length;a++,n+=8)t[n>>>5]|=e[a]<<24-n%32;return t},wordsToBytes:function(e){for(var t=[],a=0;a<32*e.length;a+=8)t.push(e[a>>>5]>>>24-a%32&255);return t},bytesToHex:function(e){for(var t=[],a=0;a<e.length;a++)t.push((e[a]>>>4).toString(16)),t.push((15&e[a]).toString(16));return t.join("")},hexToBytes:function(e){for(var t=[],a=0;a<e.length;a+=2)t.push(parseInt(e.substr(a,2),16));return t},bytesToBase64:function(e){for(var t=[],n=0;n<e.length;n+=3)for(var s=e[n]<<16|e[n+1]<<8|e[n+2],r=0;r<4;r++)8*n+6*r<=8*e.length?t.push(a.charAt(s>>>6*(3-r)&63)):t.push("=");return t.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/gi,"");for(var t=[],n=0,s=0;n<e.length;s=++n%4)0!=s&&t.push((a.indexOf(e.charAt(n-1))&Math.pow(2,-2*s+8)-1)<<2*s|a.indexOf(e.charAt(n))>>>6-2*s);return t}},e.exports=n},function(e,t){function a(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
e.exports=function(e){return null!=e&&(a(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&a(e.slice(0,0))}(e)||!!e._isBuffer)}},function(e,t,a){"use strict";var n=a(156),s={"text/plain":"Text","text/html":"Url",default:"Text"};e.exports=function(e,t){var a,r,i,o,l,c,u=!1;t||(t={}),a=t.debug||!1;try{if(i=n(),o=document.createRange(),l=document.getSelection(),(c=document.createElement("span")).textContent=e,c.style.all="unset",c.style.position="fixed",c.style.top=0,c.style.clip="rect(0, 0, 0, 0)",c.style.whiteSpace="pre",c.style.webkitUserSelect="text",c.style.MozUserSelect="text",c.style.msUserSelect="text",c.style.userSelect="text",c.addEventListener("copy",(function(n){if(n.stopPropagation(),t.format)if(n.preventDefault(),void 0===n.clipboardData){a&&console.warn("unable to use e.clipboardData"),a&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var r=s[t.format]||s.default;window.clipboardData.setData(r,e)}else n.clipboardData.clearData(),n.clipboardData.setData(t.format,e);t.onCopy&&(n.preventDefault(),t.onCopy(n.clipboardData))})),document.body.appendChild(c),o.selectNodeContents(c),l.addRange(o),!document.execCommand("copy"))throw new Error("copy command was unsuccessful");u=!0}catch(n){a&&console.error("unable to copy using execCommand: ",n),a&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(t.format||"text",e),t.onCopy&&t.onCopy(window.clipboardData),u=!0}catch(n){a&&console.error("unable to copy using clipboardData: ",n),a&&console.error("falling back to prompt"),r=function(e){var t=(/mac os x/i.test(navigator.userAgent)?"⌘":"Ctrl")+"+C";return e.replace(/#{\s*key\s*}/g,t)}("message"in t?t.message:"Copy to clipboard: #{key}, Enter"),window.prompt(r,e)}}finally{l&&("function"==typeof l.removeRange?l.removeRange(o):l.removeAllRanges()),c&&document.body.removeChild(c),i()}return u}},function(e,t){e.exports=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var t=document.activeElement,a=[],n=0;n<e.rangeCount;n++)a.push(e.getRangeAt(n));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||a.forEach((function(t){e.addRange(t)})),t&&t.focus()}}},function(e,t,a){e.exports=a(29)(1733)},function(e,t,a){"use strict";var n=a(159),s=a(115),r=a(160);function i(e){var t=n(r);t.prototype.options=s(t.prototype.options,this.data("settings"),e),this.Compiler=t}e.exports=i,i.Compiler=r},function(e,t,a){e.exports=a(29)(3230)},function(e,t,a){"use strict";var n=a(115),s=a(161);function r(e,t){this.inLink=!1,this.inTable=!1,this.tree=e,this.file=t,this.options=n(this.options),this.setOptions({})}e.exports=r;var i=r.prototype;i.enterLink=s("inLink",!1),i.enterTable=s("inTable",!1),i.enterLinkReference=a(162),i.options=a(140),i.setOptions=a(163),i.compile=a(175),i.visit=a(178),i.all=a(179),i.block=a(180),i.visitOrderedItems=a(181),i.visitUnorderedItems=a(182),i.visitors={root:a(183),text:a(184),heading:a(185),paragraph:a(186),blockquote:a(187),list:a(188),listItem:a(189),inlineCode:a(190),code:a(191),html:a(192),thematicBreak:a(193),strong:a(194),emphasis:a(195),break:a(196),delete:a(197),link:a(198),linkReference:a(200),imageReference:a(202),definition:a(203),image:a(204),table:a(205),tableCell:a(207)}},function(e,t,a){e.exports=a(29)(3233)},function(e,t,a){"use strict";var n=a(139);e.exports=function(e,t){var a=e.encode,s=e.escape,r=e.enterLink();return"shortcut"!==t.referenceType&&"collapsed"!==t.referenceType?r:(e.escape=n,e.encode=n,function(){e.encode=a,e.escape=s,r()})}},function(e,t,a){"use strict";var n=a(115),s=a(164),r=a(140),i=a(170),o=a(139);e.exports=function(e){var t,a,d=this,m=d.options;if(null==e)e={};else{if("object"!=typeof e)throw new Error("Invalid value `"+e+"` for setting `options`");e=n(e)}for(a in r)c[typeof r[a]](e,a,m[a],l[a]);return(t=e.ruleRepetition)&&t<3&&u(t,"options.ruleRepetition"),d.encode=function(e){var t={};return"false"===e?o:("true"===e&&(t.useNamedReferences=!0),"escape"===e&&(t.escapeOnly=!0,t.useNamedReferences=!0),function(e){return s(e,t)})}(String(e.entities)),d.escape=i(e),d.options=e,d};var l={entities:{true:!0,false:!0,numbers:!0,escape:!0},bullet:{"*":!0,"-":!0,"+":!0},rule:{"-":!0,_:!0,"*":!0},listItemIndent:{tab:!0,mixed:!0,1:!0},emphasis:{_:!0,"*":!0},strong:{_:!0,"*":!0},fence:{"`":!0,"~":!0}},c={boolean:function(e,t,a){var n=e[t];null==n&&(n=a),"boolean"!=typeof n&&u(n,"options."+t),e[t]=n},string:function(e,t,a,n){var s=e[t];null==s&&(s=a),(s=String(s))in n||u(s,"options."+t),e[t]=s},number:function(e,t,a){var n=e[t];null==n&&(n=a),isNaN(n)&&u(n,"options."+t),e[t]=n},function:function(e,t,a){var n=e[t];null==n&&(n=a),"function"!=typeof n&&u(n,"options."+t),e[t]=n}};function u(e,t){throw new Error("Invalid value `"+e+"` for setting `"+t+"`")}},function(e,t,a){"use strict";var n=a(165),s=a(166),r=a(167),i=a(141),o=a(168),l=a(169);e.exports=b,b.escape=function(e){return b(e,{escapeOnly:!0,useNamedReferences:!0})};var c={}.hasOwnProperty,u=function(){var e,t={};for(e in n)t[n[e]]=e;return t}(),d=f(['"',"'","<",">","&","`"]),m=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,p=/[\x01-\t\x0B\f\x0E-\x1F\x7F\x81\x8D\x8F\x90\x9D\xA0-\uFFFF]/g;function b(e,t){var a=t||{},n=a.subset,r=n?f(n):d,i=a.escapeOnly,b=a.omitOptionalSemicolons;return e=e.replace(r,h),n||i?e:e.replace(m,(function(e,t,a){return g(1024*(e.charCodeAt(0)-55296)+e.charCodeAt(1)-56320+65536,a.charCodeAt(t+2),b)})).replace(p,h);function h(e,t,n){return function(e,t,a){var n,r,i,d,m=a.useShortestReferences,p=a.omitOptionalSemicolons;return(m||a.useNamedReferences)&&c.call(u,e)&&(n=function(e,t,a,n){var r="&"+e;return a&&c.call(s,e)&&-1===l.indexOf(e)&&(!n||t&&61!==t&&!o(t))?r:r+";"}(u[e],t,p,a.attribute)),!m&&n||(i=g(r=e.charCodeAt(0),t,p),m&&(d=E(r,t,p)).length<i.length&&(i=d)),n&&(!m||n.length<i.length)?n:i}(e,n.charCodeAt(t+1),a)}}function g(e,t,a){var n="&#x"+e.toString(16).toUpperCase();return a&&t&&!r(t)?n:n+";"}function E(e,t,a){var n="&#"+String(e);return a&&t&&!i(t)?n:n+";"}function f(e){return new RegExp("["+e.join("")+"]","g")}},function(e){e.exports=JSON.parse('{"nbsp":" ","iexcl":"¡","cent":"¢","pound":"£","curren":"¤","yen":"¥","brvbar":"¦","sect":"§","uml":"¨","copy":"©","ordf":"ª","laquo":"«","not":"¬","shy":"­","reg":"®","macr":"¯","deg":"°","plusmn":"±","sup2":"²","sup3":"³","acute":"´","micro":"µ","para":"¶","middot":"·","cedil":"¸","sup1":"¹","ordm":"º","raquo":"»","frac14":"¼","frac12":"½","frac34":"¾","iquest":"¿","Agrave":"À","Aacute":"Á","Acirc":"Â","Atilde":"Ã","Auml":"Ä","Aring":"Å","AElig":"Æ","Ccedil":"Ç","Egrave":"È","Eacute":"É","Ecirc":"Ê","Euml":"Ë","Igrave":"Ì","Iacute":"Í","Icirc":"Î","Iuml":"Ï","ETH":"Ð","Ntilde":"Ñ","Ograve":"Ò","Oacute":"Ó","Ocirc":"Ô","Otilde":"Õ","Ouml":"Ö","times":"×","Oslash":"Ø","Ugrave":"Ù","Uacute":"Ú","Ucirc":"Û","Uuml":"Ü","Yacute":"Ý","THORN":"Þ","szlig":"ß","agrave":"à","aacute":"á","acirc":"â","atilde":"ã","auml":"ä","aring":"å","aelig":"æ","ccedil":"ç","egrave":"è","eacute":"é","ecirc":"ê","euml":"ë","igrave":"ì","iacute":"í","icirc":"î","iuml":"ï","eth":"ð","ntilde":"ñ","ograve":"ò","oacute":"ó","ocirc":"ô","otilde":"õ","ouml":"ö","divide":"÷","oslash":"ø","ugrave":"ù","uacute":"ú","ucirc":"û","uuml":"ü","yacute":"ý","thorn":"þ","yuml":"ÿ","fnof":"ƒ","Alpha":"Α","Beta":"Β","Gamma":"Γ","Delta":"Δ","Epsilon":"Ε","Zeta":"Ζ","Eta":"Η","Theta":"Θ","Iota":"Ι","Kappa":"Κ","Lambda":"Λ","Mu":"Μ","Nu":"Ν","Xi":"Ξ","Omicron":"Ο","Pi":"Π","Rho":"Ρ","Sigma":"Σ","Tau":"Τ","Upsilon":"Υ","Phi":"Φ","Chi":"Χ","Psi":"Ψ","Omega":"Ω","alpha":"α","beta":"β","gamma":"γ","delta":"δ","epsilon":"ε","zeta":"ζ","eta":"η","theta":"θ","iota":"ι","kappa":"κ","lambda":"λ","mu":"μ","nu":"ν","xi":"ξ","omicron":"ο","pi":"π","rho":"ρ","sigmaf":"ς","sigma":"σ","tau":"τ","upsilon":"υ","phi":"φ","chi":"χ","psi":"ψ","omega":"ω","thetasym":"ϑ","upsih":"ϒ","piv":"ϖ","bull":"•","hellip":"…","prime":"′","Prime":"″","oline":"‾","frasl":"⁄","weierp":"℘","image":"ℑ","real":"ℜ","trade":"™","alefsym":"ℵ","larr":"←","uarr":"↑","rarr":"→","darr":"↓","harr":"↔","crarr":"↵","lArr":"⇐","uArr":"⇑","rArr":"⇒","dArr":"⇓","hArr":"⇔","forall":"∀","part":"∂","exist":"∃","empty":"∅","nabla":"∇","isin":"∈","notin":"∉","ni":"∋","prod":"∏","sum":"∑","minus":"−","lowast":"∗","radic":"√","prop":"∝","infin":"∞","ang":"∠","and":"∧","or":"∨","cap":"∩","cup":"∪","int":"∫","there4":"∴","sim":"∼","cong":"≅","asymp":"≈","ne":"≠","equiv":"≡","le":"≤","ge":"≥","sub":"⊂","sup":"⊃","nsub":"⊄","sube":"⊆","supe":"⊇","oplus":"⊕","otimes":"⊗","perp":"⊥","sdot":"⋅","lceil":"⌈","rceil":"⌉","lfloor":"⌊","rfloor":"⌋","lang":"〈","rang":"〉","loz":"◊","spades":"♠","clubs":"♣","hearts":"♥","diams":"♦","quot":"\\"","amp":"&","lt":"<","gt":">","OElig":"Œ","oelig":"œ","Scaron":"Š","scaron":"š","Yuml":"Ÿ","circ":"ˆ","tilde":"˜","ensp":" ","emsp":" ","thinsp":" ","zwnj":"‌","zwj":"‍","lrm":"‎","rlm":"‏","ndash":"–","mdash":"—","lsquo":"‘","rsquo":"’","sbquo":"‚","ldquo":"“","rdquo":"”","bdquo":"„","dagger":"†","Dagger":"‡","permil":"‰","lsaquo":"‹","rsaquo":"›","euro":"€"}')},function(e,t,a){e.exports=a(29)(2850)},function(e,t,a){e.exports=a(29)(2852)},function(e,t,a){e.exports=a(29)(2853)},function(e){e.exports=JSON.parse('["cent","copy","divide","gt","lt","not","para","times"]')},function(e,t,a){"use strict";var n=a(141),s=a(171),r=a(172),i=a(173),o=a(142);e.exports=function(e){return function(t,a,O){var k,T,A,S,F,N,L=this,D=e.gfm,M=e.commonmark,R=e.pedantic,B=M?[b,")"]:[b],z=O&&O.children,U=z&&z.indexOf(a),P=z&&z[U-1],_=z&&z[U+1],V=t.length,$=i(e),H=-1,G=[],q=G;for(k=P?w(P)&&j.test(P.value):!O||"root"===O.type||"paragraph"===O.type;++H<V;){if(N=!1,"\n"===(T=t.charAt(H)))k=!0;else if(T===E||"`"===T||T===p||"["===T||"<"===T||T===d&&o(t.slice(H))>0||"]"===T&&L.inLink||D&&T===h&&t.charAt(H+1)===h||D&&"|"===T&&(L.inTable||x(t,H))||T===f&&H>0&&H<V-1&&(R||!s(t.charAt(H-1))||!s(t.charAt(H+1)))||D&&!L.inLink&&T===g&&I(G.join("")))N=!0;else if(k)if(">"===T||"#"===T||T===p||"-"===T||"+"===T)N=!0;else if(n(T)){for(F=H+1;F<V&&n(t.charAt(F));)F++;-1!==B.indexOf(t.charAt(F))&&((_=t.charAt(F+1))&&_!==u&&_!==l&&_!==c||(G.push(t.slice(H,F)),H=F,T=t.charAt(H),N=!0))}k&&!r(T)&&(k=!1),G.push(N?W(T):T)}if(z&&w(a)){if(P&&P.referenceType===v){for(H=-1,V=q.length;++H<V;)if((T=q[H])!==u&&T!==l){T!==m&&T!==g||(q[H]=W(T));break}w(_)&&H===V&&_.value.charAt(0)===m&&q.push(E)}D&&!L.inLink&&w(P)&&t.charAt(0)===g&&I(P.value.slice(-6))&&(q[0]=W(g)),w(_)&&t.charAt(V-1)===d&&0!==o(d+_.value)&&(q[q.length-1]=W(d)),_&&"link"===_.type&&t.charAt(V-1)===y&&(q[q.length-1]=W(y)),D&&w(_)&&t.charAt(V-1)===h&&_.value.charAt(0)===h&&q.splice(-1,0,E),A=w(P)&&s(P.value.slice(-1)),S=w(_)&&s(_.value.charAt(0)),1===V?t!==f||!R&&A&&S||q.unshift(E):(t.charAt(0)!==f||!R&&A&&s(t.charAt(1))||q.unshift(E),t.charAt(V-1)!==f||!R&&S&&s(t.charAt(V-2))||q.splice(-1,0,E))}return q.join("");function W(e){return-1===$.indexOf(e)?C[e]:E+e}}};var l="\t",c="\n",u=" ",d="&",m="(",p="*",b=".",g=":",E="\\",f="_",h="~",y="!",C={"<":"&lt;",":":"&#x3A;","&":"&amp;","|":"&#x7C;","~":"&#x7E;"},v="shortcut",j=/\n\s*$/;function x(e,t){var a,n=e.lastIndexOf(c,t),s=e.indexOf(c,t);for(s=-1===s?e.length:s;++n<s;)if((a=e.charAt(n))!==g&&"-"!==a&&a!==u&&"|"!==a)return!1;return!0}function w(e){return e&&"text"===e.type}function I(e){var t=e.slice(-6).toLowerCase();return"mailto"===t||"https"===t.slice(-5)||"http"===t.slice(-4)}},function(e,t,a){"use strict";e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected a string");return!/[^0-9a-z\xDF-\xFF]/.test(e.toLowerCase())}},function(e,t,a){e.exports=a(29)(298)},function(e,t,a){e.exports=a(29)(3239)},function(e,t,a){e.exports=a(29)(569)},function(e,t,a){"use strict";var n=a(176);e.exports=function(){return this.visit(n(this.tree,this.options.commonmark))}},function(e,t,a){"use strict";var n=a(177);function s(e,t){var a,n;return"text"===e.type?!e.position||(a=e.position.start,n=e.position.end,a.line!==n.line||n.column-a.column===e.value.length):t&&"blockquote"===e.type}e.exports=function(e,t){return n(e,(function(e,a,n){var r=n?n.children:[],i=a&&r[a-1];if(i&&e.type===i.type&&s(i,t)&&s(e,t))return e.value&&(i.value+=e.value),e.children&&(i.children=i.children.concat(e.children)),r.splice(a,1),i.position&&e.position&&(i.position.end=e.position.end),a})),e}},function(e,t,a){e.exports=a(29)(302)},function(e,t,a){"use strict";e.exports=function(e,t){var a=this,n=a.visitors;return"function"!=typeof n[e.type]&&a.file.fail(new Error("Missing compiler for node of type `"+e.type+"`: `"+e+"`"),e),n[e.type].call(a,e,t)}},function(e,t,a){"use strict";e.exports=function(e){for(var t=e.children,a=t.length,n=[],s=-1;++s<a;)n[s]=this.visit(t[s],e);return n}},function(e,t,a){"use strict";e.exports=function(e){for(var t,a,r=this.options,i=r.fences,o=r.commonmark?"\n\n\x3c!----\x3e\n\n":"\n\n\n",l=r.tightDefinitions?n:s,c=[],u=e.children,d=u.length,m=-1;++m<d;)t=a,a=u[m],t&&("list"===t.type&&("list"===a.type&&t.ordered===a.ordered||"code"===a.type&&!a.lang&&!i)?c.push(o):"definition"===t.type&&"definition"===a.type?c.push(l):c.push(s)),c.push(this.visit(a,e));return c.join("")};var n="\n",s="\n\n"},function(e,t,a){"use strict";e.exports=function(e){var t,a=this,n=a.visitors.listItem,s=a.options.incrementListMarker,r=[],i=e.start,o=e.children,l=o.length,c=-1;for(i=null==i?1:i;++c<l;)t=(s?i+c:i)+".",r[c]=n.call(a,o[c],e,c,t);return r.join(e.spread?"\n\n":"\n")}},function(e,t,a){"use strict";e.exports=function(e){for(var t=this,a=t.options.bullet,n=t.visitors.listItem,s=e.children,r=s.length,i=-1,o=[];++i<r;)o[i]=n.call(t,s[i],e,i,a);return o.join(e.spread?"\n\n":"\n")}},function(e,t,a){"use strict";e.exports=function(e){var t=this.block(e);return"\n"!==t.charAt(t.length-1)&&(t+="\n"),t}},function(e,t,a){"use strict";e.exports=function(e,t){return this.encode(this.escape(e.value,e,t),e)}},function(e,t,a){"use strict";var n=a(84);e.exports=function(e){var t,a=this,s=e.depth,r=a.options.setext,i=a.options.closeAtx,o=a.all(e).join("");return r&&s<3?o+"\n"+n(1===s?"=":"-",o.length):(t=n("#",e.depth))+" "+o+(i?" "+t:"")}},function(e,t,a){"use strict";e.exports=function(e){return this.all(e).join("")}},function(e,t,a){"use strict";e.exports=function(e){for(var t,a=this.block(e).split("\n"),n=[],s=a.length,r=-1;++r<s;)t=a[r],n[r]=(t?" ":"")+t;return">"+n.join("\n>")}},function(e,t,a){"use strict";e.exports=function(e){return(e.ordered?this.visitOrderedItems:this.visitUnorderedItems).call(this,e)}},function(e,t,a){"use strict";var n=a(84),s=a(143);e.exports=function(e,t,a,l){for(var c,u,d,m=this,p=m.options.listItemIndent,b=l||m.options.bullet,g=null==e.spread||e.spread,E=e.checked,f=e.children,h=f.length,y=[],C=-1;++C<h;)y[C]=m.visit(f[C],e);return c=y.join(g?"\n\n":r),"boolean"==typeof E&&(c="["+(E?"x":i)+"]"+i+c),"1"===p||"mixed"===p&&-1===c.indexOf(r)?(u=b.length+1,d=i):(u=4*o((b.length+1)/4),d=n(i,u-b.length)),c?b+d+s(c,u/4).slice(u):b};var r="\n",i=" ",o=Math.ceil},function(e,t,a){"use strict";var n=a(144),s=a(84);function r(e){return 10===e||32===e}e.exports=function(e){var t,a,i=e.value,o=s("`",n(i,"`")+1),l=o,c=o,u=i.charCodeAt(0),d=i.charCodeAt(i.length-1),m=!1;if(96===u||96===d)m=!0;else if(i.length>2&&r(u)&&r(d))for(t=1,a=i.length-1;++t<a;)if(!r(i.charCodeAt(t))){m=!0;break}return m&&(l+=" ",c=" "+c),l+i+c}},function(e,t,a){"use strict";var n=a(144),s=a(84),r=a(143);e.exports=function(e,t){var a,o=this,l=e.value,c=o.options,u=c.fence,d=e.lang||"";return d&&e.meta&&(d+=" "+e.meta),(d=o.encode(o.escape(d,e)))||c.fences||!l||l.charAt(0)===i||l.charAt(l.length-1)===i?("`"===u&&-1!==d.indexOf("`")&&(u="~"),(a=s(u,Math.max(n(l,u)+1,3)))+d+i+l+i+a):(t&&"listItem"===t.type&&"tab"!==c.listItemIndent&&c.pedantic&&o.file.fail("Cannot indent code properly. See https://git.io/fxKR8",e.position),r(l,1))};var i="\n"},function(e,t,a){"use strict";e.exports=function(e){return e.value}},function(e,t,a){"use strict";var n=a(84);e.exports=function(){var e=this.options,t=n(e.rule,e.ruleRepetition);return e.ruleSpaces?t.split("").join(" "):t}},function(e,t,a){"use strict";var n=a(84);e.exports=function(e){var t=n(this.options.strong,2);return t+this.all(e).join("")+t}},function(e,t,a){"use strict";e.exports=function(e){var t=this.options.emphasis,a=this.all(e).join("");return this.options.pedantic&&"_"===t&&-1!==a.indexOf(t)&&(t="*"),t+a+t}},function(e,t,a){"use strict";e.exports=function(){return this.options.commonmark?"\\\n":"  \n"}},function(e,t,a){"use strict";e.exports=function(e){return"~~"+this.all(e).join("")+"~~"}},function(e,t,a){"use strict";var n=a(116),s=a(117);e.exports=function(e){var t=this,a=t.encode(e.url||"",e),i=t.enterLink(),o=t.encode(t.escape(e.url||"",e)),l=t.all(e).join("");return i(),null==e.title&&r.test(a)&&o===l?n(t.encode(e.url),!0):(a=n(a),e.title&&(a+=" "+s(t.encode(t.escape(e.title,e),e))),"["+l+"]("+a+")")};var r=/^[a-z][a-z+.-]+:\/?/i},function(e,t,a){e.exports=a(29)(3263)},function(e,t,a){"use strict";var n=a(201),s=a(145);e.exports=function(e){var t=this,a=e.referenceType,r=t.enterLinkReference(t,e),i=t.all(e).join("");return r(),("shortcut"===a||"collapsed"===a)&&(i=n(i,e.label||e.identifier)),"["+i+"]"+s(e)}},function(e,t,a){"use strict";var n=a(142);e.exports=function(e,t){for(var a,r=e.length,i=t.length,o=[],l=0,c=0;c<r;){for(a=c;c<r&&!s.test(e.charAt(c));)c+=1;for(o.push(e.slice(a,c));l<i&&!s.test(t.charAt(l));)l+=1;for(a=l;l<i&&s.test(t.charAt(l));)"&"===t.charAt(l)&&(l+=n(t.slice(l))),l+=1;for(o.push(t.slice(a,l));c<r&&s.test(e.charAt(c));)c+=1}return o.join("")};var s=/[-!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~_]/},function(e,t,a){"use strict";var n=a(145);e.exports=function(e){return"!["+(this.encode(e.alt,e)||"")+"]"+n(e)}},function(e,t,a){"use strict";var n=a(116),s=a(117);e.exports=function(e){var t=n(e.url);return e.title&&(t+=" "+s(e.title)),"["+(e.label||e.identifier)+"]: "+t}},function(e,t,a){"use strict";var n=a(116),s=a(117);e.exports=function(e){var t=this,a=n(t.encode(e.url||"",e)),r=t.enterLink(),i=t.encode(t.escape(e.alt||"",e));return r(),e.title&&(a+=" "+s(t.encode(e.title,e))),"!["+i+"]("+a+")"}},function(e,t,a){"use strict";var n=a(206);e.exports=function(e){for(var t=this,a=t.options,s=a.tableCellPadding,r=a.tablePipeAlign,i=a.stringLength,o=e.children,l=o.length,c=t.enterTable(),u=[];l--;)u[l]=t.all(o[l]);return c(),n(u,{align:e.align,alignDelimiters:r,padding:s,stringLength:i})}},function(e,t,a){"use strict";var n=a(84);e.exports=function(e,t){for(var a,u,d,m,p,b,g,E,f,h,y,C,v=t||{},j=!1!==v.padding,x=!1!==v.delimiterStart,w=!1!==v.delimiterEnd,I=(v.align||[]).concat(),O=!1!==v.alignDelimiters,k=[],T=v.stringLength||l,A=-1,S=e.length,F=[],N=[],L=[],D=[],M=[],R=0;++A<S;){for(u=-1,L=[],D=[],(d=(a=e[A]).length)>R&&(R=d);++u<d;)b=null==(C=a[u])?"":String(C),!0===O&&(p=T(b),D[u]=p,(void 0===(m=M[u])||p>m)&&(M[u]=p)),L.push(b);F[A]=L,N[A]=D}if(u=-1,d=R,"object"==typeof I&&"length"in I)for(;++u<d;)k[u]=c(I[u]);else for(y=c(I);++u<d;)k[u]=y;for(u=-1,d=R,L=[],D=[];++u<d;)f="",h="",108===(y=k[u])?f=i:y===o?h=i:99===y&&(f=i,h=i),p=O?Math.max(1,M[u]-f.length-h.length):1,b=f+n("-",p)+h,!0===O&&((p=f.length+p+h.length)>M[u]&&(M[u]=p),D[u]=p),L[u]=b;for(F.splice(1,0,L),N.splice(1,0,D),A=-1,S=F.length,g=[];++A<S;){for(L=F[A],D=N[A],u=-1,d=R,E=[];++u<d;)b=L[u]||"",f="",h="",!0===O&&(p=M[u]-(D[u]||0),(y=k[u])===o?f=n(r,p):99===y?p%2==0?h=f=n(r,p/2):(f=n(r,p/2+.5),h=n(r,p/2-.5)):h=n(r,p)),!0===x&&0===u&&E.push("|"),!0!==j||!1===O&&""===b||!0!==x&&0===u||E.push(r),!0===O&&E.push(f),E.push(b),!0===O&&E.push(h),!0===j&&E.push(r),!0!==w&&u===d-1||E.push("|");E=E.join(""),!1===w&&(E=E.replace(s,"")),g.push(E)}return g.join("\n")};var s=/ +$/,r=" ",i=":",o=114;function l(e){return e.length}function c(e){var t="string"==typeof e?e.charCodeAt(0):0;return 76===t||108===t?108:82===t||t===o?o:67===t||99===t?99:0}},function(e,t,a){"use strict";e.exports=function(e){return this.all(e).join("").replace(n," ")};var n=/\r?\n/g},function(e,t,a){e.exports=a(29)(923)}])]);