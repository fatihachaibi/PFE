/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[4],{192:function(t,n,e){"use strict";e.d(n,"a",(function(){return c}));var r=e(5),i=e(3),a=e(86),o=e(169),u=e(18);const c=()=>{const t=Object(u.n)(),n=Object(r.useRef)(t.addError.bind(t)).current,e=Object(r.useRef)(t.addSuccess.bind(t)).current,i=Object(r.useRef)(t.addWarning.bind(t)).current,a=Object(r.useRef)(t.remove.bind(t)).current,o=Object(r.useCallback)(((t,e)=>{const r=s(t);return n(r,e)}),[n]);return Object(r.useMemo)((()=>({api:t,addError:o,addSuccess:e,addWarning:i,remove:a})),[o,e,i,a,t])},s=t=>null!=t&&Object(o.isEsError)(t)?f(t):Object(a.q)(t)?p(t):t instanceof Error?l(t):d(t),f=t=>{var n,e,r,i,a;const o=null!=t.err?t.err:t,u=null!=(null===(n=t.err)||void 0===n?void 0:n.statusCode)?`(${t.err.statusCode})`:null!=t.statusCode?`(${t.statusCode})`:"",c=m(o),s=new Error(`${null!==(e=null===(r=t.attributes)||void 0===r?void 0:r.reason)&&void 0!==e?e:t.message} ${u}`);return s.name=null!==(i=null===(a=t.attributes)||void 0===a?void 0:a.reason)&&void 0!==i?i:t.message,null!=c&&(s.stack=c),s},p=t=>{const n=Object(a.r)(t)?`(${t.body.statusCode})`:Object(a.t)(t)?`(${t.body.status_code})`:"",e=m(t),r=new Error(`${""!==String(t.body.message).trim()?t.body.message:t.message} ${n}`);return r.name=null!=t.name?t.name:"",null!=e&&(r.stack=e),r},l=t=>{const n=m(t),e=new Error(t.message);return e.name=t.name,null!=n&&(e.stack=n),e},d=t=>{const n=m(t),e=Object(i.isString)(t)?t:t instanceof Object&&null!=n?n:String(t),r=new Error(e);return r.name=e,null!=n&&(r.stack=n),r},m=t=>{try{return JSON.stringify(t,((t,n)=>{const e=h(n);return g(e)?void 0:e}),2)}catch(t){return}},h=t=>t instanceof Error?{...t,name:t.name,message:t.message,stack:t.stack}:t,g=t=>{if(!(t instanceof Object))return!1;try{return"{}"===JSON.stringify(t)}catch(t){return!1}}},222:function(t,n,e){"use strict";e.d(n,"a",(function(){return r})),e.d(n,"f",(function(){return i})),e.d(n,"e",(function(){return a})),e.d(n,"b",(function(){return o})),e.d(n,"d",(function(){return u})),e.d(n,"g",(function(){return c})),e.d(n,"c",(function(){return s}));const r={ACTION:"action",RESPONSE:"response",FLEET_ACTION:"fleetAction",FLEET_RESPONSE:"fleetResponse"};let i,a,o,u,c,s;!function(t){t.windows="windows",t.mac="mac",t.linux="linux"}(i||(i={})),function(t){t.is="is",t.matches="matches"}(a||(a={})),function(t){t.enrolled="enrolled",t.unenrolled="unenrolled"}(o||(o={})),function(t){t.UNHEALTHY="unhealthy",t.HEALTHY="healthy",t.OFFLINE="offline",t.UPDATING="updating",t.INACTIVE="inactive",t.UNENROLLED="unenrolled"}(u||(u={})),function(t){t.detect="detect",t.prevent="prevent",t.off="off"}(c||(c={})),function(t){t.success="success",t.failure="failure",t.warning="warning",t.unsupported="unsupported"}(s||(s={}))},224:function(t,n,e){"use strict";e.d(n,"a",(function(){return a}));var r=e(5),i=e(814);const a=()=>Object(r.useContext)(i.a)},234:function(t,n,e){"use strict";e.d(n,"a",(function(){return u})),e.d(n,"b",(function(){return o})),e.d(n,"c",(function(){return f})),e.d(n,"d",(function(){return p}));var r=e(38),i=e.n(r),a=e(5),o=function(){var t=Object(a.useRef)(!1),n=Object(a.useCallback)((function(){return t.current}),[]),e=Object(a.useCallback)((function(){t.current=!1}),[]);return Object(a.useEffect)((function(){return t.current=!0,e}),[e]),n},u=function(t){var n=o(),e=Object(a.useState)(!1),r=i()(e,2),u=r[0],c=r[1],s=Object(a.useState)(),f=i()(s,2),p=f[0],l=f[1],d=Object(a.useState)(),m=i()(d,2),h=m[0],g=m[1],b=Object(a.useCallback)((function(){c(!0),g(void 0),l(void 0),t.apply(void 0,arguments).then((function(t){return n()&&g(t)})).catch((function(t){return n()&&l(t)})).finally((function(){return n()&&c(!1)}))}),[t,n]);return{error:p,loading:u,result:h,start:b}},c=e(11),s=e.n(c),f=function(t){var n=o(),e=Object(a.useRef)(),r=Object(a.useReducer)((function(t,n){switch(n.type){case"setResult":return s()(s()({},t),{},{result:n.result,loading:!1});case"setError":return s()(s()({},t),{},{error:n.error,loading:!1});case"load":return{loading:!0,result:void 0,error:void 0}}}),{loading:!1,error:void 0,result:void 0}),u=i()(r,2),c=u[0],f=u[1],p=Object(a.useCallback)((function(){e.current&&e.current.unsubscribe(),f({type:"load"}),e.current=t.apply(void 0,arguments).subscribe((function(t){n()&&f({type:"setResult",result:t})}),(function(t){n()&&f({type:"setError",error:t})}))}),[t,n]);return Object(a.useEffect)((function(){return function(){e.current&&e.current.unsubscribe()}}),[]),{result:c.result,error:c.error,loading:c.loading,start:p}},p=function(t){return function(n){var e=null!=n.signal?n.signal:(new AbortController).signal;return t(s()(s()({},n),{},{signal:e}))}}},254:function(t,n,e){"use strict";e.d(n,"b",(function(){return j})),e.d(n,"c",(function(){return E})),e.d(n,"r",(function(){return x})),e.d(n,"s",(function(){return T})),e.d(n,"l",(function(){return _})),e.d(n,"j",(function(){return M})),e.d(n,"m",(function(){return N})),e.d(n,"k",(function(){return P})),e.d(n,"e",(function(){return L})),e.d(n,"f",(function(){return F})),e.d(n,"a",(function(){return W})),e.d(n,"h",(function(){return K})),e.d(n,"n",(function(){return J})),e.d(n,"o",(function(){return G})),e.d(n,"g",(function(){return $})),e.d(n,"i",(function(){return Y})),e.d(n,"p",(function(){return Z})),e.d(n,"q",(function(){return Q})),e.d(n,"d",(function(){return nt}));var r=e(11),i=e.n(r),a=e(20),o=e.n(a),u=e(285),c=e.n(u),s=e(286),f=e.n(s),p=e(507),l=e(40),d=e(490),m=e(219),h=e(202),g=e(49),b=e(37),v=function(){var t=c()(f.a.mark((function t(n){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=g.pipe,t.next=3,n();case 3:return t.t1=t.sent,t.t2=Object(b.fold)((function(t){return Promise.reject(t)}),(function(t){return Promise.resolve(t)})),t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),O=function(t){return t instanceof Error?t:new Error(String(t))},y=function(){var t=c()(f.a.mark((function t(n){var e,r,i;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.http,r=n.list,i=n.signal,t.abrupt("return",e.fetch(h.r,{body:JSON.stringify(r),method:"POST",signal:i}));case 2:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),j=function(){var t=c()(f.a.mark((function t(n){var e,r,i;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.http,r=n.list,i=n.signal,t.abrupt("return",Object(l.flow)((function(){return Object(p.tryCatch)((function(){return y({http:e,list:r,signal:i})}),O)}),Object(p.chain)((function(t){return Object(p.fromEither)(Object(d.c)(m.p,t))})),Object(l.flow)(v))());case 2:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),w=function(){var t=c()(f.a.mark((function t(n){var e,r,i;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.http,r=n.listItem,i=n.signal,t.abrupt("return",e.fetch(h.o,{body:JSON.stringify(r),method:"POST",signal:i}));case 2:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),E=function(){var t=c()(f.a.mark((function t(n){var e,r,i;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.http,r=n.listItem,i=n.signal,t.abrupt("return",Object(l.flow)((function(){return Object(p.tryCatch)((function(){return w({http:e,listItem:r,signal:i})}),O)}),Object(p.chain)((function(t){return Object(p.fromEither)(Object(d.c)(m.o,t))})),Object(l.flow)(v))());case 2:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),I=function(){var t=c()(f.a.mark((function t(n){var e,r,i;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.http,r=n.list,i=n.signal,t.abrupt("return",e.fetch(h.r,{body:JSON.stringify(r),method:"PUT",signal:i}));case 2:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),x=function(){var t=c()(f.a.mark((function t(n){var e,r,i;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.http,r=n.list,i=n.signal,t.abrupt("return",Object(l.flow)((function(){return Object(p.tryCatch)((function(){return I({http:e,list:r,signal:i})}),O)}),Object(p.chain)((function(t){return Object(p.fromEither)(Object(d.c)(m.p,t))})),Object(l.flow)(v))());case 2:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),k=function(){var t=c()(f.a.mark((function t(n){var e,r,i;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.http,r=n.listItem,i=n.signal,t.abrupt("return",e.fetch(h.o,{body:JSON.stringify(r),method:"PUT",signal:i}));case 2:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),T=function(){var t=c()(f.a.mark((function t(n){var e,r,i;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.http,r=n.listItem,i=n.signal,t.abrupt("return",Object(l.flow)((function(){return Object(p.tryCatch)((function(){return k({http:e,listItem:r,signal:i})}),O)}),Object(p.chain)((function(t){return Object(p.fromEither)(Object(d.c)(m.o,t))})),Object(l.flow)(v))());case 2:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),S=function(){var t=c()(f.a.mark((function t(n){var e,r,i,a,o,u;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.http,r=n.filters,i=n.namespaceTypes,a=n.pagination,o=n.signal,u={filter:r||void 0,namespace_type:i,page:a.page?"".concat(a.page):"1",per_page:a.perPage?"".concat(a.perPage):"20",sort_field:"exception-list.created_at",sort_order:"desc"},t.abrupt("return",e.fetch("".concat(h.r,"/_find"),{method:"GET",query:u,signal:o}));case 3:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),_=function(){var t=c()(f.a.mark((function t(n){var e,r,i,a,o;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.filters,r=n.http,i=n.namespaceTypes,a=n.pagination,o=n.signal,t.abrupt("return",Object(l.flow)((function(){return Object(p.tryCatch)((function(){return S({filters:e,http:r,namespaceTypes:i,pagination:a,signal:o})}),O)}),Object(p.chain)((function(t){return Object(p.fromEither)(Object(d.c)(m.t,t))})),Object(l.flow)(v))());case 2:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),R=function(){var t=c()(f.a.mark((function t(n){var e,r,i,a;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.http,r=n.id,i=n.namespaceType,a=n.signal,t.abrupt("return",e.fetch(h.r,{method:"GET",query:{id:r,namespace_type:i},signal:a}));case 2:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),M=function(){var t=c()(f.a.mark((function t(n){var e,r,i,a;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.http,r=n.id,i=n.namespaceType,a=n.signal,t.abrupt("return",Object(l.flow)((function(){return Object(p.tryCatch)((function(){return R({http:e,id:r,namespaceType:i,signal:a})}),O)}),Object(p.chain)((function(t){return Object(p.fromEither)(Object(d.c)(m.p,t))})),Object(l.flow)(v))());case 2:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),C=function(){var t=c()(f.a.mark((function t(n){var e,r,a,u,c,s,p,l;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.http,r=n.listIds,a=n.namespaceTypes,u=n.filterOptions,c=n.pagination,s=n.signal,p=u.map((function(t,n){var e="agnostic"===a[n]?h.q:h.p;return[].concat(o()(t.filter.length?["".concat(e,".attributes.entries.field:").concat(t.filter,"*")]:[]),o()(t.tags.length?t.tags.map((function(t){return"".concat(e,".attributes.tags:").concat(t)})):[])).join(" AND ")})).join(","),l=i()({list_id:r.join(","),namespace_type:a.join(","),page:c.page?"".concat(c.page):"1",per_page:c.perPage?"".concat(c.perPage):"20",sort_field:"exception-list.created_at",sort_order:"desc"},""!==p.trim()?{filter:p}:{}),t.abrupt("return",e.fetch("".concat(h.o,"/_find"),{method:"GET",query:l,signal:s}));case 4:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),N=function(){var t=c()(f.a.mark((function t(n){var e,r,i,a,o,u;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.filterOptions,r=n.http,i=n.listIds,a=n.namespaceTypes,o=n.pagination,u=n.signal,t.abrupt("return",Object(l.flow)((function(){return Object(p.tryCatch)((function(){return C({filterOptions:e,http:r,listIds:i,namespaceTypes:a,pagination:o,signal:u})}),O)}),Object(p.chain)((function(t){return Object(p.fromEither)(Object(d.c)(m.s,t))})),Object(l.flow)(v))());case 2:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),U=function(){var t=c()(f.a.mark((function t(n){var e,r,i,a;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.http,r=n.id,i=n.namespaceType,a=n.signal,t.abrupt("return",e.fetch(h.o,{method:"GET",query:{id:r,namespace_type:i},signal:a}));case 2:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),P=function(){var t=c()(f.a.mark((function t(n){var e,r,i,a;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.http,r=n.id,i=n.namespaceType,a=n.signal,t.abrupt("return",Object(l.flow)((function(){return Object(p.tryCatch)((function(){return U({http:e,id:r,namespaceType:i,signal:a})}),O)}),Object(p.chain)((function(t){return Object(p.fromEither)(Object(d.c)(m.o,t))})),Object(l.flow)(v))());case 2:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),A=function(){var t=c()(f.a.mark((function t(n){var e,r,i,a;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.http,r=n.id,i=n.namespaceType,a=n.signal,t.abrupt("return",e.fetch(h.r,{method:"DELETE",query:{id:r,namespace_type:i},signal:a}));case 2:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),L=function(){var t=c()(f.a.mark((function t(n){var e,r,i,a;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.http,r=n.id,i=n.namespaceType,a=n.signal,t.abrupt("return",Object(l.flow)((function(){return Object(p.tryCatch)((function(){return A({http:e,id:r,namespaceType:i,signal:a})}),O)}),Object(p.chain)((function(t){return Object(p.fromEither)(Object(d.c)(m.p,t))})),Object(l.flow)(v))());case 2:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),q=function(){var t=c()(f.a.mark((function t(n){var e,r,i,a;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.http,r=n.id,i=n.namespaceType,a=n.signal,t.abrupt("return",e.fetch(h.o,{method:"DELETE",query:{id:r,namespace_type:i},signal:a}));case 2:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),F=function(){var t=c()(f.a.mark((function t(n){var e,r,i,a;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.http,r=n.id,i=n.namespaceType,a=n.signal,t.abrupt("return",Object(l.flow)((function(){return Object(p.tryCatch)((function(){return q({http:e,id:r,namespaceType:i,signal:a})}),O)}),Object(p.chain)((function(t){return Object(p.fromEither)(Object(d.c)(m.o,t))})),Object(l.flow)(v))());case 2:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),D=function(){var t=c()(f.a.mark((function t(n){var e,r;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.http,r=n.signal,t.abrupt("return",e.fetch(h.k,{method:"POST",signal:r}));case 2:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),W=function(){var t=c()(f.a.mark((function t(n){var e,r;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.http,r=n.signal,t.abrupt("return",Object(l.flow)((function(){return Object(p.tryCatch)((function(){return D({http:e,signal:r})}),O)}),Object(p.chain)((function(t){return Object(p.fromEither)(Object(d.c)(m.f,t))})),Object(l.flow)(v))());case 2:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),K=function(){var t=c()(f.a.mark((function t(n){var e,r,i,a,o;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.http,r=n.id,i=n.listId,a=n.namespaceType,o=n.signal,t.abrupt("return",e.fetch("".concat(h.r,"/_export"),{method:"POST",query:{id:r,list_id:i,namespace_type:a},signal:o}));case 2:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),z=function(){var t=c()(f.a.mark((function t(n){var e,r,i,a,o;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.http,r=n.cursor,i=n.page,a=n.per_page,o=n.signal,t.abrupt("return",e.fetch("".concat(h.v,"/_find"),{method:"GET",query:{cursor:r,page:i,per_page:a},signal:o}));case 2:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),J=function(){var t=c()(f.a.mark((function t(n){var e,r,a,o,u;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.cursor,r=n.http,a=n.pageIndex,o=n.pageSize,u=n.signal,t.abrupt("return",Object(g.pipe)({cursor:null!=e?e.toString():void 0,page:null!=a?a.toString():void 0,per_page:null!=o?o.toString():void 0},(function(t){return Object(p.fromEither)(Object(d.c)(m.r,t))}),Object(p.chain)((function(t){return Object(p.tryCatch)((function(){return z(i()({http:r,signal:u},t))}),O)})),Object(p.chain)((function(t){return Object(p.fromEither)(Object(d.c)(m.u,t))})),Object(l.flow)(v)));case 2:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),H=function(){var t=c()(f.a.mark((function t(n){var e,r,i,a,o,u;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.file,r=n.http,i=n.list_id,a=n.type,o=n.signal,(u=new FormData).append("file",e),t.abrupt("return",r.fetch("".concat(h.t,"/_import"),{body:u,headers:{"Content-Type":void 0},method:"POST",query:{list_id:i,type:a},signal:o}));case 4:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),G=function(){var t=c()(f.a.mark((function t(n){var e,r,a,o,u;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.file,r=n.http,a=n.listId,o=n.type,u=n.signal,t.abrupt("return",Object(g.pipe)({list_id:a,type:o},(function(t){return Object(p.fromEither)(Object(d.c)(m.v,t))}),Object(p.chain)((function(t){return Object(g.pipe)(Object(p.fromEither)(Object(d.c)(m.w,{file:e})),Object(p.map)((function(n){return i()(i()({},n),t)})))})),Object(p.chain)((function(t){return Object(p.tryCatch)((function(){return H(i()({http:r,signal:u},t))}),O)})),Object(p.chain)((function(t){return Object(p.fromEither)(Object(d.c)(m.z,t))})),v));case 2:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),X=function(){var t=c()(f.a.mark((function t(n){var e,r,i,a,o,u,c;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.deleteReferences,r=void 0!==e&&e,i=n.http,a=n.id,o=n.ignoreReferences,u=void 0!==o&&o,c=n.signal,t.abrupt("return",i.fetch(h.v,{method:"DELETE",query:{deleteReferences:r,id:a,ignoreReferences:u},signal:c}));case 2:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),$=function(){var t=c()(f.a.mark((function t(n){var e,r,a,o,u;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.deleteReferences,r=n.http,a=n.id,o=n.ignoreReferences,u=n.signal,t.abrupt("return",Object(g.pipe)({deleteReferences:e,id:a,ignoreReferences:o},(function(t){return Object(p.fromEither)(Object(d.c)(m.h,t))}),Object(p.chain)((function(t){return Object(p.tryCatch)((function(){return X(i()({http:r,signal:u},t))}),O)})),Object(p.chain)((function(t){return Object(p.fromEither)(Object(d.c)(m.z,t))})),Object(l.flow)(v)));case 2:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),V=function(){var t=c()(f.a.mark((function t(n){var e,r,i;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.http,r=n.list_id,i=n.signal,t.abrupt("return",e.fetch("".concat(h.t,"/_export"),{method:"POST",query:{list_id:r},signal:i}));case 2:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),Y=function(){var t=c()(f.a.mark((function t(n){var e,r,a;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.http,r=n.listId,a=n.signal,t.abrupt("return",Object(g.pipe)({list_id:r},(function(t){return Object(p.fromEither)(Object(d.c)(m.q,t))}),Object(p.chain)((function(t){return Object(p.tryCatch)((function(){return V(i()({http:e,signal:a},t))}),O)})),Object(l.flow)(v)));case 2:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),B=function(){var t=c()(f.a.mark((function t(n){var e,r;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.http,r=n.signal,t.abrupt("return",e.fetch(h.s,{method:"GET",signal:r}));case 2:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),Z=function(){var t=c()(f.a.mark((function t(n){var e,r;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.http,r=n.signal,t.abrupt("return",Object(l.flow)((function(){return Object(p.tryCatch)((function(){return B({http:e,signal:r})}),O)}),Object(p.chain)((function(t){return Object(p.fromEither)(Object(d.c)(m.y,t))})),Object(l.flow)(v))());case 2:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),Q=function(){var t=c()(f.a.mark((function t(n){var e,r;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.http,r=n.signal,t.abrupt("return",e.fetch(h.u,{method:"GET",signal:r}));case 2:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),tt=function(){var t=c()(f.a.mark((function t(n){var e,r;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.http,r=n.signal,t.abrupt("return",e.fetch(h.s,{method:"POST",signal:r}));case 2:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),nt=function(){var t=c()(f.a.mark((function t(n){var e,r;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.http,r=n.signal,t.abrupt("return",Object(l.flow)((function(){return Object(p.tryCatch)((function(){return tt({http:e,signal:r})}),O)}),Object(p.chain)((function(t){return Object(p.fromEither)(Object(d.c)(m.d,t))})),Object(l.flow)(v))());case 2:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}()},256:function(t,n,e){"use strict";e.d(n,"k",(function(){return r})),e.d(n,"l",(function(){return i})),e.d(n,"i",(function(){return a})),e.d(n,"f",(function(){return o})),e.d(n,"e",(function(){return u})),e.d(n,"h",(function(){return c})),e.d(n,"c",(function(){return s})),e.d(n,"g",(function(){return f})),e.d(n,"j",(function(){return p})),e.d(n,"d",(function(){return l})),e.d(n,"b",(function(){return d})),e.d(n,"a",(function(){return m}));const r="metrics-endpoint.metadata_current_*",i="endpoint.metadata_current-default",a=".metrics-endpoint.metadata_united_default",o="/api/endpoint/metadata",u="/api/endpoint/metadata/{id}",c="/api/endpoint/metadata/transforms",s="/api/endpoint/policy_response",f="/api/endpoint/isolate",p="/api/endpoint/unisolate",l="/api/endpoint/action_log/{agent_id}",d="/api/endpoint/action_status",m="/api/endpoint/action/{action_id}"},282:function(t,n,e){"use strict";e.d(n,"p",(function(){return a})),e.d(n,"n",(function(){return o})),e.d(n,"o",(function(){return u})),e.d(n,"f",(function(){return s})),e.d(n,"e",(function(){return f})),e.d(n,"b",(function(){return m})),e.d(n,"a",(function(){return h})),e.d(n,"d",(function(){return T})),e.d(n,"i",(function(){return U})),e.d(n,"j",(function(){return P})),e.d(n,"m",(function(){return x})),e.d(n,"c",(function(){return F})),e.d(n,"k",(function(){return D})),e.d(n,"l",(function(){return W})),e.d(n,"h",(function(){return K})),e.d(n,"g",(function(){return z}));var r=e(4),i=e(219),a={message:r.i18n.translate("lists.exceptions.isOperatorLabel",{defaultMessage:"is"}),operator:i.b.INCLUDED,type:i.c.MATCH,value:"is"},o={message:r.i18n.translate("lists.exceptions.isNotOperatorLabel",{defaultMessage:"is not"}),operator:i.b.EXCLUDED,type:i.c.MATCH,value:"is_not"},u={message:r.i18n.translate("lists.exceptions.isOneOfOperatorLabel",{defaultMessage:"is one of"}),operator:i.b.INCLUDED,type:i.c.MATCH_ANY,value:"is_one_of"},c={message:r.i18n.translate("lists.exceptions.isNotOneOfOperatorLabel",{defaultMessage:"is not one of"}),operator:i.b.EXCLUDED,type:i.c.MATCH_ANY,value:"is_not_one_of"},s={message:r.i18n.translate("lists.exceptions.existsOperatorLabel",{defaultMessage:"exists"}),operator:i.b.INCLUDED,type:i.c.EXISTS,value:"exists"},f={message:r.i18n.translate("lists.exceptions.doesNotExistOperatorLabel",{defaultMessage:"does not exist"}),operator:i.b.EXCLUDED,type:i.c.EXISTS,value:"does_not_exist"},p={message:r.i18n.translate("lists.exceptions.isInListOperatorLabel",{defaultMessage:"is in list"}),operator:i.b.INCLUDED,type:i.c.LIST,value:"is_in_list"},l={message:r.i18n.translate("lists.exceptions.isNotInListOperatorLabel",{defaultMessage:"is not in list"}),operator:i.b.EXCLUDED,type:i.c.LIST,value:"is_not_in_list"},d={message:r.i18n.translate("lists.exceptions.matchesOperatorLabel",{defaultMessage:"matches"}),operator:i.b.INCLUDED,type:i.c.WILDCARD,value:"matches"},m=[a,o,u,c,d],h=[a,o,u,c,s,f,p,l,d],g=e(11),b=e.n(g),v=e(38),O=e.n(v),y=e(10),j=e.n(y),w=e(20),E=e.n(w),I=e(3),x=function(t){return t.filter((function(t){return"list"===t.type})).length>0},k=function(t){return t.flatMap((function(t){return function(t){var n=t.entries,e=t.os_types;return null!=e&&e.length>0?function(t,n){var e=function(t,n){var e=t.map((function(t){return[{field:"host.os.type",operator:"included",type:"match",value:t}].concat(E()(n))})),r=t.map((function(t){return[{field:"host.os.name.caseless",operator:"included",type:"match",value:t}].concat(E()(n))}));return[].concat(E()(e),E()(r))}(t,n);return e.map((function(t){return{bool:{filter:t.map((function(t){return R(t)}))}}}))}(e,n):1===n.length?[R(n[0])]:[{bool:{filter:n.map((function(t){return R(t)}))}}]}(t)}))},T=function(t){var n=t.lists,e=t.excludeExceptions,r=t.chunkSize,i=t.alias,a=void 0===i?null:i,o=n.filter((function(t){return!x(t.entries)})),u={meta:{alias:a,disabled:!1,negate:e},query:{bool:{should:void 0}}};if(0!==o.length){if(o.length<=r){var c=k(o);return u.query.bool.should=c,u}var s=function(t,n){return Object(I.chunk)(n,t)}(o,r);return{meta:{alias:a,disabled:!1,negate:e},query:{bool:{should:s.map((function(t){return{meta:{alias:null,disabled:!1,negate:!1},query:{bool:{should:k(t)}}}})).map((function(t){return t.query}))}}}}},S=function(t){return{bool:{must_not:t}}},_=function(t,n){if(1===t.length){var e=O()(t,1)[0],r=R(e,n);return i=r,null!=Object.keys(i).includes("bool")?r:{bool:{}}}var i;return{bool:{filter:t.map((function(t){return R(t,n)}))}}},R=function(t,n){if(i.i.is(t)){var e=null!=n?"".concat(n,".").concat(t.field):t.field;return function(t){var n={bool:{minimum_should_match:1,should:[{exists:{field:t.field}}]}};return"excluded"===t.operator?S(n):n}(b()(b()({},t),{},{field:e}))}if(i.k.is(t)){var r=null!=n?"".concat(n,".").concat(t.field):t.field;return function(t){var n=t.field,e=t.operator,r=t.value,i={bool:{minimum_should_match:1,should:[{match_phrase:j()({},n,r)}]}};return"excluded"===e?S(i):i}(b()(b()({},t),{},{field:r}))}if(i.l.is(t)){var a=null!=n?"".concat(n,".").concat(t.field):t.field;return function(t){var n=t.operator,e=function(t){var n=t.field,e=t.value;return 1===e.length?{bool:{minimum_should_match:1,should:[{match_phrase:j()({},n,e[0])}]}}:{bool:{minimum_should_match:1,should:e.map((function(t){return{bool:{minimum_should_match:1,should:[{match_phrase:j()({},n,t)}]}}}))}}}(t);return"excluded"===n?S(e):e}(b()(b()({},t),{},{field:a}))}if(i.m.is(t))return function(t){var n=t.field,e=t.entries;return{nested:{path:n,query:_(e,n),score_mode:"none"}}}(t);throw new TypeError("Unexpected exception entry: ".concat(t))},M=e(202),C=M.p,N=M.q,U=function(t){var n=t.filters,e=t.namespaceTypes,r=t.hideLists,i=function(t){return t.namespaceType.map((function(t){return function(t){return"agnostic"===t.namespaceType?N:C}({namespaceType:t})}))}({namespaceType:e}),a=function(t,n){return Object.keys(t).map((function(e){var r=Object(I.get)(e,t);if(null!=r&&""!==r.trim()){var i=n.map((function(t){var n="name"===e?"name.text":e;return"".concat(t,".attributes.").concat(n,":").concat(r)})).join(" OR ");return"(".concat(i,")")}return null})).filter((function(t){return null!=t})).join(" AND ")}(n,i),o=r.map((function(t){var n=i.map((function(n){return"not ".concat(n,".attributes.list_id: ").concat(t,"*")}));return"(".concat(n.join(" AND "),")")}));return[a].concat(E()(o)).filter((function(t){return""!==t.trim()})).join(" AND ")},P=function(t){var n=t.lists,e=t.showDetection,r=t.showEndpoint;return n.filter((function(t){return e?"detection"===t.type:!r||"endpoint"===t.type})).reduce((function(t,n){var e=n.listId,r=n.namespaceType;return{ids:[].concat(E()(t.ids),[e]),namespaces:[].concat(E()(t.namespaces),[r])}}),{ids:[],namespaces:[]})},A=(e(210),e(43)),L=e.n(A),q=e(212),F=(e(490),e(39),function(t){return t.map((function(t){return"nested"===t.type?Object(q.d)(b()(b()({},t),{},{entries:t.entries.map((function(t){return Object(q.d)(t)}))})):Object(q.d)(t)}))}),D=function(t){var n=t.listId,e=t.namespaceType,r=t.ruleName;return{comments:[],description:"".concat(r," - exception list item"),entries:F([{field:"",operator:"included",type:"match",value:""}]),item_id:void 0,list_id:n,meta:{temporaryUuid:L.a.v4()},name:"".concat(r," - exception list item"),namespace_type:e,tags:[],type:"simple"}},W=function(t){switch(t.type){case"match":return i.c.MATCH;case"match_any":return i.c.MATCH_ANY;case"wildcard":return i.c.WILDCARD;case"list":return i.c.LIST;default:return i.c.EXISTS}},K=function(t){if("nested"===t.type)return a;var n=W(t),e=h.find((function(e){return t.operator===e.operator&&n===e.type}));return null!=e?e:a},z=function(t){switch(t.type){case i.c.MATCH:case i.c.MATCH_ANY:case i.c.WILDCARD:return t.value;case i.c.EXISTS:return;case i.c.LIST:return t.list.id;default:return}}},285:function(t,n,e){t.exports=e(24)(919)},286:function(t,n,e){t.exports=e(24)(518)},287:function(t,n,e){"use strict";e.d(n,"d",(function(){return s})),e.d(n,"i",(function(){return f})),e.d(n,"g",(function(){return p})),e.d(n,"h",(function(){return l})),e.d(n,"c",(function(){return d})),e.d(n,"a",(function(){return m})),e.d(n,"b",(function(){return h})),e.d(n,"e",(function(){return g})),e.d(n,"f",(function(){return b}));var r=e(48),i=e(1),a=e(256),o=e(18),u=e(362),c=e(329);const s=async({query:t,signal:n})=>o.b.get().http.fetch(i.kb,{method:"POST",body:JSON.stringify(t),signal:n}),f=async({query:t,status:n,signal:e})=>o.b.get().http.fetch(i.ob,{method:"POST",body:JSON.stringify({conflicts:"proceed",status:n,...t}),signal:e}),p=async({signal:t})=>o.b.get().http.fetch(i.fb,{method:"GET",signal:t}),l=async({signal:t})=>o.b.get().http.fetch(i.jb,{method:"GET",signal:t}),d=async({signal:t})=>o.b.get().http.fetch(i.fb,{method:"POST",signal:t}),m=async({endpointId:t,comment:n="",caseIds:e})=>Object(u.a)({endpoint_ids:[t],comment:n,case_ids:e}),h=async({endpointId:t,comment:n="",caseIds:e})=>Object(u.b)({endpoint_ids:[t],comment:n,case_ids:e}),g=async({alertId:t,owner:n})=>o.b.get().http.fetch(Object(r.getCasesFromAlertsUrl)(t),{method:"get",query:{...n.length>0?{owner:n}:{}}}),b=async({agentId:t,signal:n})=>o.b.get().http.fetch(Object(c.a)(a.e,{id:t}),{method:"GET",signal:n})},305:function(t,n,e){"use strict";e.d(n,"a",(function(){return b})),e.d(n,"b",(function(){return y})),e.d(n,"c",(function(){return k})),e.d(n,"d",(function(){return S})),e.d(n,"e",(function(){return _})),e.d(n,"f",(function(){return M})),e.d(n,"g",(function(){return N})),e.d(n,"h",(function(){return P})),e.d(n,"i",(function(){return L})),e.d(n,"j",(function(){return F}));var r=e(11),i=e.n(r),a=e(40),o=e(212),u=function(t){return Object(a.flow)(c)(t)},c=function(t){var n=t.entries.map((function(t){return"nested"===t.type?Object(o.d)(i()(i()({},t),{},{entries:t.entries.map((function(t){return Object(o.d)(t)}))})):Object(o.d)(t)}));return i()(i()({},t),{},{entries:n})},s=function(t){var n=t.entries.map((function(t){return"nested"===t.type?Object(o.g)(i()(i()({},t),{},{entries:t.entries.map((function(t){return Object(o.g)(t)}))})):Object(o.g)(t)}));return i()(i()({},t),{},{entries:n})},f=e(285),p=e.n(f),l=e(286),d=e.n(l),m=e(5),h=e(254),g=e(282),b=function(t){return Object(m.useMemo)((function(){return{addExceptionListItem:function(n){return p()(d.a.mark((function e(){var r,i,o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.listItem,i=new AbortController,u=r,o=Object(a.flow)(s)(u),e.abrupt("return",h.c({http:t,listItem:o,signal:i.signal}));case 4:case"end":return e.stop()}var u}),e)})))()},deleteExceptionItem:function(n){return p()(d.a.mark((function e(){var r,i,a,o,u;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.id,i=n.namespaceType,a=n.onSuccess,o=n.onError,u=new AbortController,e.prev=2,e.next=5,h.f({http:t,id:r,namespaceType:i,signal:u.signal});case 5:a(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),o(e.t0);case 11:case"end":return e.stop()}}),e,null,[[2,8]])})))()},deleteExceptionList:function(n){return p()(d.a.mark((function e(){var r,i,a,o,u;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.id,i=n.namespaceType,a=n.onSuccess,o=n.onError,u=new AbortController,e.prev=2,e.next=5,h.e({http:t,id:r,namespaceType:i,signal:u.signal});case 5:a(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),o(e.t0);case 11:case"end":return e.stop()}}),e,null,[[2,8]])})))()},exportExceptionList:function(n){return p()(d.a.mark((function e(){var r,i,a,o,u,c,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.id,i=n.listId,a=n.namespaceType,o=n.onError,u=n.onSuccess,c=new AbortController,e.prev=2,e.next=5,h.h({http:t,id:r,listId:i,namespaceType:a,signal:c.signal});case 5:s=e.sent,u(s),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),o(e.t0);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})))()},getExceptionItem:function(n){return p()(d.a.mark((function e(){var r,i,a,o,c,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.id,i=n.namespaceType,a=n.onSuccess,o=n.onError,c=new AbortController,e.prev=2,e.t0=u,e.next=6,h.k({http:t,id:r,namespaceType:i,signal:c.signal});case 6:e.t1=e.sent,s=(0,e.t0)(e.t1),a(s),e.next=14;break;case 11:e.prev=11,e.t2=e.catch(2),o(e.t2);case 14:case"end":return e.stop()}}),e,null,[[2,11]])})))()},getExceptionList:function(n){return p()(d.a.mark((function e(){var r,i,a,o,u,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.id,i=n.namespaceType,a=n.onSuccess,o=n.onError,u=new AbortController,e.prev=2,e.next=5,h.j({http:t,id:r,namespaceType:i,signal:u.signal});case 5:c=e.sent,a(c),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),o(e.t0);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})))()},getExceptionListsItems:function(n){return p()(d.a.mark((function e(){var r,i,a,o,c,s,f,p,l,m,b,v,O,y,j,w;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.lists,i=n.filterOptions,a=n.pagination,o=n.showDetectionsListsOnly,c=n.showEndpointListsOnly,s=n.onSuccess,f=n.onError,p=new AbortController,l=Object(g.j)({lists:r,showDetection:o,showEndpoint:c}),m=l.ids,b=l.namespaces,e.prev=3,!(m.length>0&&b.length>0)){e.next=15;break}return e.next=7,h.m({filterOptions:i,http:t,listIds:m,namespaceTypes:b,pagination:a,signal:p.signal});case 7:v=e.sent,O=v.data,y=v.page,j=v.per_page,w=v.total,s({exceptions:O.map((function(t){return u(t)})),pagination:{page:y,perPage:j,total:w}}),e.next=16;break;case 15:s({exceptions:[],pagination:{page:0,perPage:null!=a.perPage?a.perPage:0,total:0}});case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(3),f(e.t0);case 21:case"end":return e.stop()}}),e,null,[[3,18]])})))()},updateExceptionListItem:function(n){return p()(d.a.mark((function e(){var r,i,o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.listItem,i=new AbortController,u=r,o=Object(a.flow)(s)(u),e.abrupt("return",h.s({http:t,listItem:o,signal:i.signal}));case 4:case"end":return e.stop()}var u}),e)})))()}}}),[t])},v=e(234),O=Object(v.d)(h.d),y=function(){return Object(v.a)(O)},j=e(10),w=e.n(j),E=e(38),I=e.n(E),x=function(t){return JSON.stringify(t)},k=function(t){for(var n,e=t.pageIndex,r=t.pageSize,a=Object(m.useState)({}),o=I()(a,2),u=o[0],c=o[1],s=Object(m.useCallback)((function(t){c(i()(i()({},u),{},w()({},x({pageIndex:e+1,pageSize:r}),t)))}),[e,r]),f=e;f>=0&&!(n=u[x({pageIndex:f,pageSize:r})]);f--);return[n,s]},T=Object(v.d)(h.g),S=function(){return Object(v.a)(T)},_=function(t){var n=t.http,e=t.lists,r=t.pagination,i=void 0===r?{page:1,perPage:20,total:0}:r,a=t.filterOptions,o=t.showDetectionsListsOnly,c=t.showEndpointListsOnly,s=t.matchFilters,f=t.onError,l=t.onSuccess,b=Object(m.useState)([]),v=I()(b,2),O=v[0],y=v[1],j=Object(m.useState)(i),w=I()(j,2),E=w[0],x=w[1],k=Object(m.useRef)(null),T=Object(m.useState)(!0),S=I()(T,2),_=S[0],R=S[1],M=Object(g.j)({lists:e,showDetection:o,showEndpoint:c}),C=M.ids,N=M.namespaces,U=s&&a.length>0?C.map((function(){return a[0]})):a,P=C.join(","),A=N.join(","),L=a.map((function(t){return t.filter})).join(","),q=a.map((function(t){return t.tags.join(",")})).join(",");return Object(m.useEffect)((function(){var t=!0,e=new AbortController,r=function(){var r=p()(d.a.mark((function r(){var a,o,c,s,p,m;return d.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,R(!0),0!==C.length||!t){r.next=9;break}x({page:0,perPage:i.perPage,total:0}),y([]),null!=l&&l({exceptions:[],pagination:{page:0,perPage:i.perPage,total:0}}),R(!1),r.next=18;break;case 9:return r.next=11,Object(h.m)({filterOptions:U,http:n,listIds:C,namespaceTypes:N,pagination:{page:i.page,perPage:i.perPage},signal:e.signal});case 11:a=r.sent,o=a.page,c=a.per_page,s=a.total,p=a.data,m=p.map((function(t){return u(t)})),t&&(x({page:o,perPage:c,total:s}),y(m),null!=l&&l({exceptions:m,pagination:{page:o,perPage:c,total:s}}));case 18:r.next=23;break;case 20:r.prev=20,r.t0=r.catch(0),t&&(y([]),x({page:1,perPage:20,total:0}),null!=f&&f(r.t0));case 23:t&&R(!1);case 24:case"end":return r.stop()}}),r,null,[[0,20]])})));return function(){return r.apply(this,arguments)}}();return r(),k.current=r,function(){t=!1,e.abort()}}),[n,P,A,y,i.page,i.perPage,L,q]),[_,O,E,k.current]},R={page:1,perPage:20,total:0},M=function(t){var n=t.errorMessage,e=t.http,r=t.initialPagination,i=void 0===r?R:r,a=t.filterOptions,o=void 0===a?{}:a,u=t.namespaceTypes,c=t.notifications,s=t.hideLists,f=void 0===s?[]:s,l=Object(m.useState)([]),b=I()(l,2),v=b[0],O=b[1],y=Object(m.useState)(i),j=I()(y,2),w=j[0],E=j[1],x=Object(m.useState)(!0),k=I()(x,2),T=k[0],S=k[1],_=Object(m.useRef)(),M=Object(m.useMemo)((function(){return u.join(",")}),[u]),C=Object(m.useMemo)((function(){return Object(g.i)({filters:o,namespaceTypes:u,hideLists:f})}),[u,o,f]),N=Object(m.useCallback)(p()(d.a.mark((function t(){var r,i,a,o,u;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,S(!0),_.current=new AbortController,t.next=5,Object(h.l)({filters:C,http:e,namespaceTypes:M,pagination:{page:w.page,perPage:w.perPage},signal:_.current.signal});case 5:r=t.sent,i=r.page,a=r.per_page,o=r.total,u=r.data,E({page:i,perPage:a,total:o}),O(u),S(!1),t.next=18;break;case 15:t.prev=15,t.t0=t.catch(0),"AbortError"!==t.t0.name&&(c.toasts.addError(t.t0,{title:n}),O([]),E(R),S(!1));case 18:case"end":return t.stop()}}),t,null,[[0,15]])}))),[n,C,e,M,c.toasts,w.page,w.perPage]);return Object(m.useEffect)((function(){return N(),function(){var t;null===(t=_.current)||void 0===t||t.abort()}}),[N]),[T,v,w,E,N]},C=(Object(v.d)(h.i),Object(v.d)(h.n)),N=function(){return Object(v.a)(C)},U=Object(v.d)(h.o),P=function(){return Object(v.a)(U)},A=Object(v.d)(h.p),L=function(){return Object(v.a)(A)},q=Object(v.d)(h.q),F=function(){return Object(v.a)(q)}},315:function(t,n,e){"use strict";e.d(n,"a",(function(){return a})),e.d(n,"d",(function(){return o})),e.d(n,"e",(function(){return u})),e.d(n,"b",(function(){return c})),e.d(n,"c",(function(){return s})),e.d(n,"f",(function(){return f}));var r=e(4),i=e(212);const a=r.i18n.translate("xpack.securitySolution.endpointsTab",{defaultMessage:"Endpoints"}),o=r.i18n.translate("xpack.securitySolution.policiesTab",{defaultMessage:"Policies"}),u=r.i18n.translate("xpack.securitySolution.trustedAppsTab",{defaultMessage:"Trusted applications"}),c=r.i18n.translate("xpack.securitySolution.eventFiltersTab",{defaultMessage:"Event filters"}),s=(r.i18n.translate("xpack.securitySolution.administration.list.beta",{defaultMessage:"Beta"}),{[i.c.WINDOWS]:r.i18n.translate("xpack.securitySolution.administration.os.windows",{defaultMessage:"Windows"}),[i.c.MAC]:r.i18n.translate("xpack.securitySolution.administration.os.macos",{defaultMessage:"Mac"}),[i.c.LINUX]:r.i18n.translate("xpack.securitySolution.administration.os.linux",{defaultMessage:"Linux"})}),f=t=>r.i18n.translate("xpack.securitySolution.exceptions.failedLoadPolicies",{defaultMessage:'There was an error loading policies: "{error}"',values:{error:t.message}})},329:function(t,n,e){"use strict";e.d(n,"a",(function(){return r}));const r=(t,n)=>Object.keys(n).reduce(((t,e)=>t.replace(new RegExp(`{${e}}`,"g"),String(n[e]))),t)},362:function(t,n,e){"use strict";e.d(n,"a",(function(){return a})),e.d(n,"b",(function(){return o}));var r=e(18),i=e(256);const a=async t=>r.b.get().http.post(i.g,{body:JSON.stringify(t)}),o=async t=>r.b.get().http.post(i.j,{body:JSON.stringify(t)})},490:function(t,n,e){"use strict";e.d(n,"a",(function(){return p})),e.d(n,"b",(function(){return v})),e.d(n,"c",(function(){return O}));var r=e(20),i=e.n(r),a=e(3),o=function(t){var n=t.map((function(t){if(null!=t.message)return t.message;var n=t.context.filter((function(t){return null!=t.key&&!Number.isInteger(+t.key)&&""!==t.key.trim()})).map((function(t){return t.key})).join(","),e=t.context.find((function(t){return null!=t.type&&null!=t.type.name&&t.type.name.length>0})),r=""!==n?n:null!=e?e.type.name:"",i=Object(a.isObject)(t.value)?JSON.stringify(t.value):t.value;return'Invalid value "'.concat(i,'" supplied to "').concat(r,'"')}));return i()(new Set(n))},u=e(51),c=e.n(u),s=e(95),f=e.n(s),p=function(t){var n=!isNaN(Date.parse(t)),e=n||t.trim().startsWith("now"),r=n?c()(t):e?f.a.parse(t):null;return null!=r?r:null},l=e(60),d=e.n(l),m=e(37),h=e(49),g=function t(n,e){if(null===e&&null===n)return[];if(null!=e){if("object"!==d()(n)||null==n)return[];var r=Object.keys(e);return Object.keys(n).flatMap((function(o){var u=r.some((function(t){return t===o}))?[]:[o],c=Object(a.get)(o,n),s=Object(a.get)(o,e);return Object(a.isObject)(c)?[].concat(u,i()(t(c,s))):Array.isArray(c)?[].concat(u,i()(c.flatMap((function(n,e){return t(n,Object(a.get)(e,s))})))):u}))}try{return[JSON.stringify(n)]}catch(t){return["circular reference"]}},b=(Object(m.fold)((function(t){return{schema:{},errors:t}}),(function(t){return{schema:t,errors:[]}})),e(507),e(0)),v=function(t,n){var e,r,i=(e=t,r=n.decode(t),Object(h.pipe)(r,Object(m.fold)((function(t){return Object(m.left)(t)}),(function(t){var n=g(e,t);if(0!==n.length){var r=[{value:n,context:[],message:'invalid keys "'.concat(n.join(","),'"')}];return Object(m.left)(r)}return Object(m.right)(t)}))));return Object(h.pipe)(i,Object(m.fold)((function(t){return[null,o(t).join(",")]}),(function(t){return[t,null]})))},O=function(t,n){return Object(h.pipe)(n,(function(n){return t.validate(n,b.getDefaultContext(t.asDecoder()))}),Object(m.mapLeft)((function(t){return new Error(o(t).join(","))})))}},507:function(t,n,e){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,n,e,r){void 0===r&&(r=e),Object.defineProperty(t,r,{enumerable:!0,get:function(){return n[e]}})}:function(t,n,e,r){void 0===r&&(r=e),t[r]=n[e]}),i=this&&this.__setModuleDefault||(Object.create?function(t,n){Object.defineProperty(t,"default",{enumerable:!0,value:n})}:function(t,n){t.default=n}),a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var n={};if(null!=t)for(var e in t)"default"!==e&&Object.prototype.hasOwnProperty.call(t,e)&&r(n,t,e);return i(n,t),n};Object.defineProperty(n,"__esModule",{value:!0}),n.apS=n.apSW=n.bind=n.bindW=n.bindTo=n.bracket=n.taskify=n.taskEitherSeq=n.taskEither=n.Alt=n.Bifunctor=n.ApplicativeSeq=n.ApplicativePar=n.Functor=n.getFilterable=n.getTaskValidation=n.getAltTaskValidation=n.getApplicativeTaskValidation=n.getApplyMonoid=n.getApplySemigroup=n.getSemigroup=n.URI=n.throwError=n.fromTask=n.fromIO=n.of=n.alt=n.flatten=n.chainFirst=n.chainFirstW=n.chain=n.chainW=n.apSecond=n.apFirst=n.ap=n.apW=n.mapLeft=n.bimap=n.map=n.chainIOEitherK=n.chainIOEitherKW=n.chainEitherK=n.chainEitherKW=n.fromIOEitherK=n.fromEitherK=n.tryCatchK=n.filterOrElse=n.swap=n.orElse=n.getOrElse=n.getOrElseW=n.fold=n.tryCatch=n.fromPredicate=n.fromOption=n.fromEither=n.fromIOEither=n.leftIO=n.rightIO=n.leftTask=n.rightTask=n.right=n.left=void 0;var o=a(e(37)),u=e(898),c=e(40),s=a(e(901));function f(t,n){return function(){return t().then(o.right,(function(t){return o.left(n(t))}))}}function p(t){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return n.fromEither(t.apply(void 0,e))}}function l(t){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return n.fromIOEither(t.apply(void 0,e))}}n.left=c.flow(o.left,s.of),n.right=c.flow(o.right,s.of),n.rightTask=s.map(o.right),n.leftTask=s.map(o.left),n.rightIO=c.flow(s.fromIO,n.rightTask),n.leftIO=c.flow(s.fromIO,n.leftTask),n.fromIOEither=s.fromIO,n.fromEither=o.fold(n.left,(function(t){return n.right(t)})),n.fromOption=function(t){return function(e){return"None"===e._tag?n.left(t()):n.right(e.value)}},n.fromPredicate=function(t,e){return function(r){return t(r)?n.right(r):n.left(e(r))}},n.tryCatch=f,n.fold=c.flow(o.fold,s.chain),n.getOrElseW=function(t){return function(n){return c.pipe(n,s.chain(o.fold(t,s.of)))}},n.getOrElse=n.getOrElseW,n.orElse=function(t){return s.chain(o.fold(t,n.right))},n.swap=s.map(o.swap),n.filterOrElse=function(t,e){return n.chain((function(r){return t(r)?n.right(r):n.left(e(r))}))},n.tryCatchK=function(t,n){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return f((function(){return t.apply(void 0,e)}),n)}},n.fromEitherK=p,n.fromIOEitherK=l,n.chainEitherKW=function(t){return n.chainW(p(t))},n.chainEitherK=n.chainEitherKW,n.chainIOEitherKW=function(t){return n.chainW(l(t))},n.chainIOEitherK=n.chainIOEitherKW;var d=function(t,e){return c.pipe(t,n.map(e))},m=function(t,e,r){return c.pipe(t,n.bimap(e,r))},h=function(t,e){return c.pipe(t,n.mapLeft(e))},g=function(t,e){return c.pipe(t,n.ap(e))},b=function(t,e){return c.pipe(t,n.chain((function(t){return c.pipe(e,n.map(t))})))},v=function(t,e){return c.pipe(t,n.chain(e))},O=function(t,e){return c.pipe(t,n.alt(e))};function y(t){return s.getSemigroup(o.getApplySemigroup(t))}function j(t,e){var r=o.getApplicativeValidation(e);return{URI:n.URI,_E:void 0,map:d,ap:function(n,e){return c.pipe(n,(i=e,function(n){return t.ap(t.map(n,(function(t){return function(n){return r.ap(t,n)}})),i)}));var i},of:n.of}}function w(t){return{URI:n.URI,_E:void 0,map:d,alt:function(n,e){return c.pipe(n,s.chain((function(n){return o.isRight(n)?s.of(n):c.pipe(e(),s.map((function(e){return o.isLeft(e)?o.left(t.concat(n.left,e.left)):e})))})))}}}n.map=function(t){return s.map(o.map(t))},n.bimap=c.flow(o.bimap,s.map),n.mapLeft=function(t){return s.map(o.mapLeft(t))},n.apW=function(t){return c.flow(s.map((function(t){return function(n){return o.apW(n)(t)}})),s.ap(t))},n.ap=n.apW,n.apFirst=function(t){return c.flow(n.map((function(t){return function(){return t}})),n.ap(t))},n.apSecond=function(t){return c.flow(n.map((function(){return function(t){return t}})),n.ap(t))},n.chainW=function(t){return function(e){return c.pipe(e,s.chain(o.fold(n.left,t)))}},n.chain=n.chainW,n.chainFirstW=function(t){return n.chainW((function(e){return c.pipe(t(e),n.map((function(){return e})))}))},n.chainFirst=n.chainFirstW,n.flatten=n.chain(c.identity),n.alt=function(t){return s.chain(o.fold(t,n.right))},n.of=n.right,n.fromIO=n.rightIO,n.fromTask=n.rightTask,n.throwError=n.left,n.URI="TaskEither",n.getSemigroup=function(t){return s.getSemigroup(o.getSemigroup(t))},n.getApplySemigroup=y,n.getApplyMonoid=function(t){return{concat:y(t).concat,empty:n.right(t.empty)}},n.getApplicativeTaskValidation=j,n.getAltTaskValidation=w,n.getTaskValidation=function(t){var e=j(s.ApplicativePar,t),r=w(t);return{URI:n.URI,_E:void 0,map:d,ap:e.ap,of:n.of,chain:v,bimap:m,mapLeft:h,alt:r.alt,fromIO:n.fromIO,fromTask:n.fromTask,throwError:n.throwError}},n.getFilterable=function(t){var e=o.getWitherable(t),r=u.getFilterableComposition(s.Monad,e);return{URI:n.URI,_E:void 0,map:d,compact:r.compact,separate:r.separate,filter:r.filter,filterMap:r.filterMap,partition:r.partition,partitionMap:r.partitionMap}},n.Functor={URI:n.URI,map:d},n.ApplicativePar={URI:n.URI,map:d,ap:g,of:n.of},n.ApplicativeSeq={URI:n.URI,map:d,ap:b,of:n.of},n.Bifunctor={URI:n.URI,bimap:m,mapLeft:h},n.Alt={URI:n.URI,map:d,alt:O},n.taskEither={URI:n.URI,bimap:m,mapLeft:h,map:d,of:n.of,ap:g,chain:v,alt:O,fromIO:n.fromIO,fromTask:n.fromTask,throwError:n.throwError},n.taskEitherSeq={URI:n.URI,bimap:m,mapLeft:h,map:d,of:n.of,ap:b,chain:v,alt:O,fromIO:n.fromIO,fromTask:n.fromTask,throwError:n.throwError},n.taskify=function(t){return function(){var n=Array.prototype.slice.call(arguments);return function(){return new Promise((function(e){t.apply(null,n.concat((function(t,n){return e(null!=t?o.left(t):o.right(n))})))}))}}},n.bracket=function(t,e,r){return c.pipe(t,n.chain((function(t){return c.pipe(c.pipe(e(t),s.map(o.right)),n.chain((function(e){return c.pipe(r(t,e),n.chain((function(){return o.isLeft(e)?n.left(e.left):n.of(e.right)})))})))})))},n.bindTo=function(t){return n.map(c.bindTo_(t))},n.bindW=function(t,e){return n.chainW((function(r){return c.pipe(e(r),n.map((function(n){return c.bind_(r,t,n)})))}))},n.bind=n.bindW,n.apSW=function(t,e){return c.flow(n.map((function(n){return function(e){return c.bind_(n,t,e)}})),n.apW(e))},n.apS=n.apSW},646:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.apS=n.bind=n.bindTo=n.getRefinement=n.exists=n.elem=n.option=n.MonadThrow=n.Witherable=n.Traversable=n.Filterable=n.Compactable=n.Extend=n.Alternative=n.Alt=n.Foldable=n.Monad=n.Applicative=n.Functor=n.getMonoid=n.getLastMonoid=n.getFirstMonoid=n.getApplyMonoid=n.getApplySemigroup=n.getOrd=n.getEq=n.getShow=n.URI=n.wilt=n.wither=n.sequence=n.traverse=n.partitionMap=n.partition=n.filterMap=n.filter=n.separate=n.compact=n.reduceRight=n.foldMap=n.reduce=n.duplicate=n.extend=n.throwError=n.zero=n.alt=n.flatten=n.chainFirst=n.chain=n.of=n.apSecond=n.apFirst=n.ap=n.map=n.mapNullable=n.getOrElse=n.getOrElseW=n.toUndefined=n.toNullable=n.fold=n.fromEither=n.getRight=n.getLeft=n.tryCatch=n.fromPredicate=n.fromNullable=n.some=n.none=n.isNone=n.isSome=void 0;var r=e(40);function i(t){return null==t?n.none:n.some(t)}function a(t){return"Right"===t._tag?n.none:n.some(t.left)}function o(t){return"Left"===t._tag?n.none:n.some(t.right)}n.isSome=function(t){return"Some"===t._tag},n.isNone=function(t){return"None"===t._tag},n.none={_tag:"None"},n.some=function(t){return{_tag:"Some",value:t}},n.fromNullable=i,n.fromPredicate=function(t){return function(e){return t(e)?n.some(e):n.none}},n.tryCatch=function(t){try{return n.some(t())}catch(t){return n.none}},n.getLeft=a,n.getRight=o,n.fromEither=function(t){return"Left"===t._tag?n.none:n.some(t.right)},n.fold=function(t,e){return function(r){return n.isNone(r)?t():e(r.value)}},n.toNullable=function(t){return n.isNone(t)?null:t.value},n.toUndefined=function(t){return n.isNone(t)?void 0:t.value},n.getOrElseW=function(t){return function(e){return n.isNone(e)?t():e.value}},n.getOrElse=n.getOrElseW,n.mapNullable=function(t){return function(e){return n.isNone(e)?n.none:i(t(e.value))}};var u=function(t,e){return r.pipe(t,n.map(e))},c=function(t,e){return r.pipe(t,n.ap(e))},s=function(t,e){return r.pipe(t,n.chain(e))},f=function(t,e,i){return r.pipe(t,n.reduce(e,i))},p=function(t){var e=n.foldMap(t);return function(t,n){return r.pipe(t,e(n))}},l=function(t,e,i){return r.pipe(t,n.reduceRight(e,i))},d=function(t){var e=n.traverse(t);return function(t,n){return r.pipe(t,e(n))}},m=function(t,e){return r.pipe(t,n.alt(e))},h=function(t,e){return r.pipe(t,n.filter(e))},g=function(t,e){return r.pipe(t,n.filterMap(e))},b=function(t,e){return r.pipe(t,n.extend(e))},v=function(t,e){return r.pipe(t,n.partition(e))},O=function(t,e){return r.pipe(t,n.partitionMap(e))},y=function(t){var e=n.wither(t);return function(t,n){return r.pipe(t,e(n))}},j=function(t){var e=n.wilt(t);return function(t,n){return r.pipe(t,e(n))}};n.map=function(t){return function(e){return n.isNone(e)?n.none:n.some(t(e.value))}},n.ap=function(t){return function(e){return n.isNone(e)||n.isNone(t)?n.none:n.some(e.value(t.value))}},n.apFirst=function(t){return r.flow(n.map((function(t){return function(){return t}})),n.ap(t))},n.apSecond=function(t){return r.flow(n.map((function(){return function(t){return t}})),n.ap(t))},n.of=n.some,n.chain=function(t){return function(e){return n.isNone(e)?n.none:t(e.value)}},n.chainFirst=function(t){return n.chain((function(e){return r.pipe(t(e),n.map((function(){return e})))}))},n.flatten=n.chain(r.identity),n.alt=function(t){return function(e){return n.isNone(e)?t():e}},n.zero=function(){return n.none},n.throwError=function(){return n.none},n.extend=function(t){return function(e){return n.isNone(e)?n.none:n.some(t(e))}},n.duplicate=n.extend(r.identity),n.reduce=function(t,e){return function(r){return n.isNone(r)?t:e(t,r.value)}},n.foldMap=function(t){return function(e){return function(r){return n.isNone(r)?t.empty:e(r.value)}}},n.reduceRight=function(t,e){return function(r){return n.isNone(r)?t:e(r.value,t)}},n.compact=n.flatten;var w={left:n.none,right:n.none};function E(t){return{equals:function(e,r){return e===r||(n.isNone(e)?n.isNone(r):!n.isNone(r)&&t.equals(e.value,r.value))}}}function I(t){return{concat:function(e,r){return n.isSome(e)&&n.isSome(r)?n.some(t.concat(e.value,r.value)):n.none}}}n.separate=function(t){var e=r.pipe(t,n.map((function(t){return{left:a(t),right:o(t)}})));return n.isNone(e)?w:e.value},n.filter=function(t){return function(e){return n.isNone(e)?n.none:t(e.value)?e:n.none}},n.filterMap=function(t){return function(e){return n.isNone(e)?n.none:t(e.value)}},n.partition=function(t){return function(e){return{left:r.pipe(e,n.filter((function(n){return!t(n)}))),right:r.pipe(e,n.filter(t))}}},n.partitionMap=function(t){return function(e){return n.separate(r.pipe(e,n.map(t)))}},n.traverse=function(t){return function(e){return function(r){return n.isNone(r)?t.of(n.none):t.map(e(r.value),n.some)}}},n.sequence=function(t){return function(e){return n.isNone(e)?t.of(n.none):t.map(e.value,n.some)}},n.wither=function(t){return function(e){return function(r){return n.isNone(r)?t.of(n.none):e(r.value)}}},n.wilt=function(t){return function(e){return function(i){var u=r.pipe(i,n.map((function(n){return t.map(e(n),(function(t){return{left:a(t),right:o(t)}}))})));return n.isNone(u)?t.of({left:n.none,right:n.none}):u.value}}},n.URI="Option",n.getShow=function(t){return{show:function(e){return n.isNone(e)?"none":"some("+t.show(e.value)+")"}}},n.getEq=E,n.getOrd=function(t){return{equals:E(t).equals,compare:function(e,r){return e===r?0:n.isSome(e)?n.isSome(r)?t.compare(e.value,r.value):1:-1}}},n.getApplySemigroup=I,n.getApplyMonoid=function(t){return{concat:I(t).concat,empty:n.some(t.empty)}},n.getFirstMonoid=function(){return{concat:function(t,e){return n.isNone(t)?e:t},empty:n.none}},n.getLastMonoid=function(){return{concat:function(t,e){return n.isNone(e)?t:e},empty:n.none}},n.getMonoid=function(t){return{concat:function(e,r){return n.isNone(e)?r:n.isNone(r)?e:n.some(t.concat(e.value,r.value))},empty:n.none}},n.Functor={URI:n.URI,map:u},n.Applicative={URI:n.URI,map:u,ap:c,of:n.of},n.Monad={URI:n.URI,map:u,ap:c,of:n.of,chain:s},n.Foldable={URI:n.URI,reduce:f,foldMap:p,reduceRight:l},n.Alt={URI:n.URI,map:u,alt:m},n.Alternative={URI:n.URI,map:u,ap:c,of:n.of,alt:m,zero:n.zero},n.Extend={URI:n.URI,map:u,extend:b},n.Compactable={URI:n.URI,compact:n.compact,separate:n.separate},n.Filterable={URI:n.URI,map:u,compact:n.compact,separate:n.separate,filter:h,filterMap:g,partition:v,partitionMap:O},n.Traversable={URI:n.URI,map:u,reduce:f,foldMap:p,reduceRight:l,traverse:d,sequence:n.sequence},n.Witherable={URI:n.URI,map:u,reduce:f,foldMap:p,reduceRight:l,traverse:d,sequence:n.sequence,compact:n.compact,separate:n.separate,filter:h,filterMap:g,partition:v,partitionMap:O,wither:y,wilt:j},n.MonadThrow={URI:n.URI,map:u,ap:c,of:n.of,chain:s,throwError:n.throwError},n.option={URI:n.URI,map:u,of:n.of,ap:c,chain:s,reduce:f,foldMap:p,reduceRight:l,traverse:d,sequence:n.sequence,zero:n.zero,alt:m,extend:b,compact:n.compact,separate:n.separate,filter:h,filterMap:g,partition:v,partitionMap:O,wither:y,wilt:j,throwError:n.throwError},n.elem=function(t){return function(e,r){return!n.isNone(r)&&t.equals(e,r.value)}},n.exists=function(t){return function(e){return!n.isNone(e)&&t(e.value)}},n.getRefinement=function(t){return function(e){return n.isSome(t(e))}},n.bindTo=function(t){return n.map(r.bindTo_(t))},n.bind=function(t,e){return n.chain((function(i){return r.pipe(e(i),n.map((function(n){return r.bind_(i,t,n)})))}))},n.apS=function(t,e){return r.flow(n.map((function(n){return function(e){return r.bind_(n,t,e)}})),n.ap(e))}},814:function(t,n,e){"use strict";e.d(n,"a",(function(){return h})),e.d(n,"b",(function(){return g}));var r=e(5),i=e.n(r),a=e(1),o=e(305),u=e(192),c=e(18),s=e(4);const f=s.i18n.translate("xpack.securitySolution.containers.detectionEngine.alerts.readListsPrivileges.errorDescription",{defaultMessage:"Failed to retrieve lists privileges"}),p=s.i18n.translate("xpack.securitySolution.containers.detectionEngine.alerts.detectionEnginePrivileges.errorFetching",{defaultMessage:"Failed to retreive detection engine privileges"});var l=e(234),d=e(287);var m=e(425);const h=Object(r.createContext)({listPrivileges:{loading:!1,error:void 0,result:void 0},detectionEnginePrivileges:{loading:!1,error:void 0,result:void 0},endpointPrivileges:Object(m.a)(),kibanaSecuritySolutionsPrivileges:{crud:!1,read:!1}}),g=({kibanaCapabilities:t,children:n})=>{const e=!0===t[a.Zb].crud,s=!0===t[a.Zb].show,[g,b]=Object(r.useState)({crud:e,read:s}),v=((t=!0)=>{const n=Object(c.i)(),{lists:e}=Object(c.j)().services,{start:i,...a}=Object(o.j)(),{addError:s}=Object(u.a)(),p=Object(r.useRef)(new AbortController);return Object(r.useEffect)((()=>{const{loading:r,result:o,error:u}=a;!t||!e||r||o||u||(p.current.abort(),p.current=new AbortController,i({http:n,signal:p.current.signal}))}),[n,e,i,a,t]),Object(r.useEffect)((()=>()=>{p.current.abort()}),[]),Object(r.useEffect)((()=>{const t=a.error;null!=t&&s(t,{title:f})}),[s,a.error]),{loading:a.loading,error:a.error,result:a.result}})(s),O=((t=!0)=>{const{start:n,...e}=Object(l.a)(Object(l.d)(d.h)),{addError:i}=Object(u.a)(),a=Object(r.useRef)(new AbortController);return Object(r.useEffect)((()=>{const{loading:r,result:i,error:o}=e;!t||r||i||o||(a.current.abort(),a.current=new AbortController,n({signal:a.current.signal}))}),[n,e,t]),Object(r.useEffect)((()=>()=>{a.current.abort()}),[]),Object(r.useEffect)((()=>{const t=e.error;null!=t&&i(t,{title:p})}),[i,e.error]),e})(s),y=Object(m.b)();return Object(r.useEffect)((()=>{b((t=>t.read!==s||t.crud!==e?{read:s,crud:e}:t))}),[e,s]),i.a.createElement(h.Provider,{value:{listPrivileges:v,detectionEnginePrivileges:O,endpointPrivileges:y,kibanaSecuritySolutionsPrivileges:g}},n)}},898:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getFilterableComposition=void 0;var r=e(899),i=e(646);n.getFilterableComposition=function(t,n){var e=r.getCompactableComposition(t,n),a={map:e.map,compact:e.compact,separate:e.separate,partitionMap:function(t,n){return{left:a.filterMap(t,(function(t){return i.getLeft(n(t))})),right:a.filterMap(t,(function(t){return i.getRight(n(t))}))}},partition:function(t,n){return{left:a.filter(t,(function(t){return!n(t)})),right:a.filter(t,n)}},filterMap:function(e,r){return t.map(e,(function(t){return n.filterMap(t,r)}))},filter:function(e,r){return t.map(e,(function(t){return n.filter(t,r)}))}};return a}},899:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getCompactableComposition=void 0;var r=e(900),i=e(646);n.getCompactableComposition=function(t,n){var e=r.getFunctorComposition(t,n),a={map:e.map,compact:function(e){return t.map(e,n.compact)},separate:function(t){return{left:a.compact(e.map(t,i.getLeft)),right:a.compact(e.map(t,i.getRight))}}};return a}},900:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getFunctorComposition=void 0,n.getFunctorComposition=function(t,n){return{map:function(e,r){return t.map(e,(function(t){return n.map(t,r)}))}}}},901:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.apS=n.bind=n.bindTo=n.never=n.taskSeq=n.task=n.Monad=n.ApplicativeSeq=n.ApplicativePar=n.Functor=n.getRaceMonoid=n.getMonoid=n.getSemigroup=n.URI=n.fromTask=n.flatten=n.chainFirst=n.chain=n.of=n.apSecond=n.apFirst=n.ap=n.map=n.chainIOK=n.fromIOK=n.delay=n.fromIO=void 0;var r=e(40);function i(t){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return n.fromIO(t.apply(void 0,e))}}n.fromIO=function(t){return function(){return Promise.resolve(t())}},n.delay=function(t){return function(n){return function(){return new Promise((function(e){setTimeout((function(){n().then(e)}),t)}))}}},n.fromIOK=i,n.chainIOK=function(t){return n.chain(i(t))};var a=function(t,e){return r.pipe(t,n.map(e))},o=function(t,e){return r.pipe(t,n.ap(e))},u=function(t,e){return r.pipe(t,n.chain((function(t){return r.pipe(e,n.map(t))})))},c=function(t,e){return r.pipe(t,n.chain(e))};function s(t){return{concat:function(n,e){return function(){return n().then((function(n){return e().then((function(e){return t.concat(n,e)}))}))}}}}n.map=function(t){return function(n){return function(){return n().then(t)}}},n.ap=function(t){return function(n){return function(){return Promise.all([n(),t()]).then((function(t){return(0,t[0])(t[1])}))}}},n.apFirst=function(t){return r.flow(n.map((function(t){return function(){return t}})),n.ap(t))},n.apSecond=function(t){return r.flow(n.map((function(){return function(t){return t}})),n.ap(t))},n.of=function(t){return function(){return Promise.resolve(t)}},n.chain=function(t){return function(n){return function(){return n().then((function(n){return t(n)()}))}}},n.chainFirst=function(t){return n.chain((function(e){return r.pipe(t(e),n.map((function(){return e})))}))},n.flatten=n.chain(r.identity),n.fromTask=r.identity,n.URI="Task",n.getSemigroup=s,n.getMonoid=function(t){return{concat:s(t).concat,empty:n.of(t.empty)}},n.getRaceMonoid=function(){return{concat:function(t,n){return function(){return Promise.race([t(),n()])}},empty:n.never}},n.Functor={URI:n.URI,map:a},n.ApplicativePar={URI:n.URI,map:a,ap:o,of:n.of},n.ApplicativeSeq={URI:n.URI,map:a,ap:u,of:n.of},n.Monad={URI:n.URI,map:a,of:n.of,ap:o,chain:c},n.task={URI:n.URI,map:a,of:n.of,ap:o,chain:c,fromIO:n.fromIO,fromTask:n.fromTask},n.taskSeq={URI:n.URI,map:a,of:n.of,ap:u,chain:c,fromIO:n.fromIO,fromTask:n.fromTask},n.never=function(){return new Promise((function(t){}))},n.bindTo=function(t){return n.map(r.bindTo_(t))},n.bind=function(t,e){return n.chain((function(i){return r.pipe(e(i),n.map((function(n){return r.bind_(i,t,n)})))}))},n.apS=function(t,e){return r.flow(n.map((function(n){return function(e){return r.bind_(n,t,e)}})),n.ap(e))}}}]);