/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[8],{203:function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return i}));var r=a(3),n=a(5),s=a.n(n);function o(e){var t;const a=t=>{const{loading:a,id:n,refetch:o,setQuery:l,deleteQuery:c,inspect:u=null}=t;i({queryId:n,loading:a,refetch:o,setQuery:l,deleteQuery:c,inspect:u});const d=Object(r.omit)(["refetch","setQuery"],t);return s.a.createElement(e,d)};return a.displayName=`ManageQuery (${null!==(t=null==e?void 0:e.displayName)&&void 0!==t?t:"Unknown"})`,a}const i=({setQuery:e,deleteQuery:t,refetch:a,inspect:r,loading:s,queryId:o})=>{Object(n.useEffect)((()=>{e({id:o,inspect:null!=r?r:null,loading:s,refetch:a})}),[t,e,o,a,r,s]),Object(n.useEffect)((()=>()=>{t&&t({id:o})}),[t,o])}},241:function(e,t,a){"use strict";a.d(t,"a",(function(){return k}));var r=a(16),n=a(5),s=a.n(n),o=a(23),i=a.n(o),l=a(527),c=a(694),u=a(196),d=a(327);const p=i.a.h1.withConfig({displayName:"Header",componentId:"sc-1tun0gt-0"})(["display:grid;grid-gap:12px;grid-template-columns:auto auto;align-items:center;justify-items:start;justify-content:start;"]);p.displayName="Header";const b=i.a.span.withConfig({displayName:"TitleWrapper",componentId:"sc-1tun0gt-1"})(["min-width:0;max-width:100%;"]);b.displayName="TitleWrapper";const m=({draggableArguments:e,title:t,badgeOptions:a})=>s.a.createElement(r.EuiTitle,{size:"l"},s.a.createElement(p,{"data-test-subj":"header-page-title"},e?s.a.createElement(u.b,{"data-test-subj":"header-page-draggable",id:`header-page-draggable-${e.field}-${e.value}`,field:e.field,value:`${e.value}`}):s.a.createElement(b,null,s.a.createElement(d.b,{tooltipContent:t},t)),a&&s.a.createElement(s.a.Fragment,null,a.beta?s.a.createElement(r.EuiBetaBadge,{label:a.text,tooltipContent:a.tooltip,tooltipPosition:"bottom"}):s.a.createElement(r.EuiBadge,{color:a.color||"hollow",title:""},a.text)))),g=s.a.memo(m);var f=a(221),y=a(18);i.a.header.attrs({className:"securitySolutionHeaderPage"}).withConfig({displayName:"Header",componentId:"sc-fdx6r8-0"})(["",""],(({border:e,theme:t})=>Object(o.css)(["margin-bottom:",";"],t.eui.euiSizeL))).displayName="Header";const T=i.a.div.attrs({className:"securitySolutionHeaderPage__linkBack"}).withConfig({displayName:"LinkBack",componentId:"sc-fdx6r8-1"})(["",""],(({theme:e})=>Object(o.css)(["font-size:",";line-height:",";margin-bottom:",";"],e.eui.euiFontSizeXS,e.eui.euiLineHeight,e.eui.euiSizeS)));T.displayName="LinkBack";const w=i()(r.EuiPageHeaderSection).withConfig({displayName:"HeaderSection",componentId:"sc-fdx6r8-2"})(["min-width:0;max-width:100%;"]);w.displayName="HeaderSection";const h=s.a.memo((({backOptions:e})=>{var t,a;const{navigateToUrl:r}=Object(y.j)().services.application,{formatUrl:n}=Object(f.k)(e.pageId),o=n(null!==(t=e.path)&&void 0!==t?t:"");return s.a.createElement(T,null,s.a.createElement(l.b,{dataTestSubj:null!==(a=e.dataTestSubj)&&void 0!==a?a:"link-back",onClick:e=>{e.preventDefault(),r(o)},href:o,iconType:"arrowLeft"},e.text))}));h.displayName="HeaderLinkBack";const O=({backOptions:e,backComponent:t,badgeOptions:a,border:n,children:o,draggableArguments:i,isLoading:l,subtitle:u,subtitle2:d,title:p,titleNode:b})=>s.a.createElement(s.a.Fragment,null,s.a.createElement(r.EuiPageHeader,{alignItems:"center",bottomBorder:n},s.a.createElement(w,null,e&&s.a.createElement(h,{backOptions:e}),!e&&t&&s.a.createElement(s.a.Fragment,null,t),b||s.a.createElement(g,{draggableArguments:i,title:p,badgeOptions:a}),u&&s.a.createElement(c.a,{"data-test-subj":"header-page-subtitle",items:u}),d&&s.a.createElement(c.a,{"data-test-subj":"header-page-subtitle-2",items:d}),n&&l&&s.a.createElement(r.EuiProgress,{size:"xs",color:"accent"})),o&&s.a.createElement(r.EuiPageHeaderSection,{"data-test-subj":"header-page-supplements"},o)),s.a.createElement(r.EuiSpacer,{size:"l"})),k=s.a.memo(O)},262:function(e,t,a){"use strict";a.d(t,"a",(function(){return k}));var r=a(16),n=a(3),s=a(5),o=a.n(s),i=a(23),l=a.n(i),c=a(1),u=a(216),d=a(239),p=a(46),b=a(4);const m=b.i18n.translate("xpack.securitySolution.paginatedTable.showingSubtitle",{defaultMessage:"Showing"}),g=b.i18n.translate("xpack.securitySolution.paginatedTable.rowsButtonLabel",{defaultMessage:"Rows per page"}),f=b.i18n.translate("xpack.securitySolution.paginatedTable.tooManyResultsToastTitle",{defaultMessage:" - too many results"}),y=b.i18n.translate("xpack.securitySolution.paginatedTable.tooManyResultsToastText",{defaultMessage:"Narrow your query to better filter the results"});var T=a(312),w=a(220),h=a(197);const O=({activePage:e,columns:t,dataTestSubj:a="paginated-table",headerCount:i,headerFilters:l,headerSupplement:b,headerTitle:O,headerTooltip:k,headerUnit:E,headerSubtitle:P,id:x,isInspect:C,itemsPerRow:I,limit:N,loading:D,loadPage:M,onChange:R=n.noop,pageOfItems:F,setQuerySkip:$,showMorePagesIndicator:A,sorting:Q=null,split:_,stackHeader:H,totalCount:q,updateActivePage:U,updateLimitPagination:L})=>{const[B,V]=Object(s.useState)(D),[z,G]=Object(s.useState)(e),[J,Z]=Object(s.useState)(-1===i),[W,K]=Object(s.useState)(!1),X=Math.ceil(q/N),Y=Object(p.g)()[1];Object(s.useEffect)((()=>{G(e)}),[e]),Object(s.useEffect)((()=>{i>=0&&J&&Z(!1)}),[J,i]),Object(s.useEffect)((()=>{V(D)}),[D]);const ee=()=>{K(!1)},te=o.a.createElement(r.EuiButtonEmpty,{size:"xs",color:"text",iconType:"arrowDown",iconSide:"right",onClick:()=>{K(!W)}},`${g}: ${N}`),ae=I&&I.map((e=>o.a.createElement(r.EuiContextMenuItem,{key:e.text,icon:N===e.numberOfRow?"check":"empty",onClick:()=>{ee(),L(e.numberOfRow),U(0)}},e.text))),re=A?v:r.EuiFlexItem,ne=Object(s.useMemo)((()=>Q?{sort:{field:Q.field,direction:Q.direction}}:void 0),[Q]),{toggleStatus:se,setToggleStatus:oe}=Object(h.a)(x),ie=Object(s.useCallback)((e=>{oe(e),$(!e)}),[$,oe]);return o.a.createElement(w.c,{show:!J},o.a.createElement(T.a,{"data-test-subj":`${a}-loading-${D}`,loading:D},o.a.createElement(u.a,{toggleStatus:se,toggleQuery:ie,headerFilters:l,id:x,split:_,stackHeader:H,subtitle:!J&&P?`${m}: ${P}`:E&&`${m}: ${i>=0?i.toLocaleString():0} ${E}`,title:O,tooltip:k},!J&&b),se&&(J?o.a.createElement(r.EuiLoadingContent,{"data-test-subj":"initialLoadingPanelPaginatedTable",lines:10}):o.a.createElement(o.a.Fragment,null,o.a.createElement(S,{"data-test-subj":"paginated-basic-table",columns:t,items:F,onChange:R,sorting:ne}),o.a.createElement(j,null,o.a.createElement(r.EuiFlexItem,null,I&&I.length>0&&q>=I[0].numberOfRow&&o.a.createElement(r.EuiPopover,{id:"customizablePagination","data-test-subj":"loadingMoreSizeRowPopover",button:te,isOpen:W,closePopover:ee,panelPaddingSize:"none",repositionOnScroll:!0},o.a.createElement(r.EuiContextMenuPanel,{items:ae,"data-test-subj":"loadingMorePickSizeRow"}))),o.a.createElement(re,{grow:!1},q>0&&o.a.createElement(r.EuiPagination,{"data-test-subj":"numberedPagination",pageCount:X,activePage:z,onPageClick:e=>{if((e+1)*N>=c.U)return Y({type:"addToaster",toast:{id:"PaginationWarningMsg",title:O+f,color:"warning",iconType:"alert",toastLifeTimeMs:1e4,text:y}});G(e),M(e),U(e)}}))),(C||B)&&o.a.createElement(d.a,{"data-test-subj":"loadingPanelPaginatedTable",overlay:!0,size:"xl"})))))},k=Object(s.memo)(O),S=l()(r.EuiBasicTable).withConfig({displayName:"BasicTable",componentId:"sc-53ob89-0"})(["tbody{th,td{vertical-align:top;}.euiTableCellContent{display:block;}}"]);S.displayName="BasicTable";const j=l()(r.EuiFlexGroup).attrs((()=>({alignItems:"center",responsive:!1}))).withConfig({displayName:"FooterAction",componentId:"sc-53ob89-1"})(["margin-top:",";"],(({theme:e})=>e.eui.euiSizeXS));j.displayName="FooterAction";const v=l()(r.EuiFlexItem).withConfig({displayName:"PaginationEuiFlexItem",componentId:"sc-53ob89-2"})(["@media only screen and (min-width:","){.euiButtonIcon:last-child{margin-left:28px;}.euiPagination{position:relative;}.euiPagination::before{bottom:0;color:",";content:'\\2026';font-size:",";padding:5px ",";position:absolute;right:",";}}"],(({theme:e})=>e.eui.euiBreakpoints.m),(({theme:e})=>e.eui.euiButtonColorDisabled),(({theme:e})=>e.eui.euiFontSizeS),(({theme:e})=>e.eui.euiSizeS),(({theme:e})=>e.eui.euiSizeL));v.displayName="PaginationEuiFlexItem"},263:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var r=a(5),n=a.n(r),s=a(165),o=a(16),i=a(88);const l=n.a.memo((()=>n.a.createElement(i.a,null,n.a.createElement(o.EuiPageTemplate,{template:"centeredContent"},n.a.createElement(o.EuiEmptyPrompt,{"data-test-subj":"notFoundPage",iconColor:"default",iconType:"logoElastic",title:n.a.createElement("p",null,n.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.pages.fourohfour.pageNotFoundDescription",defaultMessage:"Page not found"}))})))));l.displayName="NotFoundPage"},278:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var r=a(5),n=a.n(r),s=a(842),o=a(88);const i=Object(r.memo)((()=>n.a.createElement(o.a,null,n.a.createElement(s.a,null))));i.displayName="LandingPageComponent"},283:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return s})),a.d(t,"d",(function(){return r})),a.d(t,"e",(function(){return h})),a.d(t,"c",(function(){return O}));var r={};a.r(r),a.d(r,"authenticationsSelector",(function(){return c})),a.d(r,"hostsSelector",(function(){return u})),a.d(r,"hostRiskScoreSelector",(function(){return d})),a.d(r,"hostRiskScoreSeverityFilterSelector",(function(){return p})),a.d(r,"eventsSelector",(function(){return b})),a.d(r,"uncommonProcessesSelector",(function(){return m})),a.d(r,"alertsSelector",(function(){return g}));var n=a(451),s=a(225),o=a(3),i=a(12);const l=(e,t)=>Object(o.get)(t,e.hosts),c=()=>Object(i.createSelector)(l,(e=>e.queries.authentications)),u=()=>Object(i.createSelector)(l,(e=>e.queries[s.HostsTableType.hosts])),d=()=>Object(i.createSelector)(l,(e=>e.queries[s.HostsTableType.risk])),p=()=>Object(i.createSelector)(l,(e=>e.queries[s.HostsTableType.risk].severitySelection)),b=()=>Object(i.createSelector)(l,(e=>e.queries.events)),m=()=>Object(i.createSelector)(l,(e=>e.queries.uncommonProcesses)),g=()=>Object(i.createSelector)(l,(e=>e.queries[s.HostsTableType.alerts]));var f=a(47),y=a(72),T=a(368),w=a(526);const h={page:{queries:{[s.HostsTableType.authentications]:{activePage:T.a,limit:T.b},[s.HostsTableType.hosts]:{activePage:T.a,direction:y.b.desc,limit:T.b,sortField:y.f.lastSeen},[s.HostsTableType.events]:{activePage:T.a,limit:T.b},[s.HostsTableType.uncommonProcesses]:{activePage:T.a,limit:T.b},[s.HostsTableType.anomalies]:null,[s.HostsTableType.alerts]:{activePage:T.a,limit:T.b},[s.HostsTableType.risk]:{activePage:T.a,limit:T.b,sort:{field:y.t.riskScore,direction:y.b.desc},severitySelection:[]},[s.HostsTableType.sessions]:{activePage:T.a,limit:T.b}}},details:{queries:{[s.HostsTableType.authentications]:{activePage:T.a,limit:T.b},[s.HostsTableType.hosts]:{activePage:T.a,direction:y.b.desc,limit:T.b,sortField:y.f.lastSeen},[s.HostsTableType.events]:{activePage:T.a,limit:T.b},[s.HostsTableType.uncommonProcesses]:{activePage:T.a,limit:T.b},[s.HostsTableType.anomalies]:null,[s.HostsTableType.alerts]:{activePage:T.a,limit:T.b},[s.HostsTableType.risk]:{activePage:T.a,limit:T.b,sort:{field:y.t.riskScore,direction:y.b.desc},severitySelection:[]},[s.HostsTableType.sessions]:{activePage:T.a,limit:T.b}}}},O=Object(f.reducerWithInitialState)(h).case(n.setHostTablesActivePageToZero,(e=>({...e,page:{...e.page,queries:Object(w.c)(e)},details:{...e.details,queries:Object(w.b)(e)}}))).case(n.setHostDetailsTablesActivePageToZero,(e=>({...e,details:{...e.details,queries:Object(w.b)(e)}}))).case(n.updateTableActivePage,((e,{activePage:t,hostsType:a,tableType:r})=>({...e,[a]:{...e[a],queries:{...e[a].queries,[r]:{...e[a].queries[r],activePage:t}}}}))).case(n.updateTableLimit,((e,{limit:t,hostsType:a,tableType:r})=>({...e,[a]:{...e[a],queries:{...e[a].queries,[r]:{...e[a].queries[r],limit:t}}}}))).case(n.updateHostsSort,((e,{sort:t,hostsType:a})=>({...e,[a]:{...e[a],queries:{...e[a].queries,[s.HostsTableType.hosts]:{...e[a].queries[s.HostsTableType.hosts],direction:t.direction,sortField:t.field,activePage:T.a}}}}))).case(n.updateHostRiskScoreSort,((e,{sort:t,hostsType:a})=>({...e,[a]:{...e[a],queries:{...e[a].queries,[s.HostsTableType.risk]:{...e[a].queries[s.HostsTableType.risk],sort:t}}}}))).case(n.updateHostRiskScoreSeverityFilter,((e,{severitySelection:t,hostsType:a})=>({...e,[a]:{...e[a],queries:{...e[a].queries,[s.HostsTableType.risk]:{...e[a].queries[s.HostsTableType.risk],severitySelection:t,activePage:T.a}}}}))).build()},289:function(e,t,a){"use strict";a.d(t,"c",(function(){return o})),a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return l})),a.d(t,"d",(function(){return c}));const r=["started","opened"],n=["starting","stopping","opening","closing"],s=["deleted","failed"],o=(e,t)=>r.includes(e)&&r.includes(t),i=(e,t)=>n.includes(e)||n.includes(t),l=(e,t)=>s.includes(e)||s.includes(t),c=e=>"machine_learning"===e},294:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));const r=(e,t,a)=>{const r=e*t;return{activePage:e,cursorStart:r,fakePossibleCount:4<=e&&e>0?t*(e+2):5*t,querySize:a?t:t+r}}},295:function(e,t,a){"use strict";a.d(t,"a",(function(){return v}));var r=a(650),n=a(3),s=a(5),o=a.n(s),i=a(42),l=a(19),c=a(85),u=a.n(c),d=a(28),p=a(364),b=a(12),m=a(272);const g=e=>e.query,f=e=>e.savedQuery;var y=a(84),T=a(18),w=a(306),h=a(283),O=a(214);const k="securitySolution.searchBar.appState",S=Object(s.memo)((({end:e,filterQuery:t,fromStr:a,hideFilterBar:n=!1,hideQueryInput:c=!1,id:d,indexPattern:b,isLoading:m=!1,pollForSignalIndex:g,queries:f,savedQuery:y,setSavedQuery:S,setSearchBarFilter:j,start:v,toStr:E,updateSearch:P,dataTestSubj:x})=>{const{data:{query:{timefilter:{timefilter:C},filterManager:I}},storage:N,unifiedSearch:{ui:{SearchBar:D}}}=Object(T.j)().services,M=Object(i.useDispatch)(),R=Object(s.useCallback)((()=>{M(w.b.setUsersTablesActivePageToZero()),M(h.a.setHostTablesActivePageToZero()),M(O.b.setNetworkTablesActivePageToZero())}),[M]);Object(s.useEffect)((()=>{null!=a&&null!=E?C.setTime({from:a,to:E}):null!=v&&null!=e&&(R(),C.setTime({from:new Date(v).toISOString(),to:new Date(e).toISOString()}))}),[e,a,v,C,E,R]);const F=Object(s.useCallback)((n=>{null!=g&&g();const s=n.dateRange.from.includes("now")||n.dateRange.to.includes("now");let o={id:d,end:null!=E?E:new Date(e).toISOString(),start:null!=a?a:new Date(v).toISOString(),isInvalid:!1,isQuickSelection:s,updateTime:!1,filterManager:I,setTablesActivePageToZero:R},i=!1;(!s||a===n.dateRange.from&&E===n.dateRange.to)&&(s||v===Object(p.c)(n.dateRange.from)&&e===Object(p.c)(n.dateRange.to))||(i=!0,o.updateTime=!0,o.end=n.dateRange.to,o.start=n.dateRange.from),null==n.query||u()(n.query,t)||(i=!0,o=Object(r.set)("query",n.query,o)),i||(s&&n.dateRange.to!==n.dateRange.from?(o.updateTime=!0,o.end=n.dateRange.to,o.start=n.dateRange.from):f.forEach((e=>e.refetch&&e.refetch()))),window.setTimeout((()=>P(o)),0)}),[d,g,E,e,a,v,I,t,f,P,R]),$=Object(s.useCallback)((e=>{e.dateRange.from.includes("now")||e.dateRange.to.includes("now")?P({id:d,end:e.dateRange.to,start:e.dateRange.from,isInvalid:!1,isQuickSelection:!0,updateTime:!0,filterManager:I,setTablesActivePageToZero:R}):f.forEach((e=>e.refetch&&e.refetch()))}),[P,d,I,f,R]),A=Object(s.useCallback)((e=>{S({id:d,savedQuery:e})}),[d,S]),Q=Object(s.useCallback)((t=>{const n=!!t.attributes.timefilter&&(t.attributes.timefilter.from.includes("now")||t.attributes.timefilter.to.includes("now"));let s={id:d,filters:t.attributes.filters||[],end:null!=E?E:new Date(e).toISOString(),start:null!=a?a:new Date(v).toISOString(),isInvalid:!1,isQuickSelection:n,updateTime:!1,filterManager:I,setTablesActivePageToZero:R};t.attributes.timefilter&&(s.end=t.attributes.timefilter?t.attributes.timefilter.to:s.end,s.start=t.attributes.timefilter?t.attributes.timefilter.from:s.start,s.updateTime=!0),s=Object(r.set)("query",t.attributes.query,s),s=Object(r.set)("savedQuery",t,s),P(s)}),[d,E,e,a,v,I,P,R]),_=Object(s.useCallback)((()=>{null!=y&&P({id:d,filters:[],end:null!=E?E:new Date(e).toISOString(),start:null!=a?a:new Date(v).toISOString(),isInvalid:!1,isQuickSelection:!1,updateTime:!1,query:{query:"",language:y.attributes.query.language},resetSavedQuery:!0,savedQuery:void 0,filterManager:I,setTablesActivePageToZero:R})}),[y,P,d,E,e,a,v,I,R]),H=Object(s.useCallback)((e=>N.set(k,e)),[N]),q=Object(s.useCallback)((()=>{var e;return null!==(e=N.get(k))&&void 0!==e?e:[]}),[N]);Object(s.useEffect)((()=>{let e=!0;const t=new l.Subscription;return t.add(I.getUpdates$().subscribe({next:()=>{e&&(H(I.getAppFilters()),j({id:d,filters:I.getFilters()}),R())}})),I.setAppFilters(q()),j({id:d,filters:I.getFilters()}),()=>{e=!1,t.unsubscribe()}}),[]);const U=Object(s.useMemo)((()=>[b]),[b]);return o.a.createElement("div",{"data-test-subj":`${d}DatePicker`},o.a.createElement(D,{appName:"siem",isLoading:m,indexPatterns:U,query:t,onClearSavedQuery:_,onQuerySubmit:F,onRefresh:$,onSaved:A,onSavedQueryUpdated:Q,savedQuery:y,showFilterBar:!n,showDatePicker:!0,showQueryBar:!0,showQueryInput:!c,showSaveQuery:!0,dataTestSubj:x}))}),((e,t)=>e.end===t.end&&e.filterQuery===t.filterQuery&&e.fromStr===t.fromStr&&e.id===t.id&&e.isLoading===t.isLoading&&e.savedQuery===t.savedQuery&&e.setSavedQuery===t.setSavedQuery&&e.setSearchBarFilter===t.setSearchBarFilter&&e.start===t.start&&e.toStr===t.toStr&&e.updateSearch===t.updateSearch&&e.dataTestSubj===t.dataTestSubj&&u()(e.indexPattern,t.indexPattern)&&u()(e.queries,t.queries)));S.displayName="SiemSearchBar";const j=e=>({end:t,filters:a,id:r,isQuickSelection:n,query:s,resetSavedQuery:o,savedQuery:i,start:l,timelineId:c,filterManager:u,updateTime:b=!1,setTablesActivePageToZero:m})=>{if(b){const a=Object(p.c)(l);let s=Object(p.c)(t,{roundUp:!0});n?e(t===l?d.b.setAbsoluteRangeDatePicker({id:r,fromStr:l,toStr:t,from:a,to:s}):d.b.setRelativeRangeDatePicker({id:r,fromStr:l,toStr:t,from:a,to:s})):(s=Object(p.c)(t),e(d.b.setAbsoluteRangeDatePicker({id:r,from:Object(p.c)(l),to:Object(p.c)(t)}))),null!=c&&e(y.a.updateRange({id:c,start:a,end:s}))}null!=s&&e(d.b.setFilterQuery({id:r,...s})),null!=a&&u.setFilters(a),(null!=i||o)&&e(d.b.setSavedQuery({id:r,savedQuery:i})),m()},v=Object(i.connect)((()=>{const e=Object(m.b)(),t=Object(m.c)(),a=Object(m.d)(),r=Object(m.h)(),s=Object(m.i)(),o=Object(m.j)(),i=Object(b.createSelector)(g,(e=>e)),l=Object(b.createSelector)(f,(e=>e));return(c,{id:u})=>{const d=Object(n.getOr)({},`inputs.${u}`,c);return{end:e(d),fromStr:t(d),filterQuery:i(d),isLoading:a(d),queries:r(c,u),savedQuery:l(d),start:s(d),toStr:o(d)}}}),(e=>({updateSearch:j(e),setSavedQuery:({id:t,savedQuery:a})=>e(d.b.setSavedQuery({id:t,savedQuery:a})),setSearchBarFilter:({id:t,filters:a})=>e(d.b.setSearchBarFilter({id:t,filters:a}))})))(S)},296:function(e,t,a){"use strict";a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return c}));var r,n=a(5),s=a(138),o=(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])},r(e,t)},function(e,t){function a(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}),i=function(){var e,t,a={},r=Object.assign(document.createElement("div"),{setPortalProps:function(e){a=e},getInitialPortalProps:function(){return a},mount:function(a,n){n!==t&&(r.unmount(),a.replaceChild(r,n),e=a,t=n)},unmount:function(a){a&&a!==t||e&&t&&(e.replaceChild(t,r),e=void 0,t=void 0)}});return r},l=function(e){function t(t){var a=e.call(this,t)||this;return a.addPropsChannel=function(){Object.assign(a.props.node,{setPortalProps:function(e){a.setState({nodeProps:e})}})},a.state={nodeProps:a.props.node.getInitialPortalProps()},a}return o(t,e),t.prototype.componentDidMount=function(){this.addPropsChannel()},t.prototype.componentDidUpdate=function(){this.addPropsChannel()},t.prototype.render=function(){var e=this,t=this.props,a=t.children,r=t.node;return s.createPortal(n.Children.map(a,(function(t){return n.isValidElement(t)?n.cloneElement(t,e.state.nodeProps):t})),r)},t}(n.PureComponent),c=function(e){function t(t){var a=e.call(this,t)||this;return a.placeholderNode=n.createRef(),a.passPropsThroughPortal(),a}return o(t,e),t.prototype.passPropsThroughPortal=function(){var e=Object.assign({},this.props,{node:void 0});this.props.node.setPortalProps(e)},t.prototype.componentDidMount=function(){var e=this.props.node,t=this.placeholderNode.current,a=t.parentNode;e.mount(a,t),this.passPropsThroughPortal()},t.prototype.componentDidUpdate=function(){var e=this.props.node,t=this.placeholderNode.current,a=t.parentNode;e.mount(a,t),this.passPropsThroughPortal()},t.prototype.componentWillUnmount=function(){this.props.node.unmount(this.placeholderNode.current)},t.prototype.render=function(){return n.createElement("div",{ref:this.placeholderNode})},t}(n.PureComponent)},306:function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return s})),a.d(t,"e",(function(){return r})),a.d(t,"a",(function(){return T})),a.d(t,"d",(function(){return w}));var r={};a.r(r),a.d(r,"allUsersSelector",(function(){return l})),a.d(r,"userRiskScoreSelector",(function(){return c})),a.d(r,"usersRiskScoreSeverityFilterSelector",(function(){return u})),a.d(r,"authenticationsSelector",(function(){return d}));var n=a(471),s=a(233),o=a(12);const i=e=>e.users.page,l=()=>Object(o.createSelector)(i,(e=>e.queries[s.UsersTableType.allUsers])),c=()=>Object(o.createSelector)(i,(e=>e.queries[s.UsersTableType.risk])),u=()=>Object(o.createSelector)(i,(e=>e.queries[s.UsersTableType.risk].severitySelection)),d=()=>Object(o.createSelector)(i,(e=>e.queries[s.UsersTableType.authentications]));var p=a(47),b=a(368);const m=e=>({...e.page.queries,[s.UsersTableType.allUsers]:{...e.page.queries[s.UsersTableType.allUsers],activePage:b.a}});var g=a(59),f=a(72),y=a(113);const T={page:{queries:{[s.UsersTableType.allUsers]:{activePage:b.a,limit:b.b,sort:{field:y.a.lastSeen,direction:g.a.desc}},[s.UsersTableType.authentications]:{activePage:b.a,limit:b.b},[s.UsersTableType.risk]:{activePage:b.a,limit:b.b,sort:{field:f.t.riskScore,direction:g.a.desc},severitySelection:[]},[s.UsersTableType.anomalies]:null,[s.UsersTableType.events]:{activePage:b.a,limit:b.b},[s.UsersTableType.alerts]:{activePage:b.a,limit:b.b}}},details:{queries:{[s.UsersTableType.anomalies]:null,[s.UsersTableType.events]:{activePage:b.a,limit:b.b},[s.UsersTableType.alerts]:{activePage:b.a,limit:b.b}}}},w=Object(p.reducerWithInitialState)(T).case(n.setUsersTablesActivePageToZero,(e=>({...e,page:{...e.page,queries:m(e)}}))).case(n.updateTableActivePage,((e,{activePage:t,tableType:a})=>({...e,page:{...e.page,queries:{...e.page.queries,[a]:{...e.page.queries[a],activePage:t}}}}))).case(n.updateTableLimit,((e,{limit:t,tableType:a})=>({...e,page:{...e.page,queries:{...e.page.queries,[a]:{...e.page.queries[a],limit:t}}}}))).case(n.updateTableSorting,((e,{sort:t,tableType:a})=>({...e,page:{...e.page,queries:{...e.page.queries,[a]:{...e.page.queries[a],sort:t,activePage:b.a}}}}))).case(n.updateUserRiskScoreSeverityFilter,((e,{severitySelection:t})=>({...e,page:{...e.page,queries:{...e.page.queries,[s.UsersTableType.risk]:{...e.page.queries[s.UsersTableType.risk],severitySelection:t,activePage:b.a}}}}))).build()},308:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var r=a(5),n=a.n(r),s=a(23),o=a.n(s),i=a(296),l=a(16),c=a(693);const u=o.a.header.withConfig({displayName:"FiltersGlobalContainer",componentId:"sc-z1qy4y-0"})(["display:",";"],(({show:e})=>e?"block":"none"));u.displayName="FiltersGlobalContainer";const d=n.a.memo((({children:e,show:t=!0})=>{const{globalKQLHeaderPortalNode:a}=Object(c.a)();return n.a.createElement(i.a,{node:a},n.a.createElement(l.EuiPanel,{borderRadius:"none",color:"subdued",paddingSize:"none"},n.a.createElement(u,{"data-test-subj":"filters-global-container",show:t},e)))}));d.displayName="FiltersGlobal"},325:function(e,t,a){"use strict";a.d(t,"a",(function(){return y}));var r=a(5),n=a.n(r),s=a(16),o=a(23),i=a.n(o),l=a(4);const c=l.i18n.translate("xpack.securitySolution.andOrBadge.and",{defaultMessage:"AND"}),u=l.i18n.translate("xpack.securitySolution.andOrBadge.or",{defaultMessage:"OR"}),d=i()(s.EuiBadge).withConfig({displayName:"RoundBadge",componentId:"sc-wu3h16-0"})(["align-items:center;border-radius:100%;display:inline-flex;font-size:9px;height:34px;justify-content:center;margin:0 5px 0 5px;padding:7px 6px 4px 6px;user-select:none;width:34px;.euiBadge__content{position:relative;top:-1px;}.euiBadge__text{text-overflow:clip;}"]);d.displayName="RoundBadge";const p=({type:e})=>n.a.createElement(d,{"data-test-subj":"and-or-badge",color:"hollow"},"and"===e?c:u);p.displayName="RoundedBadge";const b=Object(o.css)(["background:",";position:relative;width:2px;&:after{background:",";content:'';height:8px;right:-4px;position:absolute;width:10px;clip-path:circle();}"],(({theme:e})=>e.eui.euiColorLightShade),(({theme:e})=>e.eui.euiColorLightShade)),m=i()(s.EuiFlexItem).withConfig({displayName:"TopAntenna",componentId:"sc-10c57g6-0"})([""," &:after{top:0;}"],b),g=i()(s.EuiFlexItem).withConfig({displayName:"BottomAntenna",componentId:"sc-10c57g6-1"})([""," &:after{bottom:0;}"],b),f=({type:e})=>n.a.createElement(s.EuiFlexGroup,{className:"andBadgeContainer",gutterSize:"none",direction:"column",alignItems:"center"},n.a.createElement(m,{"data-test-subj":"andOrBadgeBarTop",grow:1}),n.a.createElement(s.EuiFlexItem,{grow:!1},n.a.createElement(p,{type:e})),n.a.createElement(g,{"data-test-subj":"andOrBadgeBarBottom",grow:1}));f.displayName="RoundedBadgeAntenna";const y=n.a.memo((({type:e,includeAntennas:t=!1})=>t?n.a.createElement(f,{type:e}):n.a.createElement(p,{type:e})));y.displayName="AndOrBadge"},353:function(e,t,a){"use strict";a.d(t,"h",(function(){return n})),a.d(t,"a",(function(){return s})),a.d(t,"k",(function(){return o})),a.d(t,"j",(function(){return i})),a.d(t,"g",(function(){return l})),a.d(t,"d",(function(){return c})),a.d(t,"l",(function(){return u})),a.d(t,"e",(function(){return d})),a.d(t,"c",(function(){return p})),a.d(t,"b",(function(){return b})),a.d(t,"f",(function(){return m})),a.d(t,"i",(function(){return g}));var r=a(4);const n=r.i18n.translate("xpack.securitySolution.anomaliesTable.table.showingDescription",{defaultMessage:"Showing"}),s=r.i18n.translate("xpack.securitySolution.anomaliesTable.table.anomaliesDescription",{defaultMessage:"Anomalies"}),o=e=>r.i18n.translate("xpack.securitySolution.anomaliesTable.table.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {anomaly} other {anomalies}}"}),i=r.i18n.translate("xpack.securitySolution.anomaliesTable.table.anomaliesTooltip",{defaultMessage:"The anomalies table is not filterable via the SIEM global KQL search."}),l=r.i18n.translate("xpack.securitySolution.ml.table.scoreTitle",{defaultMessage:"Anomaly score"}),c=r.i18n.translate("xpack.securitySolution.ml.table.hostNameTitle",{defaultMessage:"Host name"}),u=r.i18n.translate("xpack.securitySolution.ml.table.userNameTitle",{defaultMessage:"User name"}),d=r.i18n.translate("xpack.securitySolution.ml.table.influencedByTitle",{defaultMessage:"Influenced by"}),p=r.i18n.translate("xpack.securitySolution.ml.table.entityTitle",{defaultMessage:"Entity"}),b=r.i18n.translate("xpack.securitySolution.ml.table.detectorTitle",{defaultMessage:"Job"}),m=r.i18n.translate("xpack.securitySolution.ml.table.networkNameTitle",{defaultMessage:"Network IP"}),g=r.i18n.translate("xpack.securitySolution.ml.table.timestampTitle",{defaultMessage:"Timestamp"})},354:function(e,t,a){"use strict";let r;a.d(t,"a",(function(){return r})),function(e){e.defineRule="define-rule",e.aboutRule="about-rule",e.scheduleRule="schedule-rule",e.ruleActions="rule-actions"}(r||(r={}))},382:function(e,t,a){"use strict";a.d(t,"g",(function(){return n})),a.d(t,"b",(function(){return s})),a.d(t,"d",(function(){return o})),a.d(t,"c",(function(){return i})),a.d(t,"f",(function(){return l})),a.d(t,"e",(function(){return c})),a.d(t,"a",(function(){return u})),a.d(t,"h",(function(){return d})),a.d(t,"i",(function(){return p}));var r=a(4);const n=r.i18n.translate("xpack.securitySolution.users.pageTitle",{defaultMessage:"Users"}),s=r.i18n.translate("xpack.securitySolution.users.navigation.allUsersTitle",{defaultMessage:"All users"}),o=r.i18n.translate("xpack.securitySolution.users.navigation.authenticationsTitle",{defaultMessage:"Authentications"}),i=r.i18n.translate("xpack.securitySolution.users.navigation.anomaliesTitle",{defaultMessage:"Anomalies"}),l=r.i18n.translate("xpack.securitySolution.users.navigation.riskTitle",{defaultMessage:"User risk"}),c=r.i18n.translate("xpack.securitySolution.users.navigation.eventsTitle",{defaultMessage:"Events"}),u=r.i18n.translate("xpack.securitySolution.users.navigation.alertsTitle",{defaultMessage:"External alerts"}),d=r.i18n.translate("xpack.securitySolution.users.navigation.userScoreOverTimeTitle",{defaultMessage:"User risk score over time"}),p=r.i18n.translate("xpack.securitySolution.hosts.navigaton.hostRisk.viewDashboardButtonLabel",{defaultMessage:"View source dashboard"})},391:function(e,t,a){"use strict";a.d(t,"a",(function(){return v}));var r=a(50),n=a.n(r),s=a(5),o=a.n(s),i=a(1),l=a(365),c=a.n(l),u=a(211),d=a(432),p=a(18),b=a(326),m=a(4);const g=m.i18n.translate("xpack.securitySolution.containers.anomalies.stackByJobId",{defaultMessage:"job"}),f=m.i18n.translate("xpack.securitySolution.containers.anomalies.title",{defaultMessage:"Anomalies"}),y=m.i18n.translate("xpack.securitySolution.containers.anomalies.errorFetchingAnomaliesData",{defaultMessage:"Failed to query anomalies data"});var T,w=a(107);const h=[{text:g,value:"job_id"}],O=g,k={defaultStackByOption:null!==(T=h.find((e=>e.text===O)))&&void 0!==T?T:h[0],errorMessage:y,hideHistogramIfEmpty:!0,histogramType:w.b.anomalies,stackByOptions:h,subtitle:void 0,title:f},S="anomaliesHistogramQuery",j=({deleteQuery:e,endDate:t,setQuery:a,skip:r,startDate:l,type:m,narrowDateRange:g,filterQuery:f,anomaliesFilterQuery:y,AnomaliesTableComponent:T,flowTarget:w,ip:h,hostName:O,userName:j,indexNames:v})=>{const{jobs:E}=Object(d.a)(),[P]=Object(p.p)(i.F),x=((e,t={},a=[],r,n,s)=>{const o=a.map((e=>e.id)).map((e=>({match_phrase:{job_id:e}}))),i=Object(u.a)(e),l=i?JSON.parse(i):{},d=c.a.all([l,t,{bool:{filter:[{bool:{should:o,minimum_should_match:1}},{match_phrase:{result_type:"record"}},n&&s&&{match_phrase:{[`${n}.ip`]:s}},{range:{record_score:{gte:r}}}]}}]);return JSON.stringify(d)})(f,y,E,P,w,h);return Object(s.useEffect)((()=>()=>{e&&e({id:S})}),[]),o.a.createElement(o.a.Fragment,null,o.a.createElement(b.a,n()({endDate:t,filterQuery:x,id:S,indexNames:v,setQuery:a,startDate:l},k)),o.a.createElement(T,{startDate:l,endDate:t,skip:r,type:m,narrowDateRange:g,flowTarget:w,ip:h,hostName:O,userName:j}))};j.displayName="AnomaliesQueryTabBodyComponent";const v=o.a.memo(j);v.displayName="AnomaliesQueryTabBody"},393:function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));var r=a(16),n=a(165),s=a(5),o=a.n(s),i=a(85),l=a.n(i),c=a(3),u=a(19),d=a(166),p=a(18),b=a(108),m=a(4);const g=m.i18n.translate("xpack.securitySolution.lastEventTime.errorSearchDescription",{defaultMessage:"An error has occurred on last event time search"}),f=m.i18n.translate("xpack.securitySolution.lastEventTime.failSearchDescription",{defaultMessage:"Failed to run search on last event time"});var y=a(192),T=a(193),w=a(201);const h=Object(s.memo)((({docValueFields:e,hostName:t,userName:a,indexKey:i,ip:m,indexNames:h})=>{const[O,{lastSeen:k,errorMessage:S}]=(({docValueFields:e,indexKey:t,indexNames:a,details:r})=>{const{data:n}=Object(p.j)().services,o=Object(s.useRef)(c.noop),i=Object(s.useRef)(new AbortController),m=Object(s.useRef)(new u.Subscription),[T,w]=Object(s.useState)(!1),[h,O]=Object(s.useState)({defaultIndex:a,docValueFields:e,factoryQueryType:b.c.lastEventTime,indexKey:t,details:r}),[k,S]=Object(s.useState)({lastSeen:null,refetch:o.current,errorMessage:void 0}),{addError:j,addWarning:v}=Object(y.a)(),E=Object(s.useCallback)((e=>{const t=async()=>{i.current=new AbortController,w(!0),m.current=n.search.search(e,{strategy:"timelineSearchStrategy",abortSignal:i.current.signal}).subscribe({next:e=>{Object(d.isCompleteResponse)(e)?(w(!1),S((t=>({...t,errorMessage:void 0,lastSeen:e.lastSeen,refetch:o.current})))):Object(d.isErrorResponse)(e)&&(w(!1),v(g))},error:e=>{w(!1),j(e,{title:f}),S((t=>({...t,errorMessage:e.message})))}})};m.current.unsubscribe(),i.current.abort(),t(),o.current=t}),[n.search,j,v]);return Object(s.useEffect)((()=>{O((n=>{const s={...n,defaultIndex:a,docValueFields:e,indexKey:t,details:r};return l()(n,s)?n:s}))}),[a,r,e,t]),Object(s.useEffect)((()=>(E(h),()=>{m.current.unsubscribe(),i.current.abort()})),[h,E]),[T,k]})({docValueFields:e,indexKey:i,indexNames:h,details:{hostName:t,ip:m,userName:a}});return null!=S?o.a.createElement(r.EuiToolTip,{position:"top",content:S,"data-test-subj":"last_event_time_error","aria-label":"last_event_time_error",id:`last_event_time_error-${i}`},o.a.createElement(r.EuiIcon,{"aria-describedby":`last_event_time_error-${i}`,type:"alert"})):o.a.createElement(o.a.Fragment,null,O&&o.a.createElement(r.EuiLoadingSpinner,{size:"m"}),O||null==k||"Invalid Date"!==new Date(k).toString()?!O&&null!=k&&o.a.createElement(n.FormattedMessage,{id:"xpack.securitySolution.headerPage.pageSubtitle",defaultMessage:"Last event: {beat}",values:{beat:o.a.createElement(w.b,{value:k})}}):k,!O&&null==k&&Object(T.d)())}));h.displayName="LastEventTime"},399:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var r=a(5),n=a(425),s=a(91),o=a(260),i=a(334);function l(){const e=Object(s.g)(),t=Object(n.b)(),a=Object(o.f)(i.a.getInstance(e),void 0,void 0,{enabled:!1}),{data:l,isFetching:c,refetch:u,isFetched:d}=a,p=Object(r.useMemo)((()=>t.canIsolateHost||Boolean(null==l?void 0:l.total)),[t.canIsolateHost,null==l?void 0:l.total]);return Object(r.useEffect)((()=>{t.canIsolateHost||t.loading||d||c||u()}),[u,d,c,t.canIsolateHost,t.loading]),p}},445:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));const r=e=>n(e)&&s(e)&&o(e)&&i(e),n=({capabilities:e})=>e.canGetDatafeeds&&e.canStartStopDatafeed&&e.canUpdateDatafeed&&e.canPreviewDatafeed,s=({capabilities:e})=>e.canCreateJob&&e.canGetJobs&&e.canUpdateJob&&e.canDeleteJob&&e.canOpenJob&&e.canCloseJob&&e.canForecastJob,o=({capabilities:e})=>e.canGetFilters&&e.canCreateFilter&&e.canDeleteFilter,i=({capabilities:e})=>e.canCreateCalendar&&e.canGetCalendars&&e.canDeleteCalendar},449:function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return o}));var r=a(5),n=a(63);const s=()=>{const e=Object(n.f)();return Object(r.useMemo)((()=>i(e)),[e])},o=e=>s().find((({id:t})=>t===e)),i=e=>e.map((e=>({id:e.id,title:e.title,...null!=e.categories?{categories:e.categories}:{},...null!=e.description?{description:e.description}:{},...!0===e.sideNavDisabled?{disabled:!0}:{},...null!=e.landingIcon?{icon:e.landingIcon}:{},...null!=e.landingImage?{image:e.landingImage}:{},...null!=e.skipUrlState?{skipUrlState:e.skipUrlState}:{},...e.links&&e.links.length?{links:i(e.links)}:{}})))},451:function(e,t,a){"use strict";a.r(t),a.d(t,"updateTableActivePage",(function(){return s})),a.d(t,"setHostTablesActivePageToZero",(function(){return o})),a.d(t,"setHostDetailsTablesActivePageToZero",(function(){return i})),a.d(t,"updateTableLimit",(function(){return l})),a.d(t,"updateHostsSort",(function(){return c})),a.d(t,"updateHostRiskScoreSort",(function(){return u})),a.d(t,"updateHostRiskScoreSeverityFilter",(function(){return d}));var r=a(41);const n=a.n(r)()("x-pack/security_solution/local/hosts"),s=n("UPDATE_HOST_TABLE_ACTIVE_PAGE"),o=n("SET_HOST_TABLES_ACTIVE_PAGE_TO_ZERO"),i=n("SET_HOST_DETAILS_TABLES_ACTIVE_PAGE_TO_ZERO"),l=n("UPDATE_HOST_TABLE_LIMIT"),c=n("UPDATE_HOSTS_SORT"),u=n("UPDATE_HOST_RISK_SCORE_SORT"),d=n("UPDATE_HOST_RISK_SCORE_SEVERITY")},470:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));const r=e=>`${e.entityName}-${e.entityValue}-${e.severity}-${e.jobId}`},471:function(e,t,a){"use strict";a.r(t),a.d(t,"setUsersTablesActivePageToZero",(function(){return s})),a.d(t,"setUsersDetailsTablesActivePageToZero",(function(){return o})),a.d(t,"updateTableLimit",(function(){return i})),a.d(t,"updateTableActivePage",(function(){return l})),a.d(t,"updateTableSorting",(function(){return c})),a.d(t,"updateUserRiskScoreSeverityFilter",(function(){return u}));var r=a(41);const n=a.n(r)()("x-pack/security_solution/local/users"),s=n("SET_USERS_TABLES_ACTIVE_PAGE_TO_ZERO"),o=n("SET_USERS_DETAILS_TABLES_ACTIVE_PAGE_TO_ZERO"),i=n("UPDATE_USERS_TABLE_LIMIT"),l=n("UPDATE_USERS_ACTIVE_PAGE"),c=n("UPDATE_USERS_SORTING"),u=n("UPDATE_USERS_RISK_SEVERITY_FILTER")},472:function(e,t,a){"use strict";a.d(t,"i",(function(){return n})),a.d(t,"f",(function(){return s})),a.d(t,"e",(function(){return o})),a.d(t,"b",(function(){return i})),a.d(t,"h",(function(){return l})),a.d(t,"g",(function(){return c})),a.d(t,"d",(function(){return u})),a.d(t,"c",(function(){return d})),a.d(t,"a",(function(){return p}));var r=a(4);r.i18n.translate("xpack.securitySolution.network.kqlPlaceholder",{defaultMessage:'e.g. source.ip: "foo"'});const n=r.i18n.translate("xpack.securitySolution.network.pageTitle",{defaultMessage:"Network"}),s=r.i18n.translate("xpack.securitySolution.network.navigation.flowsTitle",{defaultMessage:"Flows"}),o=r.i18n.translate("xpack.securitySolution.network.navigation.dnsTitle",{defaultMessage:"DNS"}),i=r.i18n.translate("xpack.securitySolution.hosts.navigation.dns.histogram.errorFetchingDnsData",{defaultMessage:"Failed to query DNS data"}),l=r.i18n.translate("xpack.securitySolution.network.navigation.tlsTitle",{defaultMessage:"TLS"}),c=r.i18n.translate("xpack.securitySolution.network.navigation.httpTitle",{defaultMessage:"HTTP"}),u=r.i18n.translate("xpack.securitySolution.network.navigation.anomaliesTitle",{defaultMessage:"Anomalies"}),d=r.i18n.translate("xpack.securitySolution.network.navigation.alertsTitle",{defaultMessage:"External alerts"}),p=e=>r.i18n.translate("xpack.securitySolution.network.dns.stackByUniqueSubdomain",{values:{groupByField:e},defaultMessage:"Top domains by {groupByField}"})},493:function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));var r=a(5),n=a(1),s=a(445),o=a(366),i=a(192),l=a(18),c=a(817);const u=["siem_cloudtrail","siem_packetbeat","security_auth","security_linux_v3","security_network","security_windows_v3"],d=(e,t,a)=>{const r=t.find((t=>t.id===e));return void 0!==r?{moduleId:r.moduleId,defaultIndexPattern:r.defaultIndexPattern,isCompatible:a.includes(r.moduleId),isElasticJob:!0}:{moduleId:"",defaultIndexPattern:"",isCompatible:!0,isElasticJob:!1}};var p=a(235),b=a(519),m=a(680);const g=e=>{const[t,a]=Object(r.useState)([]),[g,f]=Object(r.useState)(!0),y=Object(p.a)(),[T]=Object(l.p)(n.N),w=Object(l.i)(),{addError:h}=Object(i.a)(),O=Object(s.a)(y),k=Object(o.a)(y);return Object(r.useEffect)((()=>{let e=!0;const t=new AbortController;return f(!0),async function(){if(O&&k)try{const[r,n,s]=await Promise.all([Object(m.a)({http:w,signal:t.signal}),Object(c.b)({signal:t.signal}),Object(c.a)({indexPatternName:T,signal:t.signal})]),o=((e,t,a)=>{const r=a.map((e=>e.id)),n=((e,t)=>e.filter((e=>u.includes(e.id))).map((e=>[...e.jobs.map((a=>((e,t,a)=>({datafeedId:"",datafeedIndices:[],datafeedState:"",hasDatafeed:!1,isSingleMetricViewerJob:!1,jobState:"closed",memory_status:"",processed_record_count:0,id:t.id,description:t.config.description,groups:[...t.config.groups].sort(),defaultIndexPattern:e.defaultIndexPattern,moduleId:e.id,isCompatible:a,isInstalled:!1,isElasticJob:!0,awaitingNodeAssignment:!1,jobTags:{},bucketSpanSeconds:900}))(e,a,t.includes(e.id))))])).flat())(t,r),s=((e,t,a)=>e.filter((({groups:e})=>e.includes("siem")||e.includes("security"))).map((e=>({...e,...d(e.id,t,a),isInstalled:!0}))))(e,n,r);return((e,t)=>{const a=e.map((e=>e.id));return[...e,...t.filter((e=>!a.includes(e.id)))].sort(((e,t)=>e.id.localeCompare(t.id)))})(s,n)})(r,n,s);e&&a(o)}catch(t){e&&h(t,{title:b.a})}e&&f(!1)}(),()=>{e=!1,t.abort()}}),[e,O,k,T,h,w]),{isLicensed:k,isMlAdmin:O,jobs:t,loading:g}}},518:function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var r=a(5),n=a.n(r),s=a(16),o=a(23),i=a.n(o);const l=i()(s.EuiFlexGroup).withConfig({displayName:"PopoverItemsWrapper",componentId:"sc-3vrhxe-0"})(["width:100%;"]),c=i()(s.EuiBadgeGroup).withConfig({displayName:"PopoverWrapper",componentId:"sc-3vrhxe-1"})(["max-height:200px;max-width:600px;overflow:auto;line-height:",";"],(({theme:e})=>e.eui.euiLineHeight)),u=({items:e,renderItem:t,popoverTitle:a,popoverButtonTitle:o,popoverButtonIcon:i,numberOfItemsToDisplay:u=0,dataTestPrefix:d="items"})=>{const[p,b]=Object(r.useState)(!1),m=({items:e})=>n.a.createElement(n.a.Fragment,null,e.map(t));return e.length<=u?n.a.createElement(l,{"data-test-subj":d,alignItems:"center",gutterSize:"s"},n.a.createElement(m,{items:e})):n.a.createElement(l,{alignItems:"center",gutterSize:"s","data-test-subj":d},0!==u&&n.a.createElement(s.EuiFlexItem,{grow:1,className:"eui-textTruncate"},n.a.createElement(m,{items:e.slice(0,u)})),n.a.createElement(s.EuiPopover,{ownFocus:!0,"data-test-subj":`${d}DisplayPopover`,button:n.a.createElement(s.EuiBadge,{iconType:i,color:"hollow","data-test-subj":`${d}DisplayPopoverButton`,onClick:()=>b(!p),onClickAriaLabel:o},o),isOpen:p,closePopover:()=>b(!p),repositionOnScroll:!0},a?n.a.createElement(s.EuiPopoverTitle,{"data-test-subj":`${d}DisplayPopoverTitle`},a):null,n.a.createElement(c,{"data-test-subj":`${d}DisplayPopoverWrapper`},n.a.createElement(m,{items:e.slice(u)}))))},d=n.a.memo(u);d.displayName="PopoverItems";const p=d},520:function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var r=a(5),n=a(4),s=a(42),o=a(73),i=a(71),l=a(194),c=a(13),u=a(443),d=a(29),p=a(444),b=a(192);const m=()=>{const{indicesExist:e}=Object(l.d)(c.SourcererScopeName.detections),{indexFieldsSearch:t}=Object(p.b)(),a=Object(s.useDispatch)(),{addError:m}=Object(b.a)(),g=Object(r.useRef)(new AbortController),f=Object(r.useMemo)((()=>o.f.defaultDataViewSelector()),[]),y=Object(r.useMemo)((()=>o.f.signalIndexNameSelector()),[]),T=Object(i.a)(y),w=Object(i.a)(f),h=Object(r.useMemo)((()=>!w.title.includes(`${T}`)),[w.title,T]),O=Object(r.useMemo)((()=>!e&&!h),[e,h]),k=Object(r.useCallback)((()=>{null!==T&&(g.current.abort(),(async()=>{g.current=new AbortController;try{const e=await Object(u.b)({body:{patternList:w.title.split(",")},signal:g.current.signal});null!==T&&e.defaultDataView.patternList.includes(T)&&(t({dataViewId:e.defaultDataView.id}),a(d.a.setSourcererDataViews(e)))}catch(e){m(e,{title:n.i18n.translate("xpack.securitySolution.sourcerer.error.title",{defaultMessage:"Error updating Security Data View"}),toastMessage:n.i18n.translate("xpack.securitySolution.sourcerer.error.toastMessage",{defaultMessage:"Refresh the page"})})}})())}),[m,w.title,a,t,T]);return{...O?{pollForSignalIndex:k}:{},signalIndexNeedsInit:h}}},525:function(e,t,a){"use strict";a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return d}));var r=a(3),n=a(283),s=a(225),o=a(336),i=a(369),l=a(8);const c=n.b.HostsType.details,u={[s.HostsTableType.hosts]:i.e,[s.HostsTableType.authentications]:i.g,[s.HostsTableType.uncommonProcesses]:i.k,[s.HostsTableType.anomalies]:i.f,[s.HostsTableType.events]:i.h,[s.HostsTableType.alerts]:i.d,[s.HostsTableType.risk]:i.i,[s.HostsTableType.sessions]:i.j},d=(e,t)=>{let a=[];if(null!=e.detailName&&(a=[...a,{text:e.detailName,href:t({path:Object(o.a)(e.detailName,""),deepLinkId:l.a.hosts})}]),null!=e.tabName){const t=Object(r.get)("tabName",e);if(!t)return a;a=[...a,{text:u[t],href:""}]}return a}},526:function(e,t,a){"use strict";a.d(t,"c",(function(){return s})),a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return i}));var r=a(368),n=a(225);const s=e=>({...e.page.queries,[n.HostsTableType.authentications]:{...e.page.queries[n.HostsTableType.authentications],activePage:r.a},[n.HostsTableType.hosts]:{...e.page.queries[n.HostsTableType.hosts],activePage:r.a},[n.HostsTableType.events]:{...e.page.queries[n.HostsTableType.events],activePage:r.a},[n.HostsTableType.uncommonProcesses]:{...e.page.queries[n.HostsTableType.uncommonProcesses],activePage:r.a},[n.HostsTableType.alerts]:{...e.page.queries[n.HostsTableType.alerts],activePage:r.a}}),o=e=>({...e.details.queries,[n.HostsTableType.authentications]:{...e.details.queries[n.HostsTableType.authentications],activePage:r.a},[n.HostsTableType.hosts]:{...e.details.queries[n.HostsTableType.hosts],activePage:r.a},[n.HostsTableType.events]:{...e.details.queries[n.HostsTableType.events],activePage:r.a},[n.HostsTableType.uncommonProcesses]:{...e.details.queries[n.HostsTableType.uncommonProcesses],activePage:r.a},[n.HostsTableType.alerts]:{...e.page.queries[n.HostsTableType.alerts],activePage:r.a}}),i=e=>e.length>0?[{query:{bool:{should:e.map((e=>({match_phrase:{"risk.keyword":{query:e}}})))}},meta:{alias:null,disabled:!1,negate:!1}}]:[]},560:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var r=a(23),n=a.n(r),s=a(16);const o=n()(s.EuiInMemoryTable).withConfig({displayName:"BasicTable",componentId:"sc-1c8nyx9-0"})(["tbody{th,td{vertical-align:top;}.euiTableCellContent{display:block;}}"]);o.displayName="BasicTable"},561:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));const r=(e,t)=>e.startDate===t.startDate&&e.endDate===t.endDate&&e.skip===t.skip},562:function(e,t,a){"use strict";a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return c}));var r=a(246),n=a(205),s=a(8),o=a(1),i=a(354);const l=[i.a.defineRule,i.a.aboutRule,i.a.scheduleRule,i.a.ruleActions],c=(e,t)=>{var a,i;let l=[];var c;return e.detailName&&null!==(a=e.state)&&void 0!==a&&a.ruleName&&(l=[...l,{text:e.state.ruleName,href:t({deepLinkId:s.a.rules,path:Object(r.c)(e.detailName,"")})}]),(c=e.pathName).includes(o.Ub)&&c.includes("/create")&&(l=[...l,{text:n.e,href:""}]),(e=>e.includes(o.Ub)&&e.includes("/edit"))(e.pathName)&&e.detailName&&null!==(i=e.state)&&void 0!==i&&i.ruleName&&(l=[...l,{text:n.tb,href:""}]),l}},624:function(e,t,a){"use strict";a.d(t,"a",(function(){return T}));var r=a(5),n=a.n(r),s=a(16),o=a(242),i=a(30),l=a(249),c=a(204);const u=({idPrefix:e,entityName:t,entityValue:a})=>{const s=Object(c.h)(`entity-draggable-${e}-${t}-${a}`),u=Object(r.useMemo)((()=>({and:[],enabled:!0,id:s,name:a,excluded:!1,kqlQuery:"",queryMatch:{field:t,value:a,operator:i.c}})),[t,a,s]),d=Object(r.useCallback)(((e,r,s)=>s.isDragging?n.a.createElement(o.a,null,n.a.createElement(l.a,{dataProvider:e})):n.a.createElement(n.a.Fragment,null,`${t}: "${a}"`)),[t,a]);return n.a.createElement(o.b,{key:s,dataProvider:u,render:d,isAggregatable:!0,fieldType:"keyword"})};u.displayName="EntityDraggableComponent";const d=n.a.memo(u);d.displayName="EntityDraggable";var p=a(470),b=a(353),m=a(418),g=a(748),f=a(750),y=a(201);const T=(e,t)=>[{name:b.b,field:"anomaly.jobId",sortable:!0,render:(a,r)=>n.a.createElement(f.a,{score:r.anomaly,startDate:e,endDate:t,linkName:a})},{name:b.g,field:"anomaly.severity",sortable:!0,render:(e,t)=>n.a.createElement(g.a,{id:Object(c.h)(`anomalies-table-severity-${Object(p.a)(t.anomaly)}`),score:t.anomaly})},{name:b.c,field:"anomaly.entityValue",sortable:!0,render:(e,t)=>n.a.createElement(d,{idPrefix:`anomalies-table-entityValue${Object(p.a)(t.anomaly)}-entity`,entityName:t.anomaly.entityName,entityValue:e})},{name:b.e,field:"anomaly.influencers",render:(e,t)=>n.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"none",responsive:!1},e&&e.map((e=>{const[a,r]=Object(m.a)(e),o=null!=a?a:"",i=null!=r?r:"";return n.a.createElement(s.EuiFlexItem,{key:`${o}-${i}-${Object(p.a)(t.anomaly)}`,grow:!1},n.a.createElement(s.EuiFlexGroup,{gutterSize:"none",responsive:!1},n.a.createElement(s.EuiFlexItem,{grow:!1},n.a.createElement(d,{idPrefix:`anomalies-table-influencers-${o}-${i}-${Object(p.a)(t.anomaly)}`,entityName:o,entityValue:i}))))})))},{name:b.i,field:"anomaly.time",sortable:!0,render:e=>n.a.createElement(y.b,{value:e})}]},649:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return l}));var r=a(14),n=a(75),s=a(31),o=a(87);const i=[{columnHeaderType:n.a,id:"@timestamp",initialWidth:s.b},{columnHeaderType:n.a,id:"event.module",linkField:"rule.reference"},{columnHeaderType:n.a,id:"event.dataset"},{columnHeaderType:n.a,id:"event.category"},{columnHeaderType:n.a,id:"event.severity"},{columnHeaderType:n.a,id:"observer.name"},{columnHeaderType:n.a,id:"host.name"},{columnHeaderType:n.a,id:"message"},{columnHeaderType:n.a,id:"agent.id"},{columnHeaderType:n.a,id:"agent.type"}],l={...o.a,columns:i,excludedRowRendererIds:Object.values(r.d)}},679:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));const r=(e,t,a)=>{const r=t.indexOf(e),n=[...t];r>=0?n.splice(r,1):n.push(e),a(n)}},693:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var r=a(5),n=a(296);const s=Object(n.c)(),o=()=>{const[e]=Object(r.useState)(s);return{globalKQLHeaderPortalNode:e}}},768:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var r=a(16),n=a(23);const s=a.n(n)()(r.EuiFlexGroup).withConfig({displayName:"ConditionalFlexGroup",componentId:"sc-jyindk-0"})(["@media only screen and (min-width:1441px){flex-direction:row !important;}"]);s.displayName="ConditionalFlexGroup"},769:function(e,t,a){"use strict";a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return d}));var r=a(3),n=a(306),s=a(233),o=a(692),i=a(382),l=a(8);const c=n.c.UsersType.details,u={[s.UsersTableType.allUsers]:i.b,[s.UsersTableType.authentications]:i.d,[s.UsersTableType.anomalies]:i.c,[s.UsersTableType.risk]:i.f,[s.UsersTableType.events]:i.e,[s.UsersTableType.alerts]:i.a,[s.UsersTableType.risk]:i.f},d=(e,t)=>{let a=[];if(null!=e.detailName&&(a=[{text:e.detailName,href:t({path:Object(o.b)(e.detailName,""),deepLinkId:l.a.users})}]),null!=e.tabName){const t=Object(r.get)("tabName",e);if(!t)return a;a=[...a,{text:u[t],href:""}]}return a}},800:function(e,t,a){"use strict";a.d(t,"b",(function(){return tt})),a.d(t,"a",(function(){return nt}));var r=a(16),n=a(5),s=a.n(n),o=a(42),i=a(58),l=a(166),c=a(71),u=a(72),d=a(213),p=a(308),b=a(241),m=a(393),g=a(392),f=a(753),y=a(276),T=a(805),w=a(203),h=a(23),O=a.n(h),k=a(402),S=a(4);const j=S.i18n.translate("xpack.securitySolution.components.flowControls.selectFlowTarget.sourceDropDownOptionLabel",{defaultMessage:"Source"}),v=S.i18n.translate("xpack.securitySolution.components.flowControls.selectFlowTarget.destinationDropDownOptionLabel",{defaultMessage:"Destination"}),E=S.i18n.translate("xpack.securitySolution.components.flowControls.selectFlowTarget.clientDropDownOptionLabel",{defaultMessage:"CLIENT"}),P=S.i18n.translate("xpack.securitySolution.components.flowControls.selectFlowTarget.serverDropDownOptionLabel",{defaultMessage:"SERVER"}),x=(S.i18n.translate("xpack.securitySolution.components.flowControls.selectFlowDirection.unidirectionalButtonLabel",{defaultMessage:"Unidirectional"}),S.i18n.translate("xpack.securitySolution.components.flowControls.selectFlowDirection.bidirectionalButtonLabel",{defaultMessage:"Bidirectional"}),(e,t)=>[{id:`${e}-select-flow-target-${u.d.source}`,value:u.d.source,inputDisplay:t[0]||j,directions:[u.c.uniDirectional,u.c.biDirectional]},{id:`${e}-select-flow-target-${u.d.destination}`,value:u.d.destination,inputDisplay:t[1]||v,directions:[u.c.uniDirectional,u.c.biDirectional]},{id:`${e}-select-flow-target-${u.d.client}`,value:u.d.client,inputDisplay:t[2]||E,directions:[u.c.biDirectional]},{id:`${e}-select-flow-target-${u.d.server}`,value:u.d.server,inputDisplay:t[3]||P,directions:[u.c.biDirectional]}]),C=({id:e,isLoading:t=!1,selectedDirection:a,selectedTarget:n,displayTextOverride:o=[],updateFlowTargetAction:i})=>s.a.createElement(r.EuiSuperSelect,{options:a?x(e,o).filter((e=>e.directions.includes(a))):x(e,o),valueOfSelected:n,onChange:i,isLoading:t}),I=s.a.memo(C);var N=a(346);const D=O()(r.EuiFlexItem).withConfig({displayName:"SelectTypeItem",componentId:"sc-12qgll-0"})(["min-width:180px;"]);D.displayName="SelectTypeItem";const M=({flowTarget:e})=>{const t=Object(i.useHistory)(),a=Object(i.useLocation)(),r=Object(n.useCallback)((r=>{const n=((e,t,a)=>`${e.pathname.replace(t,a)}${e.search}`)(a,e,r);t.push(n)}),[t,a,e]);return s.a.createElement(D,{grow:!1,"data-test-subj":`${N.b}-select-flow-target`},s.a.createElement(I,{id:N.b,isLoading:!e,selectedDirection:u.c.uniDirectional,selectedTarget:e,displayTextOverride:[k.b,k.a],updateFlowTargetAction:r}))},R=s.a.memo(M);var F=a(752),$=a(295),A=a(88),Q=a(841),_=a(18),H=a(97),q=a(231),U=a(768),L=a(73),B=a(22),V=a(467),z=a(218),G=a(3),J=a(849),Z=a(826),W=a(197);const K=Object(w.a)(Z.a),X=({endDate:e,filterQuery:t,indexNames:a,ip:r,setQuery:o,skip:i,startDate:l,type:c})=>{const{toggleStatus:u}=Object(W.a)(J.a),[d,p]=Object(n.useState)(i||!u);Object(n.useEffect)((()=>{p(i||!u)}),[i,u]);const[b,{id:m,inspect:g,isInspected:f,loadPage:y,networkHttp:T,pageInfo:w,refetch:h,totalCount:O}]=Object(J.b)({endDate:e,filterQuery:t,indexNames:a,ip:r,skip:d,startDate:l,type:c});return s.a.createElement(K,{data:T,fakeTotalCount:Object(G.getOr)(50,"fakeTotalCount",w),id:m,inspect:g,isInspect:f,loading:b,loadPage:y,refetch:h,setQuery:o,setQuerySkip:p,showMorePagesIndicator:Object(G.getOr)(!1,"showMorePagesIndicator",w),totalCount:O,type:c})};X.displayName="NetworkHttpQueryTable";var Y=a(850),ee=a(827);const te=Object(w.a)(ee.a),ae=({endDate:e,filterQuery:t,flowTarget:a,indexNames:r,ip:o,setQuery:i,skip:l,startDate:c,type:u,indexPattern:d})=>{const{toggleStatus:p}=Object(W.a)(`${Y.a}-${a}`),[b,m]=Object(n.useState)(l||!p);Object(n.useEffect)((()=>{m(l||!p)}),[l,p]);const[g,{id:f,inspect:y,isInspected:T,loadPage:w,networkTopCountries:h,pageInfo:O,refetch:k,totalCount:S}]=Object(Y.b)({endDate:e,flowTarget:a,filterQuery:t,indexNames:r,ip:o,skip:b,startDate:c,type:u});return s.a.createElement(te,{data:h,fakeTotalCount:Object(G.getOr)(50,"fakeTotalCount",O),flowTargeted:a,id:f,indexPattern:d,inspect:y,isInspect:T,loading:g,loadPage:w,refetch:k,setQuery:i,setQuerySkip:m,showMorePagesIndicator:Object(G.getOr)(!1,"showMorePagesIndicator",O),totalCount:S,type:u})};ae.displayName="NetworkTopCountriesQueryTable";var re=a(828),ne=a(851);const se=Object(w.a)(re.a),oe=({endDate:e,filterQuery:t,flowTarget:a,ip:r,indexNames:o,setQuery:i,skip:l,startDate:c,type:u})=>{const{toggleStatus:d}=Object(W.a)(`${ne.a}-${a}`),[p,b]=Object(n.useState)(l||!d);Object(n.useEffect)((()=>{b(l||!d)}),[l,d]);const[m,{id:g,inspect:f,isInspected:y,loadPage:T,networkTopNFlow:w,pageInfo:h,refetch:O,totalCount:k}]=Object(ne.b)({endDate:e,filterQuery:t,flowTarget:a,indexNames:o,ip:r,skip:p,startDate:c,type:u});return s.a.createElement(se,{data:w,fakeTotalCount:Object(G.getOr)(50,"fakeTotalCount",h),flowTargeted:a,id:g,inspect:f,isInspect:y,loading:m,loadPage:T,refetch:O,setQuery:i,setQuerySkip:b,showMorePagesIndicator:Object(G.getOr)(!1,"showMorePagesIndicator",h),totalCount:k,type:u})};oe.displayName="NetworkTopNFlowQueryTable";var ie=a(829),le=a(852);const ce=Object(w.a)(ie.a),ue=({endDate:e,filterQuery:t,flowTarget:a,indexNames:r,ip:o,setQuery:i,skip:l,startDate:c,type:u})=>{const{toggleStatus:d}=Object(W.a)(le.a),[p,b]=Object(n.useState)(l||!d);Object(n.useEffect)((()=>{b(l||!d)}),[l,d]);const[m,{id:g,inspect:f,isInspected:y,tls:T,totalCount:w,pageInfo:h,loadPage:O,refetch:k}]=Object(le.b)({endDate:e,filterQuery:t,flowTarget:a,indexNames:r,ip:o,skip:p,startDate:c,type:u});return s.a.createElement(ce,{data:T,id:g,inspect:f,isInspect:y,fakeTotalCount:Object(G.getOr)(50,"fakeTotalCount",h),loading:m,loadPage:O,showMorePagesIndicator:Object(G.getOr)(!1,"showMorePagesIndicator",h),refetch:k,setQuery:i,setQuerySkip:b,totalCount:w,type:u})};ue.displayName="TlsQueryTable";var de=a(85),pe=a.n(de),be=a(19),me=a(1),ge=a(211),fe=a(294),ye=a(214),Te=a(94);const we=S.i18n.translate("xpack.securitySolution.networkUsers.errorSearchDescription",{defaultMessage:"An error has occurred on network users search"}),he=S.i18n.translate("xpack.securitySolution.networkUsers.failSearchDescription",{defaultMessage:"Failed to run search on network users"});var Oe=a(74),ke=a(192);const Se="networkUsersQuery";var je=a(2),ve=a(262),Ee=a(193);const Pe=S.i18n.translate("xpack.securitySolution.network.ipDetails.usersTable.usersTitle",{defaultMessage:"Users"}),xe=e=>S.i18n.translate("xpack.securitySolution.network.ipDetails.usersTable.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {user} other {users}}"}),Ce=S.i18n.translate("xpack.securitySolution.network.ipDetails.usersTable.columns.userNameTitle",{defaultMessage:"User"}),Ie=S.i18n.translate("xpack.securitySolution.network.ipDetails.usersTable.columns.userIdTitle",{defaultMessage:"ID"}),Ne=S.i18n.translate("xpack.securitySolution.network.ipDetails.usersTable.columns.groupNameTitle",{defaultMessage:"Group name"}),De=S.i18n.translate("xpack.securitySolution.network.ipDetails.usersTable.columns.groupIdTitle",{defaultMessage:"Group ID"}),Me=S.i18n.translate("xpack.securitySolution.network.ipDetails.usersTable.columns.documentCountTitle",{defaultMessage:"Document count"}),Re=S.i18n.translate("xpack.securitySolution.network.ipDetails.usersTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),Fe=S.i18n.translate("xpack.securitySolution.network.ipDetails.usersTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"});var $e=a(258);const Ae=ye.c.NetworkDetailsTableType.users,Qe=[{text:Re,numberOfRow:5},{text:Fe,numberOfRow:10}],_e="users-table",He=({data:e,fakeTotalCount:t,flowTarget:a,id:r,isInspect:i,loading:l,loadPage:u,setQuerySkip:d,showMorePagesIndicator:p,totalCount:b,type:m})=>{const g=Object(o.useDispatch)(),f=Object(n.useMemo)((()=>ye.e.usersSelector()),[]),{activePage:y,sort:T,limit:w}=Object(c.a)(f),h=Object(n.useCallback)((e=>g(ye.b.updateNetworkTable({networkType:m,tableType:Ae,updates:{limit:e}}))),[g,m]),O=Object(n.useCallback)((e=>g(ye.b.updateNetworkTable({networkType:m,tableType:Ae,updates:{activePage:e}}))),[g,m]),k=Object(n.useCallback)((e=>{if(null!=e.sort){const t=e.sort.field.split("."),a={field:Le(t[t.length-1]),direction:e.sort.direction};pe()(a,T)||g(ye.b.updateNetworkTable({networkType:m,tableType:Ae,updates:{sort:a}}))}}),[g,T,m]),S=Object(n.useMemo)((()=>((e,t)=>[{field:"node.user.name",name:Ce,truncateText:!1,mobileOptions:{show:!0},sortable:!0,render:a=>Object($e.b)({rowItem:a,attrName:"user.name",idPrefix:`${t}-table-${e}-user`,isAggregatable:!0,fieldType:"keyword"})},{field:"node.user.id",name:Ie,truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:a=>Object($e.c)({rowItems:a,attrName:"user.id",idPrefix:`${t}-table-${e}`,isAggregatable:!0,fieldType:"keyword"})},{field:"node.user.groupName",name:Ne,truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:a=>Object($e.c)({rowItems:a,attrName:"user.group.name",idPrefix:`${t}-table-${e}`,isAggregatable:!0,fieldType:"keyword"})},{field:"node.user.groupId",name:De,truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:a=>Object($e.c)({rowItems:a,attrName:"user.group.id",idPrefix:`${t}-table-${e}`,isAggregatable:!0,fieldType:"keyword"})},{align:"right",field:"node.user.count",name:Me,truncateText:!1,mobileOptions:{show:!0},sortable:!0,render:e=>Object(Ee.a)(e)}])(a,_e)),[a,_e]);return s.a.createElement(ve.a,{activePage:y,columns:S,dataTestSubj:`table-${Ae}`,showMorePagesIndicator:p,headerCount:b,headerTitle:Pe,headerUnit:xe(b),id:r,isInspect:i,itemsPerRow:Qe,limit:w,loading:l,loadPage:u,onChange:k,pageOfItems:e,setQuerySkip:d,sorting:Ue(T),totalCount:t,updateActivePage:O,updateLimitPagination:h})};He.displayName="UsersTableComponent";const qe=s.a.memo(He),Ue=e=>{switch(e.field){case u.r.name:case u.r.count:return{field:`node.user.${e.field}`,direction:e.direction}}return Object(je.a)(e.field)},Le=e=>{switch(e){case u.r.name.valueOf():return u.r.name;case u.r.count.valueOf():return u.r.count;default:return u.r.name}},Be=Object(w.a)(qe),Ve=({endDate:e,filterQuery:t,flowTarget:a,ip:r,setQuery:o,skip:i,startDate:u,type:d})=>{const{toggleStatus:p}=Object(W.a)(Se),[b,m]=Object(n.useState)(i||!p);Object(n.useEffect)((()=>{m(i||!p)}),[i,p]);const[g,{id:f,inspect:y,isInspected:T,networkUsers:w,totalCount:h,pageInfo:O,loadPage:k,refetch:S}]=(({endDate:e,filterQuery:t,flowTarget:a,id:r=Se,ip:s,skip:o,startDate:i})=>{const u=Object(n.useMemo)((()=>ye.e.usersSelector()),[]),{activePage:d,sort:p,limit:b}=Object(c.a)(u),{data:m,uiSettings:g}=Object(_.j)().services,f=Object(n.useRef)(G.noop),y=Object(n.useRef)(new AbortController),T=Object(n.useRef)(new be.Subscription),w=g.get(me.N),[h,O]=Object(n.useState)(!1),[k,S]=Object(n.useState)(null),j=Object(n.useCallback)((e=>{S((t=>t?{...t,pagination:Object(fe.a)(e,b)}:t))}),[b]),[v,E]=Object(n.useState)({networkUsers:[],id:r,inspect:{dsl:[],response:[]},isInspected:!1,loadPage:j,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1},refetch:f.current,totalCount:-1}),{addError:P,addWarning:x}=Object(ke.a)(),C=Object(n.useCallback)((e=>{if(null==e||o)return;const t=async()=>{y.current=new AbortController,O(!0),T.current=m.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:y.current.signal}).subscribe({next:e=>{Object(l.isCompleteResponse)(e)?(O(!1),E((t=>({...t,networkUsers:e.edges,inspect:Object(Oe.c)(e,t.inspect),pageInfo:e.pageInfo,refetch:f.current,totalCount:e.totalCount}))),T.current.unsubscribe()):Object(l.isErrorResponse)(e)&&(O(!1),x(we),T.current.unsubscribe())},error:e=>{O(!1),P(e,{title:he}),T.current.unsubscribe()}})};T.current.unsubscribe(),y.current.abort(),t(),f.current=t}),[m.search,P,x,o]);return Object(n.useEffect)((()=>{S((r=>{const n={...null!=r?r:{},ip:s,defaultIndex:w,factoryQueryType:Te.g.users,filterQuery:Object(ge.a)(t),flowTarget:a,pagination:Object(fe.a)(d,b),sort:p,timerange:{interval:"12h",from:i,to:e}};return pe()(r,n)?r:n}))}),[d,w,e,t,b,i,p,s,a]),Object(n.useEffect)((()=>(C(k),()=>{T.current.unsubscribe(),y.current.abort()})),[k,C]),Object(n.useEffect)((()=>{o&&(O(!1),T.current.unsubscribe(),y.current.abort())}),[o]),[h,v]})({endDate:e,filterQuery:t,flowTarget:a,ip:r,skip:b,startDate:u});return s.a.createElement(Be,{data:w,id:f,inspect:y,isInspect:T,flowTarget:a,fakeTotalCount:Object(G.getOr)(50,"fakeTotalCount",O),loading:g,loadPage:k,showMorePagesIndicator:Object(G.getOr)(!1,"showMorePagesIndicator",O),refetch:S,setQuery:o,setQuerySkip:m,totalCount:h,type:d})};Ve.displayName="UsersQueryTable";var ze=a(391),Ge=a(8),Je=a(194),Ze=a(265),We=a(278),Ke=a(448),Xe=a(472),Ye=a(339);ye.c.NetworkType.details;const et={[Ye.a.alerts]:Xe.c,[Ye.a.anomalies]:Xe.d,[Ye.a.flows]:Xe.f,[Ye.a.dns]:Xe.e,[Ye.a.http]:Xe.g,[Ye.a.tls]:Xe.h},tt=(e,t)=>{let a=[];null!=e.detailName&&(a=[{text:Object(H.c)(e.detailName),href:t({deepLinkId:Ge.a.network,path:Object(Ke.a)(e.detailName,e.flowTarget,"")})}]);const r=Object(G.get)("tabName",e);return r?(a=[...a,{text:et[r],href:""}],a):a},at=Object(w.a)(F.a),rt=()=>{const e=Object(o.useDispatch)(),{to:t,from:a,setQuery:w,isInitializing:h}=Object(d.a)(),{detailName:O,flowTarget:k}=Object(i.useParams)(),S=Object(n.useMemo)((()=>L.e.globalQuerySelector()),[]),j=Object(n.useMemo)((()=>L.e.globalFiltersQuerySelector()),[]),v=Object(c.a)(S),E=Object(c.a)(j),P=ye.c.NetworkType.details,x=Object(n.useCallback)(((t,a)=>{const r=Object(y.a)(t,a);e(Object(B.setAbsoluteRangeDatePicker)({id:"global",from:r.from,to:r.to}))}),[e]),{services:{uiSettings:C}}=Object(_.j)();Object(n.useEffect)((()=>{e(Object(V.setNetworkDetailsTablesActivePageToZero)())}),[O,e]);const{docValueFields:I,indicesExist:N,indexPattern:D,selectedPatterns:M}=Object(Je.d)(),F=Object(H.c)(O),[G,J]=Object(q.b)({config:Object(l.getEsQueryConfig)(C),indexPattern:D,queries:[v],filters:E});Object(Ze.a)({id:Q.a,filterQuery:G,kqlError:J,query:v,startDate:a,endDate:t});const[Z,{id:W,inspect:K,networkDetails:Y,refetch:ee}]=Object(Q.b)({docValueFields:I,skip:h,filterQuery:G,indexNames:M,ip:F}),[te,re]=Object(g.a)({criteriaFields:Object(f.a)(O,k),startDate:a,endDate:t,skip:h}),ne=Object(n.useMemo)((()=>({field:`${k}.ip`,value:F})),[k,F]),se=Object(n.useMemo)((()=>h||void 0===G),[h,G]);return s.a.createElement("div",{"data-test-subj":"network-details-page"},N?s.a.createElement(s.a.Fragment,null,s.a.createElement(p.a,null,s.a.createElement($.a,{indexPattern:D,id:"global"})),s.a.createElement(A.a,null,s.a.createElement(b.a,{border:!0,"data-test-subj":"network-details-headline",draggableArguments:ne,subtitle:s.a.createElement(m.a,{docValueFields:I,indexKey:u.i.ipDetails,indexNames:M,ip:F}),title:F},s.a.createElement(R,{flowTarget:k})),s.a.createElement(at,{id:W,inspect:K,ip:F,isInDetailsSidePanel:!1,data:Y,anomaliesData:re,loading:Z,isLoadingAnomaliesData:te,type:P,flowTarget:k,refetch:ee,setQuery:w,startDate:a,endDate:t,narrowDateRange:x}),s.a.createElement(r.EuiHorizontalRule,null),s.a.createElement(U.a,{direction:"column"},s.a.createElement(r.EuiFlexItem,null,s.a.createElement(oe,{endDate:t,filterQuery:G,flowTarget:u.e.source,indexNames:M,ip:F,skip:se,startDate:a,type:P,setQuery:w,indexPattern:D})),s.a.createElement(r.EuiFlexItem,null,s.a.createElement(oe,{endDate:t,flowTarget:u.e.destination,filterQuery:G,indexNames:M,ip:F,skip:se,startDate:a,type:P,setQuery:w,indexPattern:D}))),s.a.createElement(r.EuiSpacer,null),s.a.createElement(U.a,{direction:"column"},s.a.createElement(r.EuiFlexItem,null,s.a.createElement(ae,{endDate:t,filterQuery:G,flowTarget:u.e.source,indexNames:M,ip:F,skip:se,startDate:a,type:P,setQuery:w,indexPattern:D})),s.a.createElement(r.EuiFlexItem,null,s.a.createElement(ae,{endDate:t,flowTarget:u.e.destination,filterQuery:G,indexNames:M,ip:F,skip:se,startDate:a,type:P,setQuery:w,indexPattern:D}))),s.a.createElement(r.EuiSpacer,null),s.a.createElement(Ve,{endDate:t,filterQuery:G,flowTarget:k,indexNames:M,ip:F,skip:se,startDate:a,type:P,setQuery:w}),s.a.createElement(r.EuiSpacer,null),s.a.createElement(X,{endDate:t,filterQuery:G,indexNames:M,ip:F,skip:se,startDate:a,type:P,setQuery:w}),s.a.createElement(r.EuiSpacer,null),s.a.createElement(ue,{endDate:t,filterQuery:G,flowTarget:k,indexNames:M,ip:F,setQuery:w,skip:se,startDate:a,type:P}),s.a.createElement(r.EuiSpacer,null),s.a.createElement(ze.a,{filterQuery:G,setQuery:w,startDate:a,endDate:t,skip:se,indexNames:M,ip:F,type:P,flowTarget:k,narrowDateRange:x,hideHistogramIfEmpty:!0,AnomaliesTableComponent:T.a}))):s.a.createElement(We.a,null),s.a.createElement(z.a,{pageName:Ge.a.network}))};rt.displayName="NetworkDetailsComponent";const nt=s.a.memo(rt)},805:function(e,t,a){"use strict";a.d(t,"a",(function(){return C}));var r=a(5),n=a.n(r),s=a(392),o=a(216),i=a(259),l=a(353);const c=["source.ip","destination.ip"],u=e=>null!=e&&c.includes(e);var d=a(418);const p=(e,t)=>!!u(e.entityName)&&(null==t||e.entityValue===t);var b=a(239),m=a(258),g=a(470),f=a(195),y=a(349),T=a(624);var w=a(235),h=a(560),O=a(561);const k=(e,t)=>Object(O.a)(e,t)&&e.flowTarget===t.flowTarget;var S=a(72);const j=(e,t,a)=>e===y.NetworkType.details&&null!=t?a===S.d.source?[{fieldName:"source.ip",fieldValue:t}]:a===S.d.destination?[{fieldName:"destination.ip",fieldValue:t}]:[]:[];var v=a(312),E=a(197);const P={sort:{field:"anomaly.severity",direction:"desc"}},x=({startDate:e,endDate:t,skip:a,ip:c,type:O,flowTarget:k})=>{const S=Object(w.a)(),{toggleStatus:x,setToggleStatus:C}=Object(E.a)(`AnomaliesNetwork-${k}`),[I,N]=Object(r.useState)(a||!x);Object(r.useEffect)((()=>{N(a||!x)}),[a,x]);const D=Object(r.useCallback)((e=>{C(e),N(!e)}),[N,C]),[M,R]=Object(s.a)({startDate:e,endDate:t,skip:I,criteriaFields:j(O,c,k)}),F=((e,t)=>null==e?[]:e.anomalies.reduce(((e,a)=>{if(u(a.entityName)&&p(a,t))return[...e,{ip:a.entityValue,type:a.entityName,anomaly:a}];{const r=((e=[],t)=>{const a=e.find((e=>{const[a,r]=Object(d.a)(e);return!!u(a)&&(null==t||r===t)}));if(null!=a){const[e]=Object(d.a)(a);return u(e)?{ip:Object.values(a)[0],type:e}:{ip:Object.values(a)[0],type:"destination.ip"}}return null})(a.influencers,t);return null!=r?[...e,{ip:r.ip,type:r.type,anomaly:a}]:e}}),[]))(R,c),$=((e,t,a,r)=>{const s=((e,t,a)=>[{name:l.f,field:"ip",sortable:!0,render:(e,t)=>Object(m.b)({rowItem:e,attrName:t.type,idPrefix:`anomalies-network-table-ip-${Object(g.a)(t.anomaly)}`,render:e=>n.a.createElement(f.h,{ip:e,flowTarget:a}),isAggregatable:!0,fieldType:"ip"})},...Object(T.a)(e,t)])(t,a,r);return e===y.NetworkType.details?s.filter((e=>e.name!==l.f)):s})(O,e,t,k),A={initialPageIndex:0,initialPageSize:10,totalItemCount:F.length,pageSizeOptions:[5,10,20,50],showPerPageOptions:!0};return Object(i.a)(S)?n.a.createElement(v.a,{loading:M},n.a.createElement(o.a,{subtitle:`${l.h}: ${A.totalItemCount.toLocaleString()} ${l.k(A.totalItemCount)}`,title:l.a,tooltip:l.j,toggleQuery:D,toggleStatus:x,isInspectDisabled:a}),x&&n.a.createElement(h.a,{"data-test-subj":"network-anomalies-table",columns:$,items:F,pagination:A,sorting:P}),M&&n.a.createElement(b.a,{"data-test-subj":"anomalies-network-table-loading-panel",overlay:!0,size:"xl"})):null},C=n.a.memo(x,k)},816:function(e,t,a){"use strict";a.d(t,"a",(function(){return k}));var r=a(3),n=a(42),s=a(525),o=a(800),i=a(562),l=a(769),c=a(523),u=a(315),d=a(17);const p={[c.a.endpoints]:u.a,[c.a.policies]:u.d,[c.a.trustedApps]:u.e,[c.a.eventFilters]:u.b,[c.a.hostIsolationExceptions]:d.p,[c.a.blocklist]:d.c};function b(e){return[...(null!=e&&e.tabName?[null==e?void 0:e.tabName]:[]).map((e=>({text:p[e],href:""})))]}var m=a(8),g=a(84),f=a(14),y=a(1),T=a(273),w=a(63),h=a(221),O=a(331);const k=()=>{const e=Object(n.useDispatch)(),t=Object(h.l)(),a=Object(O.c)();return(r,n,s)=>{const o=S(r,t,a);o&&n.setBreadcrumbs(o.map((t=>({...t,...t.href&&!t.onClick?{onClick:a=>{a.preventDefault(),e(g.a.showTimeline({id:f.i.active,show:!1})),s(t.href)}}:{}}))))}},S=(e,t,a)=>{const n=Object(r.omit)("navTabs",e);if(!n||!e.navTabs||!n.pageName||x(n))return null;const s=((e,t,a,r)=>{const n=t({deepLinkId:m.a.landing});var s;return[{text:y.q,href:(s=n,`${s}${Object(T.a)(undefined)}`)},...Object(w.a)(e).map((({title:e,id:n})=>{const s=e,o=a[n]?a[n].name:e;return{text:r?s:o,href:t({deepLinkId:n})}}))]})(n.pageName,t,e.navTabs,a),o=s[s.length-1],i=s[0],l=a?s:[i,o];return C(n)?a?N([...l,...b(n)]):[...i?[i]:[],...b(n)]:N([...l,...j(n,t)])},j=(e,t)=>E(e)?Object(s.a)(e,t):v(e)?Object(o.b)(e,t):P(e)?Object(l.a)(e,t):I(e)?Object(i.a)(e,t):[],v=e=>e.pageName===m.a.network,E=e=>e.pageName===m.a.hosts,P=e=>e.pageName===m.a.users,x=e=>e.pageName===m.a.case,C=e=>e.pageName===m.a.administration,I=e=>e.pageName===m.a.rules||e.pageName===m.a.rulesCreate,N=e=>{const t=e.slice(0,-1),a=Object(r.last)(e);return a?[...t,{...a,href:""}]:e}},817:function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return c})),a.d(t,"c",(function(){return u})),a.d(t,"d",(function(){return d})),a.d(t,"e",(function(){return p}));const r=a(4).i18n.translate("xpack.securitySolution.components.ml.api.errors.statusCodeFailureTitle",{defaultMessage:"Status Code:"});var n=a(46),s=a(3);const o=e=>{try{return JSON.stringify(JSON.parse(e),null,2)}catch(t){return e}};var i=a(18);const l=async({indexPatternName:e,signal:t})=>i.b.get().http.fetch(`/api/ml/modules/recognize/${e}`,{method:"GET",asSystemRequest:!0,signal:t}),c=async({moduleId:e="",signal:t})=>i.b.get().http.fetch(`/api/ml/modules/get_module/${e}`,{method:"GET",asSystemRequest:!0,signal:t}),u=async({configTemplate:e,indexPatternName:t="auditbeat-*",jobIdErrorFilter:a=[],groups:s=["security"],prefix:l=""})=>{const c=await i.b.get().http.fetch(`/api/ml/modules/setup/${e}`,{method:"POST",body:JSON.stringify({prefix:l,groups:s,indexPatternName:t,startDatafeed:!1,useDedicatedIndex:!0,applyToAllSpaces:!0}),asSystemRequest:!0});return((e,t=[])=>{const a=[...e.jobs.reduce(((e,a)=>null!=a.error&&t.includes(a.id)?[...e,a.error.msg,o(a.error.response),`${r} ${a.error.statusCode}`]:e),[]),...e.datafeeds.reduce(((e,a)=>null!=a.error&&t.includes(a.id.substr("datafeed-".length))?[...e,a.error.msg,o(a.error.response),`${r} ${a.error.statusCode}`]:e),[])];if(a.length>0)throw new n.c(a)})(c,a),c},d=async({datafeedIds:e,start:t=0})=>{const a=await i.b.get().http.fetch("/api/ml/jobs/force_start_datafeeds",{method:"POST",body:JSON.stringify({datafeedIds:e,...0!==t&&{start:t}}),asSystemRequest:!0});return((e,t)=>{const a=t.reduce(((t,a)=>{const n=e[a];return i=n,Object(s.has)("error.msg",i)&&Object(s.has)("error.response",i)&&Object(s.has)("error.statusCode",i)?[...t,n.error.msg,o(n.error.response),`${r} ${n.error.statusCode}`]:t;var i}),[]);if(a.length>0)throw new n.c(a)})(a,e),a},p=async({datafeedIds:e})=>{const t=await i.b.get().http.fetch("/api/ml/jobs/stop_datafeeds",{method:"POST",body:JSON.stringify({datafeedIds:e}),asSystemRequest:!0}),a="datafeed-";return[t,await i.b.get().http.fetch("/api/ml/jobs/close_jobs",{method:"POST",body:JSON.stringify({jobIds:e.map((e=>e.startsWith(a)?e.substring(a.length):e))}),asSystemRequest:!0})]}},826:function(e,t,a){"use strict";a.d(t,"a",(function(){return N}));var r=a(5),n=a.n(r),s=a(42),o=a(214),i=a(72),l=a(71),c=a(262),u=a(168),d=a.n(u),p=a(94),b=a(204),m=a(193),g=a(195),f=a(4);const y=f.i18n.translate("xpack.securitySolution.networkHttpTable.title",{defaultMessage:"HTTP Requests"}),T=e=>f.i18n.translate("xpack.securitySolution.networkHttpTable.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {request} other {requests}}"}),w=f.i18n.translate("xpack.securitySolution.networkHttpTable.column.methodTitle",{defaultMessage:"Method"}),h=f.i18n.translate("xpack.securitySolution.networkHttpTable.column.domainTitle",{defaultMessage:"Domain"}),O=f.i18n.translate("xpack.securitySolution.networkHttpTable.column.pathTitle",{defaultMessage:"Path"}),k=f.i18n.translate("xpack.securitySolution.networkHttpTable.column.statusTitle",{defaultMessage:"Status"}),S=f.i18n.translate("xpack.securitySolution.networkHttpTable.column.lastHostTitle",{defaultMessage:"Last host"}),j=f.i18n.translate("xpack.securitySolution.networkHttpTable.column.lastSourceIpTitle",{defaultMessage:"Last source Ip"}),v=f.i18n.translate("xpack.securitySolution.networkHttpTable.column.requestsTitle",{defaultMessage:"Requests"}),E=f.i18n.translate("xpack.securitySolution.networkHttpTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),P=f.i18n.translate("xpack.securitySolution.networkHttpTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"});var x=a(258);const C=[{text:E,numberOfRow:5},{text:P,numberOfRow:10}],I=({data:e,fakeTotalCount:t,id:a,isInspect:u,loading:f,loadPage:E,setQuerySkip:P,showMorePagesIndicator:I,totalCount:N,type:D})=>{const M=Object(s.useDispatch)(),R=Object(r.useMemo)((()=>o.e.httpSelector()),[]),{activePage:F,limit:$,sort:A}=Object(l.a)((e=>R(e,D))),Q=D===o.c.NetworkType.page?o.c.NetworkTableType.http:o.c.NetworkDetailsTableType.http,_=Object(r.useCallback)((e=>M(o.b.updateNetworkTable({networkType:D,tableType:Q,updates:{limit:e}}))),[M,D,Q]),H=Object(r.useCallback)((e=>M(o.b.updateNetworkTable({networkType:D,tableType:Q,updates:{activePage:e}}))),[M,D,Q]),q=Object(r.useCallback)((e=>{null!=e.sort&&e.sort.direction!==A.direction&&M(o.b.updateNetworkTable({networkType:D,tableType:Q,updates:{sort:{direction:e.sort.direction}}}))}),[A.direction,M,D,Q]),U={field:`node.${i.m.requestCount}`,direction:A.direction},L=Object(r.useMemo)((()=>{return e=Q,[{name:w,render:({node:{methods:t,path:a}})=>Array.isArray(t)&&t.length>0?Object(x.c)({attrName:"http.request.method",displayCount:3,idPrefix:Object(b.h)(`${e}-table-methods-${a}`),rowItems:t,isAggregatable:!0,fieldType:"keyword"}):Object(m.d)()},{name:h,render:({node:{domains:t,path:a}})=>Array.isArray(t)&&t.length>0?Object(x.c)({attrName:"url.domain",displayCount:3,idPrefix:Object(b.h)(`${e}-table-domains-${a}`),rowItems:t,isAggregatable:!0,fieldType:"keyword"}):Object(m.d)()},{field:`node.${p.e.path}`,name:O,render:t=>null!=t?Object(x.b)({attrName:"url.path",idPrefix:Object(b.h)(`${e}-table-path-${t}`),rowItem:t,isAggregatable:!0,fieldType:"keyword"}):Object(m.d)()},{name:k,render:({node:{statuses:t,path:a}})=>Array.isArray(t)&&t.length>0?Object(x.c)({attrName:"http.response.status_code",displayCount:3,idPrefix:Object(b.h)(`${e}-table-statuses-${a}`),rowItems:t,isAggregatable:!0,fieldType:"keyword"}):Object(m.d)()},{name:S,render:({node:{lastHost:t,path:a}})=>null!=t?Object(x.b)({attrName:"host.name",idPrefix:Object(b.h)(`${e}-table-lastHost-${a}`),rowItem:t,isAggregatable:!0,fieldType:"keyword"}):Object(m.d)()},{name:j,render:({node:{lastSourceIp:t,path:a}})=>null!=t?Object(x.b)({attrName:"source.ip",idPrefix:Object(b.h)(`${e}-table-lastSourceIp-${a}`),rowItem:t,render:()=>n.a.createElement(g.h,{ip:t}),isAggregatable:!0,fieldType:"keyword"}):Object(m.d)()},{align:"right",field:`node.${p.e.requestCount}`,name:v,sortable:!0,render:e=>null!=e?d()(e).format("0,000"):Object(m.d)()}];var e}),[Q]);return n.a.createElement(c.a,{activePage:F,columns:L,dataTestSubj:`table-${Q}`,headerCount:N,headerTitle:y,headerUnit:T(N),id:a,itemsPerRow:C,isInspect:u,limit:$,loading:f,loadPage:E,onChange:q,pageOfItems:e,setQuerySkip:P,showMorePagesIndicator:I,sorting:U,totalCount:t,updateActivePage:H,updateLimitPagination:_})};I.displayName="NetworkHttpTableComponent";const N=n.a.memo(I)},827:function(e,t,a){"use strict";a.d(t,"a",(function(){return Q}));var r=a(3),n=a(5),s=a.n(n),o=a(42),i=a(85),l=a.n(i),c=a(214),u=a(72),d=a(71),p=a(262),b=a(168),m=a.n(b),g=a(553),f=a(94),y=a(242),T=a(204),w=a(193),h=a(30),O=a(249),k=a(4);const S=e=>k.i18n.translate("xpack.securitySolution.networkTopCountriesTable.heading.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {Country} other {Countries}}"}),j=k.i18n.translate("xpack.securitySolution.networkTopCountriesTable.column.countryTitle",{defaultMessage:"Country"}),v=k.i18n.translate("xpack.securitySolution.networkTopCountriesTable.column.bytesInTitle",{defaultMessage:"Bytes in"}),E=k.i18n.translate("xpack.securitySolution.networkTopCountriesTable.column.bytesOutTitle",{defaultMessage:"Bytes out"}),P=k.i18n.translate("xpack.securitySolution.networkTopCountriesTable.column.flows",{defaultMessage:"Flows"}),x=k.i18n.translate("xpack.securitySolution.networkTopCountriesTable.heading.destinationCountries",{defaultMessage:"Destination countries"}),C=k.i18n.translate("xpack.securitySolution.networkTopCountriesTable.heading.sourceCountries",{defaultMessage:"Source countries"}),I=k.i18n.translate("xpack.securitySolution.networkTopCountriesTable.column.destinationIps",{defaultMessage:"Destination IPs"}),N=k.i18n.translate("xpack.securitySolution.networkTopCountriesTable.column.sourceIps",{defaultMessage:"Source IPs"}),D=k.i18n.translate("xpack.securitySolution.networkTopCountriesTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),M=k.i18n.translate("xpack.securitySolution.networkTopCountriesTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"});var R=a(373);const F=e=>e===f.b.source?f.b.destination:f.b.source,$=[{text:D,numberOfRow:5},{text:M,numberOfRow:10}],A=({data:e,fakeTotalCount:t,flowTargeted:a,id:i,indexPattern:b,isInspect:k,loading:D,loadPage:M,setQuerySkip:A,showMorePagesIndicator:Q,totalCount:_,type:H})=>{const q=Object(o.useDispatch)(),U=Object(n.useMemo)((()=>c.e.topCountriesSelector()),[]),{activePage:L,limit:B,sort:V}=Object(d.a)((e=>U(e,H,a))),z=Object(n.useMemo)((()=>a===u.e.source?C:x),[a]),G=Object(n.useMemo)((()=>H===c.c.NetworkType.page?a===u.e.source?c.c.NetworkTableType.topCountriesSource:c.c.NetworkTableType.topCountriesDestination:a===u.e.source?c.c.NetworkDetailsTableType.topCountriesSource:c.c.NetworkDetailsTableType.topCountriesDestination),[a,H]),J=V.field===u.q.bytes_out||V.field===u.q.bytes_in?`node.network.${V.field}`:`node.${a}.${V.field}`,Z=Object(n.useCallback)((e=>q(c.b.updateNetworkTable({networkType:H,tableType:G,updates:{limit:e}}))),[q,H,G]),W=Object(n.useCallback)((e=>q(c.b.updateNetworkTable({networkType:H,tableType:G,updates:{activePage:e}}))),[q,H,G]),K=Object(n.useCallback)((e=>{if(null!=e.sort){const t=e.sort.field.split("."),a=Object(r.last)(t),n={field:a,direction:a!==V.field?u.b.desc:e.sort.direction};l()(n,V)||q(c.b.updateNetworkTable({networkType:H,tableType:G,updates:{sort:n}}))}}),[V,q,H,G]),X=Object(n.useMemo)((()=>((e,t,a,n)=>{const o=((e,t,a,n)=>[{name:j,render:({node:e})=>{const a=Object(r.get)(`${t}.country`,e),o=`${t}.geo.country_iso_code`,i=Object(T.h)(`${n}-table-${t}-country-${a}`);return null!=a?s.a.createElement(y.b,{key:i,dataProvider:{and:[],enabled:!0,id:i,name:a,excluded:!1,kqlQuery:"",queryMatch:{field:o,value:a,operator:h.c}},isAggregatable:!0,fieldType:"keyword",render:(e,t,r)=>r.isDragging?s.a.createElement(y.a,null,s.a.createElement(O.a,{dataProvider:e})):s.a.createElement(s.a.Fragment,null,s.a.createElement(g.b,{countryCode:a}))}):Object(w.d)()},width:"20%"},{align:"right",field:"node.network.bytes_in",name:v,sortable:!0,render:e=>null!=e?s.a.createElement(R.a,{value:e}):Object(w.d)()},{align:"right",field:"node.network.bytes_out",name:E,sortable:!0,render:e=>null!=e?s.a.createElement(R.a,{value:e}):Object(w.d)()},{align:"right",field:`node.${t}.flows`,name:P,sortable:!0,render:e=>null!=e?m()(e).format("0,000"):Object(w.d)()},{align:"right",field:`node.${t}.${t}_ips`,name:t===f.b.source?N:I,sortable:!0,render:e=>null!=e?m()(e).format("0,000"):Object(w.d)()},{align:"right",field:`node.${t}.${F(t)}_ips`,name:F(t)===f.b.source?N:I,sortable:!0,render:e=>null!=e?m()(e).format("0,000"):Object(w.d)()}])(0,t,0,n);return a===c.c.NetworkType.details?(o.pop(),o):o})(0,a,H,"networkTopCountries-top-talkers")),[b,a,H]);return s.a.createElement(p.a,{activePage:L,columns:X,dataTestSubj:`table-${G}`,headerCount:_,headerTitle:z,headerUnit:S(_),id:i,isInspect:k,itemsPerRow:$,limit:B,loading:D,loadPage:M,onChange:K,pageOfItems:e,setQuerySkip:A,showMorePagesIndicator:Q,sorting:{field:J,direction:V.direction},totalCount:t,updateActivePage:W,updateLimitPagination:Z})};A.displayName="NetworkTopCountriesTableComponent";const Q=s.a.memo(A)},828:function(e,t,a){"use strict";a.d(t,"a",(function(){return q}));var r=a(3),n=a(5),s=a.n(n),o=a(42),i=a(85),l=a.n(i),c=a(72),u=a(71),d=a(262),p=a(214),b=a(168),m=a.n(b),g=a(553),f=a(242),y=a(204),T=a(193),w=a(195),h=a(30),O=a(249),k=a(4);const S=e=>k.i18n.translate("xpack.securitySolution.networkTopNFlowTable.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {IP} other {IPs}}"}),j=k.i18n.translate("xpack.securitySolution.networkTopNFlowTable.column.sourceIpTitle",{defaultMessage:"Source IPs"}),v=k.i18n.translate("xpack.securitySolution.networkTopNFlowTable.column.destinationIpTitle",{defaultMessage:"Destination IPs"}),E=k.i18n.translate("xpack.securitySolution.networkTopNFlowTable.column.IpTitle",{defaultMessage:"IP"}),P=k.i18n.translate("xpack.securitySolution.networkTopNFlowTable.column.domainTitle",{defaultMessage:"Domain"}),x=k.i18n.translate("xpack.securitySolution.networkTopNFlowTable.column.bytesInTitle",{defaultMessage:"Bytes in"}),C=k.i18n.translate("xpack.securitySolution.networkTopNFlowTable.column.bytesOutTitle",{defaultMessage:"Bytes out"}),I=k.i18n.translate("xpack.securitySolution.networkTopNFlowTable.column.asTitle",{defaultMessage:"Autonomous system"}),N=k.i18n.translate("xpack.securitySolution.networkTopNFlowTable.flows",{defaultMessage:"Flows"}),D=k.i18n.translate("xpack.securitySolution.networkTopNFlowTable.destinationIps",{defaultMessage:"Destination IPs"}),M=k.i18n.translate("xpack.securitySolution.networkTopNFlowTable.sourceIps",{defaultMessage:"Source IPs"}),R=k.i18n.translate("xpack.securitySolution.networkTopNFlowTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),F=k.i18n.translate("xpack.securitySolution.networkTopNFlowTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"});var $=a(258),A=a(373);const Q=e=>e===c.e.source?c.e.destination:c.e.source,_=[{text:R,numberOfRow:5},{text:F,numberOfRow:10}],H=({data:e,fakeTotalCount:t,flowTargeted:a,id:i,isInspect:b,loading:k,loadPage:R,setQuerySkip:F,showMorePagesIndicator:H,totalCount:q,type:U})=>{const L=Object(o.useDispatch)(),B=Object(n.useMemo)((()=>p.e.topNFlowSelector()),[]),{activePage:V,limit:z,sort:G}=Object(u.a)((e=>B(e,U,a))),J=Object(n.useMemo)((()=>((e,t,a)=>{const n=((e,t)=>[{name:E,render:({node:a})=>{const n=`${e}.ip`,o=Object(r.get)(n,a),i=`${e}.location.geo.country_iso_code[0]`,l=`${e}.geo.country_iso_code`,c=Object(r.get)(i,a),u=Object(y.h)(`${t}-table-${e}-ip-${o}`);return null!=o?s.a.createElement(s.a.Fragment,null,s.a.createElement(f.b,{key:u,dataProvider:{and:[],enabled:!0,id:u,name:o,excluded:!1,kqlQuery:"",queryMatch:{field:n,value:o,operator:h.c}},isAggregatable:!0,fieldType:"ip",render:(t,a,r)=>r.isDragging?s.a.createElement(f.a,null,s.a.createElement(O.a,{dataProvider:t})):s.a.createElement(w.h,{ip:o,flowTarget:e})}),c&&s.a.createElement(f.b,{key:`${u}-${c}`,dataProvider:{and:[],enabled:!0,id:`${u}-${c}`,name:c,excluded:!1,kqlQuery:"",queryMatch:{field:l,value:c,operator:h.c}},isAggregatable:!0,fieldType:"geo_point",render:(e,t,a)=>a.isDragging?s.a.createElement(f.a,null,s.a.createElement(O.a,{dataProvider:e})):s.a.createElement(s.a.Fragment,null," ",s.a.createElement(g.a,{countryCode:c})," ",c)})):Object(T.d)()},width:"20%"},{name:P,render:({node:a})=>{const n=`${e}.domain`,s=`${e}.ip`,o=Object(r.get)(n,a),i=Object(r.get)(s,a);if(Array.isArray(o)&&o.length>0){const e=Object(y.h)(`${t}-table-${i}`);return Object($.c)({rowItems:o,attrName:n,idPrefix:e,displayCount:1,isAggregatable:!0,fieldType:"keyword"})}return Object(T.d)()},width:"20%"},{name:I,render:({node:a,cursor:{value:n}})=>{const o=`${e}.autonomous_system`,i=Object(r.get)(o,a);if(null!=i){const a=Object(y.h)(`${t}-table-${e}-ip-${n}`);return s.a.createElement(s.a.Fragment,null,i.name&&Object($.b)({rowItem:i.name,attrName:`${e}.as.organization.name`,idPrefix:`${a}-name`,isAggregatable:!0,fieldType:"keyword"}),i.number&&s.a.createElement(s.a.Fragment,null," ",Object($.b)({rowItem:`${i.number}`,attrName:`${e}.as.number`,idPrefix:`${a}-number`,isAggregatable:!0,fieldType:"keyword"})))}return Object(T.d)()},width:"20%"},{align:"right",field:"node.network.bytes_in",name:x,sortable:!0,render:e=>null!=e?s.a.createElement(A.a,{value:e}):Object(T.d)()},{align:"right",field:"node.network.bytes_out",name:C,sortable:!0,render:e=>null!=e?s.a.createElement(A.a,{value:e}):Object(T.d)()},{align:"right",field:`node.${e}.flows`,name:N,sortable:!0,render:e=>null!=e?m()(e).format("0,000"):Object(T.d)()},{align:"right",field:`node.${e}.${Q(e)}_ips`,name:e===c.e.source?D:M,sortable:!0,render:e=>null!=e?m()(e).format("0,000"):Object(T.d)()}])(e,a);return t===p.c.NetworkType.details?(n.pop(),n):n})(a,U,"networkTopSourceFlow-top-talkers")),[a,U]);let Z;const W=a===c.e.source?j:v;Z=U===p.c.NetworkType.page?a===c.e.source?p.c.NetworkTableType.topNFlowSource:p.c.NetworkTableType.topNFlowDestination:a===c.e.source?p.c.NetworkDetailsTableType.topNFlowSource:p.c.NetworkDetailsTableType.topNFlowDestination;const K=Object(n.useCallback)((e=>{if(null!=e.sort){const t=e.sort.field.split("."),a=Object(r.last)(t),n={field:a,direction:a!==G.field?c.b.desc:e.sort.direction};l()(n,G)||L(p.b.updateNetworkTable({networkType:U,tableType:Z,updates:{sort:n}}))}}),[G,L,U,Z]),X=Object(n.useMemo)((()=>({field:G.field===c.q.bytes_out||G.field===c.q.bytes_in?`node.network.${G.field}`:`node.${a}.${G.field}`,direction:G.direction})),[a,G]),Y=Object(n.useCallback)((e=>L(p.b.updateNetworkTable({networkType:U,tableType:Z,updates:{activePage:e}}))),[L,U,Z]),ee=Object(n.useCallback)((e=>L(p.b.updateNetworkTable({networkType:U,tableType:Z,updates:{limit:e}}))),[L,U,Z]);return s.a.createElement(d.a,{activePage:V,columns:J,dataTestSubj:`table-${Z}`,headerCount:q,headerTitle:W,headerUnit:S(q),id:i,isInspect:b,itemsPerRow:_,limit:z,loading:k,loadPage:R,onChange:K,pageOfItems:e,setQuerySkip:F,showMorePagesIndicator:H,sorting:X,totalCount:t,updateActivePage:Y,updateLimitPagination:ee})},q=s.a.memo(H)},829:function(e,t,a){"use strict";a.d(t,"a",(function(){return P}));var r=a(5),n=a.n(r),s=a(42),o=a(85),i=a.n(o),l=a(214),c=a(72),u=a(71),d=a(262),p=a(51),b=a.n(p),m=a(258),g=a(711),f=a(201),y=a(4);const T=y.i18n.translate("xpack.securitySolution.network.ipDetails.tlsTable.transportLayerSecurityTitle",{defaultMessage:"Transport Layer Security"}),w=e=>y.i18n.translate("xpack.securitySolution.network.ipDetails.tlsTable.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {server certificate} other {server certificates}}"}),h=y.i18n.translate("xpack.securitySolution.network.ipDetails.tlsTable.columns.issuerTitle",{defaultMessage:"Issuer"}),O=y.i18n.translate("xpack.securitySolution.network.ipDetails.tlsTable.columns.subjectTitle",{defaultMessage:"Subject"}),k=y.i18n.translate("xpack.securitySolution.network.ipDetails.tlsTable.columns.sha1FingerPrintTitle",{defaultMessage:"SHA1 fingerprint"}),S=y.i18n.translate("xpack.securitySolution.network.ipDetails.tlsTable.columns.ja3FingerPrintTitle",{defaultMessage:"JA3 fingerprint"}),j=y.i18n.translate("xpack.securitySolution.network.ipDetails.tlsTable.columns.validUntilTitle",{defaultMessage:"Valid until"}),v=[{text:y.i18n.translate("xpack.securitySolution.network.ipDetails.tlsTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),numberOfRow:5},{text:y.i18n.translate("xpack.securitySolution.network.ipDetails.tlsTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),numberOfRow:10}],E=({data:e,fakeTotalCount:t,id:a,isInspect:o,loading:c,loadPage:p,setQuerySkip:y,showMorePagesIndicator:E,totalCount:P,type:I})=>{const N=Object(s.useDispatch)(),D=Object(r.useMemo)((()=>l.e.tlsSelector()),[]),{activePage:M,limit:R,sort:F}=Object(u.a)((e=>D(e,I))),$=I===l.c.NetworkType.page?l.c.NetworkTableType.tls:l.c.NetworkDetailsTableType.tls,A=Object(r.useCallback)((e=>N(l.b.updateNetworkTable({networkType:I,tableType:$,updates:{limit:e}}))),[N,I,$]),Q=Object(r.useCallback)((e=>N(l.b.updateNetworkTable({networkType:I,tableType:$,updates:{activePage:e}}))),[N,I,$]),_=Object(r.useCallback)((e=>{if(null!=e.sort){const t=e.sort.field.split("."),a={field:C(t[t.length-1]),direction:e.sort.direction};i()(a,F)||N(l.b.updateNetworkTable({networkType:I,tableType:$,updates:{sort:a}}))}}),[F,N,I,$]),H=Object(r.useMemo)((()=>("tls-table",[{field:"node",name:h,truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:({_id:e,issuers:t})=>Object(m.c)({rowItems:t,attrName:"tls.server.issuer",idPrefix:`tls-table-${e}-table-issuers`,isAggregatable:!0,fieldType:"keyword"})},{field:"node",name:O,truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:({_id:e,subjects:t})=>Object(m.c)({rowItems:t,attrName:"tls.server.subject",idPrefix:`tls-table-${e}-table-subjects`,isAggregatable:!0,fieldType:"keyword"})},{field:"node._id",name:k,truncateText:!1,mobileOptions:{show:!0},sortable:!0,render:e=>Object(m.b)({rowItem:e,attrName:"tls.server.hash.sha1",idPrefix:`tls-table-${e}-table-sha1`,isAggregatable:!0,fieldType:"keyword"})},{field:"node",name:S,truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:({_id:e,ja3:t})=>Object(m.c)({rowItems:t,attrName:"tls.server.ja3s",idPrefix:`tls-table-${e}-table-ja3`,isAggregatable:!0,fieldType:"keyword"})},{field:"node",name:j,truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:({_id:e,notAfter:t})=>Object(m.c)({rowItems:t,attrName:"tls.server.not_after",idPrefix:`tls-table-${e}-table-notAfter`,render:e=>n.a.createElement(g.a,{date:b()(new Date(e)).toDate()},n.a.createElement(f.c,{value:new Date(e)}))})}])),[]);return n.a.createElement(d.a,{activePage:M,columns:H,dataTestSubj:`table-${$}`,showMorePagesIndicator:E,headerCount:P,headerTitle:T,headerUnit:w(P),id:a,isInspect:o,itemsPerRow:v,limit:R,loading:c,loadPage:p,onChange:_,pageOfItems:e,setQuerySkip:y,sorting:x(F),totalCount:t,updateActivePage:Q,updateLimitPagination:A})};E.displayName="TlsTableComponent";const P=n.a.memo(E),x=e=>({field:`node.${e.field}`,direction:e.direction}),C=e=>c.p._id},849:function(e,t,a){"use strict";a.d(t,"a",(function(){return h})),a.d(t,"b",(function(){return O}));var r=a(3),n=a(5),s=a(85),o=a.n(s),i=a(19),l=a(166),c=a(71),u=a(18),d=a(211),p=a(294),b=a(214),m=a(72),g=a(4);const f=g.i18n.translate("xpack.securitySolution.networkHttp.errorSearchDescription",{defaultMessage:"An error has occurred on network http search"}),y=g.i18n.translate("xpack.securitySolution.networkHttp.failSearchDescription",{defaultMessage:"Failed to run search on network http"});var T=a(74),w=a(192);const h="networkHttpQuery",O=({endDate:e,filterQuery:t,id:a=h,indexNames:s,ip:g,skip:O,startDate:k,type:S})=>{const j=Object(n.useMemo)((()=>b.e.httpSelector()),[]),{activePage:v,limit:E,sort:P}=Object(c.a)((e=>j(e,S))),{data:x}=Object(u.j)().services,C=Object(n.useRef)(r.noop),I=Object(n.useRef)(new AbortController),N=Object(n.useRef)(new i.Subscription),[D,M]=Object(n.useState)(!1),[R,F]=Object(n.useState)(null),$=Object(n.useCallback)((e=>{F((t=>t?{...t,pagination:Object(p.a)(e,E)}:t))}),[E]),[A,Q]=Object(n.useState)({networkHttp:[],id:a,inspect:{dsl:[],response:[]},isInspected:!1,loadPage:$,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1},refetch:C.current,totalCount:-1}),{addError:_,addWarning:H}=Object(w.a)(),q=Object(n.useCallback)((e=>{if(null==e||O)return;const t=async()=>{I.current=new AbortController,M(!0),N.current=x.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:I.current.signal}).subscribe({next:e=>{Object(l.isCompleteResponse)(e)?(M(!1),Q((t=>({...t,networkHttp:e.edges,inspect:Object(T.c)(e,t.inspect),pageInfo:e.pageInfo,refetch:C.current,totalCount:e.totalCount}))),N.current.unsubscribe()):Object(l.isErrorResponse)(e)&&(M(!1),H(f),N.current.unsubscribe())},error:e=>{M(!1),_(e,{title:y}),N.current.unsubscribe()}})};N.current.unsubscribe(),I.current.abort(),t(),C.current=t}),[x.search,_,H,O]);return Object(n.useEffect)((()=>{F((a=>{const r={...null!=a?a:{},defaultIndex:s,factoryQueryType:m.o.http,filterQuery:Object(d.a)(t),ip:g,pagination:Object(p.a)(v,E),sort:P,timerange:{interval:"12h",from:k,to:e}};return o()(a,r)?a:r}))}),[v,s,e,t,g,E,k,P]),Object(n.useEffect)((()=>(q(R),()=>{N.current.unsubscribe(),I.current.abort()})),[R,q]),Object(n.useEffect)((()=>{O&&(M(!1),N.current.unsubscribe(),I.current.abort())}),[O]),[D,A]}},850:function(e,t,a){"use strict";a.d(t,"a",(function(){return h})),a.d(t,"b",(function(){return O}));var r=a(3),n=a(5),s=a(85),o=a.n(s),i=a(19),l=a(166),c=a(71),u=a(18),d=a(211),p=a(294),b=a(214),m=a(72),g=a(74),f=a(4);const y=f.i18n.translate("xpack.securitySolution.networkTopCountries.errorSearchDescription",{defaultMessage:"An error has occurred on network top countries search"}),T=f.i18n.translate("xpack.securitySolution.networkTopCountries.failSearchDescription",{defaultMessage:"Failed to run search on network top countries"});var w=a(192);const h="networkTopCountriesQuery",O=({endDate:e,filterQuery:t,flowTarget:a,indexNames:s,ip:f,skip:O,startDate:k,type:S})=>{const j=Object(n.useMemo)((()=>b.e.topCountriesSelector()),[]),{activePage:v,limit:E,sort:P}=Object(c.a)((e=>j(e,S,a))),{data:x}=Object(u.j)().services,C=Object(n.useRef)(r.noop),I=Object(n.useRef)(new AbortController),N=Object(n.useRef)(new i.Subscription),[D,M]=Object(n.useState)(!1),R=Object(n.useMemo)((()=>`${h}-${a}`),[a]),[F,$]=Object(n.useState)(null),A=Object(n.useCallback)((e=>{$((t=>t?{...t,pagination:Object(p.a)(e,E)}:t))}),[E]),{addError:Q,addWarning:_}=Object(w.a)(),[H,q]=Object(n.useState)({networkTopCountries:[],id:R,inspect:{dsl:[],response:[]},isInspected:!1,loadPage:A,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1},refetch:C.current,totalCount:-1}),U=Object(n.useCallback)((e=>{if(null==e||O)return;const t=async()=>{I.current=new AbortController,M(!0),N.current=x.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:I.current.signal}).subscribe({next:e=>{Object(l.isCompleteResponse)(e)?(M(!1),q((t=>({...t,networkTopCountries:e.edges,inspect:Object(g.c)(e,t.inspect),pageInfo:e.pageInfo,refetch:C.current,totalCount:e.totalCount}))),N.current.unsubscribe()):Object(l.isErrorResponse)(e)&&(M(!1),_(y),N.current.unsubscribe())},error:e=>{M(!1),Q(e,{title:T}),N.current.unsubscribe()}})};N.current.unsubscribe(),I.current.abort(),t(),C.current=t}),[x.search,_,Q,O]);return Object(n.useEffect)((()=>{$((r=>{const n={...null!=r?r:{},defaultIndex:s,factoryQueryType:m.o.topCountries,filterQuery:Object(d.a)(t),flowTarget:a,ip:f,pagination:Object(p.a)(v,E),sort:P,timerange:{interval:"12h",from:k,to:e}};return o()(r,n)?r:n}))}),[v,s,e,t,f,E,k,P,a]),Object(n.useEffect)((()=>(U(F),()=>{N.current.unsubscribe(),I.current.abort()})),[F,U]),Object(n.useEffect)((()=>{O&&(M(!1),N.current.unsubscribe(),I.current.abort())}),[O]),[D,H]}},851:function(e,t,a){"use strict";a.d(t,"a",(function(){return h})),a.d(t,"b",(function(){return O}));var r=a(3),n=a(5),s=a(85),o=a.n(s),i=a(19),l=a(166),c=a(71),u=a(18),d=a(211),p=a(294),b=a(214),m=a(72),g=a(74),f=a(4);const y=f.i18n.translate("xpack.securitySolution.networkTopNFlow.errorSearchDescription",{defaultMessage:"An error has occurred on network top n flow search"}),T=f.i18n.translate("xpack.securitySolution.networkTopNFlow.failSearchDescription",{defaultMessage:"Failed to run search on network top n flow"});var w=a(192);const h="networkTopNFlowQuery",O=({endDate:e,filterQuery:t,flowTarget:a,indexNames:s,ip:f,skip:O,startDate:k,type:S})=>{const j=Object(n.useMemo)((()=>b.e.topNFlowSelector()),[]),{activePage:v,limit:E,sort:P}=Object(c.a)((e=>j(e,S,a))),{data:x}=Object(u.j)().services,C=Object(n.useRef)(r.noop),I=Object(n.useRef)(new AbortController),N=Object(n.useRef)(new i.Subscription),[D,M]=Object(n.useState)(!1),[R,F]=Object(n.useState)(null),$=Object(n.useCallback)((e=>{F((t=>t?{...t,pagination:Object(p.a)(e,E)}:t))}),[E]),[A,Q]=Object(n.useState)({networkTopNFlow:[],id:`${h}-${a}`,inspect:{dsl:[],response:[]},isInspected:!1,loadPage:$,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1},refetch:C.current,totalCount:-1}),{addError:_,addWarning:H}=Object(w.a)(),q=Object(n.useCallback)((e=>{if(null==e||O)return;const t=async()=>{I.current=new AbortController,M(!0),N.current=x.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:I.current.signal}).subscribe({next:e=>{Object(l.isCompleteResponse)(e)?(M(!1),Q((t=>({...t,networkTopNFlow:e.edges,inspect:Object(g.c)(e,t.inspect),pageInfo:e.pageInfo,refetch:C.current,totalCount:e.totalCount}))),N.current.unsubscribe()):Object(l.isErrorResponse)(e)&&(M(!1),H(y),N.current.unsubscribe())},error:e=>{M(!1),_(e,{title:T}),N.current.unsubscribe()}})};N.current.unsubscribe(),I.current.abort(),t(),C.current=t}),[x.search,_,H,O]);return Object(n.useEffect)((()=>{F((r=>{const n={...null!=r?r:{},defaultIndex:s,factoryQueryType:m.o.topNFlow,filterQuery:Object(d.a)(t),flowTarget:a,ip:f,pagination:Object(p.a)(v,E),timerange:{interval:"12h",from:k,to:e},sort:P};return o()(r,n)?r:n}))}),[v,e,t,s,f,E,k,P,a]),Object(n.useEffect)((()=>(q(R),()=>{N.current.unsubscribe(),I.current.abort()})),[R,q]),Object(n.useEffect)((()=>{O&&(M(!1),N.current.unsubscribe(),I.current.abort())}),[O]),[D,A]}},852:function(e,t,a){"use strict";a.d(t,"a",(function(){return h})),a.d(t,"b",(function(){return O}));var r=a(3),n=a(5),s=a(85),o=a.n(s),i=a(19),l=a(166),c=a(71),u=a(18),d=a(211),p=a(294),b=a(214),m=a(94),g=a(4);const f=g.i18n.translate("xpack.securitySolution.networkTls.errorSearchDescription",{defaultMessage:"An error has occurred on network tls search"}),y=g.i18n.translate("xpack.securitySolution.networkTls.failSearchDescription",{defaultMessage:"Failed to run search on network tls"});var T=a(74),w=a(192);const h="networkTlsQuery",O=({endDate:e,filterQuery:t,flowTarget:a,id:s=h,indexNames:g,ip:O,skip:k,startDate:S,type:j})=>{const v=Object(n.useMemo)((()=>b.e.tlsSelector()),[]),{activePage:E,limit:P,sort:x}=Object(c.a)((e=>v(e,j,a))),{data:C}=Object(u.j)().services,I=Object(n.useRef)(r.noop),N=Object(n.useRef)(new AbortController),D=Object(n.useRef)(new i.Subscription),[M,R]=Object(n.useState)(!1),[F,$]=Object(n.useState)(null),A=Object(n.useCallback)((e=>{$((t=>t?{...t,pagination:Object(p.a)(e,P)}:t))}),[P]),[Q,_]=Object(n.useState)({tls:[],id:h,inspect:{dsl:[],response:[]},isInspected:!1,loadPage:A,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1},refetch:I.current,totalCount:-1}),{addError:H,addWarning:q}=Object(w.a)(),U=Object(n.useCallback)((e=>{if(null==e||k)return;const t=async()=>{N.current=new AbortController,R(!0),D.current=C.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:N.current.signal}).subscribe({next:e=>{Object(l.isCompleteResponse)(e)?(R(!1),_((t=>({...t,tls:e.edges,inspect:Object(T.c)(e,t.inspect),pageInfo:e.pageInfo,refetch:I.current,totalCount:e.totalCount}))),D.current.unsubscribe()):Object(l.isErrorResponse)(e)&&(R(!1),q(f),D.current.unsubscribe())},error:e=>{R(!1),H(e,{title:y}),D.current.unsubscribe()}})};D.current.unsubscribe(),N.current.abort(),t(),I.current=t}),[C.search,H,q,k]);return Object(n.useEffect)((()=>{$((r=>{const n={...null!=r?r:{},defaultIndex:g,factoryQueryType:m.g.tls,filterQuery:Object(d.a)(t),flowTarget:a,ip:O,pagination:Object(p.a)(E,P),timerange:{interval:"12h",from:S,to:e},sort:x};return o()(r,n)?r:n}))}),[E,g,e,t,P,S,x,a,O,s]),Object(n.useEffect)((()=>(U(F),()=>{D.current.unsubscribe(),N.current.abort()})),[F,U]),Object(n.useEffect)((()=>{k&&(R(!1),D.current.unsubscribe(),N.current.abort())}),[k]),[M,Q]}}}]);