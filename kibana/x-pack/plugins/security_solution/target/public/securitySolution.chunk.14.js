/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[14],{1371:function(e,t,a){"use strict";a.r(t),a.d(t,"renderApp",(function(){return _i})),a.d(t,"createStore",(function(){return v.c})),a.d(t,"createInitialState",(function(){return v.b}));var n=a(50),i=a.n(n),l=a(5),r=a.n(l),o=a(138),s=a(58),c=a(55),u=a(263),d=a(42),m=a(16),p=a(180),b=a(255),g=a(1),E=a(71),v=a(73),h=a(35),f=a(46);const y=({toastLifeTimeMs:e=5e3})=>{const t=Object(d.useDispatch)(),a=Object(l.useMemo)((()=>v.a.errorsSelector()),[]),n=Object(E.a)(a),[{toasts:i},r]=Object(f.g)();return Object(l.useEffect)((()=>{n.forEach((({id:a,title:n,message:l})=>{i.some((e=>e.id===a))||r({type:"addToaster",toast:{color:"danger",id:a,iconType:"alert",title:n,errors:l,toastLifeTimeMs:e}}),t(h.a.removeError({id:a}))}))}),[t,r,n,e,i]),null};y.displayName="ErrorToastDispatcherComponent";const j=r.a.memo(y);var O=a(808),S=a(18),x=a(648);const w=({children:e})=>r.a.createElement(x.a.Provider,{value:Object(l.useReducer)(((e,t)=>{switch(t.type){case"updateRoute":return t.route;case"updateRouteWithOutSearch":return{...e,...t.route};case"updateSearch":return{...e,search:t.search};default:return e}}),x.b)},e),k=Object(l.memo)(w);var T=a(27),C=a(84);const I=Object(l.memo)((({children:e})=>{const t=Object(s.useLocation)(),a=Object(d.useDispatch)();return Object(l.useEffect)((()=>{a(C.a.showTimeline({id:T.TimelineId.active,show:!1}))}),[a,t.pathname]),Object(l.useEffect)((()=>{a({type:"userChangedUrl",payload:t})})),r.a.createElement(r.a.Fragment,null,e)}));I.displayName="RouteCapture";var P=a(3),M=a(177),L=a(85),N=a.n(L),F=a(86),D=a(21),z=a(395),B=a(4);B.i18n.translate("xpack.securitySolution.components.ml.api.errors.statusCodeFailureTitle",{defaultMessage:"Status Code:"}),B.i18n.translate("xpack.securitySolution.components.ml.api.errors.networkErrorFailureTitle",{defaultMessage:"Network Error:"}),B.i18n.translate("xpack.securitySolution.components.mlPopup.hooks.errors.indexPatternFetchFailureTitle",{defaultMessage:"Index pattern fetch failure"}),B.i18n.translate("xpack.securitySolution.components.hooks.eql.partialResponse",{defaultMessage:"EQL Preview Error"}),B.i18n.translate("xpack.securitySolution.components.hooks.errors.timeIntervalsNotDefined",{defaultMessage:"Time intervals are not defined."});var A=a(14),R=a(204),$=a(87),V=a(649);window["__react-beautiful-dnd-disable-dev-warnings"]=!0;const q=({browserFields:e,children:t})=>{const a=Object(d.useDispatch)(),n=Object(l.useMemo)((()=>C.b.getTimelineByIdSelector()),[]),i=Object(l.useMemo)((()=>v.d.getDataProvidersSelector()),[]),{timelines:o}=Object(S.j)().services,s=[o.getUseAddToTimelineSensor()],{dataProviders:c,timelineType:u}=Object(E.a)((e=>{var t;return Object(P.pick)(["dataProviders","timelineType"],null!==(t=n(e,A.i.active))&&void 0!==t?t:$.a)})),m=Object(E.a)(i),[,p]=Object(f.g)(),b=Object(l.useCallback)((e=>{const t=u===A.m.template?(e=>B.i18n.translate("xpack.securitySolution.hooks.useAddToTimeline.template.addedFieldMessage",{values:{fieldOrValue:e},defaultMessage:"Added {fieldOrValue} to timeline template"}))(e):(e=>B.i18n.translate("xpack.securitySolution.hooks.useAddToTimeline.addedFieldMessage",{values:{fieldOrValue:e},defaultMessage:"Added {fieldOrValue} to timeline"}))(e);Object(f.e)(t,p)}),[p,u]),g=Object(l.useCallback)((t=>{try{H(),null!=m&&(({activeTimelineDataProviders:e,browserFields:t,dataProviders:a,dispatch:n,onAddedToTimeline:i,result:l})=>{if(Object(R.p)(l))Object(z.d)({dataProviders:e,destination:l.destination,dispatch:n,source:l.source,timelineId:A.i.active});else if(Object(R.o)(l))Object(R.c)({activeTimelineDataProviders:e,dataProviders:a,dispatch:n,onAddedToTimeline:i,result:l,timelineId:A.i.active});else if(Object(R.i)(l)){var r,o;Object(D.addFieldToTimelineColumns)({browserFields:t,defaultsHeader:V.b,dispatch:n,result:l,timelineId:Object(D.getTimelineIdFromColumnDroppableId)(null!==(r=null===(o=l.destination)||void 0===o?void 0:o.droppableId)&&void 0!==r?r:"")})}})({activeTimelineDataProviders:c,browserFields:e,dataProviders:m,dispatch:a,onAddedToTimeline:b,result:t})}finally{document.body.classList.remove(F.d),Object(R.e)(t)&&document.body.classList.remove(R.b)}}),[c,e,m,a,b]);return r.a.createElement(M.DragDropContext,{onDragEnd:g,onBeforeCapture:G,sensors:s},t)};q.displayName="DragDropContextWrapperComponent";const _=r.a.memo(q,((e,t)=>N()(e.children,t.children)));_.displayName="DragDropContextWrapper";const G=e=>{Object(R.e)(e)||document.body.classList.add(F.d),Object(R.e)(e)&&document.body.classList.add(R.b)},H=()=>window.onscroll=()=>P.noop;var U=a(93),J=a(79);const Q=r.a.memo((()=>{const{chrome:e,docLinks:t}=Object(S.j)().services;return Object(l.useEffect)((()=>{e.setHelpExtension({appName:J.b,links:[{content:B.i18n.translate("xpack.securitySolution.chrome.helpMenu.documentation",{defaultMessage:"Security documentation"}),href:t.links.siem.guide,iconType:"documents",linkType:"custom",target:"_blank",rel:"noopener"},{content:B.i18n.translate("xpack.securitySolution.chrome.helpMenu.documentation.ecs",{defaultMessage:"ECS documentation"}),href:t.links.ecs.guide,iconType:"documents",linkType:"custom",target:"_blank",rel:"noopener"},{linkType:"discuss",href:"https://discuss.elastic.co/c/security",target:"_blank",rel:"noopener"}]})}),[]),null}));Q.displayName="HelpMenu";var W=a(270),K=a(77),Z=a(139),Y=a(271),X=a(66),ee=a(257),te=a(13);var ae=a(676);const ne=({search:e,urlKey:t})=>Object(Y.c)(Object(Y.d)(e),t);var ie=a(63),le=a(331);const re=({indexPattern:e,navTabs:t,pageName:a,urlState:n,search:i,pathName:r,history:o})=>{const[c,u]=Object(l.useState)(!0),{filterManager:m,savedQueries:p}=Object(S.j)().services.data.query,{pathname:b}=Object(s.useLocation)(),g=function(e){const t=Object(l.useRef)(e);return Object(l.useEffect)((()=>{t.current=e})),t.current}({pathName:r,pageName:a,urlState:n,search:i}),E=Object(le.c)(),v=a?Object(ie.b)(a):void 0,{setInitialStateFromUrl:h,updateTimeline:f,updateTimelineIsLoading:y}=(()=>{const e=Object(d.useDispatch)(),t=Object(l.useMemo)((()=>Object(ee.b)(e)),[e]),a=Object(l.useMemo)((()=>t=>e(C.a.updateIsLoading(t))),[e]),n=Object(l.useCallback)((({filterManager:n,indexPattern:i,pageName:l,savedQueries:r,urlStateToUpdate:o})=>{o.forEach((({urlKey:o,newUrlStateString:s})=>{if(o===Z.a.timerange&&((e,t)=>{const a=Object(Y.a)(e),n="global",i={linkTo:Object(P.get)("global.linkTo",a)},l=Object(P.get)("global.timerange.kind",a),r="timeline",o={linkTo:Object(P.get)("timeline.linkTo",a)},s=Object(P.get)("timeline.timerange.kind",a);if(Object(P.isEmpty)(i.linkTo)?t(K.b.removeGlobalLinkTo()):t(K.b.addGlobalLinkTo({linkToId:"timeline"})),Object(P.isEmpty)(o.linkTo)?t(K.b.removeTimelineLinkTo()):t(K.b.addTimelineLinkTo({linkToId:"global"})),s){if("absolute"===s){const e=Object(X.a)(Object(P.get)("timeline.timerange",a));t(K.b.setAbsoluteRangeDatePicker({...e,id:r}))}if("relative"===s){const e=Object(X.a)(Object(P.get)("timeline.timerange",a));t(K.b.setRelativeRangeDatePicker({...e,id:r}))}}if(l){if("absolute"===l){const e=Object(X.a)(Object(P.get)("global.timerange",a));t(K.b.setAbsoluteRangeDatePicker({...e,id:n}))}if("relative"===l){const e=Object(X.a)(Object(P.get)("global.timerange",a));t(K.b.setRelativeRangeDatePicker({...e,id:n}))}}})(s,e),o===Z.a.sourcerer){const t=Object(Y.a)(s);null!=t&&Object.keys(t).filter((e=>!(e===te.SourcererScopeName.default&&Object(Y.g)(l)))).forEach((a=>{var n,i,l,r;return e(K.c.setSelectedDataView({id:a,selectedDataViewId:null!==(n=null===(i=t[a])||void 0===i?void 0:i.id)&&void 0!==n?n:null,selectedPatterns:null!==(l=null===(r=t[a])||void 0===r?void 0:r.selectedPatterns)&&void 0!==l?l:[]}))}))}if(o===Z.a.appQuery&&null!=i){const t=Object(Y.a)(s);null!=t&&e(K.b.setFilterQuery({id:"global",query:t.query,language:t.language}))}if(o===Z.a.filters){const e=Object(Y.a)(s);n.setFilters(e||[])}if(o===Z.a.savedQuery){const t=Object(Y.a)(s);null!=t&&""!==t&&r.getSavedQuery(t).then((t=>{n.setFilters(t.attributes.filters||[]),e(K.b.setFilterQuery({id:"global",...t.attributes.query})),e(K.b.setSavedQuery({id:"global",savedQuery:t}))}))}if(o===Z.a.timeline){const e=Object(Y.a)(s);null!=e&&""!==e.id&&Object(ee.h)({activeTimelineTab:e.activeTab,duplicate:!1,graphEventId:e.graphEventId,timelineId:e.id,openTimeline:e.isOpen,updateIsLoading:a,updateTimeline:t})}}))}),[e,t,a]);return Object.freeze({setInitialStateFromUrl:n,updateTimeline:t,updateTimelineIsLoading:a})})(),j=Object(l.useCallback)((t=>{const l=[],s=[];(E?null==v?void 0:v.skipUrlState:Object(ae.b)(t))?ae.a.forEach((e=>{s.push({urlStateToReplace:"",urlStateKey:e})})):ae.a.forEach((e=>{const t=se({urlKey:e,search:i});if(t){const i=ce({isFirstPageLoad:c,newUrlStateString:t,updateTimerange:Object(Y.g)(a)||c,urlKey:e});i&&s.push(i);const r=i?Object(Y.b)(i.urlStateToReplace):t;(c||Object(Y.g)(a)&&r!==t)&&(e===Z.a.timeline&&ue(t,n.timeline)||l.push({urlKey:e,newUrlStateString:r}))}else s.push({urlStateToReplace:oe(n,e),urlStateKey:e})})),Object(Y.l)(s,r,i,o),h({filterManager:m,indexPattern:e,pageName:a,savedQueries:p,urlStateToUpdate:l})}),[m,o,e,a,r,p,i,h,n,c,E,null==v?void 0:v.skipUrlState]);return Object(l.useEffect)((()=>{if(b!==r)return;const e=Object(Y.f)(a),t=E?null==v?void 0:v.skipUrlState:Object(ae.b)(e);if(N()(n,g.urlState)||c||t)(c&&null!=a&&""!==a||r!==g.pathName)&&(j(e),u(!1));else{const e=ae.a.map((e=>({urlStateToReplace:oe(n,e),urlStateKey:e})));Object(Y.l)(e,r,i,o)}}),[c,o,r,a,g,n,b,j,i,E,null==v?void 0:v.skipUrlState]),Object(l.useEffect)((()=>{var e;document.title=E?`${null!==(e=null==v?void 0:v.title)&&void 0!==e?e:""} - Kibana`:`${Object(Y.e)(a,t)} - Kibana`}),[a,t,E,v]),Object(l.useEffect)((()=>{(({oldSearch:e,search:t,timelineIdFromReduxStore:a,updateTimeline:n,updateTimelineIsLoading:i})=>{const l=ne({urlKey:Z.a.timeline,search:null!=e?e:""}),r=ne({urlKey:Z.a.timeline,search:t});if(null!=l&&null!=r){var o,s;let e=null,t=null;try{e=Object(Y.a)(r)}catch(e){}try{t=Object(Y.a)(l)}catch(e){}const m=null===(o=e)||void 0===o?void 0:o.id,p=null===(s=t)||void 0===s?void 0:s.id;var c,u,d;m&&m!==p&&m!==a&&Object(ee.h)({activeTimelineTab:null!==(c=null===(u=e)||void 0===u?void 0:u.activeTab)&&void 0!==c?c:A.l.query,duplicate:!1,graphEventId:null===(d=e)||void 0===d?void 0:d.graphEventId,timelineId:m,openTimeline:!0,updateIsLoading:i,updateTimeline:n})}})({oldSearch:g.search,search:i,timelineIdFromReduxStore:n.timeline.id,updateTimeline:f,updateTimelineIsLoading:y})}),[i,g.search,n.timeline.id,f,y]),null},oe=(e,t)=>Object(Y.h)(e[t],t)?"":e[t],se=({search:e,urlKey:t})=>Object(Y.c)(Object(Y.d)(e),t),ce=({isFirstPageLoad:e,newUrlStateString:t,updateTimerange:a,urlKey:n})=>{if(Object(Y.h)(Object(Y.a)(t),n))return{urlStateToReplace:"",urlStateKey:n};if(n===Z.a.timerange&&a){const a=Object(Y.a)(t);if(null!=a&&null!=a.global)return{urlStateToReplace:Object(Y.m)(a,e),urlStateKey:n}}},ue=(e,t)=>{const a=Object(Y.a)(e);return null!=a&&a.id===t.id},de=r.a.memo((function(e){return re(e),null}),((e,t)=>e.pathName===t.pathName&&N()(e.urlState,t.urlState)&&N()(e.indexPattern,t.indexPattern)&&e.search===t.search&&N()(e.navTabs,t.navTabs))),me=Object(d.connect)(Y.i)((e=>{const[t]=Object(W.a)();return r.a.createElement(de,i()({},t,e))}));var pe=a(442),be=a(194),ge=a(173),Ee=a(224);var ve=a(296),he=a(165),fe=a(51),ye=a.n(fe),je=a(23),Oe=a.n(je),Se=a(178),xe=a(65),we=a(817);const ke=B.i18n.translate("xpack.securitySolution.components.mlPopover.jobsTable.filters.searchFilterPlaceholder",{defaultMessage:"e.g. rare_process_linux"}),Te=B.i18n.translate("xpack.securitySolution.components.mlPopover.jobsTable.filters.groupsLabel",{defaultMessage:"Groups"}),Ce=B.i18n.translate("xpack.securitySolution.components.mlPopover.jobsTable.filters.noGroupsAvailableDescription",{defaultMessage:"No Groups available"}),Ie=B.i18n.translate("xpack.securitySolution.components.mlPopover.jobsTable.filters.showAllJobsLabel",{defaultMessage:"Elastic jobs"}),Pe=B.i18n.translate("xpack.securitySolution.components.mlPopover.jobsTable.filters.showSiemJobsLabel",{defaultMessage:"Custom jobs"});var Me=a(679);const Le=({securityJobs:e,onSelectedGroupsChanged:t})=>{const[a,n]=Object(l.useState)(!1),[i,o]=Object(l.useState)([]),s=e.map((e=>e.groups)).flat().filter((e=>"siem"!==e&&"security"!==e)),c=Array.from(new Set(s));return Object(l.useEffect)((()=>{t(i)}),[i.sort().join()]),r.a.createElement(m.EuiPopover,{ownFocus:!0,button:r.a.createElement(m.EuiFilterButton,{"data-test-subj":"groups-filter-popover-button",iconType:"arrowDown",onClick:()=>n(!a),isSelected:a,numFilters:c.length,hasActiveFilters:i.length>0,numActiveFilters:i.length},Te),isOpen:a,closePopover:()=>n(!a),panelPaddingSize:"none",repositionOnScroll:!0},c.map(((e,t)=>r.a.createElement(m.EuiFilterSelectItem,{checked:i.includes(e)?"on":void 0,key:`${t}-${e}`,onClick:()=>Object(Me.a)(e,i,o)},`${e} (${s.filter((t=>t===e)).length})`))),0===c.length&&r.a.createElement(m.EuiFlexGroup,{gutterSize:"m",justifyContent:"spaceAround"},r.a.createElement(m.EuiFlexItem,{grow:!0},r.a.createElement(m.EuiIcon,{type:"minusInCircle"}),r.a.createElement(m.EuiSpacer,{size:"xs"}),r.a.createElement("p",null,Ce))))};Le.displayName="GroupsFilterPopoverComponent";const Ne=r.a.memo(Le);Ne.displayName="GroupsFilterPopover";const Fe=({securityJobs:e,onFilterChanged:t})=>{const[a,n]=Object(l.useState)(""),[i,o]=Object(l.useState)([]),[s,c]=Object(l.useState)(!1),[u,d]=Object(l.useState)(!1);Object(l.useEffect)((()=>{t({filterQuery:a,showCustomJobs:s,showElasticJobs:u,selectedGroups:i})}),[a,i,s,u,t]);const p=Object(l.useCallback)((e=>n(e.queryText.trim())),[n]),b=Object(l.useCallback)((()=>{d(!u),c(!1)}),[d,u,c]),g=Object(l.useCallback)((()=>{c(!s),d(!1)}),[d,s,c]);return r.a.createElement(m.EuiFlexGroup,{gutterSize:"m",justifyContent:"flexEnd"},r.a.createElement(m.EuiFlexItem,{grow:!0},r.a.createElement(m.EuiSearchBar,{"data-test-subj":"jobs-filter-bar",box:{placeholder:ke,incremental:!0},onChange:p})),r.a.createElement(m.EuiFlexItem,{grow:!1},r.a.createElement(m.EuiFilterGroup,null,r.a.createElement(Ne,{securityJobs:e,onSelectedGroupsChanged:o}))),r.a.createElement(m.EuiFlexItem,{grow:!1},r.a.createElement(m.EuiFilterGroup,null,r.a.createElement(m.EuiFilterButton,{hasActiveFilters:u,onClick:b,"data-test-subj":"show-elastic-jobs-filter-button",withNext:!0},Ie),r.a.createElement(m.EuiFilterButton,{hasActiveFilters:s,onClick:g,"data-test-subj":"show-custom-jobs-filter-button"},Pe))))};Fe.displayName="JobsTableFiltersComponent";const De=r.a.memo(Fe);De.displayName="JobsTableFilters";var ze=a(518);const Be=B.i18n.translate("xpack.securitySolution.components.mlPopup.jobsTable.jobNameColumn",{defaultMessage:"Job name"}),Ae=B.i18n.translate("xpack.securitySolution.components.mlPopup.jobsTable.tagsColumn",{defaultMessage:"Groups"}),Re=B.i18n.translate("xpack.securitySolution.components.mlPopup.jobsTable.runJobColumn",{defaultMessage:"Run job"}),$e=B.i18n.translate("xpack.securitySolution.components.mlPopup.jobsTable.noItemsDescription",{defaultMessage:"No Security Machine Learning jobs found"}),Ve=B.i18n.translate("xpack.securitySolution.components.mlPopup.jobsTable.createCustomJobButtonLabel",{defaultMessage:"Create custom job"});var qe=a(289);const _e=Oe()(m.EuiSwitch).withConfig({displayName:"StaticSwitch",componentId:"sc-1xsgv9-0"})([".euiSwitch__thumb,.euiSwitch__icon{transition:none;}"]);_e.displayName="StaticSwitch";const Ge=({job:e,isSecurityJobsLoading:t,onJobStateChange:a})=>{const[n,i]=Object(l.useState)(!1),o=Object(l.useCallback)((async t=>{i(!0),await a(e,e.latestTimestampMs||0,t.target.checked),i(!1)}),[e,i,a]);return r.a.createElement(m.EuiFlexGroup,{justifyContent:"spaceAround"},r.a.createElement(m.EuiFlexItem,{grow:!1},t||n||Object(qe.b)(e.jobState,e.datafeedState)?r.a.createElement(m.EuiLoadingSpinner,{size:"m","data-test-subj":"job-switch-loader"}):r.a.createElement(_e,{"data-test-subj":"job-switch",disabled:Object(qe.a)(e.jobState,e.datafeedState),checked:Object(qe.c)(e.jobState,e.datafeedState),onChange:o,showLabel:!1,label:""})))};Ge.displayName="JobSwitchComponent";const He=r.a.memo(Ge);He.displayName="JobSwitch";const Ue=Oe.a.div.withConfig({displayName:"JobNameWrapper",componentId:"sc-1foobv2-0"})(["margin:5px 0;"]);Ue.displayName="JobNameWrapper";const Je=({id:e,description:t,basePath:a})=>{const{services:{ml:n}}=Object(S.j)(),i=Object(Se.useMlHref)(n,a,{page:Se.ML_PAGES.ANOMALY_DETECTION_JOBS_MANAGE,pageState:{jobId:e}});return r.a.createElement(Ue,null,r.a.createElement(m.EuiText,{size:"s"},r.a.createElement(m.EuiLink,{"data-test-subj":"jobs-table-link",href:i,target:"_blank"},e)),r.a.createElement(m.EuiText,{color:"subdued",size:"xs"},t.length>200?`${t.substring(0,200)}...`:t))},Qe=(e,t,a)=>[{name:Be,render:({id:e,description:t})=>r.a.createElement(Je,{id:e,description:t,basePath:a})},{name:Ae,render:({groups:e})=>r.a.createElement(ze.a,{items:e,numberOfItemsToDisplay:0,popoverButtonTitle:`${e.length} Groups`,renderItem:(e,t)=>r.a.createElement(m.EuiBadge,{color:"hollow",key:`${e}-${t}`,"data-test-subj":"group"},e),dataTestPrefix:"groups"}),width:"80px"},{name:Re,render:a=>a.isCompatible?r.a.createElement(He,{job:a,isSecurityJobsLoading:e,onJobStateChange:t}):r.a.createElement(m.EuiIcon,{"aria-label":"Warning",size:"s",type:"alert",color:"warning"}),align:m.CENTER_ALIGNMENT,width:"80px"}],We=(e,t,a)=>e.slice(t*a,t*a+a),Ke=({isLoading:e,jobs:t,onJobStateChange:a})=>{const[n,i]=Object(l.useState)(0),o=Object(S.e)(),s={showPerPageOptions:!1,pageIndex:n,pageSize:5,totalItemCount:t.length};return Object(l.useEffect)((()=>{i(0)}),[t.length]),r.a.createElement(m.EuiBasicTable,{"data-test-subj":"jobs-table",columns:Qe(e,a,o),items:We(t,n,5),loading:e,noItemsMessage:r.a.createElement(Ye,{basePath:o}),pagination:s,responsive:!1,onChange:({page:e})=>{i(e.index)}})};Ke.displayName="JobsTableComponent";const Ze=r.a.memo(Ke);Ze.displayName="JobsTable";const Ye=r.a.memo((({basePath:e})=>{const{services:{ml:t}}=Object(S.j)(),a=Object(Se.useMlHref)(t,e,{page:Se.ML_PAGES.ANOMALY_DETECTION_CREATE_JOB_SELECT_INDEX});return r.a.createElement(m.EuiEmptyPrompt,{title:r.a.createElement("h3",null,$e),titleSize:"xs",actions:r.a.createElement(m.EuiButton,{href:a,iconType:"popout",iconSide:"right",size:"s",target:"_blank"},Ve)})}));Ye.displayName="NoItemsMessage";const Xe=Oe.a.div.withConfig({displayName:"ShowingContainer",componentId:"sc-8k6h3p-0"})(["user-select:none;margin-top:5px;"]);Xe.displayName="ShowingContainer";const et=({filterResultsLength:e})=>r.a.createElement(Xe,{"data-test-subj":"showing"},r.a.createElement(m.EuiText,{color:"subdued",size:"xs"},r.a.createElement(he.FormattedMessage,{"data-test-subj":"query-message",id:"xpack.securitySolution.components.mlPopup.showingLabel",defaultMessage:"Showing: {filterResultsLength} {filterResultsLength, plural, one {job} other {jobs}}",values:{filterResultsLength:e}})));et.displayName="ShowingCountComponent";const tt=r.a.memo(et);tt.displayName="ShowingCount";const at=()=>r.a.createElement(m.EuiText,{size:"s"},r.a.createElement(he.FormattedMessage,{id:"xpack.securitySolution.components.mlPopup.anomalyDetectionDescription",defaultMessage:"Run any of the Machine Learning jobs below to prepare for creating detection rules that produce alerts for detected anomalies, and to view anomalous events throughout the Security application. We’ve provided a collection of common detection jobs to get you started. If you wish to add your own custom ML jobs, create and add them to the “Security” group from the {machineLearning} application.",values:{machineLearning:r.a.createElement(m.EuiLink,{href:`${Object(S.e)()}/app/ml`,target:"_blank"},r.a.createElement(he.FormattedMessage,{id:"xpack.securitySolution.components.mlPopup.machineLearningLink",defaultMessage:"Machine Learning"}))}}));at.displayName="PopoverDescriptionComponent";const nt=r.a.memo(at);nt.displayName="PopoverDescription";const it=B.i18n.translate("xpack.securitySolution.components.mlPopup.mlJobSettingsButtonLabel",{defaultMessage:"ML job settings"}),lt=B.i18n.translate("xpack.securitySolution.components.mlPopup.upgradeTitle",{defaultMessage:"Upgrade to Elastic Platinum"}),rt=B.i18n.translate("xpack.securitySolution.components.mlPopup.upgradeButtonLabel",{defaultMessage:"Subscription plans"}),ot=B.i18n.translate("xpack.securitySolution.components.mlPopup.licenseButtonLabel",{defaultMessage:"Manage license"}),st=e=>B.i18n.translate("xpack.securitySolution.components.mlPopup.moduleNotCompatibleTitle",{values:{incompatibleJobCount:e},defaultMessage:"{incompatibleJobCount} {incompatibleJobCount, plural, =1 {job} other {jobs}} are currently unavailable"}),ct=B.i18n.translate("xpack.securitySolution.components.mlPopup.errors.startJobFailureTitle",{defaultMessage:"Start job failure"}),ut=B.i18n.translate("xpack.securitySolution.containers.errors.stopJobFailureTitle",{defaultMessage:"Stop job failure"}),dt=B.i18n.translate("xpack.securitySolution.components.mlPopup.errors.createJobFailureTitle",{defaultMessage:"Create job failure"}),mt=Oe.a.div.withConfig({displayName:"PopoverContentsDiv",componentId:"sc-fqnfg5-0"})(["width:384px;"]);mt.displayName="PopoverContentsDiv";const pt=()=>r.a.createElement(mt,{"data-test-subj":"ml-popover-upgrade-contents"},r.a.createElement(m.EuiPopoverTitle,null,lt),r.a.createElement(m.EuiText,{size:"s"},r.a.createElement(he.FormattedMessage,{id:"xpack.securitySolution.components.mlPopup.upgradeDescription",defaultMessage:"To access SIEM’s anomaly detection features, you must update your license to Platinum, start a free 30-day trial, or spin up a {cloudLink} on AWS, GCP, or Azure. You can then run Machine Learning jobs and view anomalies.",values:{cloudLink:r.a.createElement(m.EuiLink,{href:"https://www.elastic.co/cloud/",target:"_blank"},r.a.createElement(he.FormattedMessage,{id:"xpack.securitySolution.components.mlPopup.cloudLink",defaultMessage:"cloud deployment"}))}})),r.a.createElement(m.EuiSpacer,null),r.a.createElement(m.EuiFlexGroup,{gutterSize:"s",wrap:!0},r.a.createElement(m.EuiFlexItem,{grow:!1},r.a.createElement(m.EuiButton,{href:"https://www.elastic.co/subscriptions",iconType:"popout",iconSide:"right",target:"_blank"},rt)),r.a.createElement(m.EuiFlexItem,{grow:!1},r.a.createElement(m.EuiButton,{href:`${Object(S.e)()}/app/management/stack/license_management`,iconType:"gear",target:"_blank"},ot)))),bt=r.a.memo(pt);bt.displayName="UpgradeContents";var gt=a(493);const Et=Oe.a.div.withConfig({displayName:"PopoverContentsDiv",componentId:"sc-z6keba-0"})(["max-width:684px;max-height:90vh;overflow-y:auto;overflow-x:hidden;padding-bottom:15px;"]);function vt(e,t){switch(t.type){case"refresh":return{...e,refreshToggle:!e.refreshToggle};case"loading":return{...e,isLoading:!0};case"success":case"failure":return{...e,isLoading:!1};default:return e}}Et.displayName="PopoverContentsDiv";const ht={isLoading:!1,refreshToggle:!0},ft={filterQuery:"",showCustomJobs:!1,showElasticJobs:!1,selectedGroups:[]},yt=r.a.memo((()=>{const[{isLoading:e,refreshToggle:t},a]=Object(l.useReducer)(vt,ht),[n,i]=Object(l.useState)(!1),[o,s]=Object(l.useState)(ft),{isMlAdmin:c,isLicensed:u,loading:d,jobs:p}=Object(gt.a)(t),[,b]=Object(f.g)(),g=Object(S.j)().services.docLinks,E=Object(l.useCallback)(((e,t,n)=>jt(e,t,n,a,b)),[a,b]),v=(({jobs:e,selectedGroups:t,showCustomJobs:a,showElasticJobs:n,filterQuery:i})=>((e,t)=>e.filter((e=>null==t||e.id.includes(t)||e.description.includes(t))))(e.filter((e=>!a||a&&!e.isElasticJob)).filter((e=>!n||n&&e.isElasticJob)).filter((e=>0===t.length||t.some((t=>e.groups.includes(t))))),i))({jobs:p,...o}),h=p.filter((e=>!e.isCompatible)).length,y=Object(l.useMemo)((()=>p.filter((e=>e.isInstalled)).map((e=>e.id))),[p]);return u?c?r.a.createElement(m.EuiPopover,{anchorPosition:"downRight",id:"integrations-popover",button:r.a.createElement(m.EuiHeaderSectionItemButton,{"aria-expanded":n,"aria-haspopup":"true","aria-label":it,color:"primary","data-test-subj":"integrations-button",iconType:"arrowDown",iconSide:"right",onClick:()=>{i(!n),a({type:"refresh"})},textProps:{style:{fontSize:"1rem"}}},it),isOpen:n,closePopover:()=>i(!n),repositionOnScroll:!0},r.a.createElement(Et,{"data-test-subj":"ml-popover-contents"},r.a.createElement(m.EuiPopoverTitle,null,it),r.a.createElement(nt,null),r.a.createElement(m.EuiSpacer,null),r.a.createElement(De,{securityJobs:p,onFilterChanged:s}),r.a.createElement(tt,{filterResultsLength:v.length}),r.a.createElement(m.EuiSpacer,{size:"m"}),h>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement(m.EuiCallOut,{title:st(h),color:"warning",iconType:"alert",size:"s"},r.a.createElement("p",null,r.a.createElement(he.FormattedMessage,{defaultMessage:"We could not find any data, see {mlDocs} for more information on Machine Learning job requirements.",id:"xpack.securitySolution.components.mlPopup.moduleNotCompatibleDescription",values:{mlDocs:r.a.createElement("a",{href:`${g.links.siem.ml}`,rel:"noopener noreferrer",target:"_blank"},"Anomaly Detection with Machine Learning")}}))),r.a.createElement(m.EuiSpacer,{size:"m"})),r.a.createElement(Se.MLJobsAwaitingNodeWarning,{jobIds:y}),r.a.createElement(Ze,{isLoading:d||e,jobs:v,onJobStateChange:E}))):null:r.a.createElement(m.EuiPopover,{anchorPosition:"downRight",id:"integrations-popover",button:r.a.createElement(m.EuiHeaderSectionItemButton,{"aria-expanded":n,"aria-haspopup":"true","aria-label":it,color:"primary","data-test-subj":"integrations-button",iconType:"arrowDown",iconSide:"right",onClick:()=>i(!n),textProps:{style:{fontSize:"1rem"}}},it),isOpen:n,closePopover:()=>i(!n),repositionOnScroll:!0},r.a.createElement(bt,null))})),jt=async(e,t,a,n,i)=>{if(Ot(e,a),!e.isInstalled){n({type:"loading"});try{await Object(we.c)({configTemplate:e.moduleId,indexPatternName:e.defaultIndexPattern,jobIdErrorFilter:[e.id],groups:e.groups}),n({type:"success"})}catch(e){return Object(f.f)({title:dt,error:e,dispatchToaster:i}),n({type:"failure"}),void n({type:"refresh"})}}const l=ye.a.utc().subtract(14,"days").valueOf();if(a){const a=Math.max(t,l);try{await Object(we.d)({datafeedIds:[`datafeed-${e.id}`],start:a})}catch(e){Object(xe.e)(xe.a.COUNT,xe.b.JOB_ENABLE_FAILURE),Object(f.f)({title:ct,error:e,dispatchToaster:i})}}else try{await Object(we.e)({datafeedIds:[`datafeed-${e.id}`]})}catch(e){Object(xe.e)(xe.a.COUNT,xe.b.JOB_DISABLE_FAILURE),Object(f.f)({title:ut,error:e,dispatchToaster:i})}n({type:"refresh"})},Ot=(e,t)=>{Object(xe.e)(xe.a.COUNT,e.isElasticJob?t?xe.b.SIEM_JOB_ENABLED:xe.b.SIEM_JOB_DISABLED:t?xe.b.CUSTOM_JOB_ENABLED:xe.b.CUSTOM_JOB_DISABLED)};yt.displayName="MlPopover";var St=a(74),xt=a(604);const wt=B.i18n.translate("xpack.securitySolution.globalHeader.buttonAddData",{defaultMessage:"Add integrations"}),kt=r.a.memo((({setHeaderActionMenu:e})=>{const t=Object(l.useMemo)((()=>Object(ve.c)()),[]),{theme:a,http:{basePath:{prepend:n}}}=Object(S.j)().services,{pathname:i}=Object(s.useLocation)(),o=Object(l.useMemo)((()=>C.b.getTimelineByIdSelector()),[]),u=Object(E.b)((e=>{var t;return(null!==(t=o(e,A.i.active))&&void 0!==t?t:$.a).show})),d=Object(be.a)(i),p=Object(be.b)(i),b=Object(l.useMemo)((()=>n(g.a)),[n]);return Object(l.useEffect)((()=>(e((e=>Object(c.toMountPoint)(r.a.createElement(ve.b,{node:t}),{theme$:a.theme$})(e))),()=>{t.unmount(),e(void 0)})),[t,e,a.theme$]),r.a.createElement(ve.a,{node:t},r.a.createElement(m.EuiHeaderSection,{side:"right"},Object(St.e)(i)&&r.a.createElement(m.EuiHeaderSectionItem,null,r.a.createElement(yt,null)),r.a.createElement(m.EuiHeaderSectionItem,null,r.a.createElement(m.EuiHeaderLinks,null,r.a.createElement(m.EuiHeaderLink,{color:"primary","data-test-subj":"add-data",href:b,iconType:"indexOpen"},wt),p&&!u&&r.a.createElement(xt.a,{scope:d,"data-test-subj":"sourcerer"})))))}));kt.displayName="GlobalHeader";var Tt=a(430),Ct=(a(607),r.a.lazy((function(){return Promise.resolve().then(a.bind(null,607)).then((function(e){return{default:e.ToolbarButton}}))}))),It=(Object(Tt.c)(Ct),r.a.lazy((function(){return Promise.resolve().then(a.bind(null,607)).then((function(e){return{default:e.IconButtonGroup}}))}))),Pt=(Object(Tt.c)(It),r.a.lazy((function(){return Promise.all([a.e(10),a.e(26)]).then(a.bind(null,1378)).then((function(e){return{default:e.KibanaNoDataPage}}))}))),Mt=(Object(Tt.c)(Pt),r.a.lazy((function(){return a.e(10).then(a.bind(null,1360)).then((function(e){return{default:e.KibanaPageTemplate}}))}))),Lt=Object(Tt.c)(Mt),Nt=a(32),Ft=a(91),Dt=a(677),zt=a(399),Bt=a(200);var At=a(8),Rt=a(195),$t=a(449),Vt=a(90),qt=a.n(Vt);const _t=Oe()(m.EuiPanel).withConfig({displayName:"EuiPanelStyled",componentId:"sc-4kry1m-0"})(["position:fixed;top:95px;left:247px;bottom:0;width:340px;height:inherit;",""],(({$bottomOffset:e,theme:t})=>null!=e&&`\n      height: inherit;\n      bottom: ${e};\n      box-shadow:\n        // left\n        -${t.eui.euiSizeS} 0 ${t.eui.euiSizeS} -${t.eui.euiSizeS} rgb(0 0 0 / 15%), \n        // right\n        ${t.eui.euiSizeS} 0 ${t.eui.euiSizeS} -${t.eui.euiSizeS} rgb(0 0 0 / 15%), \n        // bottom inset to match timeline bar top shadow\n        inset 0 -${t.eui.euiSizeXS} ${t.eui.euiSizeXS} -${t.eui.euiSizeXS} rgb(0 0 0 / 6%); \n      `)),Gt=({onClose:e,onOutsideClick:t,title:a,categories:n,items:i,bottomOffset:o})=>{const s=Object(m.useIsWithinBreakpoints)(["l","xl"]),c=qt()("eui-yScroll"),u=s?o:void 0,d=Object(l.useCallback)((t=>{t.key===m.keys.ESCAPE&&e()}),[e]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(m.EuiWindowEvent,{event:"keydown",handler:d}),r.a.createElement(m.EuiPortal,null,r.a.createElement(m.EuiFocusTrap,{autoFocus:!0},r.a.createElement(m.EuiOutsideClickDetector,{onOutsideClick:t},r.a.createElement(_t,{className:c,hasShadow:!u,$bottomOffset:u,borderRadius:"none",paddingSize:"l","data-test-subj":"groupedNavPanel"},r.a.createElement(m.EuiFlexGroup,{direction:"column",gutterSize:"l",alignItems:"flexStart"},r.a.createElement(m.EuiFlexItem,null,r.a.createElement(m.EuiTitle,{size:"xs"},r.a.createElement("strong",null,a))),r.a.createElement(m.EuiFlexItem,null,r.a.createElement(m.EuiDescriptionList,null,n?r.a.createElement(Ut,{categories:n,items:i,onClose:e}):r.a.createElement(Jt,{items:i,onClose:e})))))))))},Ht=r.a.memo(Gt),Ut=({categories:e,items:t,onClose:a})=>{const n=new Map(t.map((e=>[e.id,e])));return r.a.createElement(r.a.Fragment,null,e.map((({label:e,linkIds:t})=>{const i=t.reduce(((e,t)=>{const a=n.get(t);return a&&e.push(a),e}),[]);return r.a.createElement(l.Fragment,{key:e},r.a.createElement(m.EuiTitle,{size:"xxxs"},r.a.createElement("h2",null,e)),r.a.createElement(m.EuiHorizontalRule,{margin:"s"}),r.a.createElement(Jt,{items:i,onClose:a}),r.a.createElement(m.EuiSpacer,{size:"l"}))})))},Jt=({items:e,onClose:t})=>r.a.createElement(r.a.Fragment,null,e.map((({id:e,href:a,onClick:n,label:i,description:o})=>r.a.createElement(l.Fragment,{key:e},r.a.createElement(m.EuiDescriptionListTitle,null,r.a.createElement("a",{"data-test-subj":`groupedNavPanelLink-${e}`,href:a,onClick:e=>{t(),n&&n(e)}},i)),r.a.createElement(m.EuiDescriptionListDescription,null,o))))),Qt=Oe()(m.EuiListGroupItem).withConfig({displayName:"EuiListGroupItemStyled",componentId:"sc-1lker6g-0"})(["font-weight:",";&.solutionGroupedNavItem--isPrimary{font-weight:",";}&:focus,&:focus-within,&:hover,&.solutionGroupedNavItem--isActive{background-color:",";}.solutionGroupedNavItemButton:focus,.solutionGroupedNavItemButton:focus-within,.solutionGroupedNavItemButton:hover{background-color:",";}"],(({theme:e})=>e.eui.euiFontWeightRegular),(({theme:e})=>e.eui.euiFontWeightBold),(({theme:e})=>Object(m.transparentize)(e.eui.euiColorPrimary,.1)),(({theme:e})=>Object(m.transparentize)(e.eui.euiColorPrimary,.1))),Wt=e=>"render"in e,Kt=({...e})=>r.a.createElement("svg",i()({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),r.a.createElement("path",{fillRule:"evenodd",d:"M3 3.5h3v3H3v-3zm-1 0a1 1 0 011-1h3a1 1 0 011 1v3a1 1 0 01-1 1H3a1 1 0 01-1-1v-3zm1 7h3v3H3v-3zm-1 0a1 1 0 011-1h3a1 1 0 011 1v3a1 1 0 01-1 1H3a1 1 0 01-1-1v-3zm11-7h-3v3h3v-3zm-3-1a1 1 0 00-1 1v3a1 1 0 001 1h3a1 1 0 001-1v-3a1 1 0 00-1-1h-3zm0 8h3v3h-3v-3zm-1 0a1 1 0 011-1h3a1 1 0 011 1v3a1 1 0 01-1 1h-3a1 1 0 01-1-1v-3z",clipRule:"evenodd"})),Zt=({items:e,selectedId:t,footerItems:a=[],bottomOffset:n})=>{const i=Object(m.useIsWithinBreakpoints)(["xs","s"]),[o,s]=Object(l.useState)(null),c=Object(l.useRef)(null),u=e=>{c.current=e,s(e)},d=Object(l.useCallback)((()=>{c.current=null,s(null)}),[]),p=Object(l.useCallback)((()=>{const e=c.current;setTimeout((()=>{c.current===e&&d()}))}),[d]),b=Object(l.useMemo)((()=>[...e,...a].reduce(((e,t)=>((e=>!Wt(e))(t)&&t.items&&t.items.length>0&&(e[t.id]={title:t.label,panelItems:t.items,categories:t.categories}),e)),{})),[e,a]),g=Object(l.useMemo)((()=>{if(null==o||!b[o])return null;const{panelItems:e,title:t,categories:a}=b[o];return r.a.createElement(Ht,{onClose:d,onOutsideClick:p,items:e,title:t,categories:a,bottomOffset:n})}),[o,n,b,d,p]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(m.EuiFlexGroup,{gutterSize:"none",direction:"column"},r.a.createElement(m.EuiFlexItem,null,r.a.createElement(m.EuiFlexGroup,{gutterSize:"none",direction:"column"},r.a.createElement(m.EuiFlexItem,null,r.a.createElement(m.EuiListGroup,{gutterSize:"none"},r.a.createElement(Xt,{items:e,selectedId:t,activePanelNavId:o,isMobileSize:i,navItemsById:b,onOpenPanelNav:u}))),r.a.createElement(m.EuiFlexItem,{grow:!1},r.a.createElement(m.EuiListGroup,{gutterSize:"none"},r.a.createElement(Xt,{items:a,selectedId:t,activePanelNavId:o,isMobileSize:i,navItemsById:b,onOpenPanelNav:u})))))),g)},Yt=r.a.memo(Zt),Xt=({items:e,selectedId:t,activePanelNavId:a,isMobileSize:n,navItemsById:i,onOpenPanelNav:l})=>r.a.createElement(r.a.Fragment,null,e.map((e=>r.a.createElement(ta,{key:e.id,item:e,isSelected:t===e.id,isActive:a===e.id,hasPanelNav:!n&&e.id in i,onOpenPanelNav:l})))),ea=({item:e,isSelected:t,isActive:a,hasPanelNav:n,onOpenPanelNav:o})=>{if(Wt(e))return r.a.createElement(l.Fragment,{key:e.id},e.render(t));const{id:s,href:c,label:u,onClick:d}=e,p=qt()("solutionGroupedNavItem",{"solutionGroupedNavItem--isActive":a,"solutionGroupedNavItem--isPrimary":t}),b=qt()("solutionGroupedNavItemButton");return r.a.createElement(m.EuiLink,{key:s,href:c,onClick:d,color:t?"primary":"text","data-test-subj":`groupedNavItemLink-${s}`},r.a.createElement(Qt,i()({className:p,color:t?"primary":"text",label:u,size:"s"},n?{extraAction:{className:b,color:a?"primary":"text",onClick:e=>{e.preventDefault(),e.stopPropagation(),o(s)},iconType:Kt,iconSize:"m","aria-label":"Toggle group nav","data-test-subj":`groupedNavItemButton-${s}`,alwaysShow:!0}}:{})))},ta=r.a.memo(ea),aa=({...e})=>r.a.createElement("svg",i()({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),r.a.createElement("path",{d:"M14.5 1.5L15 1.5L15 0.999999L14.5 0.999999L14.5 1.5ZM2.50018 7L2.15128 6.64186C1.98519 6.80366 1.95214 7.05842 2.07144 7.25725L2.50018 7ZM8.99958 13.5L8.74229 13.9287C8.93901 14.0468 9.19083 14.0158 9.35308 13.8536L8.99958 13.5ZM4.00018 9.5L3.57144 9.75725C3.59247 9.7923 3.61772 9.82465 3.64663 9.85355L4.00018 9.5ZM6.50018 12L6.14663 12.3536C6.17552 12.3824 6.20785 12.4077 6.24289 12.4287L6.50018 12ZM10.7526 8.71583L11.1263 9.04802L10.7526 8.71583ZM10.5 9.3802L10 9.3802L10.5 9.3802ZM7.28418 5.24741L7.61636 5.62111L7.28418 5.24741ZM6.61982 5.5L6.61982 6L6.61982 5.5ZM10.5 11.5857L11 11.5857L10.5 11.5857ZM10.207 12.2929L10.5605 12.6465L10.207 12.2929ZM14.5 2.599L15 2.599L14.5 2.599ZM13.401 1.5L13.401 0.999999L13.401 1.5ZM13.401 2L14.5 2L14.5 0.999999L13.401 0.999999L13.401 2ZM14 1.5L14 2.599L15 2.599L15 1.5L14 1.5ZM7.61636 5.62111L10.4114 3.13666L9.74701 2.38925L6.952 4.8737L7.61636 5.62111ZM4.44648 6L6.61982 6L6.61981 5L4.44648 5L4.44648 6ZM2.84909 7.35814L4.09758 6.14186L3.39977 5.42557L2.15128 6.64186L2.84909 7.35814ZM12.8634 5.58864L10.3789 8.38365L11.1263 9.04802L13.6108 6.253L12.8634 5.58864ZM10 9.3802L10 11.5857L11 11.5857L11 9.3802L10 9.3802ZM9.85352 11.9393L8.64608 13.1464L9.35308 13.8536L10.5605 12.6465L9.85352 11.9393ZM6.85374 11.6464L4.35374 9.14645L3.64663 9.85355L6.14663 12.3536L6.85374 11.6464ZM4.42893 9.24275L2.92893 6.74275L2.07144 7.25725L3.57144 9.75725L4.42893 9.24275ZM9.25687 13.0713L6.75748 11.5713L6.24289 12.4287L8.74229 13.9287L9.25687 13.0713ZM10.3789 8.38365C10.1348 8.65823 10 9.01283 10 9.3802L11 9.3802C11 9.25774 11.045 9.13954 11.1263 9.04802L10.3789 8.38365ZM4.44648 5C4.05544 5 3.67986 5.1527 3.39977 5.42557L4.09758 6.14186C4.19094 6.0509 4.31614 6 4.44648 6L4.44648 5ZM6.952 4.8737C6.86047 4.95506 6.74227 5 6.61981 5L6.61982 6C6.98719 6 7.34178 5.86518 7.61636 5.62111L6.952 4.8737ZM10 11.5857C10 11.7183 9.94731 11.8455 9.85352 11.9393L10.5605 12.6465C10.8419 12.3652 11 11.9836 11 11.5857L10 11.5857ZM14 2.599C14 3.70112 13.5956 4.76491 12.8634 5.58864L13.6108 6.253C14.5057 5.24622 15 3.94603 15 2.599L14 2.599ZM13.401 0.999999C12.054 0.999999 10.7538 1.49433 9.74701 2.38925L10.4114 3.13666C11.2351 2.40445 12.2989 2 13.401 2L13.401 0.999999Z"}),r.a.createElement("path",{d:"M2.5 10.5L1.5 12.5V14.5H3.5L5.5 13.5",strokeLinecap:"round",strokeLinejoin:"round"}),r.a.createElement("path",{d:"M1 14.1667L2.5 10.5L5.5 13.5L1.83333 15H1V14.1667Z"}),r.a.createElement("circle",{cx:"10",cy:"6",r:"1"}),r.a.createElement("path",{d:"M5.5 10.5L8 8",strokeLinecap:"round",strokeLinejoin:"round"})),na=["/cases/configure","/administration","/rules/create","/get_started","/explore","/dashboards","/manage"],ia=()=>{const e=Object(le.c)(),{pathname:t}=Object(s.useLocation)(),{indicesExist:a,dataViewId:n}=Object(be.d)(te.SourcererScopeName.timeline),i=Object(S.j)().services.application.capabilities.siem.show,r=Object(l.useMemo)((()=>i&&(a||null===n)),[a,n,i]);return[Object(l.useMemo)((()=>!!r&&((e,t)=>{const a=Object(ie.c)().map((e=>e.path));return!(t?a:na).find((t=>Object(s.matchPath)(e,t)))})(t,e)),[r,t,e])]};var la=a(230),ra=a(97);const oa=({isSelected:e,title:t})=>r.a.createElement(Rt.k,{deepLinkId:At.a.landing,color:e?"primary":"text"},r.a.createElement(m.EuiListGroupItem,{label:t.toUpperCase(),size:"xs",color:e?"primary":"text",iconType:aa,iconProps:{color:e?"primary":"text"}}),r.a.createElement(m.EuiHorizontalRule,{margin:"xs"})),sa=r.a.memo(oa),ca=()=>{const e=Object($t.a)(),t=(()=>{const e=!Object(zt.a)(),t=Object(Rt.o)();return Object(l.useCallback)((a=>{return a.id===At.a.landing?{id:(n=a).id,render:e=>r.a.createElement(sa,{isSelected:e,title:n.title})}:(a=>({id:a.id,label:a.title,...t({deepLinkId:a.id}),...a.categories&&a.categories.length>0?{categories:a.categories}:{},...a.links&&a.links.length>0?{items:a.links.filter((t=>!(t.disabled||t.id===At.a.hostIsolationExceptions&&e))).map((e=>({id:e.id,label:e.title,description:e.description,...t({deepLinkId:e.id})})))}:{}}))(a);var n}),[t,e])})();return Object(l.useMemo)((()=>{const a=[],n=[];return e.forEach((e=>{var i;e.disabled||((i=e.id)===At.a.landing||i===At.a.administration?n.push(t(e)):a.push(t(e)))})),[a,n]}),[e,t])},ua=()=>{const[e,t]=ca(),a=(()=>{const[{pageName:e}]=Object(W.a)();return Object(l.useMemo)((()=>{var t;const[a]=Object(ie.a)(e);return null!==(t=null==a?void 0:a.id)&&void 0!==t?t:""}),[e])})(),n=Object(la.a)(),[i]=ia(),o=i||n?ra.b:void 0;return 0===e.length&&0===t.length?r.a.createElement(m.EuiLoadingSpinner,{size:"m","data-test-subj":"sideNavLoader"}):r.a.createElement(Yt,{items:e,footerItems:t,selectedId:a,bottomOffset:o})},da=B.i18n.translate("xpack.securitySolution.navigation.mainLabel",{defaultMessage:"Security"});var ma=a(816);const pa=()=>{const[e]=Object(W.a)(),t=Object(Y.i)(),{urlState:a}=Object(E.a)(t),{chrome:n,application:{getUrlForApp:i,navigateToUrl:o}}=Object(S.j)().services,{detailName:s,flowTarget:c,pageName:u,pathName:d,search:m,state:p,tabName:b}=e,v=[...Object(Bt.a)("usersEnabled")?[]:["users"]],h=Object(P.omit)(v,pe.a),f=Object(ma.a)();return Object(l.useEffect)((()=>{(d||u)&&f({detailName:s,flowTarget:c,navTabs:h,pageName:u,pathName:d,search:m,state:p,tabName:b},n,o)}),[n,u,d,m,p,s,c,b,i,o,h,f]),(({filters:e,query:t,navTabs:a,pageName:n,savedQuery:i,sourcerer:o,tabName:s,timeline:c,timerange:u})=>{const d=Object(le.c)(),m=Object(l.useCallback)((()=>{var e,t;return null!==(e=null===(t=s&&a[s]||a[n])||void 0===t?void 0:t.id)&&void 0!==e?e:""}),[n,s,a]),[p,b]=Object(l.useState)(m());Object(l.useEffect)((()=>{const e=m();e!==p&&b(e)}),[n,a,m,p]);const E=(({navTabs:e,selectedTabId:t,...a})=>{const{navigateTo:n,getAppUrl:i}=Object(Ft.i)(),r=Object(l.useCallback)((e=>{const{id:l,name:r,disabled:o}=e,s=t===l,c=Object(le.a)(e,a),u=i({deepLinkId:l,path:c});return{"data-href":u,"data-test-subj":`navigation-${l}`,disabled:o,href:u,id:l,isSelected:s,name:r,onClick:e=>{e.preventDefault(),n({deepLinkId:l,path:c})}}}),[i,n,t,a]),o=function(e){var t;const a=null===(t=Object(S.h)())||void 0===t?void 0:t.read,n=Object(zt.a)(),i=Object(Bt.a)("policyListEnabled"),r=Object(Nt.b)().services.application.capabilities;return Object(l.useMemo)((()=>r.siem.show?[{id:"main",name:"",items:[e[g.cc.landing]]},{...pe.b[Dt.a.dashboards],items:[e[g.cc.overview],e[g.cc.detectionAndResponse]]},{...pe.b[Dt.a.detect],items:[e[g.cc.alerts],e[g.cc.rules],e[g.cc.exceptions]]},{...pe.b[Dt.a.explore],items:[e[g.cc.hosts],e[g.cc.network],...null!=e[g.cc.users]?[e[g.cc.users]]:[]]},{...pe.b[Dt.a.investigate],items:a?[e[g.cc.timelines],e[g.cc.case]]:[e[g.cc.timelines]]},{...pe.b[Dt.a.manage],items:[e[g.cc.endpoints],...i?[e[g.cc.policies]]:[],e[g.cc.trustedApps],e[g.cc.eventFilters],...n?[e[g.cc.hostIsolationExceptions]]:[],e[g.cc.blocklist]]}]:a?[{...pe.b[Dt.a.investigate],items:[e[g.cc.case]]}]:[]),[r.siem.show,e,a,n,i])}(e);return Object(l.useMemo)((()=>o.map((e=>({...e,items:e.items.map((e=>r(e)))})))),[r,o])})({navTabs:a,selectedTabId:p,filters:e,query:t,savedQuery:i,sourcerer:o,timeline:c,timerange:u});return{name:da,icon:"logoSecurity",...d?{children:r.a.createElement(ua,null),closeFlyoutButtonPosition:"inside"}:{items:E}}})({query:a.query,filters:a.filters,navTabs:h,pageName:u,sourcerer:a.sourcerer,savedQuery:a.savedQuery,tabName:b,timeline:a.timeline,timerange:a.timerange})};var ba=a(12);const ga=()=>Object(ba.createSelector)(C.b.selectTimeline,(e=>{var t,a,n,i;return{activeTab:null!==(t=null==e?void 0:e.activeTab)&&void 0!==t?t:A.l.query,status:null!==(a=null==e?void 0:e.status)&&void 0!==a?a:A.k.draft,show:null!==(n=null==e?void 0:e.show)&&void 0!==n&&n,updated:null!==(i=null==e?void 0:e.updated)&&void 0!==i?i:void 0}}));var Ea=a(693);const va=Oe.a.div.withConfig({displayName:"StyledStickyWrapper",componentId:"sc-jbkt6d-0"})(["position:sticky;z-index:",";"],(e=>e.theme.eui.euiZHeaderBelowDataGrid)),ha=r.a.memo((()=>{const{globalKQLHeaderPortalNode:e}=Object(Ea.a)();return r.a.createElement(va,{id:"securitySolutionStickyKQL"},r.a.createElement(ve.b,{node:e}))}));ha.displayName="GlobalKQLHeader";var fa=a(22);const ya=B.i18n.translate("xpack.securitySolution.timeline.autosave.warning.title",{defaultMessage:"Auto-save disabled until refresh"}),ja=B.i18n.translate("xpack.securitySolution.timeline.autosave.warning.description",{defaultMessage:"Another user has made changes to this timeline. Any changes you make will not be auto-saved until you have refreshed this timeline to absorb those changes."}),Oa=B.i18n.translate("xpack.securitySolution.timeline.autosave.warning.refresh.title",{defaultMessage:"Refresh timeline"}),Sa=()=>{const e=Object(d.useDispatch)(),t=Object(f.g)()[1],{timelineId:a,newTimelineModel:n}=Object(E.a)(C.b.autoSaveMsgSelector),i=Object(l.useCallback)((()=>{null!=a&&null!=n&&(e(C.a.updateTimeline({id:a,timeline:n})),e(C.a.updateAutoSaveMsg({timelineId:null,newTimelineModel:null})),e(Object(fa.setTimelineRangeDatePicker)({from:Object(P.getOr)(0,"dateRange.start",n),to:Object(P.getOr)(0,"dateRange.end",n)})))}),[e,n,a]),o=Object(l.useMemo)((()=>r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,ja),r.a.createElement(m.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},r.a.createElement(m.EuiFlexItem,{grow:!1},r.a.createElement(m.EuiButton,{size:"s",onClick:i},Oa))))),[i]);return null!=a&&null!=n&&t({type:"addToaster",toast:{id:"AutoSaveWarningMsg",title:ya,color:"warning",iconType:"alert",toastLifeTimeMs:1e4,text:o}}),null};Sa.displayName="AutoSaveWarningMsgComponent";const xa=r.a.memo(Sa);var wa=a(812),ka=a(207),Ta=a(166),Ca=a(407),Ia=a(7),Pa=a(221),Ma=a(345);const La=({timelineId:e})=>{var t;const a=Object(l.useMemo)((()=>C.b.getTimelineByIdSelector()),[]),{cases:n,application:{navigateToApp:i}}=Object(S.j)().services,o=Object(d.useDispatch)(),{graphEventId:s,savedObjectId:c,status:u,title:p,timelineType:b}=Object(E.a)((t=>{var n;return Object(P.pick)(["graphEventId","savedObjectId","status","title","timelineType"],null!==(n=a(t,e))&&void 0!==n?n:$.a)})),[v,h]=Object(l.useState)(!1),[f,y]=Object(l.useState)(!1),j=Object(l.useCallback)((async t=>{y(!1),await i(g.y,{deepLinkId:At.a.case,path:null!=t?Object(Pa.a)({id:t.id}):Object(Pa.b)()}),o(Object(Ia.setInsertTimeline)({graphEventId:s,timelineId:e,timelineSavedObjectId:c,timelineTitle:p}))}),[o,s,i,c,e,p]),O=Object(S.h)(),x=Object(l.useCallback)((()=>{h((e=>!e))}),[]),w=Object(l.useCallback)((()=>h(!1)),[]),k=Object(l.useCallback)((()=>{w(),i(g.y,{deepLinkId:At.a.case,path:Object(Pa.b)()}).then((()=>{o(Object(Ia.setInsertTimeline)({graphEventId:s,timelineId:e,timelineSavedObjectId:c,timelineTitle:p.length>0?p:Ma.l})),o(Object(Ia.showTimeline)({id:A.i.active,show:!1}))}))}),[o,s,i,w,c,e,p]),T=Object(l.useCallback)((()=>{w(),y(!0)}),[y,w]),I=Object(l.useCallback)((()=>{h(!1)}),[]),M=Object(l.useMemo)((()=>r.a.createElement(m.EuiButton,{fill:!0,size:"m","data-test-subj":"attach-timeline-case-button",iconType:"arrowDown",iconSide:"right",onClick:x,disabled:u===A.k.draft||b!==A.m.default},Ma.c)),[x,u,b]),L=Object(l.useMemo)((()=>[r.a.createElement(m.EuiContextMenuItem,{key:"new-case","data-test-subj":"attach-timeline-new-case",onClick:k},Ma.e),r.a.createElement(m.EuiContextMenuItem,{key:"existing-case","data-test-subj":"attach-timeline-existing-case",onClick:T},Ma.d)]),[T,k]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(m.EuiPopover,{id:"singlePanel",button:M,isOpen:v,closePopover:I,panelPaddingSize:"none",anchorPosition:"downLeft"},r.a.createElement(m.EuiContextMenuPanel,{items:L})),f&&n.ui.getAllCasesSelectorModal({onRowClick:j,userCanCrud:null!==(t=null==O?void 0:O.crud)&&void 0!==t&&t,owner:[g.n]}))};La.displayName="AddToCaseButtonComponent";const Na=r.a.memo(La);var Fa=a(846),Da=a(813),za=a(220),Ba=a(19),Aa=a(169),Ra=a(72),$a=a(192);const Va=B.i18n.translate("xpack.securitySolution.timeline.kpiFailDescription",{defaultMessage:"An error has occurred"}),qa=B.i18n.translate("xpack.securitySolution.timeline.kpiFailSearchDescription",{defaultMessage:"Failed to load KPIs"});var _a=a(272),Ga=a(473);const Ha=e=>B.i18n.translate("xpack.securitySolution.timeline.flyout.header.closeTimelineButtonLabel",{defaultMessage:"Close {isTimeline, select, true {timeline} false {template}}",values:{isTimeline:e}}),Ua=B.i18n.translate("xpack.securitySolution.timeline.properties.unsavedLabel",{defaultMessage:"Unsaved"}),Ja=B.i18n.translate("xpack.securitySolution.timeline.properties.autosavedLabel",{defaultMessage:"Autosaved"}),Qa=B.i18n.translate("xpack.securitySolution.timeline.properties.inspectTimelineTitle",{defaultMessage:"Timeline"}),Wa=B.i18n.translate("xpack.securitySolution.timeline.kpis.processKpiTitle",{defaultMessage:"Processes"}),Ka=B.i18n.translate("xpack.securitySolution.timeline.kpis.hostKpiTitle",{defaultMessage:"Hosts"}),Za=B.i18n.translate("xpack.securitySolution.timeline.kpis.sourceIpKpiTitle",{defaultMessage:"Source IPs"}),Ya=B.i18n.translate("xpack.securitySolution.timeline.kpis.destinationKpiTitle",{defaultMessage:"Destination IPs"}),Xa=B.i18n.translate("xpack.securitySolution.timeline.kpis.userKpiTitle",{defaultMessage:"Users"}),en=B.i18n.translate("xpack.securitySolution.timeline.properties.readMore",{defaultMessage:"Read More"}),tn=({isOpen:e,title:t})=>B.i18n.translate("xpack.securitySolution.timeline.properties.timelineToggleButtonAriaLabel",{values:{isOpen:e,title:t},defaultMessage:"{isOpen, select, false {Open} true {Close} other {Toggle}} timeline {title}"}),an=Oe()(m.EuiHealth).withConfig({displayName:"EuiHealthStyled",componentId:"sc-4g9vxo-0"})(["display:block;"]),nn=Oe()(m.EuiButtonEmpty).withConfig({displayName:"StyledEuiButtonEmpty",componentId:"sc-4g9vxo-1"})(["> span{padding:0;}"]),ln=Oe()(m.EuiFlexItem).withConfig({displayName:"TitleConatiner",componentId:"sc-4g9vxo-2"})(["overflow:hidden;display:inline-block;text-overflow:ellipsis;"]),rn=({timelineId:e,timelineStatus:t,timelineType:a,timelineTitle:n,updated:i,isOpen:o})=>{const s=Object(d.useDispatch)(),c=Object(l.useCallback)((()=>{s(C.a.showTimeline({id:e,show:!o})),Object(ka.j)()}),[s,o,e]),u=Object(P.isEmpty)(n)?a===A.m.template?Ma.k:Ma.l:n,p=Object(l.useMemo)((()=>t===A.k.draft?r.a.createElement(r.a.Fragment,null,Ua):r.a.createElement(r.a.Fragment,null,Ja," ",r.a.createElement(he.FormattedRelative,{"data-test-subj":"timeline-status",key:"timeline-status-autosaved",value:new Date(i)}))),[t,i]);return r.a.createElement(nn,{"aria-label":tn({isOpen:o,title:u}),className:ka.b,flush:"both","data-test-subj":"flyoutOverlay",size:"s",isSelected:o,onClick:c},r.a.createElement(m.EuiFlexGroup,{gutterSize:"none",alignItems:"center",justifyContent:"flexStart",responsive:!1},r.a.createElement(m.EuiFlexItem,{grow:!1},r.a.createElement(m.EuiToolTip,{position:"top",content:p},r.a.createElement(an,{color:t===A.k.draft?"warning":"success"}))),r.a.createElement(ln,{grow:!1},u),!o&&r.a.createElement(m.EuiFlexItem,{grow:!1},r.a.createElement(Ga.b,null))))},on=r.a.memo(rn);var sn=a(168),cn=a.n(sn),un=a(193);const dn=Oe()(m.EuiStat).withConfig({displayName:"NoWrapEuiStat",componentId:"sc-9jxvke-0"})(["& .euiStat__description{white-space:nowrap;}"]),mn=r.a.memo((({kpis:e,isLoading:t})=>{const a="0,0.[000]a",[n]=Object(S.p)(g.V),i=Object(l.useMemo)((()=>({process:null===e?Object(un.e)():cn()(e.processCount).format(a),user:null===e?Object(un.e)():cn()(e.userCount).format(a),host:null===e?Object(un.e)():cn()(e.hostCount).format(a),sourceIp:null===e?Object(un.e)():cn()(e.sourceIpCount).format(a),destinationIp:null===e?Object(un.e)():cn()(e.destinationIpCount).format(a)})),[e]),o=Object(l.useMemo)((()=>({process:cn()(null==e?void 0:e.processCount).format(n),user:cn()(null==e?void 0:e.userCount).format(n),host:cn()(null==e?void 0:e.hostCount).format(n),sourceIp:cn()(null==e?void 0:e.sourceIpCount).format(n),destinationIp:cn()(null==e?void 0:e.destinationIpCount).format(n)})),[e,n]);return r.a.createElement(m.EuiFlexGroup,{wrap:!0,"data-test-subj":"siem-timeline-kpis"},r.a.createElement(m.EuiFlexItem,{grow:!1},r.a.createElement(m.EuiToolTip,{position:"left",content:o.process},r.a.createElement(dn,{"data-test-subj":"siem-timeline-process-kpi",title:i.process,description:Wa,titleSize:"s",isLoading:t}))),r.a.createElement(m.EuiFlexItem,{grow:!1},r.a.createElement(m.EuiToolTip,{position:"left",content:o.user},r.a.createElement(dn,{"data-test-subj":"siem-timeline-user-kpi",title:i.user,description:Xa,titleSize:"s",isLoading:t}))),r.a.createElement(m.EuiFlexItem,{grow:!1},r.a.createElement(m.EuiToolTip,{position:"left",content:o.host},r.a.createElement(dn,{"data-test-subj":"siem-timeline-host-kpi",title:i.host,description:Ka,titleSize:"s",isLoading:t}))),r.a.createElement(m.EuiFlexItem,{grow:!1},r.a.createElement(m.EuiToolTip,{position:"left",content:o.sourceIp},r.a.createElement(dn,{"data-test-subj":"siem-timeline-source-ip-kpi",title:i.sourceIp,description:Za,titleSize:"s",isLoading:t}))),r.a.createElement(m.EuiFlexItem,{grow:!1,style:{minWidth:100}},r.a.createElement(m.EuiToolTip,{position:"left",content:o.destinationIp},r.a.createElement(dn,{"data-test-subj":"siem-timeline-destination-ip-kpi",title:i.destinationIp,description:Ya,titleSize:"s",isLoading:t}))))}));mn.displayName="TimelineKPIs";var pn=a(726);const bn=Oe()(m.EuiPanel).withConfig({displayName:"StyledPanel",componentId:"sc-12xgwp3-0"})(["margin:0 -1px 0;"]),gn=Oe()(m.EuiFlexItem).withConfig({displayName:"ActiveTimelinesContainer",componentId:"sc-12xgwp3-1"})(["overflow:hidden;"]),En=({timelineId:e})=>{const t=Object(d.useDispatch)(),{browserFields:a,indexPattern:n}=Object(be.d)(te.SourcererScopeName.timeline),{uiSettings:i}=Object(S.j)().services,o=Object(l.useMemo)((()=>Object(Ta.getEsQueryConfig)(i)),[i]),s=Object(l.useMemo)((()=>C.b.getTimelineByIdSelector()),[]),{activeTab:c,dataProviders:u,kqlQuery:p,title:b,timelineType:g,status:v,updated:h,show:f,filters:y,kqlMode:j}=Object(E.a)((t=>{var a;return Object(P.pick)(["activeTab","dataProviders","kqlQuery","status","title","timelineType","updated","show","filters","kqlMode"],null!==(a=s(t,e))&&void 0!==a?a:$.a)})),O=Object(l.useMemo)((()=>!Object(P.isEmpty)(u)||!Object(P.isEmpty)(Object(P.get)("filterQuery.kuery.expression",p))),[u,p]),x=Object(l.useMemo)((()=>C.b.getKqlFilterQuerySelector()),[]),w=Object(d.useSelector)((t=>x(t,e))),k=Object(P.isEmpty)(u)&&Object(P.isEmpty)(w)&&"template"===g?" ":w,T=Object(l.useMemo)((()=>({query:k,language:"kuery"})),[k]),I=Object(l.useMemo)((()=>Object(ka.i)({config:o,dataProviders:u,indexPattern:n,browserFields:a,filters:y||[],kqlQuery:T,kqlMode:j})),[a,u,o,y,n,j,T]),M=Object(l.useCallback)((()=>{t(C.a.showTimeline({id:e,show:!1})),Object(ka.j)()}),[t,e]);return r.a.createElement(bn,{borderRadius:"none",grow:!1,paddingSize:"s",hasShadow:!1,"data-test-subj":"timeline-flyout-header-panel"},r.a.createElement(m.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1},r.a.createElement(Fa.b,{timelineId:e}),r.a.createElement(gn,{grow:!1},r.a.createElement(on,{timelineId:e,timelineType:g,timelineTitle:b,timelineStatus:v,isOpen:f,updated:h})),f&&r.a.createElement(m.EuiFlexItem,null,r.a.createElement(m.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s",responsive:!1},(c===A.l.query||c===A.l.eql)&&r.a.createElement(m.EuiFlexItem,{grow:!1},r.a.createElement(za.b,{compact:!0,queryId:`${e}-${c}`,inputId:"timeline",inspectIndex:0,isDisabled:!O||void 0===(null==I?void 0:I.filterQuery),title:Qa})),r.a.createElement(m.EuiFlexItem,{grow:!1},r.a.createElement(m.EuiToolTip,{content:Ha("default"===g)},r.a.createElement(m.EuiButtonIcon,{"aria-label":Ha("default"===g),"data-test-subj":"close-timeline",iconType:"cross",onClick:M})))))))},vn=r.a.memo(En),hn=Oe.a.div.withConfig({displayName:"StyledDiv",componentId:"sc-12xgwp3-2"})(["display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;overflow:hidden;word-break:break-word;"]),fn=({description:e,onclick:t})=>{const[a,n]=Object(pn.a)(e);return r.a.createElement(r.a.Fragment,null,r.a.createElement(hn,{ref:n},e),a&&r.a.createElement(m.EuiButtonEmpty,{flush:"left",onClick:t},en))},yn=Oe()(m.EuiFlexGroup).withConfig({displayName:"StyledTimelineHeader",componentId:"sc-12xgwp3-3"})([""," flex:0;"],(({theme:e})=>`margin: ${e.eui.euiSizeXS} ${e.eui.euiSizeS} 0 ${e.eui.euiSizeS};`)),jn=Oe.a.span.withConfig({displayName:"TimelineStatusInfoContainer",componentId:"sc-12xgwp3-4"})([""," white-space:nowrap;"],(({theme:e})=>`margin-left: ${e.eui.euiSizeS};`)),On=Oe.a.div.withConfig({displayName:"KpisContainer",componentId:"sc-12xgwp3-5"})(["",""],(({theme:e})=>`margin-right: ${e.eui.euiSizeM};`)),Sn=Oe()(m.EuiFlexItem).withConfig({displayName:"RowFlexItem",componentId:"sc-12xgwp3-6"})(["flex-direction:row;align-items:center;"]),xn=Oe.a.h3.withConfig({displayName:"TimelineTitleContainer",componentId:"sc-12xgwp3-7"})(["display:-webkit-box;overflow:hidden;-webkit-line-clamp:1;-webkit-box-orient:vertical;word-break:break-word;"]),wn=({timelineId:e})=>{const t=Object(l.useMemo)((()=>C.b.getTimelineByIdSelector()),[]),{title:a,timelineType:n}=Object(E.a)((a=>{var n;return Object(P.pick)(["title","timelineType"],null!==(n=t(a,e))&&void 0!==n?n:$.a)})),i=Object(l.useMemo)((()=>n===A.m.template?Ma.k:Ma.l),[n]),o=Object(l.useMemo)((()=>a||i),[a,i]);return r.a.createElement(m.EuiToolTip,{content:o,position:"bottom"},r.a.createElement(m.EuiText,null,r.a.createElement(xn,{"data-test-subj":"timeline-title"},o)))},kn=r.a.memo(wn),Tn=({timelineId:e})=>{const t=Object(l.useMemo)((()=>C.b.getTimelineByIdSelector()),[]),a=Object(E.a)((a=>{var n;return(null!==(n=t(a,e))&&void 0!==n?n:$.a).description})),n=Object(d.useDispatch)(),i=Object(l.useCallback)((t=>{n(Object(Ia.setActiveTabTimeline)({id:e,activeTab:A.l.notes,scrollToTop:!0}))}),[n,e]);return r.a.createElement(m.EuiText,{size:"s","data-test-subj":"timeline-description"},r.a.createElement(fn,{description:a||Ma.f,onclick:i}))},Cn=r.a.memo(Tn),In=({timelineId:e})=>{const t=Object(l.useMemo)((()=>Object(ba.createSelector)(C.b.selectTimeline,(e=>{var t,a;return{status:null!==(t=null==e?void 0:e.status)&&void 0!==t?t:A.k.draft,updated:null!==(a=null==e?void 0:e.updated)&&void 0!==a?a:void 0}}))),[]),{status:a,updated:n}=Object(E.a)((a=>t(a,e)));return Object(l.useMemo)((()=>a===A.k.draft),[a])?r.a.createElement(m.EuiText,{size:"xs"},r.a.createElement(m.EuiTextColor,{color:"warning","data-test-subj":"timeline-status"},Ua)):r.a.createElement(m.EuiText,{size:"xs"},r.a.createElement(m.EuiTextColor,{color:"default"},Ja," ",r.a.createElement(he.FormattedRelative,{"data-test-subj":"timeline-status",key:"timeline-status-autosaved",value:new Date(n)})))},Pn=r.a.memo(In),Mn=({timelineId:e})=>{var t,a,n;const{selectedPatterns:i,indexPattern:o,docValueFields:s,browserFields:c}=Object(be.d)(te.SourcererScopeName.timeline),u=Object(l.useMemo)((()=>Object(_a.i)()),[]),p=Object(l.useMemo)((()=>Object(_a.b)()),[]),b=Object(l.useMemo)((()=>e===A.i.active),[e]),g=Object(E.a)((e=>b?{from:u(e.inputs.timeline),to:p(e.inputs.timeline),interval:""}:{from:u(e.inputs.global),to:p(e.inputs.global),interval:""})),{uiSettings:v}=Object(S.j)().services,h=Object(l.useMemo)((()=>Object(Ta.getEsQueryConfig)(v)),[v]),f=Object(l.useMemo)((()=>C.b.getTimelineByIdSelector()),[]),y=Object(d.useSelector)((t=>{var a;return null!==(a=f(t,e))&&void 0!==a?a:$.a})),{dataProviders:j,filters:O,timelineType:x,kqlMode:w,activeTab:k}=y,T=Object(l.useMemo)((()=>C.b.getKqlFilterQuerySelector()),[]),I=Object(d.useSelector)((t=>T(t,e))),M=Object(P.isEmpty)(j)&&Object(P.isEmpty)(I)&&"template"===x?" ":I,L=Object(l.useMemo)((()=>({query:M,language:"kuery"})),[M]),F=Object(l.useMemo)((()=>Object(ka.i)({config:h,dataProviders:j,indexPattern:o,browserFields:c,filters:O||[],kqlQuery:L,kqlMode:w})),[c,j,h,O,o,w,L]),D=Object(l.useMemo)((()=>Object(P.isEmpty)(j)&&Object(P.isEmpty)(O)&&Object(P.isEmpty)(L.query)||void 0===(null==F?void 0:F.filterQuery)),[j,O,L,F]),[z,B]=(({timerange:e,filterQuery:t,docValueFields:a,defaultIndex:n,isBlankTimeline:i})=>{const{data:r}=Object(S.j)().services,o=Object(l.useRef)(P.noop),s=Object(l.useRef)(new AbortController),c=Object(l.useRef)(new Ba.Subscription),[u,d]=Object(l.useState)(!1),[m,p]=Object(l.useState)(null),[b,g]=Object(l.useState)(null),{addError:E,addWarning:v}=Object($a.a)(),h=Object(l.useCallback)((e=>{if(null==e)return;const t=async()=>{s.current=new AbortController,d(!0),c.current=r.search.search(e,{strategy:"timelineSearchStrategy",abortSignal:s.current.signal}).subscribe({next:e=>{Object(Aa.isCompleteResponse)(e)?(d(!1),g(e),c.current.unsubscribe()):Object(Aa.isErrorResponse)(e)&&(d(!1),v(Va),c.current.unsubscribe())},error:e=>{d(!1),E(e,{title:qa}),c.current.unsubscribe()}})};c.current.unsubscribe(),s.current.abort(),t(),o.current=t}),[r.search,E,v]);return Object(l.useEffect)((()=>{p((i=>{const l={...null!=i?i:{},docValueFields:a,defaultIndex:n,timerange:e,filterQuery:t,factoryQueryType:Ra.v.kpi};return N()(i,l)?i:l}))}),[a,n,e,t]),Object(l.useEffect)((()=>(i?(d(!1),g(null)):h(m),()=>{c.current.unsubscribe(),s.current.abort()})),[i,m,h]),[u,b]})({defaultIndex:i,docValueFields:s,timerange:g,isBlankTimeline:D,filterQuery:null!==(t=null==F?void 0:F.filterQuery)&&void 0!==t?t:""}),R=null!==(a=null===(n=Object(S.h)())||void 0===n?void 0:n.crud)&&void 0!==a&&a;return r.a.createElement(yn,{alignItems:"center",gutterSize:"s"},r.a.createElement(m.EuiFlexItem,null,r.a.createElement(m.EuiFlexGroup,{"data-test-subj":"properties-left",direction:"column",gutterSize:"none"},r.a.createElement(Sn,null,r.a.createElement(kn,{timelineId:e}),r.a.createElement(Da.a,{timelineId:e,initialFocus:"title"}),r.a.createElement(jn,null,r.a.createElement(Pn,{timelineId:e}))),r.a.createElement(Sn,null,r.a.createElement(Cn,{timelineId:e}),r.a.createElement(Da.a,{timelineId:e,initialFocus:"description"})))),r.a.createElement(m.EuiFlexItem,{grow:!1},r.a.createElement(On,null,k===A.l.query?r.a.createElement(mn,{kpis:B,isLoading:z}):null)),r.a.createElement(m.EuiFlexItem,{grow:!1},r.a.createElement(m.EuiFlexGroup,{gutterSize:"s"},r.a.createElement(m.EuiFlexItem,{grow:!1},r.a.createElement(Ca.a,{timelineId:e})),R&&r.a.createElement(m.EuiFlexItem,{grow:!1},r.a.createElement(Na,{timelineId:e})))))};Mn.displayName="FlyoutHeaderComponent";const Ln=r.a.memo(Mn),Nn=Oe()(m.EuiPanel).withConfig({displayName:"DataProvidersPanel",componentId:"sc-oo43db-0"})(["border-radius:0;padding:0 4px 0 4px;user-select:none;z-index:",";"],(({theme:e})=>e.eui.euiZLevel9)),Fn=r.a.memo((({activeTab:e,showDataproviders:t,timelineId:a})=>r.a.createElement("div",{className:ka.e,"data-test-subj":"flyoutBottomBar"},t&&r.a.createElement(vn,{timelineId:a}),(t||!t&&e!==A.l.query)&&r.a.createElement(Nn,{paddingSize:"none"},r.a.createElement(wa.a,{timelineId:a,"data-test-subj":"dataProviders-bottomBar"})))));Fn.displayName="FlyoutBottomBar";var Dn=a(75),zn=a(78),Bn=a(338),An=a(770);const Rn=B.i18n.translate("xpack.securitySolution.timeline.tabs.queyTabTimelineTitle",{defaultMessage:"Query"}),$n=B.i18n.translate("xpack.securitySolution.timeline.tabs.eqlTabTimelineTitle",{defaultMessage:"Correlation"}),Vn=B.i18n.translate("xpack.securitySolution.timeline.tabs.analyserTabTimelineTitle",{defaultMessage:"Analyzer"}),qn=B.i18n.translate("xpack.securitySolution.timeline.tabs.notesTabTimelineTitle",{defaultMessage:"Notes"}),_n=B.i18n.translate("xpack.securitySolution.timeline.tabs.pinnedTabTimelineTitle",{defaultMessage:"Pinned"}),Gn=B.i18n.translate("xpack.securitySolution.timeline.tabs.sessionTabTimelineTitle",{defaultMessage:"Session View"}),Hn=Oe.a.div.attrs((({$isVisible:e=!1,isOverflowYScroll:t=!1})=>({style:{display:e?"flex":"none",overflow:t?"hidden scroll":"hidden"}}))).withConfig({displayName:"HideShowContainer",componentId:"sc-14igzi1-0"})(["flex:1;"]),Un=Object(l.lazy)((()=>Promise.all([a.e(7),a.e(23)]).then(a.bind(null,1373)))),Jn=Object(l.lazy)((()=>Promise.all([a.e(7),a.e(24)]).then(a.bind(null,1376)))),Qn=Object(l.lazy)((()=>a.e(31).then(a.bind(null,1366)))),Wn=Object(l.lazy)((()=>a.e(27).then(a.bind(null,1379)))),Kn=Object(l.lazy)((()=>Promise.all([a.e(7),a.e(32)]).then(a.bind(null,1367)))),Zn=Object(l.lazy)((()=>a.e(33).then(a.bind(null,1368)))),Yn=Object(l.memo)((({renderCellValue:e,rowRenderers:t,timelineId:a})=>r.a.createElement(l.Suspense,{fallback:r.a.createElement(m.EuiLoadingContent,{lines:10})},r.a.createElement(Un,{renderCellValue:e,rowRenderers:t,timelineId:a}))));Yn.displayName="QueryTab";const Xn=Object(l.memo)((({renderCellValue:e,rowRenderers:t,timelineId:a})=>r.a.createElement(l.Suspense,{fallback:r.a.createElement(m.EuiLoadingContent,{lines:10})},r.a.createElement(Jn,{renderCellValue:e,rowRenderers:t,timelineId:a}))));Xn.displayName="EqlTab";const ei=Object(l.memo)((({timelineId:e})=>r.a.createElement(l.Suspense,{fallback:r.a.createElement(m.EuiLoadingContent,{lines:10})},r.a.createElement(Qn,{timelineId:e}))));ei.displayName="GraphTab";const ti=Object(l.memo)((({timelineId:e})=>r.a.createElement(l.Suspense,{fallback:r.a.createElement(m.EuiLoadingContent,{lines:10})},r.a.createElement(Wn,{timelineId:e}))));ti.displayName="NotesTab";const ai=Object(l.memo)((({timelineId:e})=>r.a.createElement(l.Suspense,{fallback:r.a.createElement(m.EuiLoadingContent,{lines:10})},r.a.createElement(Zn,{timelineId:e}))));ai.displayName="SessionTab";const ni=Object(l.memo)((({renderCellValue:e,rowRenderers:t,timelineId:a})=>r.a.createElement(l.Suspense,{fallback:r.a.createElement(m.EuiLoadingContent,{lines:10})},r.a.createElement(Kn,{renderCellValue:e,rowRenderers:t,timelineId:a}))));ni.displayName="PinnedTab";const ii=Object(l.memo)((({activeTimelineTab:e,renderCellValue:t,rowRenderers:a,timelineId:n,timelineType:i})=>{const o=Object(l.useCallback)((e=>{switch(e){case A.l.graph:return r.a.createElement(ei,{timelineId:n});case A.l.notes:return r.a.createElement(ti,{timelineId:n});case A.l.session:return r.a.createElement(ai,{timelineId:n});default:return null}}),[n]),s=Object(l.useMemo)((()=>[A.l.graph,A.l.notes,A.l.session].includes(e)),[e]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Hn,{$isVisible:A.l.query===e,"data-test-subj":`timeline-tab-content-${A.l.query}`},r.a.createElement(Yn,{renderCellValue:t,rowRenderers:a,timelineId:n})),r.a.createElement(Hn,{$isVisible:A.l.pinned===e,"data-test-subj":`timeline-tab-content-${A.l.pinned}`},r.a.createElement(ni,{renderCellValue:t,rowRenderers:a,timelineId:n})),i===A.m.default&&r.a.createElement(Hn,{$isVisible:A.l.eql===e,"data-test-subj":`timeline-tab-content-${A.l.eql}`},r.a.createElement(Xn,{renderCellValue:t,rowRenderers:a,timelineId:n})),r.a.createElement(Hn,{$isVisible:s,isOverflowYScroll:e===A.l.session,"data-test-subj":`timeline-tab-content-${A.l.graph}-${A.l.notes}`},s&&o(e)))}));ii.displayName="ActiveTimelineTab";const li=Oe()(m.EuiBadge).withConfig({displayName:"CountBadge",componentId:"sc-14igzi1-1"})(["margin-left:",";"],(({theme:e})=>e.eui.paddingSizes.s)),ri=Oe()(m.EuiTab).withConfig({displayName:"StyledEuiTab",componentId:"sc-14igzi1-2"})([".euiTab__content{display:flex;flex-direction:row;white-space:pre;}:focus{text-decoration:none;> span > span{text-decoration:underline;}}"]),oi=({renderCellValue:e,rowRenderers:t,timelineId:a,timelineFullScreen:n,timelineType:i,graphEventId:o,sessionViewConfig:s,timelineDescription:c})=>{const u=Object(d.useDispatch)(),p=Object(l.useMemo)((()=>Object(An.a)()),[]),b=Object(l.useMemo)((()=>Object(An.g)()),[]),g=Object(l.useMemo)((()=>Object(An.e)()),[]),v=Object(l.useMemo)((()=>Object(An.d)()),[]),h=Object(l.useMemo)((()=>Object(An.c)()),[]),f=Object(l.useMemo)((()=>Object(An.b)()),[]),y=Object(E.b)((e=>p(e,a))),j=Object(E.b)((e=>b(e,a))),O=Object(E.b)((e=>g(e,a))),S=Object(E.a)((e=>h(e,a))),x=Object(E.a)((e=>f(e,a))),w=Object(E.a)((e=>v(e))),k=Object(l.useMemo)((()=>{const e=Object.values(x).reduce(((e,t)=>[...e,...t]),[]);return[...S,...e]}),[S,x]),T=Object(l.useMemo)((()=>w.filter((e=>k.includes(e.id))).length+(Object(P.isEmpty)(c)?0:1)),[w,k,c]),I=Object(l.useCallback)((e=>{u(C.a.setActiveTabTimeline({id:a,activeTab:e}))}),[u,a]),M=Object(l.useCallback)((()=>{I(A.l.query)}),[I]),L=Object(l.useCallback)((()=>{I(A.l.eql)}),[I]),N=Object(l.useCallback)((()=>{I(A.l.graph)}),[I]),F=Object(l.useCallback)((()=>{I(A.l.notes)}),[I]),D=Object(l.useCallback)((()=>{I(A.l.pinned)}),[I]),z=Object(l.useCallback)((()=>{I(A.l.session)}),[I]);return Object(l.useEffect)((()=>{o||y!==A.l.graph||M()}),[y,o,M]),r.a.createElement(r.a.Fragment,null,!n&&r.a.createElement(m.EuiTabs,null,r.a.createElement(ri,{"data-test-subj":`timelineTabs-${A.l.query}`,onClick:M,isSelected:y===A.l.query,disabled:!1,key:A.l.query},r.a.createElement("span",null,Rn),j&&r.a.createElement(Ga.b,null)),i===A.m.default&&r.a.createElement(ri,{"data-test-subj":`timelineTabs-${A.l.eql}`,onClick:L,isSelected:y===A.l.eql,disabled:!1,key:A.l.eql},r.a.createElement("span",null,$n),j&&r.a.createElement(Ga.a,null)),r.a.createElement(m.EuiTab,{"data-test-subj":`timelineTabs-${A.l.graph}`,onClick:N,isSelected:y===A.l.graph,disabled:!o,key:A.l.graph},Vn),r.a.createElement(m.EuiTab,{"data-test-subj":`timelineTabs-${A.l.session}`,onClick:z,isSelected:y===A.l.session,disabled:null===s,key:A.l.session,append:r.a.createElement(m.EuiBetaBadge,{label:J.a,size:"s"})},Gn),r.a.createElement(ri,{"data-test-subj":`timelineTabs-${A.l.notes}`,onClick:F,isSelected:y===A.l.notes,disabled:!1,key:A.l.notes},r.a.createElement("span",null,qn),j&&T>0&&r.a.createElement("div",null,r.a.createElement(li,null,T))),r.a.createElement(ri,{"data-test-subj":`timelineTabs-${A.l.pinned}`,onClick:D,isSelected:y===A.l.pinned,key:A.l.pinned},r.a.createElement("span",null,_n),j&&O>0&&r.a.createElement("div",null,r.a.createElement(li,null,O)))),r.a.createElement(ii,{activeTimelineTab:y,renderCellValue:e,rowRenderers:t,timelineId:a,timelineType:i,timelineDescription:c}))},si=Object(l.memo)(oi);var ci=a(237),ui=a(89),di=a(474);const mi=Oe.a.div.withConfig({displayName:"TimelineTemplateBadge",componentId:"sc-h40gwq-0"})(["background:",";color:#fff;padding:10px 15px;font-size:0.8em;"],(({theme:e})=>e.eui.euiColorVis3_behindText)),pi=({timelineId:e})=>{const t=Object(l.useMemo)((()=>C.b.getTimelineByIdSelector()),[]);return Object(E.b)((a=>{var n;return(null!==(n=t(a,e))&&void 0!==n?n:$.a).isSaving}))?r.a.createElement(m.EuiProgress,{size:"s",color:"primary",position:"absolute"}):null},bi=r.a.memo(pi),gi=({renderCellValue:e,rowRenderers:t,timelineId:a})=>{const n=Object(d.useDispatch)(),i=Object(l.useRef)(null),o=Object(l.useMemo)((()=>C.b.getTimelineByIdSelector()),[]),c=Object(l.useMemo)((()=>v.f.scopeIdSelector()),[]),{selectedPatterns:u,selectedDataViewId:p}=Object(E.a)((e=>c(e,te.SourcererScopeName.timeline))),{dataViewId:b,indexNames:g,graphEventId:h,savedObjectId:f,timelineType:y,description:j,sessionViewConfig:O}=Object(E.a)((e=>{var t;return Object(P.pick)(["indexNames","dataViewId","graphEventId","savedObjectId","timelineType","description","sessionViewConfig"],null!==(t=o(e,a))&&void 0!==t?t:$.a)})),{timelineFullScreen:x}=Object(ui.b)();Object(l.useEffect)((()=>{f||n(C.a.createTimeline({id:a,columns:Dn.b,dataViewId:p,indexNames:u,expandedDetail:zn.a.getExpandedDetail(),show:!1}))}),[]);const w=Object(l.useCallback)((()=>{!f||null==p||null===b&&0===g.length||b===p&&g.sort().join()===u.sort().join()||n(C.a.updateDataView({dataViewId:p,id:a,indexNames:u}))}),[n,f,p,b,u,g,a]);Object(l.useEffect)((()=>{w()}),[p,u]);const k=Object(l.useCallback)((()=>{var e;const t=null===(e=i.current)||void 0===e?void 0:e.querySelector(di.a);var a,n;null!=t?t.focus():null===(a=i.current)||void 0===a||null===(n=a.querySelector(".globalFilterBar__addButton"))||void 0===n||n.focus()}),[i]),T=Object(l.useCallback)((()=>{var e,t;null===(e=i.current)||void 0===e||null===(t=e.querySelector(`.${ka.d}`))||void 0===t||t.focus()}),[i]),I=Object(l.useCallback)((e=>{Object(D.isTab)(e)&&Object(ka.l)({containerElement:i.current,keyboardEvent:e,onSkipFocusBeforeEventsTable:k,onSkipFocusAfterEventsTable:T})}),[i,k,T]),M=Object(l.useMemo)((()=>({timelineId:a})),[a]),L=(()=>{const{search:e,pathname:t}=Object(s.useLocation)(),{spaces:a}=Object(S.j)().services,n=Object(l.useMemo)((()=>C.b.getTimelineByIdSelector()),[]),{resolveTimelineConfig:i,savedObjectId:o,show:c,graphEventId:u,activeTab:d}=Object(E.a)((e=>{var t;return null!==(t=n(e,A.i.active))&&void 0!==t?t:$.a})),p=Object(l.useCallback)((()=>{var n,l,s;if(!a||"conflict"!==(null==i?void 0:i.outcome)||null==(null==i?void 0:i.alias_target_id))return null;const p=new URLSearchParams(e),b=null!==(n=p.get(Z.a.timeline))&&void 0!==n?n:void 0,g={id:null!=o?o:"",isOpen:!!c,activeTab:d,graphEventId:u};let E=g;try{var v;E=null!==(v=Object(Y.a)(b))&&void 0!==v?v:g}catch(e){}const h=null===(l=E)||void 0===l?void 0:l.id,f=null!==(s=null==i?void 0:i.alias_target_id)&&void 0!==s?s:"",y={...E,id:f},j=Object(Y.b)(y);p.set(Z.a.timeline,j);const O=`${t}?${p.toString()}${window.location.hash}`;return r.a.createElement(r.a.Fragment,null,a.ui.components.getLegacyUrlConflict({objectNoun:Z.a.timeline,currentObjectId:h,otherObjectId:f,otherObjectPath:O}),r.a.createElement(m.EuiSpacer,null))}),[d,u,t,null==i?void 0:i.alias_target_id,null==i?void 0:i.outcome,o,e,c,a]);return Object(l.useMemo)((()=>p()),[p])})();return r.a.createElement(D.TimelineContext.Provider,{value:M},r.a.createElement(ci.B,{"data-test-subj":"timeline","data-timeline-id":a,onKeyDown:I,ref:i},r.a.createElement(bi,{timelineId:a}),y===A.m.template&&r.a.createElement(mi,null,Bn.f),L,r.a.createElement(ci.y,{$isVisible:!x,"data-test-subj":"timeline-hide-show-container"},r.a.createElement(vn,{timelineId:a}),r.a.createElement(Ln,{timelineId:a})),r.a.createElement(si,{graphEventId:h,sessionViewConfig:O,renderCellValue:e,rowRenderers:t,timelineId:a,timelineType:y,timelineDescription:j,timelineFullScreen:x})))};gi.displayName="StatefulTimelineComponent";const Ei=r.a.memo(gi),vi=B.i18n.translate("xpack.securitySolution.timeline.flyout.pane.timelinePropertiesAriaLabel",{defaultMessage:"Timeline Properties"});var hi=a(323),fi=a(381);const yi=Oe()(m.EuiFlyout).withConfig({displayName:"StyledEuiFlyout",componentId:"sc-jz8ju6-0"})(["animation:none;min-width:150px;z-index:",";"],(({theme:e})=>e.eui.euiZLevel4)),ji=Object(je.createGlobalStyle)([".indexPatternFieldEditorMaskOverlay{","}"],(({theme:e})=>`\n    z-index: ${e.eui.euiZLevel5};\n  `)),Oi=({timelineId:e,visible:t=!0})=>{const a=Object(d.useDispatch)(),n=Object(l.useCallback)((()=>{a(C.a.showTimeline({id:e,show:!1})),Object(ka.j)()}),[a,e]);return r.a.createElement("div",{"data-test-subj":"flyout-pane",style:{display:t?"block":"none"}},r.a.createElement(yi,{"aria-label":vi,className:"timeline-flyout","data-test-subj":"eui-flyout",hideCloseButton:!0,onClose:n,size:"100%",ownFocus:!1,style:{display:t?"block":"none"}},r.a.createElement(ji,null),r.a.createElement(Ei,{renderCellValue:fi.a,rowRenderers:hi.b,timelineId:e})))},Si=r.a.memo(Oi);Si.displayName="Pane";const xi=({timelineId:e,onAppLeave:t})=>{const a=Object(d.useDispatch)(),n=Object(l.useMemo)((()=>ga()),[]),{activeTab:i,show:o,status:s,updated:c}=Object(E.a)((t=>n(t,e))),[u,p]=Object(l.useState)(!0),[b,g]=Object(l.useState)(!0),v=Object(l.useRef)(null),h=Object(l.useRef)(null),f=Object(l.useCallback)((()=>{o&&!1===u&&p(!0)}),[o,u]),y=Object(l.useCallback)((e=>{p(!1),e.target.classList.contains("kbnSearchBar")&&(h.current=e.target,g((e=>!e)),window.setTimeout((()=>{null!==h.current&&h.current.focus()}),0))}),[]);return Object(l.useEffect)((()=>(null!=h.current&&(null!==v.current&&h.current.removeEventListener("blur",v.current),h.current.addEventListener("blur",f),v.current=f),()=>{null!=h.current&&null!==v.current&&h.current.removeEventListener("blur",v.current)})),[f,b]),Object(l.useEffect)((()=>{t(((e,t)=>{if(o&&a(C.a.showTimeline({id:A.i.active,show:!1})),(null!=t?t:"").includes("securitySolution")||s!==A.k.draft||null==c)return e.default();{const t=()=>{a(C.a.showTimeline({id:A.i.active,show:!0})),a(C.a.setActiveTabTimeline({id:A.i.active,activeTab:A.l.query})),a(C.a.toggleModalSaveTimeline({id:A.i.active,showModalSaveTimeline:!0}))};return e.confirm(B.i18n.translate("xpack.securitySolution.timeline.unsavedWorkMessage",{defaultMessage:"Leave Timeline with unsaved work?"}),B.i18n.translate("xpack.securitySolution.timeline.unsavedWorkTitle",{defaultMessage:"Unsaved changes"}),t)}}))}),[a,t,o,s,c]),r.a.createElement(m.EuiOutsideClickDetector,{onOutsideClick:y},r.a.createElement(r.a.Fragment,null,r.a.createElement(m.EuiFocusTrap,{disabled:!u},r.a.createElement(Si,{timelineId:e,visible:o})),r.a.createElement(Fn,{activeTab:i,timelineId:e,showDataproviders:!o})))};xi.displayName="FlyoutComponent";const wi=r.a.memo(xi);wi.displayName="Flyout";const ki="timeline-bottom-bar",Ti=r.a.memo((({onAppLeave:e})=>((()=>{const{search:e,pathname:t}=Object(s.useLocation)(),[a,n]=Object(l.useState)(!1),{spaces:i}=Object(S.j)().services,r=Object(l.useMemo)((()=>C.b.getTimelineByIdSelector()),[]),{resolveTimelineConfig:o,savedObjectId:c,show:u,activeTab:d,graphEventId:m}=Object(E.a)((e=>{var t;return null!==(t=r(e,A.i.active))&&void 0!==t?t:$.a})),p=Object(l.useCallback)((()=>{var l,r;const s=new URLSearchParams(e),p=null!==(l=s.get(Z.a.timeline))&&void 0!==l?l:void 0,b={id:null!=c?c:"",isOpen:!!u,activeTab:d,graphEventId:m};let g=b;try{var E;g=null!==(E=Object(Y.a)(p))&&void 0!==E?E:b}catch(e){}if(a||!i||"aliasMatch"!==(null==o?void 0:o.outcome)||null==(null==o?void 0:o.alias_target_id))return null;const v=null!==(r=o.alias_target_id)&&void 0!==r?r:"",h={...g,id:v},f=Object(Y.b)(h);s.set(Z.a.timeline,f);const y=`${t}?${s.toString()}`;i.ui.redirectLegacyUrl({path:y,aliasPurpose:o.alias_purpose,objectNoun:Z.a.timeline}),n(!0)}),[d,m,a,t,o,c,e,u,i]);Object(l.useEffect)((()=>{p()}),[p])})(),r.a.createElement(r.a.Fragment,null,r.a.createElement(xa,null),r.a.createElement(wi,{timelineId:A.i.active,onAppLeave:e}))))),Ci={className:ki,"data-test-subj":"timeline-bottom-bar-container",position:"fixed",usePortal:!1},Ii={restrictWidth:950,template:"centeredBody",pageContentProps:{hasShadow:!1,color:"transparent"}},Pi=Oe()(Lt).withConfig({displayName:"StyledKibanaPageTemplate",componentId:"sc-1xdm1q0-0"})([".","{animation:'none !important';background:",";color:inherit;transform:",";."," &{transform:none;}}",""],ki,(({theme:e})=>e.eui.euiColorEmptyShade),(({$isShowingTimelineOverlay:e})=>e?"none":"translateY(calc(100% - 50px))"),F.d,(({$addBottomPadding:e})=>e&&`\n    @media (min-width: 768px) {\n      .kbnPageTemplateSolutionNav {\n        padding-bottom: ${ra.e};\n      }\n    }\n  `)),Mi=r.a.memo((({children:e,onAppLeave:t})=>{const a=pa(),n=Object(la.a)(),[o]=ia(),s=Object(l.useMemo)((()=>ga()),[]),{show:c}=Object(E.a)((e=>s(e,A.i.active))),u=Object(le.c)(),d=o||n||u,p=(()=>{const[{pageName:e}]=Object(W.a)(),{indicesExist:t}=Object(be.d)(),a=(n=e,[At.a.hosts,At.a.network,At.a.timelines,At.a.overview,At.a.users].includes(n)&&!t||e===At.a.landing);var n;const[i,r]=Object(l.useState)(a);return Object(l.useEffect)((()=>{r(!!a)}),[a]),i})()?{...Ii,template:"centeredContent",pageContentProps:{verticalPosition:"top"}}:{};return r.a.createElement(Pi,i()({$addBottomPadding:d,$isShowingTimelineOverlay:c,bottomBarProps:Ci,bottomBar:o&&r.a.createElement(Ti,{onAppLeave:t}),paddingSize:"none",solutionNav:a,restrictWidth:!1,template:"default"},p),r.a.createElement(r.a.Fragment,null,r.a.createElement(ha,null),r.a.createElement(m.EuiPanel,{className:"securityPageWrapper","data-test-subj":"pageContainer",hasShadow:!1,paddingSize:"l"},e)))}));var Li=a(457);const Ni=({children:e,onAppLeave:t,setHeaderActionMenu:a})=>{const{pathname:n}=Object(s.useLocation)();Object(be.c)(Object(be.a)(n));const{browserFields:i,indexPattern:o}=Object(be.d)(Object(be.a)(n));return(()=>{const e=Object(S.j)(),t=Object(Ee.a)().endpointPrivileges.canAccessFleet;Object(l.useEffect)((()=>{const a=new AbortController,n=()=>{a.abort()};if(t){const t=a.signal;return(async()=>{try{var n;await(null===(n=e.services.fleet)||void 0===n?void 0:n.isInitialized()),await(async(e,t={})=>e.post(ge.epmRouteService.getBulkInstallPath(),{...t,body:JSON.stringify({packages:["endpoint","security_detection_engine"]})}))(e.services.http,{signal:t})}catch(e){a.signal.aborted||console.error(e)}})(),n}}),[t,e.services.fleet,e.services.http])})(),r.a.createElement(U.g,{className:"kbnAppWrapper"},r.a.createElement(Li.a,null,r.a.createElement(kt,{setHeaderActionMenu:a}),r.a.createElement(_,{browserFields:i},r.a.createElement(me,{indexPattern:o,navTabs:pe.a}),r.a.createElement(Mi,{onAppLeave:t},e)),r.a.createElement(Q,null)))};Ni.displayName="HomePage";const Fi=r.a.memo(Ni),Di=({children:e,history:t,onAppLeave:a,setHeaderActionMenu:n})=>{const i=Object(d.useDispatch)();return Object(l.useEffect)((()=>()=>{i({type:"userChangedUrl",payload:{pathname:"",search:"",hash:""}})}),[i]),r.a.createElement(k,null,r.a.createElement(s.Router,{history:t},r.a.createElement(I,null,r.a.createElement(s.Switch,null,r.a.createElement(c.Route,{path:"/"},r.a.createElement(Fi,{onAppLeave:a,setHeaderActionMenu:n},e)),r.a.createElement(c.Route,null,r.a.createElement(u.a,null))))))},zi=Object(l.memo)(Di);var Bi=a(814),Ai=a(563);const Ri=({children:e,history:t,setHeaderActionMenu:a,onAppLeave:n,store:i,theme$:l})=>{var o;const{i18n:s,application:{capabilities:u},cases:E}=Object(S.j)().services,[v]=Object(S.p)(g.J),h=Object(S.h)(),y=E.ui.getCasesContext();return r.a.createElement(m.EuiErrorBoundary,null,r.a.createElement(s.Context,null,r.a.createElement(f.b,null,r.a.createElement(d.Provider,{store:i},r.a.createElement(c.KibanaThemeProvider,{theme$:l},r.a.createElement(p.EuiThemeProvider,{darkMode:v},r.a.createElement(O.b,null,r.a.createElement(Bi.b,{kibanaCapabilities:u},r.a.createElement(b.a,null,r.a.createElement(Ai.a,null,r.a.createElement(y,{owner:[g.n],userCanCrud:null!==(o=null==h?void 0:h.crud)&&void 0!==o&&o},r.a.createElement(zi,{history:t,onAppLeave:n,setHeaderActionMenu:a},e)))))))),r.a.createElement(j,null),r.a.createElement(f.a,null)))))},$i=Object(l.memo)(Ri),Vi=({children:e,history:t,onAppLeave:a,services:n,setHeaderActionMenu:i,store:l,theme$:o})=>r.a.createElement(S.a,{services:{appName:g.q,...n}},r.a.createElement($i,{history:t,onAppLeave:a,setHeaderActionMenu:i,store:l,theme$:o},e)),qi=Object(l.memo)(Vi),_i=({element:e,history:t,onAppLeave:a,setHeaderActionMenu:n,services:l,store:d,usageCollection:m,subPluginRoutes:p,theme$:b})=>{var g;const E=null!==(g=null==m?void 0:m.components.ApplicationUsageTrackingProvider)&&void 0!==g?g:r.a.Fragment;return Object(o.render)(r.a.createElement(qi,{history:t,onAppLeave:a,services:l,setHeaderActionMenu:n,store:d,theme$:b},r.a.createElement(E,null,r.a.createElement(s.Switch,null,p.map(((e,t)=>r.a.createElement(c.Route,i()({key:`route-${t}`},e)))),r.a.createElement(c.Route,null,r.a.createElement(u.a,null))))),e),()=>Object(o.unmountComponentAtNode)(e)}},430:function(e,t,a){"use strict";a.d(t,"c",(function(){return d})),a.d(t,"a",(function(){return p})),a.d(t,"b",(function(){return m}));var n=a(5),i=a.n(n),l=a(16),r=a(167),o={name:"1azakc",styles:"text-align:center"},s=function(){var e=o;return Object(r.jsx)("div",{css:e},Object(r.jsx)(l.EuiLoadingSpinner,null))},c=a(50),u=a.n(c),d=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object(r.jsx)(s,null);return i.a.forwardRef((function(a,i){return Object(r.jsx)(l.EuiErrorBoundary,null,Object(r.jsx)(n.Suspense,{fallback:t},Object(r.jsx)(e,u()({},a,{ref:i}))))}))},m=function(e){return e.metaKey||e.altKey||e.ctrlKey||e.shiftKey},p=function(e,t){var a=e;do{var n,i;if("a"===(null===(n=a)||void 0===n?void 0:n.tagName.toLowerCase()))return a;var l=null===(i=a)||void 0===i?void 0:i.parentElement;if(!l||l===document.body||l===t)break;a=l}while(parent||parent!==document.body||parent!==t)}},473:function(e,t,a){"use strict";a.d(t,"d",(function(){return s})),a.d(t,"b",(function(){return c})),a.d(t,"c",(function(){return u})),a.d(t,"a",(function(){return d}));var n=a(5),i=a.n(n),l=a(296);const r=Object(l.c)(),o=Object(l.c)(),s=()=>{const[e]=Object(n.useState)(r);return{portalNode:e}},c=i.a.memo((()=>{const{portalNode:e}=s();return i.a.createElement(l.b,{node:e})}));c.displayName="TimelineEventsCountBadge";const u=()=>{const[e]=Object(n.useState)(o);return{portalNode:e}},d=i.a.memo((()=>{const{portalNode:e}=u();return i.a.createElement(l.b,{node:e})}));d.displayName="EqlEventsCountBadge"},474:function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return m}));var n=a(16),i=a(5),l=a.n(i),r=a(23),o=a.n(r),s=a(550);const c="exit-full-screen",u=o()(n.EuiButton).withConfig({displayName:"StyledEuiButton",componentId:"sc-4dkrmi-0"})(["margin:",";"],(({theme:e})=>e.eui.paddingSizes.s)),d=({fullScreen:e,setFullScreen:t})=>{const a=Object(i.useCallback)((()=>{t(!1)}),[t]),r=Object(i.useCallback)((e=>{"Escape"===e.key&&(e.preventDefault(),a())}),[a]);return e?l.a.createElement(l.a.Fragment,null,l.a.createElement(n.EuiWindowEvent,{event:"keydown",handler:r}),l.a.createElement(u,{className:c,"data-test-subj":"exit-full-screen",fullWidth:!1,iconType:"fullScreen",isDisabled:!e,onClick:a},s.a)):null};d.displayName="ExitFullScreenComponent";const m=l.a.memo(d)},563:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(5),i=a.n(n),l=a(215);class SecuritySolutionQueryClient extends l.QueryClient{constructor(e={}){var t,a,n;super({...e,defaultOptions:{...null!==(t=e.defaultOptions)&&void 0!==t?t:{},queries:{refetchIntervalInBackground:!1,refetchOnWindowFocus:!1,refetchOnMount:!0,keepPreviousData:!0,...null!==(a=null==e||null===(n=e.defaultOptions)||void 0===n?void 0:n.queries)&&void 0!==a?a:{}}}})}}const r=Object(n.memo)((({queryClient:e,children:t})=>{const a=Object(n.useMemo)((()=>e||new SecuritySolutionQueryClient),[e]);return i.a.createElement(l.QueryClientProvider,{client:a},t)}));r.displayName="ReactQueryClientProvider"},604:function(e,t,a){"use strict";a.d(t,"a",(function(){return Me}));var n=a(16),i=a(5),l=a.n(i),r=a(42),o=a(4);const s=o.i18n.translate("xpack.securitySolution.indexPatterns.callOutTitle",{defaultMessage:"Data view cannot be modified on this page"}),c=o.i18n.translate("xpack.securitySolution.indexPatterns.callOutDeprecxatedTitle",{defaultMessage:"This timeline uses a legacy data view selector"}),u=o.i18n.translate("xpack.securitySolution.indexPatterns.callOutDeprecxatedTemplateTitle",{defaultMessage:"This timeline template uses a legacy data view selector"}),d=o.i18n.translate("xpack.securitySolution.indexPatterns.callOutMissingPatternsTitle",{defaultMessage:"This timeline is out of date with the Security Data View"}),m=o.i18n.translate("xpack.securitySolution.indexPatterns.callOutMissingPatternsTemplateTitle",{defaultMessage:"This timeline template is out of date with the Security Data View"}),p=o.i18n.translate("xpack.securitySolution.indexPatterns.callOutTimelineTitle",{defaultMessage:"Data view cannot be modified when show only detection alerts is selected"}),b=o.i18n.translate("xpack.securitySolution.indexPatterns.toggleToNewSourcerer.link",{defaultMessage:"here"}),g=o.i18n.translate("xpack.securitySolution.indexPatterns.dataViewLabel",{defaultMessage:"Data view"}),E=o.i18n.translate("xpack.securitySolution.indexPatterns.updateDataView",{defaultMessage:"Would you like to add this index pattern to Security Data View? Otherwise, we can recreate the data view without the missing index patterns."}),v=o.i18n.translate("xpack.securitySolution.indexPatterns.updateSecurityDataView",{defaultMessage:"Update Security Data View"}),h=o.i18n.translate("xpack.securitySolution.indexPatterns.continue",{defaultMessage:"Continue without adding"}),f=o.i18n.translate("xpack.securitySolution.indexPatterns.add",{defaultMessage:"Add index pattern"}),y=o.i18n.translate("xpack.securitySolution.indexPatterns.modifiedBadgeTitle",{defaultMessage:"Modified"}),j=o.i18n.translate("xpack.securitySolution.indexPatterns.alertsBadgeTitle",{defaultMessage:"Alerts"}),O=o.i18n.translate("xpack.securitySolution.indexPatterns.updateAvailableBadgeTitle",{defaultMessage:"Update available"}),S=o.i18n.translate("xpack.securitySolution.indexPatterns.securityDefaultDataViewLabel",{defaultMessage:"Security Default Data View"}),x=o.i18n.translate("xpack.securitySolution.indexPatterns.securityDataViewLabel",{defaultMessage:"Security Data View"}),w=o.i18n.translate("xpack.securitySolution.indexPatterns.selectDataView",{defaultMessage:"Data view selection"}),k=o.i18n.translate("xpack.securitySolution.indexPatterns.save",{defaultMessage:"Save"}),T=o.i18n.translate("xpack.securitySolution.indexPatterns.chooseDataViewLabel",{defaultMessage:"Choose data view"}),C=o.i18n.translate("xpack.securitySolution.indexPatterns.advancedOptionsTitle",{defaultMessage:"Advanced options"}),I=o.i18n.translate("xpack.securitySolution.indexPatterns.indexPatternsLabel",{defaultMessage:"Index patterns"}),P=o.i18n.translate("xpack.securitySolution.indexPatterns.descriptionsLabel",{defaultMessage:"These are the index patterns currently selected. Filtering out index patterns from your data view can help improve overall performance."}),M=(o.i18n.translate("xpack.securitySolution.indexPatterns.disabled",{defaultMessage:"Disabled index patterns are recommended on this page, but first need to be configured in your Kibana index pattern settings"}),o.i18n.translate("xpack.securitySolution.sourcerer.disabled",{defaultMessage:"The updates to the Data view require a page reload to take effect."})),L=o.i18n.translate("xpack.securitySolution.indexPatterns.update",{defaultMessage:"Update and recreate data view"}),N=o.i18n.translate("xpack.securitySolution.indexPatterns.resetButton",{defaultMessage:"Reset"}),F=o.i18n.translate("xpack.securitySolution.indexPatterns.closeButton",{defaultMessage:"Close"}),D=o.i18n.translate("xpack.securitySolution.indexPatterns.inactive",{defaultMessage:"Inactive index patterns"}),z=o.i18n.translate("xpack.securitySolution.indexPatterns.noData",{defaultMessage:"The index pattern on this timeline doesn't match any data streams, indices, or index aliases."}),B=o.i18n.translate("xpack.securitySolution.indexPatterns.pickIndexPatternsCombo",{defaultMessage:"Pick index patterns"}),A=o.i18n.translate("xpack.securitySolution.indexPatterns.onlyDetectionAlertsLabel",{defaultMessage:"Show only detection alerts"}),R=o.i18n.translate("xpack.securitySolution.indexPatterns.successToastTitle",{defaultMessage:"One or more settings require you to reload the page to take effect"}),$=o.i18n.translate("xpack.securitySolution.indexPatterns.reloadPageTitle",{defaultMessage:"Reload page"}),V=o.i18n.translate("xpack.securitySolution.indexPatterns.failureToastTitle",{defaultMessage:"Unable to update data view"});var q=a(29),_=a(71),G=a(13),H=a(443),U=a(57),J=a(23),Q=a.n(J);const W=Q()(n.EuiFormRow).withConfig({displayName:"FormRow",componentId:"sc-tzfq9h-0"})(["display:",";max-width:none;"],(({$expandAdvancedOptions:e})=>e?"flex":"none")),K=Q()(n.EuiFormRow).withConfig({displayName:"StyledFormRow",componentId:"sc-tzfq9h-1"})(["max-width:none;"]),Z=Q()(n.EuiButtonEmpty).withConfig({displayName:"StyledButton",componentId:"sc-tzfq9h-2"})(["&:enabled:focus,&:focus{background-color:transparent;}"]),Y=Q()(n.EuiButtonEmpty).withConfig({displayName:"ResetButton",componentId:"sc-tzfq9h-3"})(["width:fit-content;&:enabled:focus,&:focus{background-color:transparent;}"]),X=Q.a.div.withConfig({displayName:"PopoverContent",componentId:"sc-tzfq9h-4"})(["width:600px;"]),ee=Q()(n.EuiBadge).withConfig({displayName:"StyledBadge",componentId:"sc-tzfq9h-5"})(["margin-left:8px;&,.euiBadge__text{cursor:pointer;}"]),te=Q.a.span.withConfig({displayName:"Blockquote",componentId:"sc-tzfq9h-6"})(["",""],(({theme:e})=>Object(J.css)(["display:block;border-color:",";border-left:",";margin:"," 0 "," ",";padding:",";"],e.eui.euiColorDarkShade,e.eui.euiBorderThick,e.eui.euiSizeS,e.eui.euiSizeS,e.eui.euiSizeS,e.eui.euiSizeS))),ae=(e,t)=>e.filter((e=>e!==t)),ne=(e,t)=>Object(U.d)(e).map((e=>({label:e,value:e,...null!=t?{disabled:!t.includes(e)}:{}})));var ie=a(165);const le=Q()(n.EuiModal).withConfig({displayName:"MyEuiModal",componentId:"sc-1c0zuny-0"})([".euiModal__flex{width:60vw;}.euiCodeBlock{height:auto !important;max-width:718px;}z-index:99999999;"]),re=l.a.memo((({isShowing:e,onDismissModal:t,onContinue:a,onUpdate:i,missingPatterns:r})=>e?l.a.createElement(le,{onClose:t,"data-test-subj":"sourcerer-update-data-view-modal"},l.a.createElement(n.EuiModalHeader,null,l.a.createElement(n.EuiModalHeaderTitle,null,l.a.createElement("h1",null,v))),l.a.createElement(n.EuiModalBody,null,l.a.createElement(n.EuiText,{size:"s"},l.a.createElement(n.EuiTextColor,{color:"subdued"},l.a.createElement("p",null,l.a.createElement(ie.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.missingPatterns",defaultMessage:"Security Data View is missing the following index patterns in order to recreate the previous timeline's data view: {callout}",values:{callout:l.a.createElement(te,null,r.join(", "))}}),E))),l.a.createElement(n.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd"},l.a.createElement(n.EuiFlexItem,{grow:!1},l.a.createElement(Y,{"aria-label":h,"data-test-subj":"sourcerer-continue-close",flush:"left",onClick:a,title:h},h)),l.a.createElement(n.EuiFlexItem,{grow:!1},l.a.createElement(n.EuiButton,{"data-test-subj":"sourcerer-update-data-view",fill:!0,fullWidth:!0,onClick:i,size:"s"},f))))):null));re.displayName="UpdateDefaultDataViewModal";var oe=a(228),se=a(84),ce=a(87);const ue=({activePatterns:e,deadPatterns:t,selectedPatterns:a,timelineType:r})=>{const o=Object(i.useMemo)((()=>t.length>0?l.a.createElement(n.EuiToolTip,{content:l.a.createElement(de,{activePatterns:e,selectedPatterns:a,timelineType:r})},l.a.createElement(n.EuiIcon,{type:"questionInCircle",title:D})):null),[e,t.length,a,r]);return r===oe.d.template?l.a.createElement(ie.FormattedMessage,{"data-test-subj":"sourcerer-current-patterns-message",id:"xpack.securitySolution.indexPatterns.timelineTemplate.currentPatterns",defaultMessage:"The active index patterns in this timeline template are{tooltip}: {callout}",values:{tooltip:o,callout:l.a.createElement(te,null,e.join(", "))}}):l.a.createElement(ie.FormattedMessage,{"data-test-subj":"sourcerer-current-patterns-message",id:"xpack.securitySolution.indexPatterns.timeline.currentPatterns",defaultMessage:"The active index patterns in this timeline are{tooltip}: {callout}",values:{tooltip:o,callout:l.a.createElement(te,null,e.join(", "))}})},de=({activePatterns:e,selectedPatterns:t,timelineType:a})=>{const n=Object(i.useMemo)((()=>t.filter((t=>!e.includes(t))).join(", ")),[e,t]);return a===oe.d.template?l.a.createElement(ie.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timelineTemplate.noMatchData",defaultMessage:"The following index patterns are saved to this timeline template but do not match any data streams, indices, or index aliases: {aliases}",values:{aliases:n}}):l.a.createElement(ie.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timeline.noMatchData",defaultMessage:"The following index patterns are saved to this timeline but do not match any data streams, indices, or index aliases: {aliases}",values:{aliases:n}})},me=({timelineType:e,selectedPatterns:t})=>{const a=Object(i.useMemo)((()=>l.a.createElement(te,null,t.join(", "))),[t]);return e===oe.d.template?l.a.createElement(ie.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timelineTemplate.currentPatternsBad",defaultMessage:"The current index patterns in this timeline template are: {callout}",values:{callout:a}}):l.a.createElement(ie.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timeline.currentPatternsBad",defaultMessage:"The current index patterns in this timeline are: {callout}",values:{callout:a}})},pe=({onReset:e,timelineType:t})=>t===oe.d.template?l.a.createElement(ie.FormattedMessage,{"data-test-subj":"sourcerer-deprecated-message",id:"xpack.securitySolution.indexPatterns.timelineTemplate.toggleToNewSourcerer",defaultMessage:"We have preserved your timeline template by creating a temporary data view. If you'd like to modify your data, we can recreate your temporary data view with the new data view selector. You can also manually select a data view {link}.",values:{link:l.a.createElement(n.EuiLink,{onClick:e},b)}}):l.a.createElement(ie.FormattedMessage,{"data-test-subj":"sourcerer-deprecated-message",id:"xpack.securitySolution.indexPatterns.timeline.toggleToNewSourcerer",defaultMessage:"We have preserved your timeline by creating a temporary data view. If you'd like to modify your data, we can recreate your temporary data view with the new data view selector. You can also manually select a data view {link}.",values:{link:l.a.createElement(n.EuiLink,{onClick:e},b)}}),be=({onReset:e,timelineType:t})=>t===oe.d.template?l.a.createElement(ie.FormattedMessage,{"data-test-subj":"sourcerer-missing-patterns-message",id:"xpack.securitySolution.indexPatterns.missingPatterns.timelineTemplate.description",defaultMessage:"We have preserved your timeline template by creating a temporary data view. If you'd like to modify your data, we can add the missing index patterns to the Security Data View. You can also manually select a data view {link}.",values:{link:l.a.createElement(n.EuiLink,{onClick:e},b)}}):l.a.createElement(ie.FormattedMessage,{"data-test-subj":"sourcerer-missing-patterns-message",id:"xpack.securitySolution.indexPatterns.missingPatterns.timeline.description",defaultMessage:"We have preserved your timeline by creating a temporary data view. If you'd like to modify your data, we can add the missing index patterns to the Security Data View. You can also manually select a data view {link}.",values:{link:l.a.createElement(n.EuiLink,{onClick:e},b)}}),ge={deprecated:{title:{[oe.d.default]:c,[oe.d.template]:u},update:L},missingPatterns:{title:{[oe.d.default]:d,[oe.d.template]:m},update:f}},Ee=l.a.memo((({activePatterns:e,indicesExist:t,isModified:a,onDismiss:r,onReset:o,onUpdate:s,selectedPatterns:c,missingPatterns:u})=>{const d=Object(i.useMemo)((()=>l.a.createElement(n.EuiButton,{"data-test-subj":"sourcerer-deprecated-update",fill:!0,fullWidth:!0,onClick:s,size:"s",disabled:!t},ge[a].update)),[t,a,s]),m=Object(i.useMemo)((()=>t?d:l.a.createElement(n.EuiToolTip,{position:"top",content:z,"data-test-subj":"sourcerer-tooltip"},d)),[t,d]),p=e&&e.length>0?c.filter((t=>!e.includes(t))):[],b=Object(i.useMemo)((()=>se.b.getTimelineByIdSelector()),[]),g=Object(_.a)((e=>{var t;return(null!==(t=b(e,oe.b.active))&&void 0!==t?t:ce.a).timelineType}));return l.a.createElement(l.a.Fragment,null,l.a.createElement(n.EuiCallOut,{color:"warning","data-test-subj":"sourcerer-deprecated-callout",iconType:"alert",size:"s",title:ge[a].title[g]}),l.a.createElement(n.EuiSpacer,{size:"s"}),l.a.createElement(n.EuiText,{size:"s"},l.a.createElement(n.EuiTextColor,{color:"subdued"},l.a.createElement("p",null,e&&e.length>0?l.a.createElement(ue,{timelineType:g,activePatterns:e,deadPatterns:p,selectedPatterns:c}):l.a.createElement(me,{timelineType:g,selectedPatterns:c}),"deprecated"===a&&l.a.createElement(pe,{timelineType:g,onReset:o}),"missingPatterns"===a&&l.a.createElement(l.a.Fragment,null,l.a.createElement(ie.FormattedMessage,{"data-test-subj":"sourcerer-missing-patterns-callout",id:"xpack.securitySolution.indexPatterns.missingPatterns.callout",defaultMessage:"Security Data View is missing the following index patterns: {callout}",values:{callout:l.a.createElement(te,null,u.join(", "))}}),l.a.createElement(be,{timelineType:g,onReset:o}))))),l.a.createElement(n.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd"},l.a.createElement(n.EuiFlexItem,{grow:!1},l.a.createElement(Y,{"aria-label":F,"data-test-subj":"sourcerer-deprecated-close",flush:"left",onClick:r,title:F},F)),l.a.createElement(n.EuiFlexItem,{grow:!1},m)))}));Ee.displayName="TemporarySourcererComp";const ve=l.a.memo((({activePatterns:e,indicesExist:t,isModified:a,missingPatterns:n,onContinueWithoutUpdate:i,onDismiss:r,onReset:o,onUpdateStepOne:s,onUpdateStepTwo:c,selectedPatterns:u,isShowingUpdateModal:d,onDismissModal:m})=>l.a.createElement(l.a.Fragment,null,l.a.createElement(Ee,{activePatterns:e,indicesExist:t,isModified:a,missingPatterns:n,onDismiss:r,onReset:o,onUpdate:s,selectedPatterns:u}),l.a.createElement(re,{isShowing:d,missingPatterns:n,onDismissModal:m,onContinue:i,onUpdate:c}))));ve.displayName="TemporarySourcerer";var he=a(194),fe=a(55),ye=a(18),je=a(1);const Oe=Q()(n.EuiButton).withConfig({displayName:"StyledRefreshButton",componentId:"sc-1lqcqbd-0"})(["float:right;"]),Se=l.a.memo((()=>{const e=Object(i.useCallback)((()=>{document.location.reload()}),[]);return l.a.createElement(Oe,{onClick:e,"data-test-subj":"page-refresh"},$)}));Se.displayName="RefreshButton";var xe=a(192);const we=({activePatterns:e,disabled:t,isModified:a,isOnlyDetectionAlerts:r,isPopoverOpen:o,isTimelineSourcerer:s,loading:c,onClick:u,selectedPatterns:d,signalIndexName:m})=>{const p=Object(i.useMemo)((()=>{switch(a){case"modified":return l.a.createElement(ee,{"data-test-subj":"sourcerer-modified-badge"},y);case"alerts":return l.a.createElement(ee,{"data-test-subj":"sourcerer-alerts-badge"},j);case"deprecated":return l.a.createElement(ee,{color:"warning","data-test-subj":"sourcerer-deprecated-badge"},O);case"missingPatterns":return l.a.createElement(ee,{color:"warning","data-test-subj":"sourcerer-missingPatterns-badge"},O);default:return null}}),[a]),b=Object(i.useMemo)((()=>l.a.createElement(Z,{"aria-label":g,"data-test-subj":s?"timeline-sourcerer-trigger":"sourcerer-trigger",flush:"left",iconSide:"right",iconType:"arrowDown",disabled:t,isLoading:c,onClick:u,title:g},g,!t&&p)),[t,p,s,c,u]),E=Object(i.useMemo)((()=>t?M:(({isOnlyDetectionAlerts:e,isPopoverOpen:t,selectedPatterns:a,signalIndexName:n})=>t||e&&!n?null:(e?[n]:a).join(", "))({isOnlyDetectionAlerts:r,isPopoverOpen:o,selectedPatterns:null!=e?e:d,signalIndexName:m})),[e,t,r,o,d,m]);return E?l.a.createElement(n.EuiToolTip,{position:"top",content:E,"data-test-subj":"sourcerer-tooltip"},b):b},ke=Object(i.memo)(we),Te=l.a.memo((({isOnlyDetectionAlerts:e,title:t})=>e?l.a.createElement(n.EuiCallOut,{"data-test-subj":"sourcerer-callout",iconType:"iInCircle",size:"s",title:t}):null));Te.displayName="SourcererCallout";const Ce=l.a.memo((({onChange:e,checked:t,isShow:a})=>a?l.a.createElement(K,null,l.a.createElement(n.EuiCheckbox,{checked:t,"data-test-subj":"sourcerer-alert-only-checkbox",id:"sourcerer-alert-only-checkbox",label:A,onChange:e})):null));Ce.displayName="AlertsCheckbox";const Ie=l.a.memo((({disableSave:e,isShow:t,onReset:a,onSave:i})=>t?l.a.createElement(K,null,l.a.createElement(n.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd"},l.a.createElement(n.EuiFlexItem,{grow:!1},l.a.createElement(Y,{"aria-label":N,"data-test-subj":"sourcerer-reset",flush:"left",onClick:a,title:N},N)),l.a.createElement(n.EuiFlexItem,{grow:!1},l.a.createElement(n.EuiButton,{onClick:i,disabled:e,"data-test-subj":"sourcerer-save",fill:!0,fullWidth:!0,size:"s"},k)))):null));Ie.displayName="SaveButtons";var Pe=a(520);const Me=l.a.memo((({scope:e})=>{const t=Object(r.useDispatch)(),a=e===G.SourcererScopeName.detections,o=e===G.SourcererScopeName.timeline,c=Object(i.useMemo)((()=>q.d.getSourcererScopeSelector()),[]),{defaultDataView:u,kibanaDataViews:d,signalIndexName:m,sourcererScope:{selectedDataViewId:g,selectedPatterns:E,missingPatterns:v}}=Object(_.a)((t=>c(t,e))),{pollForSignalIndex:h}=Object(Pe.a)();Object(i.useEffect)((()=>{null!=h&&(o||a)&&h()}),[a,o,h]);const{activePatterns:f,indicesExist:O,loading:k}=Object(he.d)(e),[M,L]=Object(i.useState)(f&&f.length>0?v.filter((e=>f.includes(e))):[]);Object(i.useEffect)((()=>{f&&f.length>0&&L(v.filter((e=>f.includes(e))))}),[f,v]);const[N,F]=Object(i.useState)(o&&E.join()===m),D=Object(i.useCallback)((()=>{F(o&&E.join()===m)}),[o,E,m]);Object(i.useEffect)((()=>{D()}),[E]);const z=a||o&&N,[A,$]=Object(i.useState)(!1),[J,Q]=Object(i.useState)(g),{allOptions:Y,dataViewSelectOptions:te,loadingIndexPatterns:le,isModified:re,handleOutsideClick:oe,onChangeCombo:se,renderOption:ce,selectedOptions:ue,setIndexPatternsByDataView:de}=(({dataViewId:e,defaultDataViewId:t,isOnlyDetectionAlerts:a,kibanaDataViews:o,missingPatterns:s,scopeId:c,selectedDataViewId:u,selectedPatterns:d,signalIndexName:m})=>{const p=Object(r.useDispatch)(),b=Object(i.useRef)(!0),[g,E]=Object(i.useState)(!1),v=Object(i.useMemo)((()=>m?ne([m]):[]),[m]),[h,f]=Object(i.useState)(a?v:ne(d)),[O,w]=Object(i.useState)(null==e?"deprecated":s.length>0?"missingPatterns":""),{allPatterns:k,selectablePatterns:T}=Object(i.useMemo)((()=>{if(a&&m)return{allPatterns:[m],selectablePatterns:[m]};const t=o.find((t=>t.id===e));if(null==t)return{allPatterns:[],selectablePatterns:[]};const n=[...new Set(t.title.split(","))];return c===q.b.SourcererScopeName.default?{allPatterns:ae(n,m),selectablePatterns:ae(t.patternList,m)}:{allPatterns:n,selectablePatterns:t.patternList}}),[e,a,o,c,m]),C=Object(i.useMemo)((()=>ne(k,T)),[k,T]),I=Object(i.useCallback)(((e,a=!1)=>c===G.SourcererScopeName.detections||a?v:ne(Object(U.c)(o.find((t=>t.id===e)),c,m,e===t))),[v,o,c,m,t]),P=Object(i.useMemo)((()=>null!=e?I(e):[]),[e,I]),M=Object(i.useCallback)(((e,t)=>{if(null==t)return w("deprecated");if(s.length>0)return w("missingPatterns");if(a)return w("alerts");const n=P.length!==e.length||!P.every((t=>e.find((e=>t.value===e))));return w(n?"modified":"")}),[P,a,s.length]);Object(i.useEffect)((()=>{f(c===G.SourcererScopeName.detections?v:ne(d))}),[d,c]),Object(i.useEffect)((()=>{M(d.map((e=>e)),u)}),[a,u,s,c,d]);const L=Object(i.useCallback)((e=>{f(e)}),[]),N=Object(i.useCallback)((({value:e})=>l.a.createElement("span",{"data-test-subj":"sourcerer-combo-option"},e)),[]),F=Object(i.useCallback)((async(e,t)=>{if(o.some((t=>t.id===e&&0===t.indexFields.length))){try{E(!0),f([]);const t=await Object(H.a)(e);b.current&&(p(q.a.updateSourcererDataViews({dataView:t})),f(a?v:ne(t.patternList)))}catch(e){}E(!1)}else f(I(e,t))}),[v,p,I,a,o]),D=Object(i.useMemo)((()=>null!=e?(({dataViewId:e,defaultDataViewId:t,isModified:a,isOnlyDetectionAlerts:i,kibanaDataViews:r})=>i?[{inputDisplay:l.a.createElement("span",{"data-test-subj":"security-alerts-option-super"},l.a.createElement(n.EuiIcon,{type:"logoSecurity",size:"s"})," ",x,l.a.createElement(ee,{"data-test-subj":"security-alerts-option-badge"},j)),value:t}]:r.map((({title:i,id:r})=>({inputDisplay:r===t?l.a.createElement("span",{"data-test-subj":"security-option-super"},l.a.createElement(n.EuiIcon,{type:"logoSecurity",size:"s"})," ",S,a&&r===e&&l.a.createElement(ee,{"data-test-subj":"security-modified-option-badge"},y)):l.a.createElement("span",{"data-test-subj":"dataView-option-super"},l.a.createElement(n.EuiIcon,{type:"logoKibana",size:"s"})," ",i,a&&r===e&&l.a.createElement(ee,{"data-test-subj":"security-modified-option-badge"},y)),value:r}))))({dataViewId:e,defaultDataViewId:t,isModified:"modified"===O,isOnlyDetectionAlerts:a,kibanaDataViews:o}):[]),[e,t,O,a,o]);return Object(i.useEffect)((()=>(b.current=!0,()=>{b.current=!1})),[]),{allOptions:C,dataViewSelectOptions:D,loadingIndexPatterns:g,handleOutsideClick:Object(i.useCallback)((()=>{f(ne(d))}),[d]),isModified:O,onChangeCombo:L,renderOption:N,selectedOptions:h,setIndexPatternsByDataView:F}})({dataViewId:J,defaultDataViewId:u.id,isOnlyDetectionAlerts:z,kibanaDataViews:d,missingPatterns:M,scopeId:e,selectedDataViewId:g,selectedPatterns:E,signalIndexName:m}),me=Object(i.useCallback)((e=>{F(e.target.checked),Q(u.id),de(u.id,e.target.checked)}),[u.id,de]),[pe,be]=Object(i.useState)(!1),[ge,Ee]=Object(i.useState)(!1),Oe=Object(i.useCallback)((()=>{$((e=>!e)),be(!1)}),[]),we=Object(i.useCallback)(((a,n,i)=>{t(q.a.setSelectedDataView({id:e,selectedDataViewId:a,selectedPatterns:n,shouldValidateSelectedPatterns:i}))}),[t,e]),Me=Object(i.useCallback)((e=>{Q(e),de(e)}),[de]),Le=Object(i.useCallback)((()=>{Q(u.id),de(u.id),F(!1),L([])}),[u.id,de]),Ne=Object(i.useCallback)((()=>{const e=ue.map((e=>e.label));null!=J&&we(J,e),$(!1)}),[we,J,ue]),Fe=Object(i.useCallback)((()=>{$(!1),be(!1)}),[]),De=Object(i.useCallback)((()=>{Ee(!1);const e=E.filter((e=>u.patternList.includes(e)));we(u.id,e),$(!1)}),[u.id,u.patternList,we,E]),ze=Object(i.useCallback)((()=>{0===M.length?De():Ee(!0)}),[M,De]),[Be,Ae]=Object(i.useState)(!1),Re=(e=>{const{theme:t,uiSettings:a}=Object(ye.j)().services,{addSuccess:r,addError:o}=Object(xe.a)();return Object(i.useCallback)((async i=>{const[s,c]=await(async()=>{try{const e=[...a.get(je.N),...i];return[await a.set(je.N,Object(U.b)(e)),null]}catch(e){return[!1,e]}})();return s?(r({color:"success",title:Object(fe.toMountPoint)(R,{theme$:t.theme$}),text:Object(fe.toMountPoint)(l.a.createElement(Se,null),{theme$:t.theme$}),iconType:void 0,toastLifeTimeMs:6e5}),!0):(o(null!==c?c:new Error(V),{title:V,toastMessage:l.a.createElement(l.a.Fragment,null,l.a.createElement(ie.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.failureToastText",defaultMessage:"Unexpected error occurred on update. If you would like to modify your data, you can manually select a data view {link}.",values:{link:l.a.createElement(n.EuiLink,{onClick:e,"data-test-subj":"failureToastLink"},b)}}))}),!1)}),[o,r,e,t.theme$,a])})(Object(i.useCallback)((()=>{$(!0),Le()}),[Le])),$e=Object(i.useCallback)((async()=>{const e=await Re(M);Ee(!1),$(!1),e&&(we(u.id,null!=f?f:E,!1),Ae(!0))}),[f,u.id,M,we,E,Re]);Object(i.useEffect)((()=>{Q(g)}),[g]);const Ve=Object(i.useCallback)((()=>{Q(g),L(v),D(),oe()}),[oe,D,g,v]),qe=Object(i.useCallback)((()=>{be((e=>!e))}),[]);return O||e===G.SourcererScopeName.timeline?l.a.createElement(n.EuiPopover,{panelClassName:"sourcererPopoverPanel",button:l.a.createElement(ke,{activePatterns:f,disabled:Be,isModified:re,isOnlyDetectionAlerts:z,isPopoverOpen:A,isTimelineSourcerer:o,loading:k,onClick:Oe,selectedPatterns:E,signalIndexName:m}),closePopover:Fe,"data-test-subj":o?"timeline-sourcerer-popover":"sourcerer-popover",display:"block",isOpen:A,ownFocus:!0,repositionOnScroll:!0},l.a.createElement(n.EuiOutsideClickDetector,{onOutsideClick:Ve},l.a.createElement(X,null,l.a.createElement(n.EuiPopoverTitle,{"data-test-subj":"sourcerer-title"},l.a.createElement(l.a.Fragment,null,w)),l.a.createElement(Te,{isOnlyDetectionAlerts:z,title:o?p:s}),l.a.createElement(n.EuiSpacer,{size:"s"}),null===J&&"deprecated"===re||"missingPatterns"===re?l.a.createElement(ve,{activePatterns:f,indicesExist:O,isModified:re,isShowingUpdateModal:ge,missingPatterns:M,onContinueWithoutUpdate:De,onDismiss:Oe,onDismissModal:()=>Ee(!1),onReset:Le,onUpdateStepOne:"deprecated"===re?ze:$e,onUpdateStepTwo:$e,selectedPatterns:E}):l.a.createElement(n.EuiForm,{component:"form"},l.a.createElement(l.a.Fragment,null,l.a.createElement(Ce,{isShow:o,checked:N,onChange:me}),J&&l.a.createElement(K,{label:T},l.a.createElement(n.EuiSuperSelect,{"data-test-subj":"sourcerer-select",isLoading:le,disabled:z,fullWidth:!0,onChange:Me,options:te,placeholder:T,valueOfSelected:J})),l.a.createElement(n.EuiSpacer,{size:"m"}),l.a.createElement(Z,{color:"text","data-test-subj":"sourcerer-advanced-options-toggle",iconType:pe?"arrowDown":"arrowRight",onClick:qe},C),pe&&l.a.createElement(n.EuiSpacer,{size:"m"}),l.a.createElement(W,{isDisabled:le,$expandAdvancedOptions:pe,helpText:z?void 0:P,label:I},l.a.createElement(n.EuiComboBox,{"data-test-subj":"sourcerer-combo-box",fullWidth:!0,isDisabled:z||le,onChange:se,options:Y,placeholder:B,renderOption:ce,selectedOptions:ue})),l.a.createElement(Ie,{disableSave:0===ue.length,isShow:!a,onReset:Le,onSave:Ne})),l.a.createElement(n.EuiSpacer,{size:"s"}))))):null}));Me.displayName="Sourcerer"},607:function(e,t,a){"use strict";a.r(t),a.d(t,"ToolbarButton",(function(){return p})),a.d(t,"IconButtonGroup",(function(){return g})),a.d(t,"AddFromLibraryButton",(function(){return h})),a.d(t,"ToolbarPopover",(function(){return O}));var n=a(50),i=a.n(n),l=a(11),r=a.n(l),o=a(210),s=a.n(o),c=a(5),u=a(16),d=a(167),m=["label","iconSide"],p=function(e){var t=e.label,a=e.iconSide,n=void 0===a?"left":a,l=s()(e,m);return Object(d.jsx)(u.EuiButton,i()({size:"m",color:"primary",fill:!0},r()({iconSide:n},l)),t)},b=["label","title"],g=function(e){var t=e.buttons,a=e.legend,n=function(e){var t=e.euiTheme;return{button:{"&.euiButtonGroupButton":{backgroundColor:t.colors.emptyShade,border:"".concat(t.border.thin," !important"),"&:first-of-type":{borderTopLeftRadius:"".concat(t.border.radius.medium," !important"),borderBottomLeftRadius:"".concat(t.border.radius.medium," !important")},"&:last-of-type":{borderTopRightRadius:"".concat(t.border.radius.medium," !important"),borderBottomRightRadius:"".concat(t.border.radius.medium," !important")}}}}}(Object(u.useEuiTheme)()),i=t.map((function(e,t){var a=e.label,i=e.title,l=void 0===i?a:i,o=s()(e,b);return r()(r()({},o),{},{"aria-label":null!=l?l:a,id:"".concat(Object(u.htmlIdGenerator)()()).concat(t),label:a,title:l,css:[n.button]})}));return Object(d.jsx)(u.EuiButtonGroup,{buttonSize:"m",legend:a,options:i,onChange:function(e){var t;null===(t=i.find((function(t){return t.id===e})))||void 0===t||t.onClick()},type:"multi",isIconOnly:!0})},E=a(4),v=["onClick"],h=function(e){e.onClick;var t=s()(e,v);return Object(d.jsx)(p,i()({},t,{iconType:"folderOpen",label:E.i18n.translate("sharedUXComponents.toolbar.buttons.addFromLibrary.libraryButtonLabel",{defaultMessage:"Add from library"})}))},f=a(38),y=a.n(f),j=["label","iconType","children","iconSide"],O=function(e){var t=e.label,a=e.iconType,n=e.children,l=e.iconSide,r=s()(e,j),o=Object(c.useState)(!1),m=y()(o,2),b=m[0],g=m[1],E=function(){return g(!1)},v=Object(d.jsx)(p,{onClick:function(){return g((function(e){return!e}))},label:t,iconSide:l,iconType:a});return Object(d.jsx)(u.EuiPopover,i()({isOpen:b,button:v,closePopover:E},r),n({closePopover:E}))}},770:function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"g",(function(){return s})),a.d(t,"e",(function(){return c})),a.d(t,"c",(function(){return u})),a.d(t,"b",(function(){return d})),a.d(t,"d",(function(){return m})),a.d(t,"f",(function(){return p}));var n=a(12),i=a(14),l=a(110),r=a(99);const o=()=>Object(n.createSelector)(r.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.activeTab)&&void 0!==t?t:i.l.query})),s=()=>Object(n.createSelector)(r.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.show)&&void 0!==t&&t})),c=()=>Object(n.createSelector)(r.selectTimeline,(e=>{var t;return Object.keys(null!==(t=null==e?void 0:e.pinnedEventIds)&&void 0!==t?t:{}).length})),u=()=>Object(n.createSelector)(r.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.noteIds)&&void 0!==t?t:[]})),d=()=>Object(n.createSelector)(r.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.eventIdToNoteIds)&&void 0!==t?t:{}})),m=()=>Object(n.createSelector)(l.selectNotesById,(e=>Object.values(e))),p=()=>Object(n.createSelector)(r.selectTimeline,(e=>null==e?void 0:e.scrollToTop))},812:function(e,t,a){"use strict";a.d(t,"a",(function(){return ee}));var n=a(274),i=a(5),l=a.n(i),r=a(23),o=a.n(r),s=a(43),c=a.n(s),u=a(86),d=a(13),m=a(194),p=a(71),b=a(50),g=a.n(b),E=a(177);const v=o.a.div.withConfig({displayName:"ReactDndDropTarget",componentId:"sc-zu5fvf-0"})(["transition:background-color 0.7s ease;width:100%;height:",";.flyout-overlay{.euiPanel{background-color:",";}}"," > div.timeline-drop-area{.drop-and-provider-timeline{display:none;}& + div{display:none !important;}}"],(({height:e})=>e),(e=>e.theme.eui.euiFormBackgroundColor),(e=>e.isDraggingOver?`\n    .drop-and-provider-timeline {\n      &:hover {\n        background-color: ${Object(n.rgba)(e.theme.eui.euiColorSuccess,.3)};\n      }\n    }\n    .drop-and-provider-timeline:hover {\n        background-color: ${Object(n.rgba)(e.theme.eui.euiColorSuccess,.3)};\n    }\n  > div.timeline-drop-area-empty {\n     color: ${e.theme.eui.euiColorSuccess};\n     background-color: ${Object(n.rgba)(e.theme.eui.euiColorSuccess,.2)};\n\n     & .euiTextColor--subdued {\n      color: ${e.theme.eui.euiColorSuccess};\n     }\n  }\n  > div.timeline-drop-area {\n    background-color: ${Object(n.rgba)(e.theme.eui.euiColorSuccess,.2)};\n    .provider-item-filter-container div:first-child{\n      /* Override dragNdrop beautiful so we do not have our droppable moving around for no good reason */\n      transform: none !important;\n    }\n    .drop-and-provider-timeline {\n      display: block !important;\n      + div {\n        display: none;\n      }\n    }\n\n    & .euiFormHelpText {\n      color: ${e.theme.eui.euiColorSuccess};\n    }\n  }\n  .flyout-overlay {\n    .euiPanel {\n      background-color: ${e.theme.eui.euiColorLightShade};\n    }\n    + div {\n      /* Override dragNdrop beautiful so we do not have our droppable moving around for no good reason */\n      display: none !important;\n    }\n  }\n  `:""));v.displayName="ReactDndDropTarget";const h=l.a.memo((({children:e=null,droppableId:t,height:a="100%",isDropDisabled:n=!1,type:r,render:o=null,renderClone:s})=>{const c=Object(i.useCallback)(((t,n)=>l.a.createElement(v,g()({height:a,ref:t.innerRef},t.droppableProps,{isDraggingOver:n.isDraggingOver}),null==o?e:o({isDraggingOver:n.isDraggingOver}),t.placeholder)),[e,a,o]);return l.a.createElement(E.Droppable,{isDropDisabled:n,droppableId:t,direction:"horizontal",type:r,renderClone:s},c)}));h.displayName="DroppableWrapper";var f=a(204),y=a(16),j=a(325),O=a(3),S=a(42),x=a(14),w=a(715),k=a(395),T=a(30),C=a(84),I=a(372);const P=({browserFields:e,timelineId:t})=>{const a=Object(S.useDispatch)(),[n,r]=Object(i.useState)(!1),o=Object(i.useMemo)((()=>C.b.getTimelineByIdSelector()),[]),{dataProviders:s,timelineType:u}=Object(p.a)((e=>Object(O.pick)(["dataProviders","timelineType"],o(e,t)))),d=Object(i.useCallback)((()=>r(!0)),[r]),m=Object(i.useCallback)((()=>r(!1)),[r]),b=Object(i.useCallback)((({andProviderId:e,excluded:n,field:i,id:l,operator:r,providerId:o,value:c,type:u})=>{Object(k.b)({dataProviders:s,destination:{droppableId:`droppableId.timelineProviders.${t}.group.${s.length}`,index:0},dispatch:a,onAddedToTimeline:m,providerToAdd:{id:o,name:c,enabled:!0,excluded:n,kqlQuery:"",type:u,queryMatch:{displayField:void 0,displayValue:void 0,field:i,value:c,operator:r},and:[]},timelineId:t})}),[s,t,a,m]),g=Object(i.useMemo)((()=>[{id:0,width:400,items:[{name:I.a,icon:l.a.createElement(y.EuiIcon,{type:"plusInCircle",size:"m"}),panel:1},u===x.m.template?{disabled:u!==x.m.template,name:I.b,icon:l.a.createElement(y.EuiIcon,{type:"visText",size:"m"}),panel:2}:null].filter((e=>null!==e))},{id:1,title:I.a,width:400,content:l.a.createElement(w.a,{browserFields:e,field:"",isExcluded:!1,onDataProviderEdited:b,operator:":",timelineId:t,value:"",type:T.a.default,providerId:`${t}-${c.a.v4()}`})},{id:2,title:I.b,width:400,content:l.a.createElement(w.a,{browserFields:e,field:"",isExcluded:!1,onDataProviderEdited:b,operator:":",timelineId:t,value:"",type:T.a.template,providerId:`${t}-${c.a.v4()}`})}]),[e,b,t,u]),E=Object(i.useMemo)((()=>u===x.m.template?l.a.createElement(y.EuiButton,{size:"s",onClick:d,"data-test-subj":"addField",iconType:"arrowDown",fill:!0,iconSide:"right"},l.a.createElement(y.EuiText,{size:"s"},I.a)):l.a.createElement(y.EuiButtonEmpty,{size:"s",onClick:d,"data-test-subj":"addField",iconSide:"right"},l.a.createElement(y.EuiText,{size:"s"},`+ ${I.a}`))),[d,u]),v=Object(i.useMemo)((()=>u===x.m.template?l.a.createElement(y.EuiContextMenu,{initialPanelId:0,panels:g}):l.a.createElement(w.a,{browserFields:e,field:"",isExcluded:!1,onDataProviderEdited:b,operator:":",timelineId:t,value:"",type:T.a.default,providerId:`${t}-${c.a.v4()}`})),[e,b,g,t,u]);return l.a.createElement(y.EuiPopover,{id:"addFieldsPopover",button:E,isOpen:n,closePopover:m,anchorPosition:"downLeft",panelPaddingSize:"none",repositionOnScroll:!0},v)};P.displayName="AddDataProviderPopoverComponent";const M=l.a.memo(P);M.displayName="AddDataProviderPopover";const L=o()(y.EuiText).withConfig({displayName:"Text",componentId:"sc-1dcwhn2-0"})(["overflow:hidden;margin:5px 0 5px 0;padding:3px;white-space:nowrap;"]);L.displayName="Text";const N=o()(y.EuiBadge).withConfig({displayName:"BadgeHighlighted",componentId:"sc-1dcwhn2-1"})(["height:20px;margin:0 5px 0 5px;maxwidth:85px;minwidth:85px;"]);N.displayName="BadgeHighlighted";const F=o.a.span.withConfig({displayName:"HighlightedBackground",componentId:"sc-1dcwhn2-2"})(["background-color:",";"],(e=>e.theme.eui.euiColorLightShade));F.displayName="HighlightedBackground";const D=o.a.div.withConfig({displayName:"EmptyContainer",componentId:"sc-1dcwhn2-3"})(["width:",";align-items:center;display:flex;flex-direction:column;flex-wrap:wrap;justify-content:center;user-select:none;align-content:center;",""],(e=>e.showSmallMsg?"60px":"auto"),(e=>e.showSmallMsg?`\n      border-right: 1px solid ${e.theme.eui.euiColorMediumShade};\n      margin-right: 10px;\n    `:"\n  min-height: 100px;\n  + div {\n    display: none !important;\n   }\n  "));D.displayName="EmptyContainer";const z=o.a.div.withConfig({displayName:"NoWrap",componentId:"sc-1dcwhn2-4"})(["align-items:center;display:flex;flex-direction:row;flex-wrap:no-wrap;"]);z.displayName="NoWrap";const B=l.a.memo((({showSmallMsg:e=!1,browserFields:t,timelineId:a})=>l.a.createElement(D,{className:"timeline-drop-area-empty","data-test-subj":"empty",showSmallMsg:e},!e&&l.a.createElement(l.a.Fragment,null,l.a.createElement(z,null,l.a.createElement(L,{color:"subdued",size:"s"},I.f),l.a.createElement(F,null,l.a.createElement(N,{className:"highlighted-drop-target"},I.n)),l.a.createElement(L,{color:"subdued",size:"s"},I.m),l.a.createElement(j.a,{type:"or"}),l.a.createElement(L,{color:"subdued",size:"s"},I.q)),l.a.createElement(M,{browserFields:t,timelineId:a})),e&&l.a.createElement(j.a,{type:"or"}))));B.displayName="Empty";var A=a(825),R=a(18);const $={alignItems:"center",display:"flex",height:"36px",minWidth:"125px"},V=o.a.div.withConfig({displayName:"DroppableContainer",componentId:"sc-cfhrc0-0"})(["min-height:","px;height:auto !important;."," &:hover{background-color:"," !important;}"],36,u.d,(({theme:e})=>Object(n.rgba)(e.eui.euiColorSuccess,.2))),q=o.a.span.withConfig({displayName:"Parens",componentId:"sc-cfhrc0-1"})(["color:",";font-size:32px;padding:2px;user-select:none;"],(({theme:e})=>e.eui.euiColorMediumShade)),_=o.a.div.withConfig({displayName:"AndOrBadgeContainer",componentId:"sc-cfhrc0-2"})(["span{visibility:",";}"],(({hideBadge:e})=>e?"hidden":"inherit")),G=o.a.div.withConfig({displayName:"LastAndOrBadgeInGroup",componentId:"sc-cfhrc0-3"})(["display:none;."," &{display:initial;}"],u.d),H=o()(y.EuiFlexItem).withConfig({displayName:"OrFlexItem",componentId:"sc-cfhrc0-4"})(["padding-left:9px;"]);o()(y.EuiFormHelpText).withConfig({displayName:"TimelineEuiFormHelpText",componentId:"sc-cfhrc0-5"})(["padding-top:0px;position:absolute;bottom:0px;left:4px;"]).displayName="TimelineEuiFormHelpText";const U=o()(y.EuiFlexItem).withConfig({displayName:"ParensContainer",componentId:"sc-cfhrc0-6"})(["align-self:center;"]),J=e=>{var t;return null!==(t=e.queryMatch.displayValue)&&void 0!==t?t:e.queryMatch.value},Q=l.a.memo((({browserFields:e,timelineId:t,dataProviders:a})=>{const n=Object(i.useMemo)((()=>[...Object(k.c)(a),...k.a]),[a]),r=Object(i.useMemo)((()=>n.map(((i,r)=>l.a.createElement(K,{key:`droppable-${r}`,group:i,groupIndex:r,isLastGroup:r===n.length-1,browserFields:e,timelineId:t,dataProviders:a})))),[e,n,a,t]);return l.a.createElement("div",null,r)}));Q.displayName="Providers";const W=l.a.memo((({browserFields:e,group:t,groupIndex:a,dataProvider:n,index:r,timelineId:o})=>{const s=Object(i.useRef)(null),[c,d]=Object(i.useState)(!1),[,m]=Object(i.useState)(!1),p=Object(S.useDispatch)(),{timelines:b}=Object(R.j)().services,v=Object(i.useCallback)((()=>{m((e=>!e))}),[]),h=Object(i.useMemo)((()=>Object(f.m)({dataProviderId:n.id,groupIndex:a,timelineId:o})),[n.id,a,o]),O=Object(i.useCallback)((()=>{const e={id:o,providerId:r>0?t[0].id:n.id,andProviderId:r>0?n.id:void 0};p(C.a.removeProvider(e))}),[n.id,p,t,r,o]),x=Object(i.useCallback)((()=>{const e={id:o,providerId:r>0?t[0].id:n.id,enabled:!n.enabled,andProviderId:r>0?n.id:void 0};p(C.a.updateDataProviderEnabled(e))}),[n.enabled,n.id,p,t,r,o]),w=Object(i.useCallback)((()=>{const e={id:o,providerId:r>0?t[0].id:n.id,excluded:!n.excluded,andProviderId:r>0?n.id:void 0};p(C.a.updateDataProviderExcluded(e))}),[n.excluded,n.id,p,t,r,o]),k=Object(i.useCallback)((()=>{const e={id:o,providerId:r>0?t[0].id:n.id,type:n.type===T.a.template?T.a.default:T.a.template,andProviderId:r>0?n.id:void 0};p(C.a.updateDataProviderType(e))}),[n.id,n.type,p,t,r,o]),I=Object(i.useCallback)((({andProviderId:e,excluded:t,field:a,operator:n,providerId:i,value:l})=>p(C.a.dataProviderEdited({andProviderId:e,excluded:t,field:a,id:o,operator:n,providerId:i,value:l}))),[p,o]),P=Object(i.useCallback)((()=>{var e;null===(e=s.current)||void 0===e||e.focus()}),[]),M=Object(i.useCallback)((()=>{d(!0)}),[]),{onBlur:L,onKeyDown:N}=b.getUseDraggableKeyboardWrapper()({closePopover:v,draggableId:h,fieldName:n.queryMatch.field,keyboardHandlerRef:s,openPopover:M}),F=Object(i.useCallback)((e=>{s.current===document.activeElement&&N(e)}),[N]),D=Object(i.useCallback)(((a,i)=>{var u,m,p,b,E;return l.a.createElement("div",g()({ref:a.innerRef},a.draggableProps,a.dragHandleProps,{style:(E=a.draggableProps.style,{...E,userSelect:"none"}),"data-test-subj":"providerContainer",tabIndex:-1}),l.a.createElement(y.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},l.a.createElement(y.EuiFlexItem,{grow:!1},l.a.createElement(A.a,{andProviderId:r>0?n.id:void 0,browserFields:e,deleteProvider:O,field:r>0?null!==(u=n.queryMatch.displayField)&&void 0!==u?u:n.queryMatch.field:null!==(m=t[0].queryMatch.displayField)&&void 0!==m?m:t[0].queryMatch.field,kqlQuery:r>0?n.kqlQuery:t[0].kqlQuery,isEnabled:r>0?n.enabled:t[0].enabled,isExcluded:r>0?n.excluded:t[0].excluded,isPopoverOpen:c,onDataProviderEdited:I,operator:r>0?null!==(p=n.queryMatch.operator)&&void 0!==p?p:T.c:null!==(b=t[0].queryMatch.operator)&&void 0!==b?b:T.c,register:n,providerId:r>0?t[0].id:n.id,timelineId:o,setIsPopoverOpen:d,toggleEnabledProvider:x,toggleExcludedProvider:w,toggleTypeProvider:k,val:J(n),type:n.type,wrapperRef:s})),l.a.createElement(y.EuiFlexItem,{grow:!1},!i.isDragging&&(r<t.length-1?l.a.createElement(j.a,{type:"and"}):l.a.createElement(G,null,l.a.createElement(j.a,{type:"and"}))))))}),[e,n,t,I,O,x,w,k,r,c,s,d,o]);return l.a.createElement("div",{className:u.a,"data-test-subj":"draggableWrapperKeyboardHandler",onClick:P,onBlur:L,onKeyDown:F,ref:s,role:"button",tabIndex:0},l.a.createElement(E.Draggable,{disableInteractiveElementBlocking:!0,draggableId:h,index:r,key:n.id},D))}));W.displayName="DataProvidersGroupItem";const K=l.a.memo((({browserFields:e,timelineId:t,group:a,groupIndex:n,isLastGroup:r})=>{const o=Object(i.useMemo)((()=>Object(f.n)({groupIndex:n,timelineId:t})),[n,t]),s=Object(i.useMemo)((()=>a.map(((i,r)=>l.a.createElement(W,{key:i.id,browserFields:e,dataProvider:i,index:r,timelineId:t,group:a,groupIndex:n})))),[e,a,n,t]),c=Object(i.useCallback)((e=>l.a.createElement(V,g()({className:r?"empty-providers-group":"",ref:e.innerRef,style:$},e.droppableProps),s,e.placeholder)),[s,r]);return l.a.createElement(l.a.Fragment,null,0!==n&&l.a.createElement(y.EuiSpacer,{size:"xs"}),l.a.createElement(y.EuiFlexGroup,{"aria-label":I.l(n),alignItems:"center",gutterSize:"none"},l.a.createElement(H,{grow:!1},l.a.createElement(_,{hideBadge:0===n},l.a.createElement(j.a,{type:"or"}))),l.a.createElement(U,{grow:!1},l.a.createElement(q,null,"(")),l.a.createElement(y.EuiFlexItem,{grow:!1},l.a.createElement(E.Droppable,{droppableId:o,direction:"horizontal"},c)),l.a.createElement(U,{grow:!1},l.a.createElement(q,null,")")),r&&l.a.createElement(M,{browserFields:e,timelineId:t})))}));K.displayName="DataProvidersGroup";var Z=a(87);const Y=o.a.div.withConfig({displayName:"DropTargetDataProvidersContainer",componentId:"sc-rnh8sd-0"})(["padding:2px 0 4px 0;."," & .drop-target-data-providers{background:",";border:0.2rem dashed ",";& .euiTextColor--subdued{color:",";}& .euiFormHelpText{color:",";}}"],u.d,(({theme:e})=>Object(n.rgba)(e.eui.euiColorSuccess,.1)),(({theme:e})=>e.eui.euiColorSuccess),(({theme:e})=>e.eui.euiColorSuccess),(({theme:e})=>e.eui.euiColorSuccess)),X=o.a.div.withConfig({displayName:"DropTargetDataProviders",componentId:"sc-rnh8sd-1"})(["display:flex;flex-direction:column;justify-content:flex-start;padding-bottom:2px;position:relative;border:0.2rem dashed ",";border-radius:5px;padding:"," 0;margin:2px 0 2px 0;max-height:33vh;min-height:100px;overflow:auto;resize:vertical;background-color:",";"],(({theme:e})=>e.eui.euiColorMediumShade),(({theme:e})=>e.eui.euiSizeXS),(({theme:e})=>e.eui.euiFormBackgroundColor));X.displayName="DropTargetDataProviders";const ee=l.a.memo((({timelineId:e})=>{const{browserFields:t}=Object(m.d)(d.SourcererScopeName.timeline),a=Object(i.useMemo)((()=>C.b.getManageTimelineById()),[]),{isLoading:n}=Object(p.a)((t=>a(t,e))),r=Object(i.useMemo)((()=>C.b.getTimelineByIdSelector()),[]),o=Object(p.a)((t=>{var a;return(null!==(a=r(t,e))&&void 0!==a?a:Z.a).dataProviders})),s=Object(i.useMemo)((()=>{return t=e,`${f.g}${t}${c.a.v4()}`;var t}),[e]);return l.a.createElement(Y,{"aria-label":I.r,className:"drop-target-data-providers-container"},l.a.createElement(X,{className:"drop-target-data-providers","data-test-subj":"dataProviders"},null!=o&&o.length?l.a.createElement(Q,{browserFields:t,timelineId:e,dataProviders:o}):l.a.createElement(h,{isDropDisabled:n,droppableId:s},l.a.createElement(B,{browserFields:t,timelineId:e}))))}));ee.displayName="DataProviders"}}]);