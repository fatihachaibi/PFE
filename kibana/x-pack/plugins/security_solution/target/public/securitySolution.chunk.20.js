/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[20],{1375:function(e,t,n){"use strict";n.r(t),n.d(t,"EndpointPackageCustomExtension",(function(){return F})),n.d(t,"TRUSTED_APPS_LABELS",(function(){return C})),n.d(t,"EVENT_FILTERS_LABELS",(function(){return T})),n.d(t,"HOST_ISOLATION_EXCEPTIONS_LABELS",(function(){return O})),n.d(t,"BLOCKLISTS_LABELS",(function(){return _}));var a=n(50),i=n.n(a),r=n(5),s=n.n(r),o=n(16),c=n(18),l=n(399),u=n(388),d=n(416),m=n(334),p=n(485),f=n(4),E=n(165),g=n(176),y=n(173),b=n(91),S=n(587),h=n(586),x=n(588),I=n(260),v=n(198);const A={artifactsSummaryApiError:e=>f.i18n.translate("xpack.securitySolution.endpoint.fleetCustomExtension.artifactsSummaryError",{defaultMessage:'There was an error trying to fetch artifacts stats: "{error}"',values:{error:e}}),cardTitle:s.a.createElement(E.FormattedMessage,{id:"xpack.securitySolution.endpoint.fleetCustomExtension.title",defaultMessage:"Artifacts"})},j=Object(r.memo)((({pkgkey:e,artifactApiClientInstance:t,getArtifactsPath:n,labels:a=A,"data-test-subj":i})=>{const{getAppUrl:l}=Object(b.b)(),u=Object(c.n)(),d=n(),m=Object(v.a)(i),{data:p}=Object(I.f)(t,{},[],{onError:e=>u.addDanger(a.artifactsSummaryApiError(e.message))}),j=Object(r.useMemo)((()=>{const t=`#${g.pagePathGetters.integration_details_custom({pkgkey:e})[1]}`;return{backButtonLabel:f.i18n.translate("xpack.securitySolution.endpoint.fleetCustomExtension.backButtonLabel",{defaultMessage:"Return to Endpoint Security integrations"}),onBackButtonNavigateTo:[y.INTEGRATIONS_PLUGIN_ID,{path:t}],backButtonUrl:l({appId:y.INTEGRATIONS_PLUGIN_ID,path:t})}}),[l,e]);return s.a.createElement(o.EuiPanel,{hasShadow:!1,paddingSize:"l",hasBorder:!0,"data-test-subj":m("fleetCard")},s.a.createElement(x.a,{alignItems:"baseline",justifyContent:"center"},s.a.createElement(x.b,{gridarea:"title",alignitems:"flex-start"},s.a.createElement(o.EuiText,null,s.a.createElement("h4",null,a.cardTitle))),s.a.createElement(x.b,{gridarea:"summary"},s.a.createElement(h.a,{stats:p})),s.a.createElement(x.b,{gridarea:"link",alignitems:"flex-end"},s.a.createElement(s.a.Fragment,null,s.a.createElement(S.a,{href:l({path:d}),appPath:d,appState:j,"data-test-subj":m("artifactsLink")},s.a.createElement(E.FormattedMessage,{id:"xpack.securitySolution.endpoint.fleetCustomExtension.manageArtifactsLinkLabel",defaultMessage:"Manage"}))))))}));j.displayName="FleetArtifactsCard";var k=n(206);const C={artifactsSummaryApiError:e=>f.i18n.translate("xpack.securitySolution.endpoint.fleetCustomExtension.trustedAppsSummarySummary.error",{defaultMessage:'There was an error trying to fetch trusted applications stats: "{error}"',values:{error:e}}),cardTitle:s.a.createElement(E.FormattedMessage,{id:"xpack.securitySolution.endpoint.trustedApps.fleetIntegration.title",defaultMessage:"Trusted applications"})},T={artifactsSummaryApiError:e=>f.i18n.translate("xpack.securitySolution.endpoint.fleetCustomExtension.eventFiltersSummarySummary.error",{defaultMessage:'There was an error trying to fetch event filters stats: "{error}"',values:{error:e}}),cardTitle:s.a.createElement(E.FormattedMessage,{id:"xpack.securitySolution.endpoint.eventFilters.fleetIntegration.title",defaultMessage:"Event filters"})},O={artifactsSummaryApiError:e=>f.i18n.translate("xpack.securitySolution.endpoint.fleetCustomExtension.hostIsolationExceptionsSummarySummary.error",{defaultMessage:'There was an error trying to fetch host isolation exceptions stats: "{error}"',values:{error:e}}),cardTitle:s.a.createElement(E.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolationExceptions.fleetIntegration.title",defaultMessage:"Host isolation exceptions"})},_={artifactsSummaryApiError:e=>f.i18n.translate("xpack.securitySolution.endpoint.fleetCustomExtension.blocklistsSummarySummary.error",{defaultMessage:'There was an error trying to fetch blocklist stats: "{error}"',values:{error:e}}),cardTitle:s.a.createElement(E.FormattedMessage,{id:"xpack.securitySolution.endpoint.blocklists.fleetIntegration.title",defaultMessage:"Blocklist"})};var M=n(425),w=n(618);const F=Object(r.memo)((e=>{const t=Object(c.i)(),n=Object(l.a)(),{loading:a,canAccessEndpointManagement:f}=Object(M.b)(),E=Object(r.useMemo)((()=>u.a.getInstance(t)),[t]),g=Object(r.useMemo)((()=>d.a.getInstance(t)),[t]),y=Object(r.useMemo)((()=>m.a.getInstance(t)),[t]),b=Object(r.useMemo)((()=>p.a.getInstance(t)),[t]),S=Object(r.useMemo)((()=>s.a.createElement("div",{"data-test-subj":"fleetEndpointPackageCustomContent"},s.a.createElement(j,i()({},e,{artifactApiClientInstance:E,getArtifactsPath:k.o,labels:C,"data-test-subj":"trustedApps"})),s.a.createElement(o.EuiSpacer,null),s.a.createElement(j,i()({},e,{artifactApiClientInstance:g,getArtifactsPath:k.f,labels:T,"data-test-subj":"eventFilters"})),n&&s.a.createElement(s.a.Fragment,null,s.a.createElement(o.EuiSpacer,null),s.a.createElement(j,i()({},e,{artifactApiClientInstance:y,getArtifactsPath:k.g,labels:O,"data-test-subj":"hostIsolationExceptions"}))),s.a.createElement(o.EuiSpacer,null),s.a.createElement(j,i()({},e,{artifactApiClientInstance:b,getArtifactsPath:k.c,labels:_,"data-test-subj":"blocklists"})))),[b,n,g,y,E,e]);return a?s.a.createElement(o.EuiLoadingSpinner,{"data-test-subj":"endpointExtensionLoadingSpinner"}):f?S:s.a.createElement(w.a,null)}));F.displayName="EndpointPackageCustomExtension"},334:function(e,t,n){"use strict";n.d(t,"a",(function(){return HostIsolationExceptionsApiClient}));var a=n(202),i=n(335),r=n(367);class HostIsolationExceptionsApiClient extends i.a{constructor(e){super(e,a.h,r.a)}static getInstance(e){return super.getInstance(e,a.h,r.a)}}},367:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return s}));var a=n(219),i=n(202);const r=["item_id","name","description","entries.value"],s={name:i.i,namespace_type:"agnostic",description:i.g,list_id:i.h,type:a.a.ENDPOINT_HOST_ISOLATION_EXCEPTIONS}},388:function(e,t,n){"use strict";n.d(t,"a",(function(){return TrustedAppsApiClient}));var a=n(202),i=n(433),r=n(335),s=n(389);function o(e){return{...e,entries:Object(i.b)(e.entries)}}function c(e){return{...e,entries:Object(i.a)(e.entries,!0)}}class TrustedAppsApiClient extends r.a{constructor(e){super(e,a.m,s.b,o,c)}static getInstance(e){return super.getInstance(e,a.m,s.b,o,c)}}},389:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return s}));var a=n(219),i=n(202);const r=["name","description","item_id","entries.value","entries.entries.value"],s={name:i.n,namespace_type:"agnostic",description:i.l,list_id:i.m,type:a.a.ENDPOINT_TRUSTED_APPS}},390:function(e,t,n){"use strict";n.d(t,"a",(function(){return BlocklistsApiClient}));var a=n(202),i=n(433),r=n(335),s=n(421);function o(e){return{...e,entries:Object(i.b)(e.entries)}}function c(e){return{...e,entries:Object(i.a)(e.entries)}}class BlocklistsApiClient extends r.a{constructor(e){super(e,a.b,s.a,o,c)}static getInstance(e){return super.getInstance(e,a.b,s.a,o,c)}}},399:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(5),i=n(425),r=n(91),s=n(260),o=n(334);function c(){const e=Object(r.g)(),t=Object(i.b)(),n=Object(s.f)(o.a.getInstance(e),void 0,void 0,{enabled:!1}),{data:c,isFetching:l,refetch:u,isFetched:d}=n,m=Object(a.useMemo)((()=>t.canIsolateHost||Boolean(null==c?void 0:c.total)),[t.canIsolateHost,null==c?void 0:c.total]);return Object(a.useEffect)((()=>{t.canIsolateHost||t.loading||d||l||u()}),[u,d,l,t.canIsolateHost,t.loading]),m}},421:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return o}));var a=n(219),i=n(202);const r=a.a.ENDPOINT_BLOCKLISTS,s={name:i.c,namespace_type:"agnostic",description:i.a,list_id:i.b,type:r},o=["name","description","item_id","entries.value","entries.entries.value","comments.comment"]},433:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d}));var a=n(212);const i="included",r=e=>{switch(e.length){case 32:return"md5";case 40:return"sha1";case 64:return"sha256"}},s=(e,t)=>({field:e,value:t,type:"match",operator:i}),o=(e,t)=>({field:e,value:t,type:"match_any",operator:i});const c=(e,t=!1)=>{const n=[];return e.forEach((e=>{if(e.field.includes(a.b.HASH))(function(e,t){const n=[];if(!Array.isArray(t.value)){const i=s(`${e}${a.b.HASH}${r(t.value)}`,t.value.toLowerCase());return n.push(i),n}const i=t.value.reduce(((e,t)=>{const n=r(t);return n?{...e,[n]:[...e[n],t]}:e}),{md5:[],sha1:[],sha256:[]});return Object.entries(i).forEach((([t,i])=>{if(!i.length)return;const r=o(`${e}${a.b.HASH}${t}`,i);n.push(r)})),n})(e.field.split(".")[0],e).forEach((e=>n.push(e)));else if(e.field.includes(a.b.SIGNER)){const a=function(e,t,n=!1){const a=Array.isArray(t)?o("subject_name",t):s("subject_name",t),i=[];return n&&i.push(s("trusted","true")),i.push(a),((e,t)=>({field:e,entries:t,type:"nested"}))(e,i)}(e.field,e.value,t);n.push(a)}else if((e.field.includes(a.b.EXECUTABLE)||e.field.includes(a.b.PATH))&&"wildcard"===e.type){const t=function(e,t){return Array.isArray(t)?o(e,t):((e,t)=>({field:e,value:t,type:"wildcard",operator:i}))(e,t)}(e.field,e.value);n.push(t)}else{const t=(c=e.field,l=e.value,Array.isArray(l)?o(c,l):s(c,l));n.push(t)}var c,l})),n},l=(e,t,n)=>({field:e,value:n,type:t,operator:i});function u(e){return`${e.split(".")[0]}${a.b.HASH}*`}const d=e=>{const t=(e=>e.reduce(((e,t)=>{const n=t.field;if(n.includes(a.b.HASH)&&"match"===t.type){const a=u(n);return{...e,[a]:l(a,t.type,t.value)}}if(n.includes(a.b.HASH)&&"match_any"===t.type){var i,r;const a=u(n),s=null!==(i=null===(r=e[a])||void 0===r?void 0:r.value)&&void 0!==i?i:[];return{...e,[a]:l(a,t.type,[...s,...t.value])}}if((n.includes(a.b.EXECUTABLE)||n.includes(a.b.PATH))&&("match"===t.type||"match_any"===t.type||"wildcard"===t.type))return{...e,[n]:l(n,t.type,t.value)};if(n.includes(a.b.SIGNER)&&"nested"===t.type){const a=t.entries.find((e=>"subject_name"===e.field&&("match"===e.type||"match_any"===e.type)));if(a)return{...e,[n]:l(n,a.type,a.value)}}return e}),{}))(e);return Object.values(t).reduce(((e,t)=>t?[...e,t]:e),[])}},485:function(e,t,n){"use strict";var a=n(390);n.d(t,"a",(function(){return a.a}))},586:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n(5),i=n.n(a),r=n(16),s=n(4),o=n(23),c=n.n(o);const l=["windows","macos","linux","total"],u={windows:s.i18n.translate("xpack.securitySolution.endpoint.fleetCustomExtension.exceptionItemsSummary.windows",{defaultMessage:"Windows"}),linux:s.i18n.translate("xpack.securitySolution.endpoint.fleetCustomExtension.exceptionItemsSummary.linux",{defaultMessage:"Linux"}),macos:s.i18n.translate("xpack.securitySolution.endpoint.fleetCustomExtension.exceptionItemsSummary.macos",{defaultMessage:"Mac"}),total:s.i18n.translate("xpack.securitySolution.endpoint.fleetCustomExtension.exceptionItemsSummary.total",{defaultMessage:"Total"})},d=(c()(r.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGridGroup",componentId:"sc-1pq2evz-0"})(["display:grid;min-width:240px;grid-template-columns:50% 50%;"]),c()(r.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-1pq2evz-1"})(["font-size:",";font-weight:",";"],(({isSmall:e,theme:t})=>e?t.eui.euiFontSizeXS:"inherit"),(({isSmall:e})=>e?"1px":"inherit"))),m={fontWeight:"bold"},p=Object(a.memo)((({stats:e,isSmall:t=!1})=>{const n=Object(a.useCallback)((n=>{var a;return"total"!==n&&t?null:i.a.createElement(r.EuiFlexItem,{key:n},i.a.createElement(f,{value:null!==(a=null==e?void 0:e[n])&&void 0!==a?a:0,color:"total"!==n||t?"default":"primary",key:n,isSmall:t},u[n]))}),[e,t]);return i.a.createElement(r.EuiFlexGroup,{alignItems:"center",justifyContent:t?"flexStart":"spaceAround",gutterSize:t?"s":"l"},l.map((e=>n(e))))}));p.displayName="ExceptionItemsSummary";const f=Object(a.memo)((({children:e,value:t,color:n,isSmall:a=!1,...s})=>i.a.createElement(r.EuiText,{className:"eui-displayInlineBlock",size:a?"xs":"s"},i.a.createElement(d,{justifyContent:a?"flexStart":"center",direction:a?"rowReverse":"row",alignItems:"center",gutterSize:a?"xs":"l",isSmall:a},a?null:i.a.createElement(r.EuiFlexItem,{grow:!1,style:"primary"===n?m:void 0},e),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiBadge,{color:n},t))))));f.displayName="SummaryState"},587:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(23),i=n.n(a),r=n(5),s=n.n(r),o=n(16),c=n(316);const l=i.a.span.withConfig({displayName:"LinkLabel",componentId:"sc-1ril6c5-0"})(["display:inline-block;padding-right:",";font-size:",";"],(e=>e.theme.eui.paddingSizes.s),(({size:e,theme:t})=>"m"===e?t.eui.euiFontSizeXS:"innherit")),u=Object(r.memo)((({children:e,size:t="l",...n})=>s.a.createElement(c.a,n,s.a.createElement(l,{size:t},e),s.a.createElement(o.EuiIcon,{type:"m"===t?"arrowRight":"popout"}))));u.displayName="LinkWithIcon"},588:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return c}));var a=n(23),i=n.n(a),r=n(16);const s=i()(r.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGridGroup",componentId:"sc-iti06b-0"})(["display:grid;grid-template-columns:33% 45% 22%;grid-template-areas:'title summary link';"]),o=i()(r.EuiFlexItem).withConfig({displayName:"StyledEuiFlexGridItem",componentId:"sc-iti06b-1"})(["grid-area:",";align-items:",";margin:0px;padding:12px;"],(({gridarea:e})=>e),(({alignitems:e})=>null!=e?e:"center")),c=i()(r.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-iti06b-2"})(["flex-direction:row-reverse;"])},618:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(5),i=n.n(a),r=n(16),s=n(165);const o=Object(a.memo)((()=>i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiEmptyPrompt,{iconType:"alert",iconColor:"danger",titleSize:"l","data-test-subj":"noIngestPermissions",title:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpointManagemnet.noPermissionsText",defaultMessage:"You do not have the required Kibana permissions to use Elastic Security Administration"}),body:i.a.createElement(r.EuiText,{color:"subdued"},i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpointManagement.noPermissionsSubText",defaultMessage:"You must have the superuser role to use this feature. If you do not have the superuser role and do not have permissions to edit user roles, contact your Kibana administrator."}))}))));o.displayName="NoPermissions"}}]);