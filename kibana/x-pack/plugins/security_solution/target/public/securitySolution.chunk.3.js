/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[3],{227:function(e,t,n){"use strict";n.d(t,"z",(function(){return v})),n.d(t,"G",(function(){return g})),n.d(t,"N",(function(){return h})),n.d(t,"l",(function(){return b})),n.d(t,"E",(function(){return y})),n.d(t,"r",(function(){return E})),n.d(t,"L",(function(){return C})),n.d(t,"M",(function(){return x})),n.d(t,"e",(function(){return w})),n.d(t,"D",(function(){return S})),n.d(t,"w",(function(){return O})),n.d(t,"B",(function(){return j})),n.d(t,"m",(function(){return M})),n.d(t,"d",(function(){return k})),n.d(t,"J",(function(){return D})),n.d(t,"a",(function(){return I})),n.d(t,"H",(function(){return T})),n.d(t,"p",(function(){return _})),n.d(t,"h",(function(){return R})),n.d(t,"j",(function(){return F})),n.d(t,"i",(function(){return B})),n.d(t,"k",(function(){return A})),n.d(t,"I",(function(){return q})),n.d(t,"O",(function(){return $})),n.d(t,"c",(function(){return Y})),n.d(t,"x",(function(){return X})),n.d(t,"b",(function(){return Z})),n.d(t,"y",(function(){return W})),n.d(t,"C",(function(){return H})),n.d(t,"K",(function(){return G})),n.d(t,"A",(function(){return U})),n.d(t,"v",(function(){return K})),n.d(t,"q",(function(){return Q})),n.d(t,"g",(function(){return J})),n.d(t,"o",(function(){return ee})),n.d(t,"n",(function(){return te})),n.d(t,"u",(function(){return ne})),n.d(t,"t",(function(){return re})),n.d(t,"f",(function(){return ae})),n.d(t,"s",(function(){return oe})),n.d(t,"F",(function(){return ie}));var r=n(12),a=n(613),o=n(818),i=n(175),s=n(614),l=n(505);const c=Object(r.createSelector)((e=>e),(({ariaActiveDescendant:e})=>e)),u=Object(r.createSelector)((e=>e),(({selectedNode:e})=>e)),d=Object(r.createSelector)((e=>e.locationSearch),(e=>e.resolverComponentInstanceID),((e,t)=>Object(s.a)({locationSearch:e,resolverComponentInstanceID:t}))),p=Object(r.createSelector)((e=>e.locationSearch),(e=>e.resolverComponentInstanceID),((e,t)=>n=>{if(void 0===e||void 0===t)return;const r=new URLSearchParams(e),a=Object(i.encode)(n);return r.set(Object(l.a)(t),a),`?${r.toString()}`})),m=Object(r.createSelector)(p,(e=>(t,n)=>{const r=new Map;return void 0!==t&&Object.keys(t).map((t=>{const a={panelView:"nodeEventsInCategory",panelParameters:{nodeID:n,eventCategory:t}};return r.set(t,e(a)),t})),r}));var f=n(284);const v=se(P,a.d),g=(se(P,a.a),se(P,a.g),se(P,a.b),se(P,a.e),se(P,a.f)),h=se(P,a.h),b=se(P,a.c),y=se(L,o.C),E=se(L,o.q),C=se(L,o.I),x=se(L,o.J),w=(se(L,o.H),se(L,o.d)),S=se(L,o.B),O=se(L,o.u),j=se(L,o.A),M=(se(L,o.y),se(L,o.l)),k=se(L,o.c),D=se(L,o.F),I=se(N,c),T=se(N,u);function P(e){return e.camera}function L(e){return e.data}function N(e){return e.ui}const _=se(L,o.o),R=se(L,o.h),F=se(L,o.j),B=se(L,o.i),A=se(L,o.k),z=(se(L,o.f),se(P,a.i)),V=se(L,o.v),q=se(L,o.E),$=Object(r.createSelector)(V,z,(function(e,t){return n=>e(t(n))})),Y=se(L,o.b),X=se(L,o.w),Z=Object(r.createSelector)($,se(L,o.a),((e,t)=>Object(r.defaultMemoize)((n=>{const{processNodePositions:r}=e(n),a=new Set;for(const e of r.keys()){const t=f.b(e);void 0!==t&&a.add(t)}return e=>{const n=t(e);return null===n||!1===a.has(n)?null:n}})))),W=se(N,d),H=se(N,p),G=(se(N,m),se(L,o.G)),U=se(L,o.z),K=se(L,o.t),Q=se(L,o.p),J=se(L,o.g),ee=se(L,o.n),te=se(L,o.m),ne=se(L,o.s),re=se(L,o.r),ae=se(L,o.e),oe=Object(r.createSelector)(se(L,(e=>e.nodeData)),$,(function(e,t){return Object(r.defaultMemoize)((n=>{const{processNodePositions:r}=t(n),a=new Set;for(const t of r.keys()){const n=f.b(t);void 0===n||e&&e.has(n)||a.add(n)}return a}))})),ie=se(L,o.D);function se(e,t){return n=>t(e(n))}},269:function(e,t,n){"use strict";n.d(t,"j",(function(){return a})),n.d(t,"i",(function(){return o})),n.d(t,"o",(function(){return i})),n.d(t,"g",(function(){return s})),n.d(t,"q",(function(){return l})),n.d(t,"m",(function(){return c})),n.d(t,"k",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"p",(function(){return p})),n.d(t,"n",(function(){return m})),n.d(t,"e",(function(){return f})),n.d(t,"r",(function(){return v})),n.d(t,"c",(function(){return g})),n.d(t,"l",(function(){return h})),n.d(t,"a",(function(){return b})),n.d(t,"d",(function(){return y})),n.d(t,"h",(function(){return E})),n.d(t,"f",(function(){return C}));var r=n(438);function a(e){return"endgame"in e&&void 0!==e.endgame}function o(e){return void 0!==e.endgame}function i(e){return Object(r.a)(null==e?void 0:e["@timestamp"])}function s(e){return Object(r.a)(e["@timestamp"])}function l(e){var t;if(!a(e))return Object(r.a)(null===(t=e.user)||void 0===t?void 0:t.name)}function c(e){var t,n;return Object(r.a)(a(e)?e.endgame.ppid:null===(t=e.process)||void 0===t||null===(n=t.parent)||void 0===n?void 0:n.pid)}function u(e){var t,n;return Object(r.a)(a(e)||null===(t=e.process)||void 0===t||null===(n=t.hash)||void 0===n?void 0:n.md5)}function d(e){var t;if(!a(e))return Object(r.c)(null===(t=e.process)||void 0===t?void 0:t.args)}function p(e){var t;if(!a(e))return Object(r.a)(null===(t=e.user)||void 0===t?void 0:t.domain)}function m(e){return a(e)?Object(r.a)(e.endgame.process_name):Object(r.a)(null===(t=e.process)||void 0===t?void 0:t.name);var t}function f(e){var t;return Object(r.a)(a(e)?e.endgame.serial_event_id:null===(t=e.event)||void 0===t?void 0:t.id)}function v(e){var t;return Object(r.a)(null===(t=e.winlog)||void 0===t?void 0:t.record_id)}function g(e){var t,n;return a(e)?void 0===(null===(t=e.endgame)||void 0===t?void 0:t.unique_pid)?void 0:String(Object(r.a)(e.endgame.unique_pid)):Object(r.a)(null===(n=e.process)||void 0===n?void 0:n.entity_id)}function h(e){var t,n,o;return a(e)?String(Object(r.a)(null===(o=e.endgame)||void 0===o?void 0:o.unique_ppid)):Object(r.a)(null===(t=e.process)||void 0===t||null===(n=t.parent)||void 0===n?void 0:n.entity_id)}function b(e){var t,n;if(!a(e))return Object(r.c)(null===(t=e.process)||void 0===t||null===(n=t.Ext)||void 0===n?void 0:n.ancestry)}function y(e){var t;return Object(r.c)(a(e)?e.endgame.event_type_full:null===(t=e.event)||void 0===t?void 0:t.category)}function E(e){var t;return Object(r.c)(a(e)?e.endgame.event_subtype_full:null===(t=e.event)||void 0===t?void 0:t.type)}function C(e){return a(e)?[]:Object(r.c)(null===(t=e.event)||void 0===t?void 0:t.kind);var t}},284:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return i})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return l}));var r=n(438);function a(e){return null!=e&&e.id?String(Object(r.a)(e.id)):void 0}function o(e){return null!=e&&e.parent?String(Object(r.a)(null==e?void 0:e.parent)):void 0}function i(e){const t=s(e);if(void 0===t)return;const n=new Date(t);return isFinite(n.getTime())?n:void 0}function s(e){return Object(r.a)(null==e?void 0:e.data["@timestamp"])}function l(e){return null!=e&&e.name?String(Object(r.a)(e.name)):void 0}},310:function(e,t,n){"use strict";function r(e,t){return[e[0]+t[0],e[1]+t[1]]}function a(e,t){return[e[0]-t[0],e[1]-t[1]]}function o(e,t){return[e[0]/t[0],e[1]/t[1]]}function i(e,t){return[e[0]*t[0],e[1]*t[1]]}function s([e,t],[n,r,a,o,i,s]){return[e*n+t*r+a,e*o+t*i+s]}function l([e,t],[n,r]){return e===n&&t===r}function c(e,t){const[n,r]=e,[a,o]=t;return Math.sqrt(Math.pow(a-n,2)+Math.pow(o-r,2))}function u(e,t){const n=t[0]-e[0],r=t[1]-e[1];return Math.atan2(r,n)}function d(e,t){return[e[0]*t,e[1]*t]}function p(e,t,n){return r(d(e,1-n),d(t,n))}n.d(t,"a",(function(){return r})),n.d(t,"j",(function(){return a})),n.d(t,"e",(function(){return o})),n.d(t,"h",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"f",(function(){return l})),n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"i",(function(){return d})),n.d(t,"g",(function(){return p}))},328:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(16),a=n(4),o=n(165),i=n(5),s=n.n(i);const l=({count:e})=>{const[t,n,l]=Object(i.useMemo)((()=>function(e){var t;if(!Number.isFinite(e))return[e,"",""];const n=Math.pow(10,3*Math.min(Math.floor(Math.floor(Math.log10(e))/3),4)),r={compactThousands:a.i18n.translate("xpack.securitySolution.formattedNumber.compactThousands",{defaultMessage:"k"}),compactMillions:a.i18n.translate("xpack.securitySolution.formattedNumber.compactMillions",{defaultMessage:"M"}),compactBillions:a.i18n.translate("xpack.securitySolution.formattedNumber.compactBillions",{defaultMessage:"B"}),compactTrillions:a.i18n.translate("xpack.securitySolution.formattedNumber.compactTrillions",{defaultMessage:"T"})},o=new Map([[1,""],[1e3,r.compactThousands],[1e6,r.compactMillions],[1e9,r.compactBillions],[1e12,r.compactTrillions]]),i=a.i18n.translate("xpack.securitySolution.formattedNumber.compactOverflow",{defaultMessage:"+"}),s=null!==(t=o.get(n))&&void 0!==t?t:"";return[Math.floor(e/n),s,e/n%1>Number.EPSILON?i:""]}(e||0)),[e]);return null==e?null:0===e?s.a.createElement(s.a.Fragment,null,0):s.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.formattedNumber.countsLabel",description:"",defaultMessage:"{mantissa}{scale}{hasRemainder}",values:{mantissa:s.a.createElement(r.EuiI18nNumber,{value:t}),scale:n,hasRemainder:l}})},c=s.a.memo(l)},394:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"a",(function(){return c}));var r=n(269),a=n(506);function o(e=new Map,t){const n=Array.from(t);return new Map([...e,...n.map((e=>[e,{events:[],status:"loading"}]))])}function i(e=new Map,t){const n=Array.from(t);return new Map([...e,...n.map((e=>[e,{events:[],status:"error"}]))])}function s(e=new Map,t){const n=new Map([...e]);return n.delete(t),n}function l({storedNodeInfo:e=new Map,receivedEvents:t,requestedNodes:n,numberOfRequestedEvents:o}){const i=new Map([...e]),s=t.length>=o,l=function(e){const t=new Map;for(const n of e){const e=Object(r.c)(n),o=Object(a.a)(n);if(e){const r=t.get(e);r?(r.events.push(n),r.terminated=r.terminated||o):t.set(e,{events:[n],terminated:o})}}return t}(t);for(const e of n.values())l.has(e)||(s?i.delete(e):i.set(e,{events:[],status:"running"}));for(const[e,t]of l.entries())i.set(e,{events:[...t.events],status:t.terminated?"terminated":"running"});return i}function c(e){return!e||"loading"===e.status||"error"===e.status||e.events.length<=0?void 0:e.events[0]}},435:function(e,t,n){e.exports=n(24)(151)},437:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"f",(function(){return o})),n.d(t,"e",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return l}));const r=.5,a=2,o=2,i=50,s=300,l=1e3},438:function(e,t,n){"use strict";function r(e,t){return Array.isArray(e)?e.includes(t):e===t}function a(e){if(null!==e){if(!Array.isArray(e))return e;for(const t of e)if(null!==t)return t}}function o(e){if(Array.isArray(e)){const t=[];for(const n of e)null!=n&&t.push(n);return t}return null!=e?[e]:[]}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return o}))},505:function(e,t,n){"use strict";function r(e){return`resolver-${e}`}n.d(t,"a",(function(){return r}))},506:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return u}));var r=n(438),a=n(269),o=n(284);function i(e){return"processTerminated"===function(e){if(a.j(e)){const{endgame:{event_type_full:t,event_subtype_full:n}}=e;if("process_event"===t)return"creation_event"===n||"fork_event"===n||"exec_event"===n?"processCreated":"already_running"===n?"processRan":"termination_event"===n?"processTerminated":"unknownProcessEvent";if("alert_event"===t)return"processCausedAlert"}else{const t=new Set(a.h(e)),n=new Set(a.d(e)),r=new Set(a.f(e));if(n.has("process"))return t.has("start")||t.has("change")||t.has("creation")?"processCreated":t.has("info")?"processRan":t.has("end")?"processTerminated":"unknownProcessEvent";if(r.has("alert"))return"processCausedAlert"}return"unknownEvent"}(e)}function s(e){const t=o.a(e),n=void 0===t?0:new Date(t).getTime();return isNaN(n)?null:n}function l(e){var t;return Object(r.a)(a.j(e)?e.endgame.pid:null===(t=e.process)||void 0===t?void 0:t.pid)}function c(e){var t;return Object(r.a)(a.j(e)?e.endgame.process_path:null===(t=e.process)||void 0===t?void 0:t.executable)}function u(e,t){const n=s(e),r=s(t);return n===r?String(o.b(e)).localeCompare(String(o.b(t))):null===n||null===r?(null===n?1:0)-(null===r?1:0):n-r}},613:function(e,t,n){"use strict";n.d(t,"e",(function(){return p})),n.d(t,"a",(function(){return m})),n.d(t,"c",(function(){return f})),n.d(t,"g",(function(){return v})),n.d(t,"b",(function(){return g})),n.d(t,"i",(function(){return h})),n.d(t,"d",(function(){return b})),n.d(t,"f",(function(){return y})),n.d(t,"h",(function(){return E}));var r=n(12),a=n(894),o=n(641),i=n(310);function s([e,t,n,r,a,o,i,s,l],[c,u,d,p,m,f,v,g,h]){return[e*c+t*p+n*v,e*u+t*m+n*g,e*d+t*f+n*h,r*c+a*p+o*v,r*u+a*m+o*g,r*d+a*f+o*h,i*c+s*p+l*v,i*u+s*m+l*g,i*d+s*f+l*h]}function l([e,t,n,r,a,o,i,s,l],[c,u,d,p,m,f,v,g,h]){return[e+c,t+u,n+d,r+p,a+m,o+f,i+v,s+g,l+h]}function c([e,t]){return[e,0,0,0,t,0,0,0,0]}var u=n(437);function d(e,t){return e.startTime+e.duration>=t}const p=Object(r.createSelector)((e=>e.scalingFactor),(e=>e.animation),((e,t)=>{const n=(s=e,Object(o.b)(u.b,u.a,Math.pow(s,u.f)));var s;if(void 0!==t){const e=i.d(t.targetTranslation,t.initialTranslation),s=e*n/t.duration,l=.4,c=.4,p=s<l?s:s**c-(l**c-l),m=Object(o.a)(p*t.duration/e,u.b,u.a);return Object(r.defaultMemoize)((e=>{if(!1===d(t,e))return[n,n];{const r=C(t,e),i=a.easing.inOutCubic(1-Math.abs(2*r-1)),s=Object(o.b)(n,m,i);return[s,s]}}))}return Object(r.defaultMemoize)((()=>[n,n]))})),m=Object(r.createSelector)((e=>e.rasterSize),p,((e,t)=>Object(r.defaultMemoize)((n=>{const[r,a]=t(n),o=e[0],i=e[1],s=o/2/r,l=i/2/a;return{renderWidth:o,renderHeight:i,clippingPlaneRight:s,clippingPlaneTop:l,clippingPlaneLeft:-s,clippingPlaneBottom:-l}})))),f=Object(r.createSelector)((e=>e.animation),(e=>t=>void 0!==e&&d(e,t))),v=Object(r.createSelector)((e=>e.panning),(e=>e.translationNotCountingCurrentPanning),p,(e=>e.animation),((e,t,n,o)=>Object(r.defaultMemoize)((r=>{const[s,l]=n(r);if(void 0!==o&&d(o,r))return i.g(o.initialTranslation,o.targetTranslation,a.easing.inOutCubic(C(o,r)));if(e){const n=i.j(e.currentOffset,e.origin),r=i.e(n,[-s,l]);return i.a(t,r)}return t})))),g=Object(r.createSelector)(m,v,((e,t)=>Object(r.defaultMemoize)((n=>{const{renderWidth:r,renderHeight:a,clippingPlaneRight:o,clippingPlaneTop:i,clippingPlaneLeft:u,clippingPlaneBottom:d}=e(n),p=[0===r?0:2/r,0,-1,0,0===a?0:2/a,-1,0,0,0],m=c([1,-1]),[f,v]=t(n);return l([0,0,f,0,0,v,0,0,0],s(function(e,t,n,r){let a,o,i,s;return t-r==0?(a=0,o=0):(a=(t-r)/2,o=(t+r)/(t-r)),e-n==0?(i=0,s=0):(i=(e-n)/2,s=(e+n)/(e-n)),[a,0,o,0,i,s,0,0,0]}(i,o,d,u),s(m,p)))})))),h=Object(r.createSelector)(m,g,((e,t)=>Object(r.defaultMemoize)((n=>{const{renderWidth:r,renderHeight:a}=e(n),o=t(n),s=[0,a],l=[r,0];return{minimum:i.c(s,o),maximum:i.c(l,o)}})))),b=Object(r.createSelector)(m,v,((e,t)=>Object(r.defaultMemoize)((n=>{const{renderWidth:r,renderHeight:a,clippingPlaneRight:o,clippingPlaneTop:u,clippingPlaneLeft:d,clippingPlaneBottom:p}=e(n),m=function([e,t]){return[1,0,e,0,1,t,0,0,0]}(i.i(t(n),-1)),f=function(e,t,n,r){let a,o,i,s;return t-r==0?(a=0,o=0):(a=2/(t-r),o=-(t+r)/(t-r)),e-n==0?(i=0,s=0):(i=e-n==0?0:2/(e-n),s=e-n==0?0:-(e+n)/(e-n)),[a,0,o,0,i,s,0,0,0]}(u,o,p,d),v=c([1,-1]);return s(c([r/2,a/2]),l([0,0,1,0,0,1,0,0,0],s(v,s(f,m))))})))),y=e=>e.scalingFactor,E=e=>void 0!==e.panning;function C(e,t){return Object(o.a)((t-e.startTime)/e.duration,0,1)}},614:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(175);function a(e){return function(t){for(const n of e)if(n(t))return!0;return!1}}function o(e){return function(t){if("object"!=typeof t||null===t)return!1;const n=t;for(const t of Object.keys(e))if(!(0,e[t])(n[t]))return!1;return!0}}function i(e){return function(t){return e===t}}const s=a([o({panelView:i("nodes")}),o({panelView:i("nodeDetail"),panelParameters:o({nodeID:function(e){return"string"==typeof e}})}),o({panelView:i("nodeEvents"),panelParameters:o({nodeID:function(e){return"string"==typeof e}})}),o({panelView:i("nodeEventsInCategory"),panelParameters:o({nodeID:function(e){return"string"==typeof e},eventCategory:function(e){return"string"==typeof e}})}),o({panelView:i("eventDetail"),panelParameters:o({nodeID:function(e){return"string"==typeof e},eventCategory:function(e){return"string"==typeof e},eventID:a([function(e){return"string"==typeof e},i(void 0),function(e){return"number"==typeof e}]),eventTimestamp:function(e){return"string"==typeof e},winlogRecordID:function(e){return"string"==typeof e}})})]);var l=n(505);function c({locationSearch:e,resolverComponentInstanceID:t}){if(void 0===e||void 0===t)return{panelView:"nodes"};const n=new URLSearchParams(e).get(Object(l.a)(t));if(null===n)return{panelView:"nodes"};const a=Object(r.decode)(n);return s(a)?a:{panelView:"nodes"}}},641:function(e,t,n){"use strict";function r(e,t,n){return Math.max(Math.min(e,n),t)}function a(e,t,n){return e*(1-n)+t*n}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}))},642:function(e,t,n){"use strict";function r(e,t){return"nodeEventsInCategory"===t.panelView&&t.panelParameters.nodeID===e.nodeID&&t.panelParameters.eventCategory===e.eventCategory}function a(e,t){return e.nodeID===t.nodeID&&e.eventCategory===t.eventCategory?{nodeID:e.nodeID,eventCategory:e.eventCategory,events:[...e.events,...t.events],cursor:t.cursor,lastCursorRequested:null}:void 0}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}))},643:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return s}));var r=n(284);function a(e){return void 0!==(null==e?void 0:e.ancestry)?200:20}function o(e){return void 0!==(null==e?void 0:e.ancestry)?0:10}function i(){return 500}function s(e){const t=new Map;for(const n of e.nodes)if(n.stats){const e=r.b(n);t.set(e,n.stats)}return t}},644:function(e,t,n){"use strict";function r(e,t){return!!t&&(e===t||e.databaseDocumentID===t.databaseDocumentID&&e.filters.from===t.filters.from&&e.filters.to===t.filters.to&&function(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;const n=new Set(e);for(let e=0;e<t.length;e++)if(!n.has(t[e]))return!1;return!0}(e.indices,t.indices))}n.d(t,"a",(function(){return r}))},645:function(e,t,n){(function(t){var n;n=function(){"use strict";var e=function(){if("undefined"!=typeof Map)return Map;function e(e,t){var n=-1;return e.some((function(e,r){return e[0]===t&&(n=r,!0)})),n}return function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(t){var n=e(this.__entries__,t),r=this.__entries__[n];return r&&r[1]},t.prototype.set=function(t,n){var r=e(this.__entries__,t);~r?this.__entries__[r][1]=n:this.__entries__.push([t,n])},t.prototype.delete=function(t){var n=this.__entries__,r=e(n,t);~r&&n.splice(r,1)},t.prototype.has=function(t){return!!~e(this.__entries__,t)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(e,t){void 0===t&&(t=null);for(var n=0,r=this.__entries__;n<r.length;n++){var a=r[n];e.call(t,a[1],a[0])}},t}()}(),n="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,r=void 0!==t&&t.Math===Math?t:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),a="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(r):function(e){return setTimeout((function(){return e(Date.now())}),1e3/60)},o=["top","right","bottom","left","width","height","size","weight"],i="undefined"!=typeof MutationObserver,s=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(e,t){var n=!1,r=!1,o=0;function i(){n&&(n=!1,e()),r&&l()}function s(){a(i)}function l(){var e=Date.now();if(n){if(e-o<2)return;r=!0}else n=!0,r=!1,setTimeout(s,20);o=e}return l}(this.refresh.bind(this))}return e.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},e.prototype.removeObserver=function(e){var t=this.observers_,n=t.indexOf(e);~n&&t.splice(n,1),!t.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},e.prototype.updateObservers_=function(){var e=this.observers_.filter((function(e){return e.gatherActive(),e.hasActive()}));return e.forEach((function(e){return e.broadcastActive()})),e.length>0},e.prototype.connect_=function(){n&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),i?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){n&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(e){var t=e.propertyName,n=void 0===t?"":t;o.some((function(e){return!!~n.indexOf(e)}))&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),l=function(e,t){for(var n=0,r=Object.keys(t);n<r.length;n++){var a=r[n];Object.defineProperty(e,a,{value:t[a],enumerable:!1,writable:!1,configurable:!0})}return e},c=function(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView||r},u=v(0,0,0,0);function d(e){return parseFloat(e)||0}function p(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.reduce((function(t,n){return t+d(e["border-"+n+"-width"])}),0)}var m="undefined"!=typeof SVGGraphicsElement?function(e){return e instanceof c(e).SVGGraphicsElement}:function(e){return e instanceof c(e).SVGElement&&"function"==typeof e.getBBox};function f(e){return n?m(e)?function(e){var t=e.getBBox();return v(0,0,t.width,t.height)}(e):function(e){var t=e.clientWidth,n=e.clientHeight;if(!t&&!n)return u;var r=c(e).getComputedStyle(e),a=function(e){for(var t={},n=0,r=["top","right","bottom","left"];n<r.length;n++){var a=r[n],o=e["padding-"+a];t[a]=d(o)}return t}(r),o=a.left+a.right,i=a.top+a.bottom,s=d(r.width),l=d(r.height);if("border-box"===r.boxSizing&&(Math.round(s+o)!==t&&(s-=p(r,"left","right")+o),Math.round(l+i)!==n&&(l-=p(r,"top","bottom")+i)),!function(e){return e===c(e).document.documentElement}(e)){var m=Math.round(s+o)-t,f=Math.round(l+i)-n;1!==Math.abs(m)&&(s-=m),1!==Math.abs(f)&&(l-=f)}return v(a.left,a.top,s,l)}(e):u}function v(e,t,n,r){return{x:e,y:t,width:n,height:r}}var g=function(){function e(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=v(0,0,0,0),this.target=e}return e.prototype.isActive=function(){var e=f(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},e}(),h=function(e,t){var n,r,a,o,i,s,c,u=(r=(n=t).x,a=n.y,o=n.width,i=n.height,s="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,c=Object.create(s.prototype),l(c,{x:r,y:a,width:o,height:i,top:a,right:r+o,bottom:i+a,left:r}),c);l(this,{target:e,contentRect:u})},b=function(){function t(t,n,r){if(this.activeObservations_=[],this.observations_=new e,"function"!=typeof t)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=t,this.controller_=n,this.callbackCtx_=r}return t.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof c(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new g(e)),this.controller_.addObserver(this),this.controller_.refresh())}},t.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof c(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},t.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},t.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach((function(t){t.isActive()&&e.activeObservations_.push(t)}))},t.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map((function(e){return new h(e.target,e.broadcastRect())}));this.callback_.call(e,t,e),this.clearActive()}},t.prototype.clearActive=function(){this.activeObservations_.splice(0)},t.prototype.hasActive=function(){return this.activeObservations_.length>0},t}(),y="undefined"!=typeof WeakMap?new WeakMap:new e,E=function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=s.getInstance(),r=new b(t,n,this);y.set(this,r)};return["observe","unobserve","disconnect"].forEach((function(e){E.prototype[e]=function(){var t;return(t=y.get(this))[e].apply(t,arguments)}})),void 0!==r.ResizeObserver?r.ResizeObserver:E},e.exports=n()}).call(this,n(435))},795:function(e,t,n){"use strict";n.d(t,"a",(function(){return Et}));var r=n(5),a=n.n(r),o=n(42),i=n(16),s=n(165),l=n(58),c=n(227),u=n(505),d=n(23),p=n.n(d),m=n(310);function f(e,t,n){return t+(e>1?n*(e-1):0)}var v=n(170);function g(){return Object(r.useMemo)((()=>({copyableFieldBackground:v.euiThemeVars.euiColorLightShade,descriptionText:v.euiThemeVars.euiTextColor,full:v.euiThemeVars.euiColorFullShade,graphControls:v.euiThemeVars.euiColorDarkestShade,graphControlsBackground:v.euiThemeVars.euiColorEmptyShade,graphControlsBorderColor:v.euiThemeVars.euiColorLightShade,processBackingFill:`${v.euiThemeVars.euiColorPrimary}${v.darkMode?"1F":"0F"}`,resolverBackground:v.euiThemeVars.euiColorEmptyShade,resolverEdge:v.darkMode?v.euiThemeVars.euiColorLightShade:v.euiThemeVars.euiColorLightestShade,resolverBreadcrumbBackground:v.euiThemeVars.euiColorLightestShade,resolverEdgeText:v.darkMode?v.euiThemeVars.euiColorFullShade:v.euiThemeVars.euiColorDarkShade,triggerBackingFill:`${v.euiThemeVars.euiColorDanger}${v.darkMode?"1F":"0F"}`,pillStroke:v.euiThemeVars.euiColorLightShade,linkColor:v.euiThemeVars.euiLinkColor})),[])}const h=p.a.div.withConfig({displayName:"StyledEdgeLine",componentId:"sc-6iesrv-0"})(["position:absolute;height:",";background-color:",";z-index:10;"],(e=>`${f(e.magFactorX,12,8.5)}px`),(e=>e.resolverEdgeColor)),b=p.a.div.withConfig({displayName:"StyledElapsedTime",componentId:"sc-6iesrv-1"})(["background-color:",";color:",";font-size:",";font-weight:bold;max-width:75%;overflow:hidden;position:absolute;text-overflow:ellipsis;top:50%;white-space:nowrap;left:",";padding:6px 8px;border-radius:999px;transform:translate(-50%,-50%);user-select:none;"],(e=>e.backgroundColor),(e=>e.textColor),(e=>`${e.scaledTypeSize}px`),(e=>`${e.leftPct}%`)),y=a.a.memo((({className:e,edgeLineMetadata:t,startPosition:n,endPosition:r,projectionMatrix:o})=>{const i=Object(m.c)(n,o),l=Object(m.c)(r,o),[c]=o,u=g(),d=null==t?void 0:t.elapsedTime,p=Object(m.d)(i,l),v=f(c,10,7.5),y={left:`${i[0]}px`,top:`${i[1]}px`,width:`${p}px`,transformOrigin:"top left",transform:`translateY(-50%) rotateZ(${Object(m.b)(i,l)}rad)`};let E=50;return c<1&&(E+=1/c*(10*(1-c))),a.a.createElement(h,{className:e,style:y,resolverEdgeColor:u.resolverEdge,magFactorX:c,"data-test-subj":"resolver:graph:edgeline"},d&&a.a.createElement(b,{backgroundColor:u.resolverEdge,leftPct:E,scaledTypeSize:v,textColor:u.resolverEdgeText},a.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.elapsedTime",defaultMessage:"{duration} {durationType}",values:{duration:d.duration,durationType:d.durationType}})))}));var E=n(4),C=n(645);const x={timestamp:()=>Date.now(),requestAnimationFrame:(...e)=>window.requestAnimationFrame(...e),cancelAnimationFrame:(...e)=>window.cancelAnimationFrame(...e),ResizeObserver:n.n(C).a,writeTextToClipboard:e=>navigator.clipboard.writeText(e),getBoundingClientRect:e=>e.getBoundingClientRect()},w=Object(r.createContext)(x),S=p()(i.EuiDescriptionList).withConfig({displayName:"StyledDescriptionList",componentId:"sc-254p1f-0"})(["&.euiDescriptionList.euiDescriptionList--column dt.euiDescriptionList__title.desc-title{max-width:10em;}"]),O=p()("h4").withConfig({displayName:"StyledTitle",componentId:"sc-254p1f-1"})(["overflow-wrap:break-word;"]),j=(p()("header").withConfig({displayName:"BetaHeader",componentId:"sc-254p1f-2"})(["margin-bottom:1em;"]),p()(i.EuiBreadcrumbs).withConfig({displayName:"ThemedBreadcrumbs",componentId:"sc-254p1f-3"})(["&.euiBreadcrumbs{background-color:",";color:",";padding:1em;border-radius:5px;}& .euiBreadcrumbSeparator{background:",";}"],(e=>e.background),(e=>e.text),(e=>e.text))),M=p.a.div.withConfig({displayName:"StyledButtonTextContainer",componentId:"sc-254p1f-4"})(["align-items:center;display:flex;flex-direction:row;"]),k=p.a.div.withConfig({displayName:"StyledAnalyzedEvent",componentId:"sc-254p1f-5"})(["color:",";font-size:10.5px;font-weight:700;"],(e=>e.color)),D=p.a.div.withConfig({displayName:"StyledLabelTitle",componentId:"sc-254p1f-6"})([""]),I=p.a.div.withConfig({displayName:"StyledLabelContainer",componentId:"sc-254p1f-7"})(["display:inline-block;flex:3;min-width:0;",",","{overflow:hidden;text-align:left;text-overflow:ellipsis;white-space:nowrap;}"],k,D),T=p()(i.EuiCode).withConfig({displayName:"BoldCode",componentId:"sc-254p1f-8"})(["&.euiCodeBlock code.euiCodeBlock__code{font-weight:900;}"]),P=p()("time").withConfig({displayName:"StyledTime",componentId:"sc-254p1f-9"})(["display:inline-block;text-align:start;"]);function L(){const e=Object(o.useSelector)(c.D);return Object(r.useMemo)((()=>{const t=`${e}-symbols`;return{processNodeLabel:`${t}-nodeSymbol`,runningProcessCube:`${t}-runningCube`,runningTriggerCube:`${t}-runningTriggerCube`,terminatedProcessCube:`${t}-terminatedCube`,terminatedTriggerCube:`${t}-terminatedTriggerCube`,processCubeActiveBacking:`${t}-activeBacking`,loadingCube:`${t}-loadingCube`,errorCube:`${t}-errorCube`}}),[e])}function N(e,t){const n=L(),a=g(),o=Object(r.useMemo)((()=>({runningProcessCube:{backingFill:a.processBackingFill,cubeSymbol:`#${n.runningProcessCube}`,descriptionFill:a.descriptionText,descriptionText:E.i18n.translate("xpack.securitySolution.endpoint.resolver.runningProcess",{defaultMessage:"Running Process"}),isLabelFilled:!0,labelButtonFill:"primary",strokeColor:v.euiThemeVars.euiColorPrimary},loadingCube:{backingFill:a.processBackingFill,cubeSymbol:`#${n.loadingCube}`,descriptionFill:a.descriptionText,descriptionText:E.i18n.translate("xpack.securitySolution.endpoint.resolver.loadingProcess",{defaultMessage:"Loading Process"}),isLabelFilled:!1,labelButtonFill:"primary",strokeColor:v.euiThemeVars.euiColorPrimary},errorCube:{backingFill:a.processBackingFill,cubeSymbol:`#${n.errorCube}`,descriptionFill:a.descriptionText,descriptionText:E.i18n.translate("xpack.securitySolution.endpoint.resolver.errorProcess",{defaultMessage:"Error Process"}),isLabelFilled:!1,labelButtonFill:"primary",strokeColor:v.euiThemeVars.euiColorPrimary},runningTriggerCube:{backingFill:a.triggerBackingFill,cubeSymbol:`#${n.runningTriggerCube}`,descriptionFill:a.descriptionText,descriptionText:E.i18n.translate("xpack.securitySolution.endpoint.resolver.runningTrigger",{defaultMessage:"Running Trigger"}),isLabelFilled:!0,labelButtonFill:"danger",strokeColor:v.euiThemeVars.euiColorDanger},terminatedProcessCube:{backingFill:a.processBackingFill,cubeSymbol:`#${n.terminatedProcessCube}`,descriptionFill:a.descriptionText,descriptionText:E.i18n.translate("xpack.securitySolution.endpoint.resolver.terminatedProcess",{defaultMessage:"Terminated Process"}),isLabelFilled:!1,labelButtonFill:"primary",strokeColor:v.euiThemeVars.euiColorPrimary},terminatedTriggerCube:{backingFill:a.triggerBackingFill,cubeSymbol:`#${n.terminatedTriggerCube}`,descriptionFill:a.descriptionText,descriptionText:E.i18n.translate("xpack.securitySolution.endpoint.resolver.terminatedTrigger",{defaultMessage:"Terminated Trigger"}),isLabelFilled:!1,labelButtonFill:"danger",strokeColor:v.euiThemeVars.euiColorDanger}})),[n,a]);return"terminated"===e?t?o.terminatedTriggerCube:o[_.processTerminated]:"running"===e?t?o[_.processCausedAlert]:o[_.processRan]:"error"===e?o[_.processError]:o[_.processLoading]}const _={processCreated:"runningProcessCube",processRan:"runningProcessCube",processTerminated:"terminatedProcessCube",unknownProcessEvent:"runningProcessCube",processCausedAlert:"runningTriggerCube",processLoading:"loadingCube",processError:"errorCube",unknownEvent:"runningProcessCube"},R=Object(r.memo)((function({className:e,size:t="2.15em",state:n,isOrigin:r,"data-test-subj":o}){const{cubeSymbol:i,strokeColor:s}=N(n,!1),{processCubeActiveBacking:l}=L();return a.a.createElement(F,{className:e,width:t,height:t,viewBox:"0 0 34 34","data-test-subj":o,isOrigin:r},a.a.createElement("desc",null,E.i18n.translate("xpack.securitySolution.resolver.node_icon",{defaultMessage:"{state, select, running {Running Process} terminated {Terminated Process} loading {Loading Process} error {Error Process}}",values:{state:n}})),r&&a.a.createElement("use",{xlinkHref:`#${l}`,fill:"transparent",x:0,y:-1,stroke:s,strokeDashoffset:0,width:"100%",height:"100%"}),a.a.createElement("use",{role:"presentation",xlinkHref:i,x:5.25,y:4.25,width:"70%",height:"70%",opacity:"1",className:"cube"}))})),F=p.a.svg.withConfig({displayName:"StyledSVG",componentId:"sc-14ztjy8-0"})(["margin-right:",";"],(e=>e.isOrigin?"0.15em":0)),B=a.a.memo((function({children:e}){return a.a.createElement(a.a.Fragment,null,a.a.Children.map(e,(e=>{if("string"==typeof e){const t=e.split(/\b/);return t.length<2?t[0]:[t[0],...t.splice(1).reduce((function(e,t){return[...e,t,a.a.createElement("wbr",null)]}),[])]}return e})))})),A=p()(i.EuiRange).withConfig({displayName:"StyledEuiRange",componentId:"sc-1wdm067-0"})(["& .euiRangeTrack:after{left:-65px;transform:rotate(90deg);}"]),z=p.a.div.withConfig({displayName:"StyledGraphControlsColumn",componentId:"sc-1wdm067-1"})(["display:flex;flex-direction:column;&:not(last-of-type){margin-right:5px;}"]),V=p()(i.EuiDescriptionListTitle).withConfig({displayName:"StyledEuiDescriptionListTitle",componentId:"sc-1wdm067-2"})(["text-transform:uppercase;max-width:25%;"]),q=p()(i.EuiDescriptionListDescription).withConfig({displayName:"StyledEuiDescriptionListDescription",componentId:"sc-1wdm067-3"})(["min-width:75%;width:75%;"]),$=p()(i.EuiButtonIcon).withConfig({displayName:"StyledEuiButtonIcon",componentId:"sc-1wdm067-4"})(["background-color:",";color:",";border-color:",";border-width:1px;border-style:solid;border-radius:4px;width:40px;height:40px;&:not(last-of-type){margin-bottom:7px;}"],(e=>e.$backgroundColor),(e=>e.$iconColor),(e=>e.$borderColor)),Y=p.a.div.withConfig({displayName:"StyledGraphControls",componentId:"sc-1wdm067-5"})(["display:flex;flex-direction:row;position:absolute;top:5px;right:5px;background-color:transparent;color:",";.zoom-controls{display:flex;flex-direction:column;align-items:center;padding:5px 0px;.zoom-slider{width:20px;height:150px;margin:5px 0px 2px 0px;input[type='range']{width:150px;height:20px;transform-origin:75px 75px;transform:rotate(-90deg);}}}.panning-controls{text-align:center;}"],(e=>e.$iconColor)),X=a.a.memo((({className:e})=>{const t=Object(o.useDispatch)(),n=Object(o.useSelector)(c.G),{timestamp:s}=Object(r.useContext)(w),[l,u]=Object(r.useState)(null),d=g(),p=Object(r.useCallback)((e=>{u(e===l?null:e)}),[u,l]),m=Object(r.useCallback)((()=>u(null)),[]),f=Object(r.useCallback)((e=>{const n=parseFloat(e.target.value);!1===isNaN(n)&&t({type:"userSetZoomLevel",payload:n})}),[t]),v=Object(r.useCallback)((()=>{t({type:"userSetPositionOfCamera",payload:[0,0]})}),[t]),h=Object(r.useCallback)((()=>{t({type:"userClickedZoomOut"})}),[t]),b=Object(r.useCallback)((()=>{t({type:"userClickedZoomIn"})}),[t]),[y,C,x,S]=Object(r.useMemo)((()=>[[0,1],[1,0],[0,-1],[-1,0]].map((e=>()=>{const n={type:"userNudgedCamera",payload:{direction:e,time:s()}};t(n)}))),[t,s]);return a.a.createElement(Y,{className:e,$iconColor:d.graphControls,"data-test-subj":"resolver:graph-controls"},a.a.createElement(z,null,a.a.createElement(Z,{closePopover:m,isOpen:"schemaInfo"===l,setActivePopover:p}),a.a.createElement(W,{closePopover:m,isOpen:"nodeLegend"===l,setActivePopover:p})),a.a.createElement(z,null,a.a.createElement(i.EuiPanel,{className:"panning-controls",paddingSize:"none",hasBorder:!0},a.a.createElement("div",{className:"panning-controls-top"},a.a.createElement("button",{className:"north-button","data-test-subj":"resolver:graph-controls:north-button",title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.north",{defaultMessage:"North"}),onClick:y},a.a.createElement(i.EuiIcon,{type:"arrowUp"}))),a.a.createElement("div",{className:"panning-controls-middle"},a.a.createElement("button",{className:"west-button","data-test-subj":"resolver:graph-controls:west-button",title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.west",{defaultMessage:"West"}),onClick:S},a.a.createElement(i.EuiIcon,{type:"arrowLeft"})),a.a.createElement("button",{className:"center-button","data-test-subj":"resolver:graph-controls:center-button",title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.center",{defaultMessage:"Center"}),onClick:v},a.a.createElement(i.EuiIcon,{type:"bullseye"})),a.a.createElement("button",{className:"east-button","data-test-subj":"resolver:graph-controls:east-button",title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.east",{defaultMessage:"East"}),onClick:C},a.a.createElement(i.EuiIcon,{type:"arrowRight"}))),a.a.createElement("div",{className:"panning-controls-bottom"},a.a.createElement("button",{className:"south-button","data-test-subj":"resolver:graph-controls:south-button",title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.south",{defaultMessage:"South"}),onClick:x},a.a.createElement(i.EuiIcon,{type:"arrowDown"})))),a.a.createElement(i.EuiPanel,{className:"zoom-controls",paddingSize:"none",hasBorder:!0},a.a.createElement("button",{title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.zoomIn",{defaultMessage:"Zoom In"}),"data-test-subj":"resolver:graph-controls:zoom-in",onClick:b},a.a.createElement(i.EuiIcon,{type:"plusInCircle"})),a.a.createElement(A,{className:"zoom-slider","data-test-subj":"resolver:graph-controls:zoom-slider",min:0,max:1,step:.01,value:n,onChange:f}),a.a.createElement("button",{title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.zoomOut",{defaultMessage:"Zoom Out"}),"data-test-subj":"resolver:graph-controls:zoom-out",onClick:h},a.a.createElement(i.EuiIcon,{type:"minusInCircle"})))))})),Z=({closePopover:e,setActivePopover:t,isOpen:n})=>{var s,l,u;const d=g(),p=Object(o.useSelector)(c.F),m=Object(r.useCallback)((()=>t("schemaInfo")),[t]),f=E.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaInfoButtonTitle",{defaultMessage:"Schema Information"}),v=E.i18n.translate("xpack.securitySolution.resolver.graphControls.unknownSchemaValue",{defaultMessage:"Unknown"});return a.a.createElement(i.EuiPopover,{button:a.a.createElement($,{"data-test-subj":"resolver:graph-controls:schema-info-button",size:"m",title:f,"aria-label":f,onClick:m,iconType:"iInCircle",$backgroundColor:d.graphControlsBackground,$iconColor:d.graphControls,$borderColor:d.graphControlsBorderColor}),isOpen:n,closePopover:e,anchorPosition:"leftCenter"},a.a.createElement(i.EuiPopoverTitle,{style:{textTransform:"uppercase"}},E.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaInfoTitle",{defaultMessage:"process tree"}),a.a.createElement(i.EuiIconTip,{content:E.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaInfoTooltip",{defaultMessage:"These are the fields used to create the process tree"}),position:"right"})),a.a.createElement("div",{style:{maxWidth:"268px"}},a.a.createElement(S,{"data-test-subj":"resolver:graph-controls:schema-info",type:"column",align:"left",compressed:!0},a.a.createElement(a.a.Fragment,null,a.a.createElement(V,{"data-test-subj":"resolver:graph-controls:schema-info:title",style:{width:"30%"}},E.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaSource",{defaultMessage:"source"})),a.a.createElement(q,{"data-test-subj":"resolver:graph-controls:schema-info:description",style:{width:"70%"}},a.a.createElement(B,null,null!==(s=null==p?void 0:p.dataSource)&&void 0!==s?s:v)),a.a.createElement(V,{"data-test-subj":"resolver:graph-controls:schema-info:title",style:{width:"30%"}},E.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaID",{defaultMessage:"id"})),a.a.createElement(q,{"data-test-subj":"resolver:graph-controls:schema-info:description",style:{width:"70%"}},a.a.createElement(B,null,null!==(l=null==p?void 0:p.schema.id)&&void 0!==l?l:v)),a.a.createElement(V,{"data-test-subj":"resolver:graph-controls:schema-info:title",style:{width:"30%"}},E.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaEdge",{defaultMessage:"edge"})),a.a.createElement(q,{"data-test-subj":"resolver:graph-controls:schema-info:description",style:{width:"70%"}},a.a.createElement(B,null,null!==(u=null==p?void 0:p.schema.parent)&&void 0!==u?u:v))))))},W=({closePopover:e,setActivePopover:t,isOpen:n})=>{const o=Object(r.useCallback)((()=>t("nodeLegend")),[t]),s=g(),l=E.i18n.translate("xpack.securitySolution.resolver.graphControls.nodeLegendButtonTitle",{defaultMessage:"Node Legend"});return a.a.createElement(i.EuiPopover,{button:a.a.createElement($,{"data-test-subj":"resolver:graph-controls:node-legend-button",size:"m",title:l,"aria-label":l,onClick:o,iconType:"node",$backgroundColor:s.graphControlsBackground,$iconColor:s.graphControls,$borderColor:s.graphControlsBorderColor}),isOpen:n,closePopover:e,anchorPosition:"leftCenter"},a.a.createElement(i.EuiPopoverTitle,{style:{textTransform:"uppercase"}},E.i18n.translate("xpack.securitySolution.resolver.graphControls.nodeLegend",{defaultMessage:"legend"})),a.a.createElement("div",{style:{maxWidth:"212px"}},a.a.createElement(S,{"data-test-subj":"resolver:graph-controls:node-legend",type:"column",align:"left",compressed:!0},a.a.createElement(a.a.Fragment,null,a.a.createElement(V,{"data-test-subj":"resolver:graph-controls:node-legend:title",style:{width:"20% "}},a.a.createElement(R,{size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"running"})),a.a.createElement(q,{"data-test-subj":"resolver:graph-controls:node-legend:description",style:{width:"80%",lineHeight:"2.2em"}},a.a.createElement(B,null,E.i18n.translate("xpack.securitySolution.resolver.graphControls.runningProcessCube",{defaultMessage:"Running Process"}))),a.a.createElement(V,{"data-test-subj":"resolver:graph-controls:node-legend:title",style:{width:"20% "}},a.a.createElement(R,{size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"terminated"})),a.a.createElement(q,{"data-test-subj":"resolver:graph-controls:node-legend:description",style:{width:"80%",lineHeight:"2.2em"}},a.a.createElement(B,null,E.i18n.translate("xpack.securitySolution.resolver.graphControls.terminatedProcessCube",{defaultMessage:"Terminated Process"}))),a.a.createElement(V,{"data-test-subj":"resolver:graph-controls:node-legend:title",style:{width:"20% "}},a.a.createElement(R,{size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"loading"})),a.a.createElement(q,{"data-test-subj":"resolver:graph-controls:node-legend:description",style:{width:"80%",lineHeight:"2.2em"}},a.a.createElement(B,null,E.i18n.translate("xpack.securitySolution.resolver.graphControls.currentlyLoadingCube",{defaultMessage:"Loading Process"}))),a.a.createElement(V,{"data-test-subj":"resolver:graph-controls:node-legend:title",style:{width:"20% "}},a.a.createElement(R,{size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"error"})),a.a.createElement(q,{"data-test-subj":"resolver:graph-controls:node-legend:description",style:{width:"80%",lineHeight:"2.2em"}},a.a.createElement(B,null,E.i18n.translate("xpack.securitySolution.resolver.graphControls.errorCube",{defaultMessage:"Error Process"})))))))};function H(e){return function(e,t){const n=Object(l.useHistory)(),a=Object(r.useCallback)((t=>{t.defaultPrevented||0===t.button&&(t.currentTarget instanceof HTMLAnchorElement&&""!==t.currentTarget.target&&"_self"!==t.currentTarget.target||t.metaKey||t.altKey||t.ctrlKey||t.shiftKey||(t.preventDefault(),n.push(e)))}),[n,t,e]);return{href:n.createHref(e),onClick:a}}({search:Object(o.useSelector)((t=>c.C(t)(e)))})}var G=n(328);const U=a.a.memo((({className:e,nodeID:t,nodeStats:n})=>{const o=Object(r.useMemo)((()=>void 0===n?[]:Object.entries(n.byCategory).map((([e,t])=>({prefix:a.a.createElement(G.a,{count:t||0}),category:e})))),[n]);return void 0===o?null:a.a.createElement("ul",{className:`${e} options`,"aria-describedby":t},o.sort(((e,t)=>e.category.localeCompare(t.category))).map((e=>a.a.createElement(K,{pill:e,nodeID:t,key:e.category}))))})),K=({pill:e,nodeID:t})=>{const n=H({panelView:"nodeEventsInCategory",panelParameters:{nodeID:t,eventCategory:e.category}}),{pillStroke:i,resolverBackground:s}=g(),l=Object(r.useMemo)((()=>({border:`1.5px solid ${i}`,backgroundColor:s})),[i,s]),c=Object(o.useDispatch)(),{timestamp:u}=Object(r.useContext)(w),d=Object(r.useCallback)((e=>{n.onClick(e),c({type:"userSelectedResolverNode",payload:{nodeID:t,time:u()}})}),[u,n,c,t]);return a.a.createElement("li",{className:"item","data-test-subj":"resolver:map:node-submenu-item",style:l,key:e.category},a.a.createElement("button",{type:"button",className:"kbn-resetFocusState",onClick:d},e.prefix," ",e.category))},Q=p()(U).withConfig({displayName:"NodeSubMenu",componentId:"sc-1p5k68h-0"})(["margin:2px 0 0 0;padding:0;border:none;display:flex;flex-flow:column;z-index:auto;&.options{font-size:0.8rem;display:flex;flex-flow:row wrap;background:transparent;position:absolute;top:4.5em;overflow-x:visible;width:24ch;z-index:auto;}&.options::after{position:absolute;content:'';width:100%;height:100%;left:0;top:0;z-index:20;backdrop-filter:blur(2px);pointer-events:none;}&.options .item{margin:0.25ch 0.35ch 0.35ch 0;padding:0.35em 0.5em;height:fit-content;width:fit-content;border-radius:2px;line-height:0.8;z-index:40;}&.options .item button{appearance:none;height:fit-content;width:fit-content;line-height:0.8;outline-style:none;border-color:transparent;box-shadow:none;}&.options .item button:focus{outline-style:none;border-color:transparent;box-shadow:none;text-decoration:underline;}&.options .item button:active{transform:scale(0.95);}"]),J=p.a.div.withConfig({displayName:"StyledMapContainer",componentId:"sc-1p5k68h-1"})(["&,.resolver-graph{display:flex;flex-grow:1;}.loading-container{display:flex;align-items:center;justify-content:center;flex-grow:1;}min-height:652px;position:relative;overflow:hidden;contain:strict;background-color:",";"],(e=>e.backgroundColor)),ee=p()(i.EuiPanel).withConfig({displayName:"StyledPanel",componentId:"sc-1p5k68h-2"})(["position:absolute;left:0;top:0;bottom:0;overflow:auto;width:25em;max-width:50%;border-radius:0;border-top:none;"]),te=p.a.div.withConfig({displayName:"GraphContainer",componentId:"sc-1p5k68h-3"})(["display:flex;flex-grow:1;contain:layout;position:relative;z-index:0;"]),ne=p()(i.EuiCallOut).withConfig({displayName:"LimitWarningsEuiCallOut",componentId:"sc-1p5k68h-4"})(["flex-flow:row wrap;display:block;align-items:baseline;margin-top:1em;& .euiCallOutHeader{display:inline;margin-right:0.25em;}& .euiText{display:inline;}& .euiText p{display:inline;}"]),re=o.useDispatch;var ae=n(284),oe=n(269),ie=n(394);const se=p.a.div.withConfig({displayName:"StyledActionsContainer",componentId:"sc-14u1iy3-0"})(["background-color:transparent;color:",";display:flex;flex-flow:column;font-size:",";left:20.9%;line-height:140%;padding:0.25rem 0 0 0.1rem;position:absolute;top:",";width:auto;pointer-events:all;"],(e=>e.color),(e=>`${e.fontSize}px`),(e=>`${e.topPct}%`)),le=p.a.div.withConfig({displayName:"StyledDescriptionText",componentId:"sc-14u1iy3-1"})(["background-color:",";color:",";display:",";font-size:0.8rem;font-weight:bold;letter-spacing:-0.01px;line-height:1;margin:0;padding:4px 0 0 2px;text-align:left;text-transform:uppercase;width:fit-content;z-index:45;"],(e=>e.backgroundColor),(e=>e.color),(e=>e.isDisplaying?"block":"none")),ce=p.a.span.withConfig({displayName:"StyledEuiButtonContent",componentId:"sc-14u1iy3-2"})(["padding:",";"],(e=>e.isShowingIcon?"0px":"0 12px")),ue=p.a.g.withConfig({displayName:"StyledOuterGroup",componentId:"sc-14u1iy3-3"})(["fill:none;pointer-events:visiblePainted;",""],(e=>e.isNodeLoading&&"\n    & .cube {\n    animation-name: pulse;\n    /**\n     * his is a multiple of .6 so it can match up with the EUI button's loading spinner\n     * which is (0.6s). Using .6 here makes it a bit too fast.\n     */\n    animation-duration: 1.8s;\n    animation-delay: 0;\n    animation-direction: normal;\n    animation-iteration-count: infinite;\n    animation-timing-function: linear;\n  }\n\n  /**\n   * Animation loading state of the cube.\n   */\n  @keyframes pulse {\n    0% {\n      opacity: 1;\n    }\n    50% {\n      opacity: 0.35;\n    }\n    100% {\n      opacity: 1;\n    }\n  }\n  ")),de=a.a.memo((({className:e,position:t,node:n,nodeID:l,projectionMatrix:u,timeAtRender:d})=>{const p=`resolver:${Object(o.useSelector)(c.D)}`,v=L(),{timestamp:h}=Object(r.useContext)(w),[b,y]=Object(m.c)(t,u),[C]=u,x=Object(o.useSelector)(c.a),S=Object(o.useSelector)(c.H),O=Object(o.useSelector)(c.x),j=Object(o.useSelector)((e=>c.w(e)(l))),M=Object(r.useCallback)((e=>Object(i.htmlIdGenerator)(p)(`${e}:node`)),[p]),k=Object(o.useSelector)((e=>c.c(e)(l))),D=Object(o.useSelector)((e=>c.b(e)(d)(l))),I=C>.8,T=C>=.55,P=(I?3.5:T?1:21)*C+5,_=360*(I?-.147413:-.147413-.08*(C-.5))*C,R=120*(I?-.53684:.2*-C*(1-C)/C-.53684)*C,F=Object(r.useMemo)((()=>({left:`${b+_}px`,top:`${y+R}px`,width:360*C+"px",height:120*C+"px"})),[b,C,_,R,y]),B=f(C,18.75,12.5),A=a.a.createRef(),z=g(),V=Object(o.useSelector)((e=>c.u(e)(l))),q="loading"===V,{backingFill:$,cubeSymbol:Y,descriptionText:X,isLabelFilled:Z,labelButtonFill:W,strokeColor:G}=N(V,!1),U=Object(i.htmlIdGenerator)("resolver")(`${l}:label`),K=l===x,J=l===S,ee=l===O,te=re(),ne=H({panelView:"nodeDetail",panelParameters:{nodeID:l}}),de=Object(r.useCallback)((()=>{te({type:"userFocusedOnResolverNode",payload:{nodeID:l,time:h()}})}),[te,l,h]),pe=Object(r.useCallback)((e=>{var t;null!==(t=A.current)&&void 0!==t&&t.beginElement&&A.current.beginElement(),"error"===V?te({type:"userReloadedResolverNode",payload:l}):(te({type:"userSelectedResolverNode",payload:{nodeID:l,time:h()}}),ne.onClick(e))}),[A,te,l,ne,V,h]),me=Object(o.useSelector)((e=>c.I(e)(n))),fe=ae.c(n),ve=Object(o.useSelector)((e=>ie.a(c.t(e)(String(n.id))))),ge=Object(r.useMemo)((()=>void 0!==ve?oe.n(ve):fe),[ve,fe]);return a.a.createElement("div",{"data-test-subj":"resolver:node","data-test-resolver-node-id":l,className:`${e} kbn-resetFocusState`,role:"treeitem","aria-level":null===k?void 0:k,"aria-flowto":null===D?void 0:M(D),"aria-labelledby":U,"aria-haspopup":"true","aria-current":K?"true":void 0,"aria-selected":J?"true":void 0,style:F,id:M(l),tabIndex:-1},a.a.createElement("svg",{viewBox:"-15 -15 90 30",preserveAspectRatio:"xMidYMid meet",onClick:e=>{de(),pe(e)},role:"img","aria-labelledby":U,fill:"none",style:{display:"block",width:"100%",height:"100%",position:"absolute",top:"0",left:"0",outline:"transparent",border:"none",pointerEvents:"none",zIndex:30}},a.a.createElement(ue,{isNodeLoading:q},a.a.createElement("use",{xlinkHref:`#${v.processCubeActiveBacking}`,fill:$,x:-15.35,y:-15.35,stroke:G,width:22.5,height:22.5,className:"backing"}),ee&&a.a.createElement("use",{xlinkHref:`#${v.processCubeActiveBacking}`,fill:"transparent",x:-15.35,y:-15.35,stroke:G,strokeOpacity:.35,strokeDashoffset:0,width:22.5,height:22.5,className:"origin"}),a.a.createElement("use",{role:"presentation",xlinkHref:Y,x:-11.5,y:-11.5,width:15,height:15,opacity:"1",className:"cube"},a.a.createElement("animateTransform",{attributeType:"XML",attributeName:"transform",type:"scale",values:"1 1; 1 .83; 1 .8; 1 .83; 1 1",dur:"0.2s",repeatCount:"1",className:"squish",ref:A})))),a.a.createElement(se,{color:z.full,fontSize:B,topPct:P},a.a.createElement(le,{backgroundColor:z.resolverBackground,color:z.descriptionText,isDisplaying:T,"data-test-subj":"resolver:node:description"},a.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.processDescription",defaultMessage:"{isEventBeingAnalyzed, select, true {Analyzed Event · {descriptionText}} false {{descriptionText}}}",values:{isEventBeingAnalyzed:ee,descriptionText:X}})),a.a.createElement("div",{className:"euiButton euiButton--small",id:U,onClick:pe,onFocus:de,tabIndex:-1,style:{backgroundColor:z.resolverBackground,alignSelf:"flex-start",padding:0,zIndex:45}},a.a.createElement(i.EuiButton,{iconSide:q?"right":"left",isLoading:q,color:W,fill:Z,iconType:"error"===V?"refresh":"",size:"s",style:{maxHeight:`${Math.min(26+3*C,32)}px`,maxWidth:(I?400:210*C)+"px"},tabIndex:-1,title:ge,"data-test-subj":"resolver:node:primary-button","data-test-resolver-node-id":l},a.a.createElement(ce,{isShowingIcon:"loading"===V||"error"===V},a.a.createElement("span",{className:"euiButton__text","data-test-subj":"euiButton__text"},E.i18n.translate("xpack.securitySolution.resolver.node_button_name",{defaultMessage:"{nodeState, select, error {Reload {nodeName}} other {{nodeName}}}",values:{nodeState:V,nodeName:ge}}))))),a.a.createElement(i.EuiFlexGroup,{justifyContent:"flexStart",gutterSize:"xs",style:{alignSelf:"flex-start",background:z.resolverBackground,display:I?"flex":"none",margin:"2px 0 0 0",padding:0}},a.a.createElement(i.EuiFlexItem,{grow:!1,className:"related-dropdown"},null!==me&&me>0&&a.a.createElement(Q,{buttonFill:z.resolverBackground,nodeStats:j,nodeID:l})))))})),pe=p()(de).withConfig({displayName:"ProcessEventDot",componentId:"sc-14u1iy3-4"})(["position:absolute;text-align:left;font-size:10px;user-select:none;box-sizing:border-box;border-radius:10%;white-space:nowrap;will-change:left,top,width,height;min-width:280px;min-height:90px;overflow-y:visible;pointer-events:none;z-index:auto;& .backing{stroke-dasharray:500;stroke-dashoffset:500;fill-opacity:0;}&:hover:not([aria-current]) .backing{transition-property:fill-opacity;transition-duration:0.25s;fill-opacity:1;}&[aria-current] .backing{transition-property:stroke-dashoffset;transition-duration:1s;stroke-dashoffset:0;}& .euiButton{width:fit-content;}& .euiSelectableList-bordered{border-top-right-radius:0px;border-top-left-radius:0px;}& .euiSelectableListItem{background-color:black;}& .euiSelectableListItem path{fill:white;}& .euiSelectableListItem__text{color:white;}"]);var me=n(55);function fe(){const e=Object(o.useSelector)(c.D);return Object(r.useMemo)((()=>{const t=`${e}-symbols`;return{runningProcessCube:`${t}-psRunningProcessCube`,runningTriggerCube:`${t}-psRunningTriggerCube`,terminatedProcessCube:`${t}-psTerminatedProcessCube`,terminatedTriggerCube:`${t}-psTerminatedTriggerCube`,loadingCube:`${t}-psLoadingCube`,errorCube:`${t}-psErrorCube`}}),[e])}const ve=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.loadingProcess",{defaultMessage:"Loading Process"}),ge=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.errorProcess",{defaultMessage:"Error Process"}),he=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.runningProcess",{defaultMessage:"Running Process"}),be=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.triggerProcess",{defaultMessage:"Trigger Process"}),ye=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.terminatedProcess",{defaultMessage:"Terminated Process"}),Ee=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.terminatedTriggerProcess",{defaultMessage:"Terminated Trigger Process"}),Ce=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.hoveredProcessBackground",{defaultMessage:"Hovered Process Background"}),xe=Object(r.memo)((({isDarkMode:e})=>{const t=fe();return a.a.createElement(a.a.Fragment,null,a.a.createElement("linearGradient",{id:t.errorCube,x1:"10.2372",y1:"9.49068",x2:"46.5307",y2:"45.7844",gradientUnits:"userSpaceOnUse"},a.a.createElement("stop",{stopColor:"#6D6D6D"}),a.a.createElement("stop",{offset:"1",stopColor:"#B9B9B9"})),a.a.createElement("linearGradient",{id:t.runningProcessCube,x1:"-381.23556",y1:"264.73802",x2:"-380.48514",y2:"263.8816",gradientTransform:"matrix(70.05179, 0, 0, -79.94774, 26724.01618, 21181.09848)",gradientUnits:"userSpaceOnUse"},a.a.createElement("stop",{offset:"0.00087",stopColor:"#006bb4"}),a.a.createElement("stop",{offset:"1",stopColor:"#54b399"})),a.a.createElement("linearGradient",{id:t.runningTriggerCube,x1:"-381.18643",y1:"264.68195",x2:"-380.48514",y2:"263.8816",gradientTransform:"matrix(70.05179, 0, 0, -79.94774, 26724.01618, 21181.09848)",gradientUnits:"userSpaceOnUse"},a.a.createElement("stop",{offset:"0",stopColor:"#dd0a73"}),a.a.createElement("stop",{offset:"1",stopColor:"#f66"})),e?a.a.createElement(a.a.Fragment,null,a.a.createElement("linearGradient",{id:t.terminatedProcessCube,x1:"-381.23752",y1:"264.24026",x2:"-380.48514",y2:"263.3816",gradientTransform:"matrix(70.05178, 0, 0, -79.94771, 26724.01313, 21140.72096)",gradientUnits:"userSpaceOnUse"},a.a.createElement("stop",{offset:"0",stopColor:"#4c82c3"}),a.a.createElement("stop",{offset:"1",stopColor:"#8bd1c7"})),a.a.createElement("linearGradient",{id:t.terminatedTriggerCube,x1:"-381.18658",y1:"264.68187",x2:"-380.48546",y2:"263.8817",gradientTransform:"matrix(70.05179, 0, 0, -79.94774, 26724.01618, 21181.09848)",gradientUnits:"userSpaceOnUse"},a.a.createElement("stop",{offset:"0",stopColor:"#dd0a73"}),a.a.createElement("stop",{offset:"1",stopColor:"#f66"}))):a.a.createElement(a.a.Fragment,null,a.a.createElement("linearGradient",{id:t.terminatedProcessCube,x1:"10.5206",y1:"9.49068",x2:"46.8141",y2:"45.7844",gradientUnits:"userSpaceOnUse"},a.a.createElement("stop",{offset:"0",stopColor:"#2F6EB6"}),a.a.createElement("stop",{offset:"1",stopColor:"#00B4AC"})),a.a.createElement("linearGradient",{id:t.terminatedTriggerCube,x1:"15.4848",y1:"12.0468",x2:"43.1049",y2:"47.2331",gradientUnits:"userSpaceOnUse"},a.a.createElement("stop",{stopColor:"#DD0A73"}),a.a.createElement("stop",{offset:"1",stopColor:"#FF6666"}))))})),we=Object(r.memo)((({isDarkMode:e})=>{const t=L(),n=fe();return a.a.createElement(a.a.Fragment,null,a.a.createElement("symbol",{id:t.processNodeLabel,viewBox:"0 0 144 25",preserveAspectRatio:"xMidYMid meet"},a.a.createElement("rect",{x:"1",y:"1",width:"142",height:"23",fill:"inherit",strokeWidth:"0",paintOrder:"normal"})),a.a.createElement("symbol",{id:t.loadingCube,viewBox:"0 0 88 100"},a.a.createElement("title",null,ve),a.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",fill:e?"#1d1e24":"white",stroke:"#98A2B3",strokeWidth:"2"})),a.a.createElement("symbol",{id:t.errorCube,viewBox:"0 0 88 100"},a.a.createElement("title",null,ge),a.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",transform:"translate(0.00001 0)",fill:`url(#${n.errorCube})`}),a.a.createElement("g",{opacity:"0.6"},a.a.createElement("path",{opacity:.6,d:"M87.52113,24.73352a3.7956,3.7956,0,0,0-1.43182-1.47166L45.91012.17918a3.8365,3.8365,0,0,0-3.82049,0L1.91029,23.26186A3.86312,3.86312,0,0,0-.00009,26.55445V72.7199a3.79834,3.79834,0,0,0,1.91041,3.29249L42.08963,99.09514a3.83689,3.83689,0,0,0,3.82049,0L86.08931,76.01239a3.79852,3.79852,0,0,0,1.91056-3.29249V26.55445A3.77643,3.77643,0,0,0,87.52113,24.73352Z",transform:"translate(0.00013 0.39551)",fill:`url(#${n.errorCube})`}),a.a.createElement("path",{opacity:.4,d:"M.57134,24.52282a3.79906,3.79906,0,0,1,1.34824-1.32625L42.09878.11387a3.83708,3.83708,0,0,1,3.8208,0L86.09877,23.19655a3.79771,3.79771,0,0,1,1.43182,1.47165L44.00909,49.57182Z",transform:"translate(0.00013 0.39551)",fill:"#fff",style:{isolation:"isolate"}}),a.a.createElement("path",{opacity:.4,d:"M43.99972,49.63713V99.60449a3.83406,3.83406,0,0,1-1.91025-.50932L1.91029,76.01239A3.79835,3.79835,0,0,1-.00013,72.7199V26.55445A3.77431,3.77431,0,0,1,.562,24.5882Z",transform:"translate(0.00013 0.39551)",fill:"#353944",style:{isolation:"isolate"}}))),a.a.createElement("symbol",{id:t.runningProcessCube,viewBox:"0 0 88 100"},a.a.createElement("title",null,he),a.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",transform:"translate(0.00001 0)",fill:`url(#${n.runningProcessCube})`}),a.a.createElement("g",{opacity:"0.5"},a.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff"}),a.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),a.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),a.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),a.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),a.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}})),a.a.createElement("path",{d:"M.57144,24.91834a3.79909,3.79909,0,0,1,1.34825-1.32625L42.0989.50939a3.837,3.837,0,0,1,3.82081,0L86.09892,23.59206a3.79782,3.79782,0,0,1,1.4318,1.47169L44.00915,49.96733Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.3",style:{isolation:"isolate"}}),a.a.createElement("path",{d:"M43.99984,50.03265V100a3.83392,3.83392,0,0,1-1.91024-.50933L1.91039,76.40791A3.79835,3.79835,0,0,1,0,73.11541V26.95a3.77423,3.77423,0,0,1,.56216-1.96625Z",transform:"translate(0.00001 0)",fill:"#353944",opacity:"0.2",style:{isolation:"isolate"}})),a.a.createElement("symbol",{id:t.runningTriggerCube,viewBox:"0 0 88 100"},a.a.createElement("title",null,be),a.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",transform:"translate(0.00001 0)",fill:`url(#${n.runningTriggerCube})`}),a.a.createElement("g",{opacity:"0.5"},a.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff"}),a.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),a.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),a.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),a.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),a.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}})),a.a.createElement("path",{d:"M.57144,24.91834a3.79909,3.79909,0,0,1,1.34825-1.32625L42.0989.50939a3.837,3.837,0,0,1,3.82081,0L86.09892,23.59206a3.79782,3.79782,0,0,1,1.4318,1.47169L44.00915,49.96733Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.3",style:{isolation:"isolate"}}),a.a.createElement("path",{d:"M43.99984,50.03265V100a3.83392,3.83392,0,0,1-1.91024-.50933L1.91039,76.40791A3.79835,3.79835,0,0,1,0,73.11541V26.95a3.77423,3.77423,0,0,1,.56216-1.96625Z",transform:"translate(0.00001 0)",fill:"#353944",opacity:"0.2",style:{isolation:"isolate"}})),a.a.createElement("symbol",{viewBox:"0 0 88 100",id:t.terminatedProcessCube},a.a.createElement("title",null,ye),a.a.createElement("path",{d:"M87.52113,24.73352a3.7956,3.7956,0,0,0-1.43182-1.47166L45.91012.17918a3.8365,3.8365,0,0,0-3.82049,0L1.91029,23.26186A3.86312,3.86312,0,0,0-.00009,26.55445V72.7199a3.79834,3.79834,0,0,0,1.91041,3.29249L42.08963,99.09514a3.83689,3.83689,0,0,0,3.82049,0L86.08931,76.01239a3.79852,3.79852,0,0,0,1.91056-3.29249V26.55445A3.77643,3.77643,0,0,0,87.52113,24.73352Z",transform:"translate(0.00013 0.39551)",fill:e?"#010101":"#fff"}),a.a.createElement("g",{opacity:"0.7"},a.a.createElement("path",{opacity:e?1:.6,d:"M87.52113,24.73352a3.7956,3.7956,0,0,0-1.43182-1.47166L45.91012.17918a3.8365,3.8365,0,0,0-3.82049,0L1.91029,23.26186A3.86312,3.86312,0,0,0-.00009,26.55445V72.7199a3.79834,3.79834,0,0,0,1.91041,3.29249L42.08963,99.09514a3.83689,3.83689,0,0,0,3.82049,0L86.08931,76.01239a3.79852,3.79852,0,0,0,1.91056-3.29249V26.55445A3.77643,3.77643,0,0,0,87.52113,24.73352Z",transform:"translate(0.00013 0.39551)",fill:`url(#${n.terminatedProcessCube})`}),a.a.createElement("path",{opacity:e?.3:.4,d:"M.57134,24.52282a3.79906,3.79906,0,0,1,1.34824-1.32625L42.09878.11387a3.83708,3.83708,0,0,1,3.8208,0L86.09877,23.19655a3.79771,3.79771,0,0,1,1.43182,1.47165L44.00909,49.57182Z",transform:"translate(0.00013 0.39551)",fill:"#fff",style:{isolation:"isolate"}}),a.a.createElement("path",{opacity:e?.2:.4,d:"M43.99972,49.63713V99.60449a3.83406,3.83406,0,0,1-1.91025-.50932L1.91029,76.01239A3.79835,3.79835,0,0,1-.00013,72.7199V26.55445A3.77431,3.77431,0,0,1,.562,24.5882Z",transform:"translate(0.00013 0.39551)",fill:"#353944",style:{isolation:"isolate"}}))),a.a.createElement("symbol",{id:t.terminatedTriggerCube,viewBox:"0 0 88 100"},a.a.createElement("title",null,Ee),e&&a.a.createElement("path",{opacity:"1",d:"M87.52143,25.06372a3.795,3.795,0,0,0-1.43129-1.47166L45.92578.50939a3.83384,3.83384,0,0,0-3.81907,0L1.94219,23.59206A3.8634,3.8634,0,0,0,.03252,26.88465V73.05008a3.7986,3.7986,0,0,0,1.90971,3.2925L42.10671,99.42532a3.83423,3.83423,0,0,0,3.81907,0L86.09014,76.34258A3.79881,3.79881,0,0,0,88,73.05008V26.88465A3.77748,3.77748,0,0,0,87.52143,25.06372Z",transform:"translate(0)",fill:"#010101"}),a.a.createElement("g",{opacity:"0.6"},!e&&a.a.createElement("path",{opacity:"0.6",d:"M87.52143,25.06372a3.795,3.795,0,0,0-1.43129-1.47166L45.92578.50939a3.83384,3.83384,0,0,0-3.81907,0L1.94219,23.59206A3.8634,3.8634,0,0,0,.03252,26.88465V73.05008a3.7986,3.7986,0,0,0,1.90971,3.2925L42.10671,99.42532a3.83423,3.83423,0,0,0,3.81907,0L86.09014,76.34258A3.79881,3.79881,0,0,0,88,73.05008V26.88465A3.77748,3.77748,0,0,0,87.52143,25.06372Z",transform:"translate(0)",fill:"#010101"}),a.a.createElement("path",{opacity:e?1:.604,d:"M87.48893,25.129a3.79468,3.79468,0,0,0-1.4313-1.47165L45.89329.57472a3.83381,3.83381,0,0,0-3.81908,0L1.90969,23.65739A3.86331,3.86331,0,0,0,0,26.95V73.11541a3.79859,3.79859,0,0,0,1.90969,3.2925L42.07421,99.49067a3.83425,3.83425,0,0,0,3.81908,0L86.05763,76.40791a3.79876,3.79876,0,0,0,1.90985-3.2925V26.95A3.77746,3.77746,0,0,0,87.48893,25.129Z",transform:"translate(0)",fill:`url(#${n.terminatedTriggerCube})`}),a.a.createElement("path",{d:"M.57124,24.91834A3.79833,3.79833,0,0,1,1.919,23.59209L42.08335.50939a3.83441,3.83441,0,0,1,3.8194,0L86.06711,23.59206a3.7972,3.7972,0,0,1,1.43128,1.47169L43.99289,49.96733Z",transform:"translate(0)",fill:"#fff",opacity:"0.3",style:{isolation:"isolate"}}),a.a.createElement("path",{d:"M43.98359,50.03265V100a3.83139,3.83139,0,0,1-1.90953-.50933L1.90969,76.40791A3.79859,3.79859,0,0,1,0,73.11541V26.95a3.77523,3.77523,0,0,1,.56195-1.96625Z",transform:"translate(0)",fill:"#353944",opacity:"0.2",style:{isolation:"isolate"}}))),a.a.createElement("symbol",{viewBox:"0 -3 88 106",id:t.processCubeActiveBacking},a.a.createElement("title",null,Ce),a.a.createElement("path",{d:"m87.521 25.064a3.795 3.795 0 0 0-1.4313-1.4717l-40.164-23.083a3.8338 3.8338 0 0 0-3.8191 0l-40.165 23.083a3.8634 3.8634 0 0 0-1.9097 3.2926v46.165a3.7986 3.7986 0 0 0 1.9097 3.2925l40.164 23.083a3.8342 3.8342 0 0 0 3.8191 0l40.164-23.083a3.7988 3.7988 0 0 0 1.9099-3.2925v-46.165a3.7775 3.7775 0 0 0-0.47857-1.8209z",strokeWidth:"2"})))})),Se=Object(r.memo)((()=>{const e=Object(me.useUiSetting)("theme:darkMode");return a.a.createElement(Oe,null,a.a.createElement("defs",null,a.a.createElement(xe,{isDarkMode:e}),a.a.createElement(we,{isDarkMode:e})))})),Oe=p()("svg").withConfig({displayName:"HiddenSVG",componentId:"sc-1sziupc-0"})(["position:absolute;left:100%;top:100%;width:0;height:0;"]);var je=n(50),Me=n.n(je);const ke=Object(r.memo)((function({breadcrumbs:e}){const t=Object(r.useMemo)((()=>{const t=e.slice(-1).map((e=>(e["data-test-subj"]="resolver:breadcrumbs:last",e.truncate=!0,e)));return[...e.slice(0,-1),...t]}),[e]),{resolverBreadcrumbBackground:n,resolverEdgeText:o}=g();return a.a.createElement(a.a.Fragment,null,a.a.createElement(j,{background:n,text:o,breadcrumbs:t,truncate:!1}))})),De=p.a.span.withConfig({displayName:"StyledSpinnerFlexItem",componentId:"sc-1wo8ziw-0"})(["margin-right:5px;"]);function Ie(){const e=E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.relatedDetail.wait",{defaultMessage:"Loading Events..."}),t=E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.events",{defaultMessage:"Events"}),n=H({panelView:"nodes"}),o=Object(r.useMemo)((()=>[{text:t,...n}]),[n,t]);return a.a.createElement(a.a.Fragment,null,a.a.createElement(ke,{breadcrumbs:o}),a.a.createElement(i.EuiSpacer,{size:"l"}),a.a.createElement(i.EuiFlexGroup,{alignItems:"center",direction:"row",gutterSize:"none"},a.a.createElement(De,null,a.a.createElement(i.EuiLoadingSpinner,{size:"m"})),a.a.createElement(i.EuiFlexItem,{grow:!1},a.a.createElement(i.EuiText,{"data-test-subj":"resolver:panel:loading"},e))))}function Te({event:e}){var t,n,r,o,i,l,c,u,d,p,m,f,v;return Object(oe.j)(e)?a.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.legacyEventLabel",defaultMessage:"{ processName }",values:{processName:Object(oe.n)(e)}}):null!==(t=e.network)&&void 0!==t&&t.forwarded_ip?a.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.networkEventLabel",defaultMessage:"{ networkDirection } { forwardedIP }",values:{forwardedIP:String(null===(c=e.network)||void 0===c?void 0:c.forwarded_ip),networkDirection:String(null===(u=e.network)||void 0===u?void 0:u.direction)}}):null!==(n=e.file)&&void 0!==n&&n.path?a.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.fileEventLabel",defaultMessage:"{ filePath }",values:{filePath:String(null===(d=e.file)||void 0===d?void 0:d.path)}}):null!==(r=e.registry)&&void 0!==r&&r.path?a.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.registryPathLabel",defaultMessage:"{ registryPath }",values:{registryPath:String(null===(p=e.registry)||void 0===p?void 0:p.path)}}):null!==(o=e.registry)&&void 0!==o&&o.key?a.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.registryKeyLabel",defaultMessage:"{ registryKey }",values:{registryKey:String(null===(m=e.registry)||void 0===m?void 0:m.key)}}):null!==(i=e.dns)&&void 0!==i&&null!==(l=i.question)&&void 0!==l&&l.name?a.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.dnsQuestionNameLabel",defaultMessage:"{ dnsQuestionName }",values:{dnsQuestionName:String(null===(f=e.dns)||void 0===f||null===(v=f.question)||void 0===v?void 0:v.name)}}):a.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.entityIDLabel",defaultMessage:"{ entityID }",values:{entityID:Object(oe.c)(e)}})}var Pe=n(64),Le=n.n(Pe);const Ne=E.i18n.translate("xpack.securitySolution.enpdoint.resolver.panelutils.invaliddate",{defaultMessage:"Invalid Date"}),_e=new Intl.DateTimeFormat(E.i18n.getLocale(),{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"});function Re(e){const t=Object(me.useUiSetting)("dateFormat"),n=Object(me.useUiSetting)("dateFormat:tz"),r="Browser"===n?Le.a.tz.guess():n;if(!e)return;const a=new Date(e);return a&&Number.isFinite(a.getTime())?t?Le.a.tz(a,r).format(t):_e.format(a):Ne}const Fe=Object(r.memo)((function({nodeID:e,eventCategory:t}){const n=Object(o.useSelector)((t=>c.f(t)(e))),r=Object(o.useSelector)(c.o),l=Object(o.useSelector)(c.g);return a.a.createElement(a.a.Fragment,null,r?a.a.createElement(ee,{hasBorder:!0},a.a.createElement(Ie,null)):a.a.createElement(ee,{hasBorder:!0,"data-test-subj":"resolver:panel:events-in-category"},l||!n?a.a.createElement(i.EuiCallOut,{title:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.nodeEventsByType.errorPrimary",{defaultMessage:"Unable to load events."}),color:"danger",iconType:"alert","data-test-subj":"resolver:nodeEventsInCategory:error"},a.a.createElement("p",null,a.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.nodeEventsByType.errorSecondary",defaultMessage:"An error occurred when fetching the events."}))):a.a.createElement(a.a.Fragment,null,a.a.createElement(ze,{nodeName:n.name,eventCategory:t,nodeID:e}),a.a.createElement(i.EuiSpacer,{size:"l"}),a.a.createElement(Ae,{eventCategory:t,nodeID:e}))))})),Be=Object(r.memo)((function({event:e,nodeID:t,eventCategory:n}){const r=oe.g(e),o=oe.e(e),l=oe.r(e),c=Re(r)||E.i18n.translate("xpack.securitySolution.enpdoint.resolver.panelutils.noTimestampRetrieved",{defaultMessage:"No timestamp retrieved"}),u=H({panelView:"eventDetail",panelParameters:{nodeID:t,eventCategory:n,eventID:o,eventTimestamp:String(r),winlogRecordID:String(l)}});return a.a.createElement(a.a.Fragment,null,a.a.createElement(i.EuiText,null,a.a.createElement(T,null,a.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.categoryAndType",values:{category:oe.d(e).join(", "),eventType:oe.h(e).join(", ")},defaultMessage:"{category} {eventType}"})),a.a.createElement(P,{dateTime:c},a.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.atTime",values:{date:c},defaultMessage:"@ {date}"}))),a.a.createElement(i.EuiSpacer,{size:"xs"}),a.a.createElement(i.EuiButtonEmpty,Me()({"data-test-subj":"resolver:panel:node-events-in-category:event-link"},u),a.a.createElement(Te,{event:e})))})),Ae=Object(r.memo)((function({eventCategory:e,nodeID:t}){const n=Object(o.useSelector)(c.v),l=re(),u=Object(r.useCallback)((()=>{l({type:"userRequestedAdditionalRelatedEvents"})}),[l]),d=Object(o.useSelector)(c.n),p=Object(o.useSelector)(c.q);return a.a.createElement(a.a.Fragment,null,n.map(((o,s)=>a.a.createElement(r.Fragment,{key:s},a.a.createElement(Be,{nodeID:t,eventCategory:e,event:o}),s===n.length-1?null:a.a.createElement(i.EuiHorizontalRule,{margin:"m"})))),p&&a.a.createElement(i.EuiFlexItem,{grow:!1},a.a.createElement(i.EuiButton,{color:"primary",size:"s",fill:!0,onClick:u,isLoading:d,"data-test-subj":"resolver:nodeEventsInCategory:loadMore"},a.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.nodeEventsByType.loadMore",defaultMessage:"Load More Data"}))))})),ze=Object(r.memo)((function({nodeName:e,eventCategory:t,nodeID:n}){const r=Object(o.useSelector)((e=>c.K(e)(n))),i=Object(o.useSelector)((e=>c.A(e)(n,t))),l=H({panelView:"nodes"}),u=H({panelView:"nodeDetail",panelParameters:{nodeID:n}}),d=H({panelView:"nodeEvents",panelParameters:{nodeID:n}});return a.a.createElement(ke,{breadcrumbs:[{text:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.processEventListByType.events",{defaultMessage:"Events"}),"data-test-subj":"resolver:node-events-in-category:breadcrumbs:node-list-link",...l},{text:e,...u},{text:a.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventList.numberOfEvents",values:{totalCount:r},defaultMessage:"{totalCount} Events"}),...d},{text:a.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventList.countByCategory",values:{count:i,category:t},defaultMessage:"{count} {category}"})}]})}));function Ve({nodeID:e}){const t=Object(o.useSelector)((t=>ie.a(c.t(t)(e)))),n=Object(o.useSelector)((t=>c.w(t)(e)));return void 0===t||void 0===n?a.a.createElement(ee,{hasBorder:!0},a.a.createElement(Ie,null)):a.a.createElement(ee,{hasBorder:!0},a.a.createElement($e,{nodeName:oe.n(t),nodeID:e,totalEventCount:n.total}),a.a.createElement(i.EuiSpacer,{size:"l"}),a.a.createElement(qe,{nodeID:e,relatedStats:n}))}const qe=Object(r.memo)((function({nodeID:e,relatedStats:t}){const n=Object(r.useMemo)((()=>Object.entries(t.byCategory).map((([e,t])=>({eventType:e,count:t})))),[t.byCategory]),o=Object(r.useMemo)((()=>[{field:"count",name:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.count",{defaultMessage:"Count"}),"data-test-subj":"resolver:panel:node-events:event-type-count",width:"20%",sortable:!0},{field:"eventType",name:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.eventType",{defaultMessage:"Event Type"}),width:"80%",sortable:!0,render:t=>a.a.createElement(Ye,{nodeID:e,eventType:t},t)}]),[e]);return a.a.createElement(i.EuiInMemoryTable,{items:n,columns:o,sorting:!0})})),$e=Object(r.memo)((function({nodeID:e,nodeName:t,totalEventCount:n}){return a.a.createElement(ke,{breadcrumbs:[{text:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.processEventCounts.events",{defaultMessage:"Events"}),...H({panelView:"nodes"})},{text:t,...H({panelView:"nodeDetail",panelParameters:{nodeID:e}})},{text:a.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedCounts.numberOfEventsInCrumb",values:{totalCount:n},defaultMessage:"{totalCount} Events"}),...H({panelView:"nodeEvents",panelParameters:{nodeID:e}})}]})})),Ye=Object(r.memo)((({nodeID:e,eventType:t,children:n})=>{const r=H({panelView:"nodeEventsInCategory",panelParameters:{nodeID:e,eventCategory:t}});return a.a.createElement(i.EuiButtonEmpty,Me()({"data-test-subj":"resolver:panel:node-events:event-type-link"},r),n)})),Xe=p.a.div.withConfig({displayName:"StyledCopyableField",componentId:"sc-3rurpv-0"})(["border-radius:3px;padding:4px;transition:background 0.2s ease;",":hover &{background-color:",";&:hover{background-color:",";color:#fff;}}"],ee,(e=>e.backgroundColor),(e=>e.activeBackgroundColor)),Ze=Object(r.memo)((({textToCopy:e,content:t})=>{var n;const{linkColor:o,copyableFieldBackground:s}=g(),[l,c]=Object(r.useState)(!1),u=null===(n=Object(me.useKibana)().services.notifications)||void 0===n?void 0:n.toasts,d=()=>c(!0),p=()=>c(!1),m=Object(r.useMemo)((()=>a.a.createElement(Xe,{backgroundColor:s,"data-test-subj":"resolver:panel:copyable-field-hover-area",activeBackgroundColor:o,onMouseEnter:d},t)),[t,s,o]),{writeTextToClipboard:f}=Object(r.useContext)(w),v=Object(r.useCallback)((async()=>{try{await f(e)}catch(e){u&&u.addError(e,{title:E.i18n.translate("xpack.securitySolution.resolver.panel.copyFailureTitle",{defaultMessage:"Copy Failure"})})}}),[e,u,f]);return a.a.createElement("div",{onMouseLeave:p},a.a.createElement(i.EuiPopover,{anchorPosition:"downCenter",button:m,closePopover:p,hasArrow:!1,isOpen:l,panelPaddingSize:"s"},a.a.createElement(i.EuiToolTip,{content:E.i18n.translate("xpack.securitySolution.resolver.panel.copyToClipboard",{defaultMessage:"Copy to Clipboard"})},a.a.createElement(i.EuiButtonIcon,{"aria-label":E.i18n.translate("xpack.securitySolution.resolver.panel.copyToClipboard",{defaultMessage:"Copy to Clipboard"}),color:"text","data-test-subj":"resolver:panel:clipboard",iconType:"copyClipboard",onClick:v}))))}));var We=n(506);const He=Object(r.memo)((function({translatedErrorMessage:e}){const t=H({panelView:"nodes"}),n=Object(r.useMemo)((()=>[{text:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.error.events",{defaultMessage:"Events"}),...t},{text:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.error.error",{defaultMessage:"Error"})}]),[t]);return a.a.createElement(a.a.Fragment,null,a.a.createElement(ke,{breadcrumbs:n}),a.a.createElement(i.EuiSpacer,{size:"l"}),a.a.createElement(i.EuiText,{textAlign:"center","data-test-subj":"resolver:panel:error"},e),a.a.createElement(i.EuiSpacer,{size:"l"}),a.a.createElement(i.EuiButtonEmpty,t,E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.error.goBack",{defaultMessage:"View all processes"})))})),Ge=p()(R).withConfig({displayName:"StyledCubeForProcess",componentId:"sc-821tkc-0"})(["position:relative;top:0.75em;"]),Ue=E.i18n.translate("xpack.securitySolution.resolver.panel.nodeDetail.Error",{defaultMessage:"Node details were unable to be retrieved"}),Ke=Object(r.memo)((function({nodeID:e}){const t=Object(o.useSelector)((t=>ie.a(c.t(t)(e))));return"loading"===Object(o.useSelector)((t=>c.u(t)(e)))?a.a.createElement(ee,{hasBorder:!0},a.a.createElement(Ie,null)):t?a.a.createElement(ee,{hasBorder:!0,"data-test-subj":"resolver:panel:node-detail"},a.a.createElement(Qe,{nodeID:e,processEvent:t})):a.a.createElement(ee,{hasBorder:!0},a.a.createElement(He,{translatedErrorMessage:Ue}))})),Qe=Object(r.memo)((function({processEvent:e,nodeID:t}){const n=oe.n(e),l=Object(o.useSelector)((e=>c.u(e)(t))),u=Object(o.useSelector)((e=>c.B(e)(t))),d=Re(oe.g(e)),p=Object(r.useMemo)((()=>[{title:"@timestamp",description:d},{title:"process.executable",description:Object(We.d)(e)},{title:"process.pid",description:Object(We.c)(e)},{title:"user.name",description:oe.q(e)},{title:"user.domain",description:oe.p(e)},{title:"process.parent.pid",description:oe.m(e)},{title:"process.hash.md5",description:oe.k(e)},{title:"process.args",description:oe.b(e)}].reduce(((e,t)=>Array.isArray(t.description)?[...e,...t.description.map((e=>({title:t.title,description:e})))]:[...e,t]),[]).filter((e=>void 0!==e.description)).map((e=>({...e,description:a.a.createElement(Ze,{textToCopy:String(e.description),content:a.a.createElement(B,null,String(e.description))})})))),[d,e]),m=H({panelView:"nodes"}),f=Object(r.useMemo)((()=>[{text:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.processDescList.events",{defaultMessage:"Events"}),"data-test-subj":"resolver:node-detail:breadcrumbs:node-list-link",...m},{text:a.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.detailsForProcessName",values:{processName:n},defaultMessage:"Details for: {processName}"})}]),[n,m]),{descriptionText:v}=N(l,!1),g=H({panelView:"nodeEvents",panelParameters:{nodeID:t}}),h=Object(r.useMemo)((()=>Object(i.htmlIdGenerator)("resolverTable")()),[]);return a.a.createElement(a.a.Fragment,null,a.a.createElement(ke,{breadcrumbs:f}),a.a.createElement(i.EuiSpacer,{size:"l"}),a.a.createElement(i.EuiTitle,{size:"xs"},a.a.createElement(O,{"aria-describedby":h},a.a.createElement(Ge,{"data-test-subj":"resolver:node-detail:title-icon",state:l}),a.a.createElement("span",{"data-test-subj":"resolver:node-detail:title"},a.a.createElement(B,null,n)))),a.a.createElement(i.EuiText,null,a.a.createElement(i.EuiTextColor,{color:"subdued"},a.a.createElement("span",{id:h},v))),a.a.createElement(i.EuiSpacer,{size:"s"}),a.a.createElement(i.EuiLink,Me()({},g,{"data-test-subj":"resolver:node-detail:node-events-link"}),a.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.processDescList.numberOfEvents",values:{relatedEventTotal:u},defaultMessage:"{relatedEventTotal} Events"})),a.a.createElement(i.EuiSpacer,{size:"l"}),a.a.createElement(S,{"data-test-subj":"resolver:node-detail",type:"column",align:"left",titleProps:{"data-test-subj":"resolver:node-detail:entry-title",className:"desc-title"},descriptionProps:{"data-test-subj":"resolver:node-detail:entry-description"},compressed:!0,listItems:p}))})),Je=a.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.eitherLineageLimitExceeded",defaultMessage:"Some process events in the visualization and event list below could not be displayed because the data limit has been reached."}),et=a.a.memo((function({numberOfEntries:e}){return a.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.relatedEventLimitTitle",defaultMessage:"This list includes {numberOfEntries} process events.",values:{numberOfEntries:e}})})),tt=a.a.memo((function({numberDisplayed:e}){return a.a.createElement(ne,{size:"s",title:a.a.createElement(et,{numberOfEntries:e})},a.a.createElement("p",null,Je))})),nt=Object(r.memo)((()=>{const e=Object(r.useMemo)((()=>[{field:"name",name:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.processNameTitle",{defaultMessage:"Process Name"}),sortable:!0,truncateText:!0,render:(e,t)=>a.a.createElement(rt,{name:e,nodeID:t.nodeID})},{field:"timestamp",name:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.timestampTitle",{defaultMessage:"Timestamp"}),dataType:"date",sortable:!0,render:e=>a.a.createElement(at,{eventDate:e})}]),[]),t=Object(o.useSelector)(Object(r.useCallback)((e=>{const{processNodePositions:t}=c.r(e),n=[];for(const e of t.keys()){const t=ae.c(e),r=ae.b(e);void 0!==r&&n.push({name:t,timestamp:ae.e(e),nodeID:r})}return n}),[])),n=t.length,s=Object(r.useMemo)((()=>[{text:E.i18n.translate("xpack.securitySolution.resolver.panel.nodeList.title",{defaultMessage:"All Process Events"})}]),[]),l=Object(o.useSelector)(c.j),u=Object(o.useSelector)(c.i),d=Object(o.useSelector)(c.k),p=!0===l||!0===u||!0===d,m=Object(r.useMemo)((()=>({"data-test-subj":"resolver:node-list:item"})),[]);return a.a.createElement(ee,{hasBorder:!0},a.a.createElement(ke,{breadcrumbs:s}),p&&a.a.createElement(tt,{numberDisplayed:n}),a.a.createElement(i.EuiSpacer,{size:"l"}),a.a.createElement(i.EuiInMemoryTable,{rowProps:m,"data-test-subj":"resolver:node-list",items:t,columns:e,sorting:!0}))}));function rt({name:e,nodeID:t}){const n=Object(o.useSelector)((e=>c.x(e)===t)),s=Object(o.useSelector)((e=>c.u(e)(t))),{descriptionText:l}=g(),u=H({panelView:"nodeDetail",panelParameters:{nodeID:t}}),d=Object(o.useDispatch)(),{timestamp:p}=Object(r.useContext)(w),m=Object(r.useCallback)((e=>{u.onClick(e),d({type:"userSelectedResolverNode",payload:{nodeID:t,time:p()}})}),[p,u,d,t]);return a.a.createElement(i.EuiButtonEmpty,{onClick:m,href:u.href,"data-test-subj":"resolver:node-list:node-link","data-test-node-id":t},void 0===e?a.a.createElement(i.EuiBadge,{color:"warning"},E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.valueMissingDescription",{defaultMessage:"Value is missing"})):a.a.createElement(M,null,a.a.createElement(R,{state:s,isOrigin:n,"data-test-subj":"resolver:node-list:node-link:icon"}),a.a.createElement(I,null,n&&a.a.createElement(k,{color:l,"data-test-subj":"resolver:node-list:node-link:analyzed-event"},E.i18n.translate("xpack.securitySolution.resolver.panel.table.row.analyzedEvent",{defaultMessage:"ANALYZED EVENT"})),a.a.createElement(D,{"data-test-subj":"resolver:node-list:node-link:title"},e))))}const at=Object(r.memo)((({eventDate:e})=>{const t=Re(e);return t?a.a.createElement(Ze,{textToCopy:t,content:t}):a.a.createElement("span",null,"—")}));function ot(e){const t=[{path:[],value:e}],n=[];for(;t.length;){const e=t.shift();if(void 0===e)throw new Error;const{path:r,value:a}=e;Array.isArray(a)?t.push(...a.map((e=>({path:[...r],value:e})))):"object"==typeof a&&null!==a?t.push(...Object.keys(a).map((e=>({path:[...r,e],value:a[e]})))):null!=a&&n.push([r,a])}return n}const it=E.i18n.translate("xpack.securitySolution.resolver.panel.eventDetail.requestError",{defaultMessage:"Event details were unable to be retrieved"}),st=Object(r.memo)((function({nodeID:e,eventCategory:t}){const n=Object(o.useSelector)(c.m),r=Object(o.useSelector)(c.p),i=Object(o.useSelector)((t=>ie.a(c.t(t)(e)))),s=Object(o.useSelector)((t=>c.u(t)(e))),l=n||r||"loading"===s,u=Object(o.useSelector)(c.d);return l?a.a.createElement(ee,{hasBorder:!0},a.a.createElement(Ie,null)):u?a.a.createElement(lt,{nodeID:e,event:u,processEvent:i,eventType:t}):a.a.createElement(ee,{hasBorder:!0},a.a.createElement(He,{translatedErrorMessage:it}))})),lt=Object(r.memo)((function({nodeID:e,event:t,eventType:n,processEvent:r}){const o=Re(oe.o(t))||E.i18n.translate("xpack.securitySolution.enpdoint.resolver.panelutils.noTimestampRetrieved",{defaultMessage:"No timestamp retrieved"}),l=r?oe.n(r):null;return a.a.createElement(ee,{hasBorder:!0,"data-test-subj":"resolver:panel:event-detail"},a.a.createElement(ut,{nodeID:e,nodeName:l,event:t,breadcrumbEventCategory:n}),a.a.createElement(i.EuiSpacer,{size:"l"}),a.a.createElement(i.EuiText,{size:"s"},a.a.createElement(T,null,a.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.categoryAndType",values:{category:n,eventType:String(oe.h(t))},defaultMessage:"{category} {eventType}"})),a.a.createElement(P,{dateTime:o},a.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.atTime",values:{date:o},defaultMessage:"@ {date}"}))),a.a.createElement(i.EuiSpacer,{size:"m"}),a.a.createElement(pt,null,a.a.createElement(B,null,a.a.createElement(Te,{event:t}))),a.a.createElement(i.EuiSpacer,{size:"l"}),a.a.createElement(ct,{event:t}))}));function ct({event:e}){const t=Object(r.useMemo)((()=>{const t=[];for(const[n,r]of Object.entries(e)){if("agent"===n||"ecs"===n||"process"===n||"@timestamp"===n)continue;const e={namespace:a.a.createElement(B,null,n),descriptions:ot(r).map((([e,t])=>{const r=[n,...e].join(".");return{title:a.a.createElement(B,null,r),description:a.a.createElement(Ze,{textToCopy:String(t),content:a.a.createElement(B,null,String(t))})}}))};t.push(e)}return t}),[e]);return a.a.createElement(a.a.Fragment,null,t.map((({namespace:e,descriptions:n},o)=>a.a.createElement(r.Fragment,{key:o},0===o?null:a.a.createElement(i.EuiSpacer,{size:"m"}),a.a.createElement(i.EuiTitle,{size:"xxxs"},a.a.createElement(i.EuiTextColor,{color:"subdued"},a.a.createElement(mt,null,e,a.a.createElement(ft,null)))),a.a.createElement(i.EuiSpacer,{size:"m"}),a.a.createElement(dt,{type:"column",align:"left",titleProps:{className:"desc-title","data-test-subj":"resolver:panel:event-detail:event-field-title"},compressed:!0,listItems:n}),o===t.length-1?null:a.a.createElement(i.EuiSpacer,{size:"m"})))))}function ut({nodeID:e,nodeName:t,event:n,breadcrumbEventCategory:i}){const l=Object(o.useSelector)((t=>c.A(t)(e,i))),u=Object(o.useSelector)((t=>c.B(t)(e))),d=H({panelView:"nodes"}),p=H({panelView:"nodeDetail",panelParameters:{nodeID:e}}),m=H({panelView:"nodeEvents",panelParameters:{nodeID:e}}),f=H({panelView:"nodeEventsInCategory",panelParameters:{nodeID:e,eventCategory:i}}),v=Object(r.useMemo)((()=>{const e=[{text:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.events",{defaultMessage:"Events"}),"data-test-subj":"resolver:event-detail:breadcrumbs:node-list-link",...d},{text:a.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.numberOfEvents",values:{totalCount:u},defaultMessage:"{totalCount} Events"}),...m},{text:a.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.countByCategory",values:{count:l,category:i},defaultMessage:"{count} {category}"}),...f},{text:a.a.createElement(Te,{event:n})}];return t&&e.splice(1,0,{text:t,...p}),e}),[i,l,n,p,m,t,u,d,f]);return a.a.createElement(ke,{breadcrumbs:v})}const dt=Object(r.memo)(p()(i.EuiDescriptionList).withConfig({displayName:"StyledDescriptionList",componentId:"sc-wbnmrd-0"})(["&.euiDescriptionList.euiDescriptionList--column dt.euiDescriptionList__title.desc-title{max-width:8em;overflow-wrap:break-word;}&.euiDescriptionList.euiDescriptionList--column dd.euiDescriptionList__description{max-width:calc(100% - 8.5em);overflow-wrap:break-word;}"])),pt=Object(r.memo)(p()(i.EuiText).withConfig({displayName:"StyledDescriptiveName",componentId:"sc-wbnmrd-1"})(["padding-right:1em;overflow-wrap:break-word;"])),mt=Object(r.memo)(p()("h3").withConfig({displayName:"StyledFlexTitle",componentId:"sc-wbnmrd-2"})(["align-items:center;display:flex;flex-flow:row;font-size:1.2em;"])),ft=Object(r.memo)((()=>a.a.createElement(i.EuiHorizontalRule,{margin:"none",size:"half"}))),vt=Object(r.memo)((function(){const e=Object(o.useSelector)(c.y);return"nodeDetail"===e.panelView?a.a.createElement(Ke,{nodeID:e.panelParameters.nodeID}):"nodeEvents"===e.panelView?a.a.createElement(Ve,{nodeID:e.panelParameters.nodeID}):"nodeEventsInCategory"===e.panelView?a.a.createElement(Fe,{nodeID:e.panelParameters.nodeID,eventCategory:e.panelParameters.eventCategory}):"eventDetail"===e.panelView?a.a.createElement(st,{nodeID:e.panelParameters.nodeID,eventCategory:e.panelParameters.eventCategory}):a.a.createElement(nt,null)}));var gt=n(614);const ht=p()(i.EuiCodeBlock).withConfig({displayName:"StyledEuiCodeBlock",componentId:"sc-r4p8yj-0"})(["align-self:flex-start;display:inline-block;"]),bt=p()(i.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-r4p8yj-1"})(["max-width:600px;margin:60px auto 0;"]),yt=()=>a.a.createElement(bt,{"data-test-subj":"resolver:no-process-events",direction:"column"},a.a.createElement(i.EuiTitle,null,a.a.createElement("h4",null,E.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.title",{defaultMessage:"No Process Events Found"}))),a.a.createElement(i.EuiSpacer,{size:"m"}),a.a.createElement(i.EuiText,{size:"s"},E.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.timeRange",{defaultMessage:"\n            The Analyze Event tool creates graphs based on process events.\n            If the analyzed event does not have an associated process in the current time range,\n            or stored in Elasticsearch within any time range, a graph will not be created.\n            You can check for associated processes by expanding your time range.\n          "})),a.a.createElement(i.EuiSpacer,{size:"m"}),a.a.createElement(i.EuiText,{size:"s"},E.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.dataView",{defaultMessage:'In case you selected a different data view,\n          make sure your data view contains all of the indices that are stored in the source event at "{field}".',values:{field:"kibana.alert.rule.parameters.index"}})),a.a.createElement(i.EuiSpacer,{size:"m"}),a.a.createElement(i.EuiText,{size:"s"},E.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.eventCategory",{defaultMessage:"You may also add the below to your timeline query to check for process events.\n            If none are listed, a graph cannot be created from events found in that query."})),a.a.createElement(i.EuiSpacer,{size:"m"}),a.a.createElement(ht,{language:"html",paddingSize:"s",isCopyable:!0},'event.category: "process"')),Et=a.a.memo(a.a.forwardRef((function({className:e,databaseDocumentID:t,resolverComponentInstanceID:n,indices:d,shouldUpdate:p,filters:m},f){!function(){const e=Object(r.useRef)();e.current=Object(l.useLocation)().search;const t=Object(l.useHistory)(),n=Object(o.useSelector)(c.D),a=Object(u.a)(n);Object(r.useEffect)((()=>{const n=a;return()=>{const r=new URLSearchParams(e.current);r.delete(n);const a={search:r.toString()};t.replace(a)}}),[a,t])}(),function({databaseDocumentID:e,resolverComponentInstanceID:t,indices:n,filters:a,shouldUpdate:o}){const i=re(),s=Object(l.useLocation)().search;Object(r.useLayoutEffect)((()=>{i({type:"appReceivedNewExternalProperties",payload:{databaseDocumentID:e,resolverComponentInstanceID:t,locationSearch:s,indices:n,shouldUpdate:o,filters:a}})}),[i,e,t,s,n,o,a])}({databaseDocumentID:t,resolverComponentInstanceID:n,indices:d,shouldUpdate:p,filters:m}),function(){const e=Object(o.useDispatch)(),t=Object(o.useSelector)(c.D),n=Object(l.useLocation)().search,a=Object(r.useContext)(w),i=Object(o.useSelector)(c.H),s=Object(o.useSelector)(c.f),u=Object(gt.a)({locationSearch:n,resolverComponentInstanceID:t});let d;"nodes"!==u.panelView&&(d=u.panelParameters.nodeID),Object(r.useEffect)((()=>{d&&s(d)&&d!==i&&e({type:"userSelectedResolverNode",payload:{nodeID:d,time:a.timestamp()}})}),[u.panelView,d,e,s,i,a])}();const{timestamp:v}=Object(r.useContext)(w),h=v(),{processNodePositions:b,connectingEdgeLineSegments:E}=Object(o.useSelector)((e=>c.O(e)(h))),{projectionMatrix:C,ref:x,onMouseDown:S}=function(){const e=re(),t=Object(r.useContext)(w),[n,a]=Object(r.useState)(null),i=Object(o.useSelector)(c.z),s=Object(r.useRef)(),[l,u]=Object(r.useState)(i(t.timestamp())),d=Object(o.useSelector)(c.N),p=Object(o.useSelector)(c.l),[m,f]=function(){const{getBoundingClientRect:e}=Object(r.useContext)(w),[t,n]=Object(r.useState)(null),{ResizeObserver:a,requestAnimationFrame:o}=Object(r.useContext)(w),[i,s]=Object(r.useState)(null),l=Object(r.useCallback)((e=>{s(e)}),[]);return Object(r.useEffect)((()=>{null!==i&&n(e(i))}),[i,e]),Object(r.useEffect)((()=>{let t=window.scrollX,r=window.scrollY;const a=()=>{o((()=>{const a=window.scrollX,o=window.scrollY;null===i||t===a&&r===o||n(e(i)),t=a,r=o}))};return window.addEventListener("scroll",a,{passive:!0}),()=>{window.removeEventListener("scroll",a)}}),[i,o,e]),Object(r.useEffect)((()=>{if(null!==i){const t=new a((t=>{null!==i&&i===t[0].target&&n(e(i))}));return t.observe(i),()=>{t.disconnect()}}}),[a,i,e]),[t,l]}(),v=Object(r.useCallback)((e=>null===m?null:[e.clientX-m.x,e.clientY-m.y]),[m]),g=Object(r.useCallback)((n=>{const r=v(n);null!==r&&e({type:"userStartedPanning",payload:{screenCoordinates:r,time:t.timestamp()}})}),[e,v,t]),h=Object(r.useCallback)((n=>{const r=v(n);r&&e({type:"userMovedPointer",payload:{screenCoordinates:r,time:t.timestamp()}})}),[e,v,t]),b=Object(r.useCallback)((()=>{d&&e({type:"userStoppedPanning",payload:{time:t.timestamp()}})}),[e,t,d]),y=Object(r.useCallback)((n=>{null!==m&&n.ctrlKey&&0!==n.deltaY&&0===n.deltaMode&&(n.preventDefault(),e({type:"userZoomed",payload:{zoomChange:n.deltaY/-m.height,time:t.timestamp()}}))}),[m,e,t]),E=Object(r.useCallback)((e=>{a(e),f(e)}),[f]);return Object(r.useEffect)((()=>(window.addEventListener("mouseup",b,{passive:!0}),()=>{window.removeEventListener("mouseup",b)})),[b]),Object(r.useEffect)((()=>(window.addEventListener("mousemove",h,{passive:!0}),()=>{window.removeEventListener("mousemove",h)})),[h]),Object(r.useEffect)((()=>{if(null!==n)return n.addEventListener("wheel",y),()=>{n.removeEventListener("wheel",y)}}),[n,y]),Object(r.useLayoutEffect)((()=>{s.current=i}),[i]),Object(r.useLayoutEffect)((()=>{u(i(t.timestamp()))}),[i,t]),Object(r.useLayoutEffect)((()=>{const e=t.timestamp();if(p(e)){let e=null;const n=()=>{const r=t.timestamp();void 0!==s.current&&u(s.current(r)),e=p(r)?t.requestAnimationFrame(n):null};return e=t.requestAnimationFrame(n),()=>{null!==e&&t.cancelAnimationFrame(e)}}}),[p,t]),Object(r.useEffect)((()=>{null!==m&&e({type:"userSetRasterSize",payload:[m.width,m.height]})}),[e,m]),{ref:E,onMouseDown:g,projectionMatrix:l}}(),O=Object(r.useCallback)((e=>{x(e),"function"==typeof f?f(e):null!==f&&(f.current=e)}),[x,f]),j=Object(o.useSelector)(c.p),M=Object(o.useSelector)(c.h),k=Object(o.useSelector)(c.a),D=Object(o.useSelector)(c.E),I=g();return a.a.createElement(J,{className:e,backgroundColor:I.resolverBackground},j?a.a.createElement("div",{"data-test-subj":"resolver:graph:loading",className:"loading-container"},a.a.createElement(i.EuiLoadingSpinner,{size:"xl"})):M?a.a.createElement("div",{"data-test-subj":"resolver:graph:error",className:"loading-container"},a.a.createElement("div",null," ",a.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.loadingError",defaultMessage:"Error loading data."}))):D?a.a.createElement(a.a.Fragment,null,a.a.createElement(te,{"data-test-subj":"resolver:graph",className:"resolver-graph kbn-resetFocusState",onMouseDown:S,ref:O,role:"tree",tabIndex:0,"aria-activedescendant":k||void 0},E.map((({points:[e,t],metadata:n})=>a.a.createElement(y,{edgeLineMetadata:n,key:n.reactKey,startPosition:e,endPosition:t,projectionMatrix:C}))),[...b].map((([e,t])=>{const n=ae.b(e);if(void 0===n)throw new Error("Tried to render a node without an ID");return a.a.createElement(pe,{key:n,nodeID:n,position:t,projectionMatrix:C,node:e,timeAtRender:h})}))),a.a.createElement(vt,null)):a.a.createElement(yt,null),a.a.createElement(X,null),a.a.createElement(Se,null))})))},801:function(e,t,n){"use strict";n.d(t,"a",(function(){return x}));var r=n(52),a=n(893),o=n(613),i=n(310);function s(e,t,n,r){const a=Object(o.g)(e)(t);return 0===Object(i.d)(n,a)?{...e,animation:void 0,panning:void 0}:{...e,panning:void 0,translationNotCountingCurrentPanning:n,animation:{startTime:t,targetTranslation:n,initialTranslation:a,duration:r}}}var l=n(227),c=n(437),u=n(641);const d=e=>{const t=c.a-c.b;return Math.pow((e-c.b)/t,1/c.f)};var p=n(644),m=n(818),f=n(642),v=n(394);const g={currentRelatedEvent:{loading:!1,data:null},resolverComponentInstanceID:void 0,indices:[]};var h=n(832);const b=Object(r.combineReducers)({camera:(e=function(){return{scalingFactor:d(1),rasterSize:[0,0],translationNotCountingCurrentPanning:[0,0],latestFocusedWorldCoordinates:null,animation:void 0,panning:void 0}}(),t)=>{if("userSetZoomLevel"===t.type)return{...e,scalingFactor:Object(u.a)(t.payload,0,1)};if("userClickedZoomIn"===t.type)return{...e,scalingFactor:Object(u.a)(e.scalingFactor+.1,0,1)};if("userClickedZoomOut"===t.type)return{...e,scalingFactor:Object(u.a)(e.scalingFactor-.1,0,1)};if("userZoomed"===t.type){const n={...e,scalingFactor:Object(u.a)(e.scalingFactor+t.payload.zoomChange,0,1)};if(null===e.latestFocusedWorldCoordinates||o.c(e)(t.payload.time))return n;{const r=i.c(e.latestFocusedWorldCoordinates,o.d(e)(t.payload.time)),a=i.c(r,o.b(n)(t.payload.time)),s=i.j(a,e.latestFocusedWorldCoordinates),l=i.j(n.translationNotCountingCurrentPanning,s);return{...n,translationNotCountingCurrentPanning:l}}}if("userSetPositionOfCamera"===t.type)return{...e,animation:void 0,translationNotCountingCurrentPanning:t.payload};if("userStartedPanning"===t.type)return o.c(e)(t.payload.time)?e:{...e,animation:void 0,panning:{origin:t.payload.screenCoordinates,currentOffset:t.payload.screenCoordinates}};if("userStoppedPanning"===t.type)return{...e,translationNotCountingCurrentPanning:o.g(e)(t.payload.time),panning:void 0};if("userNudgedCamera"===t.type){const{direction:n,time:r}=t.payload,a=i.h(i.e([c.e,c.e],o.e(e)(r)),n);return s(e,r,i.a(e.translationNotCountingCurrentPanning,a),c.c)}if("userSetRasterSize"===t.type)return{...e,rasterSize:t.payload};if("userMovedPointer"===t.type){let n=e;return e.panning&&(n={...e,panning:{origin:e.panning.origin,currentOffset:t.payload.screenCoordinates}}),{...n,latestFocusedWorldCoordinates:i.c(t.payload.screenCoordinates,o.b(n)(t.payload.time))}}return e},data:(e=g,t)=>{if("appReceivedNewExternalProperties"===t.type){const n={...e,tree:{...e.tree,currentParameters:{databaseDocumentID:t.payload.databaseDocumentID,indices:t.payload.indices,filters:t.payload.filters}},resolverComponentInstanceID:t.payload.resolverComponentInstanceID,locationSearch:t.payload.locationSearch,indices:t.payload.indices},r=m.x(n);return{...n,nodeEventsInCategory:n.nodeEventsInCategory&&f.a(n.nodeEventsInCategory,r)?n.nodeEventsInCategory:void 0}}if("appRequestedResolverData"===t.type)return{...e,tree:{...e.tree,pendingRequestParameters:{databaseDocumentID:t.payload.databaseDocumentID,indices:t.payload.indices,filters:t.payload.filters}}};var n,r,a;if("appAbortedResolverDataRequest"===t.type)return p.a(t.payload,null===(n=e.tree)||void 0===n?void 0:n.pendingRequestParameters)?{...e,tree:{...e.tree,pendingRequestParameters:void 0}}:e;if("serverReturnedResolverData"===t.type)return{...e,tree:{...e.tree,lastResponse:{result:t.payload.result,dataSource:t.payload.dataSource,schema:t.payload.schema,parameters:t.payload.parameters,successful:!0},pendingRequestParameters:void 0}};if("serverFailedToReturnResolverData"===t.type)return void 0!==(null===(r=e.tree)||void 0===r?void 0:r.pendingRequestParameters)?{...e,tree:{...e.tree,pendingRequestParameters:void 0,lastResponse:{parameters:e.tree.pendingRequestParameters,successful:!1}}}:e;if("serverReturnedNodeEventsInCategory"===t.type){if(f.a(t.payload,m.x(e))){if(e.nodeEventsInCategory){const n=f.b(e.nodeEventsInCategory,t.payload);if(n)return{...e,nodeEventsInCategory:{...n}};throw new Error("Could not handle related event data because of an internal error.")}return{...e,nodeEventsInCategory:t.payload}}return e}if("userRequestedAdditionalRelatedEvents"===t.type)return e.nodeEventsInCategory?{...e,nodeEventsInCategory:{...e.nodeEventsInCategory,lastCursorRequested:null===(a=e.nodeEventsInCategory)||void 0===a?void 0:a.cursor}}:e;if("serverFailedToReturnNodeEventsInCategory"===t.type)return e.nodeEventsInCategory?{...e,nodeEventsInCategory:{...e.nodeEventsInCategory,error:!0}}:e;if("serverReturnedNodeData"===t.type){const n=v.e({storedNodeInfo:e.nodeData,receivedEvents:t.payload.nodeData,requestedNodes:t.payload.requestedIDs,numberOfRequestedEvents:t.payload.numberOfRequestedEvents});return{...e,nodeData:n}}if("userReloadedResolverNode"===t.type){const n=v.c(e.nodeData,t.payload);return{...e,nodeData:n}}if("appRequestingNodeData"===t.type){const n=v.d(e.nodeData,t.payload.requestedIDs);return{...e,nodeData:n}}if("serverFailedToReturnNodeData"===t.type){const n=v.b(e.nodeData,t.payload.requestedIDs);return{...e,nodeData:n}}return"appRequestedCurrentRelatedEventData"===t.type?{...e,currentRelatedEvent:{loading:!0,data:null}}:"serverReturnedCurrentRelatedEventData"===t.type?{...e,currentRelatedEvent:{loading:!1,data:{...t.payload}}}:"serverFailedToReturnCurrentRelatedEventData"===t.type?{...e,currentRelatedEvent:{loading:!1,data:null}}:e},ui:(e={ariaActiveDescendant:null,selectedNode:null},t)=>"serverReturnedResolverData"===t.type?{...e,ariaActiveDescendant:t.payload.result.originID,selectedNode:t.payload.result.originID}:"userFocusedOnResolverNode"===t.type?{...e,ariaActiveDescendant:t.payload.nodeID}:"userSelectedResolverNode"===t.type?{...e,selectedNode:t.payload.nodeID,ariaActiveDescendant:t.payload.nodeID}:"appReceivedNewExternalProperties"===t.type?{...e,locationSearch:t.payload.locationSearch,resolverComponentInstanceID:t.payload.resolverComponentInstanceID}:e}),y=(e,t)=>{const n=b(e,t);if("userSelectedResolverNode"===t.type||"userFocusedOnResolverNode"===t.type){const e=Object(h.b)(Object(l.r)(n),t.payload.nodeID);return e?{...n,camera:s(n.camera,t.payload.time,e,c.d)}:n}return n};var E=n(643),C=n(6);const x=e=>{const t=Object(a.composeWithDevTools)({name:"Resolver",actionsBlacklist:["userMovedPointer"]}),n=Object(r.applyMiddleware)((e=>t=>n=>{const r=function(e,t){let n;return async()=>{const r=t.getState(),a=l.L(r);if(l.M(r)&&n)n.abort();else if(null!==a){let o,i,s,c;n=new AbortController;const u=l.J(r);t.dispatch({type:"appRequestedResolverData",payload:a});try{const r=await e.entities({_id:a.databaseDocumentID,indices:a.indices,signal:n.signal});if(r.length<1)return void t.dispatch({type:"serverFailedToReturnResolverData",payload:a});({id:o,schema:s,name:i}=r[0]),c=await e.resolverTree({dataId:o,schema:s,timeRange:u,indices:a.indices,ancestors:Object(E.a)(s),descendants:Object(E.b)()});const l={originID:o,nodes:c};t.dispatch({type:"serverReturnedResolverData",payload:{result:l,dataSource:i,schema:s,parameters:a}})}catch(e){e instanceof DOMException&&"AbortError"===e.name?t.dispatch({type:"appAbortedResolverDataRequest",payload:a}):t.dispatch({type:"serverFailedToReturnResolverData",payload:a})}}}}(e,t),a=function(e,t){let n;return async()=>{const r=t.getState(),a=l.y(r),o=l.n(r),i=l.e(r),s=n,c=l.J(r);async function u({nodeID:n,eventCategory:r,cursor:a}){let o=null;try{o=a?await e.eventsWithEntityIDAndCategory({entityID:n,category:r,after:a,indexPatterns:i,timeRange:c}):await e.eventsWithEntityIDAndCategory({entityID:n,category:r,indexPatterns:i,timeRange:c})}catch(e){t.dispatch({type:"serverFailedToReturnNodeEventsInCategory",payload:{nodeID:n,eventCategory:r,cursor:a}})}o&&t.dispatch({type:"serverReturnedNodeEventsInCategory",payload:{events:o.events,eventCategory:r,cursor:o.nextEvent,nodeID:n}})}if(n=a,Object(C.isEqual)(a,s)){if(o){const e=r.data.nodeEventsInCategory;void 0!==e&&await u(e)}}else if("nodeEventsInCategory"===a.panelView){const e=a.panelParameters.nodeID;t.dispatch({type:"appRequestedNodeEventsInCategory",payload:{parameters:a}}),await u({nodeID:e,eventCategory:a.panelParameters.eventCategory,cursor:null})}}}(e,t),o=function(e,t){let n;return async()=>{const r=t.getState(),a=l.y(r),o=l.e(r),i=n;if(n=a,!Object(C.isEqual)(a,i)&&"eventDetail"===a.panelView){const n=a.panelParameters.eventID,i=a.panelParameters.nodeID,s=a.panelParameters.eventCategory,c=a.panelParameters.eventTimestamp,u=a.panelParameters.winlogRecordID;t.dispatch({type:"appRequestedCurrentRelatedEventData"});const d=l.J(r);let p=null;try{p=await e.event({nodeID:i,eventCategory:[s],eventTimestamp:c,eventID:n,winlogRecordID:u,indexPatterns:o,timeRange:d})}catch(e){t.dispatch({type:"serverFailedToReturnCurrentRelatedEventData"})}p?t.dispatch({type:"serverReturnedCurrentRelatedEventData",payload:p}):t.dispatch({type:"serverFailedToReturnCurrentRelatedEventData"})}}}(e,t),i=function(e,t){return async()=>{const n=t.getState(),r=l.s(n)(Number.POSITIVE_INFINITY),a=l.e(n);if(r.size<=0)return;let o;t.dispatch({type:"appRequestingNodeData",payload:{requestedIDs:r}});try{const t=l.J(n);o=await e.nodeData({ids:Array.from(r),timeRange:t,indexPatterns:a,limit:5e3})}catch(e){t.dispatch({type:"serverFailedToReturnNodeData",payload:{requestedIDs:r}})}o&&t.dispatch({type:"serverReturnedNodeData",payload:{nodeData:o,requestedIDs:r,numberOfRequestedEvents:5e3}})}}(e,t);return async e=>{n(e),r(),a(),i(),o()}})(e));return Object(r.createStore)(y,t(n))}},818:function(e,t,n){"use strict";n.d(t,"o",(function(){return f})),n.d(t,"h",(function(){return v})),n.d(t,"B",(function(){return g})),n.d(t,"C",(function(){return b})),n.d(t,"D",(function(){return y})),n.d(t,"w",(function(){return E})),n.d(t,"r",(function(){return C})),n.d(t,"s",(function(){return x})),n.d(t,"f",(function(){return w})),n.d(t,"u",(function(){return O})),n.d(t,"A",(function(){return j})),n.d(t,"l",(function(){return M})),n.d(t,"c",(function(){return k})),n.d(t,"y",(function(){return D})),n.d(t,"k",(function(){return I})),n.d(t,"j",(function(){return T})),n.d(t,"i",(function(){return P})),n.d(t,"I",(function(){return L})),n.d(t,"F",(function(){return N})),n.d(t,"H",(function(){return _})),n.d(t,"d",(function(){return R})),n.d(t,"q",(function(){return F})),n.d(t,"e",(function(){return B})),n.d(t,"b",(function(){return A})),n.d(t,"a",(function(){return z})),n.d(t,"v",(function(){return q})),n.d(t,"J",(function(){return X})),n.d(t,"E",(function(){return Z})),n.d(t,"G",(function(){return W})),n.d(t,"z",(function(){return H})),n.d(t,"x",(function(){return G})),n.d(t,"t",(function(){return U})),n.d(t,"p",(function(){return K})),n.d(t,"g",(function(){return Q})),n.d(t,"n",(function(){return J})),n.d(t,"m",(function(){return ee}));var r=n(895),a=n.n(r),o=n(12),i=n(614),s=n(835),l=n(284),c=n(642),u=n(643),d=n(644),p=n(832);var m=n(310);function f(e){var t;return void 0!==(null===(t=e.tree)||void 0===t?void 0:t.pendingRequestParameters)}function v(e){var t,n;return!(null===(t=e.tree)||void 0===t||!t.lastResponse||null!==(n=e.tree)&&void 0!==n&&n.lastResponse.successful)}function g(e){return e.resolverComponentInstanceID?e.resolverComponentInstanceID:""}const h=e=>{var t,n,r;return null!==(t=e.tree)&&void 0!==t&&null!==(n=t.lastResponse)&&void 0!==n&&n.successful?null===(r=e.tree)||void 0===r?void 0:r.lastResponse.result:void 0},b=e=>{var t,n,r,a,o;return!(null===(t=e.tree)||void 0===t||null===(n=t.lastResponse)||void 0===n||!n.successful)&&(null===(r=e.tree)||void 0===r||null===(a=r.lastResponse)||void 0===a||null===(o=a.result)||void 0===o?void 0:o.nodes.length)>0};function y(e){var t,n;if(null!==(t=e.tree)&&void 0!==t&&null!==(n=t.lastResponse)&&void 0!==n&&n.successful){var r;const{schema:t,dataSource:n}=null===(r=e.tree)||void 0===r?void 0:r.lastResponse;return{schema:t,dataSource:n}}}const E=Object(o.createSelector)(h,(function(e){return null==e?void 0:e.originID})),C=Object(o.createSelector)((e=>e.nodeData),(e=>t=>null==e?void 0:e.get(t))),x=Object(o.createSelector)(C,(e=>t=>{const n=e(t);return n?n.status:"loading"})),w=Object(o.createSelector)(h,(function(e){const t=new Map;if(null!=e&&e.nodes){for(const n of e.nodes){const e=l.b(n);void 0!==e&&t.set(e,n)}return[...t.values()]}return[]})),S=Object(o.createSelector)(w,E,(function(e,t){return s.b(e,t)})),O=Object(o.createSelector)(h,(e=>{if(e){const t=u.d(e);return e=>t.get(e)}return()=>{}})),j=Object(o.createSelector)(O,(e=>t=>{var n;return null===(n=e(t))||void 0===n?void 0:n.total}));function M(e){return e.currentRelatedEvent.loading}function k(e){return e.currentRelatedEvent.data}const D=Object(o.createSelector)(O,(e=>(t,n)=>{const r=e(t);if(r){const e=Object.prototype.hasOwnProperty.call(r.byCategory,n);if("number"==typeof e&&Number.isFinite(e))return e}})),I=Object(o.createSelector)(S,y,((e,t)=>{var n,r;return(null==t||null===(n=t.schema)||void 0===n||!n.ancestry)&&(null!==(r=e.generations)&&void 0!==r?r:0)>=u.c(null==t?void 0:t.schema)})),T=Object(o.createSelector)(S,(e=>{var t;return(null!==(t=e.descendants)&&void 0!==t?t:0)>=u.b()})),P=Object(o.createSelector)(S,y,((e,t)=>{var n;return(null!==(n=e.ancestors)&&void 0!==n?n:0)>=u.a(null==t?void 0:t.schema)}));function L(e){var t,n,r,a,o,i;return void 0===(null===(t=e.tree)||void 0===t?void 0:t.currentParameters)||d.a(null===(n=e.tree)||void 0===n?void 0:n.currentParameters,null===(r=e.tree)||void 0===r||null===(a=r.lastResponse)||void 0===a?void 0:a.parameters)||d.a(null===(o=e.tree)||void 0===o?void 0:o.currentParameters,null===(i=e.tree)||void 0===i?void 0:i.pendingRequestParameters)?null:e.tree.currentParameters}const N=Object(o.createSelector)((e=>{var t;return null===(t=e.tree)||void 0===t?void 0:t.currentParameters}),(function(e){const t=new Date(0),n=new Date(864e13),r={from:t.toISOString(),to:n.toISOString()};return void 0!==e&&(e.filters.from&&(r.from=e.filters.from),e.filters.to&&(r.to=e.filters.to)),r})),_=Object(o.createSelector)(L,(e=>{var t;return null!==(t=null==e?void 0:e.indices)&&void 0!==t?t:[]})),R=Object(o.createSelector)((e=>{var t,n,r,a,o;return null!==(t=e.tree)&&void 0!==t&&null!==(n=t.lastResponse)&&void 0!==n&&n.successful?null===(r=e.tree)||void 0===r||null===(a=r.lastResponse)||void 0===a||null===(o=a.parameters)||void 0===o?void 0:o.indices:void 0}),(e=>e.indices),(function(e,t){var n;return null!==(n=null!=e?e:t)&&void 0!==n?n:[]})),F=Object(o.createSelector)(S,E,(function(e,t){const n=p.a(e);if(!t)return n;if(null===s.f(e,t))return n;const r=p.b(n,t);return void 0===r?n:p.c(n,m.i(r,-1))})),B=Object(o.createSelector)(S,(e=>t=>s.f(e,t))),A=Object(o.createSelector)(F,B,(({ariaLevels:e},t)=>n=>{var r;const a=t(n);return a&&null!==(r=e.get(a))&&void 0!==r?r:null})),z=Object(o.createSelector)(S,B,((e,t)=>{const n=new Map;return function r(a){const o=n.get(a);if(void 0!==o)return o;const i=t(a);if(!i)throw new Error("could not find child event in process tree.");const c=s.a(e,l.d(i));let u=null;for(const e of c){if(null!==u){const t=l.b(u),r=l.b(e);void 0!==t&&void 0!==r&&n.set(t,r)}u=e}if(u){const e=l.b(u);void 0!==e&&n.set(e,null)}return r(a)}})),V=Object(o.createSelector)(F,(function({processNodePositions:e,edgeLineSegments:t}){const n=new a.a,r=[],o=[];for(const[t,n]of e){const[e,a]=n,o={minX:e-360,minY:a-120,maxX:e+360,maxY:a+120,position:n,entity:t,type:"treeNode"};r.push(o)}for(const e of t){const{points:[[t,n],[r,a]]}=e,i={minX:Math.min(t,r)-30,minY:Math.min(n,a)-30,maxX:Math.max(t,r)+30,maxY:Math.max(n,a)+30,entity:e,type:"edgeLine"};o.push(i)}return n.load([...r,...o]),n})),q=Object(o.createSelector)(V,(function(e){return Object(o.defaultMemoize)((t=>{const{minimum:[n,r],maximum:[a,o]}=t,i=e.search({minX:n,minY:r,maxX:a,maxY:o});return{processNodePositions:new Map(i.filter((e=>"treeNode"===e.type)).map((e=>[e.entity,e.position]))),connectingEdgeLineSegments:i.filter((e=>"edgeLine"===e.type)).map((e=>e.entity))}}),Y)}));function $(e){const t=e;return void 0!==t.maximum&&void 0!==t.minimum}function Y(e,t,n){return $(e)&&$(t)?function(e,t){return m.f(e.minimum,t.minimum)&&m.f(e.maximum,t.maximum)}(e,t):e===t}function X(e){var t,n,r;return void 0===(null===(t=e.tree)||void 0===t?void 0:t.pendingRequestParameters)||d.a(null===(n=e.tree)||void 0===n?void 0:n.pendingRequestParameters,null===(r=e.tree)||void 0===r?void 0:r.currentParameters)?null:e.tree.pendingRequestParameters}const Z=Object(o.createSelector)(O,(e=>t=>{const n=l.b(t);if(void 0===n)return null;const r=e(n);return r?r.total:null})),W=Object(o.createSelector)(O,(e=>t=>{const n=e(t);return void 0===n?void 0:n.total})),H=Object(o.createSelector)(O,(e=>(t,n)=>{const r=e(t);return r?r.byCategory[n]:void 0})),G=Object(o.createSelector)((e=>e.locationSearch),g,((e,t)=>Object(i.a)({locationSearch:e,resolverComponentInstanceID:t}))),U=e=>{var t,n;return null!==(t=null===(n=e.nodeEventsInCategory)||void 0===n?void 0:n.events)&&void 0!==t?t:[]},K=Object(o.createSelector)((e=>e.nodeEventsInCategory),G,(function(e,t){return!(void 0===e||!c.a(e,t))&&null!==e.cursor})),Q=Object(o.createSelector)((e=>e.nodeEventsInCategory),G,(function(e,t){return!(void 0===e||!c.a(e,t))&&e&&!0===e.error})),J=Object(o.createSelector)((e=>e.nodeEventsInCategory),G,(function(e,t){const{panelView:n}=t;return"nodeEventsInCategory"===n&&void 0===e})),ee=Object(o.createSelector)((e=>e.nodeEventsInCategory),G,(function(e,t){return!(void 0===e||!c.a(e,t))&&e&&null!==e.lastCursorRequested&&e.cursor===e.lastCursorRequested}))},832:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return m})),n.d(t,"c",(function(){return f}));var r=n(284),a=n(310),o=n(835);const i=e=>{if(!e)return NaN;if("number"==typeof e)return e;let t=Date.parse(e);return Number.isNaN(t)&&(t=parseInt(e,10)),t},s=(e,t)=>{const n=i(e),r=i(t);if(Number.isNaN(n)||Number.isNaN(r))return;const a=r-n,o=36e5,s=24*o,l=7*s,c=30*s,u=365*s;let d,p,m;switch(!0){case a>=u:d=Math.floor(a/u),p="year",m="years";break;case a>=c:d=Math.floor(a/c),p="month",m="months";break;case a>=l:d=Math.floor(a/l),p="week",m="weeks";break;case a>=s:d=Math.floor(a/s),p="day",m="days";break;case a>=o:d=Math.floor(a/o),p="hour",m="hours";break;case a>=6e4:d=Math.floor(a/6e4),p="minute",m="minutes";break;case a>=1e3:d=Math.floor(a/1e3),p="second",m="seconds";break;case 0===a:d="<1",p="millisecond",m="millisecond";break;default:d=a,p="millisecond",m="milliseconds"}return{duration:d,durationType:1===d?p:m}};function l(e){const t=function(e){const t=new Map;if(0===o.e(e))return t;const n=[...o.c(e)].reverse();for(const a of n){const n=o.a(e,r.b(a)),i=n.reduce((function(e,n){var r;return e+(null!==(r=t.get(n))&&void 0!==r?r:0)}),0)+Math.max(0,n.length-1)*p;t.set(a,i)}return t}(e),n=function(e,t){const n=new Map;let r,o=0,i=0;for(const s of u(e,t))if(null===s.parent){const{node:e}=s;n.set(e,[0,0])}else{const{node:e,parent:t,isOnlyChild:l,width:c,parentWidth:u}=s;r!==t&&(o=0,i=0,r=t);const d=n.get(t);if(void 0===d)throw new Error;const m=u/-2+o*p+i+c/2;let f=-p;l||(f*=2);const v=a.a([m,f],d);n.set(e,v),o+=1,i+=c}return n}(e,t),i=function(e,t,n){const a=[];for(const i of u(e,t)){if(null===i.parent)continue;const{node:t,parent:l,parentWidth:c}=i,u=n.get(t),d=n.get(l),p=r.b(l),m=r.b(t);if(void 0===m)throw new Error("tried to graph a Resolver that had a node with without an id");const f=`edge:${null!=p?p:"undefined"}:${m}`;if(void 0===u||void 0===d)throw new Error;const v=r.a(l),g=r.a(t),h={elapsedTime:void 0!==v&&void 0!==g?s(v,g):void 0,reactKey:f},b=d[1]+(u[1]-d[1])/2,y={points:[[u[0],b],u],metadata:h},E=t===o.a(e,r.b(l))[0];if(i.isOnlyChild)a.push({points:[d,u],metadata:h});else if(E){const{firstChildWidth:e,lastChildWidth:t}=i,n={points:[d,[d[0],b]],metadata:{reactKey:`parentToMid${f}`}},r=c/-2+e/2,o=r+(c-e/2-t/2),s={points:[[d[0]+r,b],[d[0]+o,b]],metadata:{reactKey:`midway${f}`}};a.push(n,s,y)}else a.push(y)}return a}(e,t,n),l=[],m=new Map;for(const[e,t]of n)m.set(e,a.c(t,d));for(const e of i){const{points:[t,n]}=e,r={...e,points:[a.c(t,d),a.c(n,d)]};l.push(r)}return{processNodePositions:m,edgeLineSegments:l,ariaLevels:c(e)}}function c(e){const t=new Map;for(const n of o.c(e)){const r=o.d(e,n);if(void 0===r)t.set(n,1);else{const e=t.get(r);if(void 0===e)throw new Error("failed to calculate aria levels");t.set(n,e+1)}}return t}function*u(e,t){for(const n of o.c(e)){const a=o.d(e,n),i=t.get(n);if(void 0===i)throw new Error;if(void 0===a)yield{node:n,width:i,parent:null,parentWidth:null,isOnlyChild:null,firstChildWidth:null,lastChildWidth:null};else{const s=t.get(a);if(void 0===s)throw new Error;const l={node:n,width:i,parent:a,parentWidth:s},c=o.a(e,r.b(a));if(1===c.length)l.isOnlyChild=!0,l.lastChildWidth=i,l.firstChildWidth=i;else{const e=t.get(c[0]),n=t.get(c[c.length-1]);if(void 0===e||void 0===n)throw new Error;l.isOnlyChild=!1,l.firstChildWidth=e,l.lastChildWidth=n}yield l}}}const d=[Math.sqrt(2)/2,-Math.sqrt(2)/2,0,Math.sqrt(6)/6,Math.sqrt(6)/6,-Math.sqrt(6)/3,0,0,1],p=280;function m(e,t){for(const[n,a]of e.processNodePositions.entries())if(r.b(n)===t)return a}function f(e,t){return{processNodePositions:new Map([...e.processNodePositions.entries()].map((([e,n])=>[e,a.a(n,t)]))),edgeLineSegments:e.edgeLineSegments.map((({points:e,metadata:n})=>({points:[a.a(e[0],t),a.a(e[1],t)],metadata:n}))),ariaLevels:e.ariaLevels}}},835:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"e",(function(){return p})),n.d(t,"c",(function(){return m}));var r=n(506);function a({node:e,currentLevel:t,totalDescendants:n,children:r}){const o=r(e);if(o.length<=0)return{generations:t,descendants:n};let i=0,s=n;for(const e of o){const{generations:n,descendants:o}=a({node:e,currentLevel:t+1,totalDescendants:s+1,children:r});s=o,i=Math.max(i,n)}return{generations:i,descendants:s}}var o=n(284);function i(e,t){if(e)return a({node:e,currentLevel:0,totalDescendants:0,children:e=>{var n;return null!==(n=t.get(o.b(e)))&&void 0!==n?n:[]}})}function s(e,t){const n=o.d(e);return void 0===n?void 0:t.get(n)}function l(e,t){const n=new Map,a=new Map;for(const t of e){const e=o.b(t);if(void 0!==e){a.set(e,t);const r=o.d(t);let i=n.get(r);i||(i=[],n.set(r,i)),i.push(t)}}for(const e of n.values())e.sort(r.b);let l,c;if(t){const e=i(a.get(t),n);l=null==e?void 0:e.generations,c=null==e?void 0:e.descendants}const u=function(e,t){if(!e)return;let n=1,r=t.get(e);for(;void 0!==r&&void 0!==s(r,t);)n++,r=s(r,t);return n}(t,a);return{idToChildren:n,idToNode:a,originID:t,generations:l,descendants:c,ancestors:u}}function c(e,t){const n=e.idToChildren.get(t);return void 0===n?[]:n}function u(e,t){var n;return null!==(n=e.idToNode.get(t))&&void 0!==n?n:null}function d(e,t){return s(t,e.idToNode)}function p(e){return e.idToNode.size}function*m(e){const t=function(e){if(0===p(e))return null;let t=e.idToNode.values().next().value;for(;void 0!==d(e,t);)t=d(e,t);return t}(e);null!==t&&(yield*function*(e,t){let n=[e];for(;0!==n.length;){let e=[];for(const r of n)yield r,e.push(...t(r)||[]);n=e,e=[]}}(t,(t=>c(e,o.b(t)))))}},893:function(e,t,n){"use strict";var r=n(52).compose;t.__esModule=!0,t.composeWithDevTools=function(){if(0!==arguments.length)return"object"==typeof arguments[0]?r:r.apply(null,arguments)},t.devToolsEnhancer=function(){return function(e){return e}}},894:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.easing={linear:function(e){return e},quadratic:function(e){return e*(-e*e*e+4*e*e-6*e+4)},cubic:function(e){return e*(4*e*e-9*e+6)},elastic:function(e){return e*(33*e*e*e*e-106*e*e*e+126*e*e-67*e+15)},inQuad:function(e){return e*e},outQuad:function(e){return e*(2-e)},inOutQuad:function(e){return e<.5?2*e*e:(4-2*e)*e-1},inCubic:function(e){return e*e*e},outCubic:function(e){return--e*e*e+1},inOutCubic:function(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},inQuart:function(e){return e*e*e*e},outQuart:function(e){return 1- --e*e*e*e},inOutQuart:function(e){return e<.5?8*e*e*e*e:1-8*--e*e*e*e},inQuint:function(e){return e*e*e*e*e},outQuint:function(e){return 1+--e*e*e*e*e},inOutQuint:function(e){return e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e},inSine:function(e){return 1-Math.cos(e*(Math.PI/2))},outSine:function(e){return Math.sin(e*(Math.PI/2))},inOutSine:function(e){return-(Math.cos(Math.PI*e)-1)/2},inExpo:function(e){return Math.pow(2,10*(e-1))},outExpo:function(e){return 1-Math.pow(2,-10*e)},inOutExpo:function(e){return(e/=.5)<1?Math.pow(2,10*(e-1))/2:(e--,(2-Math.pow(2,-10*e))/2)},inCirc:function(e){return 1-Math.sqrt(1-e*e)},outCirc:function(e){return Math.sqrt(1-(e-=1)*e)},inOutCirc:function(e){return(e/=.5)<1?-(Math.sqrt(1-e*e)-1)/2:(e-=2,(Math.sqrt(1-e*e)+1)/2)}}},895:function(e,t,n){e.exports=function(){"use strict";function e(e,r,a,o,i){!function e(n,r,a,o,i){for(;o>a;){if(o-a>600){var s=o-a+1,l=r-a+1,c=Math.log(s),u=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*u*(s-u)/s)*(l-s/2<0?-1:1);e(n,r,Math.max(a,Math.floor(r-l*u/s+d)),Math.min(o,Math.floor(r+(s-l)*u/s+d)),i)}var p=n[r],m=a,f=o;for(t(n,a,r),i(n[o],p)>0&&t(n,a,o);m<f;){for(t(n,m,f),m++,f--;i(n[m],p)<0;)m++;for(;i(n[f],p)>0;)f--}0===i(n[a],p)?t(n,a,f):t(n,++f,o),f<=r&&(a=f+1),r<=f&&(o=f-1)}}(e,r,a||0,o||e.length-1,i||n)}function t(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function n(e,t){return e<t?-1:e>t?1:0}var r=function(e){void 0===e&&(e=9),this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function a(e,t,n){if(!n)return t.indexOf(e);for(var r=0;r<t.length;r++)if(n(e,t[r]))return r;return-1}function o(e,t){i(e,0,e.children.length,t,e)}function i(e,t,n,r,a){a||(a=f(null)),a.minX=1/0,a.minY=1/0,a.maxX=-1/0,a.maxY=-1/0;for(var o=t;o<n;o++){var i=e.children[o];s(a,e.leaf?r(i):i)}return a}function s(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function l(e,t){return e.minX-t.minX}function c(e,t){return e.minY-t.minY}function u(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function d(e){return e.maxX-e.minX+(e.maxY-e.minY)}function p(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function m(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function f(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function v(t,n,r,a,o){for(var i=[n,r];i.length;)if(!((r=i.pop())-(n=i.pop())<=a)){var s=n+Math.ceil((r-n)/a/2)*a;e(t,s,n,r,o),i.push(n,s,s,r)}}return r.prototype.all=function(){return this._all(this.data,[])},r.prototype.search=function(e){var t=this.data,n=[];if(!m(e,t))return n;for(var r=this.toBBox,a=[];t;){for(var o=0;o<t.children.length;o++){var i=t.children[o],s=t.leaf?r(i):i;m(e,s)&&(t.leaf?n.push(i):p(e,s)?this._all(i,n):a.push(i))}t=a.pop()}return n},r.prototype.collides=function(e){var t=this.data;if(!m(e,t))return!1;for(var n=[];t;){for(var r=0;r<t.children.length;r++){var a=t.children[r],o=t.leaf?this.toBBox(a):a;if(m(e,o)){if(t.leaf||p(e,o))return!0;n.push(a)}}t=n.pop()}return!1},r.prototype.load=function(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(var t=0;t<e.length;t++)this.insert(e[t]);return this}var n=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},r.prototype.insert=function(e){return e&&this._insert(e,this.data.height-1),this},r.prototype.clear=function(){return this.data=f([]),this},r.prototype.remove=function(e,t){if(!e)return this;for(var n,r,o,i=this.data,s=this.toBBox(e),l=[],c=[];i||l.length;){if(i||(i=l.pop(),r=l[l.length-1],n=c.pop(),o=!0),i.leaf){var u=a(e,i.children,t);if(-1!==u)return i.children.splice(u,1),l.push(i),this._condense(l),this}o||i.leaf||!p(i,s)?r?(n++,i=r.children[n],o=!1):i=null:(l.push(i),c.push(n),n=0,r=i,i=i.children[0])}return this},r.prototype.toBBox=function(e){return e},r.prototype.compareMinX=function(e,t){return e.minX-t.minX},r.prototype.compareMinY=function(e,t){return e.minY-t.minY},r.prototype.toJSON=function(){return this.data},r.prototype.fromJSON=function(e){return this.data=e,this},r.prototype._all=function(e,t){for(var n=[];e;)e.leaf?t.push.apply(t,e.children):n.push.apply(n,e.children),e=n.pop();return t},r.prototype._build=function(e,t,n,r){var a,i=n-t+1,s=this._maxEntries;if(i<=s)return o(a=f(e.slice(t,n+1)),this.toBBox),a;r||(r=Math.ceil(Math.log(i)/Math.log(s)),s=Math.ceil(i/Math.pow(s,r-1))),(a=f([])).leaf=!1,a.height=r;var l=Math.ceil(i/s),c=l*Math.ceil(Math.sqrt(s));v(e,t,n,c,this.compareMinX);for(var u=t;u<=n;u+=c){var d=Math.min(u+c-1,n);v(e,u,d,l,this.compareMinY);for(var p=u;p<=d;p+=l){var m=Math.min(p+l-1,d);a.children.push(this._build(e,p,m,r-1))}}return o(a,this.toBBox),a},r.prototype._chooseSubtree=function(e,t,n,r){for(;r.push(t),!t.leaf&&r.length-1!==n;){for(var a=1/0,o=1/0,i=void 0,s=0;s<t.children.length;s++){var l=t.children[s],c=u(l),d=(p=e,m=l,(Math.max(m.maxX,p.maxX)-Math.min(m.minX,p.minX))*(Math.max(m.maxY,p.maxY)-Math.min(m.minY,p.minY))-c);d<o?(o=d,a=c<a?c:a,i=l):d===o&&c<a&&(a=c,i=l)}t=i||t.children[0]}var p,m;return t},r.prototype._insert=function(e,t,n){var r=n?e:this.toBBox(e),a=[],o=this._chooseSubtree(r,this.data,t,a);for(o.children.push(e),s(o,r);t>=0&&a[t].children.length>this._maxEntries;)this._split(a,t),t--;this._adjustParentBBoxes(r,a,t)},r.prototype._split=function(e,t){var n=e[t],r=n.children.length,a=this._minEntries;this._chooseSplitAxis(n,a,r);var i=this._chooseSplitIndex(n,a,r),s=f(n.children.splice(i,n.children.length-i));s.height=n.height,s.leaf=n.leaf,o(n,this.toBBox),o(s,this.toBBox),t?e[t-1].children.push(s):this._splitRoot(n,s)},r.prototype._splitRoot=function(e,t){this.data=f([e,t]),this.data.height=e.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},r.prototype._chooseSplitIndex=function(e,t,n){for(var r,a,o,s,l,c,d,p=1/0,m=1/0,f=t;f<=n-t;f++){var v=i(e,0,f,this.toBBox),g=i(e,f,n,this.toBBox),h=(a=v,o=g,void 0,void 0,void 0,void 0,s=Math.max(a.minX,o.minX),l=Math.max(a.minY,o.minY),c=Math.min(a.maxX,o.maxX),d=Math.min(a.maxY,o.maxY),Math.max(0,c-s)*Math.max(0,d-l)),b=u(v)+u(g);h<p?(p=h,r=f,m=b<m?b:m):h===p&&b<m&&(m=b,r=f)}return r||n-t},r.prototype._chooseSplitAxis=function(e,t,n){var r=e.leaf?this.compareMinX:l,a=e.leaf?this.compareMinY:c;this._allDistMargin(e,t,n,r)<this._allDistMargin(e,t,n,a)&&e.children.sort(r)},r.prototype._allDistMargin=function(e,t,n,r){e.children.sort(r);for(var a=this.toBBox,o=i(e,0,t,a),l=i(e,n-t,n,a),c=d(o)+d(l),u=t;u<n-t;u++){var p=e.children[u];s(o,e.leaf?a(p):p),c+=d(o)}for(var m=n-t-1;m>=t;m--){var f=e.children[m];s(l,e.leaf?a(f):f),c+=d(l)}return c},r.prototype._adjustParentBBoxes=function(e,t,n){for(var r=n;r>=0;r--)s(t[r],e)},r.prototype._condense=function(e){for(var t=e.length-1,n=void 0;t>=0;t--)0===e[t].children.length?t>0?(n=e[t-1].children).splice(n.indexOf(e[t]),1):this.clear():o(e[t],this.toBBox)},r}()}}]);