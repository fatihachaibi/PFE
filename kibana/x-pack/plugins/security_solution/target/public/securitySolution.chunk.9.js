/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[9],{1377:function(e,t,n){"use strict";n.r(t),n.d(t,"withSecurityContext",(function(){return b}));var a=n(5),i=n.n(a),o=n(52),r=n(612),s=n(35),c=n(134),d=n(616);const l=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||o.compose;var p=n(42),u=n(563),g=n(647),y=n(585);const f=Object(a.memo)((({store:e,depsStart:t,queryClient:n,children:a})=>i.a.createElement(p.Provider,{store:e},i.a.createElement(u.a,{queryClient:n},i.a.createElement(g.a.Provider,{value:t},i.a.createElement(y.a,null,a))))));f.displayName="RenderContextProviders";const b=({coreStart:e,depsStart:t,WrappedComponent:n})=>{let p;return Object(a.memo)((a=>(p||(p=(({coreStart:e,depsStart:t,reducersObject:n={management:r.a,app:s.b},preloadedState:a={management:void 0,app:{enableExperimental:c.a.get()}},additionalMiddleware:i=[]})=>Object(o.createStore)(Object(o.combineReducers)(n),a,l(Object(o.applyMiddleware)(...Object(d.a)(e,t),...i))))({coreStart:e,depsStart:t})),i.a.createElement(f,{store:p,depsStart:t},i.a.createElement(n,a)))))}},192:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(5),i=n(3),o=n(86),r=n(169),s=n(18);const c=()=>{const e=Object(s.n)(),t=Object(a.useRef)(e.addError.bind(e)).current,n=Object(a.useRef)(e.addSuccess.bind(e)).current,i=Object(a.useRef)(e.addWarning.bind(e)).current,o=Object(a.useRef)(e.remove.bind(e)).current,r=Object(a.useCallback)(((e,n)=>{const a=d(e);return t(a,n)}),[t]);return Object(a.useMemo)((()=>({api:e,addError:r,addSuccess:n,addWarning:i,remove:o})),[r,n,i,o,e])},d=e=>null!=e&&Object(r.isEsError)(e)?l(e):Object(o.q)(e)?p(e):e instanceof Error?u(e):g(e),l=e=>{var t,n,a,i,o;const r=null!=e.err?e.err:e,s=null!=(null===(t=e.err)||void 0===t?void 0:t.statusCode)?`(${e.err.statusCode})`:null!=e.statusCode?`(${e.statusCode})`:"",c=y(r),d=new Error(`${null!==(n=null===(a=e.attributes)||void 0===a?void 0:a.reason)&&void 0!==n?n:e.message} ${s}`);return d.name=null!==(i=null===(o=e.attributes)||void 0===o?void 0:o.reason)&&void 0!==i?i:e.message,null!=c&&(d.stack=c),d},p=e=>{const t=Object(o.r)(e)?`(${e.body.statusCode})`:Object(o.t)(e)?`(${e.body.status_code})`:"",n=y(e),a=new Error(`${""!==String(e.body.message).trim()?e.body.message:e.message} ${t}`);return a.name=null!=e.name?e.name:"",null!=n&&(a.stack=n),a},u=e=>{const t=y(e),n=new Error(e.message);return n.name=e.name,null!=t&&(n.stack=t),n},g=e=>{const t=y(e),n=Object(i.isString)(e)?e:e instanceof Object&&null!=t?t:String(e),a=new Error(n);return a.name=n,null!=t&&(a.stack=t),a},y=e=>{try{return JSON.stringify(e,((e,t)=>{const n=f(t);return b(n)?void 0:n}),2)}catch(e){return}},f=e=>e instanceof Error?{...e,name:e.name,message:e.message,stack:e.stack}:e,b=e=>{if(!(e instanceof Object))return!1;try{return"{}"===JSON.stringify(e)}catch(e){return!1}}},222:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"f",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return s})),n.d(t,"g",(function(){return c})),n.d(t,"c",(function(){return d}));const a={ACTION:"action",RESPONSE:"response",FLEET_ACTION:"fleetAction",FLEET_RESPONSE:"fleetResponse"};let i,o,r,s,c,d;!function(e){e.windows="windows",e.mac="mac",e.linux="linux"}(i||(i={})),function(e){e.is="is",e.matches="matches"}(o||(o={})),function(e){e.enrolled="enrolled",e.unenrolled="unenrolled"}(r||(r={})),function(e){e.UNHEALTHY="unhealthy",e.HEALTHY="healthy",e.OFFLINE="offline",e.UPDATING="updating",e.INACTIVE="inactive",e.UNENROLLED="unenrolled"}(s||(s={})),function(e){e.detect="detect",e.prevent="prevent",e.off="off"}(c||(c={})),function(e){e.success="success",e.failure="failure",e.warning="warning",e.unsupported="unsupported"}(d||(d={}))},226:function(e,t,n){"use strict";n.r(t),n.d(t,"listData",(function(){return y})),n.d(t,"pageIndex",(function(){return f})),n.d(t,"pageSize",(function(){return b})),n.d(t,"totalHits",(function(){return v})),n.d(t,"listLoading",(function(){return m})),n.d(t,"listError",(function(){return h})),n.d(t,"detailsData",(function(){return O})),n.d(t,"detailsLoading",(function(){return j})),n.d(t,"detailsError",(function(){return E})),n.d(t,"policyItems",(function(){return S})),n.d(t,"policyItemsLoading",(function(){return D})),n.d(t,"selectedPolicyId",(function(){return w})),n.d(t,"endpointPackageInfo",(function(){return R})),n.d(t,"getIsEndpointPackageInfoUninitialized",(function(){return L})),n.d(t,"isAutoRefreshEnabled",(function(){return P})),n.d(t,"autoRefreshInterval",(function(){return _})),n.d(t,"policyVersionInfo",(function(){return I})),n.d(t,"areEndpointsEnrolling",(function(){return k})),n.d(t,"agentsWithEndpointsTotalError",(function(){return A})),n.d(t,"endpointsTotalError",(function(){return T})),n.d(t,"endpointPackageVersion",(function(){return C})),n.d(t,"patterns",(function(){return x})),n.d(t,"patternsError",(function(){return F})),n.d(t,"policyResponseTimestamp",(function(){return q})),n.d(t,"policyResponseAppliedRevision",(function(){return M})),n.d(t,"policyResponseConfigurations",(function(){return z})),n.d(t,"policyResponseFailedOrWarningActionCount",(function(){return N})),n.d(t,"policyResponseActions",(function(){return $})),n.d(t,"policyResponseLoading",(function(){return H})),n.d(t,"policyResponseError",(function(){return W})),n.d(t,"isOnEndpointPage",(function(){return V})),n.d(t,"uiQueryParams",(function(){return B})),n.d(t,"hasSelectedEndpoint",(function(){return Q})),n.d(t,"showView",(function(){return G})),n.d(t,"selectedAgent",(function(){return J})),n.d(t,"hostStatusInfo",(function(){return Y})),n.d(t,"policyResponseStatus",(function(){return K})),n.d(t,"nonExistingPolicies",(function(){return X})),n.d(t,"agentPolicies",(function(){return Z})),n.d(t,"endpointsExist",(function(){return ee})),n.d(t,"searchBarQuery",(function(){return te})),n.d(t,"getCurrentIsolationRequestState",(function(){return ne})),n.d(t,"getIsIsolationRequestPending",(function(){return ae})),n.d(t,"getWasIsolationRequestSuccessful",(function(){return ie})),n.d(t,"getIsolationRequestError",(function(){return oe})),n.d(t,"getIsOnEndpointDetailsActivityLog",(function(){return re})),n.d(t,"getActivityLogDataPaging",(function(){return se})),n.d(t,"getActivityLogData",(function(){return ce})),n.d(t,"getLastLoadedActivityLogData",(function(){return de})),n.d(t,"getActivityLogUninitialized",(function(){return le})),n.d(t,"getActivityLogRequestLoading",(function(){return pe})),n.d(t,"getActivityLogRequestLoaded",(function(){return ue})),n.d(t,"getActivityLogIterableData",(function(){return ge})),n.d(t,"getActivityLogError",(function(){return ye})),n.d(t,"getActivityLogIsUninitializedOrHasSubsequentAPIError",(function(){return fe})),n.d(t,"getIsEndpointHostIsolated",(function(){return be})),n.d(t,"getEndpointPendingActionsState",(function(){return ve})),n.d(t,"getEndpointHostIsolationStatusPropsCallback",(function(){return me})),n.d(t,"getMetadataTransformStats",(function(){return he})),n.d(t,"metadataTransformStats",(function(){return Oe})),n.d(t,"isMetadataTransformStatsLoading",(function(){return je}));var a=n(337),i=n.n(a),o=n(12),r=n(58),s=n(175),c=n(222),d=n(206),l=n(199),p=n(307),u=n(261),g=n(481);const y=e=>e.hosts,f=e=>e.pageIndex,b=e=>e.pageSize,v=e=>e.total,m=e=>e.loading,h=e=>e.error,O=e=>e.endpointDetails.hostDetails.details,j=e=>e.endpointDetails.hostDetails.detailsLoading,E=e=>e.endpointDetails.hostDetails.detailsError,S=e=>e.policyItems,D=e=>e.policyItemsLoading,w=e=>e.selectedPolicyId,R=e=>e.endpointPackageInfo,L=Object(o.createSelector)(R,(e=>Object(p.j)(e))),P=e=>e.isAutoRefreshEnabled,_=e=>e.autoRefreshInterval,I=e=>e.policyVersionInfo,k=e=>e.agentsWithEndpointsTotal>e.endpointsTotal,A=e=>e.agentsWithEndpointsTotalError,T=e=>e.endpointsTotalError,C=Object(o.createSelector)(R,(e=>Object(p.h)(e)?e.data.version:void 0)),x=e=>e.patterns,F=e=>e.patternsError,U=e=>e.policyResponse&&e.policyResponse.Endpoint.policy.applied,q=e=>e.policyResponse&&e.policyResponse["@timestamp"],M=e=>{var t;return String((null===(t=e.policyResponse)||void 0===t?void 0:t.Endpoint.policy.applied.endpoint_policy_version)||"")},z=Object(o.createSelector)(U,(e=>{var t;return null==e||null===(t=e.response)||void 0===t?void 0:t.configurations})),N=Object(o.createSelector)(U,(e=>{var t;const n=new Map;return void 0!==(null==e||null===(t=e.response)||void 0===t?void 0:t.configurations)&&void 0!==(null==e?void 0:e.actions)&&Object.entries(e.response.configurations).map((([t,a])=>{let i=0;for(const t of a.concerned_actions){var o;const n=null===(o=e.actions.find((e=>e.name===t)))||void 0===o?void 0:o.status;n!==c.c.failure&&n!==c.c.warning||(i+=1)}return n.set(t,i)})),n})),$=Object(o.createSelector)(U,(e=>null==e?void 0:e.actions)),H=e=>e.policyResponseLoading,W=e=>e.policyResponseError,V=e=>{var t,n;return null!==Object(r.matchPath)(null!==(t=null===(n=e.location)||void 0===n?void 0:n.pathname)&&void 0!==t?t:"",{path:l.h,exact:!0})},B=Object(o.createSelector)((e=>e.location),(e=>{const t={page_index:String(l.b),page_size:String(l.c)};if(e){const n=i.a.parse(e.search.slice(1)),a=Object(d.a)(n),o=["selected_endpoint","show","admin_query"],r=["policy_response","details","isolate","unisolate","activity_log"];for(const e of o){const a="string"==typeof n[e]?n[e]:Array.isArray(n[e])?n[e][n[e].length-1]:void 0;void 0!==a&&("show"===e?r.includes(a)&&(t[e]=a):t[e]=a)}t.page_size=String(a.page_size),t.page_index=String(a.page_index)}return t})),Q=Object(o.createSelector)(B,(({selected_endpoint:e})=>void 0!==e)),G=Object(o.createSelector)(B,(e=>{var t;return null!==(t=e.show)&&void 0!==t?t:"details"})),J=e=>{var t;const n=e.hosts,{selected_endpoint:a}=B(e);return(null===(t=n.find((e=>e.metadata.agent.id===a)))||void 0===t?void 0:t.metadata.elastic.agent.id)||""},Y=Object(o.createSelector)((e=>e.hostStatus),(e=>e||c.d.UNHEALTHY)),K=Object(o.createSelector)((e=>e.policyResponse),(e=>{var t,n,a;return e&&(null==e||null===(t=e.Endpoint)||void 0===t||null===(n=t.policy)||void 0===n||null===(a=n.applied)||void 0===a?void 0:a.status)||""})),X=e=>e.nonExistingPolicies,Z=e=>e.agentPolicies,ee=e=>e.endpointsExist,te=Object(o.createSelector)(B,(({admin_query:e})=>{const t={query:"",language:"kuery"};if(e){const n=Object(s.decode)(e);n&&"string"==typeof n.query&&(t.query=n.query),!n||"string"!=typeof n.language||"kuery"!==n.language&&"lucene"!==n.language||(t.language=n.language)}return t})),ne=e=>e.isolationRequestState,ae=Object(o.createSelector)(ne,(e=>Object(p.i)(e))),ie=Object(o.createSelector)(ne,(e=>Object(p.h)(e))),oe=Object(o.createSelector)(ne,(e=>{if(Object(p.g)(e))return e.error})),re=Object(o.createSelector)(B,(e=>e.show===g.b.activityLog)),se=e=>e.endpointDetails.activityLog.paging,ce=e=>e.endpointDetails.activityLog.logData,de=Object(o.createSelector)(ce,(e=>{var t;return null===(t=Object(p.f)(e))||void 0===t?void 0:t.data})),le=Object(o.createSelector)(ce,(e=>Object(p.j)(e))),pe=Object(o.createSelector)(ce,(e=>Object(p.i)(e))),ue=Object(o.createSelector)(ce,(e=>Object(p.h)(e))),ge=Object(o.createSelector)(ce,(e=>Object(p.h)(e)?e.data.data:[])),ye=Object(o.createSelector)(ce,(e=>{if(Object(p.g)(e))return e.error})),fe=Object(o.createSelector)(le,de,ye,((e,t,n)=>e||!n&&!(null==t||!t.data.length))),be=Object(o.createSelector)(O,(e=>e&&Object(u.b)(e)||!1)),ve=e=>e.endpointPendingActions,me=Object(o.createSelector)(ve,(e=>t=>{let n=0,a=0;if(Object(p.h)(e)){const r=e.data.get(t.elastic.agent.id);var i,o;r&&(n=null!==(i=null==r?void 0:r.isolate)&&void 0!==i?i:0,a=null!==(o=null==r?void 0:r.unisolate)&&void 0!==o?o:0)}return{isIsolated:Object(u.b)(t),pendingIsolate:n,pendingUnIsolate:a}})),he=e=>e.metadataTransformStats,Oe=e=>Object(p.h)(e.metadataTransformStats)?e.metadataTransformStats.data:[],je=e=>Object(p.i)(e.metadataTransformStats)},240:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return h}));var a=n(42),i=n(5),o=n.n(i),r=n(176),s=n(199);function c(e){return Object(a.useSelector)((function(t){return e(t[s.t][s.s])}))}n(18);var d=n(165),l=n(603),p=n(200),u=n(1),g=n(206),y=n(226),f=n(91),b=n(261),v=n(76),m=n(544);const h=e=>{const t=Object(v.b)().isPlatinumPlus(),{getAppUrl:n}=Object(f.b)(),a=c(y.agentPolicies),s=c(y.uiQueryParams),h=Object(l.b)(),O=Object(p.a)("responseActionsConsoleEnabled");return Object(i.useMemo)((()=>{if(e){const i=Object(b.b)(e),c=e.agent.id,l=e.Endpoint.policy.applied.id,p=e.host.hostname,y=e.elastic.agent.id,f=Object(m.a)({osName:e.host.os.name,version:e.agent.version,capabilities:e.Endpoint.capabilities}),{show:v,selected_endpoint:j,...E}=s,S=Object(g.d)({name:"endpointIsolate",...E,selected_endpoint:c}),D=Object(g.d)({name:"endpointUnIsolate",...E,selected_endpoint:c}),w=[];return i?w.push({"data-test-subj":"unIsolateLink",icon:"lockOpen",key:"unIsolateHost",navigateAppId:u.y,navigateOptions:{path:D},href:n({path:D}),children:o.a.createElement(d.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.unIsolateHost",defaultMessage:"Release host"})}):t&&f&&w.push({"data-test-subj":"isolateLink",icon:"lock",key:"isolateHost",navigateAppId:u.y,navigateOptions:{path:S},href:n({path:S}),children:o.a.createElement(d.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.isolateHost",defaultMessage:"Isolate host"})}),[...w,...O?[{"data-test-subj":"console",icon:"console",key:"consoleLink",onClick:t=>{t.preventDefault(),h(e)},children:o.a.createElement(d.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.console",defaultMessage:"Launch responder"})}]:[],{"data-test-subj":"hostLink",icon:"logoSecurity",key:"hostDetailsLink",navigateAppId:u.y,navigateOptions:{path:`/hosts/${p}`},href:n({path:`/hosts/${p}`}),children:o.a.createElement(d.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.hostDetails",defaultMessage:"View host details"})},{icon:"gear",key:"agentConfigLink","data-test-subj":"agentPolicyLink",navigateAppId:"fleet",navigateOptions:{path:`${r.pagePathGetters.policy_details({policyId:a[l]})[1]}`},href:`${n({appId:"fleet"})}${r.pagePathGetters.policy_details({policyId:a[l]})[1]}`,disabled:void 0===a[l],children:o.a.createElement(d.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.agentPolicy",defaultMessage:"View agent policy"})},{icon:"gear",key:"agentDetailsLink","data-test-subj":"agentDetailsLink",navigateAppId:"fleet",navigateOptions:{path:`${r.pagePathGetters.agent_details({agentId:y})[1]}`},href:`${n({appId:"fleet"})}${r.pagePathGetters.agent_details({agentId:y})[1]}`,children:o.a.createElement(d.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.agentDetails",defaultMessage:"View agent details"})},{icon:"gear",key:"agentPolicyReassignLink","data-test-subj":"agentPolicyReassignLink",navigateAppId:"fleet",navigateOptions:{path:`${r.pagePathGetters.agent_details({agentId:y})[1]}?openReassignFlyout=true`},href:`${n({appId:"fleet"})}${r.pagePathGetters.agent_details({agentId:y})[1]}?openReassignFlyout=true`,children:o.a.createElement(d.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.agentPolicyReassign",defaultMessage:"Reassign agent policy"})}]}return[]}),[s,e,a,n,t,O,h])}},256:function(e,t,n){"use strict";n.d(t,"k",(function(){return a})),n.d(t,"l",(function(){return i})),n.d(t,"i",(function(){return o})),n.d(t,"f",(function(){return r})),n.d(t,"e",(function(){return s})),n.d(t,"h",(function(){return c})),n.d(t,"c",(function(){return d})),n.d(t,"g",(function(){return l})),n.d(t,"j",(function(){return p})),n.d(t,"d",(function(){return u})),n.d(t,"b",(function(){return g})),n.d(t,"a",(function(){return y}));const a="metrics-endpoint.metadata_current_*",i="endpoint.metadata_current-default",o=".metrics-endpoint.metadata_united_default",r="/api/endpoint/metadata",s="/api/endpoint/metadata/{id}",c="/api/endpoint/metadata/transforms",d="/api/endpoint/policy_response",l="/api/endpoint/isolate",p="/api/endpoint/unisolate",u="/api/endpoint/action_log/{agent_id}",g="/api/endpoint/action_status",y="/api/endpoint/action/{action_id}"},287:function(e,t,n){"use strict";n.d(t,"d",(function(){return d})),n.d(t,"i",(function(){return l})),n.d(t,"g",(function(){return p})),n.d(t,"h",(function(){return u})),n.d(t,"c",(function(){return g})),n.d(t,"a",(function(){return y})),n.d(t,"b",(function(){return f})),n.d(t,"e",(function(){return b})),n.d(t,"f",(function(){return v}));var a=n(48),i=n(1),o=n(256),r=n(18),s=n(362),c=n(329);const d=async({query:e,signal:t})=>r.b.get().http.fetch(i.kb,{method:"POST",body:JSON.stringify(e),signal:t}),l=async({query:e,status:t,signal:n})=>r.b.get().http.fetch(i.ob,{method:"POST",body:JSON.stringify({conflicts:"proceed",status:t,...e}),signal:n}),p=async({signal:e})=>r.b.get().http.fetch(i.fb,{method:"GET",signal:e}),u=async({signal:e})=>r.b.get().http.fetch(i.jb,{method:"GET",signal:e}),g=async({signal:e})=>r.b.get().http.fetch(i.fb,{method:"POST",signal:e}),y=async({endpointId:e,comment:t="",caseIds:n})=>Object(s.a)({endpoint_ids:[e],comment:t,case_ids:n}),f=async({endpointId:e,comment:t="",caseIds:n})=>Object(s.b)({endpoint_ids:[e],comment:t,case_ids:n}),b=async({alertId:e,owner:t})=>r.b.get().http.fetch(Object(a.getCasesFromAlertsUrl)(e),{method:"get",query:{...t.length>0?{owner:t}:{}}}),v=async({agentId:e,signal:t})=>r.b.get().http.fetch(Object(c.a)(o.e,{id:e}),{method:"GET",signal:t})},302:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(5),i=n(58);const o=(e,t)=>{const n=Object(i.useHistory)();return Object(a.useCallback)((a=>{try{t&&t(a)}catch(e){throw a.preventDefault(),e}a.defaultPrevented||0===a.button&&(a.currentTarget instanceof HTMLAnchorElement&&""!==a.currentTarget.target&&"_self"!==a.currentTarget.target||a.metaKey||a.altKey||a.ctrlKey||a.shiftKey||(a.preventDefault(),Array.isArray(e)?n.push(...e):n.push(e)))}),[n,t,e])}},307:function(e,t,n){"use strict";n.d(t,"j",(function(){return a})),n.d(t,"i",(function(){return i})),n.d(t,"h",(function(){return o})),n.d(t,"g",(function(){return r})),n.d(t,"f",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return u}));const a=e=>"UninitialisedResourceState"===e.type,i=e=>"LoadingResourceState"===e.type,o=e=>"LoadedResourceState"===e.type,r=e=>"FailedResourceState"===e.type,s=e=>o(e)?e:i(e)&&void 0!==e.previousState?s(e.previousState):r(e)?e.lastLoadedState:void 0,c=()=>({type:"UninitialisedResourceState"}),d=e=>({type:"LoadingResourceState",previousState:e}),l=e=>({type:"LoadedResourceState",data:e}),p=(e,t)=>({type:"FailedResourceState",error:e,lastLoadedState:t}),u=e=>{switch(e.type){case"LoadedResourceState":case"FailedResourceState":return e;case"UninitialisedResourceState":case"LoadingResourceState":return c()}}},311:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c}));var a=n(222);const i=()=>({windows:{events:{dll_and_driver_load:!0,dns:!0,file:!0,network:!0,process:!0,registry:!0,security:!0},malware:{mode:a.g.prevent,blocklist:!0},ransomware:{mode:a.g.prevent,supported:!0},memory_protection:{mode:a.g.prevent,supported:!0},behavior_protection:{mode:a.g.prevent,supported:!0},popup:{malware:{message:"",enabled:!0},ransomware:{message:"",enabled:!0},memory_protection:{message:"",enabled:!0},behavior_protection:{message:"",enabled:!0}},logging:{file:"info"},antivirus_registration:{enabled:!1}},mac:{events:{process:!0,file:!0,network:!0},malware:{mode:a.g.prevent,blocklist:!0},behavior_protection:{mode:a.g.prevent,supported:!0},memory_protection:{mode:a.g.prevent,supported:!0},popup:{malware:{message:"",enabled:!0},behavior_protection:{message:"",enabled:!0},memory_protection:{message:"",enabled:!0}},logging:{file:"info"}},linux:{events:{process:!0,file:!0,network:!0,session_data:!1},malware:{mode:a.g.prevent,blocklist:!0},behavior_protection:{mode:a.g.prevent,supported:!0},memory_protection:{mode:a.g.prevent,supported:!0},popup:{malware:{message:"",enabled:!0},behavior_protection:{message:"",enabled:!0},memory_protection:{message:"",enabled:!0}},logging:{file:"info"}}}),o=(e=i())=>({...e,windows:{...e.windows,ransomware:{mode:a.g.off,supported:!1},memory_protection:{mode:a.g.off,supported:!1},behavior_protection:{mode:a.g.off,supported:!1},popup:{...e.windows.popup,malware:{message:"",enabled:!0},ransomware:{message:"",enabled:!1},memory_protection:{message:"",enabled:!1},behavior_protection:{message:"",enabled:!1}}},mac:{...e.mac,behavior_protection:{mode:a.g.off,supported:!1},memory_protection:{mode:a.g.off,supported:!1},popup:{...e.mac.popup,malware:{message:"",enabled:!0},memory_protection:{message:"",enabled:!1},behavior_protection:{message:"",enabled:!1}}},linux:{...e.linux,behavior_protection:{mode:a.g.off,supported:!1},memory_protection:{mode:a.g.off,supported:!1},popup:{...e.linux.popup,malware:{message:"",enabled:!0},memory_protection:{message:"",enabled:!1},behavior_protection:{message:"",enabled:!1}}}}),r=(e=i())=>({...e,windows:{...e.windows,ransomware:{...e.windows.ransomware,supported:!0},memory_protection:{...e.windows.memory_protection,supported:!0},behavior_protection:{...e.windows.behavior_protection,supported:!0}},mac:{...e.mac,behavior_protection:{...e.windows.behavior_protection,supported:!0},memory_protection:{...e.mac.memory_protection,supported:!0}},linux:{...e.linux,behavior_protection:{...e.windows.behavior_protection,supported:!0},memory_protection:{...e.linux.memory_protection,supported:!0}}}),s="Elastic Security {action} {filename}",c="Elastic Security {action} {rule}"},329:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=(e,t)=>Object.keys(t).reduce(((e,n)=>e.replace(new RegExp(`{${n}}`,"g"),String(t[n]))),e)},357:function(e,t,n){"use strict";n.d(t,"j",(function(){return l})),n.d(t,"k",(function(){return u})),n.d(t,"h",(function(){return g})),n.d(t,"f",(function(){return y})),n.d(t,"g",(function(){return f})),n.d(t,"l",(function(){return b})),n.d(t,"c",(function(){return m})),n.d(t,"i",(function(){return E})),n.d(t,"d",(function(){return S})),n.d(t,"e",(function(){return D})),n.d(t,"b",(function(){return w})),n.d(t,"a",(function(){return R})),n.d(t,"m",(function(){return L}));var a=n(58),i=n(12),o=n(106),r=n(311),s=n(199),c=n(434),d=n(404);const l=e=>e.policyItem,p=Object(i.createSelector)(l,(e=>e.license),((e,t)=>{if(e){const n=((e,t)=>Object(o.b)(t,"platinum")?Object(r.d)(e):Object(r.e)(e))(e.inputs[0].config.policy.value,t);return{...e,inputs:[{...e.inputs[0],config:{...e.inputs[0].config,policy:{...e.inputs[0].config.policy,value:n}}}]}}return e})),u=Object(i.createSelector)(p,(e=>{if(e)return Object(c.a)(e)})),g=e=>!e.policyItem&&!e.apiError,y=e=>Object(d.e)(e)||Object(d.f)(e)||Object(d.d)(e)||Object(d.c)(e)||Object(d.b)(e),f=e=>e.license,b=Object(i.createSelector)((e=>e.location),(e=>{var t,n,i,o;return null!==(t=null===(n=Object(a.matchPath)(null!==(o=null==e?void 0:e.pathname)&&void 0!==o?o:"",{path:[s.n,s.q,s.m,s.o,s.l],exact:!0}))||void 0===n||null===(i=n.params)||void 0===i?void 0:i.policyId)&&void 0!==t?t:""})),v=Object(r.c)(),m=Object(i.createSelector)(p,(e=>{var t,n,a,i;return null!==(t=null==e||null===(n=e.inputs[0])||void 0===n||null===(a=n.config)||void 0===a||null===(i=a.policy)||void 0===i?void 0:i.value)&&void 0!==t?t:v})),h=Object(i.createSelector)(m,(e=>null==e?void 0:e.windows)),O=Object(i.createSelector)(m,(e=>null==e?void 0:e.mac)),j=Object(i.createSelector)(m,(e=>null==e?void 0:e.linux)),E=Object(i.createSelector)(h,O,j,((e,t,n)=>({windows:{advanced:e.advanced,events:e.events,malware:e.malware,ransomware:e.ransomware,memory_protection:e.memory_protection,behavior_protection:e.behavior_protection,popup:e.popup,antivirus_registration:e.antivirus_registration},mac:{advanced:t.advanced,events:t.events,malware:t.malware,behavior_protection:t.behavior_protection,memory_protection:t.memory_protection,popup:t.popup},linux:{advanced:n.advanced,events:n.events,malware:n.malware,behavior_protection:n.behavior_protection,memory_protection:n.memory_protection,popup:n.popup}}))),S=Object(i.createSelector)(E,(e=>e.windows.antivirus_registration.enabled)),D=e=>e.isLoading,w=e=>e.apiError,R=e=>e.agentStatusSummary,L=e=>e.updateStatus},362:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return r}));var a=n(18),i=n(256);const o=async e=>a.b.get().http.post(i.g,{body:JSON.stringify(e)}),r=async e=>a.b.get().http.post(i.j,{body:JSON.stringify(e)})},385:function(e,t,n){const a=n(264);e.exports=(e,t,n)=>a(e,t,n)>=0},404:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return d})),n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return p})),n.d(t,"b",(function(){return u}));var a=n(58),i=n(12),o=n(199);const r=e=>e.artifacts.location,s=e=>{var t;return null===(t=e.location)||void 0===t?void 0:t.pathname},c=Object(i.createSelector)(s,(e=>null!==Object(a.matchPath)(null!=e?e:"",{path:o.n,exact:!0}))),d=Object(i.createSelector)(s,(e=>null!==Object(a.matchPath)(null!=e?e:"",{path:o.q,exact:!0}))),l=Object(i.createSelector)(s,(e=>null!==Object(a.matchPath)(null!=e?e:"",{path:o.m,exact:!0}))),p=Object(i.createSelector)(s,(e=>null!==Object(a.matchPath)(null!=e?e:"",{path:o.o,exact:!0}))),u=Object(i.createSelector)(s,(e=>null!==Object(a.matchPath)(null!=e?e:"",{path:o.l,exact:!0})))},420:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c}));var a=n(95),i=n.n(a),o=n(51),r=n.n(o);const s=(e,t)=>null!=t&&!(e.id===t.endpoint.id&&t.agent.configured.id===t.agent.applied.id&&e.version>=t.agent.applied.revision&&e.version>=t.agent.configured.revision&&e.endpoint_policy_version>=t.endpoint.revision),c=({startDate:e,endDate:t})=>{const n=r()(i.a.parse(e)),a=r()(i.a.parse(t));return!(!n.isValid()||!a.isValid())&&n.isAfter(a)}},426:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return y})),n.d(t,"a",(function(){return p}));var a=n(311),i=n(357),o=n(378),r=n(434);const s=e=>{const t={coreStart:e};return e=>n=>async s=>{n(s),(async({coreStart:e},{dispatch:t,getState:n},s)=>{const c=e.http,d=n();if("userChangedUrl"===s.type&&Object(i.h)(d)&&Object(i.f)(d)){const e=Object(i.l)(d);let n;try{n=(await Object(o.f)(c,e)).item,""===n.inputs[0].config.policy.value.windows.popup.malware.message&&(n.inputs[0].config.policy.value.windows.popup.malware.message=a.a,n.inputs[0].config.policy.value.mac.popup.malware.message=a.a,n.inputs[0].config.policy.value.linux.popup.malware.message=a.a),""===n.inputs[0].config.policy.value.windows.popup.ransomware.message&&(n.inputs[0].config.policy.value.windows.popup.ransomware.message=a.a),""===n.inputs[0].config.policy.value.windows.popup.memory_protection.message&&(n.inputs[0].config.policy.value.windows.popup.memory_protection.message=a.b),""===n.inputs[0].config.policy.value.mac.popup.memory_protection.message&&(n.inputs[0].config.policy.value.mac.popup.memory_protection.message=a.b),""===n.inputs[0].config.policy.value.linux.popup.memory_protection.message&&(n.inputs[0].config.policy.value.linux.popup.memory_protection.message=a.b),""===n.inputs[0].config.policy.value.windows.popup.behavior_protection.message&&(n.inputs[0].config.policy.value.windows.popup.behavior_protection.message=a.b),""===n.inputs[0].config.policy.value.mac.popup.behavior_protection.message&&(n.inputs[0].config.policy.value.mac.popup.behavior_protection.message=a.b),""===n.inputs[0].config.policy.value.linux.popup.behavior_protection.message&&(n.inputs[0].config.policy.value.linux.popup.behavior_protection.message=a.b)}catch(e){return void t({type:"serverFailedToReturnPolicyDetailsData",payload:e.body||e})}if(t({type:"serverReturnedPolicyDetailsData",payload:{policyItem:n}}),n.policy_id){const{results:e}=await Object(o.d)(c,n.policy_id);t({type:"serverReturnedPolicyDetailsAgentSummaryData",payload:{agentStatusSummary:e}})}}else if("userClickedPolicyDetailsSaveButton"===s.type){const{id:e}=Object(i.j)(d),n=Object(i.k)(d);let a;try{a=await Object(o.g)(c,e,n).catch((t=>t.response&&409===t.response.status?Object(o.f)(c,e).then((t=>{const a=t.item;return a.inputs[0].config.policy=n.inputs[0].config.policy,Object(o.g)(c,e,Object(r.a)(a))})):Promise.reject(t)))}catch(e){return void t({type:"serverReturnedPolicyDetailsUpdateFailure",payload:{success:!1,error:e.body||e}})}t({type:"serverReturnedUpdatedPolicyDetailsData",payload:{policyItem:a.item,updateStatus:{success:!0}}})}})(t,e,s)}};var c=n(337),d=n(206),l=n(199);const p=()=>({policyItem:void 0,isLoading:!1,agentStatusSummary:{error:0,events:0,offline:0,online:0,total:0,other:0},artifacts:{location:{page:l.b,pageSize:l.c,show:void 0,filter:""}}}),u=(e,t)=>({...e,inputs:e.inputs.map((e=>({...e,config:e.config&&{...e.config,policy:{...e.config.policy,value:t}}})))}),g=(e=p(),t)=>{if("serverReturnedPolicyDetailsData"===t.type||"serverReturnedUpdatedPolicyDetailsData"===t.type)return{...e,...t.payload,isLoading:!1};if("serverFailedToReturnPolicyDetailsData"===t.type)return{...e,isLoading:!1,apiError:t.payload};if("serverReturnedPolicyDetailsAgentSummaryData"===t.type)return{...e,...t.payload};if("serverReturnedPolicyDetailsUpdateFailure"===t.type)return{...e,isLoading:!1,updateStatus:t.payload};if("userClickedPolicyDetailsSaveButton"===t.type)return{...e,isLoading:!0,updateApiError:void 0};if("licenseChanged"===t.type)return{...e,license:t.payload};if("userChangedUrl"===t.type){const n={...e,location:t.payload,artifacts:{...e.artifacts,location:Object(d.b)(Object(c.parse)(t.payload.search.slice(1)))}},a=Object(i.f)(n),o=Object(i.f)(e),r=Object(i.g)(n);return a?o?n:{...n,isLoading:!0}:{...p(),location:t.payload,license:r}}if("userChangedPolicyConfig"===t.type){if(!e.policyItem)return e;const n={...e,policyItem:{...e.policyItem}},a={...Object(i.c)(e)};return n.policyItem.inputs[0].config.policy.value=a,Object.entries(t.payload.policyConfig).forEach((([e,t])=>{a[e]={...a[e],...t}})),n}if("userChangedAntivirusRegistration"===t.type){if(e.policyItem){const n=Object(i.c)(e);return{...e,policyItem:u(e.policyItem,{...n,windows:{...n.windows,antivirus_registration:{enabled:t.payload.enabled}}})}}return e}return e},y=(e=p(),t)=>[g].reduce(((e,n)=>n(e,t)),e)},434:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(6);const i=e=>{const{id:t,revision:n,created_by:i,created_at:o,updated_by:r,updated_at:s,...c}=e,d=Object(a.cloneDeep)(c),l=d.inputs[0].config.policy.value;return[l.windows.popup.malware,l.mac.popup.malware].forEach((e=>e.message.trim())),d}},481:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return p}));var a=n(5),i=n.n(a),o=n(16),r=n(498),s=n(302),c=n(18);let d;!function(e){e.overview="details",e.activityLog="activity_log"}(d||(d={}));const l=Object(a.memo)((({tab:e,isSelected:t})=>{const{getAppUrl:n}=Object(c.d)(),a=Object(s.a)(e.route);return i.a.createElement(o.EuiTab,{href:n({path:e.route}),onClick:a,isSelected:t,key:e.id,"data-test-subj":e.id},e.name)}));l.displayName="EndpointDetailsTab";const p=Object(a.memo)((({hostname:e,show:t,tabs:n})=>{const s=Object(a.useMemo)((()=>n.find((e=>e.id===t))),[n,t]),c=n.map((e=>i.a.createElement(l,{key:e.id,tab:e,isSelected:e.id===(null==s?void 0:s.id)})));return i.a.createElement(i.a.Fragment,null,i.a.createElement(r.a,{hostname:e,hasBorder:!0},i.a.createElement(o.EuiTabs,{bottomBorder:!1,style:{marginBottom:"-25px"}},c)),i.a.createElement(o.EuiFlyoutBody,{"data-test-subj":"endpointDetailsFlyoutBody"},null==s?void 0:s.content))}));p.displayName="EndpointDetailsFlyoutTabs"},498:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(5),i=n.n(a),o=n(16),r=n(240),s=n(226),c=n(4),d=n(206),l=n(302),p=n(91);const u=Object(a.memo)((({endpointId:e})=>{var t;const{getAppUrl:n}=Object(p.b)(),{show:u,...g}=Object(r.b)(s.uiQueryParams),y=Object(a.useMemo)((()=>Object(d.d)({name:"endpointDetails",...g,selected_endpoint:e})),[g,e]),f=Object(l.a)(y),b=Object(a.useMemo)((()=>({title:c.i18n.translate("xpack.securitySolution.endpoint.policyResponse.backLinkTitle",{defaultMessage:"Endpoint details"}),href:n({path:y}),onClick:f})),[f,n,y]);return i.a.createElement("div",null,i.a.createElement(o.EuiButtonEmpty,{flush:"both","data-test-subj":"flyoutSubHeaderBackButton",iconType:"arrowLeft",size:"xs",href:null!==(t=null==b?void 0:b.href)&&void 0!==t?t:"",onClick:null==b?void 0:b.onClick},null==b?void 0:b.title))}));u.displayName="BackToEndpointDetailsFlyoutSubHeader";const g=Object(a.memo)((({endpointId:e,hasBorder:t=!1,hostname:n,children:a})=>{const c=Object(r.b)(s.detailsLoading);return i.a.createElement(o.EuiFlyoutHeader,{hasBorder:t},e&&i.a.createElement(u,{endpointId:e}),c?i.a.createElement(o.EuiLoadingContent,{lines:1}):i.a.createElement(o.EuiToolTip,{content:n,anchorClassName:"eui-textTruncate"},i.a.createElement(o.EuiTitle,{size:"s"},i.a.createElement("h2",{style:{overflow:"hidden",textOverflow:"ellipsis"},"data-test-subj":"endpointDetailsFlyoutTitle"},n))),a)}));g.displayName="EndpointDetailsFlyoutHeader"},563:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(5),i=n.n(a),o=n(215);class SecuritySolutionQueryClient extends o.QueryClient{constructor(e={}){var t,n,a;super({...e,defaultOptions:{...null!==(t=e.defaultOptions)&&void 0!==t?t:{},queries:{refetchIntervalInBackground:!1,refetchOnWindowFocus:!1,refetchOnMount:!0,keepPreviousData:!0,...null!==(n=null==e||null===(a=e.defaultOptions)||void 0===a?void 0:a.queries)&&void 0!==n?n:{}}}})}}const r=Object(a.memo)((({queryClient:e,children:t})=>{const n=Object(a.useMemo)((()=>e||new SecuritySolutionQueryClient),[e]);return i.a.createElement(o.QueryClientProvider,{client:n},t)}));r.displayName="ReactQueryClientProvider"},585:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(5),i=n.n(a),o=n(42),r=n(76);const s=Object(a.memo)((({children:e})=>{const t=Object(o.useDispatch)();return Object(a.useEffect)((()=>{var e;const n=null===(e=r.a.getLicenseInformation$())||void 0===e?void 0:e.subscribe((e=>{t({type:"licenseChanged",payload:e})}));return()=>null==n?void 0:n.unsubscribe()}),[t]),i.a.createElement(i.a.Fragment,null,e)}));s.displayName="CurrentLicense"},612:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(52),i=n(426),o=n(199),r=n(226),s=n(307);const c=()=>({hosts:[],pageSize:10,pageIndex:0,total:0,loading:!1,error:void 0,endpointDetails:{activityLog:{paging:{disabled:!1,page:1,pageSize:50,startDate:"now-1d",endDate:"now",isInvalidDateRange:!1,autoRefreshOptions:{enabled:!1,duration:o.a},recentlyUsedDateRanges:[]},logData:Object(s.e)()},hostDetails:{details:void 0,detailsLoading:!1,detailsError:void 0}},policyResponse:void 0,policyResponseLoading:!1,policyResponseError:void 0,location:void 0,policyItems:[],selectedPolicyId:void 0,policyItemsLoading:!1,endpointPackageInfo:Object(s.e)(),nonExistingPolicies:{},agentPolicies:{},endpointsExist:!0,patterns:[],patternsError:void 0,isAutoRefreshEnabled:!0,autoRefreshInterval:o.a,agentsWithEndpointsTotal:0,agentsWithEndpointsTotalError:void 0,endpointsTotal:0,endpointsTotalError:void 0,policyVersionInfo:void 0,hostStatus:void 0,isolationRequestState:Object(s.e)(),endpointPendingActions:Object(s.c)(new Map),metadataTransformStats:Object(s.e)()}),d=a.combineReducers,l=(o.u,Object(i.a)(),o.s,c(),d({[o.u]:i.c,[o.s]:(e=c(),t)=>{if("serverReturnedEndpointList"===t.type){const{data:n,total:a,page:i,pageSize:o}=t.payload;return{...e,hosts:n,total:a,pageIndex:i,pageSize:o,loading:!1,error:void 0}}if("serverFailedToReturnEndpointList"===t.type)return{...e,error:t.payload,loading:!1};if("serverReturnedEndpointNonExistingPolicies"===t.type)return{...e,nonExistingPolicies:{...e.nonExistingPolicies,...t.payload}};if("serverReturnedEndpointAgentPolicies"===t.type)return{...e,agentPolicies:{...e.agentPolicies,...t.payload}};if("serverReturnedMetadataPatterns"===t.type)return{...e,patterns:t.payload,patternsError:void 0};if("serverFailedToReturnMetadataPatterns"===t.type)return{...e,patternsError:t.payload};if("serverReturnedEndpointDetails"===t.type)return{...e,endpointDetails:{...e.endpointDetails,hostDetails:{...e.endpointDetails.hostDetails,details:t.payload.metadata,detailsLoading:!1,detailsError:void 0}},policyVersionInfo:t.payload.policy_info,hostStatus:t.payload.host_status};if("serverFailedToReturnEndpointDetails"===t.type)return{...e,endpointDetails:{...e.endpointDetails,hostDetails:{...e.endpointDetails.hostDetails,detailsError:t.payload,detailsLoading:!1}}};if("endpointDetailsActivityLogUpdatePaging"===t.type||"endpointDetailsActivityLogUpdateIsInvalidDateRange"===t.type||"userUpdatedActivityLogRefreshOptions"===t.type)return{...e,endpointDetails:{...e.endpointDetails,activityLog:{...e.endpointDetails.activityLog,paging:{...e.endpointDetails.activityLog.paging,...t.payload}}}};if("userUpdatedActivityLogRecentlyUsedDateRanges"===t.type)return{...e,endpointDetails:{...e.endpointDetails,activityLog:{...e.endpointDetails.activityLog,paging:{...e.endpointDetails.activityLog.paging,recentlyUsedDateRanges:t.payload}}}};if("endpointDetailsActivityLogChanged"===t.type)return((e,t)=>{const n="LoadedResourceState"===t.payload.type?{...e.endpointDetails.activityLog,paging:{...e.endpointDetails.activityLog.paging,page:t.payload.data.page,pageSize:t.payload.data.pageSize,startDate:t.payload.data.startDate,endDate:t.payload.data.endDate}}:{...e.endpointDetails.activityLog};return{...e,endpointDetails:{...e.endpointDetails,activityLog:{...n,logData:t.payload}}}})(e,t);if("endpointPendingActionsStateChanged"===t.type)return((e,t)=>Object(r.isOnEndpointPage)(e)?{...e,endpointPendingActions:t.payload}:e)(e,t);if("serverReturnedPoliciesForOnboarding"===t.type)return{...e,policyItems:t.payload.policyItems,policyItemsLoading:!1};if("serverFailedToReturnPoliciesForOnboarding"===t.type)return{...e,error:t.payload,policyItemsLoading:!1};if("serverReturnedEndpointPolicyResponse"===t.type)return{...e,policyResponse:t.payload.policy_response,policyResponseLoading:!1,policyResponseError:void 0};if("serverFailedToReturnEndpointPolicyResponse"===t.type)return{...e,policyResponseError:t.payload,policyResponseLoading:!1};if("userSelectedEndpointPolicy"===t.type)return{...e,selectedPolicyId:t.payload.selectedPolicyId,policyResponseLoading:!1};if("serverCancelledEndpointListLoading"===t.type)return{...e,loading:!1};if("serverCancelledPolicyItemsLoading"===t.type)return{...e,policyItemsLoading:!1};if("endpointPackageInfoStateChanged"===t.type)return((e,t)=>({...e,endpointPackageInfo:t.payload}))(e,t);if("serverReturnedEndpointExistValue"===t.type)return{...e,endpointsExist:t.payload};if("serverReturnedAgenstWithEndpointsTotal"===t.type)return{...e,agentsWithEndpointsTotal:t.payload,agentsWithEndpointsTotalError:void 0};if("serverFailedToReturnAgenstWithEndpointsTotal"===t.type)return{...e,agentsWithEndpointsTotalError:t.payload};if("serverReturnedEndpointsTotal"===t.type)return{...e,endpointsTotal:t.payload,endpointsTotalError:void 0};if("serverFailedToReturnEndpointsTotal"===t.type)return{...e,endpointsTotalError:t.payload};var n,a;if("userUpdatedEndpointListRefreshOptions"===t.type)return{...e,isAutoRefreshEnabled:null!==(n=t.payload.isAutoRefreshEnabled)&&void 0!==n?n:e.isAutoRefreshEnabled,autoRefreshInterval:null!==(a=t.payload.autoRefreshInterval)&&void 0!==a?a:e.autoRefreshInterval};if("endpointIsolationRequestStateChange"===t.type)return((e,t)=>({...e,isolationRequestState:t.payload}))(e,t);if("userChangedUrl"===t.type){const n={...e,location:t.payload},a=Object(r.isOnEndpointPage)(n)&&!Object(r.hasSelectedEndpoint)(n),i=Object(r.isOnEndpointPage)(e)&&!Object(r.hasSelectedEndpoint)(e),c=Object(r.isOnEndpointPage)(n)&&Object(r.hasSelectedEndpoint)(n),d=Object(r.isOnEndpointPage)(e)&&Object(r.hasSelectedEndpoint)(e),l=Object(r.isOnEndpointPage)(e)&&Object(r.hasSelectedEndpoint)(e)&&Object(r.getIsOnEndpointDetailsActivityLog)(e),p=Object(r.isOnEndpointPage)(n)&&Object(r.hasSelectedEndpoint)(n)&&Object(r.getIsOnEndpointDetailsActivityLog)(n)||l&&Object(r.uiQueryParams)(e).selected_endpoint===Object(r.uiQueryParams)(n).selected_endpoint,u={location:t.payload,error:void 0,policyResponseError:void 0},g={logData:Object(s.e)(),paging:{disabled:!1,isInvalidDateRange:!1,page:1,pageSize:50,startDate:"now-1d",endDate:"now",autoRefreshOptions:{enabled:!1,duration:o.a},recentlyUsedDateRanges:[]}};if("isolate"===Object(r.uiQueryParams)(n).show||Object(s.j)(Object(r.getCurrentIsolationRequestState)(n))||(u.isolationRequestState=Object(s.e)()),a){if(!i)return{...e,...u,endpointDetails:{...e.endpointDetails,activityLog:{...g,paging:{...g.paging,startDate:e.endpointDetails.activityLog.paging.startDate,endDate:e.endpointDetails.activityLog.paging.endDate,recentlyUsedDateRanges:e.endpointDetails.activityLog.paging.recentlyUsedDateRanges}},hostDetails:{...e.endpointDetails.hostDetails,detailsError:void 0}},loading:!0,policyItemsLoading:!0}}else if(c)return d||i?{...e,...u,endpointDetails:{...e.endpointDetails,activityLog:{...g,paging:{...g.paging,startDate:e.endpointDetails.activityLog.paging.startDate,endDate:e.endpointDetails.activityLog.paging.endDate,recentlyUsedDateRanges:e.endpointDetails.activityLog.paging.recentlyUsedDateRanges}},hostDetails:{...e.endpointDetails.hostDetails,detailsLoading:!p,detailsError:void 0}},detailsLoading:!0,policyResponseLoading:!0}:{...e,...u,endpointDetails:{...e.endpointDetails,activityLog:{...g,paging:{...g.paging,startDate:e.endpointDetails.activityLog.paging.startDate,endDate:e.endpointDetails.activityLog.paging.endDate,recentlyUsedDateRanges:e.endpointDetails.activityLog.paging.recentlyUsedDateRanges}},hostDetails:{...e.endpointDetails.hostDetails,detailsLoading:!0,detailsError:void 0}},loading:!0,policyResponseLoading:!0,policyItemsLoading:!0};return{...e,...u,endpointDetails:{...e.endpointDetails,activityLog:{...g,paging:{...g.paging,startDate:e.endpointDetails.activityLog.paging.startDate,endDate:e.endpointDetails.activityLog.paging.endDate,recentlyUsedDateRanges:e.endpointDetails.activityLog.paging.recentlyUsedDateRanges}},hostDetails:{...e.endpointDetails.hostDetails,detailsError:void 0}},endpointsExist:!0}}return"metadataTransformStatsChanged"===t.type?((e,t)=>({...e,metadataTransformStats:t.payload}))(e,t):e}}))},616:function(e,t,n){"use strict";n.d(t,"a",(function(){return L}));var a=n(73),i=n(199),o=n(426),r=n(385),s=n.n(r),c=n(173),d=n(256),l=n(362),p=n(495),u=n(329),g=n(548),y=n(307),f=n(378),b=n(420),v=n(226);const m=console.error,h=(e,t)=>{async function n(e){var n;const a=null!==(n=Object(v.endpointPackageVersion)(e))&&void 0!==n?n:"",i=a.includes("-")?a.substring(0,a.indexOf("-")):a,o=s()(i,"1.2.0")?d.i:d.k,{indexPatterns:r}=t.data;return[{title:o,fields:await r.getFieldsForWildcard({pattern:o})}]}return t=>a=>async i=>{a(i);const{getState:o,dispatch:r}=t;if(await async function(e,t,n){if(Object(v.getIsEndpointPackageInfoUninitialized)(e)){t({type:"endpointPackageInfoStateChanged",payload:Object(y.d)(Object(y.a)(Object(v.endpointPackageInfo)(e)))});try{const e=await Object(f.c)(n.http);t({type:"endpointPackageInfoStateChanged",payload:Object(y.c)(e)})}catch(e){m(e),t({type:"endpointPackageInfoStateChanged",payload:Object(y.b)(e)})}}}(o(),r,e),"userChangedUrl"!==i.type&&"appRequestedEndpointList"!==i.type||!Object(v.isOnEndpointPage)(o())||Object(v.hasSelectedEndpoint)(o())||await async function({store:e,coreStart:t,fetchIndexPatterns:n}){const{getState:a,dispatch:i}=e,{page_index:o,page_size:r}=Object(v.uiQueryParams)(a());let s;try{const n=Object(v.searchBarQuery)(a());s=await t.http.get(d.f,{query:{page:o,pageSize:r,kuery:n.query}}),i({type:"serverReturnedEndpointList",payload:s}),S(e);try{i({type:"serverReturnedEndpointsTotal",payload:await j(t.http)})}catch(e){i({type:"serverFailedToReturnEndpointsTotal",payload:e})}try{i({type:"serverReturnedAgenstWithEndpointsTotal",payload:(await Object(f.e)(t.http)).total})}catch(e){i({type:"serverFailedToReturnAgenstWithEndpointsTotal",payload:e})}w({http:t.http,hosts:s.data,store:e})}catch(e){i({type:"serverFailedToReturnEndpointList",payload:e})}if(0===Object(v.patterns)(a()).length)try{const e=await n(a());void 0!==e&&i({type:"serverReturnedMetadataPatterns",payload:e})}catch(e){i({type:"serverFailedToReturnMetadataPatterns",payload:e})}if(s&&0===s.data.length){const e=t.http;if(await(async e=>{try{return await j(e)>0}catch(e){m("error while trying to check if endpoints exist"),m(e)}return!1})(e))return;i({type:"serverReturnedEndpointExistValue",payload:!1});try{i({type:"serverReturnedPoliciesForOnboarding",payload:{policyItems:(await Object(g.a)(e,{query:{perPage:50,page:1}})).items}})}catch(e){var c;i({type:"serverFailedToReturnPoliciesForOnboarding",payload:null!==(c=e.body)&&void 0!==c?c:e})}}else i({type:"serverCancelledPolicyItemsLoading"}),i({type:"serverReturnedEndpointExistValue",payload:!0})}({coreStart:e,store:t,fetchIndexPatterns:n}),"userChangedUrl"===i.type&&Object(v.hasSelectedEndpoint)(o())){const{selected_endpoint:n}=Object(v.uiQueryParams)(o());await async function({coreStart:e,selectedEndpoint:t,store:n}){const{getState:a,dispatch:i}=n;if(i({type:"serverCancelledPolicyItemsLoading"}),0===Object(v.listData)(a()).length){const{page_index:t,page_size:o}=Object(v.uiQueryParams)(a());try{const a=await e.http.get(d.f,{query:{page:t,pageSize:o}});i({type:"serverReturnedEndpointList",payload:a}),w({http:e.http,hosts:a.data,store:n})}catch(e){i({type:"serverFailedToReturnEndpointList",payload:e})}}else i({type:"serverCancelledEndpointListLoading"});void 0!==t&&await D({store:n,coreStart:e,selectedEndpoint:t})}({store:t,coreStart:e,selectedEndpoint:n})}return"endpointDetailsLoad"===i.type&&await D({store:t,coreStart:e,selectedEndpoint:i.payload.endpointId}),"userChangedUrl"===i.type&&!0===Object(v.hasSelectedEndpoint)(o())&&Object(v.getIsOnEndpointDetailsActivityLog)(o())&&Object(v.getActivityLogIsUninitializedOrHasSubsequentAPIError)(o())&&await async function({store:e,coreStart:t}){const{getState:n,dispatch:a}=e;a({type:"endpointDetailsActivityLogChanged",payload:Object(y.d)(Object(y.a)(Object(v.getActivityLogData)(n())))});try{const{page:e,pageSize:i,startDate:o,endDate:r}=Object(v.getActivityLogDataPaging)(n()),s=Object(u.a)(d.d,{agent_id:Object(v.selectedAgent)(n())}),c=await t.http.get(s,{query:{page:e,page_size:i,start_date:o,end_date:r}});a({type:"endpointDetailsActivityLogChanged",payload:Object(y.c)(c)})}catch(e){var i;a({type:"endpointDetailsActivityLogChanged",payload:Object(y.b)(null!==(i=e.body)&&void 0!==i?i:e)})}}({store:t,coreStart:e}),"endpointDetailsActivityLogUpdatePaging"===i.type&&!Object(v.getActivityLogError)(o())&&Object(v.hasSelectedEndpoint)(o())&&await async function({store:e,coreStart:t}){const{getState:n,dispatch:a}=e;try{const{disabled:e,page:i,pageSize:o,startDate:r,endDate:s}=Object(v.getActivityLogDataPaging)(n());if(e)return;if(Object(b.a)({startDate:r,endDate:s}))return void a({type:"endpointDetailsActivityLogUpdateIsInvalidDateRange",payload:{isInvalidDateRange:!0}});a({type:"endpointDetailsActivityLogUpdateIsInvalidDateRange",payload:{isInvalidDateRange:!1}}),a({type:"endpointDetailsActivityLogChanged",payload:Object(y.d)(Object(y.a)(Object(v.getActivityLogData)(n())))});const c=Object(u.a)(d.d,{agent_id:Object(v.selectedAgent)(n())}),l=await t.http.get(c,{query:{page:i,page_size:o,start_date:r,end_date:s}}),p=Object(v.getLastLoadedActivityLogData)(n());if(void 0!==p){const e=[...new Set([...p.data,...l.data])].sort(((e,t)=>new Date(t.item.data["@timestamp"])>new Date(e.item.data["@timestamp"])?1:-1)),t={page:l.page,pageSize:l.pageSize,startDate:l.startDate,endDate:l.endDate,data:1===l.page?l.data:e};a({type:"endpointDetailsActivityLogChanged",payload:Object(y.c)(t)}),l.data.length||a({type:"endpointDetailsActivityLogUpdatePaging",payload:{disabled:!0,page:l.page>1?l.page-1:1,pageSize:l.pageSize,startDate:l.startDate,endDate:l.endDate}})}else a({type:"endpointDetailsActivityLogChanged",payload:Object(y.c)(l)})}catch(e){var i;a({type:"endpointDetailsActivityLogChanged",payload:Object(y.b)(null!==(i=e.body)&&void 0!==i?i:e)})}}({store:t,coreStart:e}),"endpointIsolationRequest"===i.type?E(t,i):"loadMetadataTransformStats"===i.type?async function(e,t){const{getState:n,dispatch:a}=t;if(!e||!n||!a)return;const i=n();if(!Object(v.isMetadataTransformStatsLoading)(i)){a({type:"metadataTransformStatsChanged",payload:Object(y.d)(Object(y.a)(Object(v.getMetadataTransformStats)(i)))});try{const t=await e.get(d.h);a({type:"metadataTransformStatsChanged",payload:Object(y.c)(t.transforms)})}catch(e){a({type:"metadataTransformStatsChanged",payload:Object(y.b)(e)})}}}(e.http,t):void 0}},O=async(e,t,n)=>{if(0===t.length)return;const a=[...new Set(t.reduce(((e,t)=>{const a=t.metadata.Endpoint.policy.applied.id;return n[a]||e.push(a),e}),[]))];if(0===a.length)return;const i=(await Object(f.b)(e,{query:{kuery:`${c.AGENT_POLICY_SAVED_OBJECT_TYPE}.package_policies: (${a.join(" or ")})`}})).items.reduce(((e,t)=>(t.package_policies.forEach((n=>{e.packagePolicy[n]=!0,e.agentPolicy[n]=t.id})),e)),{packagePolicy:{},agentPolicy:{}}),o=a.reduce(((e,t)=>i.packagePolicy[t]?(e.agentPolicy[t]=i.agentPolicy[t],e):(e.packagePolicy[t]=!0,e)),{packagePolicy:{},agentPolicy:{}});return 0!==Object.keys(o.packagePolicy).length||0!==Object.keys(o.agentPolicy).length?o:void 0},j=async e=>{try{return(await e.get(d.f,{query:{page:0,pageSize:1}})).total}catch(e){m("error while trying to check for total endpoints"),m(e)}return 0},E=async({getState:e,dispatch:t},n)=>{const a=e();if(!Object(v.getIsIsolationRequestPending)(a)){t({type:"endpointIsolationRequestStateChange",payload:Object(y.d)(Object(y.a)(Object(v.getCurrentIsolationRequestState)(a)))});try{let e;e="unisolate"===n.payload.type?await Object(l.b)(n.payload.data):await Object(l.a)(n.payload.data),t({type:"endpointIsolationRequestStateChange",payload:Object(y.c)(e)})}catch(e){var i;t({type:"endpointIsolationRequestStateChange",payload:Object(y.b)(null!==(i=e.body)&&void 0!==i?i:e)})}}},S=async({getState:e,dispatch:t})=>{const n=e(),a=Object(v.detailsData)(n),i=Object(v.listData)(n),o=new Set;a&&o.add(a.elastic.agent.id);for(const e of i)o.add(e.metadata.elastic.agent.id);if(0!==o.size)try{const{data:e}=await Object(p.a)(Array.from(o)),n=new Map;for(const t of e)n.set(t.agent_id,t.pending_actions);t({type:"endpointPendingActionsStateChanged",payload:Object(y.c)(n)})}catch(e){m(e)}};async function D({selectedEndpoint:e,store:t,coreStart:n}){const{getState:a,dispatch:i}=t;try{const t=await n.http.get(Object(u.a)(d.e,{id:e}));i({type:"serverReturnedEndpointDetails",payload:t});try{const e=await O(n.http,[t],Object(v.nonExistingPolicies)(a()));void 0!==e&&i({type:"serverReturnedEndpointNonExistingPolicies",payload:e.packagePolicy}),void 0!==(null==e?void 0:e.agentPolicy)&&i({type:"serverReturnedEndpointAgentPolicies",payload:e.agentPolicy})}catch(e){m(e)}}catch(e){i({type:"serverFailedToReturnEndpointDetails",payload:e})}S(t);try{i({type:"serverReturnedEndpointPolicyResponse",payload:await n.http.get(d.c,{query:{agentId:e}})})}catch(e){i({type:"serverFailedToReturnEndpointPolicyResponse",payload:e})}}async function w({store:e,hosts:t,http:n}){const{getState:a,dispatch:i}=e;try{const e=await O(n,t,Object(v.nonExistingPolicies)(a()));void 0!==(null==e?void 0:e.packagePolicy)&&i({type:"serverReturnedEndpointNonExistingPolicies",payload:e.packagePolicy}),void 0!==(null==e?void 0:e.agentPolicy)&&i({type:"serverReturnedEndpointAgentPolicies",payload:e.agentPolicy})}catch(e){m(e)}}const R=e=>t=>t[i.t][e],L=(e,t)=>[Object(a.g)(R(i.u),Object(o.b)(e,t)),Object(a.g)(R(i.s),h(e,t))]}}]);