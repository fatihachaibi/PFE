/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[23],{1373:function(e,t,i){"use strict";i.r(t),i.d(t,"QueryTabContentComponent",(function(){return De})),i.d(t,"default",(function(){return Ne}));var a,r=i(16),l=i(3),n=i(5),s=i.n(n),o=i(23),u=i.n(o),d=i(42),c=i(85),m=i.n(c),p=i(296),f=i(169),y=i(166),h=i(265),g=i(84),b=i(626),v=i(18),S=i(75),k=i(605),O=i(628),E=i(812),P=i(73),w=i(87),x=i(364),I=i(575),j=i(50),F=i.n(j),C=i(10),M=i.n(C),Q=i(90),q=i.n(Q);!function(e){e.BACK="back",e.FORWARD="forward"}(a||(a={}));class super_select_EuiSuperSelect extends n.Component{constructor(...e){super(...e),M()(this,"itemNodes",[]),M()(this,"_isMounted",!1),M()(this,"state",{isPopoverOpen:this.props.isOpen||!1}),M()(this,"setItemNode",((e,t)=>{this.itemNodes[t]=e})),M()(this,"openPopover",(()=>{this.setState({isPopoverOpen:!0});const e=()=>{const t=this.props.options.reduce(((e,t,i)=>null!=e?e:null==t?null:t.value===this.props.valueOfSelected?i:null),null);requestAnimationFrame((()=>{this._isMounted&&null!=this.props.valueOfSelected&&(null!=t?this.focusItemAt(t):e())}))};requestAnimationFrame(e)})),M()(this,"closePopover",(()=>{this.setState({isPopoverOpen:!1})})),M()(this,"itemClicked",(e=>{this.setState({isPopoverOpen:!1}),this.props.onChange&&this.props.onChange(e)})),M()(this,"onSelectKeyDown",(e=>{e.key!==r.keys.ARROW_UP&&e.key!==r.keys.ARROW_DOWN||(e.preventDefault(),e.stopPropagation(),this.openPopover())})),M()(this,"onItemKeyDown",(e=>{switch(e.key){case r.keys.ESCAPE:e.preventDefault(),e.stopPropagation(),this.closePopover();break;case r.keys.TAB:e.preventDefault(),e.stopPropagation();break;case r.keys.ARROW_UP:e.preventDefault(),e.stopPropagation(),this.shiftFocus(a.BACK);break;case r.keys.ARROW_DOWN:e.preventDefault(),e.stopPropagation(),this.shiftFocus(a.FORWARD)}}))}componentDidMount(){this._isMounted=!0,this.props.isOpen&&this.openPopover()}componentWillUnmount(){this._isMounted=!1}focusItemAt(e){const t=this.itemNodes[e];null!=t&&t.focus()}shiftFocus(e){const t=this.itemNodes.indexOf(document.activeElement);let i;i=-1===t?0:e===a.BACK?0===t?this.itemNodes.length-1:t-1:t===this.itemNodes.length-1?0:t+1,this.focusItemAt(i)}render(){const{className:e,options:t,valueOfSelected:i,onChange:a,isOpen:l,isInvalid:n,hasDividers:o,itemClassName:u,itemLayoutAlign:d,fullWidth:c,popoverProps:m,compressed:p,...f}=this.props,y=q()("euiSuperSelect",null==m?void 0:m.className),h=q()({"euiSuperSelect--isOpen__button":this.state.isPopoverOpen},e),g=q()("euiSuperSelect__item",{"euiSuperSelect__item--hasDividers":o},u),b=s.a.createElement(r.EuiSuperSelectControl,F()({options:t,value:i,onClick:this.state.isPopoverOpen?this.closePopover:this.openPopover,onKeyDown:this.onSelectKeyDown,className:h,fullWidth:c,isInvalid:n,compressed:p},f)),v=t.map(((e,t)=>{const{value:a,dropdownDisplay:l,inputDisplay:n,...o}=e;return s.a.createElement(r.EuiContextMenuItem,F()({key:t,className:g,icon:i===a?"check":"empty",onClick:()=>this.itemClicked(a),onKeyDown:this.onItemKeyDown,layoutAlign:d,buttonRef:e=>this.setItemNode(e,t),role:"option",id:a,"aria-selected":i===a},o),l||n)}));return s.a.createElement(r.EuiInputPopover,F()({},m,{className:y,input:b,isOpen:l||this.state.isPopoverOpen,closePopover:this.closePopover,panelPaddingSize:"none",panelClassName:y,fullWidth:c,repositionOnScroll:!0,anchorPosition:"downCenter"}),s.a.createElement(r.EuiScreenReaderOnly,null,s.a.createElement("p",{role:"alert"},s.a.createElement(r.EuiI18n,{token:"euiSuperSelect.screenReaderAnnouncement",default:"You are in a form selector of {optionsCount} items and must select a single option. Use the up and down keys to navigate or escape to close.",values:{optionsCount:t.length}}))),s.a.createElement("div",{className:"euiSuperSelect__listbox",role:"listbox","aria-activedescendant":i,tabIndex:0},v))}}M()(super_select_EuiSuperSelect,"defaultProps",{compressed:!1,fullWidth:!1,hasDividers:!1,isInvalid:!1,isLoading:!1});var T=i(325),D=i(4);const N=D.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.filterDescription",{defaultMessage:"Events from the data providers above are filtered by the adjacent KQL"}),R=D.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.filterKqlTooltip",{defaultMessage:"Events from the data providers above are filtered by this KQL"}),K=D.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.filterKqlPlaceholder",{defaultMessage:"Filter events"}),_=D.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.filterKqlSelectedText",{defaultMessage:"Filter"}),A=D.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.searchDescription",{defaultMessage:"Events from the data providers above are combined with results from the adjacent KQL"}),z=D.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.searchKqlTooltip",{defaultMessage:"Events from the data providers above are combined with results from this KQL"}),B=D.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.searchKqlPlaceholder",{defaultMessage:"Search events"}),L=D.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.searchKqlSelectedText",{defaultMessage:"Search"}),U=D.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.filterOrSearchWithKql",{defaultMessage:"Filter or Search with KQL"}),W=(D.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.eventTypeAllEvent",{defaultMessage:"All data sources"}),D.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.eventTypeRawEvent",{defaultMessage:"Events"}),D.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.eventTypeDetectionAlertsEvent",{defaultMessage:"Detection Alerts"}),D.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.customeIndexNames",{defaultMessage:"Custom"}),D.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.indexPatterns.help",{defaultMessage:"Data sources selection"}),D.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.indexPatterns.configure",{defaultMessage:"View data sources associated with each of the above selections"}),D.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.indexPatterns.save",{defaultMessage:"Save"}),D.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.indexPatterns.showAdvancedSettings",{defaultMessage:"Show Advanced"}),D.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.indexPatterns.hideAdvancedSettings",{defaultMessage:"Hide Advanced"}),D.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.indexPatterns.resetSettings",{defaultMessage:"Reset"}),D.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.indexPatterns.pickIndexPatternsCombo",{defaultMessage:"Pick index patterns"}),u.a.div.withConfig({displayName:"AndOrContainer",componentId:"sc-1mndpti-0"})(["position:relative;top:-1px;"]));W.displayName="AndOrContainer";const $={filter:{mode:"filter",description:N,kqlBarTooltip:R,placeholder:K,selectText:_},search:{mode:"search",description:A,kqlBarTooltip:z,placeholder:B,selectText:L}},V=[{value:$.filter.mode,inputDisplay:s.a.createElement(W,null,s.a.createElement(T.a,{type:"and"}),$.filter.selectText),dropdownDisplay:s.a.createElement(s.a.Fragment,null,s.a.createElement(T.a,{type:"and"}),s.a.createElement("strong",null,$.filter.selectText),s.a.createElement(r.EuiSpacer,{size:"xs"}),s.a.createElement(r.EuiText,{size:"s",color:"subdued"},s.a.createElement("p",{className:"euiTextColor--subdued"},$.filter.description))),"data-test-subj":"kqlModePopoverFilter"},{value:$.search.mode,inputDisplay:s.a.createElement(W,null,s.a.createElement(T.a,{type:"or"}),$.search.selectText),dropdownDisplay:s.a.createElement(s.a.Fragment,null,s.a.createElement(T.a,{type:"or"}),s.a.createElement("strong",null,$.search.selectText),s.a.createElement(r.EuiSpacer,{size:"xs"}),s.a.createElement(r.EuiText,{size:"s",color:"subdued"},s.a.createElement("p",{className:"euiTextColor--subdued"},$.search.description))),"data-test-subj":"kqlModePopoverSearch"}],H="timelineSelectModeItemsClassName",G="searchOrFilterPopover",J="352px",X=Object(o.createGlobalStyle)([".","{width:350px !important;}.",".euiPopover__panel{width:"," !important;.euiSuperSelect__listbox{width:"," !important;}}"],H,G,J,J),Y=u.a.div.withConfig({displayName:"SearchOrFilterContainer",componentId:"sc-izkbfu-0"})([""," user-select:none;"],(({theme:e})=>`margin-top: ${e.eui.euiSizeXS};`));Y.displayName="SearchOrFilterContainer";const Z=u()(r.EuiFlexItem).withConfig({displayName:"ModeFlexItem",componentId:"sc-izkbfu-1"})(["user-select:none;"]);Z.displayName="ModeFlexItem";const ee=s.a.memo((({dataProviders:e,isRefreshPaused:t,filters:i,filterManager:a,filterQuery:l,from:o,fromStr:u,kqlMode:d,timelineId:c,refreshInterval:m,savedQueryId:p,setFilters:f,setSavedQueryId:y,to:h,toStr:g,updateKqlMode:b,updateReduxTime:v})=>{const S=Object(n.useCallback)((e=>b({id:c,kqlMode:e})),[c,b]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(Y,null,s.a.createElement(r.EuiFlexGroup,{"data-test-subj":"timeline-search-or-filter",gutterSize:"xs"},s.a.createElement(Z,{grow:!1},s.a.createElement(r.EuiToolTip,{content:U},s.a.createElement(super_select_EuiSuperSelect,{"data-test-subj":"timeline-select-search-or-filter",hasDividers:!0,itemLayoutAlign:"top",itemClassName:H,onChange:S,options:V,popoverProps:{className:G},valueOfSelected:d}))),s.a.createElement(r.EuiFlexItem,{"data-test-subj":"timeline-search-or-filter-search-container"},s.a.createElement(I.a,{dataProviders:e,filters:i,filterManager:a,filterQuery:l,from:o,fromStr:u,kqlMode:d,isRefreshPaused:t,refreshInterval:m,savedQueryId:p,setFilters:f,setSavedQueryId:y,timelineId:c,to:h,toStr:g,updateReduxTime:v})))),s.a.createElement(X,null))}));ee.displayName="SearchOrFilter";const te=s.a.memo((({dataProviders:e,filters:t,filterManager:i,filterQuery:a,from:r,fromStr:l,isRefreshPaused:o,kqlMode:u,refreshInterval:d,savedQueryId:c,setFilters:m,setSavedQueryId:p,timelineId:f,to:y,toStr:h,updateKqlMode:g,updateReduxTime:b})=>{const v=Object(n.useCallback)((e=>m({id:f,filters:e})),[f,m]),S=Object(n.useCallback)((e=>p({id:f,savedQueryId:e})),[f,p]);return s.a.createElement(ee,{dataProviders:e,filters:t,filterManager:i,filterQuery:a,from:r,fromStr:l,isRefreshPaused:o,kqlMode:u,refreshInterval:d,savedQueryId:c,setFilters:v,setSavedQueryId:S,timelineId:f,to:y,toStr:h,updateKqlMode:g,updateReduxTime:b})}),((e,t)=>e.filterManager===t.filterManager&&e.from===t.from&&e.fromStr===t.fromStr&&e.to===t.to&&e.toStr===t.toStr&&e.isRefreshPaused===t.isRefreshPaused&&e.refreshInterval===t.refreshInterval&&e.timelineId===t.timelineId&&m()(e.dataProviders,t.dataProviders)&&m()(e.filters,t.filters)&&m()(e.filterQuery,t.filterQuery)&&m()(e.kqlMode,t.kqlMode)&&m()(e.savedQueryId,t.savedQueryId)&&m()(e.timelineId,t.timelineId)));te.displayName="StatefulSearchOrFilterComponent";const ie=Object(d.connect)((()=>{const e=g.b.getTimelineByIdSelector(),t=g.b.getKqlFilterKuerySelector(),i=P.e.getTimelineSelector(),a=P.e.getTimelinePolicySelector();return(r,{timelineId:n})=>{var s;const o=null!==(s=e(r,n))&&void 0!==s?s:w.a,u=i(r),d=a(r);return{dataProviders:o.dataProviders,filterQuery:t(r,n),filters:o.filters,from:u.timerange.from,fromStr:u.timerange.fromStr,isRefreshPaused:"manual"===d.kind,kqlMode:Object(l.getOr)("filter","kqlMode",o),refreshInterval:d.duration,savedQueryId:Object(l.getOr)(null,"savedQueryId",o),to:u.timerange.to,toStr:u.timerange.toStr}}}),(e=>({applyKqlFilterQuery:({id:t,filterQuery:i})=>e(g.a.applyKqlFilterQuery({id:t,filterQuery:i})),updateKqlMode:({id:t,kqlMode:i})=>e(g.a.updateKqlMode({id:t,kqlMode:i})),setSavedQueryId:({id:t,savedQueryId:i})=>e(g.a.setSavedQueryId({id:t,savedQueryId:i})),setFilters:({id:t,filters:i})=>e(g.a.setFilters({id:t,filters:i})),updateReduxTime:Object(x.b)(e)})))(te);var ae=i(533),re=i(14);const le=({filterManager:e,show:t,showCallOutUnauthorizedMsg:i,status:a,timelineId:l})=>s.a.createElement(s.a.Fragment,null,i&&s.a.createElement(r.EuiCallOut,{"data-test-subj":"timelineCallOutUnauthorized",title:ae.b,color:"warning",iconType:"alert",size:"s"}),a===re.k.immutable&&s.a.createElement(r.EuiCallOut,{"data-test-subj":"timelineImmutableCallOut",title:ae.a,color:"primary",iconType:"alert",size:"s"}),t&&s.a.createElement(E.a,{timelineId:l}),s.a.createElement(ie,{filterManager:e,timelineId:l})),ne=s.a.memo(le);var se=i(207),oe=i(599),ue=i(300),de=i(422),ce=i(13),me=i(194),pe=i(473),fe=i(629),ye=i(89),he=i(78),ge=i(355),be=i(474),ve=i(602),Se=i(356),ke=i(71),Oe=i(604);const Ee=u.a.div.withConfig({displayName:"TimelineHeaderContainer",componentId:"sc-fm1ksw-0"})(["margin-top:6px;width:100%;"]);Ee.displayName="TimelineHeaderContainer";const Pe=u()(r.EuiFlyoutHeader).withConfig({displayName:"StyledEuiFlyoutHeader",componentId:"sc-fm1ksw-1"})(["align-items:stretch;box-shadow:none;display:flex;flex-direction:column;&.euiFlyoutHeader{","}"],(({theme:e})=>`padding: ${e.eui.euiSizeM} ${e.eui.euiSizeS} 0 ${e.eui.euiSizeS};`)),we=u()(r.EuiFlyoutBody).withConfig({displayName:"StyledEuiFlyoutBody",componentId:"sc-fm1ksw-2"})(["overflow-y:hidden;flex:1;.euiFlyoutBody__overflow{overflow:hidden;mask-image:none;}.euiFlyoutBody__overflowContent{padding:0;height:100%;display:flex;}"]),xe=u()(r.EuiFlyoutFooter).withConfig({displayName:"StyledEuiFlyoutFooter",componentId:"sc-fm1ksw-3"})(["background:none;&.euiFlyoutFooter{","}"],(({theme:e})=>`padding: ${e.eui.euiSizeS} 0;`)),Ie=u()(r.EuiFlexGroup).withConfig({displayName:"FullWidthFlexGroup",componentId:"sc-fm1ksw-4"})(["margin:0;width:100%;overflow:hidden;"]),je=u()(r.EuiFlexItem).withConfig({displayName:"ScrollableFlexItem",componentId:"sc-fm1ksw-5"})([""," overflow:hidden;"],(({theme:e})=>`margin: 0 ${e.eui.euiSizeM};`)),Fe=u()(r.EuiFlexItem).withConfig({displayName:"DatePicker",componentId:"sc-fm1ksw-6"})([".euiSuperDatePicker__flexWrapper{max-width:none;width:auto;}"]);Fe.displayName="DatePicker";const Ce=u()(r.EuiFlexItem).withConfig({displayName:"SourcererFlex",componentId:"sc-fm1ksw-7"})(["align-items:flex-end;"]);Ce.displayName="SourcererFlex";const Me=u.a.div.withConfig({displayName:"VerticalRule",componentId:"sc-fm1ksw-8"})(["width:2px;height:100%;background:",";"],(({theme:e})=>e.eui.euiColorLightShade));Me.displayName="VerticalRule";const Qe=u()(r.EuiBadge).withConfig({displayName:"EventsCountBadge",componentId:"sc-fm1ksw-9"})(["margin-left:",";"],(({theme:e})=>e.eui.paddingSizes.s)),qe=[],Te=[],De=({activeTab:e,columns:t,dataProviders:i,end:a,expandedDetail:o,filters:u,timelineId:c,isLive:m,itemsPerPage:E,itemsPerPageOptions:P,kqlMode:w,kqlQueryExpression:I,onEventClosed:j,renderCellValue:F,rowRenderers:C,show:M,showCallOutUnauthorizedMsg:Q,showExpandedDetails:q,start:T,status:D,sort:N,timerangeKind:R})=>{var K;const _=Object(d.useDispatch)(),{portalNode:A}=Object(pe.d)(),{setTimelineFullScreen:z,timelineFullScreen:B}=Object(ye.b)(),{browserFields:L,dataViewId:U,docValueFields:W,loading:$,indexPattern:V,runtimeMappings:H,selectedPatterns:G}=Object(me.d)(ce.SourcererScopeName.timeline),{uiSettings:J}=Object(v.j)().services,X=Object(n.useMemo)((()=>g.b.getManageTimelineById()),[]),{filterManager:Y}=Object(ke.a)((e=>X(e,null!=c?c:""))),Z=Object(n.useMemo)((()=>null!=Y?Y:new f.FilterManager(J)),[Y,J]),ee=Object(n.useMemo)((()=>Object(y.getEsQueryConfig)(J)),[J]),te=Object(n.useMemo)((()=>({query:I.trim(),language:"kuery"})),[I]),ie=Object(se.i)({config:ee,dataProviders:i,indexPattern:V,browserFields:L,filters:u,kqlQuery:te,kqlMode:w});Object(h.a)({id:c,filterQuery:null==ie?void 0:ie.filterQuery,kqlError:null==ie?void 0:ie.kqlError,query:te,startDate:T,endDate:a});const ae=Object(l.isEmpty)(i)&&Object(l.isEmpty)(u)&&Object(l.isEmpty)(te.query)&&void 0===(null==ie?void 0:ie.filterQuery),le=Object(n.useMemo)((()=>null!=ie&&null!=$&&!$&&!Object(l.isEmpty)(T)&&!Object(l.isEmpty)(a)&&void 0!==(null==ie?void 0:ie.filterQuery)),[ie,a,$,T]),De=N.map((({columnId:e,columnType:t,esTypes:i,sortDirection:a})=>({field:e,direction:a,esTypes:null!=i?i:[],type:t})));Object(n.useEffect)((()=>{_(g.a.initializeTGridSettings({filterManager:Z,id:c}))}),[Y,_,Z,c,J]);const[Ne,{events:Re,inspect:Ke,totalCount:_e,pageInfo:Ae,loadPage:ze,updatedAt:Be,refetch:Le}]=Object(b.a)({dataViewId:U,docValueFields:W,endDate:a,fields:[...(Object(l.isEmpty)(t)?S.b:t).map((e=>e.id)),...ue.h],filterQuery:null==ie?void 0:ie.filterQuery,id:c,indexNames:G,language:te.language,limit:E,runtimeMappings:H,skip:!le,sort:De,startDate:T,timerangeKind:R}),Ue=Object(n.useCallback)((()=>{var e;j({tabType:re.l.query,timelineId:c}),null!==(e=o[re.l.query])&&void 0!==e&&e.panelView&&c===re.i.active&&q&&he.a.toggleExpandedDetail({})}),[j,c,o,q]);Object(n.useEffect)((()=>{_(g.a.updateIsLoading({id:c,isLoading:Ne||$}))}),[$,c,Ne,_]);const We=Object(n.useMemo)((()=>ie&&null!=ie.kqlError||!1),[ie]),$e=Object(n.useMemo)((()=>Object(Se.a)(6).map((e=>({...e,headerCellRender:ve.a})))),[]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(p.a,{node:A},_e>=0?s.a.createElement(Qe,null,_e):null),s.a.createElement(oe.a,{id:`${c}-${re.l.query}`,inputId:"timeline",inspect:Ke,loading:Ne,refetch:Le,skip:!le}),s.a.createElement(Ie,{gutterSize:"none"},s.a.createElement(je,{grow:2},s.a.createElement(Pe,{"data-test-subj":`${e}-tab-flyout-header`,hasBorder:!1},s.a.createElement(r.EuiFlexGroup,{alignItems:"center",gutterSize:"s","data-test-subj":"timeline-date-picker-container"},B&&null!=z&&s.a.createElement(be.b,{fullScreen:B,setFullScreen:z}),s.a.createElement(Fe,{grow:10},s.a.createElement(x.a,{id:"timeline",timelineId:c,disabled:We})),s.a.createElement(r.EuiFlexItem,{grow:!1},s.a.createElement(fe.a,null)),s.a.createElement(Ce,{grow:1},e===re.l.query&&s.a.createElement(Oe.a,{scope:ce.SourcererScopeName.timeline}))),s.a.createElement(Ee,{"data-test-subj":"timelineHeader"},s.a.createElement(ne,{filterManager:Z,show:M&&e===re.l.query,showCallOutUnauthorizedMsg:Q,status:D,timelineId:c}))),s.a.createElement(de.a,null,s.a.createElement(we,{"data-test-subj":`${re.l.query}-tab-flyout-body`,className:"timeline-flyout-body"},s.a.createElement(k.a,{activePage:Ae.activePage,browserFields:L,data:ae?qe:Re,id:c,refetch:Le,renderCellValue:F,rowRenderers:C,sort:N,tabType:re.l.query,totalPages:Object(se.h)({itemsCount:_e,itemsPerPage:E}),leadingControlColumns:$e,trailingControlColumns:Te})),s.a.createElement(xe,{"data-test-subj":`${re.l.query}-tab-flyout-footer`,className:"timeline-flyout-footer"},!ae&&s.a.createElement(O.a,{activePage:null!==(K=null==Ae?void 0:Ae.activePage)&&void 0!==K?K:0,"data-test-subj":"timeline-footer",updatedAt:Be,height:O.b,id:c,isLive:m,isLoading:Ne||$,itemsCount:ae?0:Re.length,itemsPerPage:E,itemsPerPageOptions:P,onChangePage:ze,totalCount:ae?0:_e})))),q&&s.a.createElement(s.a.Fragment,null,s.a.createElement(Me,null),s.a.createElement(je,{grow:1},s.a.createElement(ge.a,{browserFields:L,docValueFields:W,handleOnPanelClosed:Ue,runtimeMappings:H,tabType:re.l.query,timelineId:c})))))},Ne=Object(d.connect)((()=>{const e=g.b.getShowCallOutUnauthorizedMsg(),t=g.b.getTimelineByIdSelector(),i=g.b.getKqlFilterKuerySelector(),a=P.e.getTimelineSelector();return(r,{timelineId:n})=>{var s,o,u,d;const c=null!==(s=t(r,n))&&void 0!==s?s:w.a,m=a(r),{activeTab:p,columns:f,dataProviders:y,expandedDetail:h,filters:g,itemsPerPage:b,itemsPerPageOptions:v,kqlMode:S,show:k,sort:O,status:E,timelineType:P}=c,x=i(r,n),I="filter"===S&&g||[],j=Object(l.isEmpty)(y)&&Object(l.isEmpty)(null!==(o=null==x?void 0:x.expression)&&void 0!==o?o:"")&&"template"===P?" ":null!==(u=null==x?void 0:x.expression)&&void 0!==u?u:"";return{activeTab:p,columns:f,dataProviders:y,end:m.timerange.to,expandedDetail:h,filters:I,timelineId:n,isLive:"interval"===m.policy.kind,itemsPerPage:b,itemsPerPageOptions:v,kqlMode:S,kqlQueryExpression:j,showCallOutUnauthorizedMsg:e(r),show:k,showExpandedDetails:!!h[re.l.query]&&!(null===(d=h[re.l.query])||void 0===d||!d.panelView),sort:O,start:m.timerange.from,status:E,timerangeKind:m.timerange.kind}}}),((e,{timelineId:t})=>({onEventClosed:t=>{e(g.a.toggleDetailPanel(t))}})))(s.a.memo(De,((e,t)=>((e,t)=>e.kqlMode===t.kqlMode&&e.kqlQueryExpression===t.kqlQueryExpression&&m()(e.filters,t.filters))(e,t)&&e.activeTab===t.activeTab&&((e,t)=>e.end===t.end&&e.start===t.start&&e.timerangeKind===t.timerangeKind)(e,t)&&e.isLive===t.isLive&&e.itemsPerPage===t.itemsPerPage&&e.onEventClosed===t.onEventClosed&&e.show===t.show&&e.showCallOutUnauthorizedMsg===t.showCallOutUnauthorizedMsg&&e.showExpandedDetails===t.showExpandedDetails&&e.status===t.status&&e.timelineId===t.timelineId&&m()(e.columns,t.columns)&&m()(e.dataProviders,t.dataProviders)&&m()(e.itemsPerPageOptions,t.itemsPerPageOptions)&&m()(e.sort,t.sort))))},479:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var a=i(5),r=i.n(a),l=i(85),n=i.n(l),s=i(169),o=i(179),u=i(98);const d=Object(a.memo)((({dateRangeFrom:e,dateRangeTo:t,hideSavedQuery:i=!1,indexPattern:l,isLoading:d=!1,isRefreshPaused:c,filterQuery:m,filterManager:p,filters:f,onChangedQuery:y,onSubmitQuery:h,refreshInterval:g,savedQuery:b,onSavedQuery:v,dataTestSubj:S,displayStyle:k})=>{const O=Object(a.useCallback)((e=>{null==e.query||n()(e.query,m)||h(e.query)}),[m,h]),E=Object(a.useCallback)((e=>{y&&null!=e.query&&!n()(e.query,m)&&y(e.query)}),[m,y]),P=Object(a.useCallback)((e=>{const{query:t,filters:i,timefilter:a}=e.attributes;h(t,a),p.setFilters(i||[]),v(e)}),[p,h,v]),w=Object(a.useCallback)((()=>{null!=b&&(h({query:"",language:b.attributes.query.language}),p.setFilters([]),v(void 0))}),[p,h,v,b]),x=Object(a.useCallback)((e=>{p.setFilters(e)}),[p]),I=Object(a.useMemo)((()=>[l]),[l]);return r.a.createElement(o.SearchBar,{showSubmitButton:!1,dateRangeFrom:e,dateRangeTo:t,filters:f,indexPatterns:I,isLoading:d,isRefreshPaused:c,query:m,onClearSavedQuery:w,onFiltersUpdated:x,onQueryChange:E,onQuerySubmit:O,onSaved:v,onSavedQueryUpdated:P,refreshInterval:g,showAutoRefreshOnly:!1,showFilterBar:!i,showDatePicker:!1,showQueryBar:!0,showQueryInput:!0,showSaveQuery:!0,timeHistory:new s.TimeHistory(new u.Storage(localStorage)),dataTestSubj:S,savedQuery:b,displayStyle:k})}));d.displayName="QueryBar"},480:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var a=i(5),r=i(169),l=i(18);const n=()=>{const e=Object(l.j)(),{http:t}=e.services,[i,n]=Object(a.useState)(Object(r.createSavedQueryService)(t));return Object(a.useEffect)((()=>{n(Object(r.createSavedQueryService)(t))}),[t]),i}},575:function(e,t,i){"use strict";i.d(t,"a",(function(){return S})),i.d(t,"b",(function(){return k}));var a=i(3),r=i(5),l=i.n(r),n=i(42),s=i(19),o=i(85),u=i.n(o),d=i(39),c=i(194),m=i(13),p=i(231),f=i(480),y=i(479),h=i(207),g=i(84);const b="timeline-filter-drop-area",v=(e=[])=>e.filter((e=>e.meta.controlledBy!==b)),S=Object(r.memo)((({dataProviders:e,filters:t,filterManager:i,filterQuery:a,from:o,fromStr:d,kqlMode:S,isRefreshPaused:O,savedQueryId:E,setFilters:P,setSavedQueryId:w,refreshInterval:x,timelineId:I,to:j,toStr:F,updateReduxTime:C})=>{const M=Object(n.useDispatch)(),[Q,q]=Object(r.useState)(null!=d?d:new Date(o).toISOString()),[T,D]=Object(r.useState)(null!=F?F:new Date(j).toISOString()),{browserFields:N,indexPattern:R}=Object(c.d)(m.SourcererScopeName.timeline),[K,_]=Object(r.useState)(void 0),[A,z]=Object(r.useState)({query:null!=a?a.expression:"",language:null!=a?a.kind:"kuery"}),[B,L]=Object(r.useState)(v(t)),[U,W]=Object(r.useState)(Object(p.a)(Object(h.g)(e,N),R)),$=Object(f.a)(),V=Object(r.useCallback)(((e,t)=>M(g.a.applyKqlFilterQuery({id:I,filterQuery:{kuery:{kind:t,expression:e},serializedQuery:Object(p.a)(e,R)}}))),[M,R,I]);Object(r.useEffect)((()=>{let e=!0;const a=new s.Subscription;return i.setFilters(t),a.add(i.getUpdates$().subscribe({next:()=>{if(e){const e=v(i.getFilters());P(e),L(e)}}})),()=>{e=!1,a.unsubscribe()}}),[]),Object(r.useEffect)((()=>{const e=v(i.getFilters());u()(t,e)||i.setFilters(t)}),[t]),Object(r.useEffect)((()=>{z({query:null!=a?a.expression:"",language:null!=a?a.kind:"kuery"})}),[a]),Object(r.useEffect)((()=>{W(Object(p.a)(Object(h.g)(e,N),R))}),[e,N,R]),Object(r.useEffect)((()=>{null!=d&&null!=F?(q(d),D(F)):null!=o&&null!=j&&(q(new Date(o).toISOString()),D(new Date(j).toISOString()))}),[o,d,j,F]),Object(r.useEffect)((()=>{let e=!0;return async function(){if(null!=E&&null!=$)try{const i=await $.getSavedQuery(E);e&&null!=i&&_({...i,attributes:{...i.attributes,filters:v(t)}})}catch(e){_(void 0)}else e&&_(void 0)}(),()=>{e=!1}}),[E]);const H=Object(r.useCallback)(((e,t)=>{if((null==a||null!=a&&a.expression!==e.query||a.kind!==e.language)&&V(e.query,e.language),null!=t){const e=t.from.includes("now")||t.to.includes("now");C({id:"timeline",end:t.to,start:t.from,isInvalid:!1,isQuickSelection:e,timelineId:I})}}),[a,I]),G=Object(r.useCallback)((e=>{if(null!=e){if(e.id!==E&&w(e.id),null!=$&&""!==U){const t=null!=e.attributes.filters?e.attributes.filters.findIndex((e=>e.meta.controlledBy===b)):-1;$.updateQuery(e.id,{...e.attributes,filters:null!=e.attributes.filters?t>-1?[...e.attributes.filters.slice(0,t),k(U),...e.attributes.filters.slice(t+1)]:[...e.attributes.filters,k(U)]:[]})}}else w(null)}),[U,E,$]);return l.a.createElement(y.a,{dateRangeFrom:Q,dateRangeTo:T,hideSavedQuery:"search"===S,indexPattern:R,isRefreshPaused:O,filterQuery:A,filterManager:i,filters:B,onSubmitQuery:H,refreshInterval:x,savedQuery:K,onSavedQuery:G,dataTestSubj:"timelineQueryInput",displayStyle:"inPage"})})),k=e=>{const t=JSON.parse(e),i=Object.keys(t);return{...t,meta:{alias:b,controlledBy:b,negate:!1,disabled:!1,type:"custom",key:Object(a.isEmpty)(i)?"bool":i[0],value:e},$state:{store:d.b.APP_STATE}}}},599:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var a=i(5),r=i.n(a),l=i(42),n=i(77);const s=({id:e,inputId:t,inspect:i,loading:r,refetch:s,skip:o})=>{const u=Object(l.useDispatch)();return Object(a.useEffect)((()=>{o||u(n.b.setQuery({id:e,inputId:t,inspect:i,loading:r,refetch:s}))}),[u,e,t,r,s,i,o]),null},o=r.a.memo(s)},629:function(e,t,i){"use strict";i.d(t,"a",(function(){return y}));var a=i(16),r=i(5),l=i.n(r),n=i(42),s=i(28),o=i(71),u=i(4);const d=u.i18n.translate("xpack.securitySolution.timeline.properties.lockDatePickerTooltip",{defaultMessage:"Disable syncing of date/time range bteween the currently viewed page and your timeline"}),c=u.i18n.translate("xpack.securitySolution.timeline.properties.unlockDatePickerTooltip",{defaultMessage:"Enable syncing of date/time range between the currently viewed page and your timeline"}),m=(u.i18n.translate("xpack.securitySolution.timeline.properties.lockedDatePickerLabel",{defaultMessage:"Global date picker is locked to timeline date picker"}),u.i18n.translate("xpack.securitySolution.timeline.properties.unlockedDatePickerLabel",{defaultMessage:"Global date picker NOT locked to timeline date picker"}),u.i18n.translate("xpack.securitySolution.timeline.properties.lockDatePickerDescription",{defaultMessage:"Lock global date picker to timeline date picker"})),p=u.i18n.translate("xpack.securitySolution.timeline.properties.unlockDatePickerDescription",{defaultMessage:"Unlock global date picker from timeline date picker"}),f=()=>{const e=Object(n.useDispatch)(),t=Object(r.useMemo)((()=>s.d.globalSelector()),[]),i=Object(o.b)((e=>t(e).linkTo.includes("timeline"))),u=Object(r.useCallback)((()=>e(s.b.toggleTimelineLinkTo({linkToId:"timeline"}))),[e]);return l.a.createElement(a.EuiToolTip,{"data-test-subj":"timeline-date-picker-lock-tooltip",position:"top",content:i?d:c},l.a.createElement(a.EuiButtonIcon,{"data-test-subj":`timeline-date-picker-${i?"lock":"unlock"}-button`,color:"primary",onClick:u,iconType:i?"lock":"lockOpen","aria-label":i?p:m}))};f.displayName="TimelineDatePickerLockComponent";const y=l.a.memo(f)}}]);