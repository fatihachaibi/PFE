/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[2],{202:function(t,e,n){"use strict";n.d(e,"v",(function(){return i})),n.d(e,"s",(function(){return r})),n.d(e,"t",(function(){return a})),n.d(e,"u",(function(){return s})),n.d(e,"r",(function(){return o})),n.d(e,"o",(function(){return c})),n.d(e,"q",(function(){return u})),n.d(e,"p",(function(){return l})),n.d(e,"k",(function(){return d})),n.d(e,"j",(function(){return p})),n.d(e,"m",(function(){return y})),n.d(e,"n",(function(){return f})),n.d(e,"l",(function(){return _})),n.d(e,"e",(function(){return m})),n.d(e,"f",(function(){return g})),n.d(e,"d",(function(){return x})),n.d(e,"h",(function(){return v})),n.d(e,"i",(function(){return h})),n.d(e,"g",(function(){return b})),n.d(e,"b",(function(){return E})),n.d(e,"c",(function(){return w})),n.d(e,"a",(function(){return A}));var i="/api/lists",r="".concat(i,"/index"),a="".concat(i,"/items"),s="".concat(i,"/privileges"),o="/api/exception_lists",c="/api/exception_lists/items",u="exception-list-agnostic",l="exception-list",d="/api/endpoint_list",p="endpoint_list",y="endpoint_trusted_apps",f="Endpoint Security Trusted Apps List",_="Endpoint Security Trusted Apps List",m="endpoint_event_filters",g="Endpoint Security Event Filters List",x="Endpoint Security Event Filters List",v="endpoint_host_isolation_exceptions",h="Endpoint Security Host isolation exceptions List",b="Endpoint Security Host isolation exceptions List",E="endpoint_blocklists",w="Endpoint Security Blocklists List",A="Endpoint Security Blocklists List"},210:function(t,e,n){t.exports=n(24)(6)},212:function(t,e,n){"use strict";n.d(e,"d",(function(){return y})),n.d(e,"g",(function(){return f})),n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return a})),n.d(e,"e",(function(){return x})),n.d(e,"f",(function(){return v}));var i,r,a,s=n(210),o=n.n(s),c=n(11),u=n.n(c),l=n(43),d=n.n(l),p=["id"],y=function(t){return null!=t.id?t:u()(u()({},t),{},{id:d.a.v4()})},f=function(t){var e=t;return null!=e.id?(e.id,o()(e,p)):t},_=n(896),m=n.n(_),g=n(4);g.i18n.translate("utils.filename.wildcardWarning",{defaultMessage:"Using wildcards in file paths can impact Endpoint performance"}),g.i18n.translate("utils.filename.pathWarning",{defaultMessage:"Path may be formed incorrectly; verify value"}),function(t){t.HASH="process.hash.*",t.PATH="process.executable.caseless",t.SIGNER="process.Ext.code_signature"}(i||(i={})),function(t){t.HASH=".hash.",t.EXECUTABLE=".executable.caseless",t.PATH=".path",t.SIGNER=".Ext.code_signature"}(r||(r={})),function(t){t.LINUX="linux",t.MAC="macos",t.WINDOWS="windows"}(a||(a={}));var x=function(t){var e=t.os,n=t.type,i=t.value,r=e===a.WINDOWS?"\\":"/",s=i.split(r).pop();if(s)return"wildcard"!==n||1===(s.split("*").length||s.split("?").length)},v=function(t){var e=t.os,n=t.field,i=t.type,r=t.value;return!["process.executable.caseless","file.path","file.path.text"].includes(n)||("wildcard"===i?e===a.WINDOWS?b(r):E(r):h({value:r,os:e}))},h=function(t){var e=t.os,n=t.value;return e===a.WINDOWS?/^[a-z]:(?:|\\\\[^<>:"'/\\|?*]+\\[^<>:"'/\\|?*]+|%\w+%|)[\\](?:[^<>:"'/\\|?*]+[\\/])*([^<>:"'/\\|?*])+$/i.test(n):/^(\/|(\/[\w\-]+)+|\/[\w\-]+\.[\w]+|(\/[\w-]+)+\/[\w\-]+\.[\w]+)$/i.test(n)},b=function(t){var e=t[0],n=t.slice(-1),i=t.trim(),r=/\//.test(i);return 0!==t.length&&!(r||i.length!==t.length||"^"===e||"\\"===n||!w({path:t,isWindowsPath:!0}))},E=function(t){var e=t[0],n=t.slice(-1),i=t.trim();return 0!==t.length&&!(i.length!==t.length||"/"!==e||"/"===n||t.length>1024==1||!0===t.includes("//")||!w({path:t,isWindowsPath:!1}))},w=function(t){var e,n=t.path,i=t.isWindowsPath,r=m()(n.split(i?"\\":"/"));try{for(r.s();!(e=r.n()).done;){var a=e.value;if(!0===/[\*|\?]+/.test(a))return!0}}catch(t){r.e(t)}finally{r.f()}return!1}},219:function(t,e,n){"use strict";n.d(e,"e",(function(){return p})),n.d(e,"n",(function(){return X})),n.d(e,"i",(function(){return H})),n.d(e,"j",(function(){return M})),n.d(e,"k",(function(){return U})),n.d(e,"l",(function(){return W})),n.d(e,"m",(function(){return K})),n.d(e,"a",(function(){return $})),n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return r})),n.d(e,"x",(function(){return it})),n.d(e,"A",(function(){return B})),n.d(e,"B",(function(){return ut})),n.d(e,"g",(function(){return kt})),n.d(e,"h",(function(){return Nt})),n.d(e,"q",(function(){return Dt})),n.d(e,"r",(function(){return Pt})),n.d(e,"v",(function(){return $t})),n.d(e,"w",(function(){return zt})),n.d(e,"d",(function(){return Ut})),n.d(e,"f",(function(){return Rt})),n.d(e,"p",(function(){return Wt})),n.d(e,"o",(function(){return Bt})),n.d(e,"s",(function(){return Ft})),n.d(e,"t",(function(){return qt})),n.d(e,"u",(function(){return Qt})),n.d(e,"z",(function(){return Jt})),n.d(e,"y",(function(){return Yt}));var i,r,a=n(0),s=n(15),o=a.string,c=a.string,u=s.i,l=(a.union([u,a[void 0]]),a.string),d=a.string,p=a.intersection([a.exact(a.type({comment:s.i,created_at:o,created_by:c,id:u})),a.exact(a.partial({updated_at:l,updated_by:d}))]),y=a.array(p),f=(a.union([y,a[void 0]]),a.exact(a.type({comment:s.i}))),_=a.array(f),m=(a.union([_,a[void 0]]),a.string),g=(a.union([m,a[void 0]]),a.keyof({agnostic:null,single:null})),x=new a.Type("DefaultNamespace",g.is,(function(t,e){return null==t?a.success("single"):g.validate(t,e)}),a.identity),v=a.array(g),h=new a.Type("DefaultNamespaceArray",v.is,(function(t,e){if(null==t)return a.success(["single"]);if("string"==typeof t){var n=t.trim().split(",").map((function(t){return t.trim()}));return v.validate(n,e)}return a.failure(t,e)}),String),b=a.union([p,f]),E=a.array(b),w=(a.union([E,a[void 0]]),new a.Type("DefaultImportComments",a.array(b).is,(function(t,e){return null==t?a.success([]):a.array(b).validate(t,e)}),a.identity)),A=a.string,O=(a.union([A,a[void 0]]),a.string),T=a.union([O,a[void 0]]),j=a.exact(a.type({field:s.i,operator:s.s,type:a.keyof({match:null}),value:s.i})),I=a.exact(a.type({field:s.i,operator:s.s,type:a.keyof({match_any:null}),value:s.q})),L=a.array(a.union([j,I])),k=new a.Type("NonEmptyEndpointNestedEntriesArray",(function(t){return L.is(t)&&t.length>0}),(function(t,e){return Array.isArray(t)&&0===t.length?a.failure(t,e):L.validate(t,e)}),a.identity),C=a.exact(a.type({entries:k,field:s.i,type:a.keyof({nested:null})})),S=a.exact(a.type({field:s.i,operator:s.s,type:a.keyof({wildcard:null}),value:s.i})),N=a.array(a.union([j,I,S,C])),D=new a.Type("NonEmptyEndpointEntriesArray",(function(t){return N.is(t)&&t.length>0}),(function(t,e){return Array.isArray(t)&&0===t.length?a.failure(t,e):N.validate(t,e)}),a.identity),P=a.keyof({excluded:null,included:null});!function(t){t.INCLUDED="included",t.EXCLUDED="excluded"}(i||(i={})),function(t){t.NESTED="nested",t.MATCH="match",t.MATCH_ANY="match_any",t.WILDCARD="wildcard",t.EXISTS="exists",t.LIST="list"}(r||(r={}));var $,H=a.exact(a.type({field:s.i,operator:P,type:a.keyof({exists:null})})),z=a.keyof({binary:null,boolean:null,byte:null,date:null,date_nanos:null,date_range:null,double:null,double_range:null,float:null,float_range:null,geo_point:null,geo_shape:null,half_float:null,integer:null,integer_range:null,ip:null,ip_range:null,keyword:null,long:null,long_range:null,shape:null,short:null,text:null}),M=(a.union([z,a[void 0]]),a.exact(a.type({field:s.i,list:a.exact(a.type({id:s.i,type:z})),operator:P,type:a.keyof({list:null})}))),U=a.exact(a.type({field:s.i,operator:P,type:a.keyof({match:null}),value:s.i})),W=a.exact(a.type({field:s.i,operator:P,type:a.keyof({match_any:null}),value:s.q})),R=a.exact(a.type({field:s.i,operator:P,type:a.keyof({wildcard:null}),value:s.i})),B=a.union([U,W,H]),F=a.array(B),q=new a.Type("NonEmptyNestedEntriesArray",F.is,(function(t,e){return Array.isArray(t)&&0===t.length?a.failure(t,e):F.validate(t,e)}),a.identity),K=a.exact(a.type({entries:q,field:s.i,type:a.keyof({nested:null})})),X=a.union([U,W,M,H,R]),J=a.array(a.union([U,W,M,H,K,R])),Q=(a.union([J,a[void 0]]),{exported_exception_list_count:a.number,exported_exception_list_item_count:a.number,missing_exception_list_item_count:a.number,missing_exception_list_items:a.array(a.exact(a.type({item_id:s.i}))),missing_exception_lists:a.array(a.exact(a.type({list_id:s.i}))),missing_exception_lists_count:a.number}),G=(a.exact(a.type(Q)),a.keyof({detection:null,endpoint:null,endpoint_trusted_apps:null,endpoint_events:null,endpoint_host_isolation_exceptions:null,endpoint_blocklists:null}));a.union([G,a[void 0]]),function(t){t.DETECTION="detection",t.ENDPOINT="endpoint",t.ENDPOINT_TRUSTED_APPS="endpoint",t.ENDPOINT_EVENTS="endpoint_events",t.ENDPOINT_HOST_ISOLATION_EXCEPTIONS="endpoint_host_isolation_exceptions",t.ENDPOINT_BLOCKLISTS="endpoint_blocklists"}($||($={}));var V=a.keyof({simple:null}),Y=(a.union([V,a[void 0]]),a.string),Z=(a.union([Y,a[void 0]]),a.boolean),tt=(a.union([Z,a[void 0]]),s.i),et=(a.union([tt,a[void 0]]),s.i),nt=(a.union([et,a[void 0]]),a.keyof({item:null,list:null}),a.exact(a.type({id:s.i,list_id:s.i,type:G,namespace_type:g}))),it=a.array(nt),rt=(a.union([it,a[void 0]]),new a.Type("DefaultListArray",a.array(nt).is,(function(t,e){return null==t?a.success([]):a.array(nt).validate(t,e)}),a.identity),s.m),at=(a.union([rt,a[void 0]]),a.object),st=a.union([at,a[void 0]]),ot=a.string,ct=(a.union([ot,a[void 0]]),new a.Type("NonEmptyEntriesArray",J.is,(function(t,e){return Array.isArray(t)&&0===t.length?a.failure(t,e):Array.isArray(t)&&t.some((function(t){return M.is(t)}))&&t.some((function(t){return!M.is(t)}))?a.failure(t,e,"Cannot have entry of type list and other"):J.validate(t,e)}),a.identity)),ut=a.keyof({linux:null,macos:null,windows:null}),lt=Object(s.a)(ut),dt=a.union([lt,a[void 0]]),pt=a.number,yt=(a.union([pt,a[void 0]]),a.number),ft=(a.union([yt,a[void 0]]),a.string),_t=a.exact(a.type({id:ft,keepAlive:a.union([a.string,a[void 0]])})),mt=(a.union([_t,a[void 0]]),a.array(a.string)),gt=(a.union([mt,a[void 0]]),a.string),xt=a.union([gt,a[void 0]]),vt=a.string,ht=(a.union([vt,a[void 0]]),a.keyof({asc:null,desc:null})),bt=(a.union([ht,a[void 0]]),s.b),Et=(a.union([bt,a[void 0]]),a.string),wt=a.number,At=(a.union([wt,a[void 0]]),a.string),Ot=a.union([At,a[void 0]]),Tt=a.intersection([a.exact(a.type({comment:s.i})),a.exact(a.partial({id:u}))]),jt=a.array(Tt),It=(a.union([jt,a[void 0]]),new a.Type("DefaultCreateComments",a.array(f).is,(function(t){return null==t?a.success([]):a.array(f).decode(t)}),a.identity)),Lt=(a.intersection([a.exact(a.type({description:A,entries:D,name:ot,type:V})),a.exact(a.partial({comments:It,item_id:s.d,meta:at,os_types:dt,tags:bt}))]),x),kt=a.intersection([a.exact(a.type({description:A,entries:ct,list_id:et,name:ot,type:V})),a.exact(a.partial({comments:It,item_id:s.d,meta:at,namespace_type:Lt,os_types:dt,tags:bt}))]),Ct=(a.intersection([a.exact(a.type({description:A,name:ot,type:G})),a.exact(a.partial({list_id:s.d,meta:at,namespace_type:Lt,os_types:dt,tags:bt,version:s.e}))]),a.string),St=a.union([Ct,a[void 0]]),Nt=(a.intersection([a.exact(a.type({list_id:et,value:Ct})),a.exact(a.partial({id:u,meta:at}))]),a.intersection([a.exact(a.type({description:A,name:ot,type:z})),a.exact(a.partial({deserializer:O,id:u,meta:at,serializer:gt,version:s.e}))]),a.exact(a.partial({id:u,item_id:tt})),a.exact(a.partial({id:u,list_id:et,namespace_type:Lt})),a.exact(a.partial({id:u,item_id:tt,namespace_type:Lt})),a.intersection([a.exact(a.type({value:St})),a.exact(a.partial({id:u,list_id:et}))]),a.intersection([a.exact(a.type({id:u})),a.exact(a.partial({deleteReferences:s.c,ignoreReferences:s.c}))])),Dt=(a.exact(a.type({id:u,list_id:et,namespace_type:Lt})),a.exact(a.type({list_id:et}))),Pt=(a.exact(a.partial({filter:Y,page:s.n,per_page:s.n,sort_field:vt,sort_order:ht})),a.exact(a.partial({filter:Y,namespace_type:h,page:s.n,per_page:s.n,sort_field:vt,sort_order:ht})),a.intersection([a.exact(a.type({list_id:s.j})),a.exact(a.partial({filter:s.f,namespace_type:h,page:s.n,per_page:s.n,sort_field:vt,sort_order:ht}))]),a.intersection([a.exact(a.type({list_id:et})),a.exact(a.partial({cursor:m,filter:Y,page:s.n,per_page:s.n,sort_field:vt,sort_order:ht}))]),a.exact(a.partial({cursor:m,filter:Y,page:s.n,per_page:s.n,sort_field:vt,sort_order:ht}))),$t=a.exact(a.partial({deserializer:O,list_id:et,serializer:gt,type:z})),Ht=(a.intersection([a.exact(a.type({description:A,name:ot,type:G,list_id:et})),a.exact(a.partial({id:u,immutable:s.k,meta:at,namespace_type:Lt,os_types:dt,tags:bt,created_at:o,updated_at:l,created_by:c,updated_by:d,_version:At,tie_breaker_id:Et,version:s.e}))]),a.intersection([a.exact(a.type({description:A,entries:ct,item_id:tt,list_id:et,name:ot,type:V})),a.exact(a.partial({id:u,comments:w,created_at:o,updated_at:l,created_by:c,updated_by:d,_version:At,tie_breaker_id:Et,meta:at,namespace_type:Lt,os_types:dt,tags:bt}))]),a.object),zt=a.exact(a.type({file:Ht})),Mt=(a.intersection([a.exact(a.type({id:u})),a.exact(a.partial({_version:At,meta:at,value:Ct}))]),a.intersection([a.exact(a.type({id:u})),a.exact(a.partial({_version:At,description:A,meta:at,name:ot,version:s.t}))]),a.exact(a.partial({id:u,item_id:tt})),a.exact(a.partial({id:u,item_id:tt,namespace_type:Lt})),a.exact(a.partial({id:u,list_id:et,namespace_type:Lt})),a.exact(a.partial({id:u,list_id:et,value:Ct})),a.exact(a.type({id:u})),a.exact(a.partial({filter:Y,id:u,list_id:et,namespace_type:Lt})),new a.Type("DefaultUpdateComments",jt.is,(function(t,e){return null==t?a.success([]):jt.validate(t,e)}),a.identity)),Ut=(a.intersection([a.exact(a.type({description:A,entries:ct,name:ot,type:V})),a.exact(a.partial({_version:At,comments:Mt,id:u,item_id:a.union([a.string,a[void 0]]),meta:at,os_types:dt,tags:bt}))]),a.intersection([a.exact(a.type({description:A,entries:ct,name:ot,type:V})),a.exact(a.partial({_version:At,comments:Mt,id:u,item_id:a.union([a.string,a[void 0]]),meta:at,namespace_type:Lt,os_types:dt,tags:bt}))]),n(20),n(38),a.intersection([a.exact(a.type({description:A,name:ot,type:G})),a.exact(a.partial({_version:At,id:u,list_id:et,meta:at,namespace_type:Lt,os_types:dt,tags:bt,version:s.t}))]),a.intersection([a.exact(a.type({id:u,value:Ct})),a.exact(a.partial({_version:At,meta:at}))]),a.intersection([a.exact(a.type({description:A,id:u,name:ot})),a.exact(a.partial({_version:At,meta:at,version:s.t}))]),a.exact(a.type({acknowledged:a.boolean}))),Wt=a.exact(a.type({_version:Ot,created_at:o,created_by:c,description:A,id:u,immutable:Z,list_id:et,meta:st,name:ot,namespace_type:Lt,os_types:lt,tags:bt,tie_breaker_id:Et,type:G,updated_at:l,updated_by:d,version:s.t})),Rt=a.union([Wt,a.exact(a.type({}))]),Bt=a.exact(a.type({_version:Ot,comments:y,created_at:o,created_by:c,description:A,entries:J,id:u,item_id:tt,list_id:et,meta:st,name:ot,namespace_type:Lt,os_types:lt,tags:bt,tie_breaker_id:Et,type:V,updated_at:l,updated_by:d})),Ft=a.intersection([a.exact(a.type({data:a.array(Bt),page:pt,per_page:yt,total:wt})),a.exact(a.partial({pit:ft}))]),qt=a.intersection([a.exact(a.type({data:a.array(Wt),page:pt,per_page:yt,total:wt})),a.exact(a.partial({pit:ft}))]),Kt=a.exact(a.type({_version:Ot,created_at:o,created_by:c,deserializer:T,id:u,list_id:et,meta:st,serializer:xt,tie_breaker_id:Et,type:z,updated_at:l,updated_by:d,value:Ct})),Xt=a.array(Kt),Jt=(a.exact(a.type({cursor:m,data:a.array(Kt),page:pt,per_page:yt,total:wt})),a.exact(a.type({_version:Ot,created_at:o,created_by:c,description:A,deserializer:T,id:u,immutable:Z,meta:st,name:ot,serializer:xt,tie_breaker_id:Et,type:z,updated_at:l,updated_by:d,version:s.t}))),Qt=(a.array(Jt),a.exact(a.type({cursor:m,data:a.array(Jt),page:pt,per_page:yt,total:wt}))),Gt=a.exact(a.type({status_code:a.number,message:a.string})),Vt=a.intersection([a.exact(a.type({error:Gt})),a.partial({id:u,list_id:et,item_id:tt})]),Yt=(a.exact(a.type({errors:a.array(Vt),success:a.boolean,success_count:s.l,success_exception_lists:a.boolean,success_count_exception_lists:s.l,success_exception_list_items:a.boolean,success_count_exception_list_items:s.l})),a.exact(a.type({windows:s.l,linux:s.l,macos:s.l,total:s.l})),a.exact(a.type({list_index:a.boolean,list_item_index:a.boolean}))),Zt=a.exact(a.type({items:Xt,value:a.unknown}));a.array(Zt)},245:function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"d",(function(){return a})),n.d(e,"a",(function(){return s})),n.d(e,"c",(function(){return o}));var i=n(202);const r="policy:",a=`${r}all`,s=[i.m,i.e,i.h,i.b],o=["name","description","entries.value","entries.entries.value","item_id"]},260:function(t,e,n){"use strict";n.d(e,"e",(function(){return u})),n.d(e,"d",(function(){return l})),n.d(e,"b",(function(){return p})),n.d(e,"g",(function(){return f})),n.d(e,"c",(function(){return m})),n.d(e,"f",(function(){return x})),n.d(e,"a",(function(){return E}));var i=n(215),r=n(5),a=n(199),s=n(524),o=n(245);const c=Object.freeze({});function u(t,e=c,n=o.c,u,l=[]){const{filter:d="",page:p=a.b+1,perPage:y=a.c,policies:f=[],excludedPolicies:_=[]}=e,m=Object(r.useMemo)((()=>Object(s.a)({kuery:Object(s.b)(d,n),policies:f,excludedPolicies:_})),[d,n,f,_]);return Object(i.useQuery)([...l,"list",t,m,p,y],(async()=>await t.find({filter:m,perPage:y,page:p,sortField:a.d,sortOrder:a.e})),u)}function l(t,e,n,r){return Object(i.useQuery)(["get",t,e,n],(()=>t.get(e,n)),r)}const d=Object.freeze({});function p(t,e=d){return Object(i.useMutation)((e=>t.create(e)),e)}const y=Object.freeze({});function f(t,e=y){return Object(i.useMutation)((e=>t.update(e)),e)}const _=Object.freeze({});function m(t,e=_){return Object(i.useMutation)((({itemId:e,id:n})=>t.delete(e,n)),e)}const g=Object.freeze({});function x(t,e=g,n=o.c,r){const{filter:a="",policies:c=[]}=e;return Object(i.useQuery)(["summary",t,a,c],(()=>t.summary(Object(s.a)({policies:c,kuery:Object(s.b)(a,n)}))),r)}var v=n(691),h=n.n(v);const b=Object.freeze({});function E(t,e=b,n={concurrency:5}){return Object(i.useMutation)((e=>h()(e,(e=>t.update(e)),n)),e)}Object.freeze({})},301:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var i=n(5),r=n(18);const a=(t,e)=>{const{services:n}=Object(r.j)(),{path:a,state:s,onClick:o,deepLinkId:c,openInNewTab:u}=e||{};return Object(i.useCallback)((e=>{try{o&&o(e)}catch(t){throw e.preventDefault(),t}e.defaultPrevented||0===e.button&&(e.currentTarget instanceof HTMLAnchorElement&&""!==e.currentTarget.target&&"_self"!==e.currentTarget.target||e.metaKey||e.altKey||e.ctrlKey||e.shiftKey||(e.preventDefault(),n.application.navigateToApp(t,{deepLinkId:c,path:a,state:s,openInNewTab:u})))}),[t,c,o,a,n.application,s,u])}},316:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var i=n(50),r=n.n(i),a=n(5),s=n.n(a),o=n(16),c=n(301),u=n(1);const l=Object(a.memo)((({appId:t=u.y,deepLinkId:e,appPath:n,appState:i,onClick:a,asButton:l,children:d,...p})=>{const y=Object(c.a)(t,{deepLinkId:e,path:n,state:i,onClick:a});return s.a.createElement(s.a.Fragment,null,l&&!0===l?s.a.createElement(o.EuiButton,r()({},p,{onClick:y}),d):s.a.createElement(o.EuiLink,r()({},p,{onClick:y}),d))}))},335:function(t,e,n){"use strict";n.d(e,"a",(function(){return ExceptionsListApiClient}));var i=n(10),r=n.n(i),a=n(202),s=n(199);class ExceptionsListApiClient{constructor(t,e,n,i,a){r()(this,"ensureListExists",void 0),this.http=t,this.listId=e,this.listDefinition=n,this.readTransform=i,this.writeTransform=a,this.ensureListExists=this.createExceptionList()}async createExceptionList(){return ExceptionsListApiClient.wasListCreated.has(this.listId)||ExceptionsListApiClient.wasListCreated.set(this.listId,new Promise(((t,e)=>{(async()=>{try{await this.http.post(a.r,{body:JSON.stringify({...this.listDefinition,list_id:this.listId})}),t()}catch(i){var n;409!==(null===(n=i.response)||void 0===n?void 0:n.status)&&(ExceptionsListApiClient.wasListCreated.delete(this.listId),e(i)),t()}})()}))),ExceptionsListApiClient.wasListCreated.get(this.listId)}checkIfIsUsingTheRightInstance(t){if(t!==this.listId)throw new Error(`The list id you are using is not valid, expected [${this.listId}] list id but received [${t}] list id`)}isHttp(t){return this.http===t}static getInstance(t,e,n,i,r){var a;ExceptionsListApiClient.instance.has(e)&&null!==(a=ExceptionsListApiClient.instance.get(e))&&void 0!==a&&a.isHttp(t)||ExceptionsListApiClient.instance.set(e,new ExceptionsListApiClient(t,e,n,i,r));return ExceptionsListApiClient.instance.get(e)||new ExceptionsListApiClient(t,e,n,i,r)}static cleanExceptionsBeforeUpdate(t){var e;const n={...t};return["created_at","created_by","list_id","tie_breaker_id","updated_at","updated_by","meta"].forEach((t=>{delete n[t]})),n.comments=null===(e=n.comments)||void 0===e?void 0:e.map((t=>({comment:t.comment,id:t.id}))),n}async find({perPage:t=s.c,page:e=s.b+1,sortField:n,sortOrder:i,filter:r}={}){await this.ensureListExists;const o=await this.http.get(`${a.o}/_find`,{query:{page:e,per_page:t,sort_field:n,sort_order:i,list_id:[this.listId],namespace_type:["agnostic"],filter:r}});return this.readTransform&&(o.data=o.data.map(this.readTransform)),o}async get(t,e){if(!t&&!e)throw TypeError("either `itemId` or `id` argument must be set");await this.ensureListExists;let n=await this.http.get(a.o,{query:{id:e,item_id:t,namespace_type:"agnostic"}});return this.readTransform&&(n=this.readTransform(n)),n}async create(t){await this.ensureListExists,this.checkIfIsUsingTheRightInstance(t.list_id),delete t.meta;let e=t;return this.writeTransform&&(e=this.writeTransform(t)),this.http.post(a.o,{body:JSON.stringify(e)})}async update(t){await this.ensureListExists;let e=t;return this.writeTransform&&(e=this.writeTransform(t)),this.http.put(a.o,{body:JSON.stringify(ExceptionsListApiClient.cleanExceptionsBeforeUpdate(e))})}async delete(t,e){if(!t&&!e)throw TypeError("either `itemId` or `id` argument must be set");return await this.ensureListExists,this.http.delete(a.o,{query:{id:e,item_id:t,namespace_type:"agnostic"}})}async summary(t){return await this.ensureListExists,this.http.get(`${a.r}/summary`,{query:{filter:t,list_id:this.listId,namespace_type:"agnostic"}})}async hasData(){return(await this.find({perPage:1,page:1})).total>0}}r()(ExceptionsListApiClient,"instance",new Map),r()(ExceptionsListApiClient,"wasListCreated",new Map)},379:function(t,e,n){"use strict";n.d(e,"c",(function(){return a})),n.d(e,"b",(function(){return s})),n.d(e,"d",(function(){return o}));var i=n(219),r=n(202);n.d(e,"a",(function(){return r.e}));const a=i.a.ENDPOINT_EVENTS,s={name:r.f,namespace_type:"agnostic",description:r.d,list_id:r.e,type:a},o=["name","description","entries.value","entries.entries.value","comments.comment","item_id"]},416:function(t,e,n){"use strict";n.d(e,"a",(function(){return EventFiltersApiClient}));var i=n(202),r=n(335),a=n(379);class EventFiltersApiClient extends r.a{constructor(t){super(t,i.e,a.b)}static getInstance(t){return super.getInstance(t,i.e,a.b)}}},425:function(t,e,n){"use strict";n.d(e,"b",(function(){return c})),n.d(e,"a",(function(){return u}));var i=n(5),r=n(18),a=n(76);const s=(t,e,n)=>{const i=t.isPlatinumPlus(),r=n.includes("superuser");return{canAccessFleet:r,canAccessEndpointManagement:r,canCreateArtifactsByPolicy:r&&i,canIsolateHost:i&&r,canUnIsolateHost:r}};var o=n(647);const c=()=>{var t;const e=Object(r.f)(),n=Object(r.j)().services.fleet,c=null===(t=Object(o.b)())||void 0===t?void 0:t.fleet,u=Object(i.useRef)(!0),l=Object(a.b)(),[d,p]=Object(i.useState)(!1),[y,f]=Object(i.useState)(null),[_,m]=Object(i.useState)(!1),[g,x]=Object(i.useState)([]),v=null!=n?n:c,h=Object(i.useMemo)((()=>Object.freeze({loading:!d||!_||!e,...y?s(l,0,g):{canAccessFleet:!1,canAccessEndpointManagement:!1,canCreateArtifactsByPolicy:!1,canIsolateHost:!1,canUnIsolateHost:!0}})),[d,_,e,y,l,g]);return Object(i.useEffect)((()=>{v?(p(!1),(async()=>{try{const t=await v.authz;u.current&&f(t)}finally{u.current&&p(!0)}})()):p(!0)}),[v]),Object(i.useEffect)((()=>{(async()=>{e&&u.current&&(x(null==e?void 0:e.roles),m(!0))})()}),[e]),Object(i.useEffect)((()=>()=>{u.current=!1}),[]),h},u=()=>({loading:!0,canAccessFleet:!1,canAccessEndpointManagement:!1,canCreateArtifactsByPolicy:!1,canIsolateHost:!1,canUnIsolateHost:!0})},524:function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return s}));var i=n(3);const r=(t,e)=>t?`(${e.map((e=>`exception-list-agnostic.attributes.${e}:(*${t.trim().replace(/([\)\(\<\>\}\{\"\:\\])/gm,"\\$&").replace(/\s/gm,"*")}*)`)).join(" OR ")})`:"",a=t=>"global"===t?'exception-list-agnostic.attributes.tags:"policy:all"':"unassigned"===t?"(not exception-list-agnostic.attributes.tags:*)":`exception-list-agnostic.attributes.tags:"policy:${t}"`,s=({policies:t=[],excludedPolicies:e=[],kuery:n})=>{if(0===(null==t?void 0:t.length)&&0===(null==e?void 0:e.length))return n||void 0;const r=((t,e=[])=>{if(Object(i.isEmpty)(t)&&Object(i.isEmpty)(e))return"";const n=t.map(a).join(" OR "),r=e.map((t=>`not ${a(t)}`)).join(" AND "),s=[];return n&&s.push(n),r&&s.push(r),`(${s.join(" AND ")})`})(t,e);return`(${r})${n?` AND (${n})`:""}`}},691:function(t,e,n){"use strict";const i=n(990);t.exports=async(t,e,{concurrency:n=1/0,stopOnError:r=!0}={})=>new Promise(((a,s)=>{if("function"!=typeof e)throw new TypeError("Mapper function is required");if(!Number.isSafeInteger(n)&&n!==1/0||!(n>=1))throw new TypeError(`Expected \`concurrency\` to be an integer from 1 and up or \`Infinity\`, got \`${n}\` (${typeof n})`);const o=[],c=[],u=t[Symbol.iterator]();let l=!1,d=!1,p=0,y=0;const f=()=>{if(l)return;const t=u.next(),n=y;if(y++,t.done)return d=!0,void(0===p&&(r||0===c.length?a(o):s(new i(c))));p++,(async()=>{try{const i=await t.value;o[n]=await e(i,n),p--,f()}catch(t){r?(l=!0,s(t)):(c.push(t),p--,f())}})()};for(let t=0;t<n&&(f(),!d);t++);}))},896:function(t,e,n){var i=n(897);t.exports=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=i(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){c=!0,s=t},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw s}}}},t.exports.__esModule=!0,t.exports.default=t.exports},897:function(t,e,n){t.exports=n(24)(991)},990:function(t,e,n){"use strict";const i=n(991),r=n(992);class AggregateError extends Error{constructor(t){if(!Array.isArray(t))throw new TypeError("Expected input to be an Array, got "+typeof t);let e=(t=[...t].map((t=>t instanceof Error?t:null!==t&&"object"==typeof t?Object.assign(new Error(t.message),t):new Error(t)))).map((t=>"string"==typeof t.stack?r(t.stack).replace(/\s+at .*aggregate-error\/index.js:\d+:\d+\)?/g,""):String(t))).join("\n");e="\n"+i(e,4),super(e),this.name="AggregateError",Object.defineProperty(this,"_errors",{value:t})}*[Symbol.iterator](){for(const t of this._errors)yield t}}t.exports=AggregateError},991:function(t,e,n){"use strict";t.exports=(t,e=1,n)=>{if(n={indent:" ",includeEmptyLines:!1,...n},"string"!=typeof t)throw new TypeError(`Expected \`input\` to be a \`string\`, got \`${typeof t}\``);if("number"!=typeof e)throw new TypeError(`Expected \`count\` to be a \`number\`, got \`${typeof e}\``);if("string"!=typeof n.indent)throw new TypeError(`Expected \`options.indent\` to be a \`string\`, got \`${typeof n.indent}\``);if(0===e)return t;const i=n.includeEmptyLines?/^/gm:/^(?!\s*$)/gm;return t.replace(i,n.indent.repeat(e))}},992:function(t,e,n){"use strict";const i=n(993),r=/\s+at.*(?:\(|\s)(.*)\)?/,a=/^(?:(?:(?:node|(?:internal\/[\w/]*|.*node_modules\/(?:babel-polyfill|pirates)\/.*)?\w+)\.js:\d+:\d+)|native)/,s=void 0===i.homedir?"":i.homedir();t.exports=(t,e)=>(e=Object.assign({pretty:!1},e),t.replace(/\\/g,"/").split("\n").filter((t=>{const e=t.match(r);if(null===e||!e[1])return!0;const n=e[1];return!n.includes(".app/Contents/Resources/electron.asar")&&!n.includes(".app/Contents/Resources/default_app.asar")&&!a.test(n)})).filter((t=>""!==t.trim())).map((t=>e.pretty?t.replace(r,((t,e)=>t.replace(e,e.replace(s,"~")))):t)).join("\n"))},993:function(t,e){}}]);