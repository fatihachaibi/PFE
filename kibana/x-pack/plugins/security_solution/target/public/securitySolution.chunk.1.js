/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[1],{1006:function(e,t,n){"use strict";e.exports=function(e){if(!e)return[];for(var t=[],n="",a="",o=0,r=(e=e.replace(/[\s]{2}/g," ")).length;o<r;o++){var s=e[o];" "===s?n.length?a+=s:a&&(t.push(a),a=""):'"'===s||"'"===s?n?n===s?(a+=s,t.push(a),n="",a=""):'"'===n||"'"===n?a+=s:(a+=s,n=s):(a+=s,n=s):a+=s}return a&&t.push(a),t}},193:function(e,t,n){"use strict";n.d(t,"e",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"d",(function(){return m})),n.d(t,"c",(function(){return p})),n.d(t,"a",(function(){return E})),n.d(t,"f",(function(){return f}));var a=n(3),o=n(5),r=n.n(o),s=n(23),i=n.n(s);const l=n(4).i18n.translate("xpack.securitySolution.emptyString.emptyStringDescription",{defaultMessage:"Empty string"}),c=i.a.span.withConfig({displayName:"EmptyWrapper",componentId:"sc-1v50emf-0"})(["color:",";"],(e=>e.theme.eui.euiColorMediumShade));c.displayName="EmptyWrapper";const u=()=>"â€”",d=()=>`(${l})`,m=()=>r.a.createElement(c,null,u()),p=()=>r.a.createElement(c,null,d()),E=e=>null==e?m():Object(a.isString)(e)&&""===e?p():r.a.createElement(r.a.Fragment,null,e),f=e=>null==e?m():""===e?p():r.a.createElement(r.a.Fragment,null,e)},195:function(e,t,n){"use strict";n.d(t,"g",(function(){return j.d})),n.d(t,"f",(function(){return j.c})),n.d(t,"m",(function(){return y})),n.d(t,"d",(function(){return k})),n.d(t,"h",(function(){return w})),n.d(t,"a",(function(){return T})),n.d(t,"c",(function(){return M})),n.d(t,"i",(function(){return R})),n.d(t,"e",(function(){return A})),n.d(t,"b",(function(){return F})),n.d(t,"j",(function(){return U})),n.d(t,"n",(function(){return B})),n.d(t,"o",(function(){return _})),n.d(t,"p",(function(){return H})),n.d(t,"l",(function(){return G})),n.d(t,"k",(function(){return q}));var a=n(50),o=n.n(a),r=n(16),s=n(5),i=n.n(s),l=n(3),c=n(1),u=n(97),d=n(221),m=n(94),p=n(18),E=n(261),f=n(4),b=n(402);const g=e=>f.i18n.translate("xpack.securitySolution.cases.caseTable.caseDetailsLinkAria",{values:{detailName:e},defaultMessage:"click to visit case with title {detailName}"});var h=n(8),O=n(692),j=n(403);const v=({children:e,Component:t,userName:n,isButton:a,onClick:o,title:r,userTab:l})=>{const u=encodeURIComponent(n),{formatUrl:m,search:E}=Object(d.k)(h.a.users),{navigateToApp:f}=Object(p.j)().services.application,b=Object(s.useCallback)((e=>{e.preventDefault(),f(c.y,{deepLinkId:h.a.users,path:l?Object(O.a)(u,l,E):Object(O.b)(u,E)})}),[u,f,E,l]),g=Object(s.useMemo)((()=>m(l?Object(O.a)(u,l):Object(O.b)(u))),[m,u,l]);return a?i.a.createElement(j.b,{Component:t,dataTestSubj:"data-grid-user-details",href:g,onClick:null!=o?o:b,title:null!=r?r:n},e||n):i.a.createElement(j.c,{"data-test-subj":"users-link-anchor",onClick:null!=o?o:b,href:g},e||n)},y=i.a.memo(v),I=({children:e,Component:t,hostName:n,isButton:a,onClick:o,title:r,hostTab:l})=>{const{formatUrl:u,search:m}=Object(d.k)(h.a.hosts),{navigateToApp:E}=Object(p.j)().services.application,f=encodeURIComponent(n),b=Object(s.useCallback)((e=>{e.preventDefault(),E(c.y,{deepLinkId:h.a.hosts,path:l?Object(d.h)(f,l,m):Object(d.d)(f,m)})}),[f,E,m,l]),g=Object(s.useMemo)((()=>u(l?Object(d.h)(f,l):Object(d.d)(f))),[u,f,l]);return a?i.a.createElement(j.b,{Component:t,dataTestSubj:"data-grid-host-details",href:g,iconType:"expand",onClick:null!=o?o:b,title:null!=r?r:n},e):i.a.createElement(j.c,{onClick:null!=o?o:b,href:g,"data-test-subj":"host-details-button"},e||n)},k=i.a.memo(I),S=["http://","https://"],C=i.a.memo((({url:e,children:t,idx:n,overflowIndexStart:a=5,allItemsLimit:o=5})=>{const s=a-1,c=o-1,u=Math.max(0,Math.min(s,c)),d=S.some((t=>0===e.indexOf(t)));return e&&d&&!Object(E.c)(e)&&t?i.a.createElement(r.EuiToolTip,{content:e,position:"top","data-test-subj":"externalLinkTooltip"},i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiLink,{href:e,target:"_blank",rel:"noopener","data-test-subj":"externalLink"},t),!Object(l.isNil)(n)&&n<u&&i.a.createElement(j.a,{"data-test-subj":"externalLinkComma"}))):null}));C.displayName="ExternalLink";const x=({Component:e,children:t,ip:n,flowTarget:a=m.a.source,isButton:o,onClick:r,title:E})=>{const{formatUrl:f,search:b}=Object(d.k)(h.a.network),{navigateToApp:g}=Object(p.j)().services.application,O=Object(s.useCallback)(((e,t)=>{e.preventDefault(),g(c.y,{deepLinkId:h.a.network,path:Object(d.e)(encodeURIComponent(Object(u.d)(t)),a,b)})}),[a,g,b]),v=Object(s.useCallback)((e=>f(Object(d.e)(encodeURIComponent(Object(u.d)(e))))),[f]),y=Object(s.useCallback)(((n,a)=>o?i.a.createElement(j.b,{Component:e,key:`${n}-${a}`,dataTestSubj:"data-grid-network-details",onClick:null!=r?r:e=>O(e,n),href:v(n),title:null!=E?E:n},t):i.a.createElement(j.c,{key:`${n}-${a}`,onClick:null!=r?r:e=>O(e,n),href:v(n),"data-test-subj":"network-details"},t||n)),[e,t,v,O,o,r,E]);return Object(l.isArray)(n)?i.a.createElement(i.a.Fragment,null,n.map(y)):y(n,0)},w=i.a.memo(x),N=({children:e,detailName:t,title:n})=>{const{formatUrl:a,search:o}=Object(d.k)(h.a.case),{navigateToApp:r}=Object(p.j)().services.application,l=Object(s.useCallback)((async e=>(e.preventDefault(),r(c.y,{deepLinkId:h.a.case,path:Object(d.a)({id:t,search:o})}))),[t,r,o]);return i.a.createElement(j.c,{onClick:l,href:a(Object(d.a)({id:t})),"data-test-subj":"case-details-link","aria-label":g(null!=n?n:t)},e||t)},T=i.a.memo(N);T.displayName="CaseDetailsLink",i.a.memo((({children:e})=>{const{formatUrl:t,search:n}=Object(d.k)(h.a.case),{navigateToApp:a}=Object(p.j)().services.application,o=Object(s.useCallback)((async e=>(e.preventDefault(),a(c.y,{deepLinkId:h.a.case,path:Object(d.b)(n)}))),[a,n]);return i.a.createElement(j.c,{onClick:o,href:t(Object(d.b)())},e)})).displayName="CreateCaseLink";const M=i.a.memo((({children:e,link:t})=>{const n=Object(s.useMemo)((()=>`https://www.google.com/search?q=${encodeURIComponent(t)}`),[t]);return i.a.createElement(C,{url:n},e||t)}));M.displayName="GoogleLink";const R=i.a.memo((({Component:e,title:t,children:n,portOrServiceName:a})=>{var o;const l=Object(s.useMemo)((()=>`https://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xhtml?search=${encodeURIComponent(String(a))}`),[a]);return e?i.a.createElement(e,{href:l,"data-test-subj":"data-grid-port-or-service-name-link",title:t,iconType:"link"},null!==(o=null!=t?t:n)&&void 0!==o?o:a):i.a.createElement(j.e,null,i.a.createElement(r.EuiLink,{"data-test-subj":"port-or-service-name-link",href:l,target:"_blank"},n||a))}));R.displayName="PortOrServiceNameLink";const A=i.a.memo((({children:e,ja3Fingerprint:t})=>{const n=Object(s.useMemo)((()=>`https://sslbl.abuse.ch/ja3-fingerprints/${encodeURIComponent(t)}`),[t]);return i.a.createElement(r.EuiLink,{"data-test-subj":"ja3-fingerprint-link",href:n,target:"_blank"},e||t)}));A.displayName="Ja3FingerprintLink";const F=i.a.memo((({children:e,certificateFingerprint:t})=>{const n=Object(s.useMemo)((()=>`https://sslbl.abuse.ch/ssl-certificates/sha1/${encodeURIComponent(t)}`),[t]);return i.a.createElement(r.EuiLink,{"data-test-subj":"certificate-fingerprint-link",href:n,target:"_blank"},e||t)}));var L;function $(e){return e===L["virustotal.com"]||e===L["talosIntelligence.com"]}F.displayName="CertificateFingerprintLink",function(e){e["virustotal.com"]="virustotal.com",e["talosIntelligence.com"]="talosIntelligence.com"}(L||(L={}));const D={[L["virustotal.com"]]:b.m,[L["talosIntelligence.com"]]:b.l},P=({overflowIndexStart:e=5,allItemsLimit:t=5,showDomain:n=!1,domain:a,direction:o="row"})=>{const[u]=Object(p.p)(c.Cb),d=Object(s.useMemo)((()=>null==u?void 0:u.slice(0,t).filter((({url_template:e,name:t})=>!Object(l.isNil)(e)&&!Object(l.isNil)(t)&&!Object(E.c)(e))).map((({name:e,url_template:t})=>({name:$(e)?D[e]:e,url_template:t.replace("{{ip}}",encodeURIComponent(a))})))),[u,a,D,t]),m=Object(s.useCallback)((n=>{var o;return(e=>void 0!==e.url_template&&void 0!==e.name)(n)&&i.a.createElement(C,{url:n.url_template,overflowIndexStart:e,allItemsLimit:t},i.a.createElement(i.a.Fragment,null,null!==(o=n.name)&&void 0!==o?o:a))}),[t,a,e]);return(null==d?void 0:d.length)>0?i.a.createElement("section",null,i.a.createElement(r.EuiFlexGroup,{gutterSize:"none",justifyContent:"center",direction:o,alignItems:"center","data-test-subj":"reputationLinkGroup"},i.a.createElement(r.EuiFlexItem,{grow:!0},null==d?void 0:d.slice(0,e).map((({name:t,url_template:o},r)=>i.a.createElement(C,{allItemsLimit:d.length,idx:r,overflowIndexStart:e,url:o,"data-test-subj":"externalLinkComponent",key:`reputationLink-${r}`},i.a.createElement(i.a.Fragment,null,n?a:null!=t?t:a))))),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(j.f,{rowItems:d,render:m,moreMaxHeight:"200px",overflowIndexStart:e})))):null};P.displayName="ReputationLinkComponent";const U=i.a.memo(P),B=i.a.memo((({children:e,domain:t})=>{const n=Object(s.useMemo)((()=>`https://www.iana.org/whois?q=${encodeURIComponent(t)}`),[t]);return i.a.createElement(C,{url:n},e||t)}));B.displayName="WhoIsLink";const _=()=>{const e=Object(d.l)(),{navigateTo:t}=Object(p.k)();return Object(s.useCallback)((({deepLinkId:n,path:a,onClick:o})=>{const r=e({deepLinkId:n,path:a});return{href:r,onClick:e=>{e.preventDefault(),t({url:r}),o&&o(e)}}}),[e,t])},H=e=>({deepLinkId:t,path:n,onClick:a,...r})=>{const s=_(),{onClick:l,href:c}=s({deepLinkId:t,path:n,onClick:a});return i.a.createElement(e,o()({onClick:l,href:c},r))},G=H(j.d),q=H(j.c)},200:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(42),o=n(68);const r=Object(o.b)(),s=e=>{const t=i();if(!t||!(e in t))throw new Error(`Invalid enable value ${e}. Allowed values are: ${r.join(", ")}`);return t[e]},i=()=>Object(a.useSelector)((({app:{enableExperimental:e}})=>e))},201:function(e,t,n){"use strict";n.d(t,"c",(function(){return m})),n.d(t,"d",(function(){return p})),n.d(t,"e",(function(){return f})),n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return g}));var a=n(64),o=n.n(a),r=n(5),s=n.n(r),i=n(165),l=n(18),c=n(193),u=n(711),d=n(83);const m=s.a.memo((({value:e,dateFormat:t=Object(l.g)()})=>s.a.createElement(s.a.Fragment,null,o.a.tz(e,Object(l.m)()).format(t))));m.displayName="PreferenceFormattedDate";const p=({value:e})=>{if(null==e)return Object(c.f)(e);const t=Object(d.a)(e);if(!t.isValid())return Object(c.f)(e);const n=t.toDate();return s.a.createElement(m,{value:n})};p.displayName="PreferenceFormattedDateFromPrimitive";const E=e=>Array.isArray(e)&&"P1DT"===e[0]&&2===e.length,f=s.a.memo((({value:e})=>{const[t]=Object(l.p)("dateFormat:scaled"),n=Array.isArray(t)?t.find(E):null,a=Array.isArray(n)&&2===n.length?n[1]:"YYYY-MM-DD";return s.a.createElement(m,{dateFormat:a,value:e})}));f.displayName="PreferenceFormattedP1DTDate";const b=s.a.memo((({value:e,fieldName:t,className:n="",dateFormat:a})=>{if(null==e)return Object(c.f)(e);const o=Object(d.a)(e);return o.isValid()?s.a.createElement(u.a,{date:o.toDate(),fieldName:t,className:n},s.a.createElement(m,{value:o.toDate(),dateFormat:a})):Object(c.f)(e)}));b.displayName="FormattedDate";const g=s.a.memo((({value:e,dateFormat:t,tooltipFieldName:n,tooltipAnchorClassName:a,relativeThresholdInHrs:r=1})=>{if(null==e)return Object(c.f)(e);const l=Object(d.a)(e);if(!l.isValid())return Object(c.f)(e);const p=l.toDate(),E=o()(p).add(r,"hours").isBefore(new Date);return s.a.createElement(u.a,{date:p,fieldName:n,className:a},E?s.a.createElement(m,{"data-test-subj":"preference-time",value:p,dateFormat:t}):s.a.createElement(i.FormattedRelative,{"data-test-subj":"relative-time",value:p}))}));g.displayName="FormattedRelativePreferenceDate"},221:function(e,t,n){"use strict";n.d(t,"c",(function(){return d.a})),n.d(t,"g",(function(){return d.c})),n.d(t,"d",(function(){return m.a})),n.d(t,"h",(function(){return m.b})),n.d(t,"f",(function(){return p.b})),n.d(t,"e",(function(){return p.a})),n.d(t,"i",(function(){return f})),n.d(t,"j",(function(){return b})),n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return h})),n.d(t,"k",(function(){return O})),n.d(t,"l",(function(){return j}));var a=n(3),o=n(5),r=n(71),s=n(271),i=n(331),l=n(442),c=n(91),u=n(8),d=n(246),m=n(336),p=n(448),E=n(273);const f=(e,t)=>`/${e}${Object(E.a)(t)}`,b=(e,t)=>`?timeline=(id:'${e}',isOpen:!t${Object(a.isEmpty)(t)?")":`,graphEventId:'${t}')`}`,g=({id:e,search:t})=>`/${encodeURIComponent(e)}${Object(E.a)(null!=t?t:void 0)}`,h=e=>`/create${Object(E.a)(null!=e?e:void 0)}`,O=e=>{const{getAppUrl:t}=Object(c.b)(),n=(e=>{const t=Object(s.i)(),{urlState:n}=Object(r.a)(t);return Object(o.useMemo)((()=>e?Object(i.a)(e,n):""),[e,n])})(e in l.a?l.a[e]:void 0);return{formatUrl:Object(o.useCallback)(((a,{absolute:o=!1,skipSearch:r=!1}={})=>{const s=v(a,n,r);return t({deepLinkId:e,path:s,absolute:o})}),[t,e,n]),search:n}},j=()=>{const{getAppUrl:e}=Object(c.b)(),t=(()=>{const e=Object(s.i)(),{urlState:t}=Object(r.a)(e);return Object(o.useCallback)((()=>Object(i.b)(t)),[t])})();return Object(o.useCallback)((({deepLinkId:n,path:a="",absolute:o=!1,skipSearch:r=!1})=>{var s;const i=v(a,(s=n)!==u.a.dashboardsLanding&&s!==u.a.exploreLanding&&s!==u.a.administration&&s!==u.a.rules&&s!==u.a.exceptions&&s!==u.a.endpoints&&s!==u.a.policies&&s!==u.a.trustedApps&&s!==u.a.eventFilters&&s!==u.a.blocklist&&s!==u.a.hostIsolationExceptions?t():"",r);return e({deepLinkId:n,path:i,absolute:o})}),[e,t])};function v(e,t,n){const[o,r]=e.split("?");return`${o}${n?Object(a.isEmpty)(r)?"":`?${r}`:Object(a.isEmpty)(r)?t:`?${r}${Object(a.isEmpty)(t)?"":`&${t}`}`}`}},243:function(e,t,n){const a=n(458),{MAX_LENGTH:o,MAX_SAFE_INTEGER:r}=n(459),{re:s,t:i}=n(377),l=n(460),{compareIdentifiers:c}=n(545);class SemVer{constructor(e,t){if(t=l(t),e instanceof SemVer){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError(`Invalid Version: ${e}`);if(e.length>o)throw new TypeError(`version is longer than ${o} characters`);a("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const n=e.trim().match(t.loose?s[i.LOOSE]:s[i.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>r||this.major<0)throw new TypeError("Invalid major version");if(this.minor>r||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>r||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<r)return t}return e})):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(a("SemVer.compare",this.version,this.options,e),!(e instanceof SemVer)){if("string"==typeof e&&e===this.version)return 0;e=new SemVer(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof SemVer||(e=new SemVer(e,this.options)),c(this.major,e.major)||c(this.minor,e.minor)||c(this.patch,e.patch)}comparePre(e){if(e instanceof SemVer||(e=new SemVer(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const n=this.prerelease[t],o=e.prerelease[t];if(a("prerelease compare",t,n,o),void 0===n&&void 0===o)return 0;if(void 0===o)return 1;if(void 0===n)return-1;if(n!==o)return c(n,o)}while(++t)}compareBuild(e){e instanceof SemVer||(e=new SemVer(e,this.options));let t=0;do{const n=this.build[t],o=e.build[t];if(a("prerelease compare",t,n,o),void 0===n&&void 0===o)return 0;if(void 0===o)return 1;if(void 0===n)return-1;if(n!==o)return c(n,o)}while(++t)}inc(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{let e=this.prerelease.length;for(;--e>=0;)"number"==typeof this.prerelease[e]&&(this.prerelease[e]++,e=-2);-1===e&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error(`invalid increment argument: ${e}`)}return this.format(),this.raw=this.version,this}}e.exports=SemVer},246:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return r})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return i}));var a=n(273);const o=e=>`${Object(a.a)(e)}`,r=e=>`${Object(a.a)(e)}`,s=(e,t)=>`/id/${e}${Object(a.a)(t)}`,i=(e,t)=>`/id/${e}/edit${Object(a.a)(t)}`},261:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return i}));var a=n(3);const o=e=>{var t;return Boolean(null===(t=e.Endpoint.state)||void 0===t?void 0:t.isolation)},r=["http:","https:"],s=e=>{try{if(null!=e){if(""===e)return!1;{const t=new URL(e);if(r.includes(t.protocol)&&e.startsWith(`${t.protocol}//`))return!1}}}catch(e){}return!0};function i(e){return Object(a.isNumber)(e)||!Object(a.isEmpty)(e)}},264:function(e,t,n){const a=n(243);e.exports=(e,t,n)=>new a(e,n).compare(new a(t,n))},271:function(e,t,n){"use strict";n.d(t,"g",(function(){return f})),n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return g})),n.d(t,"d",(function(){return h})),n.d(t,"c",(function(){return O})),n.d(t,"k",(function(){return j})),n.d(t,"j",(function(){return v})),n.d(t,"f",(function(){return y})),n.d(t,"e",(function(){return I})),n.d(t,"i",(function(){return k})),n.d(t,"m",(function(){return S})),n.d(t,"h",(function(){return C})),n.d(t,"l",(function(){return x}));var a=n(3),o=n(396),r=n(175),s=n(98),i=n(14),l=n(8),c=n(73),u=n(84),d=n(364),m=n(139),p=n(29),E=n(13);const f=e=>e===l.a.alerts||e===l.a.rules||e===l.a.rulesCreate||e===l.a.exceptions,b=e=>{try{return e?Object(r.decode)(e):null}catch(e){if(e instanceof Error&&e.message.startsWith("rison decoder error"))return null;throw e}},g=e=>Object(r.encode)(e),h=e=>e.substring(1),O=(e,t)=>{const n=Object(o.parse)(e,{sort:!1})[t];return Array.isArray(n)?n[0]:n},j=(e,t)=>n=>{const a=Object(o.parse)(n,{sort:!1});if(null==t||"string"==typeof t&&""===t)return delete a[e],Object(o.stringify)(s.url.encodeQuery(a),{sort:!1,encode:!1});const r=void 0===t?a:{...a,[e]:g(t)};return Object(o.stringify)(s.url.encodeQuery(r),{sort:!1,encode:!1})},v=(e,t)=>t===h(e.search)?e:{...e,search:`?${t}`},y=e=>e===l.a.overview?"overview":e===l.a.landing?"get_started":e===l.a.hosts?"host":e===l.a.network?"network":e===l.a.alerts?"alerts":e===l.a.rules||e===l.a.rulesCreate?"rules":e===l.a.exceptions?"exceptions":e===l.a.timelines?"timeline":e===l.a.case?"cases":e===l.a.administration?"administration":"overview",I=(e,t)=>null!=t[e]?t[e].name:"",k=()=>{const e=c.e.inputsSelector(),t=c.e.globalQuerySelector(),n=c.e.globalFiltersQuerySelector(),a=c.e.globalSavedQuerySelector(),o=u.b.getTimelineByIdSelector(),r=p.d.scopesSelector();return s=>{var l;const c=e(s),{linkTo:u,timerange:d}=c.global,{linkTo:p,timerange:f}=c.timeline,b=o(s,i.i.active),g=null!=b?{id:null!=b.savedObjectId?b.savedObjectId:"",isOpen:b.show,activeTab:b.activeTab,graphEventId:null!==(l=b.graphEventId)&&void 0!==l?l:""}:{id:"",isOpen:!1,activeTab:i.l.query,graphEventId:""};let h={[m.a.appQuery]:t(s),[m.a.filters]:n(s)};const O=a(s);null!=O&&""!==O.id&&(h={[m.a.savedQuery]:O.id});const j=r(s),v=Object.keys(j).filter((e=>e===E.SourcererScopeName.default)).reduce(((e,t)=>{var n,a;return{...e,[t]:{id:null===(n=j[t])||void 0===n?void 0:n.selectedDataViewId,selectedPatterns:null===(a=j[t])||void 0===a?void 0:a.selectedPatterns}}}),{});return{urlState:{...h,[m.a.sourcerer]:v,[m.a.timerange]:{global:{[m.a.timerange]:d,linkTo:u},timeline:{[m.a.timerange]:f,linkTo:p}},[m.a.timeline]:g}}}},S=(e,t)=>("relative"===e.global.timerange.kind&&(e.global.timerange.from=Object(d.c)(e.global.timerange.fromStr),e.global.timerange.to=Object(d.c)(e.global.timerange.toStr,{roundUp:!0})),"relative"===e.timeline.timerange.kind&&t&&(e.timeline.timerange.from=Object(d.c)(e.timeline.timerange.fromStr),e.timeline.timerange.to=Object(d.c)(e.timeline.timerange.toStr,{roundUp:!0})),e),C=(e,t)=>null==e||t===m.a.appQuery&&Object(a.isEmpty)(e.query)||t===m.a.filters&&Object(a.isEmpty)(e)||t===m.a.timeline&&""===e.id,x=(e,t,n,a)=>{const o={hash:"",pathname:t,search:n,state:""},r=h(n),s=e.reduce(((e,{urlStateKey:t,urlStateToReplace:n})=>j(t,n)(e)),r),i=v(o,s);return a&&(i.state=a.location.state,a.replace(i)),i.search}},272:function(e,t,n){"use strict";n.d(t,"g",(function(){return c})),n.d(t,"a",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"i",(function(){return m})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return E})),n.d(t,"j",(function(){return f})),n.d(t,"d",(function(){return b})),n.d(t,"h",(function(){return g})),n.d(t,"f",(function(){return h}));var a=n(6),o=n(12);const r=e=>e.policy,s=e=>e.timerange,i=e=>e.queries,l=(e,t)=>{const n=e.inputs[t];return Object(a.isEmpty)(n.linkTo)?n.queries:n.linkTo.reduce(((t,n)=>[...t,...e.inputs[n].queries]),n.queries)},c=()=>Object(o.createSelector)(r,(e=>e.kind)),u=()=>Object(o.createSelector)(r,(e=>e.duration)),d=()=>Object(o.createSelector)(s,(e=>e.kind)),m=()=>Object(o.createSelector)(s,(e=>e.from)),p=()=>Object(o.createSelector)(s,(e=>e.to)),E=()=>Object(o.createSelector)(s,(e=>e.fromStr)),f=()=>Object(o.createSelector)(s,(e=>e.toStr)),b=()=>Object(o.createSelector)(i,(e=>e.some((e=>!0===e.loading)))),g=()=>Object(o.createSelector)(l,(e=>e.filter((e=>"kql"!==e.id)))),h=()=>Object(o.createSelector)(i,(e=>e.find((e=>"kql"===e.id))))},321:function(e,t,n){"use strict";n.d(t,"d",(function(){return h})),n.d(t,"c",(function(){return O})),n.d(t,"e",(function(){return j})),n.d(t,"b",(function(){return I})),n.d(t,"a",(function(){return k}));var a=n(5),o=n.n(a),r=n(16),s=n(165),i=n(4);const l=i.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.cancel",{defaultMessage:"Cancel"}),c=i.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.confirm",{defaultMessage:"Confirm"}),u=i.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.comment",{defaultMessage:"Comment"}),d=i.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.comment.placeholder",{defaultMessage:"You may leave an optional note here."}),m=e=>i.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.isolation.successfulMessage",{defaultMessage:"Isolation on host {hostName} successfully submitted",values:{hostName:e}}),p=e=>i.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.unisolate.successfulMessage",{defaultMessage:"Release on host {hostName} successfully submitted",values:{hostName:e}}),E=(i.i18n.translate("xpack.securitySolution.endpoint.hostisolation.isolate",{defaultMessage:"isolate"}),i.i18n.translate("xpack.securitySolution.endpoint.hostisolation.unisolate",{defaultMessage:"release"})),f=(i.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.notIsolated",{defaultMessage:"not isolated"}),i.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.isolated",{defaultMessage:"isolated"}));var b=n(720),g=n(195);const h=Object(a.memo)((({hostName:e,alertId:t,isolateAction:n="isolateHost",additionalInfo:i})=>o.a.createElement(r.EuiCallOut,{iconType:"check",color:"success",title:"isolateHost"===n?m(e):p(e),"data-test-subj":"isolateHost"===n?"hostIsolateSuccessMessage":"hostUnisolateSuccessMessage"},void 0!==t?(({alertIdForCase:e})=>{const{casesInfo:t}=Object(b.a)({alertId:e}),n=Object(a.useMemo)((()=>t.length),[t]),i=Object(a.useMemo)((()=>t.map(((e,t)=>o.a.createElement("li",{key:e.id},o.a.createElement(g.a,{detailName:e.id},o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolation.placeholderCase",defaultMessage:"{caseName}",values:{caseName:e.title}})))))),[t]);return o.a.createElement(o.a.Fragment,null,n>0&&o.a.createElement(o.a.Fragment,null,o.a.createElement(r.EuiText,{size:"s"},o.a.createElement("p",null,o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolation.successfulIsolation.cases",defaultMessage:"This action has been attached to the following {caseCount, plural, one {case} other {cases}}:",values:{caseCount:n}}))),o.a.createElement(r.EuiText,{size:"s"},o.a.createElement("ul",null,i))))})({alertIdForCase:t}):i)));h.displayName="EndpointIsolateSuccess";const O=Object(a.memo)((({hostName:e,onCancel:t,onConfirm:n,onChange:i,comment:m="",messageAppend:p,isLoading:E=!1})=>{const f=Object(a.useCallback)((e=>{i({comment:e.target.value})}),[i]);return o.a.createElement(r.EuiForm,null,o.a.createElement(r.EuiFormRow,{fullWidth:!0},o.a.createElement(r.EuiText,{size:"s"},o.a.createElement("p",null,o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolation.isolateThisHost",defaultMessage:"Isolate host {hostName} from network.",values:{hostName:o.a.createElement("b",null,e)}}),o.a.createElement("br",null)),o.a.createElement("p",null,o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolation.isolateThisHostAbout",defaultMessage:"Isolating a host will disconnect it from the network. The host will only be able to communicate with the Kibana platform."})," ",p))),o.a.createElement(r.EuiFormRow,{label:u,fullWidth:!0},o.a.createElement(r.EuiTextArea,{"data-test-subj":"host_isolation_comment",fullWidth:!0,placeholder:d,value:m,onChange:f})),o.a.createElement(r.EuiFormRow,{fullWidth:!0},o.a.createElement(r.EuiFlexGroup,{justifyContent:"flexEnd"},o.a.createElement(r.EuiFlexItem,{grow:!1},o.a.createElement(r.EuiButtonEmpty,{onClick:t,disabled:E,"data-test-subj":"hostIsolateCancelButton"},l)),o.a.createElement(r.EuiFlexItem,{grow:!1},o.a.createElement(r.EuiButton,{fill:!0,onClick:n,disabled:E,isLoading:E,"data-test-subj":"hostIsolateConfirmButton"},c)))))}));O.displayName="EndpointIsolateForm";const j=Object(a.memo)((({hostName:e,onCancel:t,onConfirm:n,onChange:i,comment:m="",messageAppend:p,isLoading:b=!1})=>{const g=Object(a.useCallback)((e=>{i({comment:e.target.value})}),[i]);return o.a.createElement(r.EuiForm,null,o.a.createElement(r.EuiFormRow,{fullWidth:!0},o.a.createElement(r.EuiText,{size:"s"},o.a.createElement("p",null,o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolation.unIsolateThisHost",defaultMessage:"{hostName} is currently {isolated}. Are you sure you want to {unisolate} this host?",values:{hostName:o.a.createElement("b",null,e),isolated:o.a.createElement("b",null,f),unisolate:o.a.createElement("b",null,E)}})," ",p))),o.a.createElement(r.EuiFormRow,{label:u,fullWidth:!0},o.a.createElement(r.EuiTextArea,{"data-test-subj":"host_isolation_comment",fullWidth:!0,placeholder:d,value:m,onChange:g})),o.a.createElement(r.EuiFormRow,{fullWidth:!0},o.a.createElement(r.EuiFlexGroup,{justifyContent:"flexEnd"},o.a.createElement(r.EuiFlexItem,{grow:!1},o.a.createElement(r.EuiButtonEmpty,{onClick:t,disabled:b},l)),o.a.createElement(r.EuiFlexItem,{grow:!1},o.a.createElement(r.EuiButton,{fill:!0,onClick:n,disabled:b,isLoading:b},c)))))}));j.displayName="EndpointUnisolateForm";var v=n(198),y=n(200);const I=Object(a.memo)((({isIsolated:e,pendingIsolate:t=0,pendingUnIsolate:n=0,"data-test-subj":i})=>{const l=Object(v.a)(i),c=Object(y.a)("disableIsolationUIPendingStatuses"),u=Object(a.useRef)(!1),d=Object(a.useRef)(!1);return Object(a.useEffect)((()=>{u.current=0===t&&n>0,d.current=t>0&&0===n}),[t,n]),Object(a.useMemo)((()=>{if(c)return e?o.a.createElement(r.EuiBadge,{color:"hollow","data-test-subj":i},o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolationStatus.isolated",defaultMessage:"Isolated"})):null;if(!t&&!n){if(!d.current&&u.current||!e)return null;if(!e&&d.current&&!u.current||e)return o.a.createElement(r.EuiBadge,{color:"hollow","data-test-subj":i},o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolationStatus.isolated",defaultMessage:"Isolated"}))}return t&&n?o.a.createElement(r.EuiBadge,{color:"hollow","data-test-subj":i},o.a.createElement(r.EuiToolTip,{display:"block",anchorClassName:"eui-textTruncate",content:o.a.createElement("div",{"data-test-subj":l("tooltipContent")},o.a.createElement("div",null,o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolationStatus.tooltipPendingActions",defaultMessage:"Pending actions:"})),o.a.createElement(r.EuiFlexGroup,{gutterSize:"none",justifyContent:"spaceBetween"},o.a.createElement(r.EuiFlexItem,{grow:!0},o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolationStatus.tooltipPendingIsolate",defaultMessage:"Isolate"})),o.a.createElement(r.EuiFlexItem,{grow:!1},t)),o.a.createElement(r.EuiFlexGroup,{gutterSize:"none"},o.a.createElement(r.EuiFlexItem,{grow:!0},o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolationStatus.tooltipPendingUnIsolate",defaultMessage:"Release"})),o.a.createElement(r.EuiFlexItem,{grow:!1},n)))},o.a.createElement(r.EuiTextColor,{color:"subdued","data-test-subj":l("pending")},o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolationStatus.multiplePendingActions",defaultMessage:"{count} actions pending",values:{count:t+n}})))):o.a.createElement(r.EuiBadge,{color:"hollow","data-test-subj":i},o.a.createElement(r.EuiTextColor,{color:"subdued","data-test-subj":l("pending")},t?o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolationStatus.isIsolating",defaultMessage:"Isolating"}):o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolationStatus.isUnIsolating",defaultMessage:"Releasing"})))}),[i,l,e,c,t,n])}));I.displayName="EndpointHostIsolationStatus";const k=o.a.memo((({onClick:e,buttonText:t})=>{const n=Object(a.useCallback)((()=>e()),[e]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(r.EuiSpacer,{size:"m"}),o.a.createElement(r.EuiFlexGroup,{gutterSize:"none",justifyContent:"flexEnd"},o.a.createElement(r.EuiFlexItem,{grow:!1},o.a.createElement(r.EuiButtonEmpty,{flush:"right",onClick:n,"data-test-subj":"hostIsolateSuccessCompleteButton"},o.a.createElement(r.EuiText,{size:"s"},o.a.createElement("p",null,t))))))}));k.displayName="ActionCompletionReturnButton"},331:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return m}));var a=n(3),o=n(139),r=n(676),s=n(271),i=n(200),l=n(18),c=n(1);const u=(e,t)=>e&&null!=e.urlKey&&!Object(r.b)(e.urlKey)?d(t):"",d=e=>r.a.reduce(((t,n)=>{let r="";if(n===o.a.appQuery&&null!=e.query)r=""===e.query.query?"":e.query;else if(n===o.a.filters&&null!=e.filters)r=Object(a.isEmpty)(e.filters)?"":e.filters;else if(n===o.a.timerange)r=e[o.a.timerange];else if(n===o.a.sourcerer)r=e[o.a.sourcerer];else if(n===o.a.timeline&&null!=e[o.a.timeline]){const t=e[o.a.timeline];r=""===t.id?"":t}return Object(s.j)(t,Object(s.k)(n,r)(Object(s.d)(t.search)))}),{pathname:"",hash:"",search:"",state:""}).search,m=()=>{const e=Object(i.a)("groupedNavigation"),[t]=Object(l.p)(c.rb);return e&&t}},336:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return s})),n(1);var a=n(273);const o=(e,t)=>`/${e}${Object(a.a)(t)}`,r=(e,t)=>`/${e}${Object(a.a)(t)}`,s=(e,t,n)=>`/${e}/${t}${Object(a.a)(n)}`},359:function(e,t,n){e.exports=n(24)(656)},364:function(e,t,n){"use strict";n.d(t,"c",(function(){return h})),n.d(t,"b",(function(){return O})),n.d(t,"a",(function(){return j}));var a=n(95),o=n.n(a),r=n(16),s=n(3),i=n(5),l=n.n(i),c=n(42),u=n(85),d=n.n(u),m=n(1),p=n(84),E=n(18),f=n(77),b=n(272);const g=l.a.memo((({duration:e,end:t,fromStr:n,id:a,isLoading:o,kqlQuery:c,policy:u,queries:d,setDuration:p,start:f,startAutoReload:b,stopAutoReload:g,timelineId:O,toStr:j,updateReduxTime:v,disabled:y})=>{const[I,k]=Object(i.useState)([]),S=Object(i.useCallback)((({start:e,end:n})=>{const o=e.includes("now")||n.includes("now"),{kqlHaveBeenUpdated:r}=v({end:n,id:a,isInvalid:!1,isQuickSelection:o,kql:c,start:e,timelineId:O}),s=h(e),i=o?h(n,{roundUp:!0}):h(n);r||o&&(f!==s||t!==i)||x(d)}),[t,a,c,d,f,O,v]),C=Object(i.useCallback)((({isPaused:t,refreshInterval:o})=>{const r=null!=n&&n.includes("now")||null!=j&&j.includes("now");e!==o&&p({id:a,duration:o}),t&&"interval"===u?g({id:a}):t||"manual"!==u||b({id:a}),t||r&&(!r||"now"===j)||x(d)}),[n,j,e,u,p,a,g,b,d]),x=e=>{e.forEach((e=>e.refetch&&e.refetch()))},w=Object(i.useCallback)((({start:e,end:t,isInvalid:n})=>{const o=e.includes("now")||t.includes("now");if(!n){v({end:t,id:a,isInvalid:n,isQuickSelection:o,kql:c,start:e,timelineId:O});const r=[{start:e,end:t},...Object(s.take)(9,I.filter((n=>!(n.start===e&&n.end===t))))];k(r)}}),[v,a,c,O,I]),N=null!=j?j:new Date(t).toISOString(),T=null!=n?n:new Date(f).toISOString(),[M]=Object(E.p)(m.cb),R=Object(s.isEmpty)(M)?[]:M.map((({from:e,to:t,display:n})=>({start:e,end:t,label:n})));return l.a.createElement(r.EuiSuperDatePicker,{commonlyUsedRanges:R,end:N,isLoading:o,isPaused:"manual"===u,onRefresh:S,onRefreshChange:C,onTimeChange:w,recentlyUsedRanges:I,refreshInterval:e,showUpdateButton:!0,start:T,isDisabled:y})}),((e,t)=>e.duration===t.duration&&e.end===t.end&&e.fromStr===t.fromStr&&e.id===t.id&&e.isLoading===t.isLoading&&e.policy===t.policy&&e.setDuration===t.setDuration&&e.start===t.start&&e.startAutoReload===t.startAutoReload&&e.stopAutoReload===t.stopAutoReload&&e.timelineId===t.timelineId&&e.disabled===t.disabled&&e.toStr===t.toStr&&e.updateReduxTime===t.updateReduxTime&&d()(e.kqlQuery,t.kqlQuery)&&d()(e.queries,t.queries))),h=(e,t)=>{const n=o.a.parse(e,t);return null!=n&&n.isValid()?n.toISOString():""},O=e=>({end:t,id:n,isQuickSelection:a,kql:o,start:r,timelineId:s})=>{const i=h(r);let l=h(t,{roundUp:!0});return a?e(t===r?f.b.setAbsoluteRangeDatePicker({id:n,fromStr:r,toStr:t,from:i,to:l}):f.b.setRelativeRangeDatePicker({id:n,fromStr:r,toStr:t,from:i,to:l})):(l=h(t),e(f.b.setAbsoluteRangeDatePicker({id:n,from:h(r),to:h(t)}))),null!=s&&e(p.a.updateRange({id:s,start:i,end:l})),o?{kqlHaveBeenUpdated:o.refetch(e)}:{kqlHaveBeenUpdated:!1}};g.displayName="SuperDatePickerComponent";const j=Object(c.connect)((()=>{const e=Object(b.a)(),t=Object(b.b)(),n=Object(b.c)(),a=Object(b.d)(),o=Object(b.e)(),r=Object(b.f)(),i=Object(b.g)(),l=Object(b.h)(),c=Object(b.i)(),u=Object(b.j)();return(d,{id:m})=>{const p=Object(s.getOr)({},`inputs.${m}`,d);return{duration:e(p),end:t(p),fromStr:n(p),isLoading:a(p),kind:o(p),kqlQuery:r(p),policy:i(p),queries:l(d,m),start:c(p),toStr:u(p)}}}),(e=>({startAutoReload:({id:t})=>e(f.b.startAutoReload({id:t})),stopAutoReload:({id:t})=>e(f.b.stopAutoReload({id:t})),setDuration:({id:t,duration:n})=>e(f.b.setDuration({id:t,duration:n})),updateReduxTime:O(e)})))(g)},377:function(e,t,n){const{MAX_SAFE_COMPONENT_LENGTH:a}=n(459),o=n(458),r=(t=e.exports={}).re=[],s=t.src=[],i=t.t={};let l=0;const c=(e,t,n)=>{const a=l++;o(a,t),i[e]=a,s[a]=t,r[a]=new RegExp(t,n?"g":void 0)};c("NUMERICIDENTIFIER","0|[1-9]\\d*"),c("NUMERICIDENTIFIERLOOSE","[0-9]+"),c("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),c("MAINVERSION",`(${s[i.NUMERICIDENTIFIER]})\\.(${s[i.NUMERICIDENTIFIER]})\\.(${s[i.NUMERICIDENTIFIER]})`),c("MAINVERSIONLOOSE",`(${s[i.NUMERICIDENTIFIERLOOSE]})\\.(${s[i.NUMERICIDENTIFIERLOOSE]})\\.(${s[i.NUMERICIDENTIFIERLOOSE]})`),c("PRERELEASEIDENTIFIER",`(?:${s[i.NUMERICIDENTIFIER]}|${s[i.NONNUMERICIDENTIFIER]})`),c("PRERELEASEIDENTIFIERLOOSE",`(?:${s[i.NUMERICIDENTIFIERLOOSE]}|${s[i.NONNUMERICIDENTIFIER]})`),c("PRERELEASE",`(?:-(${s[i.PRERELEASEIDENTIFIER]}(?:\\.${s[i.PRERELEASEIDENTIFIER]})*))`),c("PRERELEASELOOSE",`(?:-?(${s[i.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${s[i.PRERELEASEIDENTIFIERLOOSE]})*))`),c("BUILDIDENTIFIER","[0-9A-Za-z-]+"),c("BUILD",`(?:\\+(${s[i.BUILDIDENTIFIER]}(?:\\.${s[i.BUILDIDENTIFIER]})*))`),c("FULLPLAIN",`v?${s[i.MAINVERSION]}${s[i.PRERELEASE]}?${s[i.BUILD]}?`),c("FULL",`^${s[i.FULLPLAIN]}$`),c("LOOSEPLAIN",`[v=\\s]*${s[i.MAINVERSIONLOOSE]}${s[i.PRERELEASELOOSE]}?${s[i.BUILD]}?`),c("LOOSE",`^${s[i.LOOSEPLAIN]}$`),c("GTLT","((?:<|>)?=?)"),c("XRANGEIDENTIFIERLOOSE",`${s[i.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),c("XRANGEIDENTIFIER",`${s[i.NUMERICIDENTIFIER]}|x|X|\\*`),c("XRANGEPLAIN",`[v=\\s]*(${s[i.XRANGEIDENTIFIER]})(?:\\.(${s[i.XRANGEIDENTIFIER]})(?:\\.(${s[i.XRANGEIDENTIFIER]})(?:${s[i.PRERELEASE]})?${s[i.BUILD]}?)?)?`),c("XRANGEPLAINLOOSE",`[v=\\s]*(${s[i.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[i.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[i.XRANGEIDENTIFIERLOOSE]})(?:${s[i.PRERELEASELOOSE]})?${s[i.BUILD]}?)?)?`),c("XRANGE",`^${s[i.GTLT]}\\s*${s[i.XRANGEPLAIN]}$`),c("XRANGELOOSE",`^${s[i.GTLT]}\\s*${s[i.XRANGEPLAINLOOSE]}$`),c("COERCE",`(^|[^\\d])(\\d{1,${a}})(?:\\.(\\d{1,${a}}))?(?:\\.(\\d{1,${a}}))?(?:$|[^\\d])`),c("COERCERTL",s[i.COERCE],!0),c("LONETILDE","(?:~>?)"),c("TILDETRIM",`(\\s*)${s[i.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",c("TILDE",`^${s[i.LONETILDE]}${s[i.XRANGEPLAIN]}$`),c("TILDELOOSE",`^${s[i.LONETILDE]}${s[i.XRANGEPLAINLOOSE]}$`),c("LONECARET","(?:\\^)"),c("CARETTRIM",`(\\s*)${s[i.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",c("CARET",`^${s[i.LONECARET]}${s[i.XRANGEPLAIN]}$`),c("CARETLOOSE",`^${s[i.LONECARET]}${s[i.XRANGEPLAINLOOSE]}$`),c("COMPARATORLOOSE",`^${s[i.GTLT]}\\s*(${s[i.LOOSEPLAIN]})$|^$`),c("COMPARATOR",`^${s[i.GTLT]}\\s*(${s[i.FULLPLAIN]})$|^$`),c("COMPARATORTRIM",`(\\s*)${s[i.GTLT]}\\s*(${s[i.LOOSEPLAIN]}|${s[i.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",c("HYPHENRANGE",`^\\s*(${s[i.XRANGEPLAIN]})\\s+-\\s+(${s[i.XRANGEPLAIN]})\\s*$`),c("HYPHENRANGELOOSE",`^\\s*(${s[i.XRANGEPLAINLOOSE]})\\s+-\\s+(${s[i.XRANGEPLAINLOOSE]})\\s*$`),c("STAR","(<|>)?=?\\s*\\*"),c("GTE0","^\\s*>=\\s*0.0.0\\s*$"),c("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")},378:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"f",(function(){return o})),n.d(t,"b",(function(){return r})),n.d(t,"g",(function(){return s})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return l})),n.d(t,"c",(function(){return c}));const a="/api/fleet/package_policies",o=(e,t,n)=>e.get(`${a}/${t}`,n),r=(e,t)=>e.get("/api/fleet/agent_policies",t),s=(e,t,n,o={})=>e.put(`${a}/${t}`,{...o,body:JSON.stringify(n)}),i=(e,t,n={})=>e.get("/api/fleet/agent_status",{...n,query:{policyId:t}}),l=(e,t={})=>e.get("/api/fleet/agents",{...t,query:{page:1,perPage:1,kuery:'packages : "endpoint"'}}),c=async e=>{const t=(await e.get("/api/fleet/epm/packages",{query:{category:"security"}})).items.find((e=>"endpoint"===e.name));if(!t)throw new Error("Endpoint package was not found.");return t}},402:function(e,t,n){"use strict";n.d(t,"i",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"j",(function(){return s})),n.d(t,"d",(function(){return i})),n.d(t,"h",(function(){return l})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"o",(function(){return d})),n.d(t,"n",(function(){return m})),n.d(t,"k",(function(){return p})),n.d(t,"m",(function(){return E})),n.d(t,"l",(function(){return f})),n.d(t,"b",(function(){return b})),n.d(t,"a",(function(){return g})),n.d(t,"g",(function(){return h}));var a=n(4);const o=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.locationTitle",{defaultMessage:"Location"}),r=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.autonomousSystemTitle",{defaultMessage:"Autonomous system"}),s=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.maxAnomalyScoreByJobTitle",{defaultMessage:"Max anomaly score by job"}),i=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.firstSeenTitle",{defaultMessage:"First seen"}),l=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.lastSeenTitle",{defaultMessage:"Last seen"}),c=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.hostIdTitle",{defaultMessage:"Host ID"}),u=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.hostNameTitle",{defaultMessage:"Host name"}),d=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.whoIsTitle",{defaultMessage:"WhoIs"}),m=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.viewWhoisTitle",{defaultMessage:"iana.org"}),p=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.ipReputationTitle",{defaultMessage:"Reputation"}),E=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.viewVirusTotalTitle.",{defaultMessage:"virustotal.com"}),f=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.viewTalosIntelligenceTitle",{defaultMessage:"talosIntelligence.com"}),b=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.asSourceDropDownOptionLabel",{defaultMessage:"As Source"}),g=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.asDestinationDropDownOptionLabel",{defaultMessage:"As Destination"}),h=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.inspectTitle",{defaultMessage:"IP overview"})},403:function(e,t,n){"use strict";n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return E})),n.d(t,"e",(function(){return f})),n.d(t,"f",(function(){return b}));var a=n(5),o=n.n(a),r=n(16),s=n(23),i=n.n(s),l=n(165),c=n(193);const u=({children:e,...t})=>o.a.createElement(r.EuiButton,t,e),d=({children:e,...t})=>o.a.createElement(r.EuiLink,t,e),m=i()("span").withConfig({displayName:"Comma",componentId:"sc-y9dkfp-0"})(["margin-right:5px;margin-left:5px;&::after{content:' ,';}"]);m.displayName="Comma";const p=({children:e,Component:t,dataTestSubj:n,href:a,onClick:r,title:s,iconType:i="expand"})=>t?o.a.createElement(t,{"data-test-subj":n,href:a,iconType:i,onClick:r,title:s},null!=s?s:e):o.a.createElement(u,{"data-test-subj":n,href:a,onClick:r},null!=s?s:e),E=o.a.memo(p),f=i.a.div.withConfig({displayName:"PortContainer",componentId:"sc-y9dkfp-1"})(["& svg{position:relative;top:-1px;}"]),b=o.a.memo((({moreMaxHeight:e,overflowIndexStart:t=5,render:n,rowItems:s})=>{const[i,c]=Object(a.useState)(!1),u=Object(a.useCallback)((()=>c((e=>!e))),[]),d=Object(a.useMemo)((()=>o.a.createElement(o.a.Fragment,null," ,",o.a.createElement(r.EuiButtonEmpty,{size:"xs",onClick:u},`+${s.length-t} `,o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.reputationLinks.moreLabel",defaultMessage:"More"})))),[u,t,s.length]);return o.a.createElement(r.EuiFlexItem,{grow:!1},s.length>t&&o.a.createElement(r.EuiPopover,{id:"popover",button:d,isOpen:i,closePopover:u,repositionOnScroll:!0,panelClassName:"withHoverActions__popover"},o.a.createElement(g,{render:n,rowItems:s,moreMaxHeight:e,overflowIndexStart:t})))}));b.displayName="ReputationLinksOverflow";const g=o.a.memo((({moreMaxHeight:e,overflowIndexStart:t,render:n,rowItems:s})=>{const i=Object(a.useMemo)((()=>s.slice(t).map(((e,t)=>{var a;return o.a.createElement(r.EuiFlexItem,{grow:1,key:`${e}-${t}`},null!==(a=n&&n(e))&&void 0!==a?a:Object(c.a)(e))}))),[t,n,s]);return o.a.createElement("div",{"data-test-subj":"more-container",className:"eui-yScroll",style:{maxHeight:e,paddingRight:"2px"}},o.a.createElement(r.EuiFlexGroup,{gutterSize:"s",direction:"column","data-test-subj":"overflow-items"},i))}));g.displayName="MoreReputationLinksContainer"},409:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return l}));var a=n(4),o=n(222);const r=Object.freeze({[o.d.HEALTHY]:"success",[o.d.UNHEALTHY]:"warning",[o.d.UPDATING]:"primary",[o.d.OFFLINE]:"default",[o.d.INACTIVE]:"default",[o.d.UNENROLLED]:"default"}),s=Object.freeze({success:"success",warning:"warning",failure:"danger",unsupported:"default"}),i=Object.freeze({success:"success",warning:"warning",failure:"danger",unsupported:"default"}),l=Object.freeze({success:a.i18n.translate("xpack.securitySolution.policyStatusText.success",{defaultMessage:"Success"}),warning:a.i18n.translate("xpack.securitySolution.policyStatusText.warning",{defaultMessage:"Warning"}),failure:a.i18n.translate("xpack.securitySolution.policyStatusText.failure",{defaultMessage:"Failure"}),unsupported:a.i18n.translate("xpack.securitySolution.policyStatusText.unsupported",{defaultMessage:"Unsupported"})})},411:function(e,t,n){const a=n(264);e.exports=(e,t,n)=>a(e,t,n)<=0},439:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return r})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return i}));var a=n(4);a.i18n.translate("xpack.securitySolution.containers.detectionEngine.alerts.errorFetchingAlertsDescription",{defaultMessage:"Failed to query alerts"});const o=a.i18n.translate("xpack.securitySolution.containers.detectionEngine.alerts.errorGetAlertDescription",{defaultMessage:"Failed to get signal index name"}),r=a.i18n.translate("xpack.securitySolution.containers.detectionEngine.alerts.errorPostAlertDescription",{defaultMessage:"Failed to create signal index"}),s=a.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.failedToIsolate.title",{defaultMessage:"Failed to isolate host"}),i=a.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.casesFromAlerts.title",{defaultMessage:"Failed to find associated cases"})},442:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return i}));var a=n(17),o=n(677),r=n(1);const s={[r.cc.landing]:{id:r.cc.landing,name:a.m,href:r.o,disabled:!1,urlKey:"get_started"},[r.cc.overview]:{id:r.cc.overview,name:a.v,href:r.s,disabled:!1,urlKey:"overview"},[r.cc.detectionAndResponse]:{id:r.cc.detectionAndResponse,name:a.h,href:r.g,disabled:!1,urlKey:"detection_response"},[r.cc.alerts]:{id:r.cc.alerts,name:a.b,href:r.d,disabled:!1,urlKey:"alerts"},[r.cc.rules]:{id:r.cc.rules,name:a.x,href:r.v,disabled:!1,urlKey:"rules"},[r.cc.exceptions]:{id:r.cc.exceptions,name:a.k,href:r.j,disabled:!1,urlKey:"exceptions"},[r.cc.hosts]:{id:r.cc.hosts,name:a.o,href:r.k,disabled:!1,urlKey:"host"},[r.cc.users]:{id:r.cc.users,name:a.A,href:r.z,disabled:!1,urlKey:"users"},[r.cc.network]:{id:r.cc.network,name:a.s,href:r.r,disabled:!1,urlKey:"network"},[r.cc.timelines]:{id:r.cc.timelines,name:a.y,href:r.w,disabled:!1,urlKey:"timeline"},[r.cc.case]:{id:r.cc.case,name:a.d,href:r.f,disabled:!1,urlKey:"cases"},[r.cc.administration]:{id:r.cc.administration,name:a.a,href:r.p,disabled:!1,urlKey:"administration"},[r.cc.endpoints]:{id:r.cc.endpoints,name:a.i,href:r.h,disabled:!1,urlKey:"administration"},[r.cc.policies]:{id:r.cc.policies,name:a.w,href:r.u,disabled:!1,urlKey:"administration"},[r.cc.trustedApps]:{id:r.cc.trustedApps,name:a.z,href:r.x,disabled:!1,urlKey:"administration"},[r.cc.eventFilters]:{id:r.cc.eventFilters,name:a.j,href:r.i,disabled:!1,urlKey:"administration"},[r.cc.hostIsolationExceptions]:{id:r.cc.hostIsolationExceptions,name:a.p,href:r.l,disabled:!1,urlKey:"administration"},[r.cc.blocklist]:{id:r.cc.blocklist,name:a.c,href:r.e,disabled:!1,urlKey:"administration"}},i={[o.a.dashboards]:{id:o.a.dashboards,name:a.f},[o.a.detect]:{id:o.a.detect,name:a.g},[o.a.explore]:{id:o.a.explore,name:a.l},[o.a.investigate]:{id:o.a.investigate,name:a.q},[o.a.manage]:{id:o.a.manage,name:a.r}}},448:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return s}));var a=n(94),o=n(273);const r=e=>`${Object(o.a)(e)}`,s=(e,t,n)=>`/ip/${e}/${t||a.a.source}${Object(o.a)(n)}`},454:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(5),o=n.n(a),r=n(16),s=n(165),i=n(409);const l=o.a.memo((({hostStatus:e})=>o.a.createElement(r.EuiBadge,{color:null!=e?i.a[e]:"warning","data-test-subj":"rowHostStatus",className:"eui-textTruncate"},o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.hostStatusValue",defaultMessage:"{hostStatus, select, healthy {Healthy} unhealthy {Unhealthy} updating {Updating} offline {Offline} inactive {Inactive} unenrolled {Unenrolled} other {Unhealthy}}",values:{hostStatus:e}}))));l.displayName="AgentStatus"},457:function(e,t,n){"use strict";var a=n(494);n.d(t,"a",(function(){return a.a})),n.d(t,"b",(function(){return a.b}))},458:function(e,t,n){(function(t){const n="object"==typeof t&&Object({IS_KIBANA_DISTRIBUTABLE:"true"})&&Object({IS_KIBANA_DISTRIBUTABLE:"true"}).NODE_DEBUG&&/\bsemver\b/i.test(Object({IS_KIBANA_DISTRIBUTABLE:"true"}).NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=n}).call(this,n(359))},459:function(e,t){const n=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:n,MAX_SAFE_COMPONENT_LENGTH:16}},460:function(e,t){const n=["includePrerelease","loose","rtl"];e.exports=e=>e?"object"!=typeof e?{loose:!0}:n.filter((t=>e[t])).reduce(((e,t)=>(e[t]=!0,e)),{}):{}},494:function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return O})),n.d(t,"c",(function(){return j}));var a=n(50),o=n.n(a),r=n(5),s=n.n(r),i=n(16),l=n(23),c=n.n(l),u=n(165),d=n(90),m=n.n(d);const p=Object(r.memo)((({onConfirm:e,onCancel:t})=>s.a.createElement("div",{className:"euiOverlayMask",style:{position:"absolute"},"data-test-subj":"consolePopupTerminateConfirmModal"},s.a.createElement(i.EuiFocusTrap,null,s.a.createElement(i.EuiPanel,{className:"terminate-confirm-panel"},s.a.createElement(i.EuiCallOut,{color:"primary",iconType:"iInCircle","data-test-subj":"consolePopupTerminateConfirmMessage",title:s.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.console.popup.confirmTitle",defaultMessage:"Terminate this session"})},s.a.createElement(i.EuiText,null,s.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.console.popup.terminateMessage",defaultMessage:"This will end your console session. Do you wish to continue?"}))),s.a.createElement(i.EuiSpacer,null),s.a.createElement(i.EuiFlexGroup,{justifyContent:"flexEnd"},s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiButtonEmpty,{onClick:t,"data-test-subj":"consolePopupTerminateModalCancelButton"},s.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.console.popup.terminateConfirmCancelLabel",defaultMessage:"Cancel"}))),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiButton,{onClick:e,color:"danger",fill:!0,"data-test-subj":"consolePopupTerminateModalTerminateButton"},s.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.console.popup.terminateConfirmSubmitLabel",defaultMessage:"Terminate"})))))))));p.displayName="ConfirmTerminate";const E=c.a.div.withConfig({displayName:"ConsolePopupWrapper",componentId:"sc-f5xyeo-0"})(["position:fixed;bottom:60px;left:20px;height:50vh;width:48vw;max-width:90vw;&.is-hidden{display:none;}&.is-confirming .modal-content{opacity:0.3;}.console-holder{height:100%;}.terminate-confirm-panel{max-width:85%;flex-grow:0;}"]),f=Object(r.memo)((({children:e,isHidden:t,title:n="",onTerminate:a,onHide:o})=>{const[l,c]=Object(r.useState)(!1),d=Object(r.useMemo)((()=>m()({euiModal:!0,"euiModal--maxWidth-default":!0,"is-hidden":t,"is-confirming":l})),[t,l]),f=Object(r.useCallback)((()=>{c(!0)}),[]),b=Object(r.useCallback)((()=>{c(!1),a()}),[a]),g=Object(r.useCallback)((()=>{c(!1)}),[]);return s.a.createElement(E,{className:d,"data-test-subj":"consolePopupWrapper"},s.a.createElement("div",{className:"euiModal__flex modal-content"},!t&&s.a.createElement(i.EuiModalHeader,{"data-test-subj":"consolePopupHeader"},s.a.createElement(i.EuiModalHeaderTitle,null,s.a.createElement("h1",null,s.a.createElement(i.EuiIcon,{type:"console",size:"xl"})," ",n))),s.a.createElement(i.EuiModalBody,{"data-test-subj":"consolePopupBody"},s.a.createElement("div",{className:"console-holder"},e)),!t&&s.a.createElement(i.EuiModalFooter,null,s.a.createElement(i.EuiButtonEmpty,{color:"danger",onClick:f,"data-test-subj":"consolePopupTerminateButton"},s.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.console.manager.popup.terminateLabel",defaultMessage:"Terminate"})),s.a.createElement(i.EuiButton,{onClick:o,fill:!0,"data-test-subj":"consolePopupHideButton"},s.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.console.manager.popup.hideLabel",defaultMessage:"hide"})))),!t&&l&&s.a.createElement(p,{onConfirm:b,onCancel:g}))}));f.displayName="ConsolePopup";var b=n(601);const g=s.a.createContext(void 0),h=Object(r.memo)((({storage:e={},children:t})=>{const[n,a]=Object(r.useState)(e),i=Object(r.useRef)();i.current=n;const l=Object(r.useCallback)((e=>{var t;if(null===(t=i.current)||void 0===t||!t[e])throw new Error(`Console with id ${e} not found`)}),[]),c=Object(r.useCallback)((e=>{l(e),a((t=>{const n={...t};return Object.entries(n).forEach((([e,t])=>{t.isOpen&&(n[e]={...t,isOpen:!1})})),n[e]={...n[e],isOpen:!0},n}))}),[l]),u=Object(r.useCallback)((e=>{l(e),a((t=>({...t,[e]:{...t[e],isOpen:!1}})))}),[l]),d=Object(r.useCallback)((e=>{l(e),a((t=>{const{onBeforeTerminate:n}=t[e];n&&n();const a={...t};return delete a[e],a}))}),[l]),m=Object(r.useCallback)((e=>{var t;if(null!==(t=i.current)&&void 0!==t&&t[e])return i.current[e].client}),[]),p=Object(r.useCallback)((()=>Object.values(n).map((e=>e.client))),[n]),E=Object(r.useCallback)((e=>{var t;return!(null===(t=i.current)||void 0===t||!t[e])&&i.current[e].isOpen}),[]),h=Object(r.useCallback)((({id:e,title:t,meta:r,consoleProps:i,...l})=>{if(n[e])throw new Error(`Console with id ${e} already registered`);const m=Symbol(e),p=c.bind(null,e),f=u.bind(null,e),g=d.bind(null,e),h=E.bind(null,e),O={...l,client:{id:e,title:t,meta:r,show:()=>{setTimeout(p,0)},hide:()=>{setTimeout(f,0)},terminate:()=>{setTimeout(g,0)},isVisible:()=>h()},consoleProps:i,console:s.a.createElement(b.a,o()({},i,{managedKey:m,key:e})),isOpen:!1,key:m};return a((t=>({...t,[e]:O}))),O.client}),[n,u,E,c,d]),O=Object(r.useMemo)((()=>({register:h,show:c,hide:u,terminate:d,getOne:m,getList:p})),[p,m,u,h,c,d]),j=Object(r.useMemo)((()=>({client:O,internal:{getManagedConsole:e=>Object.values(n).find((t=>t.key===e))}})),[O,n]),v=Object(r.useMemo)((()=>Object.values(n).find((e=>e.isOpen))),[n]),y=Object(r.useCallback)((()=>{v&&O.terminate(v.client.id)}),[O,v]),I=Object(r.useCallback)((()=>{v&&O.hide(v.client.id)}),[O,v]),k=Object(r.useMemo)((()=>Object.values(n).map((e=>e.console))),[n]);return s.a.createElement(g.Provider,{value:j},t,s.a.createElement(f,{title:null==v?void 0:v.client.title,isHidden:!v,onTerminate:y,onHide:I},k))}));h.displayName="ConsoleManager";const O=()=>{const e=Object(r.useContext)(g);if(!e)throw new Error("ConsoleManagerContext not found");return e.client},j=e=>{const t=Object(r.useContext)(g);if(e&&t)return t.internal.getManagedConsole(e)}},495:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(18),o=n(256);const r=e=>a.b.get().http.get(o.b,{query:{agent_ids:e}})},544:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(411),o=n.n(a);const r={macos:!0,windows:!0};function s(e){return e.includes("-")?e.substring(0,e.indexOf("-")):e}const i=({osName:e,version:t,capabilities:n})=>!(!t||!(({currentVersion:e,minVersionRequired:t="7.14.0"})=>{try{const n=s(e);return o()(t,n)}catch(n){return window&&window.console&&window.console.warn(`SecuritySolution: isVersionSupported(): Unable to determine if current version [${e}] meets minimum version [${t}]. Error: ${n.message}`),!1}})({currentVersion:t}))&&(function(e){const t=s(e);return o()("7.15.0",t)}(t)?function(e=[]){return e.includes("isolation")}(n):function(e){return(({currentOs:e,supportedOss:t=r})=>!!t[e])({currentOs:e.toLowerCase()})}(e))},545:function(e,t){const n=/^[0-9]+$/,a=(e,t)=>{const a=n.test(e),o=n.test(t);return a&&o&&(e=+e,t=+t),e===t?0:a&&!o?-1:o&&!a?1:e<t?-1:1};e.exports={compareIdentifiers:a,rcompareIdentifiers:(e,t)=>a(t,e)}},548:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(173),o=n(378);const r=(e,t={})=>{var n;return e.get(o.a,{...t,query:{...t.query,kuery:`${null!=t&&null!==(n=t.query)&&void 0!==n&&n.kuery?`${t.query.kuery} and `:""}${a.PACKAGE_POLICY_SAVED_OBJECT_TYPE}.package.name: endpoint`}})}},601:function(e,t,n){"use strict";n.d(t,"a",(function(){return Z}));var a=n(50),o=n.n(a),r=n(5),s=n.n(r),i=n(16),l=n(23),c=n.n(l);const u=Object(r.memo)((({input:e})=>s.a.createElement(s.a.Fragment,null,"$ ",s.a.createElement("code",null,e))));u.displayName="UserCommandInput";var d=n(4),m=n(43),p=n(165),E=n(198);const f=()=>D().state.dataTestSubj,b=Object(r.memo)((({commandDef:e})=>{const t=Object(r.useMemo)((()=>(e=>{let t="",n="";if(e.args)for(const[a,o]of Object.entries(e.args))o.required?(t.length&&(t+=" "),t+=`--${a}`):(n.length&&(n+=" "),n+=`--${a}`);return`${e.name} ${t} ${n.length>0?`[${n}]`:""}`.trim()})(e)),[e]);return s.a.createElement(i.EuiFlexGroup,null,s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiText,null,s.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.console.commandUsage.inputUsage",defaultMessage:"Usage:"}))),s.a.createElement(i.EuiFlexItem,{grow:!0},s.a.createElement("code",null,s.a.createElement(i.EuiText,null,s.a.createElement("code",null,t)))))}));b.displayName="CommandInputUsage";const g=Object(r.memo)((({commandDef:e})=>{const t=Object(E.a)(f()),n=Object(r.useMemo)((()=>{var t;return Object.keys(null!==(t=e.args)&&void 0!==t?t:[]).length>0}),[e.args]),a=Object(r.useMemo)((()=>n&&e.args?Object.entries(e.args).map((([e,{about:t}])=>({title:`--${e}`,description:t}))):[]),[e.args,n]),o=Object(r.useMemo)((()=>({className:"euiTruncateText"})),[]);return s.a.createElement(i.EuiPanel,{color:"transparent","data-test-subj":t("commandUsage")},s.a.createElement(i.EuiText,null,e.about),s.a.createElement(b,{commandDef:e}),n&&s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiSpacer,null),s.a.createElement(i.EuiText,null,s.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.console.commandUsage.optionsLabel",defaultMessage:"Options:"}),e.mustHaveArgs&&e.args&&n&&s.a.createElement(i.EuiText,{size:"s",color:"subdued"},s.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.console.commandUsage.atLeastOneOptionRequiredMessage",defaultMessage:"Note: at least one option must be used"}))),e.args&&s.a.createElement(i.EuiDescriptionList,{compressed:!0,type:"column",className:"descriptionList-20_80",listItems:a,descriptionProps:o,titleProps:o,"data-test-subj":t("commandUsage-options")})))}));g.displayName="CommandUsage";const h=Object(r.memo)((({title:e,children:t})=>{const n=Object(E.a)(f());return s.a.createElement(i.EuiCallOut,{title:e,color:"primary",size:"s",iconType:"help","data-test-subj":n("helpOutput")},t)}));h.displayName="HelpOutput";const O=Object(r.memo)((e=>{const t=e.command.commandDefinition.HelpComponent;return Object(r.useEffect)((()=>{t||e.setStatus("success")}),[t,e]),t?s.a.createElement(t,e):s.a.createElement(h,{command:e.command,title:d.i18n.translate("xpack.securitySolution.console.buildInCommand.helpArgument.helpTitle",{defaultMessage:"{cmdName} command",values:{cmdName:e.command.args.name}})},s.a.createElement(g,{commandDef:e.command.commandDefinition}))}));O.displayName="HelpCommandArgument";var j=n(1006),v=n.n(j);const y=Object.freeze({hasArgs(){return Object.keys(this.args).length>0||Array.isArray(this.unknownArgs)},hasArg(e){return Object.prototype.hasOwnProperty.call(this.args,e)}}),I=Object(r.memo)((({setStatus:e})=>{const t=Object(E.a)(f());return Object(r.useEffect)((()=>{e("success")}),[e]),s.a.createElement(i.EuiCallOut,{color:"danger","data-test-subj":t("unknownCommandError")},s.a.createElement(i.EuiText,null,s.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.console.unknownCommand.title",defaultMessage:"Unknown command"})),s.a.createElement(i.EuiText,{size:"xs"},s.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.console.unknownCommand.helpMessage",defaultMessage:"For a list of available command, enter: {helpCmd}",values:{helpCmd:s.a.createElement("code",null,"help")}})))}));I.displayName="UnknownCommand";const k=Object(r.memo)((({command:e,setStatus:t,store:n})=>{const a=Object(E.a)(f());return Object(r.useEffect)((()=>{t("success")}),[t]),s.a.createElement(i.EuiCallOut,{color:"danger","data-test-subj":a("badArgument")},n.errorMessage,s.a.createElement(b,{commandDef:e.commandDefinition}))}));k.displayName="BadArgument";const S=e=>`--${e}`,C=(e,t)=>({...e,commandHistory:[...e.commandHistory,t]}),x={name:"unknown-command",about:"unknown command",RenderComponent:()=>null},w=(e={})=>({status:"pending",store:e}),N=(e,t)=>({...e,commandDefinition:{...e.commandDefinition,RenderComponent:t}}),T=Object(r.memo)((({status:e,setStatus:t})=>{const n=P();return Object(r.useEffect)((()=>{"pending"===e&&n({type:"clear"}),t("success")}),[e,t,n]),null}));T.displayName="ClearCommand";const M=Object(r.memo)((({commands:e})=>{const t=Object(E.a)(f()),n=Object(r.useMemo)((()=>s.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.console.commandList.footerText",defaultMessage:"For more details on the commands above use the {helpOption} argument. Example: {cmdExample}",values:{helpOption:"--help",cmdExample:s.a.createElement("code",null,"some-command --help")}})),[]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiFlexGroup,{wrap:!0,gutterSize:"xs","data-test-subj":t("commandList")},e.map((({name:e,about:n})=>s.a.createElement(i.EuiFlexItem,{grow:2,style:{flexBasis:"20%"},key:e},s.a.createElement(i.EuiDescriptionList,{compressed:!0,listItems:[{title:e,description:n}],"data-test-subj":t("commandList-command")}))))),s.a.createElement(i.EuiText,null,n))}));M.displayName="CommandList";const R=Object(r.memo)((e=>{const t=D().state.commands,n=D().state.HelpComponent;return Object(r.useEffect)((()=>{n||e.setStatus("success")}),[n,e]),n?s.a.createElement(n,e):s.a.createElement(h,{command:e.command,title:d.i18n.translate("xpack.securitySolution.console.builtInCommands.help.helpTitle",{defaultMessage:"Available commands"})},s.a.createElement(M,{commands:t}))}));R.displayName="HelpCommand";const A=({commands:e,scrollToBottom:t,dataTestSubj:n,HelpComponent:a})=>({commands:[{name:"help",about:d.i18n.translate("xpack.securitySolution.console.builtInCommands.helpAbout",{defaultMessage:"View list of available commands"}),RenderComponent:R},{name:"clear",about:d.i18n.translate("xpack.securitySolution.console.builtInCommands.clearAbout",{defaultMessage:"Clear the console buffer"}),RenderComponent:T}].concat(e),scrollToBottom:t,HelpComponent:a,dataTestSubj:n,commandHistory:[]}),F=(e,t)=>{switch(t.type){case"scrollDown":return e.scrollToBottom(),e;case"executeCommand":return((e,t)=>{const n=(e=>{const t=v()(e)||[],n=t.shift()||"",a={};let o,r="";for(const e of t){var s;e.startsWith("--")?(r=e.substr(2),a[r]||(a[r]={value:void 0,values:void 0})):r?Array.isArray(a[r].values)?a[r].values.push(e):void 0!==a[r].value?(a[r].values=[null!==(s=a[r].value)&&void 0!==s?s:"",e],a[r].value=void 0):a[r].value=e:(o=o||[]).push(e)}return Object.assign(Object.create(y),{input:e,name:n,args:a,unknownArgs:o})})(t.payload.input);if(""===n.name)return e;const{commands:a}=e,o=a.find((e=>e.name===n.name));if(!o)return C(e,{id:Object(m.v4)(),command:{input:n.input,args:n,commandDefinition:{...x,RenderComponent:I}},state:w()});const r={input:n.input,args:n,commandDefinition:o},s=(i=o.args)?Object.entries(i).filter((([e,t])=>t.required)).map((([e])=>e)):[];var i;if(n.hasArgs()){if(n.hasArg("help"))return C(e,{id:Object(m.v4)(),command:N(r,O),state:w()});if(!o.args||0===Object.keys(o.args).length)return C(e,{id:Object(m.v4)(),command:N(r,k),state:w({errorMessage:d.i18n.translate("xpack.securitySolution.console.commandValidation.noArgumentsSupported",{defaultMessage:"command does not support any arguments"})})});if(n.unknownArgs&&n.unknownArgs.length)return C(e,{id:Object(m.v4)(),command:N(r,k),state:w({errorMessage:d.i18n.translate("xpack.securitySolution.console.commandValidation.unknownArgument",{defaultMessage:"unknown argument(s): {unknownArgs}",values:{unknownArgs:n.unknownArgs.join(", ")}})})});for(const t of s)if(!n.args[t])return C(e,{id:Object(m.v4)(),command:N(r,k),state:w({errorMessage:d.i18n.translate("xpack.securitySolution.console.commandValidation.missingRequiredArg",{defaultMessage:"missing required argument: {argName}",values:{argName:S(t)}})})});for(const t of Object.keys(n.args)){const a=o.args[t],s=n.args[t];if(!a)return C(e,{id:Object(m.v4)(),command:N(r,k),state:w({errorMessage:d.i18n.translate("xpack.securitySolution.console.commandValidation.unsupportedArg",{defaultMessage:"unsupported argument: {argName}",values:{argName:S(t)}})})});if(!a.allowMultiples&&Array.isArray(s.values)&&s.values.length>0)return C(e,{id:Object(m.v4)(),command:N(r,k),state:w({errorMessage:d.i18n.translate("xpack.securitySolution.console.commandValidation.argSupportedOnlyOnce",{defaultMessage:"argument can only be used once: {argName}",values:{argName:S(t)}})})});if(a.validate){const n=a.validate(s);if(!0!==n)return C(e,{id:Object(m.v4)(),command:N(r,k),state:w({errorMessage:d.i18n.translate("xpack.securitySolution.console.commandValidation.invalidArgValue",{defaultMessage:"invalid argument value: {argName}. {error}",values:{argName:S(t),error:n}})})})}}}else{if(s.length>0)return C(e,{id:Object(m.v4)(),command:N(r,k),state:w({errorMessage:d.i18n.translate("xpack.securitySolution.console.commandValidation.mustHaveArgs",{defaultMessage:"missing required arguments: {requiredArgs}",values:{requiredArgs:s.map((e=>S(e))).join(", ")}})})});if(o.mustHaveArgs)return C(e,{id:Object(m.v4)(),command:N(r,k),state:w({errorMessage:d.i18n.translate("xpack.securitySolution.console.commandValidation.oneArgIsRequired",{defaultMessage:"at least one argument must be used"})})})}return C(e,{id:Object(m.v4)(),command:r,state:w()})})(e,t);case"updateCommandStatusState":case"updateCommandStoreState":return((e,{type:t,payload:{id:n,value:a}})=>{let o=!1;const r=e.commandHistory.map((e=>{if(o||e.id!==n)return e;o=!0;const r={...e,state:{...e.state}};switch(t){case"updateCommandStoreState":r.state.store=a(r.state.store);break;case"updateCommandStatusState":if(r.state.status===a)return o=!1,e;r.state.status=a}return r}));return o?{...e,commandHistory:r}:e})(e,t);case"clear":return{...e,commandHistory:[]}}return e},L=Object(r.createContext)(null),$=Object(r.memo)((({commands:e,scrollToBottom:t,HelpComponent:n,dataTestSubj:a,children:o})=>{const[i,l]=Object(r.useReducer)(F,{commands:e,scrollToBottom:t,HelpComponent:n,dataTestSubj:a},A);return s.a.createElement(L.Provider,{value:{state:i,dispatch:l}},o)}));$.displayName="ConsoleStateProvider";const D=()=>{const e=Object(r.useContext)(L);if(!e)throw new Error("ConsoleStateContext not defined");return e},P=()=>D().dispatch,U=c.a.div.withConfig({displayName:"CommandOutputContainer",componentId:"sc-10ffpqv-0"})(["position:relative;"]),B=Object(r.memo)((({item:{command:e,state:t,id:n}})=>{const a=P(),o=e.commandDefinition.RenderComponent,l=Object(r.useMemo)((()=>"pending"===t.status),[t.status]),c=Object(r.useCallback)((e=>{a({type:"updateCommandStatusState",payload:{id:n,value:e}})}),[a,n]),d=Object(r.useCallback)((e=>{a({type:"updateCommandStoreState",payload:{id:n,value:e}})}),[a,n]);return s.a.createElement(U,null,s.a.createElement("div",null,s.a.createElement(u,{input:e.input}),l&&s.a.createElement(i.EuiLoadingChart,{size:"m",style:{marginLeft:"0.5em"}})),s.a.createElement("div",null,s.a.createElement(o,{command:e,store:t.store,status:t.status,setStore:d,setStatus:c})))}));B.displayName="CommandExecutionOutput";const _=Object(r.memo)((({children:e})=>{const t=Object(E.a)(f());return s.a.createElement(i.EuiFlexItem,{grow:!0,style:{flexBasis:"100%"},"data-test-subj":t("historyItem")},e)}));_.displayName="HistoryItem";const H=Object(r.memo)((e=>{const t=D().state.commandHistory,n=P(),a=Object(E.a)(f()),l=Object(r.useMemo)((()=>t.map((e=>s.a.createElement(_,{key:e.id},s.a.createElement(B,{item:e}))))),[t]);return Object(r.useEffect)((()=>{n({type:"scrollDown"})}),[n,t.length]),s.a.createElement(i.EuiFlexGroup,o()({"data-test-subj":a("historyOutput")},e,{wrap:!0,direction:"row",alignItems:"flexEnd",responsive:!1}),l)}));H.displayName="HistoryOutput";var G=n(90),q=n.n(G),V=n(6);const z=()=>{},K=c.a.span.withConfig({displayName:"KeyCaptureContainer",componentId:"sc-1ee1vs2-0"})(["display:inline-block;position:relative;width:1px;height:1em;overflow:hidden;.invisible-input{&,&:focus{border:none;background-image:none;background-color:transparent;-webkit-box-shadow:none;-moz-box-shadow:none;box-shadow:none;animation:none !important;width:1ch !important;position:absolute;left:-100px;top:-100px;}}"]),X=Object(r.memo)((({onCapture:e,focusRef:t,onStateChange:n})=>{const[,a]=Object(r.useState)(""),o=Object(E.a)(f()),i=Object(r.useCallback)((e=>{n&&n("focus"===e.type)}),[n]),l=Object(r.useCallback)((t=>{t.stopPropagation();const n=Object(V.pick)(t,["key","altKey","ctrlKey","keyCode","metaKey","repeat","shiftKey"]);a((t=>(e({value:t,eventDetails:n}),"")))}),[e]),c=Object(r.useCallback)((e=>{const t=e.currentTarget.value;a((e=>`${e||""}${t}`))}),[]),u=Object(r.useRef)(null),d=Object(r.useCallback)(((e=!1)=>{var t,n,a;!e&&(null!==(t=null===(n=window.getSelection())||void 0===n?void 0:n.toString())&&void 0!==t?t:"").length>0||null===(a=u.current)||void 0===a||a.focus()}),[]);return t&&(t.current=d),s.a.createElement(K,{"data-test-subj":o("keyCapture")},s.a.createElement("input",{className:"invisible-input","data-test-subj":o("keyCapture-input"),spellCheck:"false",value:"",onInput:c,onKeyUp:l,onBlur:i,onFocus:i,onChange:z,ref:u}))}));X.displayName="KeyCapture";const W=c.a.div.withConfig({displayName:"CommandInputContainer",componentId:"sc-1ll2wia-0"})([".prompt{padding-right:1ch;}.textEntered{white-space:break-spaces;}.cursor{display:inline-block;width:0.5em;height:1em;background-color:",";animation:cursor-blink-animation 1s steps(5,start) infinite;-webkit-animation:cursor-blink-animation 1s steps(5,start) infinite;@keyframes cursor-blink-animation{to{visibility:hidden;}}@-webkit-keyframes cursor-blink-animation{to{visibility:hidden;}}&.inactive{background-color:transparent !important;}}"],(({theme:e})=>e.eui.euiTextColors.default)),Q=Object(r.memo)((({prompt:e=">",focusRef:t,...n})=>{const a=P(),[l,c]=Object(r.useState)(""),[u,d]=Object(r.useState)(!1),m=Object(r.useRef)(null),p=Object(r.useRef)(null),b=Object(E.a)(f()),g=t||m,h=Object(r.useCallback)((e=>{d(e)}),[]),O=Object(r.useCallback)((e=>{g.current&&g.current()}),[g]),j=Object(r.useCallback)((({value:e,eventDetails:t})=>{c((n=>{let o=n+e;switch(t.keyCode){case 8:o.length&&(o=o.replace(/.$/,""));break;case 13:return a({type:"executeCommand",payload:{input:o}}),""}return o}))}),[a]);return s.a.createElement(W,o()({},n,{onClick:O}),s.a.createElement(i.EuiFlexGroup,{wrap:!0,responsive:!1,alignItems:"flexStart",gutterSize:"none",justifyContent:"flexStart",ref:p},s.a.createElement(i.EuiFlexItem,{grow:!1,"data-test-subj":b("cmdInput-prompt")},s.a.createElement("span",{className:"eui-displayInlineBlock prompt"},e)),s.a.createElement(i.EuiFlexItem,{className:"textEntered",grow:!1,"data-test-subj":b("cmdInput-userTextInput")},l),s.a.createElement(i.EuiFlexItem,{grow:!0},s.a.createElement("span",{className:q()({cursor:!0,inactive:!u})}))),s.a.createElement(X,{onCapture:j,focusRef:g,onStateChange:h}))}));Q.displayName="CommandInput";var Y=n(494);const J=c.a.div.withConfig({displayName:"ConsoleWindow",componentId:"sc-u5ji78-0"})(["height:100%;filter:invert(100%);.ui-panel{min-width:",";height:100%;min-height:300px;overflow-y:auto;}.descriptionList-20_80{&.euiDescriptionList{> .euiDescriptionList__title{width:20%;}> .euiDescriptionList__description{width:80%;}}}"],(({theme:e})=>e.eui.euiBreakpoints.s)),Z=Object(r.memo)((({prompt:e,commands:t,HelpComponent:n,managedKey:a,...l})=>{const c=Object(r.useRef)(null),u=Object(r.useRef)(null),d=Object(E.a)(l["data-test-subj"]),m=Object(Y.c)(a),p=Object(r.useCallback)((()=>{setTimeout((()=>{c.current&&(c.current.scrollTop=c.current.scrollHeight)}),1)}),[]),f=Object(r.useCallback)((()=>{u.current&&u.current()}),[]);return s.a.createElement($,{commands:t,scrollToBottom:p,HelpComponent:n,dataTestSubj:l["data-test-subj"]},!m||m.isOpen?s.a.createElement(J,o()({onClick:f},l),s.a.createElement(i.EuiPanel,{className:"ui-panel",panelRef:c,"data-test-subj":d("mainPanel")},s.a.createElement(i.EuiFlexGroup,{direction:"column"},s.a.createElement(i.EuiFlexItem,{grow:!0},s.a.createElement(H,null)),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(Q,{prompt:e,focusRef:u}))))):null)}));Z.displayName="Console"},603:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return A}));var a=n(215),o=n(329),r=n(18),s=n(256);const i=(e,t={})=>{const n=Object(r.i)();return Object(a.useQuery)({queryKey:["get-endpoint-host-info",e],...t,queryFn:()=>n.get(Object(o.a)(s.e,{id:e.trim()||"undefined"}))})};var l=n(5),c=n.n(l),u=n(4),d=n(165),m=n(16),p=n(362);const E=Object(l.memo)((({command:e,setStore:t,store:n,status:i,setStatus:E})=>{var f,b,g,h,O;const j=null===(f=e.commandDefinition)||void 0===f||null===(b=f.meta)||void 0===b?void 0:b.endpointId,{actionId:v,completedActionDetails:y}=n,I="pending"===i,k=Boolean(n.actionRequestSent),S=Object(a.useMutation)((e=>Object(p.a)(e)),undefined);const{data:C}=((e,t={})=>{const n=Object(r.i)();return Object(a.useQuery)({queryKey:["get-action-details",e],...t,queryFn:()=>n.get(Object(o.a)(s.a,{action_id:e.trim()||"undefined"}))})})(null!=v?v:"-",{enabled:Boolean(v)&&I,refetchInterval:!!I&&3e3});return Object(l.useEffect)((()=>{var n,a;!k&&j&&(S.mutate({endpoint_ids:[j],comment:null===(n=e.args.args)||void 0===n||null===(a=n.comment)||void 0===a?void 0:a.value}),t((e=>({...e,actionRequestSent:!0}))))}),[k,null===(g=e.args.args)||void 0===g||null===(h=g.comment)||void 0===h?void 0:h.value,j,S,t]),Object(l.useEffect)((()=>{S.isSuccess&&v!==S.data.action&&t((e=>({...e,actionId:S.data.action})))}),[v,null==S||null===(O=S.data)||void 0===O?void 0:O.action,S.isSuccess,t]),Object(l.useEffect)((()=>{null!=C&&C.data.isCompleted&&(E("success"),t((e=>({...e,completedActionDetails:C.data}))))}),[null==C?void 0:C.data,E,t]),I?null:null!=y&&y.errors?c.a.createElement(m.EuiCallOut,{color:"danger",iconType:"alert",title:u.i18n.translate("xpack.securitySolution.endpointResponseActions.isolate.errorMessageTitle",{defaultMessage:"Failure"}),"data-test-subj":"isolateErrorCallout"},c.a.createElement(d.FormattedMessage,{id:"xpack.securitySolution.endpointResponseActions.isolate.errorMessage",defaultMessage:"Isolate action failed with: {errors}",values:{errors:y.errors.join(" | ")}})):c.a.createElement(m.EuiCallOut,{color:"success",iconType:"check",title:u.i18n.translate("xpack.securitySolution.endpointResponseActions.isolate.successMessageTitle",{defaultMessage:"Success"}),"data-test-subj":"isolateSuccessCallout"},c.a.createElement(d.FormattedMessage,{id:"xpack.securitySolution.endpointResponseActions.isolate.successMessage",defaultMessage:"A host isolation request was sent and an acknowledgement was received from Host."}))}));E.displayName="IsolateActionResult";var f=n(50),b=n.n(f),g=n(43),h=n(495),O=n(201),j=n(409);const v=Object(l.memo)((({policyApplied:e,children:t})=>c.a.createElement(m.EuiToolTip,{title:c.a.createElement(d.FormattedMessage,{id:"xpack.securitySolution.endpointPolicyStatus.tooltipTitleLabel",defaultMessage:"Policy applied"}),anchorClassName:"eui-textTruncate",content:c.a.createElement(m.EuiFlexGroup,{responsive:!1,gutterSize:"s",alignItems:"center","data-test-subj":"endpointAppliedPolicyTooltipInfo"},c.a.createElement(m.EuiFlexItem,{className:"eui-textTruncate",grow:!0},c.a.createElement(m.EuiText,{size:"s",className:"eui-textTruncate"},e.name)),e.endpoint_policy_version&&c.a.createElement(m.EuiFlexItem,{grow:!1},c.a.createElement(m.EuiText,{color:"subdued",size:"xs",style:{whiteSpace:"nowrap",paddingLeft:"6px"},className:"eui-textTruncate","data-test-subj":"policyRevision"},c.a.createElement(d.FormattedMessage,{id:"xpack.securitySolution.endpointPolicyStatus.revisionNumber",defaultMessage:"rev. {revNumber}",values:{revNumber:e.endpoint_policy_version}}))))},c.a.createElement(m.EuiHealth,{color:j.c[e.status],className:"eui-textTruncate eui-fullWidth","data-test-subj":"policyStatus"},void 0!==t?t:j.d[e.status]))));v.displayName="EndpointAppliedPolicyStatus";var y=n(23),I=n.n(y),k=n(198),S=n(454),C=n(321);const x=I()(m.EuiFlexGroup).withConfig({displayName:"EuiFlexGroupStyled",componentId:"sc-1uxyi62-0"})([".isolation-status{margin-left:",";}"],(({theme:e})=>e.eui.paddingSizes.s)),w=Object(l.memo)((({status:e,isIsolated:t,pendingIsolate:n,pendingUnIsolate:a,"data-test-subj":o})=>{const r=Object(k.a)(o);return c.a.createElement(x,{gutterSize:"none",responsive:!1,className:"eui-textTruncate","data-test-subj":o},c.a.createElement(m.EuiFlexItem,{grow:!1},c.a.createElement(S.a,{hostStatus:e})),void 0!==t&&c.a.createElement(m.EuiFlexItem,{grow:!1,className:"eui-textTruncate isolation-status"},c.a.createElement(C.b,{"data-test-subj":r("isolationStatus"),isIsolated:t,pendingIsolate:n,pendingUnIsolate:a})))}));w.displayName="EndpointAgentAndIsolationStatus";var N=n(855);const T=Object(l.memo)((({command:e,status:t,setStatus:n,store:o,setStore:r})=>{var s,p,E;const f=null===(s=e.commandDefinition)||void 0===s||null===(p=s.meta)||void 0===p?void 0:p.endpointId,{endpointPendingActions:j,endpointDetails:y,detailsFetchError:I,apiCalled:k}=o,S="pending"===t,{isFetching:C,isFetched:x,refetch:T}=i(f,{enabled:!1}),{refetch:M}=((e,t={})=>Object(a.useQuery)({queryKey:["fetch-endpoint-pending-actions-summary",...e],...t,queryFn:()=>Object(h.a)(e)}))([f],{enabled:!1}),R=Object(l.useMemo)((()=>{if(null!=j&&j.data.length){var e,t;const n=j.data[0].pending_actions;return{pendingIsolate:null!==(e=n.isolate)&&void 0!==e?e:0,pendingUnIsolate:null!==(t=n.unisolate)&&void 0!==t?t:0}}return{pendingIsolate:0,pendingUnIsolate:0}}),[null==j?void 0:j.data]);return Object(l.useEffect)((()=>{k||(r((e=>({...e,apiCalled:!0}))),T({queryKey:Object(g.v4)()}).then((({data:e})=>{r((t=>({...t,endpointDetails:e})))})).catch((e=>{r((t=>({...t,detailsFetchError:e})))})),M({queryKey:Object(g.v4)()}).then((({data:e})=>{r((t=>({...t,endpointPendingActions:e})))})))}),[k,T,M,r]),Object(l.useEffect)((()=>{x&&S&&n(I?"error":"success")}),[I,x,n,S]),C?null:I?c.a.createElement(m.EuiCallOut,null,c.a.createElement(m.EuiFieldText,null,c.a.createElement(N.a,{error:I}))):y?c.a.createElement(m.EuiFlexGroup,{wrap:!1,responsive:!1},c.a.createElement(m.EuiFlexItem,{grow:!1},c.a.createElement(m.EuiText,{size:"s"},c.a.createElement(d.FormattedMessage,{id:"xpack.securitySolution.endpointResponseActions.status.agentStatus",defaultMessage:"Agent status"})),c.a.createElement(w,b()({status:y.host_status,isIsolated:Boolean(null===(E=y.metadata.Endpoint.state)||void 0===E?void 0:E.isolation)},R))),c.a.createElement(m.EuiFlexItem,{grow:!1},c.a.createElement(m.EuiText,{size:"s"},c.a.createElement(d.FormattedMessage,{id:"xpack.securitySolution.endpointResponseActions.status.policyStatus",defaultMessage:"Policy status"})),c.a.createElement(v,{policyApplied:y.metadata.Endpoint.policy.applied})),c.a.createElement(m.EuiFlexItem,null,c.a.createElement(m.EuiText,{size:"s"},c.a.createElement(d.FormattedMessage,{id:"xpack.securitySolution.endpointResponseActions.status.lastActive",defaultMessage:"Last active"})),c.a.createElement(m.EuiText,null,c.a.createElement(O.a,{fieldName:u.i18n.translate("xpack.securitySolution.endpointResponseActions.status.lastActive",{defaultMessage:"Last active"}),value:y.metadata["@timestamp"],className:"eui-textTruncate"})))):null}));T.displayName="EndpointStatusActionResult";const M=e=>[{name:"isolate",about:u.i18n.translate("xpack.securitySolution.endpointConsoleCommands.isolate.about",{defaultMessage:"Isolate the host"}),RenderComponent:E,meta:{endpointId:e},args:{comment:{required:!1,allowMultiples:!1,about:u.i18n.translate("xpack.securitySolution.endpointConsoleCommands.isolate.arg.command",{defaultMessage:"A comment to go along with the action"})}}},{name:"status",about:u.i18n.translate("xpack.securitySolution.endpointConsoleCommands.status.about",{defaultMessage:"Display the latest status information for the Endpoint"}),RenderComponent:T,meta:{endpointId:e}}];n(601);var R=n(457);const A=()=>{const e=Object(R.b)();return Object(l.useCallback)((t=>{const n=t.agent.id,a=e.getOne(n);a?a.show():e.register({id:n,title:`${t.host.name} - Endpoint v${t.agent.version}`,consoleProps:{commands:M(n),"data-test-subj":"endpointResponseActionsConsole",prompt:`endpoint-${t.agent.version}`}}).show()}),[e])}},676:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return r}));var a=n(139);const o=[a.a.appQuery,a.a.filters,a.a.savedQuery,a.a.sourcerer,a.a.timerange,a.a.timeline],r=e=>"administration"===e},677:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(8);let o;!function(e){e.dashboards="dashboards",e.detect="detect",e.explore="explore",e.investigate="investigate",e.manage="manage"}(o||(o={})),a.a.administration,a.a.alerts,a.a.blocklist,a.a.detectionAndResponse,a.a.case,a.a.endpoints,a.a.landing,a.a.policies,a.a.eventFilters,a.a.exceptions,a.a.hostIsolationExceptions,a.a.hosts,a.a.network,a.a.overview,a.a.rules,a.a.timelines,a.a.trustedApps,a.a.users},692:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return r})),n(1);var a=n(273);const o=(e,t)=>`/${e}${Object(a.a)(t)}`,r=(e,t,n)=>`/${e}/${t}${Object(a.a)(n)}`},711:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(16),o=n(165),r=n(51),s=n.n(r),i=n(5),l=n.n(i);const c=l.a.memo((({children:e,date:t,fieldName:n,className:r=""})=>l.a.createElement(a.EuiToolTip,{"data-test-subj":"localized-date-tool-tip",anchorClassName:r,content:l.a.createElement(a.EuiFlexGroup,{"data-test-subj":"dates-container",direction:"column",gutterSize:"none"},null!=n?l.a.createElement(a.EuiFlexItem,{grow:!1},l.a.createElement("span",{"data-test-subj":"field-name"},n)):null,l.a.createElement(a.EuiFlexItem,{grow:!1},l.a.createElement(o.FormattedRelative,{"data-test-subj":"humanized-relative-date",value:s.a.utc(t).toDate()})),l.a.createElement(a.EuiFlexItem,{"data-test-subj":"with-day-of-week",grow:!1},s.a.utc(t).local().format("llll")),l.a.createElement(a.EuiFlexItem,{"data-test-subj":"with-time-zone-offset-in-hours",grow:!1},s()(t).format()))},l.a.createElement(l.a.Fragment,null,e))));c.displayName="LocalizedDateTooltip"},720:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(6),o=n(5),r=n(1),s=n(192),i=n(287),l=n(439);const c=({alertId:e})=>{const[t,n]=Object(o.useState)(!1),[c,u]=Object(o.useState)([]),{addError:d}=Object(s.a)();return Object(o.useEffect)((()=>{let t=!0;return n(!0),Object(a.isEmpty)(e)||(async()=>{try{const n=await Object(i.e)({alertId:e,owner:[r.n]});t&&u(n)}catch(e){d(e.message,{title:l.a})}t&&n(!1)})(),()=>{t=!1}}),[e,d]),{loading:t,casesInfo:c}}},855:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(5),o=n.n(a),r=n(16);const s=Object(a.memo)((({data:e})=>o.a.createElement(r.EuiText,{size:"s"},Object.entries(e).map((([e,t])=>o.a.createElement("div",{key:e,className:"eui-textBreakAll"},o.a.createElement("strong",null,e),": ",t))))));s.displayName="ObjectContent";const i=Object(a.memo)((({error:e,"data-test-subj":t})=>Object(a.useMemo)((()=>{let n=o.a.createElement(o.a.Fragment,null,e.message);var a,i;return(e=>"body"in e&&"req"in e&&"res"in e&&"response"in e)(e)&&(n=o.a.createElement(o.a.Fragment,null,o.a.createElement("div",null,`${null===(a=e.response)||void 0===a?void 0:a.status}: ${null===(i=e.response)||void 0===i?void 0:i.statusText}`),e.body&&o.a.createElement(s,{data:e.body}))),o.a.createElement(r.EuiText,{"data-test-subj":t},n)}),[t,e])));i.displayName="FormattedError"}}]);