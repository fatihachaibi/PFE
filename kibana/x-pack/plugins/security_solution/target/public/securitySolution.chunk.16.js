/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[16],Array(226).concat([function(e,t,a){"use strict";a.r(t),a.d(t,"listData",(function(){return g})),a.d(t,"pageIndex",(function(){return f})),a.d(t,"pageSize",(function(){return b})),a.d(t,"totalHits",(function(){return h})),a.d(t,"listLoading",(function(){return y})),a.d(t,"listError",(function(){return E})),a.d(t,"detailsData",(function(){return v})),a.d(t,"detailsLoading",(function(){return T})),a.d(t,"detailsError",(function(){return k})),a.d(t,"policyItems",(function(){return x})),a.d(t,"policyItemsLoading",(function(){return S})),a.d(t,"selectedPolicyId",(function(){return O})),a.d(t,"endpointPackageInfo",(function(){return w})),a.d(t,"getIsEndpointPackageInfoUninitialized",(function(){return j})),a.d(t,"isAutoRefreshEnabled",(function(){return C})),a.d(t,"autoRefreshInterval",(function(){return I})),a.d(t,"policyVersionInfo",(function(){return M})),a.d(t,"areEndpointsEnrolling",(function(){return A})),a.d(t,"agentsWithEndpointsTotalError",(function(){return D})),a.d(t,"endpointsTotalError",(function(){return q})),a.d(t,"endpointPackageVersion",(function(){return P})),a.d(t,"patterns",(function(){return R})),a.d(t,"patternsError",(function(){return _})),a.d(t,"policyResponseTimestamp",(function(){return L})),a.d(t,"policyResponseAppliedRevision",(function(){return N})),a.d(t,"policyResponseConfigurations",(function(){return B})),a.d(t,"policyResponseFailedOrWarningActionCount",(function(){return z})),a.d(t,"policyResponseActions",(function(){return U})),a.d(t,"policyResponseLoading",(function(){return H})),a.d(t,"policyResponseError",(function(){return $})),a.d(t,"isOnEndpointPage",(function(){return V})),a.d(t,"uiQueryParams",(function(){return Q})),a.d(t,"hasSelectedEndpoint",(function(){return W})),a.d(t,"showView",(function(){return G})),a.d(t,"selectedAgent",(function(){return K})),a.d(t,"hostStatusInfo",(function(){return Y})),a.d(t,"policyResponseStatus",(function(){return J})),a.d(t,"nonExistingPolicies",(function(){return X})),a.d(t,"agentPolicies",(function(){return Z})),a.d(t,"endpointsExist",(function(){return ee})),a.d(t,"searchBarQuery",(function(){return te})),a.d(t,"getCurrentIsolationRequestState",(function(){return ae})),a.d(t,"getIsIsolationRequestPending",(function(){return ne})),a.d(t,"getWasIsolationRequestSuccessful",(function(){return ie})),a.d(t,"getIsolationRequestError",(function(){return re})),a.d(t,"getIsOnEndpointDetailsActivityLog",(function(){return se})),a.d(t,"getActivityLogDataPaging",(function(){return oe})),a.d(t,"getActivityLogData",(function(){return le})),a.d(t,"getLastLoadedActivityLogData",(function(){return ce})),a.d(t,"getActivityLogUninitialized",(function(){return ue})),a.d(t,"getActivityLogRequestLoading",(function(){return de})),a.d(t,"getActivityLogRequestLoaded",(function(){return pe})),a.d(t,"getActivityLogIterableData",(function(){return me})),a.d(t,"getActivityLogError",(function(){return ge})),a.d(t,"getActivityLogIsUninitializedOrHasSubsequentAPIError",(function(){return fe})),a.d(t,"getIsEndpointHostIsolated",(function(){return be})),a.d(t,"getEndpointPendingActionsState",(function(){return he})),a.d(t,"getEndpointHostIsolationStatusPropsCallback",(function(){return ye})),a.d(t,"getMetadataTransformStats",(function(){return Ee})),a.d(t,"metadataTransformStats",(function(){return ve})),a.d(t,"isMetadataTransformStatsLoading",(function(){return Te}));var n=a(337),i=a.n(n),r=a(12),s=a(58),o=a(175),l=a(222),c=a(206),u=a(199),d=a(307),p=a(261),m=a(481);const g=e=>e.hosts,f=e=>e.pageIndex,b=e=>e.pageSize,h=e=>e.total,y=e=>e.loading,E=e=>e.error,v=e=>e.endpointDetails.hostDetails.details,T=e=>e.endpointDetails.hostDetails.detailsLoading,k=e=>e.endpointDetails.hostDetails.detailsError,x=e=>e.policyItems,S=e=>e.policyItemsLoading,O=e=>e.selectedPolicyId,w=e=>e.endpointPackageInfo,j=Object(r.createSelector)(w,(e=>Object(d.j)(e))),C=e=>e.isAutoRefreshEnabled,I=e=>e.autoRefreshInterval,M=e=>e.policyVersionInfo,A=e=>e.agentsWithEndpointsTotal>e.endpointsTotal,D=e=>e.agentsWithEndpointsTotalError,q=e=>e.endpointsTotalError,P=Object(r.createSelector)(w,(e=>Object(d.h)(e)?e.data.version:void 0)),R=e=>e.patterns,_=e=>e.patternsError,F=e=>e.policyResponse&&e.policyResponse.Endpoint.policy.applied,L=e=>e.policyResponse&&e.policyResponse["@timestamp"],N=e=>{var t;return String((null===(t=e.policyResponse)||void 0===t?void 0:t.Endpoint.policy.applied.endpoint_policy_version)||"")},B=Object(r.createSelector)(F,(e=>{var t;return null==e||null===(t=e.response)||void 0===t?void 0:t.configurations})),z=Object(r.createSelector)(F,(e=>{var t;const a=new Map;return void 0!==(null==e||null===(t=e.response)||void 0===t?void 0:t.configurations)&&void 0!==(null==e?void 0:e.actions)&&Object.entries(e.response.configurations).map((([t,n])=>{let i=0;for(const t of n.concerned_actions){var r;const a=null===(r=e.actions.find((e=>e.name===t)))||void 0===r?void 0:r.status;a!==l.c.failure&&a!==l.c.warning||(i+=1)}return a.set(t,i)})),a})),U=Object(r.createSelector)(F,(e=>null==e?void 0:e.actions)),H=e=>e.policyResponseLoading,$=e=>e.policyResponseError,V=e=>{var t,a;return null!==Object(s.matchPath)(null!==(t=null===(a=e.location)||void 0===a?void 0:a.pathname)&&void 0!==t?t:"",{path:u.h,exact:!0})},Q=Object(r.createSelector)((e=>e.location),(e=>{const t={page_index:String(u.b),page_size:String(u.c)};if(e){const a=i.a.parse(e.search.slice(1)),n=Object(c.a)(a),r=["selected_endpoint","show","admin_query"],s=["policy_response","details","isolate","unisolate","activity_log"];for(const e of r){const n="string"==typeof a[e]?a[e]:Array.isArray(a[e])?a[e][a[e].length-1]:void 0;void 0!==n&&("show"===e?s.includes(n)&&(t[e]=n):t[e]=n)}t.page_size=String(n.page_size),t.page_index=String(n.page_index)}return t})),W=Object(r.createSelector)(Q,(({selected_endpoint:e})=>void 0!==e)),G=Object(r.createSelector)(Q,(e=>{var t;return null!==(t=e.show)&&void 0!==t?t:"details"})),K=e=>{var t;const a=e.hosts,{selected_endpoint:n}=Q(e);return(null===(t=a.find((e=>e.metadata.agent.id===n)))||void 0===t?void 0:t.metadata.elastic.agent.id)||""},Y=Object(r.createSelector)((e=>e.hostStatus),(e=>e||l.d.UNHEALTHY)),J=Object(r.createSelector)((e=>e.policyResponse),(e=>{var t,a,n;return e&&(null==e||null===(t=e.Endpoint)||void 0===t||null===(a=t.policy)||void 0===a||null===(n=a.applied)||void 0===n?void 0:n.status)||""})),X=e=>e.nonExistingPolicies,Z=e=>e.agentPolicies,ee=e=>e.endpointsExist,te=Object(r.createSelector)(Q,(({admin_query:e})=>{const t={query:"",language:"kuery"};if(e){const a=Object(o.decode)(e);a&&"string"==typeof a.query&&(t.query=a.query),!a||"string"!=typeof a.language||"kuery"!==a.language&&"lucene"!==a.language||(t.language=a.language)}return t})),ae=e=>e.isolationRequestState,ne=Object(r.createSelector)(ae,(e=>Object(d.i)(e))),ie=Object(r.createSelector)(ae,(e=>Object(d.h)(e))),re=Object(r.createSelector)(ae,(e=>{if(Object(d.g)(e))return e.error})),se=Object(r.createSelector)(Q,(e=>e.show===m.b.activityLog)),oe=e=>e.endpointDetails.activityLog.paging,le=e=>e.endpointDetails.activityLog.logData,ce=Object(r.createSelector)(le,(e=>{var t;return null===(t=Object(d.f)(e))||void 0===t?void 0:t.data})),ue=Object(r.createSelector)(le,(e=>Object(d.j)(e))),de=Object(r.createSelector)(le,(e=>Object(d.i)(e))),pe=Object(r.createSelector)(le,(e=>Object(d.h)(e))),me=Object(r.createSelector)(le,(e=>Object(d.h)(e)?e.data.data:[])),ge=Object(r.createSelector)(le,(e=>{if(Object(d.g)(e))return e.error})),fe=Object(r.createSelector)(ue,ce,ge,((e,t,a)=>e||!a&&!(null==t||!t.data.length))),be=Object(r.createSelector)(v,(e=>e&&Object(p.b)(e)||!1)),he=e=>e.endpointPendingActions,ye=Object(r.createSelector)(he,(e=>t=>{let a=0,n=0;if(Object(d.h)(e)){const s=e.data.get(t.elastic.agent.id);var i,r;s&&(a=null!==(i=null==s?void 0:s.isolate)&&void 0!==i?i:0,n=null!==(r=null==s?void 0:s.unisolate)&&void 0!==r?r:0)}return{isIsolated:Object(p.b)(t),pendingIsolate:a,pendingUnIsolate:n}})),Ee=e=>e.metadataTransformStats,ve=e=>Object(d.h)(e.metadataTransformStats)?e.metadataTransformStats.data:[],Te=e=>Object(d.i)(e.metadataTransformStats)},,,,,,,,,,,,,,function(e,t,a){"use strict";a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return E}));var n=a(42),i=a(5),r=a.n(i),s=a(176),o=a(199);function l(e){return Object(n.useSelector)((function(t){return e(t[o.t][o.s])}))}a(18);var c=a(165),u=a(603),d=a(200),p=a(1),m=a(206),g=a(226),f=a(91),b=a(261),h=a(76),y=a(544);const E=e=>{const t=Object(h.b)().isPlatinumPlus(),{getAppUrl:a}=Object(f.b)(),n=l(g.agentPolicies),o=l(g.uiQueryParams),E=Object(u.b)(),v=Object(d.a)("responseActionsConsoleEnabled");return Object(i.useMemo)((()=>{if(e){const i=Object(b.b)(e),l=e.agent.id,u=e.Endpoint.policy.applied.id,d=e.host.hostname,g=e.elastic.agent.id,f=Object(y.a)({osName:e.host.os.name,version:e.agent.version,capabilities:e.Endpoint.capabilities}),{show:h,selected_endpoint:T,...k}=o,x=Object(m.d)({name:"endpointIsolate",...k,selected_endpoint:l}),S=Object(m.d)({name:"endpointUnIsolate",...k,selected_endpoint:l}),O=[];return i?O.push({"data-test-subj":"unIsolateLink",icon:"lockOpen",key:"unIsolateHost",navigateAppId:p.y,navigateOptions:{path:S},href:a({path:S}),children:r.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.unIsolateHost",defaultMessage:"Release host"})}):t&&f&&O.push({"data-test-subj":"isolateLink",icon:"lock",key:"isolateHost",navigateAppId:p.y,navigateOptions:{path:x},href:a({path:x}),children:r.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.isolateHost",defaultMessage:"Isolate host"})}),[...O,...v?[{"data-test-subj":"console",icon:"console",key:"consoleLink",onClick:t=>{t.preventDefault(),E(e)},children:r.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.console",defaultMessage:"Launch responder"})}]:[],{"data-test-subj":"hostLink",icon:"logoSecurity",key:"hostDetailsLink",navigateAppId:p.y,navigateOptions:{path:`/hosts/${d}`},href:a({path:`/hosts/${d}`}),children:r.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.hostDetails",defaultMessage:"View host details"})},{icon:"gear",key:"agentConfigLink","data-test-subj":"agentPolicyLink",navigateAppId:"fleet",navigateOptions:{path:`${s.pagePathGetters.policy_details({policyId:n[u]})[1]}`},href:`${a({appId:"fleet"})}${s.pagePathGetters.policy_details({policyId:n[u]})[1]}`,disabled:void 0===n[u],children:r.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.agentPolicy",defaultMessage:"View agent policy"})},{icon:"gear",key:"agentDetailsLink","data-test-subj":"agentDetailsLink",navigateAppId:"fleet",navigateOptions:{path:`${s.pagePathGetters.agent_details({agentId:g})[1]}`},href:`${a({appId:"fleet"})}${s.pagePathGetters.agent_details({agentId:g})[1]}`,children:r.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.agentDetails",defaultMessage:"View agent details"})},{icon:"gear",key:"agentPolicyReassignLink","data-test-subj":"agentPolicyReassignLink",navigateAppId:"fleet",navigateOptions:{path:`${s.pagePathGetters.agent_details({agentId:g})[1]}?openReassignFlyout=true`},href:`${a({appId:"fleet"})}${s.pagePathGetters.agent_details({agentId:g})[1]}?openReassignFlyout=true`,children:r.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.agentPolicyReassign",defaultMessage:"Reassign agent policy"})}]}return[]}),[o,e,n,a,t,v,E])}},,,,,,,,,,,,,function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TEXT_NODE=void 0,t.checkContainerType=function(e){if(!e||"function"!=typeof e.querySelector||"function"!=typeof e.querySelectorAll)throw new TypeError(`Expected container to be an Element, a Document or a DocumentFragment but got ${t=e,"object"==typeof t?null===t?"null":t.constructor.name:typeof t}.`);var t},t.getDocument=function(){if("undefined"==typeof window)throw new Error("Could not find default container");return window.document},t.getWindowFromNode=function(e){if(e.defaultView)return e.defaultView;if(e.ownerDocument&&e.ownerDocument.defaultView)return e.ownerDocument.defaultView;if(e.window)return e.window;throw e.ownerDocument&&null===e.ownerDocument.defaultView?new Error("It looks like the window object is not available for the provided node."):e.then instanceof Function?new Error("It looks like you passed a Promise object instead of a DOM node. Did you do something like `fireEvent.click(screen.findBy...` when you meant to use a `getBy` query `fireEvent.click(screen.getBy...`, or await the findBy query `fireEvent.click(await screen.findBy...`?"):Array.isArray(e)?new Error("It looks like you passed an Array instead of a DOM node. Did you do something like `fireEvent.click(screen.getAllBy...` when you meant to use a `getBy` query `fireEvent.click(screen.getBy...`?"):"function"==typeof e.debug&&"function"==typeof e.logTestingPlaygroundURL?new Error("It looks like you passed a `screen` object. Did you do something like `fireEvent.click(screen, ...` when you meant to use a query, e.g. `fireEvent.click(screen.getBy..., `?"):new Error(`The given node is not an Element, the node type is: ${typeof e}.`)},t.jestFakeTimersAreEnabled=function(){return"undefined"!=typeof jest&&null!==jest&&(!0===setTimeout._isMockFunction||Object.prototype.hasOwnProperty.call(setTimeout,"clock"))},t.TEXT_NODE=3},,,,,,,,,,,,,function(e,t,a){e.exports=a(24)(298)},function(e,t,a){e.exports=a(24)(1592)},,,,,,,,,,,,function(e,t,a){class Range{constructor(e,t){if(t=i(t),e instanceof Range)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new Range(e.raw,t);if(e instanceof r)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map((e=>this.parseRange(e.trim()))).filter((e=>e.length)),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${e}`);if(this.set.length>1){const e=this.set[0];if(this.set=this.set.filter((e=>!m(e[0]))),0===this.set.length)this.set=[e];else if(this.set.length>1)for(const e of this.set)if(1===e.length&&g(e[0])){this.set=[e];break}}this.format()}format(){return this.range=this.set.map((e=>e.join(" ").trim())).join("||").trim(),this.range}toString(){return this.range}parseRange(e){e=e.trim();const t=`parseRange:${Object.keys(this.options).join(",")}:${e}`,a=n.get(t);if(a)return a;const i=this.options.loose,o=i?l[c.HYPHENRANGELOOSE]:l[c.HYPHENRANGE];e=e.replace(o,w(this.options.includePrerelease)),s("hyphen replace",e),e=e.replace(l[c.COMPARATORTRIM],u),s("comparator trim",e,l[c.COMPARATORTRIM]),e=(e=(e=e.replace(l[c.TILDETRIM],d)).replace(l[c.CARETTRIM],p)).split(/\s+/).join(" ");const g=i?l[c.COMPARATORLOOSE]:l[c.COMPARATOR],f=e.split(" ").map((e=>b(e,this.options))).join(" ").split(/\s+/).map((e=>O(e,this.options))).filter(this.options.loose?e=>!!e.match(g):()=>!0).map((e=>new r(e,this.options))),h=(f.length,new Map);for(const e of f){if(m(e))return[e];h.set(e.value,e)}h.size>1&&h.has("")&&h.delete("");const y=[...h.values()];return n.set(t,y),y}intersects(e,t){if(!(e instanceof Range))throw new TypeError("a Range is required");return this.set.some((a=>f(a,t)&&e.set.some((e=>f(e,t)&&a.every((a=>e.every((e=>a.intersects(e,t)))))))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new o(e,this.options)}catch(e){return!1}for(let t=0;t<this.set.length;t++)if(j(this.set[t],e,this.options))return!0;return!1}}e.exports=Range;const n=new(a(1043))({max:1e3}),i=a(460),r=a(476),s=a(458),o=a(243),{re:l,t:c,comparatorTrimReplace:u,tildeTrimReplace:d,caretTrimReplace:p}=a(377),m=e=>"<0.0.0-0"===e.value,g=e=>""===e.value,f=(e,t)=>{let a=!0;const n=e.slice();let i=n.pop();for(;a&&n.length;)a=n.every((e=>i.intersects(e,t))),i=n.pop();return a},b=(e,t)=>(s("comp",e,t),e=v(e,t),s("caret",e),e=y(e,t),s("tildes",e),e=k(e,t),s("xrange",e),e=S(e,t),s("stars",e),e),h=e=>!e||"x"===e.toLowerCase()||"*"===e,y=(e,t)=>e.trim().split(/\s+/).map((e=>E(e,t))).join(" "),E=(e,t)=>{const a=t.loose?l[c.TILDELOOSE]:l[c.TILDE];return e.replace(a,((t,a,n,i,r)=>{let o;return s("tilde",e,t,a,n,i,r),h(a)?o="":h(n)?o=`>=${a}.0.0 <${+a+1}.0.0-0`:h(i)?o=`>=${a}.${n}.0 <${a}.${+n+1}.0-0`:r?(s("replaceTilde pr",r),o=`>=${a}.${n}.${i}-${r} <${a}.${+n+1}.0-0`):o=`>=${a}.${n}.${i} <${a}.${+n+1}.0-0`,s("tilde return",o),o}))},v=(e,t)=>e.trim().split(/\s+/).map((e=>T(e,t))).join(" "),T=(e,t)=>{s("caret",e,t);const a=t.loose?l[c.CARETLOOSE]:l[c.CARET],n=t.includePrerelease?"-0":"";return e.replace(a,((t,a,i,r,o)=>{let l;return s("caret",e,t,a,i,r,o),h(a)?l="":h(i)?l=`>=${a}.0.0${n} <${+a+1}.0.0-0`:h(r)?l="0"===a?`>=${a}.${i}.0${n} <${a}.${+i+1}.0-0`:`>=${a}.${i}.0${n} <${+a+1}.0.0-0`:o?(s("replaceCaret pr",o),l="0"===a?"0"===i?`>=${a}.${i}.${r}-${o} <${a}.${i}.${+r+1}-0`:`>=${a}.${i}.${r}-${o} <${a}.${+i+1}.0-0`:`>=${a}.${i}.${r}-${o} <${+a+1}.0.0-0`):(s("no pr"),l="0"===a?"0"===i?`>=${a}.${i}.${r}${n} <${a}.${i}.${+r+1}-0`:`>=${a}.${i}.${r}${n} <${a}.${+i+1}.0-0`:`>=${a}.${i}.${r} <${+a+1}.0.0-0`),s("caret return",l),l}))},k=(e,t)=>(s("replaceXRanges",e,t),e.split(/\s+/).map((e=>x(e,t))).join(" ")),x=(e,t)=>{e=e.trim();const a=t.loose?l[c.XRANGELOOSE]:l[c.XRANGE];return e.replace(a,((a,n,i,r,o,l)=>{s("xRange",e,a,n,i,r,o,l);const c=h(i),u=c||h(r),d=u||h(o),p=d;return"="===n&&p&&(n=""),l=t.includePrerelease?"-0":"",c?a=">"===n||"<"===n?"<0.0.0-0":"*":n&&p?(u&&(r=0),o=0,">"===n?(n=">=",u?(i=+i+1,r=0,o=0):(r=+r+1,o=0)):"<="===n&&(n="<",u?i=+i+1:r=+r+1),"<"===n&&(l="-0"),a=`${n+i}.${r}.${o}${l}`):u?a=`>=${i}.0.0${l} <${+i+1}.0.0-0`:d&&(a=`>=${i}.${r}.0${l} <${i}.${+r+1}.0-0`),s("xRange return",a),a}))},S=(e,t)=>(s("replaceStars",e,t),e.trim().replace(l[c.STAR],"")),O=(e,t)=>(s("replaceGTE0",e,t),e.trim().replace(l[t.includePrerelease?c.GTE0PRE:c.GTE0],"")),w=e=>(t,a,n,i,r,s,o,l,c,u,d,p,m)=>`${a=h(n)?"":h(i)?`>=${n}.0.0${e?"-0":""}`:h(r)?`>=${n}.${i}.0${e?"-0":""}`:s?`>=${a}`:`>=${a}${e?"-0":""}`} ${l=h(c)?"":h(u)?`<${+c+1}.0.0-0`:h(d)?`<${c}.${+u+1}.0-0`:p?`<=${c}.${u}.${d}-${p}`:e?`<${c}.${u}.${+d+1}-0`:`<=${l}`}`.trim(),j=(e,t,a)=>{for(let a=0;a<e.length;a++)if(!e[a].test(t))return!1;if(t.prerelease.length&&!a.includePrerelease){for(let a=0;a<e.length;a++)if(s(e[a].semver),e[a].semver!==r.ANY&&e[a].semver.prerelease.length>0){const n=e[a].semver;if(n.major===t.major&&n.minor===t.minor&&n.patch===t.patch)return!0}return!1}return!0}},function(e,t,a){"use strict";a.d(t,"m",(function(){return i})),a.d(t,"k",(function(){return r})),a.d(t,"l",(function(){return s})),a.d(t,"i",(function(){return o})),a.d(t,"j",(function(){return l})),a.d(t,"h",(function(){return c})),a.d(t,"g",(function(){return u})),a.d(t,"b",(function(){return d})),a.d(t,"a",(function(){return p})),a.d(t,"d",(function(){return m})),a.d(t,"c",(function(){return g})),a.d(t,"f",(function(){return f})),a.d(t,"e",(function(){return b}));var n=a(4);const i=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlValidation.requestError",{defaultMessage:"An error occurred while validating your EQL query"}),r=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlValidation.title",{defaultMessage:"EQL Validation Errors"}),s=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlValidation.showErrorsLabel",{defaultMessage:"Show EQL Validation Errors"}),o=(n.i18n.translate("xpack.securitySolution.detectionEngine.eqlQueryBar.label",{defaultMessage:"Enter an EQL Query"}),n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOverViewLink.text",{defaultMessage:"Event Query Language (EQL) Overview"})),l=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlSettings.title",{defaultMessage:"EQL settings"}),c=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsSize.label",{defaultMessage:"Size"}),u=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsSize.text",{defaultMessage:"For basic queries, the maximum number of matching events to return. For sequence queries, the maximum number of matching sequences to return."}),d=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventCategoryField.label",{defaultMessage:"Event category field"}),p=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventCategoryField.text",{defaultMessage:"Field containing the event classification, such as process, file, or network. This field is typically mapped as a field type in the keyword family"}),m=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTiebreakerField.label",{defaultMessage:"Tiebreaker field"}),g=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTiebreakerField.text",{defaultMessage:"Field used to sort hits with the same timestamp in ascending, lexicographic order"}),f=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTimestampField.label",{defaultMessage:"Timestamp field"}),b=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTimestampField.text",{defaultMessage:"Field containing event timestamp"})},,,,,,,,,,,,,,,,,,,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(5),i=a(58);const r=(e,t)=>{const a=Object(i.useHistory)();return Object(n.useCallback)((n=>{try{t&&t(n)}catch(e){throw n.preventDefault(),e}n.defaultPrevented||0===n.button&&(n.currentTarget instanceof HTMLAnchorElement&&""!==n.currentTarget.target&&"_self"!==n.currentTarget.target||n.metaKey||n.altKey||n.ctrlKey||n.shiftKey||(n.preventDefault(),Array.isArray(e)?a.push(...e):a.push(e)))}),[a,t,e])}},function(e,t,a){e.exports=a(24)(378)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildQueries=function(e,t,a){const n=g(u(e,t),e.name,"query"),i=p(e,a),r=u(i,t),s=g(r,e.name,"get");return[n,f(i,e.name.replace("query","get"),"getAll"),s,m(f(i,e.name,"findAll")),m(g(r,e.name,"find"))]},t.getElementError=o,t.getMultipleElementsFoundError=l,t.makeFindQuery=m,t.makeGetAllQuery=p,t.makeSingleQuery=u,t.queryAllByAttribute=c,t.queryByAttribute=function(e,t,a,n){const i=c(e,t,a,n);if(i.length>1)throw l(`Found multiple elements by [${e}=${a}]`,t);return i[0]||null},t.wrapSingleQueryWithSuggestion=t.wrapAllByQueryWithSuggestion=void 0;var n=a(784),i=a(484),r=a(584),s=a(319);function o(e,t){return(0,s.getConfig)().getElementError(e,t)}function l(e,t){return o(`${e}\n\n(If this is intentional, then use the \`*AllBy*\` variant of the query (like \`queryAllByText\`, \`getAllByText\`, or \`findAllByText\`)).`,t)}function c(e,t,a,{exact:n=!0,collapseWhitespace:r,trim:s,normalizer:o}={}){const l=n?i.matches:i.fuzzyMatches,c=(0,i.makeNormalizer)({collapseWhitespace:r,trim:s,normalizer:o});return Array.from(t.querySelectorAll(`[${e}]`)).filter((t=>l(t.getAttribute(e),t,a,c)))}function u(e,t){return(a,...n)=>{const i=e(a,...n);if(i.length>1){const e=i.map((e=>o(null,e).message)).join("\n\n");throw l(`${t(a,...n)}\n\nHere are the matching elements:\n\n${e}`,a)}return i[0]||null}}function d(e,t){return(0,s.getConfig)().getElementError(`A better query is available, try this:\n${e.toString()}\n`,t)}function p(e,t){return(a,...n)=>{const i=e(a,...n);if(!i.length)throw(0,s.getConfig)().getElementError(t(a,...n),a);return i}}function m(e){return(t,a,n,i)=>(0,r.waitFor)((()=>e(t,a,n)),{container:t,...i})}const g=(e,t,a)=>(i,...r)=>{const o=e(i,...r),[{suggest:l=(0,s.getConfig)().throwSuggestions}={}]=r.slice(-1);if(o&&l){const e=(0,n.getSuggestedQuery)(o,a);if(e&&!t.endsWith(e.queryName))throw d(e.toString(),i)}return o};t.wrapSingleQueryWithSuggestion=g;const f=(e,t,a)=>(i,...r)=>{const o=e(i,...r),[{suggest:l=(0,s.getConfig)().throwSuggestions}={}]=r.slice(-1);if(o.length&&l){const e=[...new Set(o.map((e=>{var t;return null==(t=(0,n.getSuggestedQuery)(e,a))?void 0:t.toString()})))];if(1===e.length&&!t.endsWith((0,n.getSuggestedQuery)(o[0],a).queryName))throw d(e[0],i)}return o};t.wrapAllByQueryWithSuggestion=f},,,function(e,t,a){"use strict";a.d(t,"j",(function(){return n})),a.d(t,"i",(function(){return i})),a.d(t,"h",(function(){return r})),a.d(t,"g",(function(){return s})),a.d(t,"f",(function(){return o})),a.d(t,"e",(function(){return l})),a.d(t,"d",(function(){return c})),a.d(t,"c",(function(){return u})),a.d(t,"b",(function(){return d})),a.d(t,"a",(function(){return p}));const n=e=>"UninitialisedResourceState"===e.type,i=e=>"LoadingResourceState"===e.type,r=e=>"LoadedResourceState"===e.type,s=e=>"FailedResourceState"===e.type,o=e=>r(e)?e:i(e)&&void 0!==e.previousState?o(e.previousState):s(e)?e.lastLoadedState:void 0,l=()=>({type:"UninitialisedResourceState"}),c=e=>({type:"LoadingResourceState",previousState:e}),u=e=>({type:"LoadedResourceState",data:e}),d=(e,t)=>({type:"FailedResourceState",error:e,lastLoadedState:t}),p=e=>{switch(e.type){case"LoadedResourceState":case"FailedResourceState":return e;case"UninitialisedResourceState":case"LoadingResourceState":return l()}}},,,,,,,,,,,function(e,t,a){e.exports=a(24)(387)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.configure=function(e){"function"==typeof e&&(e=e(i)),i={...i,...e}},t.getConfig=function(){return i},t.runWithExpensiveErrorDiagnosticsDisabled=function(e){try{return i._disableExpensiveErrorDiagnostics=!0,e()}finally{i._disableExpensiveErrorDiagnostics=!1}};var n=a(482);let i={testIdAttribute:"data-testid",asyncUtilTimeout:1e3,asyncWrapper:e=>e(),unstable_advanceTimersWrapper:e=>e(),eventWrapper:e=>e(),defaultHidden:!1,showOriginalStackTrace:!1,throwSuggestions:!1,getElementError(e,t){const a=(0,n.prettyDOM)(t),i=new Error([e,`Ignored nodes: comments, <script />, <style />\n${a}`].filter(Boolean).join("\n\n"));return i.name="TestingLibraryElementError",i},_disableExpensiveErrorDiagnostics:!1,computedStyleSupportsPseudoElements:!1}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(484);Object.keys(n).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===n[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}}))}));var i=a(579);Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===i[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}}))}));var r=a(304);Object.keys(r).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===r[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}}))}));var s=a(319);Object.keys(s).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===s[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}}))}))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return u}));var n=a(5),i=a.n(n),r=a(228),s=a(194),o=a(13),l=a(381);const c=({browserFields:e,columnId:t,data:a,ecsData:n,eventId:r,globalFilters:s,header:o,isDetails:c,isDraggable:u,isExpandable:d,isExpanded:p,linkValues:m,rowIndex:g,colIndex:f,rowRenderers:b,setCellProps:h,timelineId:y,truncate:E})=>i.a.createElement(l.a,{browserFields:e,columnId:t,data:a,ecsData:n,eventId:r,globalFilters:s,header:o,isDetails:c,isDraggable:u,isExpandable:d,isExpanded:p,linkValues:m,rowIndex:g,colIndex:f,rowRenderers:b,setCellProps:h,timelineId:y,truncate:E}),u=({setFlyoutAlert:e})=>{const{browserFields:t}=Object(s.d)(o.SourcererScopeName.detections);return({columnId:e,colIndex:a,data:n,ecsData:s,eventId:o,globalFilters:c,header:u,isDetails:d=!1,isDraggable:p=!1,isExpandable:m,isExpanded:g,linkValues:f,rowIndex:b,rowRenderers:h,setCellProps:y,truncate:E=!0})=>{const v=e.split(".");let T=null!=u?u:{id:e};if(v.length>1&&t[v[0]]){var k,x;const a=null!==(k=(null!==(x=t[v[0]].fields)&&void 0!==x?x:{})[e])&&void 0!==k?k:{};T={...T,...a}}else if(1===v.length){var S,O;const a=null!==(S=(null!==(O=t.base.fields)&&void 0!==O?O:{})[e])&&void 0!==S?S:{};T={...T,...a}}return i.a.createElement(l.a,{browserFields:t,columnId:e,data:n,ecsData:s,eventId:o,globalFilters:c,header:T,isDetails:d,isDraggable:p,isExpandable:m,isExpanded:g,linkValues:f,rowIndex:b,colIndex:a,rowRenderers:h,setCellProps:y,timelineId:r.b.casePage,truncate:E})}}},function(e,t,a){const{MAX_LENGTH:n}=a(459),{re:i,t:r}=a(377),s=a(243),o=a(460);e.exports=(e,t)=>{if(t=o(t),e instanceof s)return e;if("string"!=typeof e)return null;if(e.length>n)return null;if(!(t.loose?i[r.LOOSE]:i[r.FULL]).test(e))return null;try{return new s(e,t)}catch(e){return null}}},function(e,t,a){const n=a(264);e.exports=(e,t,a)=>n(e,t,a)>=0},function(e,t,a){e.exports=a(24)(446)},function(e,t){(function(t){e.exports=t}).call(this,{})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return l}));var n=a(95),i=a.n(n),r=a(51),s=a.n(r);const o=(e,t)=>null!=t&&!(e.id===t.endpoint.id&&t.agent.configured.id===t.agent.applied.id&&e.version>=t.agent.applied.revision&&e.version>=t.agent.configured.revision&&e.endpoint_policy_version>=t.endpoint.revision),l=({startDate:e,endDate:t})=>{const a=s()(i.a.parse(e)),n=s()(i.a.parse(t));return!(!a.isValid()||!n.isValid())&&a.isAfter(n)}},,,,,,function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return g})),a.d(t,"a",(function(){return d}));var n=a(311),i=a(357),r=a(378),s=a(434);const o=e=>{const t={coreStart:e};return e=>a=>async o=>{a(o),(async({coreStart:e},{dispatch:t,getState:a},o)=>{const l=e.http,c=a();if("userChangedUrl"===o.type&&Object(i.h)(c)&&Object(i.f)(c)){const e=Object(i.l)(c);let a;try{a=(await Object(r.f)(l,e)).item,""===a.inputs[0].config.policy.value.windows.popup.malware.message&&(a.inputs[0].config.policy.value.windows.popup.malware.message=n.a,a.inputs[0].config.policy.value.mac.popup.malware.message=n.a,a.inputs[0].config.policy.value.linux.popup.malware.message=n.a),""===a.inputs[0].config.policy.value.windows.popup.ransomware.message&&(a.inputs[0].config.policy.value.windows.popup.ransomware.message=n.a),""===a.inputs[0].config.policy.value.windows.popup.memory_protection.message&&(a.inputs[0].config.policy.value.windows.popup.memory_protection.message=n.b),""===a.inputs[0].config.policy.value.mac.popup.memory_protection.message&&(a.inputs[0].config.policy.value.mac.popup.memory_protection.message=n.b),""===a.inputs[0].config.policy.value.linux.popup.memory_protection.message&&(a.inputs[0].config.policy.value.linux.popup.memory_protection.message=n.b),""===a.inputs[0].config.policy.value.windows.popup.behavior_protection.message&&(a.inputs[0].config.policy.value.windows.popup.behavior_protection.message=n.b),""===a.inputs[0].config.policy.value.mac.popup.behavior_protection.message&&(a.inputs[0].config.policy.value.mac.popup.behavior_protection.message=n.b),""===a.inputs[0].config.policy.value.linux.popup.behavior_protection.message&&(a.inputs[0].config.policy.value.linux.popup.behavior_protection.message=n.b)}catch(e){return void t({type:"serverFailedToReturnPolicyDetailsData",payload:e.body||e})}if(t({type:"serverReturnedPolicyDetailsData",payload:{policyItem:a}}),a.policy_id){const{results:e}=await Object(r.d)(l,a.policy_id);t({type:"serverReturnedPolicyDetailsAgentSummaryData",payload:{agentStatusSummary:e}})}}else if("userClickedPolicyDetailsSaveButton"===o.type){const{id:e}=Object(i.j)(c),a=Object(i.k)(c);let n;try{n=await Object(r.g)(l,e,a).catch((t=>t.response&&409===t.response.status?Object(r.f)(l,e).then((t=>{const n=t.item;return n.inputs[0].config.policy=a.inputs[0].config.policy,Object(r.g)(l,e,Object(s.a)(n))})):Promise.reject(t)))}catch(e){return void t({type:"serverReturnedPolicyDetailsUpdateFailure",payload:{success:!1,error:e.body||e}})}t({type:"serverReturnedUpdatedPolicyDetailsData",payload:{policyItem:n.item,updateStatus:{success:!0}}})}})(t,e,o)}};var l=a(337),c=a(206),u=a(199);const d=()=>({policyItem:void 0,isLoading:!1,agentStatusSummary:{error:0,events:0,offline:0,online:0,total:0,other:0},artifacts:{location:{page:u.b,pageSize:u.c,show:void 0,filter:""}}}),p=(e,t)=>({...e,inputs:e.inputs.map((e=>({...e,config:e.config&&{...e.config,policy:{...e.config.policy,value:t}}})))}),m=(e=d(),t)=>{if("serverReturnedPolicyDetailsData"===t.type||"serverReturnedUpdatedPolicyDetailsData"===t.type)return{...e,...t.payload,isLoading:!1};if("serverFailedToReturnPolicyDetailsData"===t.type)return{...e,isLoading:!1,apiError:t.payload};if("serverReturnedPolicyDetailsAgentSummaryData"===t.type)return{...e,...t.payload};if("serverReturnedPolicyDetailsUpdateFailure"===t.type)return{...e,isLoading:!1,updateStatus:t.payload};if("userClickedPolicyDetailsSaveButton"===t.type)return{...e,isLoading:!0,updateApiError:void 0};if("licenseChanged"===t.type)return{...e,license:t.payload};if("userChangedUrl"===t.type){const a={...e,location:t.payload,artifacts:{...e.artifacts,location:Object(c.b)(Object(l.parse)(t.payload.search.slice(1)))}},n=Object(i.f)(a),r=Object(i.f)(e),s=Object(i.g)(a);return n?r?a:{...a,isLoading:!0}:{...d(),location:t.payload,license:s}}if("userChangedPolicyConfig"===t.type){if(!e.policyItem)return e;const a={...e,policyItem:{...e.policyItem}},n={...Object(i.c)(e)};return a.policyItem.inputs[0].config.policy.value=n,Object.entries(t.payload.policyConfig).forEach((([e,t])=>{n[e]={...n[e],...t}})),a}if("userChangedAntivirusRegistration"===t.type){if(e.policyItem){const a=Object(i.c)(e);return{...e,policyItem:p(e.policyItem,{...a,windows:{...a.windows,antivirus_registration:{enabled:t.payload.enabled}}})}}return e}return e},g=(e=d(),t)=>[m].reduce(((e,a)=>a(e,t)),e)},function(e,t,a){"use strict";a.d(t,"a",(function(){return m})),a.d(t,"b",(function(){return g})),a.d(t,"c",(function(){return f}));var n=a(6),i=a(293),r=a(18),s=a(19),o=a(166);const l=e=>"parsing_exception"===e||"verification_exception"===e||"mapping_exception"===e,c=e=>Object(n.has)(e,"error.type"),u=e=>e.error.root_cause.filter((e=>l(e.type))).map((e=>e.reason));var d=a(280);let p;!function(e){e.FAILED_REQUEST="ERR_FAILED_REQUEST",e.INVALID_EQL="ERR_INVALID_EQL"}(p||(p={}));const m=(e,t)=>{let a,n=[];return(...i)=>(a&&clearTimeout(a),a=setTimeout((()=>{const t=e(...i);n.forEach((e=>e(t))),n=[]}),t),new Promise((e=>n.push(e))))},g=async(...e)=>{const[{value:t,formData:a}]=e,{query:m}=t,g=m.query,{index:f,ruleType:b}=a;if(void 0===b&&!Object(n.isEmpty)(g)||Object(i.b)(b)&&!Object(n.isEmpty)(g))try{const{data:e}=r.b.get(),t=(new AbortController).signal,a=await(async({data:e,index:t,query:a,signal:i})=>{const{rawResponse:r}=await Object(s.firstValueFrom)(e.search.search({params:{index:t.join(),body:{query:a,size:0}},options:{ignore:[400]}},{strategy:o.EQL_SEARCH_STRATEGY,abortSignal:i}));if((e=>c(e)&&l(Object(n.get)(e,"error.type")))(r.body))return{valid:!1,errors:u(r.body)};if(c(r.body))throw new Error(JSON.stringify(r.body));return{valid:!0,errors:[]}})({data:e,query:g,signal:t,index:f});if(!1===(null==a?void 0:a.valid))return{code:p.INVALID_EQL,message:"",messages:a.errors}}catch(e){return{code:p.FAILED_REQUEST,message:d.m,error:e}}},f=e=>{const t=e.errors.length>0,a=!e.isChangingValue&&!t;if(t){const[t]=e.errors,n=t.message;return t.code===p.INVALID_EQL?{isValid:a,message:n,messages:t.messages}:{isValid:a,message:n,error:t.error}}return{isValid:a,message:""}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){const n=a(264);e.exports=(e,t,a)=>n(e,t,a)>0},function(e,t,a){const n=Symbol("SemVer ANY");class Comparator{static get ANY(){return n}constructor(e,t){if(t=i(t),e instanceof Comparator){if(e.loose===!!t.loose)return e;e=e.value}l("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===n?this.value="":this.value=this.operator+this.semver.version,l("comp",this)}parse(e){const t=this.options.loose?r[s.COMPARATORLOOSE]:r[s.COMPARATOR],a=e.match(t);if(!a)throw new TypeError(`Invalid comparator: ${e}`);this.operator=void 0!==a[1]?a[1]:"","="===this.operator&&(this.operator=""),a[2]?this.semver=new c(a[2],this.options.loose):this.semver=n}toString(){return this.value}test(e){if(l("Comparator.test",e,this.options.loose),this.semver===n||e===n)return!0;if("string"==typeof e)try{e=new c(e,this.options)}catch(e){return!1}return o(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof Comparator))throw new TypeError("a Comparator is required");if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),""===this.operator)return""===this.value||new u(e.value,t).test(this.value);if(""===e.operator)return""===e.value||new u(this.value,t).test(e.semver);const a=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),n=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),i=this.semver.version===e.semver.version,r=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),s=o(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),l=o(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return a||n||i&&r||s||l}}e.exports=Comparator;const i=a(460),{re:r,t:s}=a(377),o=a(772),l=a(458),c=a(243),u=a(279)},function(e,t,a){const n=a(279);e.exports=(e,t,a)=>{try{t=new n(t,a)}catch(e){return!1}return t.test(e)}},function(e,t,a){"use strict";e.exports=o;var n=a(1093),i=n.CONTINUE,r=n.SKIP,s=n.EXIT;function o(e,t,a,i){"function"==typeof t&&"function"!=typeof a&&(i=a,a=t,t=null),n(e,t,(function(e,t){var n=t[t.length-1],i=n?n.children.indexOf(e):null;return a(e,i,n)}),i)}o.CONTINUE=i,o.SKIP=r,o.EXIT=s},function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(5),i=a.n(n),r=a(85),s=a.n(r),o=a(169),l=a(179),c=a(98);const u=Object(n.memo)((({dateRangeFrom:e,dateRangeTo:t,hideSavedQuery:a=!1,indexPattern:r,isLoading:u=!1,isRefreshPaused:d,filterQuery:p,filterManager:m,filters:g,onChangedQuery:f,onSubmitQuery:b,refreshInterval:h,savedQuery:y,onSavedQuery:E,dataTestSubj:v,displayStyle:T})=>{const k=Object(n.useCallback)((e=>{null==e.query||s()(e.query,p)||b(e.query)}),[p,b]),x=Object(n.useCallback)((e=>{f&&null!=e.query&&!s()(e.query,p)&&f(e.query)}),[p,f]),S=Object(n.useCallback)((e=>{const{query:t,filters:a,timefilter:n}=e.attributes;b(t,n),m.setFilters(a||[]),E(e)}),[m,b,E]),O=Object(n.useCallback)((()=>{null!=y&&(b({query:"",language:y.attributes.query.language}),m.setFilters([]),E(void 0))}),[m,b,E,y]),w=Object(n.useCallback)((e=>{m.setFilters(e)}),[m]),j=Object(n.useMemo)((()=>[r]),[r]);return i.a.createElement(l.SearchBar,{showSubmitButton:!1,dateRangeFrom:e,dateRangeTo:t,filters:g,indexPatterns:j,isLoading:u,isRefreshPaused:d,query:p,onClearSavedQuery:O,onFiltersUpdated:w,onQueryChange:x,onQuerySubmit:k,onSaved:E,onSavedQueryUpdated:S,refreshInterval:h,showAutoRefreshOnly:!1,showFilterBar:!a,showDatePicker:!1,showQueryBar:!0,showQueryInput:!0,showSaveQuery:!0,timeHistory:new o.TimeHistory(new c.Storage(localStorage)),dataTestSubj:v,savedQuery:y,displayStyle:T})}));u.displayName="QueryBar"},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(5),i=a(169),r=a(18);const s=()=>{const e=Object(r.j)(),{http:t}=e.services,[a,s]=Object(n.useState)(Object(i.createSavedQueryService)(t));return Object(n.useEffect)((()=>{s(Object(i.createSavedQueryService)(t))}),[t]),a}},function(e,t,a){"use strict";a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return d}));var n=a(5),i=a.n(n),r=a(16),s=a(498),o=a(302),l=a(18);let c;!function(e){e.overview="details",e.activityLog="activity_log"}(c||(c={}));const u=Object(n.memo)((({tab:e,isSelected:t})=>{const{getAppUrl:a}=Object(l.d)(),n=Object(o.a)(e.route);return i.a.createElement(r.EuiTab,{href:a({path:e.route}),onClick:n,isSelected:t,key:e.id,"data-test-subj":e.id},e.name)}));u.displayName="EndpointDetailsTab";const d=Object(n.memo)((({hostname:e,show:t,tabs:a})=>{const o=Object(n.useMemo)((()=>a.find((e=>e.id===t))),[a,t]),l=a.map((e=>i.a.createElement(u,{key:e.id,tab:e,isSelected:e.id===(null==o?void 0:o.id)})));return i.a.createElement(i.a.Fragment,null,i.a.createElement(s.a,{hostname:e,hasBorder:!0},i.a.createElement(r.EuiTabs,{bottomBorder:!1,style:{marginBottom:"-25px"}},l)),i.a.createElement(r.EuiFlyoutBody,{"data-test-subj":"endpointDetailsFlyoutBody"},null==o?void 0:o.content))}));d.displayName="EndpointDetailsFlyoutTabs"},function(e,t,a){"use strict";(function(e){var n=a(34);Object.defineProperty(t,"__esModule",{value:!0}),t.logDOM=void 0,t.prettyDOM=p,t.prettyFormat=void 0;var i=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var a=c(t);if(a&&a.has(e))return a.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if("default"!==r&&Object.prototype.hasOwnProperty.call(e,r)){var s=i?Object.getOwnPropertyDescriptor(e,r):null;s&&(s.get||s.set)?Object.defineProperty(n,r,s):n[r]=e[r]}return n.default=e,a&&a.set(e,n),n}(a(1146));t.prettyFormat=i;var r=n(a(1158)),s=a(1159),o=a(253),l=a(578);function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(c=function(e){return e?a:t})(e)}const{DOMCollection:u}=i.plugins;function d(e){return 8!==e.nodeType&&(1!==e.nodeType||!e.matches(l.DEFAULT_IGNORE_TAGS))}function p(t,a,n={}){if(t||(t=(0,o.getDocument)().body),"number"!=typeof a&&(a=void 0!==e&&Object({IS_KIBANA_DISTRIBUTABLE:"true"}).DEBUG_PRINT_LIMIT||7e3),0===a)return"";t.documentElement&&(t=t.documentElement);let s=typeof t;if("object"===s?s=t.constructor.name:t={},!("outerHTML"in t))throw new TypeError(`Expected an element or document but got ${s}`);const{filterNode:l=d,...c}=n,p=i.format(t,{plugins:[(0,r.default)(l),u],printFunctionName:!1,highlight:void 0!==e&&void 0!==e.versions&&void 0!==e.versions.node,...c});return void 0!==a&&t.outerHTML.length>a?`${p.slice(0,a)}...`:p}t.logDOM=(...e)=>{const t=(0,s.getUserCodeFrame)();t?console.log(`${p(...e)}\n\n${t}`):console.log(p(...e))}}).call(this,a(359))},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.printIteratorEntries=function(e,t,a,n,i,r,s=": "){let o="",l=e.next();if(!l.done){o+=t.spacingOuter;const c=a+t.indent;for(;!l.done;){o+=c+r(l.value[0],t,c,n,i)+s+r(l.value[1],t,c,n,i),l=e.next(),l.done?t.min||(o+=","):o+=","+t.spacingInner}o+=t.spacingOuter+a}return o},t.printIteratorValues=function(e,t,a,n,i,r){let s="",o=e.next();if(!o.done){s+=t.spacingOuter;const l=a+t.indent;for(;!o.done;)s+=l+r(o.value,t,l,n,i),o=e.next(),o.done?t.min||(s+=","):s+=","+t.spacingInner;s+=t.spacingOuter+a}return s},t.printListItems=function(e,t,a,n,i,r){let s="";if(e.length){s+=t.spacingOuter;const o=a+t.indent;for(let a=0;a<e.length;a++)s+=o,a in e&&(s+=r(e[a],t,o,n,i)),a<e.length-1?s+=","+t.spacingInner:t.min||(s+=",");s+=t.spacingOuter+a}return s},t.printObjectProperties=function(e,t,a,n,i,r){let s="";const o=((e,t)=>{const a=Object.keys(e).sort(t);return Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(e).forEach((t=>{Object.getOwnPropertyDescriptor(e,t).enumerable&&a.push(t)})),a})(e,t.compareKeys);if(o.length){s+=t.spacingOuter;const l=a+t.indent;for(let a=0;a<o.length;a++){const c=o[a];s+=l+r(c,t,l,n,i)+": "+r(e[c],t,l,n,i),a<o.length-1?s+=","+t.spacingInner:t.min||(s+=",")}s+=t.spacingOuter+a}return s}},function(e,t,a){"use strict";function n(e){if(null==e)throw new Error(`It looks like ${e} was passed instead of a matcher. Did you do something like getByText(${e})?`)}function i({trim:e=!0,collapseWhitespace:t=!0}={}){return a=>{let n=a;return n=e?n.trim():n,n=t?n.replace(/\s+/g," "):n,n}}function r(e,t){const a=e.test(t);return e.global&&0!==e.lastIndex&&(console.warn("To match all elements we had to reset the lastIndex of the RegExp because the global flag is enabled. We encourage to remove the global flag from the RegExp."),e.lastIndex=0),a}Object.defineProperty(t,"__esModule",{value:!0}),t.fuzzyMatches=function(e,t,a,i){if("string"!=typeof e)return!1;n(a);const s=i(e);return"string"==typeof a||"number"==typeof a?s.toLowerCase().includes(a.toString().toLowerCase()):"function"==typeof a?a(s,t):r(a,s)},t.getDefaultNormalizer=i,t.makeNormalizer=function({trim:e,collapseWhitespace:t,normalizer:a}){if(!a)return i({trim:e,collapseWhitespace:t});if(void 0!==e||void 0!==t)throw new Error('trim and collapseWhitespace are not supported with a normalizer. If you want to use the default trim and collapseWhitespace logic in your normalizer, use "getDefaultNormalizer({trim, collapseWhitespace})" and compose that into your normalizer');return a},t.matches=function(e,t,a,i){if("string"!=typeof e)return!1;n(a);const s=i(e);return a instanceof Function?a(s,t):a instanceof RegExp?r(a,s):s===String(a)}},,,,,,,,,,,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(5),i=a.n(n),r=a(16),s=a(240),o=a(226),l=a(4),c=a(206),u=a(302),d=a(91);const p=Object(n.memo)((({endpointId:e})=>{var t;const{getAppUrl:a}=Object(d.b)(),{show:p,...m}=Object(s.b)(o.uiQueryParams),g=Object(n.useMemo)((()=>Object(c.d)({name:"endpointDetails",...m,selected_endpoint:e})),[m,e]),f=Object(u.a)(g),b=Object(n.useMemo)((()=>({title:l.i18n.translate("xpack.securitySolution.endpoint.policyResponse.backLinkTitle",{defaultMessage:"Endpoint details"}),href:a({path:g}),onClick:f})),[f,a,g]);return i.a.createElement("div",null,i.a.createElement(r.EuiButtonEmpty,{flush:"both","data-test-subj":"flyoutSubHeaderBackButton",iconType:"arrowLeft",size:"xs",href:null!==(t=null==b?void 0:b.href)&&void 0!==t?t:"",onClick:null==b?void 0:b.onClick},null==b?void 0:b.title))}));p.displayName="BackToEndpointDetailsFlyoutSubHeader";const m=Object(n.memo)((({endpointId:e,hasBorder:t=!1,hostname:a,children:n})=>{const l=Object(s.b)(o.detailsLoading);return i.a.createElement(r.EuiFlyoutHeader,{hasBorder:t},e&&i.a.createElement(p,{endpointId:e}),l?i.a.createElement(r.EuiLoadingContent,{lines:1}):i.a.createElement(r.EuiToolTip,{content:a,anchorClassName:"eui-textTruncate"},i.a.createElement(r.EuiTitle,{size:"s"},i.a.createElement("h2",{style:{overflow:"hidden",textOverflow:"ellipsis"},"data-test-subj":"endpointDetailsFlyoutTitle"},a))),n)}));m.displayName="EndpointDetailsFlyoutHeader"},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){"use strict";var n=a(412);a.d(t,"b",(function(){return n.a}));var i=a(383);a.d(t,"a",(function(){return i.a}))},function(e,t,a){const n=a(264);e.exports=(e,t,a)=>0===n(e,t,a)},function(e,t,a){const n=a(243);e.exports=(e,t,a)=>{const i=new n(e,a),r=new n(t,a);return i.compare(r)||i.compareBuild(r)}},function(e,t,a){const n=a(264);e.exports=(e,t,a)=>n(e,t,a)<0},function(e,t,a){const n=a(243),i=a(476),{ANY:r}=i,s=a(279),o=a(477),l=a(475),c=a(567),u=a(411),d=a(385);e.exports=(e,t,a,p)=>{let m,g,f,b,h;switch(e=new n(e,p),t=new s(t,p),a){case">":m=l,g=u,f=c,b=">",h=">=";break;case"<":m=c,g=d,f=l,b="<",h="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(o(e,t,p))return!1;for(let a=0;a<t.set.length;++a){const n=t.set[a];let s=null,o=null;if(n.forEach((e=>{e.semver===r&&(e=new i(">=0.0.0")),s=s||e,o=o||e,m(e.semver,s.semver,p)?s=e:f(e.semver,o.semver,p)&&(o=e)})),s.operator===b||s.operator===h)return!1;if((!o.operator||o.operator===b)&&g(e,o.semver))return!1;if(o.operator===h&&f(e,o.semver))return!1}return!0}},function(e,t,a){"use strict";var n=a(1082),i=a(1083),r=a(570),s=a(1084),o=a(1085),l=a(1086);e.exports=function(e,t){var a,r,s={};for(r in t||(t={}),p)a=t[r],s[r]=null==a?p[r]:a;return(s.position.indent||s.position.start)&&(s.indent=s.position.indent||[],s.position=s.position.start),function(e,t){var a,r,s,p,v,T,k,x,S,O,w,j,C,I,M,A,D,q,P,R,_=t.additional,F=t.nonTerminated,L=t.text,N=t.reference,B=t.warning,z=t.textContext,U=t.referenceContext,H=t.warningContext,$=t.position,V=t.indent||[],Q=e.length,W=0,G=-1,K=$.column||1,Y=$.line||1,J="",X=[];for(A=Z(),x=B?function(e,t){var a=Z();a.column+=t,a.offset+=t,B.call(H,y[e],a,e)}:d,W--,Q++;++W<Q;)if("\n"===v&&(K=V[G]||1),"&"!==(v=ee(W)))"\n"===v&&(Y++,G++,K=0),v?(J+=v,K++):te();else{if("\t"===(k=ee(W+1))||"\n"===k||"\f"===k||" "===k||"<"===k||"&"===k||""===k||_&&k===_){J+=v,K++;continue}for(j=C=W+1,P=C,"#"!==k?I=m:"x"===(k=ee(P=++j))||"X"===k?(I=g,P=++j):I=f,a="",w="",p="",M=h[I],P--;++P<Q&&M(k=ee(P));)p+=k,I===m&&c.call(n,p)&&(a=p,w=n[p]);(s=";"===ee(P))&&(P++,(r=I===m&&l(p))&&(a=p,w=r)),q=1+P-C,(s||F)&&(p?I===m?(s&&!w?x(5,1):(a!==p&&(q=1+(P=j+a.length)-j,s=!1),s||(S=a?1:3,t.attribute?"="===(k=ee(P))?(x(S,q),w=null):o(k)?w=null:x(S,q):x(S,q))),T=w):(s||x(2,q),(R=T=parseInt(p,b[I]))>=55296&&R<=57343||R>1114111?(x(7,q),T="ï¿½"):T in i?(x(6,q),T=i[T]):(O="",E(T)&&x(6,q),T>65535&&(O+=u((T-=65536)>>>10|55296),T=56320|1023&T),T=O+u(T))):I!==m&&x(4,q)),T?(te(),A=Z(),W=P-1,K+=P-C+1,X.push(T),(D=Z()).offset++,N&&N.call(U,T,{start:A,end:D},e.slice(C-1,P)),A=D):(p=e.slice(C-1,P),J+=p,K+=p.length,W=P-1)}return X.join("");function Z(){return{line:Y,column:K,offset:W+($.offset||0)}}function ee(t){return e.charAt(t)}function te(){J&&(X.push(J),L&&L.call(z,J,{start:A,end:Z()}),J="")}}(e,s)};var c={}.hasOwnProperty,u=String.fromCharCode,d=Function.prototype,p={warning:null,reference:null,text:null,warningContext:null,referenceContext:null,textContext:null,position:{},additional:null,attribute:!1,nonTerminated:!0},m="named",g="hexadecimal",f="decimal",b={hexadecimal:16,decimal:10},h={};h.named=o,h.decimal=r,h.hexadecimal=s;var y={};function E(e){return e>=1&&e<=8||11===e||e>=13&&e<=31||e>=127&&e<=159||e>=64976&&e<=65007||65535==(65535&e)||65534==(65535&e)}y[1]="Named character references must be terminated by a semicolon",y[2]="Numeric character references must be terminated by a semicolon",y[3]="Named character references cannot be empty",y[4]="Numeric character references cannot be empty",y[5]="Named character references must be known",y[6]="Numeric character references cannot be disallowed",y[7]="Numeric character references cannot be outside the permissible Unicode range"},function(e,t,a){e.exports=a(24)(443)},function(e,t,a){e.exports=a(24)(1071)},function(e,t,a){e.exports=a(24)(1508)},function(e,t,a){"use strict";e.exports=function(e,t,a,n){for(var i,r,s,o,l,c,u=["pedantic","commonmark"],d=u.length,p=e.length,m=-1;++m<p;){for(r=(i=e[m])[1]||{},s=i[0],o=-1,c=!1;++o<d;)if(void 0!==r[l=u[o]]&&r[l]!==a.options[l]){c=!0;break}if(!c&&t[s].apply(a,n))return!0}return!1}},function(e,t,a){"use strict";var n=a(1106);e.exports=function(e){return n(e).toLowerCase()}},function(e,t,a){"use strict";a.d(t,"a",(function(){return v})),a.d(t,"b",(function(){return T}));var n=a(3),i=a(5),r=a.n(i),s=a(42),o=a(19),l=a(85),c=a.n(l),u=a(39),d=a(194),p=a(13),m=a(231),g=a(480),f=a(479),b=a(207),h=a(84);const y="timeline-filter-drop-area",E=(e=[])=>e.filter((e=>e.meta.controlledBy!==y)),v=Object(i.memo)((({dataProviders:e,filters:t,filterManager:a,filterQuery:n,from:l,fromStr:u,kqlMode:v,isRefreshPaused:k,savedQueryId:x,setFilters:S,setSavedQueryId:O,refreshInterval:w,timelineId:j,to:C,toStr:I,updateReduxTime:M})=>{const A=Object(s.useDispatch)(),[D,q]=Object(i.useState)(null!=u?u:new Date(l).toISOString()),[P,R]=Object(i.useState)(null!=I?I:new Date(C).toISOString()),{browserFields:_,indexPattern:F}=Object(d.d)(p.SourcererScopeName.timeline),[L,N]=Object(i.useState)(void 0),[B,z]=Object(i.useState)({query:null!=n?n.expression:"",language:null!=n?n.kind:"kuery"}),[U,H]=Object(i.useState)(E(t)),[$,V]=Object(i.useState)(Object(m.a)(Object(b.g)(e,_),F)),Q=Object(g.a)(),W=Object(i.useCallback)(((e,t)=>A(h.a.applyKqlFilterQuery({id:j,filterQuery:{kuery:{kind:t,expression:e},serializedQuery:Object(m.a)(e,F)}}))),[A,F,j]);Object(i.useEffect)((()=>{let e=!0;const n=new o.Subscription;return a.setFilters(t),n.add(a.getUpdates$().subscribe({next:()=>{if(e){const e=E(a.getFilters());S(e),H(e)}}})),()=>{e=!1,n.unsubscribe()}}),[]),Object(i.useEffect)((()=>{const e=E(a.getFilters());c()(t,e)||a.setFilters(t)}),[t]),Object(i.useEffect)((()=>{z({query:null!=n?n.expression:"",language:null!=n?n.kind:"kuery"})}),[n]),Object(i.useEffect)((()=>{V(Object(m.a)(Object(b.g)(e,_),F))}),[e,_,F]),Object(i.useEffect)((()=>{null!=u&&null!=I?(q(u),R(I)):null!=l&&null!=C&&(q(new Date(l).toISOString()),R(new Date(C).toISOString()))}),[l,u,C,I]),Object(i.useEffect)((()=>{let e=!0;return async function(){if(null!=x&&null!=Q)try{const a=await Q.getSavedQuery(x);e&&null!=a&&N({...a,attributes:{...a.attributes,filters:E(t)}})}catch(e){N(void 0)}else e&&N(void 0)}(),()=>{e=!1}}),[x]);const G=Object(i.useCallback)(((e,t)=>{if((null==n||null!=n&&n.expression!==e.query||n.kind!==e.language)&&W(e.query,e.language),null!=t){const e=t.from.includes("now")||t.to.includes("now");M({id:"timeline",end:t.to,start:t.from,isInvalid:!1,isQuickSelection:e,timelineId:j})}}),[n,j]),K=Object(i.useCallback)((e=>{if(null!=e){if(e.id!==x&&O(e.id),null!=Q&&""!==$){const t=null!=e.attributes.filters?e.attributes.filters.findIndex((e=>e.meta.controlledBy===y)):-1;Q.updateQuery(e.id,{...e.attributes,filters:null!=e.attributes.filters?t>-1?[...e.attributes.filters.slice(0,t),T($),...e.attributes.filters.slice(t+1)]:[...e.attributes.filters,T($)]:[]})}}else O(null)}),[$,x,Q]);return r.a.createElement(f.a,{dateRangeFrom:D,dateRangeTo:P,hideSavedQuery:"search"===v,indexPattern:F,isRefreshPaused:k,filterQuery:B,filterManager:a,filters:U,onSubmitQuery:G,refreshInterval:w,savedQuery:L,onSavedQuery:K,dataTestSubj:"timelineQueryInput",displayStyle:"inPage"})})),T=e=>{const t=JSON.parse(e),a=Object.keys(t);return{...t,meta:{alias:y,controlledBy:y,negate:!1,disabled:!1,type:"custom",key:Object(n.isEmpty)(a)?"bool":a[0],value:e},$state:{store:u.b.APP_STATE}}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(1145);Object.keys(n).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===n[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}}))}));var i=a(1305);Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===i[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}}))}));var r=a(1306);Object.keys(r).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===r[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}}))}));var s=a(1307);Object.keys(s).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===s[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}}))}));var o=a(1308);Object.keys(o).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===o[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}}))}));var l=a(1309);Object.keys(l).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===l[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return l[e]}}))}));var c=a(1310);Object.keys(c).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===c[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return c[e]}}))}));var u=a(1311);Object.keys(u).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===u[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return u[e]}}))}))},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.printText=t.printProps=t.printElementAsLeaf=t.printElement=t.printComment=t.printChildren=void 0;var n,i=(n=a(1152))&&n.__esModule?n:{default:n};t.printProps=(e,t,a,n,i,r,s)=>{const o=n+a.indent,l=a.colors;return e.map((e=>{const c=t[e];let u=s(c,a,o,i,r);return"string"!=typeof c&&(-1!==u.indexOf("\n")&&(u=a.spacingOuter+o+u+a.spacingOuter+n),u="{"+u+"}"),a.spacingInner+n+l.prop.open+e+l.prop.close+"="+l.value.open+u+l.value.close})).join("")},t.printChildren=(e,t,a,n,i,s)=>e.map((e=>t.spacingOuter+a+("string"==typeof e?r(e,t):s(e,t,a,n,i)))).join("");const r=(e,t)=>{const a=t.colors.content;return a.open+(0,i.default)(e)+a.close};t.printText=r,t.printComment=(e,t)=>{const a=t.colors.comment;return a.open+"\x3c!--"+(0,i.default)(e)+"--\x3e"+a.close},t.printElement=(e,t,a,n,i)=>{const r=n.colors.tag;return r.open+"<"+e+(t&&r.close+t+n.spacingOuter+i+r.open)+(a?">"+r.close+a+n.spacingOuter+i+r.open+"</"+e:(t&&!n.min?"":" ")+"/")+">"+r.close},t.printElementAsLeaf=(e,t)=>{const a=t.colors.tag;return a.open+"<"+e+a.close+" â¦"+a.open+" />"+a.close}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_IGNORE_TAGS=void 0,t.DEFAULT_IGNORE_TAGS="script, style"},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNodeText=function(e){return e.matches("input[type=submit], input[type=button], input[type=reset]")?e.value:Array.from(e.childNodes).filter((e=>e.nodeType===n.TEXT_NODE&&Boolean(e.textContent))).map((e=>e.textContent)).join("")};var n=a(253)},function(e,t,a){"use strict";t.__esModule=!0;var n={computeAccessibleDescription:!0,computeAccessibleName:!0,getRole:!0};t.getRole=t.computeAccessibleName=t.computeAccessibleDescription=void 0;var i=a(1160);t.computeAccessibleDescription=i.computeAccessibleDescription;var r=a(1163);t.computeAccessibleName=r.computeAccessibleName;var s,o=(s=a(786))&&s.__esModule?s:{default:s};t.getRole=o.default;var l=a(1164);Object.keys(l).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||e in t&&t[e]===l[e]||(t[e]=l[e]))}))},function(e,t,a){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}t.__esModule=!0,t.hasAnyConcreteRoles=function(e,t){return!!s(e)&&-1!==t.indexOf((0,i.default)(e))},t.isElement=s,t.isHTMLFieldSetElement=function(e){return s(e)&&"fieldset"===(0,i.getLocalName)(e)},t.isHTMLInputElement=function(e){return s(e)&&"input"===(0,i.getLocalName)(e)},t.isHTMLLegendElement=function(e){return s(e)&&"legend"===(0,i.getLocalName)(e)},t.isHTMLOptGroupElement=function(e){return s(e)&&"optgroup"===(0,i.getLocalName)(e)},t.isHTMLSelectElement=function(e){return s(e)&&"select"===(0,i.getLocalName)(e)},t.isHTMLSlotElement=function(e){return s(e)&&"slot"===(0,i.getLocalName)(e)},t.isHTMLTableCaptionElement=function(e){return s(e)&&"caption"===(0,i.getLocalName)(e)},t.isHTMLTableElement=function(e){return s(e)&&"table"===(0,i.getLocalName)(e)},t.isHTMLTextAreaElement=function(e){return s(e)&&"textarea"===(0,i.getLocalName)(e)},t.isSVGElement=o,t.isSVGSVGElement=function(e){return s(e)&&"svg"===(0,i.getLocalName)(e)},t.isSVGTitleElement=function(e){return o(e)&&"title"===(0,i.getLocalName)(e)},t.queryIdRefs=function(e,t){return s(e)&&e.hasAttribute(t)?e.getAttribute(t).split(" ").map((function(t){return e.ownerDocument.getElementById(t)})).filter((function(e){return null!==e})):[]},t.safeWindow=function(e){var t=(null===e.ownerDocument?e:e.ownerDocument).defaultView;if(null===t)throw new TypeError("no window available");return t};var i=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!=typeof e)return{default:e};var a=r(t);if(a&&a.has(e))return a.get(e);var i={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var l=s?Object.getOwnPropertyDescriptor(e,o):null;l&&(l.get||l.set)?Object.defineProperty(i,o,l):i[o]=e[o]}return i.default=e,a&&a.set(e,i),i}(a(786));function r(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(r=function(e){return e?a:t})(e)}function s(e){return null!==e&&e.nodeType===e.ELEMENT_NODE}function o(e){return s(e)&&void 0!==e.ownerSVGElement}t.getLocalName=i.getLocalName},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.computeAriaChecked=function(e){if(!("indeterminate"in e)||!e.indeterminate)return"checked"in e?e.checked:m(e,"aria-checked")},t.computeAriaCurrent=function(e){var t,a;return null!=(t=null!=(a=m(e,"aria-current"))?a:e.getAttribute("aria-current"))&&t},t.computeAriaExpanded=function(e){return m(e,"aria-expanded")},t.computeAriaPressed=function(e){return m(e,"aria-pressed")},t.computeAriaSelected=function(e){return"OPTION"===e.tagName?e.selected:m(e,"aria-selected")},t.computeHeadingLevel=function(e){return e.getAttribute("aria-level")&&Number(e.getAttribute("aria-level"))||{H1:1,H2:2,H3:3,H4:4,H5:5,H6:6}[e.tagName]},t.getImplicitAriaRoles=u,t.getRoles=d,t.isInaccessible=c,t.isSubtreeInaccessible=l,t.logRoles=void 0,t.prettyRoles=p;var n=a(787),i=a(580),r=a(482),s=a(319);const o=function(e){function t({attributes:e=[]}){return e.length}function a(e){return t=>{let{attributes:a=[]}=e;const n=a.findIndex((e=>e.value&&"type"===e.name&&"text"===e.value));return!(n>=0&&(a=[...a.slice(0,n),...a.slice(n+1)],"text"!==t.type))&&t.matches(function({name:e,attributes:t}){return`${e}${t.map((({name:e,value:t,constraints:a=[]})=>-1!==a.indexOf("undefined")?`:not([${e}])`:t?`[${e}="${t}"]`:`[${e}]`)).join("")}`}({...e,attributes:a}))}}let n=[];for(const[i,r]of e.entries())n=[...n,{match:a(i),roles:Array.from(r),specificity:t(i)}];return n.sort((function({specificity:e},{specificity:t}){return t-e}))}(n.elementRoles);function l(e){return!0===e.hidden||("true"===e.getAttribute("aria-hidden")||"none"===e.ownerDocument.defaultView.getComputedStyle(e).display)}function c(e,t={}){const{isSubtreeInaccessible:a=l}=t;if("hidden"===e.ownerDocument.defaultView.getComputedStyle(e).visibility)return!0;let n=e;for(;n;){if(a(n))return!0;n=n.parentElement}return!1}function u(e){for(const{match:t,roles:a}of o)if(t(e))return[...a];return[]}function d(e,{hidden:t=!1}={}){return function e(t){return[t,...Array.from(t.children).reduce(((t,a)=>[...t,...e(a)]),[])]}(e).filter((e=>!1!==t||!1===c(e))).reduce(((e,t)=>{let a=[];return a=t.hasAttribute("role")?t.getAttribute("role").split(" ").slice(0,1):u(t),a.reduce(((e,a)=>Array.isArray(e[a])?{...e,[a]:[...e[a],t]}:{...e,[a]:[t]}),e)}),{})}function p(e,{hidden:t}){const a=d(e,{hidden:t});return Object.entries(a).filter((([e])=>"generic"!==e)).map((([e,t])=>{const a="-".repeat(50);return`${e}:\n\n${t.map((e=>`Name "${(0,i.computeAccessibleName)(e,{computedStyleSupportsPseudoElements:(0,s.getConfig)().computedStyleSupportsPseudoElements})}":\n${(0,r.prettyDOM)(e.cloneNode(!1))}`)).join("\n\n")}\n\n${a}`})).join("\n")}function m(e,t){const a=e.getAttribute(t);return"true"===a||"false"!==a&&void 0}t.logRoles=(e,{hidden:t=!1}={})=>console.log(p(e,{hidden:t}))},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(a(1167)),i=s(a(1180)),r=s(a(1263));function s(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=c(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,o=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return s=e.done,e},e:function(e){o=!0,r=e},f:function(){try{s||null==a.return||a.return()}finally{if(o)throw r}}}}function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,i,r=[],s=!0,o=!1;try{for(a=a.call(e);!(s=(n=a.next()).done)&&(r.push(n.value),!t||r.length!==t);s=!0);}catch(e){o=!0,i=e}finally{try{s||null==a.return||a.return()}finally{if(o)throw i}}return r}}(e,t)||c(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){if(e){if("string"==typeof e)return u(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var d=[].concat(n.default,i.default,r.default);d.forEach((function(e){var t,a=l(e,2)[1],n=o(a.superClass);try{for(n.s();!(t=n.n()).done;){var i,r=o(t.value);try{var s=function(){var e,t,n,r=i.value,s=d.find((function(e){return l(e,1)[0]===r}));if(s)for(var o=s[1],c=0,u=Object.keys(o.props);c<u.length;c++){var p=u[c];Object.prototype.hasOwnProperty.call(a.props,p)||Object.assign(a.props,(e={},t=p,n=o.props[p],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e))}};for(r.s();!(i=r.n()).done;)s()}catch(e){r.e(e)}finally{r.f()}}}catch(e){n.e(e)}finally{n.f()}}));var p={entries:function(){return d},get:function(e){var t=d.find((function(t){return t[0]===e}));return t&&t[1]},has:function(e){return!!this.get(e)},keys:function(){return d.map((function(e){return l(e,1)[0]}))},values:function(){return d.map((function(e){return l(e,2)[1]}))}};t.default=p},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.waitFor=function(e,t){const a=new Error("STACK_TRACE_MESSAGE");return(0,i.getConfig)().asyncWrapper((()=>function(e,{container:t=(0,n.getDocument)(),timeout:a=(0,i.getConfig)().asyncUtilTimeout,showOriginalStackTrace:s=(0,i.getConfig)().showOriginalStackTrace,stackTraceError:o,interval:l=50,onTimeout:c=(e=>(e.message=(0,i.getConfig)().getElementError(e.message,t).message,e)),mutationObserverOptions:u={subtree:!0,childList:!0,attributes:!0,characterData:!0}}){if("function"!=typeof e)throw new TypeError("Received `callback` arg must be a function");return new Promise((async(d,p)=>{let m,g,f,b=!1,h="idle";const y=setTimeout((function(){let e;m?(e=m,s||"TestingLibraryElementError"!==e.name||r(e,o)):(e=new Error("Timed out in waitFor."),s||r(e,o)),v(c(e),null)}),a),E=(0,n.jestFakeTimersAreEnabled)();if(E){const{unstable_advanceTimersWrapper:e}=(0,i.getConfig)();for(k();!b;){if(!(0,n.jestFakeTimersAreEnabled)()){const e=new Error("Changed from using fake timers to real timers while using waitFor. This is not allowed and will result in very strange behavior. Please ensure you're awaiting all async things your test is doing before changing to real timers. For more info, please go to https://github.com/testing-library/dom-testing-library/issues/830");return s||r(e,o),void p(e)}if(e((()=>{jest.advanceTimersByTime(l)})),k(),b)break;await e((async()=>{await new Promise((e=>{setTimeout(e,0),jest.advanceTimersByTime(0)}))}))}}else{try{(0,n.checkContainerType)(t)}catch(e){return void p(e)}g=setInterval(T,l);const{MutationObserver:e}=(0,n.getWindowFromNode)(t);f=new e(T),f.observe(t,u),k()}function v(e,t){b=!0,clearTimeout(y),E||(clearInterval(g),f.disconnect()),e?p(e):d(t)}function T(){if((0,n.jestFakeTimersAreEnabled)()){const e=new Error("Changed from using real timers to fake timers while using waitFor. This is not allowed and will result in very strange behavior. Please ensure you're awaiting all async things your test is doing before changing to fake timers. For more info, please go to https://github.com/testing-library/dom-testing-library/issues/830");return s||r(e,o),p(e)}return k()}function k(){if("pending"!==h)try{const t=(0,i.runWithExpensiveErrorDiagnosticsDisabled)(e);"function"==typeof(null==t?void 0:t.then)?(h="pending",t.then((e=>{h="resolved",v(null,e)}),(e=>{h="rejected",m=e}))):v(null,t)}catch(e){m=e}}}))}(e,{stackTraceError:a,...t})))};var n=a(253),i=a(319);function r(e,t){e.stack=t.stack.replace(t.message,e.message)}},function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(5),i=a.n(n),r=a(42),s=a(76);const o=Object(n.memo)((({children:e})=>{const t=Object(r.useDispatch)();return Object(n.useEffect)((()=>{var e;const a=null===(e=s.a.getLicenseInformation$())||void 0===e?void 0:e.subscribe((e=>{t({type:"licenseChanged",payload:e})}));return()=>null==a?void 0:a.unsubscribe()}),[t]),i.a.createElement(i.a.Fragment,null,e)}));o.displayName="CurrentLicense"},,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return S}));var n=a(5),i=a.n(n),r=a(23),s=a.n(r),o=a(16),l=a(192),c=a(280),u=a(6);const d=({ariaLabel:e,errors:t})=>{const[a,r]=Object(n.useState)(!1),s=Object(n.useCallback)((()=>{r(!a)}),[a]),l=Object(n.useCallback)((()=>{r(!1)}),[]);return i.a.createElement(o.EuiPopover,{"data-test-subj":"eql-validation-errors-popover",button:i.a.createElement(o.EuiButtonEmpty,{"data-test-subj":"eql-validation-errors-popover-button",iconType:"crossInACircleFilled",size:"s",color:"danger","aria-label":e,onClick:s},t.length),isOpen:a,closePopover:l,anchorPosition:"downCenter"},i.a.createElement("div",{"data-test-subj":"eql-validation-errors-popover-content"},i.a.createElement(o.EuiPopoverTitle,null,c.k),t.map(((e,t)=>i.a.createElement(o.EuiText,{key:t},e)))))};var p=a(18);const m=s()(o.EuiText).withConfig({displayName:"InlineText",componentId:"sc-i91hzt-0"})(["display:inline-block;"]),g=()=>{const e=Object(p.j)().services.docLinks.links.query.eql;return i.a.createElement(o.EuiLink,{external:!0,href:e,target:"_blank"},i.a.createElement(m,{size:"xs"},c.i))},f=s()(o.EuiPanel).withConfig({displayName:"Container",componentId:"sc-10yczbx-0"})(["border-radius:0;background:",";padding:"," ",";"],(({theme:e})=>e.eui.euiPageBackgroundColor),(({theme:e})=>e.eui.euiSizeXS),(({theme:e})=>e.eui.euiSizeS)),b=s()(o.EuiFlexGroup).withConfig({displayName:"FlexGroup",componentId:"sc-10yczbx-1"})(["min-height:",";"],(({theme:e})=>e.eui.euiSizeXL)),h=s()(o.EuiFlexItem).withConfig({displayName:"FlexItemLeftBorder",componentId:"sc-10yczbx-2"})(["border-left:1px solid ",";"],(({theme:e})=>e.eui.euiColorLightShade)),y=s()(o.EuiFlexItem).withConfig({displayName:"FlexItemWithMarginRight",componentId:"sc-10yczbx-3"})(["margin-right:",";"],(({theme:e})=>e.eui.euiSizeS)),E=s()(o.EuiLoadingSpinner).withConfig({displayName:"Spinner",componentId:"sc-10yczbx-4"})(["margin:0 ",";"],(({theme:e})=>e.eui.euiSizeS)),v={asPlainText:!0},T=({errors:e,isLoading:t,isSizeOptionDisabled:a,optionsData:r,optionsSelected:s,onOptionsChange:l})=>{var p;const[m,T]=Object(n.useState)(!1),[k,x]=Object(n.useState)(null!==(p=null==s?void 0:s.size)&&void 0!==p?p:100),S=Object(n.useRef)(),O=Object(n.useCallback)((()=>{T(!0)}),[]),w=Object(n.useCallback)((()=>{T(!1)}),[]),j=Object(n.useCallback)((e=>{l&&(e.length>0?l("eventCategoryField",e[0].label):l("eventCategoryField",void 0))}),[l]),C=Object(n.useCallback)((e=>{l&&(e.length>0?l("tiebreakerField",e[0].label):l("tiebreakerField",void 0))}),[l]),I=Object(n.useCallback)((e=>{l&&(e.length>0?l("timestampField",e[0].label):l("timestampField",void 0))}),[l]),M=Object(n.useCallback)((e=>{var t,a,n,i;l&&(x(null==e||null===(t=e.target)||void 0===t?void 0:t.value),null!==(a=S.current)&&void 0!==a&&a.cancel&&(null===(i=S.current)||void 0===i||i.cancel()),S.current=Object(u.debounce)((e=>l("size",e)),800),S.current(null==e||null===(n=e.target)||void 0===n?void 0:n.value))}),[l]),A=Object(n.useMemo)((()=>null!=(null==s?void 0:s.eventCategoryField)?[{label:null==s?void 0:s.eventCategoryField}]:void 0),[null==s?void 0:s.eventCategoryField]),D=Object(n.useMemo)((()=>null!=(null==s?void 0:s.tiebreakerField)?[{label:null==s?void 0:s.tiebreakerField}]:void 0),[null==s?void 0:s.tiebreakerField]),q=Object(n.useMemo)((()=>null!=(null==s?void 0:s.timestampField)?[{label:null==s?void 0:s.timestampField}]:void 0),[null==s?void 0:s.timestampField]);return i.a.createElement(f,null,i.a.createElement(b,{alignItems:"center",justifyContent:"spaceBetween",gutterSize:"none"},i.a.createElement(o.EuiFlexItem,null,e.length>0&&i.a.createElement(d,{ariaLabel:c.l,errors:e}),t&&i.a.createElement(E,{"data-test-subj":"eql-validation-loading",size:"m"})),!l&&i.a.createElement(o.EuiFlexItem,{grow:!1},i.a.createElement(g,null)),l&&i.a.createElement(i.a.Fragment,null,i.a.createElement(y,{grow:!1},i.a.createElement(g,null)),i.a.createElement(h,{grow:!1},i.a.createElement(o.EuiPopover,{button:i.a.createElement(o.EuiButtonIcon,{onClick:O,iconType:"controlsVertical",isDisabled:m,"aria-label":"eql settings","data-test-subj":"eql-settings-trigger"}),isOpen:m,closePopover:w,anchorPosition:"downCenter",ownFocus:!1},i.a.createElement(o.EuiPopoverTitle,null,c.j),i.a.createElement("div",{style:{width:"300px"}},!a&&i.a.createElement(o.EuiFormRow,{label:c.h,helpText:c.g},i.a.createElement(o.EuiFieldNumber,{value:k,onChange:M,min:1,max:1e4})),i.a.createElement(o.EuiFormRow,{label:c.b,helpText:c.a},i.a.createElement(o.EuiComboBox,{options:null==r?void 0:r.keywordFields,selectedOptions:A,singleSelection:v,onChange:j})),i.a.createElement(o.EuiFormRow,{label:c.d,helpText:c.c},i.a.createElement(o.EuiComboBox,{options:null==r?void 0:r.nonDateFields,selectedOptions:D,singleSelection:v,onChange:C})),i.a.createElement(o.EuiFormRow,{label:c.f,helpText:c.e},i.a.createElement(o.EuiComboBox,{options:null==r?void 0:r.dateFields,selectedOptions:q,singleSelection:v,onChange:I}))))))))};var k=a(427);const x=s()(o.EuiTextArea).withConfig({displayName:"TextArea",componentId:"sc-4u43ce-0"})(["display:block;border:",";border-bottom:0;box-shadow:none;min-height:",";"],(({theme:e})=>e.eui.euiBorderThin),(({theme:e})=>e.eui.euiFormControlHeight)),S=({dataTestSubj:e,field:t,idAria:a,optionsData:r,optionsSelected:s,isSizeOptionDisabled:u,onOptionsChange:d,onValidityChange:p,onValiditingChange:m})=>{const{addError:g}=Object(l.a)(),[f,b]=Object(n.useState)([]),{isValidating:h,setValue:y}=t,{isValid:E,message:v,messages:S,error:O}=Object(k.c)(t),w=t.value.query.query;Object(n.useEffect)((()=>{null!=p&&p(E)}),[E,p]),Object(n.useEffect)((()=>{b(null!=S?S:[])}),[S]),Object(n.useEffect)((()=>{O&&g(O,{title:c.m})}),[O,g]),Object(n.useEffect)((()=>{m&&m(h)}),[h,m]);const j=Object(n.useCallback)((e=>{const t=e.target.value;m&&m(!0),b([]),y({filters:[],query:{query:t,language:"eql"},saved_id:null})}),[y,m]);return i.a.createElement(o.EuiFormRow,{label:t.label,labelAppend:t.labelAppend,helpText:t.helpText,error:v,isInvalid:!E&&!h,fullWidth:!0,"data-test-subj":e,describedByIds:a?[a]:void 0},i.a.createElement(i.a.Fragment,null,i.a.createElement(x,{"data-test-subj":"eqlQueryBarTextInput",fullWidth:!0,isInvalid:!E&&!h,value:w,onChange:j}),i.a.createElement(T,{errors:f,isLoading:h,isSizeOptionDisabled:u,optionsData:r,optionsSelected:s,onOptionsChange:d})))}},,,function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(52),i=a(426),r=a(199),s=a(226),o=a(307);const l=()=>({hosts:[],pageSize:10,pageIndex:0,total:0,loading:!1,error:void 0,endpointDetails:{activityLog:{paging:{disabled:!1,page:1,pageSize:50,startDate:"now-1d",endDate:"now",isInvalidDateRange:!1,autoRefreshOptions:{enabled:!1,duration:r.a},recentlyUsedDateRanges:[]},logData:Object(o.e)()},hostDetails:{details:void 0,detailsLoading:!1,detailsError:void 0}},policyResponse:void 0,policyResponseLoading:!1,policyResponseError:void 0,location:void 0,policyItems:[],selectedPolicyId:void 0,policyItemsLoading:!1,endpointPackageInfo:Object(o.e)(),nonExistingPolicies:{},agentPolicies:{},endpointsExist:!0,patterns:[],patternsError:void 0,isAutoRefreshEnabled:!0,autoRefreshInterval:r.a,agentsWithEndpointsTotal:0,agentsWithEndpointsTotalError:void 0,endpointsTotal:0,endpointsTotalError:void 0,policyVersionInfo:void 0,hostStatus:void 0,isolationRequestState:Object(o.e)(),endpointPendingActions:Object(o.c)(new Map),metadataTransformStats:Object(o.e)()}),c=n.combineReducers,u=(r.u,Object(i.a)(),r.s,l(),c({[r.u]:i.c,[r.s]:(e=l(),t)=>{if("serverReturnedEndpointList"===t.type){const{data:a,total:n,page:i,pageSize:r}=t.payload;return{...e,hosts:a,total:n,pageIndex:i,pageSize:r,loading:!1,error:void 0}}if("serverFailedToReturnEndpointList"===t.type)return{...e,error:t.payload,loading:!1};if("serverReturnedEndpointNonExistingPolicies"===t.type)return{...e,nonExistingPolicies:{...e.nonExistingPolicies,...t.payload}};if("serverReturnedEndpointAgentPolicies"===t.type)return{...e,agentPolicies:{...e.agentPolicies,...t.payload}};if("serverReturnedMetadataPatterns"===t.type)return{...e,patterns:t.payload,patternsError:void 0};if("serverFailedToReturnMetadataPatterns"===t.type)return{...e,patternsError:t.payload};if("serverReturnedEndpointDetails"===t.type)return{...e,endpointDetails:{...e.endpointDetails,hostDetails:{...e.endpointDetails.hostDetails,details:t.payload.metadata,detailsLoading:!1,detailsError:void 0}},policyVersionInfo:t.payload.policy_info,hostStatus:t.payload.host_status};if("serverFailedToReturnEndpointDetails"===t.type)return{...e,endpointDetails:{...e.endpointDetails,hostDetails:{...e.endpointDetails.hostDetails,detailsError:t.payload,detailsLoading:!1}}};if("endpointDetailsActivityLogUpdatePaging"===t.type||"endpointDetailsActivityLogUpdateIsInvalidDateRange"===t.type||"userUpdatedActivityLogRefreshOptions"===t.type)return{...e,endpointDetails:{...e.endpointDetails,activityLog:{...e.endpointDetails.activityLog,paging:{...e.endpointDetails.activityLog.paging,...t.payload}}}};if("userUpdatedActivityLogRecentlyUsedDateRanges"===t.type)return{...e,endpointDetails:{...e.endpointDetails,activityLog:{...e.endpointDetails.activityLog,paging:{...e.endpointDetails.activityLog.paging,recentlyUsedDateRanges:t.payload}}}};if("endpointDetailsActivityLogChanged"===t.type)return((e,t)=>{const a="LoadedResourceState"===t.payload.type?{...e.endpointDetails.activityLog,paging:{...e.endpointDetails.activityLog.paging,page:t.payload.data.page,pageSize:t.payload.data.pageSize,startDate:t.payload.data.startDate,endDate:t.payload.data.endDate}}:{...e.endpointDetails.activityLog};return{...e,endpointDetails:{...e.endpointDetails,activityLog:{...a,logData:t.payload}}}})(e,t);if("endpointPendingActionsStateChanged"===t.type)return((e,t)=>Object(s.isOnEndpointPage)(e)?{...e,endpointPendingActions:t.payload}:e)(e,t);if("serverReturnedPoliciesForOnboarding"===t.type)return{...e,policyItems:t.payload.policyItems,policyItemsLoading:!1};if("serverFailedToReturnPoliciesForOnboarding"===t.type)return{...e,error:t.payload,policyItemsLoading:!1};if("serverReturnedEndpointPolicyResponse"===t.type)return{...e,policyResponse:t.payload.policy_response,policyResponseLoading:!1,policyResponseError:void 0};if("serverFailedToReturnEndpointPolicyResponse"===t.type)return{...e,policyResponseError:t.payload,policyResponseLoading:!1};if("userSelectedEndpointPolicy"===t.type)return{...e,selectedPolicyId:t.payload.selectedPolicyId,policyResponseLoading:!1};if("serverCancelledEndpointListLoading"===t.type)return{...e,loading:!1};if("serverCancelledPolicyItemsLoading"===t.type)return{...e,policyItemsLoading:!1};if("endpointPackageInfoStateChanged"===t.type)return((e,t)=>({...e,endpointPackageInfo:t.payload}))(e,t);if("serverReturnedEndpointExistValue"===t.type)return{...e,endpointsExist:t.payload};if("serverReturnedAgenstWithEndpointsTotal"===t.type)return{...e,agentsWithEndpointsTotal:t.payload,agentsWithEndpointsTotalError:void 0};if("serverFailedToReturnAgenstWithEndpointsTotal"===t.type)return{...e,agentsWithEndpointsTotalError:t.payload};if("serverReturnedEndpointsTotal"===t.type)return{...e,endpointsTotal:t.payload,endpointsTotalError:void 0};if("serverFailedToReturnEndpointsTotal"===t.type)return{...e,endpointsTotalError:t.payload};var a,n;if("userUpdatedEndpointListRefreshOptions"===t.type)return{...e,isAutoRefreshEnabled:null!==(a=t.payload.isAutoRefreshEnabled)&&void 0!==a?a:e.isAutoRefreshEnabled,autoRefreshInterval:null!==(n=t.payload.autoRefreshInterval)&&void 0!==n?n:e.autoRefreshInterval};if("endpointIsolationRequestStateChange"===t.type)return((e,t)=>({...e,isolationRequestState:t.payload}))(e,t);if("userChangedUrl"===t.type){const a={...e,location:t.payload},n=Object(s.isOnEndpointPage)(a)&&!Object(s.hasSelectedEndpoint)(a),i=Object(s.isOnEndpointPage)(e)&&!Object(s.hasSelectedEndpoint)(e),l=Object(s.isOnEndpointPage)(a)&&Object(s.hasSelectedEndpoint)(a),c=Object(s.isOnEndpointPage)(e)&&Object(s.hasSelectedEndpoint)(e),u=Object(s.isOnEndpointPage)(e)&&Object(s.hasSelectedEndpoint)(e)&&Object(s.getIsOnEndpointDetailsActivityLog)(e),d=Object(s.isOnEndpointPage)(a)&&Object(s.hasSelectedEndpoint)(a)&&Object(s.getIsOnEndpointDetailsActivityLog)(a)||u&&Object(s.uiQueryParams)(e).selected_endpoint===Object(s.uiQueryParams)(a).selected_endpoint,p={location:t.payload,error:void 0,policyResponseError:void 0},m={logData:Object(o.e)(),paging:{disabled:!1,isInvalidDateRange:!1,page:1,pageSize:50,startDate:"now-1d",endDate:"now",autoRefreshOptions:{enabled:!1,duration:r.a},recentlyUsedDateRanges:[]}};if("isolate"===Object(s.uiQueryParams)(a).show||Object(o.j)(Object(s.getCurrentIsolationRequestState)(a))||(p.isolationRequestState=Object(o.e)()),n){if(!i)return{...e,...p,endpointDetails:{...e.endpointDetails,activityLog:{...m,paging:{...m.paging,startDate:e.endpointDetails.activityLog.paging.startDate,endDate:e.endpointDetails.activityLog.paging.endDate,recentlyUsedDateRanges:e.endpointDetails.activityLog.paging.recentlyUsedDateRanges}},hostDetails:{...e.endpointDetails.hostDetails,detailsError:void 0}},loading:!0,policyItemsLoading:!0}}else if(l)return c||i?{...e,...p,endpointDetails:{...e.endpointDetails,activityLog:{...m,paging:{...m.paging,startDate:e.endpointDetails.activityLog.paging.startDate,endDate:e.endpointDetails.activityLog.paging.endDate,recentlyUsedDateRanges:e.endpointDetails.activityLog.paging.recentlyUsedDateRanges}},hostDetails:{...e.endpointDetails.hostDetails,detailsLoading:!d,detailsError:void 0}},detailsLoading:!0,policyResponseLoading:!0}:{...e,...p,endpointDetails:{...e.endpointDetails,activityLog:{...m,paging:{...m.paging,startDate:e.endpointDetails.activityLog.paging.startDate,endDate:e.endpointDetails.activityLog.paging.endDate,recentlyUsedDateRanges:e.endpointDetails.activityLog.paging.recentlyUsedDateRanges}},hostDetails:{...e.endpointDetails.hostDetails,detailsLoading:!0,detailsError:void 0}},loading:!0,policyResponseLoading:!0,policyItemsLoading:!0};return{...e,...p,endpointDetails:{...e.endpointDetails,activityLog:{...m,paging:{...m.paging,startDate:e.endpointDetails.activityLog.paging.startDate,endDate:e.endpointDetails.activityLog.paging.endDate,recentlyUsedDateRanges:e.endpointDetails.activityLog.paging.recentlyUsedDateRanges}},hostDetails:{...e.endpointDetails.hostDetails,detailsError:void 0}},endpointsExist:!0}}return"metadataTransformStatsChanged"===t.type?((e,t)=>({...e,metadataTransformStats:t.payload}))(e,t):e}}))},,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return j}));var n=a(73),i=a(199),r=a(426),s=a(385),o=a.n(s),l=a(173),c=a(256),u=a(362),d=a(495),p=a(329),m=a(548),g=a(307),f=a(378),b=a(420),h=a(226);const y=console.error,E=(e,t)=>{async function a(e){var a;const n=null!==(a=Object(h.endpointPackageVersion)(e))&&void 0!==a?a:"",i=n.includes("-")?n.substring(0,n.indexOf("-")):n,r=o()(i,"1.2.0")?c.i:c.k,{indexPatterns:s}=t.data;return[{title:r,fields:await s.getFieldsForWildcard({pattern:r})}]}return t=>n=>async i=>{n(i);const{getState:r,dispatch:s}=t;if(await async function(e,t,a){if(Object(h.getIsEndpointPackageInfoUninitialized)(e)){t({type:"endpointPackageInfoStateChanged",payload:Object(g.d)(Object(g.a)(Object(h.endpointPackageInfo)(e)))});try{const e=await Object(f.c)(a.http);t({type:"endpointPackageInfoStateChanged",payload:Object(g.c)(e)})}catch(e){y(e),t({type:"endpointPackageInfoStateChanged",payload:Object(g.b)(e)})}}}(r(),s,e),"userChangedUrl"!==i.type&&"appRequestedEndpointList"!==i.type||!Object(h.isOnEndpointPage)(r())||Object(h.hasSelectedEndpoint)(r())||await async function({store:e,coreStart:t,fetchIndexPatterns:a}){const{getState:n,dispatch:i}=e,{page_index:r,page_size:s}=Object(h.uiQueryParams)(n());let o;try{const a=Object(h.searchBarQuery)(n());o=await t.http.get(c.f,{query:{page:r,pageSize:s,kuery:a.query}}),i({type:"serverReturnedEndpointList",payload:o}),x(e);try{i({type:"serverReturnedEndpointsTotal",payload:await T(t.http)})}catch(e){i({type:"serverFailedToReturnEndpointsTotal",payload:e})}try{i({type:"serverReturnedAgenstWithEndpointsTotal",payload:(await Object(f.e)(t.http)).total})}catch(e){i({type:"serverFailedToReturnAgenstWithEndpointsTotal",payload:e})}O({http:t.http,hosts:o.data,store:e})}catch(e){i({type:"serverFailedToReturnEndpointList",payload:e})}if(0===Object(h.patterns)(n()).length)try{const e=await a(n());void 0!==e&&i({type:"serverReturnedMetadataPatterns",payload:e})}catch(e){i({type:"serverFailedToReturnMetadataPatterns",payload:e})}if(o&&0===o.data.length){const e=t.http;if(await(async e=>{try{return await T(e)>0}catch(e){y("error while trying to check if endpoints exist"),y(e)}return!1})(e))return;i({type:"serverReturnedEndpointExistValue",payload:!1});try{i({type:"serverReturnedPoliciesForOnboarding",payload:{policyItems:(await Object(m.a)(e,{query:{perPage:50,page:1}})).items}})}catch(e){var l;i({type:"serverFailedToReturnPoliciesForOnboarding",payload:null!==(l=e.body)&&void 0!==l?l:e})}}else i({type:"serverCancelledPolicyItemsLoading"}),i({type:"serverReturnedEndpointExistValue",payload:!0})}({coreStart:e,store:t,fetchIndexPatterns:a}),"userChangedUrl"===i.type&&Object(h.hasSelectedEndpoint)(r())){const{selected_endpoint:a}=Object(h.uiQueryParams)(r());await async function({coreStart:e,selectedEndpoint:t,store:a}){const{getState:n,dispatch:i}=a;if(i({type:"serverCancelledPolicyItemsLoading"}),0===Object(h.listData)(n()).length){const{page_index:t,page_size:r}=Object(h.uiQueryParams)(n());try{const n=await e.http.get(c.f,{query:{page:t,pageSize:r}});i({type:"serverReturnedEndpointList",payload:n}),O({http:e.http,hosts:n.data,store:a})}catch(e){i({type:"serverFailedToReturnEndpointList",payload:e})}}else i({type:"serverCancelledEndpointListLoading"});void 0!==t&&await S({store:a,coreStart:e,selectedEndpoint:t})}({store:t,coreStart:e,selectedEndpoint:a})}return"endpointDetailsLoad"===i.type&&await S({store:t,coreStart:e,selectedEndpoint:i.payload.endpointId}),"userChangedUrl"===i.type&&!0===Object(h.hasSelectedEndpoint)(r())&&Object(h.getIsOnEndpointDetailsActivityLog)(r())&&Object(h.getActivityLogIsUninitializedOrHasSubsequentAPIError)(r())&&await async function({store:e,coreStart:t}){const{getState:a,dispatch:n}=e;n({type:"endpointDetailsActivityLogChanged",payload:Object(g.d)(Object(g.a)(Object(h.getActivityLogData)(a())))});try{const{page:e,pageSize:i,startDate:r,endDate:s}=Object(h.getActivityLogDataPaging)(a()),o=Object(p.a)(c.d,{agent_id:Object(h.selectedAgent)(a())}),l=await t.http.get(o,{query:{page:e,page_size:i,start_date:r,end_date:s}});n({type:"endpointDetailsActivityLogChanged",payload:Object(g.c)(l)})}catch(e){var i;n({type:"endpointDetailsActivityLogChanged",payload:Object(g.b)(null!==(i=e.body)&&void 0!==i?i:e)})}}({store:t,coreStart:e}),"endpointDetailsActivityLogUpdatePaging"===i.type&&!Object(h.getActivityLogError)(r())&&Object(h.hasSelectedEndpoint)(r())&&await async function({store:e,coreStart:t}){const{getState:a,dispatch:n}=e;try{const{disabled:e,page:i,pageSize:r,startDate:s,endDate:o}=Object(h.getActivityLogDataPaging)(a());if(e)return;if(Object(b.a)({startDate:s,endDate:o}))return void n({type:"endpointDetailsActivityLogUpdateIsInvalidDateRange",payload:{isInvalidDateRange:!0}});n({type:"endpointDetailsActivityLogUpdateIsInvalidDateRange",payload:{isInvalidDateRange:!1}}),n({type:"endpointDetailsActivityLogChanged",payload:Object(g.d)(Object(g.a)(Object(h.getActivityLogData)(a())))});const l=Object(p.a)(c.d,{agent_id:Object(h.selectedAgent)(a())}),u=await t.http.get(l,{query:{page:i,page_size:r,start_date:s,end_date:o}}),d=Object(h.getLastLoadedActivityLogData)(a());if(void 0!==d){const e=[...new Set([...d.data,...u.data])].sort(((e,t)=>new Date(t.item.data["@timestamp"])>new Date(e.item.data["@timestamp"])?1:-1)),t={page:u.page,pageSize:u.pageSize,startDate:u.startDate,endDate:u.endDate,data:1===u.page?u.data:e};n({type:"endpointDetailsActivityLogChanged",payload:Object(g.c)(t)}),u.data.length||n({type:"endpointDetailsActivityLogUpdatePaging",payload:{disabled:!0,page:u.page>1?u.page-1:1,pageSize:u.pageSize,startDate:u.startDate,endDate:u.endDate}})}else n({type:"endpointDetailsActivityLogChanged",payload:Object(g.c)(u)})}catch(e){var i;n({type:"endpointDetailsActivityLogChanged",payload:Object(g.b)(null!==(i=e.body)&&void 0!==i?i:e)})}}({store:t,coreStart:e}),"endpointIsolationRequest"===i.type?k(t,i):"loadMetadataTransformStats"===i.type?async function(e,t){const{getState:a,dispatch:n}=t;if(!e||!a||!n)return;const i=a();if(!Object(h.isMetadataTransformStatsLoading)(i)){n({type:"metadataTransformStatsChanged",payload:Object(g.d)(Object(g.a)(Object(h.getMetadataTransformStats)(i)))});try{const t=await e.get(c.h);n({type:"metadataTransformStatsChanged",payload:Object(g.c)(t.transforms)})}catch(e){n({type:"metadataTransformStatsChanged",payload:Object(g.b)(e)})}}}(e.http,t):void 0}},v=async(e,t,a)=>{if(0===t.length)return;const n=[...new Set(t.reduce(((e,t)=>{const n=t.metadata.Endpoint.policy.applied.id;return a[n]||e.push(n),e}),[]))];if(0===n.length)return;const i=(await Object(f.b)(e,{query:{kuery:`${l.AGENT_POLICY_SAVED_OBJECT_TYPE}.package_policies: (${n.join(" or ")})`}})).items.reduce(((e,t)=>(t.package_policies.forEach((a=>{e.packagePolicy[a]=!0,e.agentPolicy[a]=t.id})),e)),{packagePolicy:{},agentPolicy:{}}),r=n.reduce(((e,t)=>i.packagePolicy[t]?(e.agentPolicy[t]=i.agentPolicy[t],e):(e.packagePolicy[t]=!0,e)),{packagePolicy:{},agentPolicy:{}});return 0!==Object.keys(r.packagePolicy).length||0!==Object.keys(r.agentPolicy).length?r:void 0},T=async e=>{try{return(await e.get(c.f,{query:{page:0,pageSize:1}})).total}catch(e){y("error while trying to check for total endpoints"),y(e)}return 0},k=async({getState:e,dispatch:t},a)=>{const n=e();if(!Object(h.getIsIsolationRequestPending)(n)){t({type:"endpointIsolationRequestStateChange",payload:Object(g.d)(Object(g.a)(Object(h.getCurrentIsolationRequestState)(n)))});try{let e;e="unisolate"===a.payload.type?await Object(u.b)(a.payload.data):await Object(u.a)(a.payload.data),t({type:"endpointIsolationRequestStateChange",payload:Object(g.c)(e)})}catch(e){var i;t({type:"endpointIsolationRequestStateChange",payload:Object(g.b)(null!==(i=e.body)&&void 0!==i?i:e)})}}},x=async({getState:e,dispatch:t})=>{const a=e(),n=Object(h.detailsData)(a),i=Object(h.listData)(a),r=new Set;n&&r.add(n.elastic.agent.id);for(const e of i)r.add(e.metadata.elastic.agent.id);if(0!==r.size)try{const{data:e}=await Object(d.a)(Array.from(r)),a=new Map;for(const t of e)a.set(t.agent_id,t.pending_actions);t({type:"endpointPendingActionsStateChanged",payload:Object(g.c)(a)})}catch(e){y(e)}};async function S({selectedEndpoint:e,store:t,coreStart:a}){const{getState:n,dispatch:i}=t;try{const t=await a.http.get(Object(p.a)(c.e,{id:e}));i({type:"serverReturnedEndpointDetails",payload:t});try{const e=await v(a.http,[t],Object(h.nonExistingPolicies)(n()));void 0!==e&&i({type:"serverReturnedEndpointNonExistingPolicies",payload:e.packagePolicy}),void 0!==(null==e?void 0:e.agentPolicy)&&i({type:"serverReturnedEndpointAgentPolicies",payload:e.agentPolicy})}catch(e){y(e)}}catch(e){i({type:"serverFailedToReturnEndpointDetails",payload:e})}x(t);try{i({type:"serverReturnedEndpointPolicyResponse",payload:await a.http.get(c.c,{query:{agentId:e}})})}catch(e){i({type:"serverFailedToReturnEndpointPolicyResponse",payload:e})}}async function O({store:e,hosts:t,http:a}){const{getState:n,dispatch:i}=e;try{const e=await v(a,t,Object(h.nonExistingPolicies)(n()));void 0!==(null==e?void 0:e.packagePolicy)&&i({type:"serverReturnedEndpointNonExistingPolicies",payload:e.packagePolicy}),void 0!==(null==e?void 0:e.agentPolicy)&&i({type:"serverReturnedEndpointAgentPolicies",payload:e.agentPolicy})}catch(e){y(e)}}const w=e=>t=>t[i.t][e],j=(e,t)=>[Object(n.g)(w(i.u),Object(r.b)(e,t)),Object(n.g)(w(i.s),E(e,t))]},,function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(5),i=a.n(n),r=a(16),s=a(165);const o=Object(n.memo)((()=>i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiEmptyPrompt,{iconType:"alert",iconColor:"danger",titleSize:"l","data-test-subj":"noIngestPermissions",title:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpointManagemnet.noPermissionsText",defaultMessage:"You do not have the required Kibana permissions to use Elastic Security Administration"}),body:i.a.createElement(r.EuiText,{color:"subdued"},i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpointManagement.noPermissionsSubText",defaultMessage:"You must have the superuser role to use this feature. If you do not have the superuser role and do not have permissions to edit user roles, contact your Kibana administrator."}))}))));o.displayName="NoPermissions"},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){const n=a(264);e.exports=(e,t,a)=>0!==n(e,t,a)},function(e,t,a){const n=a(565),i=a(771),r=a(475),s=a(385),o=a(567),l=a(411);e.exports=(e,t,a,c)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof a&&(a=a.version),e===a;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof a&&(a=a.version),e!==a;case"":case"=":case"==":return n(e,a,c);case"!=":return i(e,a,c);case">":return r(e,a,c);case">=":return s(e,a,c);case"<":return o(e,a,c);case"<=":return l(e,a,c);default:throw new TypeError(`Invalid operator: ${t}`)}}},function(e,t,a){const n=a(243),i=a(384),{re:r,t:s}=a(377);e.exports=(e,t)=>{if(e instanceof n)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;let a=null;if((t=t||{}).rtl){let t;for(;(t=r[s.COERCERTL].exec(e))&&(!a||a.index+a[0].length!==e.length);)a&&t.index+t[0].length===a.index+a[0].length||(a=t),r[s.COERCERTL].lastIndex=t.index+t[1].length+t[2].length;r[s.COERCERTL].lastIndex=-1}else a=e.match(r[s.COERCE]);return null===a?null:i(`${a[2]}.${a[3]||"0"}.${a[4]||"0"}`,t)}},function(e,t,a){e.exports=a(24)(1505)},function(e,t,a){"use strict";e.exports={position:!0,gfm:!0,commonmark:!1,footnotes:!1,pedantic:!1,blocks:a(1090)}},function(e,t,a){"use strict";e.exports=function(e){for(var t,a=0,i=0,r=e.charAt(a),s={};r in n;)i+=t=n[r],t>1&&(i=Math.floor(i/t)*t),s[i]=a,r=e.charAt(++a);return{indent:i,stops:s}};var n={" ":1,"\t":4}},function(e,t,a){"use strict";var n="<[A-Za-z][A-Za-z0-9\\-]*(?:\\s+[a-zA-Z_:][a-zA-Z0-9:._-]*(?:\\s*=\\s*(?:[^\"'=<>`\\u0000-\\u0020]+|'[^']*'|\"[^\"]*\"))?)*\\s*\\/?>",i="<\\/[A-Za-z][A-Za-z0-9\\-]*\\s*>";t.openCloseTag=new RegExp("^(?:"+n+"|"+i+")"),t.tag=new RegExp("^(?:"+n+"|"+i+"|\x3c!----\x3e|\x3c!--(?:-?[^>-])(?:-?[^-])*--\x3e|<[?].*?[?]>|<![A-Za-z]+\\s+[^>]*>|<!\\[CDATA\\[[\\s\\S]*?\\]\\]>)")},function(e,t,a){"use strict";e.exports=function(e,t){return e.indexOf("<",t)}},function(e,t,a){"use strict";e.exports=function(e,t){var a=e.indexOf("[",t),n=e.indexOf("![",t);return-1===n||a<n?a:n}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={within:!0,queries:!0,queryHelpers:!0,getDefaultNormalizer:!0,getRoles:!0,logRoles:!0,isInaccessible:!0,configure:!0,getConfig:!0};Object.defineProperty(t,"configure",{enumerable:!0,get:function(){return f.configure}}),Object.defineProperty(t,"getConfig",{enumerable:!0,get:function(){return f.getConfig}}),Object.defineProperty(t,"getDefaultNormalizer",{enumerable:!0,get:function(){return c.getDefaultNormalizer}}),Object.defineProperty(t,"getRoles",{enumerable:!0,get:function(){return m.getRoles}}),Object.defineProperty(t,"isInaccessible",{enumerable:!0,get:function(){return m.isInaccessible}}),Object.defineProperty(t,"logRoles",{enumerable:!0,get:function(){return m.logRoles}}),t.queryHelpers=t.queries=void 0,Object.defineProperty(t,"within",{enumerable:!0,get:function(){return i.getQueriesForElement}});var i=a(781);Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||e in t&&t[e]===i[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}}))}));var r=y(a(576));t.queries=r,Object.keys(r).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||e in t&&t[e]===r[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}}))}));var s=y(a(304));t.queryHelpers=s,Object.keys(s).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||e in t&&t[e]===s[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}}))}));var o=a(584);Object.keys(o).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||e in t&&t[e]===o[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}}))}));var l=a(1312);Object.keys(l).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||e in t&&t[e]===l[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return l[e]}}))}));var c=a(484),u=a(579);Object.keys(u).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||e in t&&t[e]===u[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return u[e]}}))}));var d=a(1313);Object.keys(d).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||e in t&&t[e]===d[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return d[e]}}))}));var p=a(1315);Object.keys(p).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||e in t&&t[e]===p[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return p[e]}}))}));var m=a(582),g=a(482);Object.keys(g).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||e in t&&t[e]===g[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return g[e]}}))}));var f=a(319),b=a(784);function h(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(h=function(e){return e?a:t})(e)}function y(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var a=h(t);if(a&&a.has(e))return a.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if("default"!==r&&Object.prototype.hasOwnProperty.call(e,r)){var s=i?Object.getOwnPropertyDescriptor(e,r):null;s&&(s.get||s.set)?Object.defineProperty(n,r,s):n[r]=e[r]}return n.default=e,a&&a.set(e,n),n}Object.keys(b).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||e in t&&t[e]===b[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return b[e]}}))}))},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getQueriesForElement=function(e,t=n,a={}){return Object.keys(t).reduce(((a,n)=>{const i=t[n];return a[n]=i.bind(null,e),a}),a)};var n=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var a=i(t);if(a&&a.has(e))return a.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var o=r?Object.getOwnPropertyDescriptor(e,s):null;o&&(o.get||o.set)?Object.defineProperty(n,s,o):n[s]=e[s]}return n.default=e,a&&a.set(e,n),n}(a(576));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(i=function(e){return e?a:t})(e)}},function(e,t,a){"use strict";(function(e){const t=(e=0)=>t=>`[${38+e};5;${t}m`,a=(e=0)=>(t,a,n)=>`[${38+e};2;${t};${a};${n}m`;Object.defineProperty(e,"exports",{enumerable:!0,get:function(){const e=new Map,n={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};n.color.gray=n.color.blackBright,n.bgColor.bgGray=n.bgColor.bgBlackBright,n.color.grey=n.color.blackBright,n.bgColor.bgGrey=n.bgColor.bgBlackBright;for(const[t,a]of Object.entries(n)){for(const[t,i]of Object.entries(a))n[t]={open:`[${i[0]}m`,close:`[${i[1]}m`},a[t]=n[t],e.set(i[0],i[1]);Object.defineProperty(n,t,{value:a,enumerable:!1})}return Object.defineProperty(n,"codes",{value:e,enumerable:!1}),n.color.close="[39m",n.bgColor.close="[49m",n.color.ansi256=t(),n.color.ansi16m=a(),n.bgColor.ansi256=t(10),n.bgColor.ansi16m=a(10),Object.defineProperties(n,{rgbToAnsi256:{value:(e,t,a)=>e===t&&t===a?e<8?16:e>248?231:Math.round((e-8)/247*24)+232:16+36*Math.round(e/255*5)+6*Math.round(t/255*5)+Math.round(a/255*5),enumerable:!1},hexToRgb:{value:e=>{const t=/(?<colorString>[a-f\d]{6}|[a-f\d]{3})/i.exec(e.toString(16));if(!t)return[0,0,0];let{colorString:a}=t.groups;3===a.length&&(a=a.split("").map((e=>e+e)).join(""));const n=Number.parseInt(a,16);return[n>>16&255,n>>8&255,255&n]},enumerable:!1},hexToAnsi256:{value:e=>n.rgbToAnsi256(...n.hexToRgb(e)),enumerable:!1}}),n}})}).call(this,a(303)(e))},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLabelContent=s,t.getLabels=function(e,t,{selector:a="*"}={}){const n=t.getAttribute("aria-labelledby"),i=n?n.split(" "):[];return i.length?i.map((t=>{const a=e.querySelector(`[id="${t}"]`);return a?{content:s(a),formControl:null}:{content:"",formControl:null}})):Array.from(o(t)).map((e=>({content:s(e),formControl:Array.from(e.querySelectorAll("button, input, meter, output, progress, select, textarea")).filter((e=>e.matches(a)))[0]})))},t.getRealLabels=o;var n=a(253);const i=["button","meter","output","progress","select","textarea","input"];function r(e){return i.includes(e.nodeName.toLowerCase())?"":e.nodeType===n.TEXT_NODE?e.textContent:Array.from(e.childNodes).map((e=>r(e))).join("")}function s(e){let t;return t="label"===e.tagName.toLowerCase()?r(e):e.value||e.textContent,t}function o(e){var t;if(void 0!==e.labels)return null!=(t=e.labels)?t:[];if(!function(e){return/BUTTON|METER|OUTPUT|PROGRESS|SELECT|TEXTAREA/.test(e.tagName)||"INPUT"===e.tagName&&"hidden"!==e.getAttribute("type")}(e))return[];const a=e.ownerDocument.querySelectorAll("label");return Array.from(a).filter((t=>t.control===e))}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSuggestedQuery=function(e,t="get",a){var i,d;if(e.matches(c.DEFAULT_IGNORE_TAGS))return;const g=null!=(i=e.getAttribute("role"))?i:null==(d=(0,o.getImplicitAriaRoles)(e))?void 0:d[0];if("generic"!==g&&m("Role",a,g))return p("Role",e,g,{variant:t,name:(0,n.computeAccessibleName)(e,{computedStyleSupportsPseudoElements:(0,s.getConfig)().computedStyleSupportsPseudoElements})});const f=(0,l.getLabels)(document,e).map((e=>e.content)).join(" ");if(m("LabelText",a,f))return p("LabelText",e,f,{variant:t});const b=e.getAttribute("placeholder");if(m("PlaceholderText",a,b))return p("PlaceholderText",e,b,{variant:t});const h=u((0,r.getNodeText)(e));if(m("Text",a,h))return p("Text",e,h,{variant:t});if(m("DisplayValue",a,e.value))return p("DisplayValue",e,u(e.value),{variant:t});const y=e.getAttribute("alt");if(m("AltText",a,y))return p("AltText",e,y,{variant:t});const E=e.getAttribute("title");if(m("Title",a,E))return p("Title",e,E,{variant:t});const v=e.getAttribute((0,s.getConfig)().testIdAttribute);return m("TestId",a,v)?p("TestId",e,v,{variant:t}):void 0};var n=a(580),i=a(484),r=a(579),s=a(319),o=a(582),l=a(783),c=a(578);const u=(0,i.getDefaultNormalizer)();function d(e){return new RegExp(function(e){return e.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&")}(e.toLowerCase()),"i")}function p(e,t,a,{variant:n,name:i}){let r="";const s={},l=[["Role","TestId"].includes(e)?a:d(a)];i&&(s.name=d(i)),"Role"===e&&(0,o.isInaccessible)(t)&&(s.hidden=!0,r="Element is inaccessible. This means that the element and all its children are invisible to screen readers.\n    If you are using the aria-hidden prop, make sure this is the right choice for your case.\n    "),Object.keys(s).length>0&&l.push(s);const c=`${n}By${e}`;return{queryName:e,queryMethod:c,queryArgs:l,variant:n,warning:r,toString(){r&&console.warn(r);let[e,t]=l;return e="string"==typeof e?`'${e}'`:e,t=t?`, { ${Object.entries(t).map((([e,t])=>`${e}: ${t}`)).join(", ")} }`:"",`${c}(${e}${t})`}}}function m(e,t,a){return a&&(!t||t.toLowerCase()===e.toLowerCase())}},function(e,t,a){"use strict";t.__esModule=!0,t.computeTextAlternative=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=new i.default,s=(0,r.safeWindow)(e),d=t.compute,y=void 0===d?"name":d,E=t.computedStyleSupportsPseudoElements,v=void 0===E?void 0!==t.getComputedStyle:E,x=t.getComputedStyle,S=void 0===x?s.getComputedStyle.bind(s):x,O=t.hidden,w=void 0!==O&&O;function j(e,t){var a="";if((0,r.isElement)(e)&&v){var i=h(S(e,"::before"));a="".concat(i," ").concat(a)}if(((0,r.isHTMLSlotElement)(e)?k(e):(0,n.default)(e.childNodes).concat((0,r.queryIdRefs)(e,"aria-owns"))).forEach((function(e){var n=I(e,{isEmbeddedInLabel:t.isEmbeddedInLabel,isReferenced:!1,recursion:!0}),i="inline"!==((0,r.isElement)(e)?S(e).getPropertyValue("display"):"inline")?" ":"";a+="".concat(i).concat(n).concat(i)})),(0,r.isElement)(e)&&v){var s=h(S(e,"::after"));a="".concat(a," ").concat(s)}return a.trim()}function C(e){if(!(0,r.isElement)(e))return null;function t(e,t){var n=e.getAttributeNode(t);return null===n||a.has(n)||""===n.value.trim()?null:(a.add(n),n.value)}if((0,r.isHTMLFieldSetElement)(e)){a.add(e);for(var i=(0,n.default)(e.childNodes),s=0;s<i.length;s+=1){var o=i[s];if((0,r.isHTMLLegendElement)(o))return I(o,{isEmbeddedInLabel:!1,isReferenced:!1,recursion:!1})}}else if((0,r.isHTMLTableElement)(e)){a.add(e);for(var l=(0,n.default)(e.childNodes),c=0;c<l.length;c+=1){var u=l[c];if((0,r.isHTMLTableCaptionElement)(u))return I(u,{isEmbeddedInLabel:!1,isReferenced:!1,recursion:!1})}}else{if((0,r.isSVGSVGElement)(e)){a.add(e);for(var d=(0,n.default)(e.childNodes),p=0;p<d.length;p+=1){var m=d[p];if((0,r.isSVGTitleElement)(m))return m.textContent}return null}if("img"===(0,r.getLocalName)(e)||"area"===(0,r.getLocalName)(e)){var g=t(e,"alt");if(null!==g)return g}else if((0,r.isHTMLOptGroupElement)(e)){var f=t(e,"label");if(null!==f)return f}}if((0,r.isHTMLInputElement)(e)&&("button"===e.type||"submit"===e.type||"reset"===e.type)){var b=t(e,"value");if(null!==b)return b;if("submit"===e.type)return"Submit";if("reset"===e.type)return"Reset"}var h=T(e);if(null!==h&&0!==h.length)return a.add(e),(0,n.default)(h).map((function(e){return I(e,{isEmbeddedInLabel:!0,isReferenced:!1,recursion:!0})})).filter((function(e){return e.length>0})).join(" ");if((0,r.isHTMLInputElement)(e)&&"image"===e.type){var y=t(e,"alt");if(null!==y)return y;var E=t(e,"title");return null!==E?E:"Submit Query"}if((0,r.hasAnyConcreteRoles)(e,["button"])){var v=j(e,{isEmbeddedInLabel:!1,isReferenced:!1});return""!==v?v:t(e,"title")}return t(e,"title")}function I(e,t){if(a.has(e))return"";if(!w&&l(e,S)&&!t.isReferenced)return a.add(e),"";var i=(0,r.queryIdRefs)(e,"aria-labelledby");if("name"===y&&!t.isReferenced&&i.length>0)return i.map((function(e){return I(e,{isEmbeddedInLabel:t.isEmbeddedInLabel,isReferenced:!0,recursion:!1})})).join(" ");var s=t.recursion&&c(e)&&"name"===y;if(!s){var o=((0,r.isElement)(e)&&e.getAttribute("aria-label")||"").trim();if(""!==o&&"name"===y)return a.add(e),o;if(!m(e)){var d=C(e);if(null!==d)return a.add(e),d}}if((0,r.hasAnyConcreteRoles)(e,["menu"]))return a.add(e),"";if(s||t.isEmbeddedInLabel||t.isReferenced){if((0,r.hasAnyConcreteRoles)(e,["combobox","listbox"])){a.add(e);var h=p(e);return 0===h.length?(0,r.isHTMLInputElement)(e)?e.value:"":(0,n.default)(h).map((function(e){return I(e,{isEmbeddedInLabel:t.isEmbeddedInLabel,isReferenced:!1,recursion:!0})})).join(" ")}if(u(e,"range"))return a.add(e),e.hasAttribute("aria-valuetext")?e.getAttribute("aria-valuetext"):e.hasAttribute("aria-valuenow")?e.getAttribute("aria-valuenow"):e.getAttribute("value")||"";if((0,r.hasAnyConcreteRoles)(e,["textbox"]))return a.add(e),b(e)}return f(e)||(0,r.isElement)(e)&&t.isReferenced||g(e)?(a.add(e),j(e,{isEmbeddedInLabel:t.isEmbeddedInLabel,isReferenced:!1})):e.nodeType===e.TEXT_NODE?(a.add(e),e.textContent||""):t.recursion?(a.add(e),j(e,{isEmbeddedInLabel:t.isEmbeddedInLabel,isReferenced:!1})):(a.add(e),"")}return o(I(e,{isEmbeddedInLabel:!1,isReferenced:"description"===y,recursion:!1}))};var n=s(a(1161)),i=s(a(1162)),r=a(581);function s(e){return e&&e.__esModule?e:{default:e}}function o(e){return e.trim().replace(/\s\s+/g," ")}function l(e,t){if(!(0,r.isElement)(e))return!1;if(e.hasAttribute("hidden")||"true"===e.getAttribute("aria-hidden"))return!0;var a=t(e);return"none"===a.getPropertyValue("display")||"hidden"===a.getPropertyValue("visibility")}function c(e){return(0,r.hasAnyConcreteRoles)(e,["button","combobox","listbox","textbox"])||u(e,"range")}function u(e,t){if(!(0,r.isElement)(e))return!1;if("range"===t)return(0,r.hasAnyConcreteRoles)(e,["meter","progressbar","scrollbar","slider","spinbutton"]);throw new TypeError("No knowledge about abstract role '".concat(t,"'. This is likely a bug :("))}function d(e,t){var a=(0,n.default)(e.querySelectorAll(t));return(0,r.queryIdRefs)(e,"aria-owns").forEach((function(e){a.push.apply(a,(0,n.default)(e.querySelectorAll(t)))})),a}function p(e){return(0,r.isHTMLSelectElement)(e)?e.selectedOptions||d(e,"[selected]"):d(e,'[aria-selected="true"]')}function m(e){return(0,r.hasAnyConcreteRoles)(e,["none","presentation"])}function g(e){return(0,r.isHTMLTableCaptionElement)(e)}function f(e){return(0,r.hasAnyConcreteRoles)(e,["button","cell","checkbox","columnheader","gridcell","heading","label","legend","link","menuitem","menuitemcheckbox","menuitemradio","option","radio","row","rowheader","switch","tab","tooltip","treeitem"])}function b(e){return(0,r.isHTMLInputElement)(e)||(0,r.isHTMLTextAreaElement)(e)?e.value:e.textContent||""}function h(e){var t=e.getPropertyValue("content");return/^["'].*["']$/.test(t)?t.slice(1,-1):""}function y(e){var t=(0,r.getLocalName)(e);return"button"===t||"input"===t&&"hidden"!==e.getAttribute("type")||"meter"===t||"output"===t||"progress"===t||"select"===t||"textarea"===t}function E(e){if(y(e))return e;var t=null;return e.childNodes.forEach((function(e){if(null===t&&(0,r.isElement)(e)){var a=E(e);null!==a&&(t=a)}})),t}function v(e){if(void 0!==e.control)return e.control;var t=e.getAttribute("for");return null!==t?e.ownerDocument.getElementById(t):E(e)}function T(e){var t=e.labels;if(null===t)return t;if(void 0!==t)return(0,n.default)(t);if(!y(e))return null;var a=e.ownerDocument;return(0,n.default)(a.querySelectorAll("label")).filter((function(t){return v(t)===e}))}function k(e){var t=e.assignedNodes();return 0===t.length?(0,n.default)(e.childNodes):t}},function(e,t,a){"use strict";function n(e){var t;return null!==(t=e.localName)&&void 0!==t?t:e.tagName.toLowerCase()}t.__esModule=!0,t.default=function(e){var t=function(e){var t=e.getAttribute("role");if(null!==t){var a=t.trim().split(" ")[0];if(a.length>0)return a}return null}(e);if(null===t||"presentation"===t){var a=function(e){var t=i[n(e)];if(void 0!==t)return t;switch(n(e)){case"a":case"area":case"link":if(e.hasAttribute("href"))return"link";break;case"img":return""!==e.getAttribute("alt")||s(e,"img")?"img":"presentation";case"input":var a=e.type;switch(a){case"button":case"image":case"reset":case"submit":return"button";case"checkbox":case"radio":return a;case"range":return"slider";case"email":case"tel":case"text":case"url":return e.hasAttribute("list")?"combobox":"textbox";case"search":return e.hasAttribute("list")?"combobox":"searchbox";case"number":return"spinbutton";default:return null}case"select":return e.hasAttribute("multiple")||e.size>1?"listbox":"combobox"}return null}(e);if("presentation"!==t||s(e,a||""))return a}return t},t.getLocalName=n;var i={article:"article",aside:"complementary",button:"button",datalist:"listbox",dd:"definition",details:"group",dialog:"dialog",dt:"term",fieldset:"group",figure:"figure",form:"form",footer:"contentinfo",h1:"heading",h2:"heading",h3:"heading",h4:"heading",h5:"heading",h6:"heading",header:"banner",hr:"separator",html:"document",legend:"legend",li:"listitem",math:"math",main:"main",menu:"list",nav:"navigation",ol:"list",optgroup:"group",option:"option",output:"status",progress:"progressbar",section:"region",summary:"button",table:"table",tbody:"rowgroup",textarea:"textbox",tfoot:"rowgroup",td:"cell",th:"columnheader",thead:"rowgroup",tr:"row",ul:"list"},r={caption:new Set(["aria-label","aria-labelledby"]),code:new Set(["aria-label","aria-labelledby"]),deletion:new Set(["aria-label","aria-labelledby"]),emphasis:new Set(["aria-label","aria-labelledby"]),generic:new Set(["aria-label","aria-labelledby","aria-roledescription"]),insertion:new Set(["aria-label","aria-labelledby"]),paragraph:new Set(["aria-label","aria-labelledby"]),presentation:new Set(["aria-label","aria-labelledby"]),strong:new Set(["aria-label","aria-labelledby"]),subscript:new Set(["aria-label","aria-labelledby"]),superscript:new Set(["aria-label","aria-labelledby"])};function s(e,t){return function(e,t){return["aria-atomic","aria-busy","aria-controls","aria-current","aria-describedby","aria-details","aria-dropeffect","aria-flowto","aria-grabbed","aria-hidden","aria-keyshortcuts","aria-label","aria-labelledby","aria-live","aria-owns","aria-relevant","aria-roledescription"].some((function(a){var n;return e.hasAttribute(a)&&!(null!==(n=r[t])&&void 0!==n&&n.has(a))}))}(e,t)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.roleElements=t.elementRoles=t.roles=t.dom=t.aria=void 0;var n=l(a(1165)),i=l(a(1166)),r=l(a(583)),s=l(a(1303)),o=l(a(1304));function l(e){return e&&e.__esModule?e:{default:e}}var c=n.default;t.aria=c;var u=i.default;t.dom=u;var d=r.default;t.roles=d;var p=s.default;t.elementRoles=p;var m=o.default;t.roleElements=m},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(140),i=a(5);t.default=function(e){void 0===e&&(e={});var t=i.useState(e),a=t[0],r=t[1],s=i.useMemo((function(){return{set:function(e,t){r((function(a){var i;return n.__assign(n.__assign({},a),((i={})[e]=t,i))}))},setAll:function(e){r(e)},remove:function(e){r((function(t){var a=t,i=e;return a[i],n.__rest(a,["symbol"==typeof i?i:i+""])}))},reset:function(){return r(e)}}}),[r]),o=n.__assign({get:i.useCallback((function(e){return a[e]}),[a])},s);return[a,o]}},function(e,t,a){e.exports=function e(t,a,n){function i(s,o){if(!a[s]){if(!t[s]){if(r)return r(s,!0);throw new Error("Cannot find module '"+s+"'")}var l=a[s]={exports:{}};t[s][0].call(l.exports,(function(e){return i(t[s][1][e]||e)}),l,l.exports,e,t,a,n)}return a[s].exports}for(var r=!1,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(e,t,a){(function(n,i,r,s,o,l,c,u,d){"use strict";function p(e,t){return function(e,t){var a;if(void 0===(a="passthrough"!==t.algorithm?h.createHash(t.algorithm):new b).write&&(a.write=a.update,a.end=a.update),f(t,a).dispatch(e),a.update||a.end(""),a.digest)return a.digest("buffer"===t.encoding?void 0:t.encoding);var n=a.read();return"buffer"===t.encoding?n:n.toString(t.encoding)}(e,t=m(e,t))}function m(e,t){if((t=t||{}).algorithm=t.algorithm||"sha1",t.encoding=t.encoding||"hex",t.excludeValues=!!t.excludeValues,t.algorithm=t.algorithm.toLowerCase(),t.encoding=t.encoding.toLowerCase(),t.ignoreUnknown=!0===t.ignoreUnknown,t.respectType=!1!==t.respectType,t.respectFunctionNames=!1!==t.respectFunctionNames,t.respectFunctionProperties=!1!==t.respectFunctionProperties,t.unorderedArrays=!0===t.unorderedArrays,t.unorderedSets=!1!==t.unorderedSets,t.unorderedObjects=!1!==t.unorderedObjects,t.replacer=t.replacer||void 0,t.excludeKeys=t.excludeKeys||void 0,void 0===e)throw new Error("Object argument required.");for(var a=0;a<y.length;++a)y[a].toLowerCase()===t.algorithm.toLowerCase()&&(t.algorithm=y[a]);if(-1===y.indexOf(t.algorithm))throw new Error('Algorithm "'+t.algorithm+'"  not supported. supported values: '+y.join(", "));if(-1===E.indexOf(t.encoding)&&"passthrough"!==t.algorithm)throw new Error('Encoding "'+t.encoding+'"  not supported. supported values: '+E.join(", "));return t}function g(e){return"function"==typeof e&&null!=/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(e))}function f(e,t,a){a=a||[];var n=function(e){return t.update?t.update(e,"utf8"):t.write(e,"utf8")};return{dispatch:function(t){e.replacer&&(t=e.replacer(t));var a=typeof t;return null===t&&(a="null"),this["_"+a](t)},_object:function(t){var i=Object.prototype.toString.call(t),s=/\[object (.*)\]/i.exec(i);s=(s=s?s[1]:"unknown:["+i+"]").toLowerCase();var o;if((o=a.indexOf(t))>=0)return this.dispatch("[CIRCULAR:"+o+"]");if(a.push(t),void 0!==r&&r.isBuffer&&r.isBuffer(t))return n("buffer:"),n(t);if("object"===s||"function"===s){var l=Object.keys(t);e.unorderedObjects&&(l=l.sort()),!1===e.respectType||g(t)||l.splice(0,0,"prototype","__proto__","constructor"),e.excludeKeys&&(l=l.filter((function(t){return!e.excludeKeys(t)}))),n("object:"+l.length+":");var c=this;return l.forEach((function(a){c.dispatch(a),n(":"),e.excludeValues||c.dispatch(t[a]),n(",")}))}if(!this["_"+s]){if(e.ignoreUnknown)return n("["+s+"]");throw new Error('Unknown object type "'+s+'"')}this["_"+s](t)},_array:function(t,i){i=void 0!==i?i:!1!==e.unorderedArrays;var r=this;if(n("array:"+t.length+":"),!i||t.length<=1)return t.forEach((function(e){return r.dispatch(e)}));var s=[],o=t.map((function(t){var n=new b,i=a.slice();return f(e,n,i).dispatch(t),s=s.concat(i.slice(a.length)),n.read().toString()}));return a=a.concat(s),o.sort(),this._array(o,!1)},_date:function(e){return n("date:"+e.toJSON())},_symbol:function(e){return n("symbol:"+e.toString())},_error:function(e){return n("error:"+e.toString())},_boolean:function(e){return n("bool:"+e.toString())},_string:function(e){n("string:"+e.length+":"),n(e.toString())},_function:function(t){n("fn:"),g(t)?this.dispatch("[native]"):this.dispatch(t.toString()),!1!==e.respectFunctionNames&&this.dispatch("function-name:"+String(t.name)),e.respectFunctionProperties&&this._object(t)},_number:function(e){return n("number:"+e.toString())},_xml:function(e){return n("xml:"+e.toString())},_null:function(){return n("Null")},_undefined:function(){return n("Undefined")},_regexp:function(e){return n("regex:"+e.toString())},_uint8array:function(e){return n("uint8array:"),this.dispatch(Array.prototype.slice.call(e))},_uint8clampedarray:function(e){return n("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(e))},_int8array:function(e){return n("uint8array:"),this.dispatch(Array.prototype.slice.call(e))},_uint16array:function(e){return n("uint16array:"),this.dispatch(Array.prototype.slice.call(e))},_int16array:function(e){return n("uint16array:"),this.dispatch(Array.prototype.slice.call(e))},_uint32array:function(e){return n("uint32array:"),this.dispatch(Array.prototype.slice.call(e))},_int32array:function(e){return n("uint32array:"),this.dispatch(Array.prototype.slice.call(e))},_float32array:function(e){return n("float32array:"),this.dispatch(Array.prototype.slice.call(e))},_float64array:function(e){return n("float64array:"),this.dispatch(Array.prototype.slice.call(e))},_arraybuffer:function(e){return n("arraybuffer:"),this.dispatch(new Uint8Array(e))},_url:function(e){return n("url:"+e.toString())},_map:function(t){n("map:");var a=Array.from(t);return this._array(a,!1!==e.unorderedSets)},_set:function(t){n("set:");var a=Array.from(t);return this._array(a,!1!==e.unorderedSets)},_blob:function(){if(e.ignoreUnknown)return n("[blob]");throw Error('Hashing Blob objects is currently not supported\n(see https://github.com/puleos/object-hash/issues/26)\nUse "options.replacer" or "options.ignoreUnknown"\n')},_domwindow:function(){return n("domwindow")},_process:function(){return n("process")},_timer:function(){return n("timer")},_pipe:function(){return n("pipe")},_tcp:function(){return n("tcp")},_udp:function(){return n("udp")},_tty:function(){return n("tty")},_statwatcher:function(){return n("statwatcher")},_securecontext:function(){return n("securecontext")},_connection:function(){return n("connection")},_zlib:function(){return n("zlib")},_context:function(){return n("context")},_nodescript:function(){return n("nodescript")},_httpparser:function(){return n("httpparser")},_dataview:function(){return n("dataview")},_signal:function(){return n("signal")},_fsevent:function(){return n("fsevent")},_tlswrap:function(){return n("tlswrap")}}}function b(){return{buf:"",write:function(e){this.buf+=e},end:function(e){this.buf+=e},read:function(){return this.buf}}}var h=e("crypto");(a=t.exports=p).sha1=function(e){return p(e)},a.keys=function(e){return p(e,{excludeValues:!0,algorithm:"sha1",encoding:"hex"})},a.MD5=function(e){return p(e,{algorithm:"md5",encoding:"hex"})},a.keysMD5=function(e){return p(e,{algorithm:"md5",encoding:"hex",excludeValues:!0})};var y=h.getHashes?h.getHashes().slice():["sha1","md5"];y.push("passthrough");var E=["buffer","hex","binary","base64"];a.writeToStream=function(e,t,a){return void 0===a&&(a=t,t={}),f(t=m(e,t),a).dispatch(e)}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/fake_e8180ef5.js","/")},{buffer:3,crypto:5,lYpoI2:10}],2:[function(e,t,a){(function(e,t,n,i,r,s,o,l,c){!function(e){"use strict";function t(e){var t=e.charCodeAt(0);return t===n||t===l?62:t===i||t===c?63:t<r?-1:t<r+10?t-r+26+26:t<o+26?t-o:t<s+26?t-s+26:void 0}var a="undefined"!=typeof Uint8Array?Uint8Array:Array,n="+".charCodeAt(0),i="/".charCodeAt(0),r="0".charCodeAt(0),s="a".charCodeAt(0),o="A".charCodeAt(0),l="-".charCodeAt(0),c="_".charCodeAt(0);e.toByteArray=function(e){function n(e){c[d++]=e}var i,r,s,o,l,c;if(e.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var u=e.length;l="="===e.charAt(u-2)?2:"="===e.charAt(u-1)?1:0,c=new a(3*e.length/4-l),s=l>0?e.length-4:e.length;var d=0;for(i=0,r=0;i<s;i+=4,r+=3)n((16711680&(o=t(e.charAt(i))<<18|t(e.charAt(i+1))<<12|t(e.charAt(i+2))<<6|t(e.charAt(i+3))))>>16),n((65280&o)>>8),n(255&o);return 2===l?n(255&(o=t(e.charAt(i))<<2|t(e.charAt(i+1))>>4)):1===l&&(n((o=t(e.charAt(i))<<10|t(e.charAt(i+1))<<4|t(e.charAt(i+2))>>2)>>8&255),n(255&o)),c},e.fromByteArray=function(e){function t(e){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e)}function a(e){return t(e>>18&63)+t(e>>12&63)+t(e>>6&63)+t(63&e)}var n,i,r,s=e.length%3,o="";for(n=0,r=e.length-s;n<r;n+=3)o+=a(i=(e[n]<<16)+(e[n+1]<<8)+e[n+2]);switch(s){case 1:o+=t((i=e[e.length-1])>>2),o+=t(i<<4&63),o+="==";break;case 2:o+=t((i=(e[e.length-2]<<8)+e[e.length-1])>>10),o+=t(i>>4&63),o+=t(i<<2&63),o+="="}return o}}(void 0===a?this.base64js={}:a)}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/base64-js/lib/b64.js","/node_modules/gulp-browserify/node_modules/base64-js/lib")},{buffer:3,lYpoI2:10}],3:[function(e,t,a){(function(t,n,i,r,s,o,l,c,u){function i(e,t,a){if(!(this instanceof i))return new i(e,t,a);var n,r,s,o=typeof e;if("base64"===t&&"string"===o)for(e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e);e.length%4!=0;)e+="=";if("number"===o)n=M(e);else if("string"===o)n=i.byteLength(e,t);else{if("object"!==o)throw new Error("First argument needs to be a number, array or string.");n=M(e.length)}if(i._useTypedArrays?r=i._augment(new Uint8Array(n)):((r=this).length=n,r._isBuffer=!0),i._useTypedArrays&&"number"==typeof e.byteLength)r._set(e);else if(function(e){return A(e)||i.isBuffer(e)||e&&"object"==typeof e&&"number"==typeof e.length}(e))for(s=0;s<n;s++)i.isBuffer(e)?r[s]=e.readUInt8(s):r[s]=e[s];else if("string"===o)r.write(e,0,t);else if("number"===o&&!i._useTypedArrays&&!a)for(s=0;s<n;s++)r[s]=0;return r}function d(e,t,a,n){a=Number(a)||0;var r=e.length-a;n?(n=Number(n))>r&&(n=r):n=r;var s=t.length;B(s%2==0,"Invalid hex string"),n>s/2&&(n=s/2);for(var o=0;o<n;o++){var l=parseInt(t.substr(2*o,2),16);B(!isNaN(l),"Invalid hex string"),e[a+o]=l}return i._charsWritten=2*o,o}function p(e,t,a,n){return i._charsWritten=R(q(t),e,a,n)}function m(e,t,a,n){return i._charsWritten=R(function(e){for(var t=[],a=0;a<e.length;a++)t.push(255&e.charCodeAt(a));return t}(t),e,a,n)}function g(e,t,a,n){return i._charsWritten=R(P(t),e,a,n)}function f(e,t,a,n){return i._charsWritten=R(function(e){for(var t,a,n,i=[],r=0;r<e.length;r++)a=(t=e.charCodeAt(r))>>8,n=t%256,i.push(n),i.push(a);return i}(t),e,a,n)}function b(e,t,a){var n="";a=Math.min(e.length,a);for(var i=t;i<a;i++)n+=String.fromCharCode(e[i]);return n}function h(e,t,a,n){n||(B("boolean"==typeof a,"missing or invalid endian"),B(null!=t,"missing offset"),B(t+1<e.length,"Trying to read beyond buffer length"));var i,r=e.length;if(!(t>=r))return a?(i=e[t],t+1<r&&(i|=e[t+1]<<8)):(i=e[t]<<8,t+1<r&&(i|=e[t+1])),i}function y(e,t,a,n){n||(B("boolean"==typeof a,"missing or invalid endian"),B(null!=t,"missing offset"),B(t+3<e.length,"Trying to read beyond buffer length"));var i,r=e.length;if(!(t>=r))return a?(t+2<r&&(i=e[t+2]<<16),t+1<r&&(i|=e[t+1]<<8),i|=e[t],t+3<r&&(i+=e[t+3]<<24>>>0)):(t+1<r&&(i=e[t+1]<<16),t+2<r&&(i|=e[t+2]<<8),t+3<r&&(i|=e[t+3]),i+=e[t]<<24>>>0),i}function E(e,t,a,n){if(n||(B("boolean"==typeof a,"missing or invalid endian"),B(null!=t,"missing offset"),B(t+1<e.length,"Trying to read beyond buffer length")),!(t>=e.length)){var i=h(e,t,a,!0);return 32768&i?-1*(65535-i+1):i}}function v(e,t,a,n){if(n||(B("boolean"==typeof a,"missing or invalid endian"),B(null!=t,"missing offset"),B(t+3<e.length,"Trying to read beyond buffer length")),!(t>=e.length)){var i=y(e,t,a,!0);return 2147483648&i?-1*(4294967295-i+1):i}}function T(e,t,a,n){return n||(B("boolean"==typeof a,"missing or invalid endian"),B(t+3<e.length,"Trying to read beyond buffer length")),U.read(e,t,a,23,4)}function k(e,t,a,n){return n||(B("boolean"==typeof a,"missing or invalid endian"),B(t+7<e.length,"Trying to read beyond buffer length")),U.read(e,t,a,52,8)}function x(e,t,a,n,i){i||(B(null!=t,"missing value"),B("boolean"==typeof n,"missing or invalid endian"),B(null!=a,"missing offset"),B(a+1<e.length,"trying to write beyond buffer length"),F(t,65535));var r=e.length;if(!(a>=r))for(var s=0,o=Math.min(r-a,2);s<o;s++)e[a+s]=(t&255<<8*(n?s:1-s))>>>8*(n?s:1-s)}function S(e,t,a,n,i){i||(B(null!=t,"missing value"),B("boolean"==typeof n,"missing or invalid endian"),B(null!=a,"missing offset"),B(a+3<e.length,"trying to write beyond buffer length"),F(t,4294967295));var r=e.length;if(!(a>=r))for(var s=0,o=Math.min(r-a,4);s<o;s++)e[a+s]=t>>>8*(n?s:3-s)&255}function O(e,t,a,n,i){i||(B(null!=t,"missing value"),B("boolean"==typeof n,"missing or invalid endian"),B(null!=a,"missing offset"),B(a+1<e.length,"Trying to write beyond buffer length"),L(t,32767,-32768)),a>=e.length||x(e,t>=0?t:65535+t+1,a,n,i)}function w(e,t,a,n,i){i||(B(null!=t,"missing value"),B("boolean"==typeof n,"missing or invalid endian"),B(null!=a,"missing offset"),B(a+3<e.length,"Trying to write beyond buffer length"),L(t,2147483647,-2147483648)),a>=e.length||S(e,t>=0?t:4294967295+t+1,a,n,i)}function j(e,t,a,n,i){i||(B(null!=t,"missing value"),B("boolean"==typeof n,"missing or invalid endian"),B(null!=a,"missing offset"),B(a+3<e.length,"Trying to write beyond buffer length"),N(t,34028234663852886e22,-34028234663852886e22)),a>=e.length||U.write(e,t,a,n,23,4)}function C(e,t,a,n,i){i||(B(null!=t,"missing value"),B("boolean"==typeof n,"missing or invalid endian"),B(null!=a,"missing offset"),B(a+7<e.length,"Trying to write beyond buffer length"),N(t,17976931348623157e292,-17976931348623157e292)),a>=e.length||U.write(e,t,a,n,52,8)}function I(e,t,a){return"number"!=typeof e?a:(e=~~e)>=t?t:e>=0||(e+=t)>=0?e:0}function M(e){return(e=~~Math.ceil(+e))<0?0:e}function A(e){return(Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)})(e)}function D(e){return e<16?"0"+e.toString(16):e.toString(16)}function q(e){for(var t=[],a=0;a<e.length;a++){var n=e.charCodeAt(a);if(n<=127)t.push(e.charCodeAt(a));else{var i=a;n>=55296&&n<=57343&&a++;for(var r=encodeURIComponent(e.slice(i,a+1)).substr(1).split("%"),s=0;s<r.length;s++)t.push(parseInt(r[s],16))}}return t}function P(e){return z.toByteArray(e)}function R(e,t,a,n){for(var i=0;i<n&&!(i+a>=t.length||i>=e.length);i++)t[i+a]=e[i];return i}function _(e){try{return decodeURIComponent(e)}catch(e){return String.fromCharCode(65533)}}function F(e,t){B("number"==typeof e,"cannot write a non-number as a number"),B(e>=0,"specified a negative value for writing an unsigned value"),B(e<=t,"value is larger than maximum value for type"),B(Math.floor(e)===e,"value has a fractional component")}function L(e,t,a){B("number"==typeof e,"cannot write a non-number as a number"),B(e<=t,"value larger than maximum allowed value"),B(e>=a,"value smaller than minimum allowed value"),B(Math.floor(e)===e,"value has a fractional component")}function N(e,t,a){B("number"==typeof e,"cannot write a non-number as a number"),B(e<=t,"value larger than maximum allowed value"),B(e>=a,"value smaller than minimum allowed value")}function B(e,t){if(!e)throw new Error(t||"Failed assertion")}var z=e("base64-js"),U=e("ieee754");a.Buffer=i,a.SlowBuffer=i,a.INSPECT_MAX_BYTES=50,i.poolSize=8192,i._useTypedArrays=function(){try{var e=new ArrayBuffer(0),t=new Uint8Array(e);return t.foo=function(){return 42},42===t.foo()&&"function"==typeof t.subarray}catch(e){return!1}}(),i.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},i.isBuffer=function(e){return!(null==e||!e._isBuffer)},i.byteLength=function(e,t){var a;switch(e+="",t||"utf8"){case"hex":a=e.length/2;break;case"utf8":case"utf-8":a=q(e).length;break;case"ascii":case"binary":case"raw":a=e.length;break;case"base64":a=P(e).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":a=2*e.length;break;default:throw new Error("Unknown encoding")}return a},i.concat=function(e,t){if(B(A(e),"Usage: Buffer.concat(list, [totalLength])\nlist should be an Array."),0===e.length)return new i(0);if(1===e.length)return e[0];var a;if("number"!=typeof t)for(t=0,a=0;a<e.length;a++)t+=e[a].length;var n=new i(t),r=0;for(a=0;a<e.length;a++){var s=e[a];s.copy(n,r),r+=s.length}return n},i.prototype.write=function(e,t,a,n){if(isFinite(t))isFinite(a)||(n=a,a=void 0);else{var i=n;n=t,t=a,a=i}t=Number(t)||0;var r,s=this.length-t;switch(a?(a=Number(a))>s&&(a=s):a=s,n=String(n||"utf8").toLowerCase()){case"hex":r=d(this,e,t,a);break;case"utf8":case"utf-8":r=p(this,e,t,a);break;case"ascii":r=m(this,e,t,a);break;case"binary":r=function(e,t,a,n){return m(e,t,a,n)}(this,e,t,a);break;case"base64":r=g(this,e,t,a);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":r=f(this,e,t,a);break;default:throw new Error("Unknown encoding")}return r},i.prototype.toString=function(e,t,a){var n,i=this;if(e=String(e||"utf8").toLowerCase(),t=Number(t)||0,(a=void 0!==a?Number(a):a=i.length)===t)return"";switch(e){case"hex":n=function(e,t,a){var n=e.length;(!t||t<0)&&(t=0),(!a||a<0||a>n)&&(a=n);for(var i="",r=t;r<a;r++)i+=D(e[r]);return i}(i,t,a);break;case"utf8":case"utf-8":n=function(e,t,a){var n="",i="";a=Math.min(e.length,a);for(var r=t;r<a;r++)e[r]<=127?(n+=_(i)+String.fromCharCode(e[r]),i=""):i+="%"+e[r].toString(16);return n+_(i)}(i,t,a);break;case"ascii":n=b(i,t,a);break;case"binary":n=function(e,t,a){return b(e,t,a)}(i,t,a);break;case"base64":n=function(e,t,a){return 0===t&&a===e.length?z.fromByteArray(e):z.fromByteArray(e.slice(t,a))}(i,t,a);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":n=function(e,t,a){for(var n=e.slice(t,a),i="",r=0;r<n.length;r+=2)i+=String.fromCharCode(n[r]+256*n[r+1]);return i}(i,t,a);break;default:throw new Error("Unknown encoding")}return n},i.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},i.prototype.copy=function(e,t,a,n){var r=this;if(a||(a=0),n||0===n||(n=this.length),t||(t=0),n!==a&&0!==e.length&&0!==r.length){B(n>=a,"sourceEnd < sourceStart"),B(t>=0&&t<e.length,"targetStart out of bounds"),B(a>=0&&a<r.length,"sourceStart out of bounds"),B(n>=0&&n<=r.length,"sourceEnd out of bounds"),n>this.length&&(n=this.length),e.length-t<n-a&&(n=e.length-t+a);var s=n-a;if(s<100||!i._useTypedArrays)for(var o=0;o<s;o++)e[o+t]=this[o+a];else e._set(this.subarray(a,a+s),t)}},i.prototype.slice=function(e,t){var a=this.length;if(e=I(e,a,0),t=I(t,a,a),i._useTypedArrays)return i._augment(this.subarray(e,t));for(var n=t-e,r=new i(n,void 0,!0),s=0;s<n;s++)r[s]=this[s+e];return r},i.prototype.get=function(e){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(e)},i.prototype.set=function(e,t){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(e,t)},i.prototype.readUInt8=function(e,t){if(t||(B(null!=e,"missing offset"),B(e<this.length,"Trying to read beyond buffer length")),!(e>=this.length))return this[e]},i.prototype.readUInt16LE=function(e,t){return h(this,e,!0,t)},i.prototype.readUInt16BE=function(e,t){return h(this,e,!1,t)},i.prototype.readUInt32LE=function(e,t){return y(this,e,!0,t)},i.prototype.readUInt32BE=function(e,t){return y(this,e,!1,t)},i.prototype.readInt8=function(e,t){if(t||(B(null!=e,"missing offset"),B(e<this.length,"Trying to read beyond buffer length")),!(e>=this.length))return 128&this[e]?-1*(255-this[e]+1):this[e]},i.prototype.readInt16LE=function(e,t){return E(this,e,!0,t)},i.prototype.readInt16BE=function(e,t){return E(this,e,!1,t)},i.prototype.readInt32LE=function(e,t){return v(this,e,!0,t)},i.prototype.readInt32BE=function(e,t){return v(this,e,!1,t)},i.prototype.readFloatLE=function(e,t){return T(this,e,!0,t)},i.prototype.readFloatBE=function(e,t){return T(this,e,!1,t)},i.prototype.readDoubleLE=function(e,t){return k(this,e,!0,t)},i.prototype.readDoubleBE=function(e,t){return k(this,e,!1,t)},i.prototype.writeUInt8=function(e,t,a){a||(B(null!=e,"missing value"),B(null!=t,"missing offset"),B(t<this.length,"trying to write beyond buffer length"),F(e,255)),t>=this.length||(this[t]=e)},i.prototype.writeUInt16LE=function(e,t,a){x(this,e,t,!0,a)},i.prototype.writeUInt16BE=function(e,t,a){x(this,e,t,!1,a)},i.prototype.writeUInt32LE=function(e,t,a){S(this,e,t,!0,a)},i.prototype.writeUInt32BE=function(e,t,a){S(this,e,t,!1,a)},i.prototype.writeInt8=function(e,t,a){a||(B(null!=e,"missing value"),B(null!=t,"missing offset"),B(t<this.length,"Trying to write beyond buffer length"),L(e,127,-128)),t>=this.length||(e>=0?this.writeUInt8(e,t,a):this.writeUInt8(255+e+1,t,a))},i.prototype.writeInt16LE=function(e,t,a){O(this,e,t,!0,a)},i.prototype.writeInt16BE=function(e,t,a){O(this,e,t,!1,a)},i.prototype.writeInt32LE=function(e,t,a){w(this,e,t,!0,a)},i.prototype.writeInt32BE=function(e,t,a){w(this,e,t,!1,a)},i.prototype.writeFloatLE=function(e,t,a){j(this,e,t,!0,a)},i.prototype.writeFloatBE=function(e,t,a){j(this,e,t,!1,a)},i.prototype.writeDoubleLE=function(e,t,a){C(this,e,t,!0,a)},i.prototype.writeDoubleBE=function(e,t,a){C(this,e,t,!1,a)},i.prototype.fill=function(e,t,a){if(e||(e=0),t||(t=0),a||(a=this.length),"string"==typeof e&&(e=e.charCodeAt(0)),B("number"==typeof e&&!isNaN(e),"value is not a number"),B(a>=t,"end < start"),a!==t&&0!==this.length){B(t>=0&&t<this.length,"start out of bounds"),B(a>=0&&a<=this.length,"end out of bounds");for(var n=t;n<a;n++)this[n]=e}},i.prototype.inspect=function(){for(var e=[],t=this.length,n=0;n<t;n++)if(e[n]=D(this[n]),n===a.INSPECT_MAX_BYTES){e[n+1]="...";break}return"<Buffer "+e.join(" ")+">"},i.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(i._useTypedArrays)return new i(this).buffer;for(var e=new Uint8Array(this.length),t=0,a=e.length;t<a;t+=1)e[t]=this[t];return e.buffer}throw new Error("Buffer.toArrayBuffer not supported in this browser")};var H=i.prototype;i._augment=function(e){return e._isBuffer=!0,e._get=e.get,e._set=e.set,e.get=H.get,e.set=H.set,e.write=H.write,e.toString=H.toString,e.toLocaleString=H.toString,e.toJSON=H.toJSON,e.copy=H.copy,e.slice=H.slice,e.readUInt8=H.readUInt8,e.readUInt16LE=H.readUInt16LE,e.readUInt16BE=H.readUInt16BE,e.readUInt32LE=H.readUInt32LE,e.readUInt32BE=H.readUInt32BE,e.readInt8=H.readInt8,e.readInt16LE=H.readInt16LE,e.readInt16BE=H.readInt16BE,e.readInt32LE=H.readInt32LE,e.readInt32BE=H.readInt32BE,e.readFloatLE=H.readFloatLE,e.readFloatBE=H.readFloatBE,e.readDoubleLE=H.readDoubleLE,e.readDoubleBE=H.readDoubleBE,e.writeUInt8=H.writeUInt8,e.writeUInt16LE=H.writeUInt16LE,e.writeUInt16BE=H.writeUInt16BE,e.writeUInt32LE=H.writeUInt32LE,e.writeUInt32BE=H.writeUInt32BE,e.writeInt8=H.writeInt8,e.writeInt16LE=H.writeInt16LE,e.writeInt16BE=H.writeInt16BE,e.writeInt32LE=H.writeInt32LE,e.writeInt32BE=H.writeInt32BE,e.writeFloatLE=H.writeFloatLE,e.writeFloatBE=H.writeFloatBE,e.writeDoubleLE=H.writeDoubleLE,e.writeDoubleBE=H.writeDoubleBE,e.fill=H.fill,e.inspect=H.inspect,e.toArrayBuffer=H.toArrayBuffer,e}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/buffer/index.js","/node_modules/gulp-browserify/node_modules/buffer")},{"base64-js":2,buffer:3,ieee754:11,lYpoI2:10}],4:[function(e,t,a){(function(a,n,i,r,s,o,l,c,u){i=e("buffer").Buffer;var d=4,p=new i(d);p.fill(0);var m=8;t.exports={hash:function(e,t,a,n){return i.isBuffer(e)||(e=new i(e)),function(e,t,a){for(var n=new i(t),r=a?n.writeInt32BE:n.writeInt32LE,s=0;s<e.length;s++)r.call(n,e[s],4*s,!0);return n}(t(function(e,t){if(e.length%d!=0){var a=e.length+(d-e.length%d);e=i.concat([e,p],a)}for(var n=[],r=t?e.readInt32BE:e.readInt32LE,s=0;s<e.length;s+=d)n.push(r.call(e,s));return n}(e,n),e.length*m),a,n)}}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/helpers.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:10}],5:[function(e,t,a){(function(t,n,i,r,s,o,l,c,u){function d(e,t){var a=b[e=e||"sha1"],n=[];return a||p("algorithm:",e,"is not yet supported"),{update:function(e){return i.isBuffer(e)||(e=new i(e)),n.push(e),e.length,this},digest:function(e){var r=i.concat(n),s=t?function(e,t,a){i.isBuffer(t)||(t=new i(t)),i.isBuffer(a)||(a=new i(a)),t.length>h?t=e(t):t.length<h&&(t=i.concat([t,y],h));for(var n=new i(h),r=new i(h),s=0;s<h;s++)n[s]=54^t[s],r[s]=92^t[s];var o=e(i.concat([n,a]));return e(i.concat([r,o]))}(a,t,r):a(r);return n=null,e?s.toString(e):s}}}function p(){var e=[].slice.call(arguments).join(" ");throw new Error([e,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join("\n"))}i=e("buffer").Buffer;var m=e("./sha"),g=e("./sha256"),f=e("./rng"),b={sha1:m,sha256:g,md5:e("./md5")},h=64,y=new i(h);y.fill(0),a.createHash=function(e){return d(e)},a.createHmac=function(e,t){return d(e,t)},a.randomBytes=function(e,t){if(!t||!t.call)return new i(f(e));try{t.call(this,void 0,new i(f(e)))}catch(e){t(e)}},function(e,t){for(var a in e)t(e[a],a)}(["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"],(function(e){a[e]=function(){p("sorry,",e,"is not implemented yet")}}))}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/index.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./md5":6,"./rng":7,"./sha":8,"./sha256":9,buffer:3,lYpoI2:10}],6:[function(e,t,a){(function(a,n,i,r,s,o,l,c,u){function d(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var a=1732584193,n=-271733879,i=-1732584194,r=271733878,s=0;s<e.length;s+=16){var o=a,l=n,c=i,u=r;a=m(a,n,i,r,e[s+0],7,-680876936),r=m(r,a,n,i,e[s+1],12,-389564586),i=m(i,r,a,n,e[s+2],17,606105819),n=m(n,i,r,a,e[s+3],22,-1044525330),a=m(a,n,i,r,e[s+4],7,-176418897),r=m(r,a,n,i,e[s+5],12,1200080426),i=m(i,r,a,n,e[s+6],17,-1473231341),n=m(n,i,r,a,e[s+7],22,-45705983),a=m(a,n,i,r,e[s+8],7,1770035416),r=m(r,a,n,i,e[s+9],12,-1958414417),i=m(i,r,a,n,e[s+10],17,-42063),n=m(n,i,r,a,e[s+11],22,-1990404162),a=m(a,n,i,r,e[s+12],7,1804603682),r=m(r,a,n,i,e[s+13],12,-40341101),i=m(i,r,a,n,e[s+14],17,-1502002290),a=g(a,n=m(n,i,r,a,e[s+15],22,1236535329),i,r,e[s+1],5,-165796510),r=g(r,a,n,i,e[s+6],9,-1069501632),i=g(i,r,a,n,e[s+11],14,643717713),n=g(n,i,r,a,e[s+0],20,-373897302),a=g(a,n,i,r,e[s+5],5,-701558691),r=g(r,a,n,i,e[s+10],9,38016083),i=g(i,r,a,n,e[s+15],14,-660478335),n=g(n,i,r,a,e[s+4],20,-405537848),a=g(a,n,i,r,e[s+9],5,568446438),r=g(r,a,n,i,e[s+14],9,-1019803690),i=g(i,r,a,n,e[s+3],14,-187363961),n=g(n,i,r,a,e[s+8],20,1163531501),a=g(a,n,i,r,e[s+13],5,-1444681467),r=g(r,a,n,i,e[s+2],9,-51403784),i=g(i,r,a,n,e[s+7],14,1735328473),a=f(a,n=g(n,i,r,a,e[s+12],20,-1926607734),i,r,e[s+5],4,-378558),r=f(r,a,n,i,e[s+8],11,-2022574463),i=f(i,r,a,n,e[s+11],16,1839030562),n=f(n,i,r,a,e[s+14],23,-35309556),a=f(a,n,i,r,e[s+1],4,-1530992060),r=f(r,a,n,i,e[s+4],11,1272893353),i=f(i,r,a,n,e[s+7],16,-155497632),n=f(n,i,r,a,e[s+10],23,-1094730640),a=f(a,n,i,r,e[s+13],4,681279174),r=f(r,a,n,i,e[s+0],11,-358537222),i=f(i,r,a,n,e[s+3],16,-722521979),n=f(n,i,r,a,e[s+6],23,76029189),a=f(a,n,i,r,e[s+9],4,-640364487),r=f(r,a,n,i,e[s+12],11,-421815835),i=f(i,r,a,n,e[s+15],16,530742520),a=b(a,n=f(n,i,r,a,e[s+2],23,-995338651),i,r,e[s+0],6,-198630844),r=b(r,a,n,i,e[s+7],10,1126891415),i=b(i,r,a,n,e[s+14],15,-1416354905),n=b(n,i,r,a,e[s+5],21,-57434055),a=b(a,n,i,r,e[s+12],6,1700485571),r=b(r,a,n,i,e[s+3],10,-1894986606),i=b(i,r,a,n,e[s+10],15,-1051523),n=b(n,i,r,a,e[s+1],21,-2054922799),a=b(a,n,i,r,e[s+8],6,1873313359),r=b(r,a,n,i,e[s+15],10,-30611744),i=b(i,r,a,n,e[s+6],15,-1560198380),n=b(n,i,r,a,e[s+13],21,1309151649),a=b(a,n,i,r,e[s+4],6,-145523070),r=b(r,a,n,i,e[s+11],10,-1120210379),i=b(i,r,a,n,e[s+2],15,718787259),n=b(n,i,r,a,e[s+9],21,-343485551),a=h(a,o),n=h(n,l),i=h(i,c),r=h(r,u)}return Array(a,n,i,r)}function p(e,t,a,n,i,r){return h(function(e,t){return e<<t|e>>>32-t}(h(h(t,e),h(n,r)),i),a)}function m(e,t,a,n,i,r,s){return p(t&a|~t&n,e,t,i,r,s)}function g(e,t,a,n,i,r,s){return p(t&n|a&~n,e,t,i,r,s)}function f(e,t,a,n,i,r,s){return p(t^a^n,e,t,i,r,s)}function b(e,t,a,n,i,r,s){return p(a^(t|~n),e,t,i,r,s)}function h(e,t){var a=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(a>>16)<<16|65535&a}var y=e("./helpers");t.exports=function(e){return y.hash(e,d,16)}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/md5.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:10}],7:[function(e,t,a){(function(e,a,n,i,r,s,o,l,c){!function(){var e,a;e=function(e){for(var t,a=new Array(e),n=0;n<e;n++)0==(3&n)&&(t=4294967296*Math.random()),a[n]=t>>>((3&n)<<3)&255;return a},this.crypto&&crypto.getRandomValues&&(a=function(e){var t=new Uint8Array(e);return crypto.getRandomValues(t),t}),t.exports=a||e}()}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/rng.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:10}],8:[function(e,t,a){(function(a,n,i,r,s,o,l,c,u){function d(e,t){e[t>>5]|=128<<24-t%32,e[15+(t+64>>9<<4)]=t;for(var a=Array(80),n=1732584193,i=-271733879,r=-1732584194,s=271733878,o=-1009589776,l=0;l<e.length;l+=16){for(var c=n,u=i,d=r,b=s,h=o,y=0;y<80;y++){a[y]=y<16?e[l+y]:f(a[y-3]^a[y-8]^a[y-14]^a[y-16],1);var E=g(g(f(n,5),p(y,i,r,s)),g(g(o,a[y]),m(y)));o=s,s=r,r=f(i,30),i=n,n=E}n=g(n,c),i=g(i,u),r=g(r,d),s=g(s,b),o=g(o,h)}return Array(n,i,r,s,o)}function p(e,t,a,n){return e<20?t&a|~t&n:e<40?t^a^n:e<60?t&a|t&n|a&n:t^a^n}function m(e){return e<20?1518500249:e<40?1859775393:e<60?-1894007588:-899497514}function g(e,t){var a=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(a>>16)<<16|65535&a}function f(e,t){return e<<t|e>>>32-t}var b=e("./helpers");t.exports=function(e){return b.hash(e,d,20,!0)}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:10}],9:[function(e,t,a){(function(a,n,i,r,s,o,l,c,u){var d=e("./helpers"),p=function(e,t){var a=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(a>>16)<<16|65535&a},m=function(e,t){return e>>>t|e<<32-t},g=function(e,t){return e>>>t},f=function(e,t,a){return e&t^~e&a},b=function(e,t,a){return e&t^e&a^t&a},h=function(e){return m(e,2)^m(e,13)^m(e,22)},y=function(e){return m(e,6)^m(e,11)^m(e,25)},E=function(e){return m(e,7)^m(e,18)^g(e,3)},v=function(e){return m(e,17)^m(e,19)^g(e,10)},T=function(e,t){var a,n,i,r,s,o,l,c,u,d,m=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),g=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),T=new Array(64);e[t>>5]|=128<<24-t%32,e[15+(t+64>>9<<4)]=t;for(var k=0;k<e.length;k+=16){a=g[0],n=g[1],i=g[2],r=g[3],s=g[4],o=g[5],l=g[6],c=g[7];for(var x=0;x<64;x++)T[x]=x<16?e[x+k]:p(p(p(v(T[x-2]),T[x-7]),E(T[x-15])),T[x-16]),u=p(p(p(p(c,y(s)),f(s,o,l)),m[x]),T[x]),d=p(h(a),b(a,n,i)),c=l,l=o,o=s,s=p(r,u),r=i,i=n,n=a,a=p(u,d);g[0]=p(a,g[0]),g[1]=p(n,g[1]),g[2]=p(i,g[2]),g[3]=p(r,g[3]),g[4]=p(s,g[4]),g[5]=p(o,g[5]),g[6]=p(l,g[6]),g[7]=p(c,g[7])}return g};t.exports=function(e){return d.hash(e,T,32,!0)}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha256.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:10}],10:[function(e,t,a){(function(e,a,n,i,r,s,o,l,c){function u(){}(e=t.exports={}).nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};if(t){var a=[];return window.addEventListener("message",(function(e){var t=e.source;(t===window||null===t)&&"process-tick"===e.data&&(e.stopPropagation(),a.length>0)&&a.shift()()}),!0),function(e){a.push(e),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),e.title="browser",e.browser=!0,e.env={},e.argv=[],e.on=u,e.addListener=u,e.once=u,e.off=u,e.removeListener=u,e.removeAllListeners=u,e.emit=u,e.binding=function(e){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(e){throw new Error("process.chdir is not supported")}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/process/browser.js","/node_modules/gulp-browserify/node_modules/process")},{buffer:3,lYpoI2:10}],11:[function(e,t,a){(function(e,t,n,i,r,s,o,l,c){a.read=function(e,t,a,n,i){var r,s,o=8*i-n-1,l=(1<<o)-1,c=l>>1,u=-7,d=a?i-1:0,p=a?-1:1,m=e[t+d];for(d+=p,r=m&(1<<-u)-1,m>>=-u,u+=o;u>0;r=256*r+e[t+d],d+=p,u-=8);for(s=r&(1<<-u)-1,r>>=-u,u+=n;u>0;s=256*s+e[t+d],d+=p,u-=8);if(0===r)r=1-c;else{if(r===l)return s?NaN:1/0*(m?-1:1);s+=Math.pow(2,n),r-=c}return(m?-1:1)*s*Math.pow(2,r-n)},a.write=function(e,t,a,n,i,r){var s,o,l,c=8*r-i-1,u=(1<<c)-1,d=u>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,m=n?0:r-1,g=n?1:-1,f=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,s=u):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),(t+=s+d>=1?p/l:p*Math.pow(2,1-d))*l>=2&&(s++,l/=2),s+d>=u?(o=0,s=u):s+d>=1?(o=(t*l-1)*Math.pow(2,i),s+=d):(o=t*Math.pow(2,d-1)*Math.pow(2,i),s=0));i>=8;e[a+m]=255&o,m+=g,o/=256,i-=8);for(s=s<<i|o,c+=i;c>0;e[a+m]=255&s,m+=g,s/=256,c-=8);e[a+m-g]|=128*f}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/ieee754/index.js","/node_modules/ieee754")},{buffer:3,lYpoI2:10}]},{},[1])(1)},function(e,t,a){const n=a(377);e.exports={re:n.re,src:n.src,tokens:n.t,SEMVER_SPEC_VERSION:a(459).SEMVER_SPEC_VERSION,SemVer:a(243),compareIdentifiers:a(545).compareIdentifiers,rcompareIdentifiers:a(545).rcompareIdentifiers,parse:a(384),valid:a(1031),clean:a(1032),inc:a(1033),diff:a(1034),major:a(1035),minor:a(1036),patch:a(1037),prerelease:a(1038),compare:a(264),rcompare:a(1039),compareLoose:a(1040),compareBuild:a(566),sort:a(1041),rsort:a(1042),gt:a(475),lt:a(567),eq:a(565),neq:a(771),gte:a(385),lte:a(411),cmp:a(772),coerce:a(773),Comparator:a(476),Range:a(279),satisfies:a(477),toComparators:a(1046),maxSatisfying:a(1047),minSatisfying:a(1048),minVersion:a(1049),validRange:a(1050),outside:a(568),gtr:a(1051),ltr:a(1052),intersects:a(1053),simplifyRange:a(1054),subset:a(1055)}},function(e,t,a){const n=a(384);e.exports=(e,t)=>{const a=n(e,t);return a?a.version:null}},function(e,t,a){const n=a(384);e.exports=(e,t)=>{const a=n(e.trim().replace(/^[=v]+/,""),t);return a?a.version:null}},function(e,t,a){const n=a(243);e.exports=(e,t,a,i)=>{"string"==typeof a&&(i=a,a=void 0);try{return new n(e,a).inc(t,i).version}catch(e){return null}}},function(e,t,a){const n=a(384),i=a(565);e.exports=(e,t)=>{if(i(e,t))return null;{const a=n(e),i=n(t),r=a.prerelease.length||i.prerelease.length,s=r?"pre":"",o=r?"prerelease":"";for(const e in a)if(("major"===e||"minor"===e||"patch"===e)&&a[e]!==i[e])return s+e;return o}}},function(e,t,a){const n=a(243);e.exports=(e,t)=>new n(e,t).major},function(e,t,a){const n=a(243);e.exports=(e,t)=>new n(e,t).minor},function(e,t,a){const n=a(243);e.exports=(e,t)=>new n(e,t).patch},function(e,t,a){const n=a(384);e.exports=(e,t)=>{const a=n(e,t);return a&&a.prerelease.length?a.prerelease:null}},function(e,t,a){const n=a(264);e.exports=(e,t,a)=>n(t,e,a)},function(e,t,a){const n=a(264);e.exports=(e,t)=>n(e,t,!0)},function(e,t,a){const n=a(566);e.exports=(e,t)=>e.sort(((e,a)=>n(e,a,t)))},function(e,t,a){const n=a(566);e.exports=(e,t)=>e.sort(((e,a)=>n(a,e,t)))},function(e,t,a){"use strict";const n=a(1044),i=Symbol("max"),r=Symbol("length"),s=Symbol("lengthCalculator"),o=Symbol("allowStale"),l=Symbol("maxAge"),c=Symbol("dispose"),u=Symbol("noDisposeOnSet"),d=Symbol("lruList"),p=Symbol("cache"),m=Symbol("updateAgeOnGet"),g=()=>1,f=(e,t,a)=>{const n=e[p].get(t);if(n){const t=n.value;if(b(e,t)){if(y(e,n),!e[o])return}else a&&(e[m]&&(n.value.now=Date.now()),e[d].unshiftNode(n));return t.value}},b=(e,t)=>{if(!t||!t.maxAge&&!e[l])return!1;const a=Date.now()-t.now;return t.maxAge?a>t.maxAge:e[l]&&a>e[l]},h=e=>{if(e[r]>e[i])for(let t=e[d].tail;e[r]>e[i]&&null!==t;){const a=t.prev;y(e,t),t=a}},y=(e,t)=>{if(t){const a=t.value;e[c]&&e[c](a.key,a.value),e[r]-=a.length,e[p].delete(a.key),e[d].removeNode(t)}};class Entry{constructor(e,t,a,n,i){this.key=e,this.value=t,this.length=a,this.now=n,this.maxAge=i||0}}const E=(e,t,a,n)=>{let i=a.value;b(e,i)&&(y(e,a),e[o]||(i=void 0)),i&&t.call(n,i.value,i.key,e)};e.exports=class LRUCache{constructor(e){if("number"==typeof e&&(e={max:e}),e||(e={}),e.max&&("number"!=typeof e.max||e.max<0))throw new TypeError("max must be a non-negative number");this[i]=e.max||1/0;const t=e.length||g;if(this[s]="function"!=typeof t?g:t,this[o]=e.stale||!1,e.maxAge&&"number"!=typeof e.maxAge)throw new TypeError("maxAge must be a number");this[l]=e.maxAge||0,this[c]=e.dispose,this[u]=e.noDisposeOnSet||!1,this[m]=e.updateAgeOnGet||!1,this.reset()}set max(e){if("number"!=typeof e||e<0)throw new TypeError("max must be a non-negative number");this[i]=e||1/0,h(this)}get max(){return this[i]}set allowStale(e){this[o]=!!e}get allowStale(){return this[o]}set maxAge(e){if("number"!=typeof e)throw new TypeError("maxAge must be a non-negative number");this[l]=e,h(this)}get maxAge(){return this[l]}set lengthCalculator(e){"function"!=typeof e&&(e=g),e!==this[s]&&(this[s]=e,this[r]=0,this[d].forEach((e=>{e.length=this[s](e.value,e.key),this[r]+=e.length}))),h(this)}get lengthCalculator(){return this[s]}get length(){return this[r]}get itemCount(){return this[d].length}rforEach(e,t){t=t||this;for(let a=this[d].tail;null!==a;){const n=a.prev;E(this,e,a,t),a=n}}forEach(e,t){t=t||this;for(let a=this[d].head;null!==a;){const n=a.next;E(this,e,a,t),a=n}}keys(){return this[d].toArray().map((e=>e.key))}values(){return this[d].toArray().map((e=>e.value))}reset(){this[c]&&this[d]&&this[d].length&&this[d].forEach((e=>this[c](e.key,e.value))),this[p]=new Map,this[d]=new n,this[r]=0}dump(){return this[d].map((e=>!b(this,e)&&{k:e.key,v:e.value,e:e.now+(e.maxAge||0)})).toArray().filter((e=>e))}dumpLru(){return this[d]}set(e,t,a){if((a=a||this[l])&&"number"!=typeof a)throw new TypeError("maxAge must be a number");const n=a?Date.now():0,o=this[s](t,e);if(this[p].has(e)){if(o>this[i])return y(this,this[p].get(e)),!1;const s=this[p].get(e).value;return this[c]&&(this[u]||this[c](e,s.value)),s.now=n,s.maxAge=a,s.value=t,this[r]+=o-s.length,s.length=o,this.get(e),h(this),!0}const m=new Entry(e,t,o,n,a);return m.length>this[i]?(this[c]&&this[c](e,t),!1):(this[r]+=m.length,this[d].unshift(m),this[p].set(e,this[d].head),h(this),!0)}has(e){if(!this[p].has(e))return!1;const t=this[p].get(e).value;return!b(this,t)}get(e){return f(this,e,!0)}peek(e){return f(this,e,!1)}pop(){const e=this[d].tail;return e?(y(this,e),e.value):null}del(e){y(this,this[p].get(e))}load(e){this.reset();const t=Date.now();for(let a=e.length-1;a>=0;a--){const n=e[a],i=n.e||0;if(0===i)this.set(n.k,n.v);else{const e=i-t;e>0&&this.set(n.k,n.v,e)}}}prune(){this[p].forEach(((e,t)=>f(this,t,!1)))}}},function(e,t,a){"use strict";function n(e){var t=this;if(t instanceof n||(t=new n),t.tail=null,t.head=null,t.length=0,e&&"function"==typeof e.forEach)e.forEach((function(e){t.push(e)}));else if(arguments.length>0)for(var a=0,i=arguments.length;a<i;a++)t.push(arguments[a]);return t}function i(e,t,a){var n=t===e.head?new o(a,null,t,e):new o(a,t,t.next,e);return null===n.next&&(e.tail=n),null===n.prev&&(e.head=n),e.length++,n}function r(e,t){e.tail=new o(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function s(e,t){e.head=new o(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function o(e,t,a,n){if(!(this instanceof o))return new o(e,t,a,n);this.list=n,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,a?(a.prev=this,this.next=a):this.next=null}e.exports=n,n.Node=o,n.create=n,n.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,a=e.prev;return t&&(t.prev=a),a&&(a.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=a),e.list.length--,e.next=null,e.prev=null,e.list=null,t},n.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},n.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},n.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)r(this,arguments[e]);return this.length},n.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)s(this,arguments[e]);return this.length},n.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},n.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},n.prototype.forEach=function(e,t){t=t||this;for(var a=this.head,n=0;null!==a;n++)e.call(t,a.value,n,this),a=a.next},n.prototype.forEachReverse=function(e,t){t=t||this;for(var a=this.tail,n=this.length-1;null!==a;n--)e.call(t,a.value,n,this),a=a.prev},n.prototype.get=function(e){for(var t=0,a=this.head;null!==a&&t<e;t++)a=a.next;if(t===e&&null!==a)return a.value},n.prototype.getReverse=function(e){for(var t=0,a=this.tail;null!==a&&t<e;t++)a=a.prev;if(t===e&&null!==a)return a.value},n.prototype.map=function(e,t){t=t||this;for(var a=new n,i=this.head;null!==i;)a.push(e.call(t,i.value,this)),i=i.next;return a},n.prototype.mapReverse=function(e,t){t=t||this;for(var a=new n,i=this.tail;null!==i;)a.push(e.call(t,i.value,this)),i=i.prev;return a},n.prototype.reduce=function(e,t){var a,n=this.head;if(arguments.length>1)a=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");n=this.head.next,a=this.head.value}for(var i=0;null!==n;i++)a=e(a,n.value,i),n=n.next;return a},n.prototype.reduceReverse=function(e,t){var a,n=this.tail;if(arguments.length>1)a=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");n=this.tail.prev,a=this.tail.value}for(var i=this.length-1;null!==n;i--)a=e(a,n.value,i),n=n.prev;return a},n.prototype.toArray=function(){for(var e=new Array(this.length),t=0,a=this.head;null!==a;t++)e[t]=a.value,a=a.next;return e},n.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,a=this.tail;null!==a;t++)e[t]=a.value,a=a.prev;return e},n.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var a=new n;if(t<e||t<0)return a;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=0,r=this.head;null!==r&&i<e;i++)r=r.next;for(;null!==r&&i<t;i++,r=r.next)a.push(r.value);return a},n.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var a=new n;if(t<e||t<0)return a;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=this.length,r=this.tail;null!==r&&i>t;i--)r=r.prev;for(;null!==r&&i>e;i--,r=r.prev)a.push(r.value);return a},n.prototype.splice=function(e,t,...a){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var n=0,r=this.head;null!==r&&n<e;n++)r=r.next;var s=[];for(n=0;r&&n<t;n++)s.push(r.value),r=this.removeNode(r);for(null===r&&(r=this.tail),r!==this.head&&r!==this.tail&&(r=r.prev),n=0;n<a.length;n++)r=i(this,r,a[n]);return s},n.prototype.reverse=function(){for(var e=this.head,t=this.tail,a=e;null!==a;a=a.prev){var n=a.prev;a.prev=a.next,a.next=n}return this.head=t,this.tail=e,this};try{a(1045)(n)}catch(e){}},function(e,t,a){"use strict";e.exports=function(e){e.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}},function(e,t,a){const n=a(279);e.exports=(e,t)=>new n(e,t).set.map((e=>e.map((e=>e.value)).join(" ").trim().split(" ")))},function(e,t,a){const n=a(243),i=a(279);e.exports=(e,t,a)=>{let r=null,s=null,o=null;try{o=new i(t,a)}catch(e){return null}return e.forEach((e=>{o.test(e)&&(r&&-1!==s.compare(e)||(r=e,s=new n(r,a)))})),r}},function(e,t,a){const n=a(243),i=a(279);e.exports=(e,t,a)=>{let r=null,s=null,o=null;try{o=new i(t,a)}catch(e){return null}return e.forEach((e=>{o.test(e)&&(r&&1!==s.compare(e)||(r=e,s=new n(r,a)))})),r}},function(e,t,a){const n=a(243),i=a(279),r=a(475);e.exports=(e,t)=>{e=new i(e,t);let a=new n("0.0.0");if(e.test(a))return a;if(a=new n("0.0.0-0"),e.test(a))return a;a=null;for(let t=0;t<e.set.length;++t){const i=e.set[t];let s=null;i.forEach((e=>{const t=new n(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":s&&!r(t,s)||(s=t);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${e.operator}`)}})),!s||a&&!r(a,s)||(a=s)}return a&&e.test(a)?a:null}},function(e,t,a){const n=a(279);e.exports=(e,t)=>{try{return new n(e,t).range||"*"}catch(e){return null}}},function(e,t,a){const n=a(568);e.exports=(e,t,a)=>n(e,t,">",a)},function(e,t,a){const n=a(568);e.exports=(e,t,a)=>n(e,t,"<",a)},function(e,t,a){const n=a(279);e.exports=(e,t,a)=>(e=new n(e,a),t=new n(t,a),e.intersects(t))},function(e,t,a){const n=a(477),i=a(264);e.exports=(e,t,a)=>{const r=[];let s=null,o=null;const l=e.sort(((e,t)=>i(e,t,a)));for(const e of l)n(e,t,a)?(o=e,s||(s=e)):(o&&r.push([s,o]),o=null,s=null);s&&r.push([s,null]);const c=[];for(const[e,t]of r)e===t?c.push(e):t||e!==l[0]?t?e===l[0]?c.push(`<=${t}`):c.push(`${e} - ${t}`):c.push(`>=${e}`):c.push("*");const u=c.join(" || "),d="string"==typeof t.raw?t.raw:String(t);return u.length<d.length?u:t}},function(e,t,a){const n=a(279),i=a(476),{ANY:r}=i,s=a(477),o=a(264),l=(e,t,a)=>{if(e===t)return!0;if(1===e.length&&e[0].semver===r){if(1===t.length&&t[0].semver===r)return!0;e=a.includePrerelease?[new i(">=0.0.0-0")]:[new i(">=0.0.0")]}if(1===t.length&&t[0].semver===r){if(a.includePrerelease)return!0;t=[new i(">=0.0.0")]}const n=new Set;let l,d,p,m,g,f,b;for(const t of e)">"===t.operator||">="===t.operator?l=c(l,t,a):"<"===t.operator||"<="===t.operator?d=u(d,t,a):n.add(t.semver);if(n.size>1)return null;if(l&&d){if(p=o(l.semver,d.semver,a),p>0)return null;if(0===p&&(">="!==l.operator||"<="!==d.operator))return null}for(const e of n){if(l&&!s(e,String(l),a))return null;if(d&&!s(e,String(d),a))return null;for(const n of t)if(!s(e,String(n),a))return!1;return!0}let h=!(!d||a.includePrerelease||!d.semver.prerelease.length)&&d.semver,y=!(!l||a.includePrerelease||!l.semver.prerelease.length)&&l.semver;h&&1===h.prerelease.length&&"<"===d.operator&&0===h.prerelease[0]&&(h=!1);for(const e of t){if(b=b||">"===e.operator||">="===e.operator,f=f||"<"===e.operator||"<="===e.operator,l)if(y&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===y.major&&e.semver.minor===y.minor&&e.semver.patch===y.patch&&(y=!1),">"===e.operator||">="===e.operator){if(m=c(l,e,a),m===e&&m!==l)return!1}else if(">="===l.operator&&!s(l.semver,String(e),a))return!1;if(d)if(h&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===h.major&&e.semver.minor===h.minor&&e.semver.patch===h.patch&&(h=!1),"<"===e.operator||"<="===e.operator){if(g=u(d,e,a),g===e&&g!==d)return!1}else if("<="===d.operator&&!s(d.semver,String(e),a))return!1;if(!e.operator&&(d||l)&&0!==p)return!1}return!(l&&f&&!d&&0!==p||d&&b&&!l&&0!==p||y||h)},c=(e,t,a)=>{if(!e)return t;const n=o(e.semver,t.semver,a);return n>0?e:n<0||">"===t.operator&&">="===e.operator?t:e},u=(e,t,a)=>{if(!e)return t;const n=o(e.semver,t.semver,a);return n<0?e:n>0||"<"===t.operator&&"<="===e.operator?t:e};e.exports=(e,t,a={})=>{if(e===t)return!0;e=new n(e,a),t=new n(t,a);let i=!1;e:for(const n of e.set){for(const e of t.set){const t=l(n,e,a);if(i=i||null!==t,t)continue e}if(i)return!1}return!0}},function(e,t,a){e.exports=p,p.Minimatch=m;var n=function(){try{return a(774)}catch(e){}}()||{sep:"/"};p.sep=n.sep;var i=p.GLOBSTAR=m.GLOBSTAR={},r=a(1057),s={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},o="[^/]",l="[^/]*?",c="().*{}+?[]^$\\!".split("").reduce((function(e,t){return e[t]=!0,e}),{}),u=/\/+/;function d(e,t){t=t||{};var a={};return Object.keys(e).forEach((function(t){a[t]=e[t]})),Object.keys(t).forEach((function(e){a[e]=t[e]})),a}function p(e,t,a){return f(t),a||(a={}),!(!a.nocomment&&"#"===t.charAt(0))&&new m(t,a).match(e)}function m(e,t){if(!(this instanceof m))return new m(e,t);f(e),t||(t={}),e=e.trim(),t.allowWindowsEscape||"/"===n.sep||(e=e.split(n.sep).join("/")),this.options=t,this.set=[],this.pattern=e,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!t.partial,this.make()}function g(e,t){return t||(t=this instanceof m?this.options:{}),e=void 0===e?this.pattern:e,f(e),t.nobrace||!/\{(?:(?!\{).)*\}/.test(e)?[e]:r(e)}p.filter=function(e,t){return t=t||{},function(a,n,i){return p(a,e,t)}},p.defaults=function(e){if(!e||"object"!=typeof e||!Object.keys(e).length)return p;var t=p,a=function(a,n,i){return t(a,n,d(e,i))};return(a.Minimatch=function(a,n){return new t.Minimatch(a,d(e,n))}).defaults=function(a){return t.defaults(d(e,a)).Minimatch},a.filter=function(a,n){return t.filter(a,d(e,n))},a.defaults=function(a){return t.defaults(d(e,a))},a.makeRe=function(a,n){return t.makeRe(a,d(e,n))},a.braceExpand=function(a,n){return t.braceExpand(a,d(e,n))},a.match=function(a,n,i){return t.match(a,n,d(e,i))},a},m.defaults=function(e){return p.defaults(e).Minimatch},m.prototype.debug=function(){},m.prototype.make=function(){var e=this.pattern,t=this.options;if(t.nocomment||"#"!==e.charAt(0))if(e){this.parseNegate();var a=this.globSet=this.braceExpand();t.debug&&(this.debug=function(){console.error.apply(console,arguments)}),this.debug(this.pattern,a),a=this.globParts=a.map((function(e){return e.split(u)})),this.debug(this.pattern,a),a=a.map((function(e,t,a){return e.map(this.parse,this)}),this),this.debug(this.pattern,a),a=a.filter((function(e){return-1===e.indexOf(!1)})),this.debug(this.pattern,a),this.set=a}else this.empty=!0;else this.comment=!0},m.prototype.parseNegate=function(){var e=this.pattern,t=!1,a=0;if(!this.options.nonegate){for(var n=0,i=e.length;n<i&&"!"===e.charAt(n);n++)t=!t,a++;a&&(this.pattern=e.substr(a)),this.negate=t}},p.braceExpand=function(e,t){return g(e,t)},m.prototype.braceExpand=g;var f=function(e){if("string"!=typeof e)throw new TypeError("invalid pattern");if(e.length>65536)throw new TypeError("pattern is too long")};m.prototype.parse=function(e,t){f(e);var a=this.options;if("**"===e){if(!a.noglobstar)return i;e="*"}if(""===e)return"";var n,r="",u=!!a.nocase,d=!1,p=[],m=[],g=!1,h=-1,y=-1,E="."===e.charAt(0)?"":a.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",v=this;function T(){if(n){switch(n){case"*":r+=l,u=!0;break;case"?":r+=o,u=!0;break;default:r+="\\"+n}v.debug("clearStateChar %j %j",n,r),n=!1}}for(var k,x=0,S=e.length;x<S&&(k=e.charAt(x));x++)if(this.debug("%s\t%s %s %j",e,x,r,k),d&&c[k])r+="\\"+k,d=!1;else switch(k){case"/":return!1;case"\\":T(),d=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s\t%s %s %j <-- stateChar",e,x,r,k),g){this.debug("  in class"),"!"===k&&x===y+1&&(k="^"),r+=k;continue}v.debug("call clearStateChar %j",n),T(),n=k,a.noext&&T();continue;case"(":if(g){r+="(";continue}if(!n){r+="\\(";continue}p.push({type:n,start:x-1,reStart:r.length,open:s[n].open,close:s[n].close}),r+="!"===n?"(?:(?!(?:":"(?:",this.debug("plType %j %j",n,r),n=!1;continue;case")":if(g||!p.length){r+="\\)";continue}T(),u=!0;var O=p.pop();r+=O.close,"!"===O.type&&m.push(O),O.reEnd=r.length;continue;case"|":if(g||!p.length||d){r+="\\|",d=!1;continue}T(),r+="|";continue;case"[":if(T(),g){r+="\\"+k;continue}g=!0,y=x,h=r.length,r+=k;continue;case"]":if(x===y+1||!g){r+="\\"+k,d=!1;continue}var w=e.substring(y+1,x);try{RegExp("["+w+"]")}catch(e){var j=this.parse(w,b);r=r.substr(0,h)+"\\["+j[0]+"\\]",u=u||j[1],g=!1;continue}u=!0,g=!1,r+=k;continue;default:T(),d?d=!1:!c[k]||"^"===k&&g||(r+="\\"),r+=k}for(g&&(w=e.substr(y+1),j=this.parse(w,b),r=r.substr(0,h)+"\\["+j[0],u=u||j[1]),O=p.pop();O;O=p.pop()){var C=r.slice(O.reStart+O.open.length);this.debug("setting tail",r,O),C=C.replace(/((?:\\{2}){0,64})(\\?)\|/g,(function(e,t,a){return a||(a="\\"),t+t+a+"|"})),this.debug("tail=%j\n   %s",C,C,O,r);var I="*"===O.type?l:"?"===O.type?o:"\\"+O.type;u=!0,r=r.slice(0,O.reStart)+I+"\\("+C}T(),d&&(r+="\\\\");var M=!1;switch(r.charAt(0)){case"[":case".":case"(":M=!0}for(var A=m.length-1;A>-1;A--){var D=m[A],q=r.slice(0,D.reStart),P=r.slice(D.reStart,D.reEnd-8),R=r.slice(D.reEnd-8,D.reEnd),_=r.slice(D.reEnd);R+=_;var F=q.split("(").length-1,L=_;for(x=0;x<F;x++)L=L.replace(/\)[+*?]?/,"");var N="";""===(_=L)&&t!==b&&(N="$"),r=q+P+_+N+R}if(""!==r&&u&&(r="(?=.)"+r),M&&(r=E+r),t===b)return[r,u];if(!u)return e.replace(/\\(.)/g,"$1");var B=a.nocase?"i":"";try{var z=new RegExp("^"+r+"$",B)}catch(e){return new RegExp("$.")}return z._glob=e,z._src=r,z};var b={};p.makeRe=function(e,t){return new m(e,t||{}).makeRe()},m.prototype.makeRe=function(){if(this.regexp||!1===this.regexp)return this.regexp;var e=this.set;if(!e.length)return this.regexp=!1,this.regexp;var t=this.options,a=t.noglobstar?l:t.dot?"(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?":"(?:(?!(?:\\/|^)\\.).)*?",n=t.nocase?"i":"",r=e.map((function(e){return e.map((function(e){return e===i?a:"string"==typeof e?e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"):e._src})).join("\\/")})).join("|");r="^(?:"+r+")$",this.negate&&(r="^(?!"+r+").*$");try{this.regexp=new RegExp(r,n)}catch(e){this.regexp=!1}return this.regexp},p.match=function(e,t,a){var n=new m(t,a=a||{});return e=e.filter((function(e){return n.match(e)})),n.options.nonull&&!e.length&&e.push(t),e},m.prototype.match=function(e,t){if(void 0===t&&(t=this.partial),this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return""===e;if("/"===e&&t)return!0;var a=this.options;"/"!==n.sep&&(e=e.split(n.sep).join("/")),e=e.split(u),this.debug(this.pattern,"split",e);var i,r,s=this.set;for(this.debug(this.pattern,"set",s),r=e.length-1;r>=0&&!(i=e[r]);r--);for(r=0;r<s.length;r++){var o=s[r],l=e;if(a.matchBase&&1===o.length&&(l=[i]),this.matchOne(l,o,t))return!!a.flipNegate||!this.negate}return!a.flipNegate&&this.negate},m.prototype.matchOne=function(e,t,a){var n=this.options;this.debug("matchOne",{this:this,file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var r=0,s=0,o=e.length,l=t.length;r<o&&s<l;r++,s++){this.debug("matchOne loop");var c,u=t[s],d=e[r];if(this.debug(t,u,d),!1===u)return!1;if(u===i){this.debug("GLOBSTAR",[t,u,d]);var p=r,m=s+1;if(m===l){for(this.debug("** at the end");r<o;r++)if("."===e[r]||".."===e[r]||!n.dot&&"."===e[r].charAt(0))return!1;return!0}for(;p<o;){var g=e[p];if(this.debug("\nglobstar while",e,p,t,m,g),this.matchOne(e.slice(p),t.slice(m),a))return this.debug("globstar found match!",p,o,g),!0;if("."===g||".."===g||!n.dot&&"."===g.charAt(0)){this.debug("dot detected!",e,p,t,m);break}this.debug("globstar swallow a segment, and continue"),p++}return!(!a||(this.debug("\n>>> no match, partial?",e,p,t,m),p!==o))}if("string"==typeof u?(c=d===u,this.debug("string match",u,d,c)):(c=d.match(u),this.debug("pattern match",u,d,c)),!c)return!1}if(r===o&&s===l)return!0;if(r===o)return a;if(s===l)return r===o-1&&""===e[r];throw new Error("wtf?")}},function(e,t,a){var n=a(1058),i=a(1059);e.exports=function(e){return e?("{}"===e.substr(0,2)&&(e="\\{\\}"+e.substr(2)),h(function(e){return e.split("\\\\").join(r).split("\\{").join(s).split("\\}").join(o).split("\\,").join(l).split("\\.").join(c)}(e),!0).map(d)):[]};var r="\0SLASH"+Math.random()+"\0",s="\0OPEN"+Math.random()+"\0",o="\0CLOSE"+Math.random()+"\0",l="\0COMMA"+Math.random()+"\0",c="\0PERIOD"+Math.random()+"\0";function u(e){return parseInt(e,10)==e?parseInt(e,10):e.charCodeAt(0)}function d(e){return e.split(r).join("\\").split(s).join("{").split(o).join("}").split(l).join(",").split(c).join(".")}function p(e){if(!e)return[""];var t=[],a=i("{","}",e);if(!a)return e.split(",");var n=a.pre,r=a.body,s=a.post,o=n.split(",");o[o.length-1]+="{"+r+"}";var l=p(s);return s.length&&(o[o.length-1]+=l.shift(),o.push.apply(o,l)),t.push.apply(t,o),t}function m(e){return"{"+e+"}"}function g(e){return/^-?0\d/.test(e)}function f(e,t){return e<=t}function b(e,t){return e>=t}function h(e,t){var a=[],r=i("{","}",e);if(!r||/\$$/.test(r.pre))return[e];var s,l=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(r.body),c=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(r.body),d=l||c,y=r.body.indexOf(",")>=0;if(!d&&!y)return r.post.match(/,.*\}/)?h(e=r.pre+"{"+r.body+o+r.post):[e];if(d)s=r.body.split(/\.\./);else if(1===(s=p(r.body)).length&&1===(s=h(s[0],!1).map(m)).length)return(T=r.post.length?h(r.post,!1):[""]).map((function(e){return r.pre+s[0]+e}));var E,v=r.pre,T=r.post.length?h(r.post,!1):[""];if(d){var k=u(s[0]),x=u(s[1]),S=Math.max(s[0].length,s[1].length),O=3==s.length?Math.abs(u(s[2])):1,w=f;x<k&&(O*=-1,w=b);var j=s.some(g);E=[];for(var C=k;w(C,x);C+=O){var I;if(c)"\\"===(I=String.fromCharCode(C))&&(I="");else if(I=String(C),j){var M=S-I.length;if(M>0){var A=new Array(M+1).join("0");I=C<0?"-"+A+I.slice(1):A+I}}E.push(I)}}else E=n(s,(function(e){return h(e,!1)}));for(var D=0;D<E.length;D++)for(var q=0;q<T.length;q++){var P=v+E[D]+T[q];(!t||d||P)&&a.push(P)}return a}},function(e,t){e.exports=function(e,t){for(var n=[],i=0;i<e.length;i++){var r=t(e[i],i);a(r)?n.push.apply(n,r):n.push(r)}return n};var a=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,a){"use strict";function n(e,t,a){e instanceof RegExp&&(e=i(e,a)),t instanceof RegExp&&(t=i(t,a));var n=r(e,t,a);return n&&{start:n[0],end:n[1],pre:a.slice(0,n[0]),body:a.slice(n[0]+e.length,n[1]),post:a.slice(n[1]+t.length)}}function i(e,t){var a=t.match(e);return a?a[0]:null}function r(e,t,a){var n,i,r,s,o,l=a.indexOf(e),c=a.indexOf(t,l+1),u=l;if(l>=0&&c>0){for(n=[],r=a.length;u>=0&&!o;)u==l?(n.push(u),l=a.indexOf(e,u+1)):1==n.length?o=[n.pop(),c]:((i=n.pop())<r&&(r=i,s=c),c=a.indexOf(t,u+1)),u=l<c&&l>=0?l:c;n.length&&(o=[r,s])}return o}e.exports=n,n.range=r},function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI4IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMSAwSDB2OGg4VjdIMVYweiIgZmlsbD0iI0QzREFFNiIvPjwvc3ZnPg=="},function(e,t,a){"use strict";var n=a(318),i=a(1062),r=a(1075),s=a(141),o=a(1131),l=a(1133),c=a(1134),u=a(1135),d=a(1136),p=a(1137),m=a(1138),g=a(1139),f=a(1140),b=Object.keys(g),h=function(e){var t=e.source||e.children||"",a=e.parserOptions;if(e.allowedTypes&&e.disallowedTypes)throw new Error("Only one of `allowedTypes` and `disallowedTypes` should be defined");var s=n(g,e.renderers),m=[[r,a]].concat(e.plugins||[]).reduce(y,i()),h=m.parse(t),E=n(e,{renderers:s,definitions:p(h)}),v=function(e){var t=[d,o()],a=e.disallowedTypes;e.allowedTypes&&(a=b.filter((function(t){return"root"!==t&&-1===e.allowedTypes.indexOf(t)})));var n=e.unwrapDisallowed?"unwrap":"remove";a&&a.length>0&&t.push(c.ofType(a,n)),e.allowNode&&t.push(c.ifNotMatch(e.allowNode,n));var i=!e.escapeHtml&&!e.skipHtml,r=(e.astPlugins||[]).some((function(e){return(Array.isArray(e)?e[0]:e).identity===f.HtmlParser}));return i&&!r&&t.push(l),e.astPlugins?t.concat(e.astPlugins):t}(e),T=m.runSync(h),k=v.reduce((function(e,t){return t(e,E)}),T);return u(k,E)};function y(e,t){return Array.isArray(t)?e.use.apply(e,function(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}(a=t)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(a)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()):e.use(t);var a}h.defaultProps={renderers:{},escapeHtml:!0,skipHtml:!1,sourcePos:!1,rawSourcePos:!1,transformLinkUri:m,astPlugins:[],plugins:[],parserOptions:{}},h.propTypes={className:s.string,source:s.string,children:s.string,sourcePos:s.bool,rawSourcePos:s.bool,escapeHtml:s.bool,skipHtml:s.bool,allowNode:s.func,allowedTypes:s.arrayOf(s.oneOf(b)),disallowedTypes:s.arrayOf(s.oneOf(b)),transformLinkUri:s.oneOfType([s.func,s.bool]),linkTarget:s.oneOfType([s.func,s.string]),transformImageUri:s.func,astPlugins:s.arrayOf(s.func),unwrapDisallowed:s.bool,renderers:s.object,plugins:s.array,parserOptions:s.object},h.types=b,h.renderers=g,h.uriTransformer=m,e.exports=h},function(e,t,a){"use strict";var n=a(1063),i=a(1064),r=a(1065),s=a(1071),o=a(1072),l=a(1073),c=a(1074);e.exports=function e(){var t=[],a=s(),E={},v=!1,T=-1;return k.data=function(e,t){return o(e)?2===arguments.length?(b("data",v),E[e]=t,k):d.call(E,e)&&E[e]||null:e?(b("data",v),E=e,k):E},k.freeze=x,k.attachers=t,k.use=function(e){var a;if(b("use",v),null==e);else if(l(e))o.apply(null,arguments);else{if("object"!=typeof e)throw new Error("Expected usable value, not `"+e+"`");"length"in e?s(e):i(e)}return a&&(E.settings=n(E.settings||{},a)),k;function i(e){s(e.plugins),e.settings&&(a=n(a||{},e.settings))}function r(e){if(l(e))o(e);else{if("object"!=typeof e)throw new Error("Expected usable value, not `"+e+"`");"length"in e?o.apply(null,e):i(e)}}function s(e){var t,a;if(null==e);else{if("object"!=typeof e||!("length"in e))throw new Error("Expected a list of plugins, not `"+e+"`");for(t=e.length,a=-1;++a<t;)r(e[a])}}function o(e,a){var i=S(e);i?(c(i[1])&&c(a)&&(a=n(i[1],a)),i[1]=a):t.push(u.call(arguments))}},k.parse=function(e){var t,a=r(e);return x(),g("parse",t=k.Parser),m(t)?new t(String(a),a).parse():t(String(a),a)},k.stringify=function(e,t){var a,n=r(t);return x(),f("stringify",a=k.Compiler),h(e),m(a)?new a(e,n).compile():a(e,n)},k.run=O,k.runSync=function(e,t){var a,n=!1;return O(e,t,(function(e,t){n=!0,i(e),a=t})),y("runSync","run",n),a},k.process=w,k.processSync=function(e){var t,a=!1;return x(),g("processSync",k.Parser),f("processSync",k.Compiler),w(t=r(e),(function(e){a=!0,i(e)})),y("processSync","process",a),t},k;function k(){for(var a=e(),i=t.length,r=-1;++r<i;)a.use.apply(null,t[r]);return a.data(n(!0,{},E)),a}function x(){var e,n,i,r;if(v)return k;for(;++T<t.length;)n=(e=t[T])[0],!1!==(i=e[1])&&(!0===i&&(e[1]=void 0),r=n.apply(k,e.slice(1)),l(r)&&a.use(r));return v=!0,T=1/0,k}function S(e){for(var a,n=t.length,i=-1;++i<n;)if((a=t[i])[0]===e)return a}function O(e,t,n){if(h(e),x(),!n&&l(t)&&(n=t,t=null),!n)return new Promise(i);function i(i,s){a.run(e,r(t),(function(t,a,r){a=a||e,t?s(t):i?i(a):n(null,a,r)}))}i(null,n)}function w(e,t){if(x(),g("process",k.Parser),f("process",k.Compiler),!t)return new Promise(a);function a(a,n){var i=r(e);p.run(k,{file:i},(function(e){e?n(e):a?a(i):t(null,i)}))}a(null,t)}}().freeze();var u=[].slice,d={}.hasOwnProperty,p=s().use((function(e,t){t.tree=e.parse(t.file)})).use((function(e,t,a){e.run(t.tree,t.file,(function(e,n,i){e?a(e):(t.tree=n,t.file=i,a())}))})).use((function(e,t){t.file.contents=e.stringify(t.tree,t.file)}));function m(e){return l(e)&&function(e){var t;for(t in e)return!0;return!1}(e.prototype)}function g(e,t){if(!l(t))throw new Error("Cannot `"+e+"` without `Parser`")}function f(e,t){if(!l(t))throw new Error("Cannot `"+e+"` without `Compiler`")}function b(e,t){if(t)throw new Error("Cannot invoke `"+e+"` on a frozen processor.\nCreate a new processor first, by invoking it: use `processor()` instead of `processor`.")}function h(e){if(!e||!o(e.type))throw new Error("Expected node, got `"+e+"`")}function y(e,t,a){if(!a)throw new Error("`"+e+"` finished async. Use `"+t+"` instead")}},function(e,t,a){e.exports=a(24)(3221)},function(e,t,a){e.exports=a(24)(3219)},function(e,t,a){"use strict";var n=a(1066),i=a(1068);e.exports=i;var r=i.prototype;function s(e,t,a){var i=this.path,r=new n(e,t,a);return i&&(r.name=i+":"+r.name,r.file=i),r.fatal=!1,this.messages.push(r),r}r.message=s,r.info=function(){var e=this.message.apply(this,arguments);return e.fatal=null,e},r.fail=function(){var e=this.message.apply(this,arguments);throw e.fatal=!0,e},r.warn=s},function(e,t,a){"use strict";var n=a(1067);function i(){}e.exports=s,i.prototype=Error.prototype,s.prototype=new i;var r=s.prototype;function s(e,t,a){var i,r,s;"string"==typeof t&&(a=t,t=null),i=function(e){var t,a=[null,null];return"string"==typeof e&&(-1===(t=e.indexOf(":"))?a[1]=e:(a[0]=e.slice(0,t),a[1]=e.slice(t+1))),a}(a),r=n(t)||"1:1",s={start:{line:null,column:null},end:{line:null,column:null}},t&&t.position&&(t=t.position),t&&(t.start?(s=t,t=t.start):s.start=t),e.stack&&(this.stack=e.stack,e=e.message),this.message=e,this.name=r,this.reason=e,this.line=t?t.line:null,this.column=t?t.column:null,this.location=s,this.source=i[0],this.ruleId=i[1]}r.file="",r.name="",r.reason="",r.message="",r.stack="",r.fatal=null,r.column=null,r.line=null},function(e,t,a){"use strict";var n={}.hasOwnProperty;function i(e){return e&&"object"==typeof e||(e={}),s(e.line)+":"+s(e.column)}function r(e){return e&&"object"==typeof e||(e={}),i(e.start)+"-"+i(e.end)}function s(e){return e&&"number"==typeof e?e:1}e.exports=function(e){return e&&"object"==typeof e?n.call(e,"position")||n.call(e,"type")?r(e.position):n.call(e,"start")||n.call(e,"end")?r(e):n.call(e,"line")||n.call(e,"column")?i(e):null:null}},function(e,t,a){"use strict";(function(t){var n=a(774),i=a(1069),r=a(1070);e.exports=c;var s={}.hasOwnProperty,o=c.prototype;o.toString=function(e){var t=this.contents||"";return r(t)?t.toString(e):String(t)};var l=["history","path","basename","stem","extname","dirname"];function c(e){var a,n,i;if(e){if("string"==typeof e||r(e))e={contents:e};else if("message"in e&&"messages"in e)return e}else e={};if(!(this instanceof c))return new c(e);for(this.data={},this.messages=[],this.history=[],this.cwd=t.cwd(),n=-1,i=l.length;++n<i;)a=l[n],s.call(e,a)&&(this[a]=e[a]);for(a in e)-1===l.indexOf(a)&&(this[a]=e[a])}function u(e,t){if(-1!==e.indexOf(n.sep))throw new Error("`"+t+"` cannot be a path: did not expect `"+n.sep+"`")}function d(e,t){if(!e)throw new Error("`"+t+"` cannot be empty")}function p(e,t){if(!e)throw new Error("Setting `"+t+"` requires `path` to be set too")}Object.defineProperty(o,"path",{get:function(){return this.history[this.history.length-1]},set:function(e){d(e,"path"),e!==this.path&&this.history.push(e)}}),Object.defineProperty(o,"dirname",{get:function(){return"string"==typeof this.path?n.dirname(this.path):void 0},set:function(e){p(this.path,"dirname"),this.path=n.join(e||"",this.basename)}}),Object.defineProperty(o,"basename",{get:function(){return"string"==typeof this.path?n.basename(this.path):void 0},set:function(e){d(e,"basename"),u(e,"basename"),this.path=n.join(this.dirname||"",e)}}),Object.defineProperty(o,"extname",{get:function(){return"string"==typeof this.path?n.extname(this.path):void 0},set:function(e){var t=e||"";if(u(t,"extname"),p(this.path,"extname"),t){if("."!==t.charAt(0))throw new Error("`extname` must start with `.`");if(-1!==t.indexOf(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=i(this.path,t)}}),Object.defineProperty(o,"stem",{get:function(){return"string"==typeof this.path?n.basename(this.path,this.extname):void 0},set:function(e){d(e,"stem"),u(e,"stem"),this.path=n.join(this.dirname||"",e+(this.extname||""))}})}).call(this,a(359))},function(e,t,a){e.exports=a(24)(3228)},function(e,t){function a(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
e.exports=function(e){return null!=e&&(a(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&a(e.slice(0,0))}(e)||!!e._isBuffer)}},function(e,t,a){e.exports=a(24)(3223)},function(e,t){var a=Object.prototype.toString;e.exports=function(e){return"[object String]"===a.call(e)}},function(e,t){e.exports=function(e){return"[object Function]"===Object.prototype.toString.call(e)}},function(e,t,a){"use strict";var n=Object.prototype.toString;e.exports=function(e){var t;return"[object Object]"===n.call(e)&&(null===(t=Object.getPrototypeOf(e))||t===Object.getPrototypeOf({}))}},function(e,t,a){"use strict";var n=a(1076),i=a(318),r=a(1077);function s(e){var t=n(r);t.prototype.options=i(t.prototype.options,this.data("settings"),e),this.Parser=t}e.exports=s,s.Parser=r},function(e,t,a){e.exports=a(24)(3230)},function(e,t,a){"use strict";var n=a(318),i=a(1078),r=a(1079),s=a(1080),o=a(1081),l=a(1087);function c(e,t){this.file=t,this.offset={},this.options=n(this.options),this.setOptions({}),this.inList=!1,this.inBlock=!1,this.inLink=!1,this.atStart=!0,this.toOffset=r(t).toOffset,this.unescape=s(this,"escape"),this.decode=o(this)}e.exports=c;var u=c.prototype;function d(e){var t,a=[];for(t in e)a.push(t);return a}u.setOptions=a(1088),u.parse=a(1091),u.options=a(775),u.exitStart=i("atStart",!0),u.enterList=i("inList",!1),u.enterLink=i("inLink",!1),u.enterBlock=i("inBlock",!1),u.interruptParagraph=[["thematicBreak"],["atxHeading"],["fencedCode"],["blockquote"],["html"],["setextHeading",{commonmark:!1}],["definition",{commonmark:!1}],["footnote",{commonmark:!1}]],u.interruptList=[["atxHeading",{pedantic:!1}],["fencedCode",{pedantic:!1}],["thematicBreak",{pedantic:!1}],["definition",{commonmark:!1}],["footnote",{commonmark:!1}]],u.interruptBlockquote=[["indentedCode",{commonmark:!0}],["fencedCode",{commonmark:!0}],["atxHeading",{commonmark:!0}],["setextHeading",{commonmark:!0}],["thematicBreak",{commonmark:!0}],["html",{commonmark:!0}],["list",{commonmark:!0}],["definition",{commonmark:!1}],["footnote",{commonmark:!1}]],u.blockTokenizers={newline:a(1095),indentedCode:a(1096),fencedCode:a(1097),blockquote:a(1098),atxHeading:a(1099),thematicBreak:a(1100),list:a(1101),setextHeading:a(1103),html:a(1104),footnote:a(1105),definition:a(1107),table:a(1108),paragraph:a(1109)},u.inlineTokenizers={escape:a(1110),autoLink:a(1112),url:a(1113),html:a(1115),link:a(1117),reference:a(1118),strong:a(1119),emphasis:a(1121),deletion:a(1124),code:a(1126),break:a(1128),text:a(1130)},u.blockMethods=d(u.blockTokenizers),u.inlineMethods=d(u.inlineTokenizers),u.tokenizeBlock=l("block"),u.tokenizeInline=l("inline"),u.tokenizeFactory=l},function(e,t,a){e.exports=a(24)(3233)},function(e,t,a){"use strict";function n(e){return function(t){var a=t&&t.line,n=t&&t.column;return isNaN(a)||isNaN(n)||!(a-1 in e)?-1:(e[a-2]||0)+n-1||0}}e.exports=function(e){var t,a=function(e){for(var t=[],a=e.indexOf("\n");-1!==a;)t.push(a+1),a=e.indexOf("\n",a+1);return t.push(e.length+1),t}(String(e));return{toPosition:(t=a,function(e){var a=-1,n=t.length;if(e<0)return{};for(;++a<n;)if(t[a]>e)return{line:a+1,column:e-(t[a-1]||0)+1,offset:e};return{}}),toOffset:n(a)}}},function(e,t,a){"use strict";e.exports=function(e,t){return function(a){for(var n,i=0,r=a.indexOf("\\"),s=e[t],o=[];-1!==r;)o.push(a.slice(i,r)),i=r+1,(n=a.charAt(i))&&-1!==s.indexOf(n)||o.push("\\"),r=a.indexOf("\\",i);return o.push(a.slice(i)),o.join("")}}},function(e,t,a){"use strict";var n=a(318),i=a(569);e.exports=function(e){return r.raw=function(e,r,s){return i(e,n(s,{position:t(r),warning:a}))},r;function t(t){for(var a=e.offset,n=t.line,i=[];++n&&n in a;)i.push((a[n]||0)+1);return{start:t,indent:i}}function a(t,a,n){3!==n&&e.file.message(t,a)}function r(n,r,s){i(n,{position:t(r),warning:a,text:s,reference:s,textContext:e,referenceContext:e})}}},function(e,t,a){e.exports=a(24)(2850)},function(e,t,a){e.exports=a(24)(2851)},function(e,t,a){e.exports=a(24)(2852)},function(e,t,a){e.exports=a(24)(2853)},function(e,t,a){"use strict";var n;e.exports=function(e){var t,a="&"+e+";";return(n=n||document.createElement("i")).innerHTML=a,(";"!==(t=n.textContent).slice(-1)||"semi"===e)&&(t!==a&&t)}},function(e,t,a){"use strict";e.exports=function(e){return function(t,a){var r,s,o,l,c,u=this,d=u.offset,p=[],m=u[e+"Methods"],g=u[e+"Tokenizers"],f=a.line,b=a.column;if(!t)return p;for(v.now=y,v.file=u.file,h("");t;){for(r=-1,s=m.length,l=!1;++r<s&&(!(o=g[m[r]])||o.onlyAtStart&&!u.atStart||o.notInList&&u.inList||o.notInBlock&&u.inBlock||o.notInLink&&u.inLink||(c=t.length,o.apply(u,[v,t]),!(l=c!==t.length))););l||u.file.fail(new Error("Infinite loop"),v.now())}return u.eof=y(),p;function h(e){for(var t=-1,a=e.indexOf("\n");-1!==a;)f++,t=a,a=e.indexOf("\n",a+1);-1===t?b+=e.length:b=e.length-t,f in d&&(-1!==t?b+=d[f]:b<=d[f]&&(b=d[f]+1))}function y(){var e={line:f,column:b};return e.offset=u.toOffset(e),e}function E(e){this.start=e,this.end=y()}function v(e){var a,r=function(){var e=[],t=f+1;return function(){for(var a=f+1;t<a;)e.push((d[t]||0)+1),t++;return e}}(),s=(a=y(),function(e,t){var n=e.position,i=n?n.start:a,r=[],s=n&&n.end.line,o=a.line;if(e.position=new E(i),n&&t&&n.indent){if(r=n.indent,s<o){for(;++s<o;)r.push((d[s]||0)+1);r.push(a.column)}t=r.concat(t)}return e.position.indent=t||[],e}),o=y();return function(e){t.substring(0,e.length)!==e&&u.file.fail(new Error("Incorrectly eaten value: please report this warning on http://git.io/vg5Ft"),y())}(e),l.reset=c,c.test=m,l.test=m,t=t.substring(e.length),h(e),r=r(),l;function l(e,t){return s(function(e,t){var a=t?t.children:p,r=a[a.length-1];return r&&e.type===r.type&&e.type in n&&i(r)&&i(e)&&(e=n[e.type].call(u,r,e)),e!==r&&a.push(e),u.atStart&&0!==p.length&&u.exitStart(),e}(s(e),t),r)}function c(){var a=l.apply(null,arguments);return f=o.line,b=o.column,t=e+t,a}function m(){var a=s({});return f=o.line,b=o.column,t=e+t,a.position}}}};var n={text:function(e,t){return e.value+=t.value,e},blockquote:function(e,t){return this.options.commonmark?t:(e.children=e.children.concat(t.children),e)}};function i(e){var t,a;return"text"!==e.type||!e.position||(t=e.position.start,a=e.position.end,t.line!==a.line||a.column-t.column===e.value.length)}},function(e,t,a){"use strict";var n=a(318),i=a(1089),r=a(775);e.exports=function(e){var t,a,s=this,o=s.options;if(null==e)e={};else{if("object"!=typeof e)throw new Error("Invalid value `"+e+"` for setting `options`");e=n(e)}for(t in r){if(null==(a=e[t])&&(a=o[t]),"blocks"!==t&&"boolean"!=typeof a||"blocks"===t&&"object"!=typeof a)throw new Error("Invalid value `"+a+"` for setting `options."+t+"`");e[t]=a}return s.options=e,s.escape=i(e),s}},function(e,t,a){e.exports=a(24)(3239)},function(e){e.exports=JSON.parse('["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","iframe","legend","li","link","main","menu","menuitem","meta","nav","noframes","ol","optgroup","option","p","param","pre","section","source","title","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"]')},function(e,t,a){"use strict";var n=a(318),i=a(1092);e.exports=function(){var e,t=this,a=String(t.file),s={line:1,column:1,offset:0},o=n(s);return 65279===(a=a.replace(r,"\n")).charCodeAt(0)&&(a=a.slice(1),o.column++,o.offset++),e={type:"root",children:t.tokenizeBlock(a,o),position:{start:s,end:t.eof||n(s)}},t.options.position||i(e,!0),e};var r=/\r\n|\r/g},function(e,t,a){"use strict";var n=a(478);function i(e){delete e.position}function r(e){e.position=void 0}e.exports=function(e,t){return n(e,t?i:r),e}},function(e,t,a){"use strict";e.exports=s;var n=a(1094),i="skip",r=!1;function s(e,t,a,s){var l;"function"==typeof t&&"function"!=typeof a&&(s=a,a=t,t=null),l=n(t),function e(n,c,u){var d,p=[];return(t&&!l(n,c,u[u.length-1]||null)||(p=o(a(n,u)))[0]!==r)&&n.children&&p[0]!==i?(d=o(function(t,a){for(var n,i=s?-1:1,o=(s?t.length:-1)+i;o>-1&&o<t.length;){if((n=e(t[o],o,a))[0]===r)return n;o="number"==typeof n[1]?n[1]:o+i}}(n.children,u.concat(n))),d[0]===r?d:p):p}(e,null,[])}function o(e){return null!==e&&"object"==typeof e&&"length"in e?e:"number"==typeof e?[!0,e]:[e]}s.CONTINUE=!0,s.SKIP=i,s.EXIT=r},function(e,t,a){"use strict";function n(e){if("string"==typeof e)return function(e){return function(t){return Boolean(t&&t.type===e)}}(e);if(null==e)return s;if("object"==typeof e)return("length"in e?r:i)(e);if("function"==typeof e)return e;throw new Error("Expected function, string, or object as test")}function i(e){return function(t){var a;for(a in e)if(t[a]!==e[a])return!1;return!0}}function r(e){var t=function(e){for(var t=[],a=e.length,i=-1;++i<a;)t[i]=n(e[i]);return t}(e),a=t.length;return function(){for(var e=-1;++e<a;)if(t[e].apply(this,arguments))return!0;return!1}}function s(){return!0}e.exports=n},function(e,t,a){"use strict";var n=a(266);e.exports=function(e,t,a){var i,r,s,o,l=t.charAt(0);if("\n"===l){if(a)return!0;for(o=1,i=t.length,r=l,s="";o<i&&(l=t.charAt(o),n(l));)s+=l,"\n"===l&&(r+=s,s=""),o++;e(r)}}},function(e,t,a){"use strict";var n=a(571),i=a(572);e.exports=function(e,t,a){for(var n,s,o,l=-1,c=t.length,u="",d="",p="",m="";++l<c;)if(n=t.charAt(l),o)if(o=!1,u+=p,d+=m,p="",m="","\n"===n)p=n,m=n;else for(u+=n,d+=n;++l<c;){if(!(n=t.charAt(l))||"\n"===n){m=n,p=n;break}u+=n,d+=n}else if(" "===n&&t.charAt(l+1)===n&&t.charAt(l+2)===n&&t.charAt(l+3)===n)p+=r,l+=3,o=!0;else if("\t"===n)p+=n,o=!0;else{for(s="";"\t"===n||" "===n;)s+=n,n=t.charAt(++l);if("\n"!==n)break;p+=s+n,m+=n}if(d)return!!a||e(u)({type:"code",lang:null,value:i(d)})};var r=n(" ",4)},function(e,t,a){"use strict";var n=a(572);e.exports=function(e,t,a){var o,l,c,u,d,p,m,g,f,b,h,y=this,E=y.options,v=t.length+1,T=0,k="";if(E.gfm){for(;T<v&&((c=t.charAt(T))===s||c===r);)k+=c,T++;if(b=T,"~"===(c=t.charAt(T))||"`"===c){for(T++,l=c,o=1,k+=c;T<v&&(c=t.charAt(T))===l;)k+=c,o++,T++;if(!(o<3)){for(;T<v&&((c=t.charAt(T))===s||c===r);)k+=c,T++;for(u="",d="";T<v&&(c=t.charAt(T))!==i&&"~"!==c&&"`"!==c;)c===s||c===r?d+=c:(u+=d+c,d=""),T++;if(!(c=t.charAt(T))||c===i){if(a)return!0;for((h=e.now()).column+=k.length,h.offset+=k.length,k+=u,u=y.decode.raw(y.unescape(u),h),d&&(k+=d),d="",g="",f="",p="",m="";T<v;)if(p+=g,m+=f,g="",f="",(c=t.charAt(T))===i){for(p?(g+=c,f+=c):k+=c,d="",T++;T<v&&(c=t.charAt(T))===s;)d+=c,T++;if(g+=d,f+=d.slice(b),!(d.length>=4)){for(d="";T<v&&(c=t.charAt(T))===l;)d+=c,T++;if(g+=d,f+=d,!(d.length<o)){for(d="";T<v&&((c=t.charAt(T))===s||c===r);)g+=c,f+=c,T++;if(!c||c===i)break}}}else p+=c,f+=c,T++;return e(k+=p+g)({type:"code",lang:u||null,value:n(m)})}}}}};var i="\n",r="\t",s=" "},function(e,t,a){"use strict";var n=a(386),i=a(573);e.exports=function(e,t,a){for(var r,s,o,l,c,u,d,p,m,g=this,f=g.offset,b=g.blockTokenizers,h=g.interruptBlockquote,y=e.now(),E=y.line,v=t.length,T=[],k=[],x=[],S=0;S<v&&(" "===(s=t.charAt(S))||"\t"===s);)S++;if(">"===t.charAt(S)){if(a)return!0;for(S=0;S<v;){for(d=S,p=!1,-1===(l=t.indexOf("\n",S))&&(l=v);S<v&&(" "===(s=t.charAt(S))||"\t"===s);)S++;if(">"===t.charAt(S)?(S++,p=!0," "===t.charAt(S)&&S++):S=d,c=t.slice(S,l),!p&&!n(c)){S=d;break}if(!p&&(o=t.slice(S),i(h,b,g,[e,o,!0])))break;u=d===S?c:t.slice(d,l),x.push(S-d),T.push(u),k.push(c),S=l+1}for(S=-1,v=x.length,r=e(T.join("\n"));++S<v;)f[E]=(f[E]||0)+x[S],E++;return m=g.enterBlock(),k=g.tokenizeBlock(k.join("\n"),y),m(),r({type:"blockquote",children:k})}}},function(e,t,a){"use strict";e.exports=function(e,t,a){for(var s,o,l,c=this.options,u=t.length+1,d=-1,p=e.now(),m="",g="";++d<u;){if((s=t.charAt(d))!==i&&s!==n){d--;break}m+=s}for(l=0;++d<=u;){if((s=t.charAt(d))!==r){d--;break}m+=s,l++}if(!(l>6)&&l&&(c.pedantic||t.charAt(d+1)!==r)){for(u=t.length+1,o="";++d<u;){if((s=t.charAt(d))!==i&&s!==n){d--;break}o+=s}if(c.pedantic||0!==o.length||!s||"\n"===s){if(a)return!0;for(m+=o,o="",g="";++d<u&&(s=t.charAt(d))&&"\n"!==s;)if(s===i||s===n||s===r){for(;s===i||s===n;)o+=s,s=t.charAt(++d);for(;s===r;)o+=s,s=t.charAt(++d);for(;s===i||s===n;)o+=s,s=t.charAt(++d);d--}else g+=o+s,o="";return p.column+=m.length,p.offset+=m.length,e(m+=g+o)({type:"heading",depth:l,children:this.tokenizeInline(g,p)})}}};var n="\t",i=" ",r="#"},function(e,t,a){"use strict";e.exports=function(e,t,a){for(var n,i,r,s,o=-1,l=t.length+1,c="";++o<l&&("\t"===(n=t.charAt(o))||" "===n);)c+=n;if("*"===n||"-"===n||"_"===n)for(i=n,c+=n,r=1,s="";++o<l;)if((n=t.charAt(o))===i)r++,c+=s+i,s="";else{if(" "!==n)return r>=3&&(!n||"\n"===n)?(c+=s,!!a||e(c)({type:"thematicBreak"})):void 0;s+=n}}},function(e,t,a){"use strict";var n=a(386),i=a(571),r=a(570),s=a(776),o=a(1102),l=a(573);e.exports=function(e,t,a){for(var i,s,o,p,m,g,f,b,T,k,x,S,O,w,j,C,I,M,A,D,q,P,R,_,F=this,L=F.options.commonmark,N=F.options.pedantic,B=F.blockTokenizers,z=F.interruptList,U=0,H=t.length,$=null,V=0;U<H;){if((p=t.charAt(U))===d)V+=4-V%4;else{if(p!==c)break;V++}U++}if(!(V>=4)){if(p=t.charAt(U),i=L?E:y,!0===h[p])m=p,o=!1;else{for(o=!0,s="";U<H&&(p=t.charAt(U),r(p));)s+=p,U++;if(p=t.charAt(U),!s||!0!==i[p])return;$=parseInt(s,10),m=p}if((p=t.charAt(++U))===c||p===d){if(a)return!0;for(U=0,w=[],j=[],C=[];U<H;){for(f=U,b=!1,_=!1,-1===(g=t.indexOf(u,U))&&(g=H),R=U+4,V=0;U<H;){if((p=t.charAt(U))===d)V+=4-V%4;else{if(p!==c)break;V++}U++}if(V>=4&&(_=!0),I&&V>=I.indent&&(_=!0),p=t.charAt(U),T=null,!_){if(!0===h[p])T=p,U++,V++;else{for(s="";U<H&&(p=t.charAt(U),r(p));)s+=p,U++;p=t.charAt(U),U++,s&&!0===i[p]&&(T=p,V+=s.length+1)}if(T)if((p=t.charAt(U))===d)V+=4-V%4,U++;else if(p===c){for(R=U+4;U<R&&t.charAt(U)===c;)U++,V++;U===R&&t.charAt(U)===c&&(U-=3,V-=3)}else p!==u&&""!==p&&(T=null)}if(T){if(!N&&m!==T)break;b=!0}else L||_||t.charAt(f)!==c?L&&I&&(_=V>=I.indent||V>4):_=!0,b=!1,U=f;if(x=t.slice(f,g),k=f===U?x:t.slice(U,g),("*"===T||"_"===T||"-"===T)&&B.thematicBreak.call(F,e,x,!0))break;if(S=O,O=!n(k).length,_&&I)I.value=I.value.concat(C,x),j=j.concat(C,x),C=[];else if(b)0!==C.length&&(I.value.push(""),I.trail=C.concat()),I={value:[x],indent:V,trail:[]},w.push(I),j=j.concat(C,x),C=[];else if(O){if(S)break;C.push(x)}else{if(S)break;if(l(z,B,F,[e,x,!0]))break;I.value=I.value.concat(C,x),j=j.concat(C,x),C=[]}U=g+1}for(q=e(j.join(u)).reset({type:"list",ordered:o,start:$,loose:null,children:[]}),M=F.enterList(),A=F.enterBlock(),D=!1,U=-1,H=w.length;++U<H;)I=w[U].value.join(u),P=e.now(),(I=e(I)(v(F,I,P),q)).loose&&(D=!0),I=w[U].trail.join(u),U!==H-1&&(I+=u),e(I);return M(),A(),q.loose=D,q}}};var c=" ",u="\n",d="\t",p=/\n\n(?!\s*$)/,m=/^\[([ \t]|x|X)][ \t]/,g=/^([ \t]*)([*+-]|\d+[.)])( {1,4}(?! )| |\t|$|(?=\n))([^\n]*)/,f=/^([ \t]*)([*+-]|\d+[.)])([ \t]+)/,b=/^( {1,4}|\t)?/gm,h={"*":!0,"+":!0,"-":!0},y={".":!0},E={};function v(e,t,a){var n,i,r=e.offset,s=e.options.pedantic?T:k,o=null;return t=s.apply(null,arguments),e.options.gfm&&(n=t.match(m))&&(i=n[0].length,o="x"===n[1].toLowerCase(),r[a.line]+=i,t=t.slice(i)),{type:"listItem",loose:p.test(t)||t.charAt(t.length-1)===u,checked:o,children:e.tokenizeBlock(t,a)}}function T(e,t,a){var n=e.offset,i=a.line;return t=t.replace(f,r),i=a.line,t.replace(b,r);function r(e){return n[i]=(n[i]||0)+e.length,i++,""}}function k(e,t,a){var n,r,l,d,p,m,f,b=e.offset,h=a.line;for(d=(t=t.replace(g,(function(e,t,a,s,o){return r=t+a+s,l=o,Number(a)<10&&r.length%2==1&&(a=c+a),(n=t+i(c,a.length)+s)+l}))).split(u),(p=o(t,s(n).indent).split(u))[0]=l,b[h]=(b[h]||0)+r.length,h++,m=0,f=d.length;++m<f;)b[h]=(b[h]||0)+d[m].length-p[m].length,h++;return p.join(u)}E["."]=!0,E[")"]=!0},function(e,t,a){"use strict";var n=a(386),i=a(571),r=a(776);e.exports=function(e,t){var a,s,o,l,c=e.split("\n"),u=c.length+1,d=1/0,p=[];for(c.unshift(i(" ",t)+"!");u--;)if(s=r(c[u]),p[u]=s.stops,0!==n(c[u]).length){if(!s.indent){d=1/0;break}s.indent>0&&s.indent<d&&(d=s.indent)}if(d!==1/0)for(u=c.length;u--;){for(o=p[u],a=d;a&&!(a in o);)a--;l=0!==n(c[u]).length&&d&&a!==d?"\t":"",c[u]=l+c[u].slice(a in o?o[a]+1:0)}return c.shift(),c.join("\n")}},function(e,t,a){"use strict";e.exports=function(e,t,a){for(var i,r,s,o,l,c=e.now(),u=t.length,d=-1,p="";++d<u;){if(" "!==(s=t.charAt(d))||d>=3){d--;break}p+=s}for(i="",r="";++d<u;){if("\n"===(s=t.charAt(d))){d--;break}" "===s||"\t"===s?r+=s:(i+=r+s,r="")}if(c.column+=p.length,c.offset+=p.length,p+=i+r,s=t.charAt(++d),o=t.charAt(++d),"\n"===s&&n[o]){for(p+=s,r=o,l=n[o];++d<u;){if((s=t.charAt(d))!==o){if("\n"!==s)return;d--;break}r+=s}return!!a||e(p+r)({type:"heading",depth:l,children:this.tokenizeInline(i,c)})}};var n={"=":1,"-":2}},function(e,t,a){"use strict";var n=a(777).openCloseTag;e.exports=function(e,t,a){for(var i,r,s,o,l,c,u,d=this.options.blocks,p=t.length,m=0,g=[[/^<(script|pre|style)(?=(\s|>|$))/i,/<\/(script|pre|style)>/i,!0],[/^<!--/,/-->/,!0],[/^<\?/,/\?>/,!0],[/^<![A-Za-z]/,/>/,!0],[/^<!\[CDATA\[/,/\]\]>/,!0],[new RegExp("^</?("+d.join("|")+")(?=(\\s|/?>|$))","i"),/^$/,!0],[new RegExp(n.source+"\\s*$"),/^$/,!1]];m<p&&("\t"===(o=t.charAt(m))||" "===o);)m++;if("<"===t.charAt(m)){for(i=-1===(i=t.indexOf("\n",m+1))?p:i,r=t.slice(m,i),s=-1,l=g.length;++s<l;)if(g[s][0].test(r)){c=g[s];break}if(c){if(a)return c[2];if(m=i,!c[1].test(r))for(;m<p;){if(i=-1===(i=t.indexOf("\n",m+1))?p:i,r=t.slice(m+1,i),c[1].test(r)){r&&(m=i);break}m=i}return e(u=t.slice(0,m))({type:"html",value:u})}}}},function(e,t,a){"use strict";var n=a(266),i=a(574);e.exports=s,s.notInList=!0,s.notInBlock=!0;var r=/^( {4}|\t)?/gm;function s(e,t,a){var s,o,l,c,u,d,p,m,g,f,b,h,y=this,E=y.offset;if(y.options.footnotes){for(s=0,o=t.length,l="",c=e.now(),u=c.line;s<o&&(g=t.charAt(s),n(g));)l+=g,s++;if("["===t.charAt(s)&&"^"===t.charAt(s+1)){for(s=(l+="[^").length,p="";s<o&&"]"!==(g=t.charAt(s));)"\\"===g&&(p+=g,s++,g=t.charAt(s)),p+=g,s++;if(p&&"]"===t.charAt(s)&&":"===t.charAt(s+1)){if(a)return!0;for(f=i(p),s=(l+=p+"]:").length;s<o&&("\t"===(g=t.charAt(s))||" "===g);)l+=g,s++;for(c.column+=l.length,c.offset+=l.length,p="",d="",m="";s<o;){if("\n"===(g=t.charAt(s))){for(m=g,s++;s<o&&"\n"===(g=t.charAt(s));)m+=g,s++;for(p+=m,m="";s<o&&" "===(g=t.charAt(s));)m+=g,s++;if(0===m.length)break;p+=m}p&&(d+=p,p=""),d+=g,s++}return l+=d,d=d.replace(r,(function(e){return E[u]=(E[u]||0)+e.length,u++,""})),b=e(l),h=y.enterBlock(),d=y.tokenizeBlock(d,c),h(),b({type:"footnoteDefinition",identifier:f,children:d})}}}}},function(e,t,a){e.exports=a(24)(3256)},function(e,t,a){"use strict";var n=a(266),i=a(574);e.exports=c,c.notInList=!0,c.notInBlock=!0;var r="\n",s="\t",o=" ",l="]";function c(e,t,a){for(var n,c,p,m,g,f,b,h,y=this,E=y.options.commonmark,v=0,T=t.length,k="";v<T&&((m=t.charAt(v))===o||m===s);)k+=m,v++;if("["===(m=t.charAt(v))){for(v++,k+=m,p="";v<T&&(m=t.charAt(v))!==l;)"\\"===m&&(p+=m,v++,m=t.charAt(v)),p+=m,v++;if(p&&t.charAt(v)===l&&":"===t.charAt(v+1)){for(f=p,v=(k+=p+l+":").length,p="";v<T&&((m=t.charAt(v))===s||m===o||m===r);)k+=m,v++;if(p="",n=k,"<"===(m=t.charAt(v))){for(v++;v<T&&u(m=t.charAt(v));)p+=m,v++;if((m=t.charAt(v))===u.delimiter)k+="<"+p+m,v++;else{if(E)return;v-=p.length+1,p=""}}if(!p){for(;v<T&&d(m=t.charAt(v));)p+=m,v++;k+=p}if(p){for(b=p,p="";v<T&&((m=t.charAt(v))===s||m===o||m===r);)p+=m,v++;if(g=null,'"'===(m=t.charAt(v))?g='"':"'"===m?g="'":"("===m&&(g=")"),g){if(!p)return;for(v=(k+=p+m).length,p="";v<T&&(m=t.charAt(v))!==g;){if(m===r){if(v++,(m=t.charAt(v))===r||m===g)return;p+=r}p+=m,v++}if((m=t.charAt(v))!==g)return;c=k,k+=p+m,v++,h=p,p=""}else p="",v=k.length;for(;v<T&&((m=t.charAt(v))===s||m===o);)k+=m,v++;return(m=t.charAt(v))&&m!==r?void 0:!!a||(n=e(n).test().end,b=y.decode.raw(y.unescape(b),n,{nonTerminated:!1}),h&&(c=e(c).test().end,h=y.decode.raw(y.unescape(h),c)),e(k)({type:"definition",identifier:i(f),title:h||null,url:b}))}}}}function u(e){return">"!==e&&"["!==e&&e!==l}function d(e){return"["!==e&&e!==l&&!n(e)}u.delimiter=">"},function(e,t,a){"use strict";var n=a(266);e.exports=function(e,t,a){var s,o,l,c,u,d,p,m,g,f,b,h,y,E,v,T,k,x,S,O,w,j,C,I;if(this.options.gfm){for(s=0,x=0,d=t.length+1,p=[];s<d;){if(j=t.indexOf(i,s),C=t.indexOf("|",s+1),-1===j&&(j=t.length),-1===C||C>j){if(x<2)return;break}p.push(t.slice(s,j)),x++,s=j+1}for(c=p.join(i),s=0,d=(o=p.splice(1,1)[0]||[]).length,x--,l=!1,b=[];s<d;){if("|"===(g=o.charAt(s))){if(f=null,!1===l){if(!1===I)return}else b.push(l),l=!1;I=!1}else if("-"===g)f=!0,l=l||null;else if(":"===g)l=l===r?"center":f&&null===l?"right":r;else if(!n(g))return;s++}if(!1!==l&&b.push(l),!(b.length<1)){if(a)return!0;for(k=-1,O=[],w=e(c).reset({type:"table",align:b,children:O});++k<x;){for(S=p[k],u={type:"tableRow",children:[]},k&&e(i),e(S).reset(u,w),d=S.length+1,s=0,m="",h="",y=!0,E=null,v=null;s<d;)if("\t"!==(g=S.charAt(s))&&" "!==g){if(""===g||"|"===g)if(y)e(g);else{if(g&&v){m+=g,s++;continue}!h&&!g||y||(c=h,m.length>1&&(g?(c+=m.slice(0,m.length-1),m=m.charAt(m.length-1)):(c+=m,m="")),T=e.now(),e(c)({type:"tableCell",children:this.tokenizeInline(h,T)},u)),e(m+g),m="",h=""}else if(m&&(h+=m,m=""),h+=g,"\\"===g&&s!==d-2&&(h+=S.charAt(s+1),s++),"`"===g){for(E=1;S.charAt(s+1)===g;)h+=g,s++,E++;v?E>=v&&(v=0):v=E}y=!1,s++}else h?m+=g:e(g),s++;k||e(i+o)}return w}}};var i="\n",r="left"},function(e,t,a){"use strict";var n=a(386),i=a(570),r=a(572),s=a(573);e.exports=function(e,t,a){for(var l,c,u,d,p,m=this,g=m.options,f=g.commonmark,b=g.gfm,h=m.blockTokenizers,y=m.interruptParagraph,E=t.indexOf(o),v=t.length;E<v;){if(-1===E){E=v;break}if(t.charAt(E+1)===o)break;if(f){for(d=0,l=E+1;l<v;){if("\t"===(u=t.charAt(l))){d=4;break}if(" "!==u)break;d++,l++}if(d>=4){E=t.indexOf(o,E+1);continue}}if(c=t.slice(E+1),s(y,h,m,[e,c,!0]))break;if(h.list.call(m,e,c,!0)&&(m.inList||f||b&&!i(n.left(c).charAt(0))))break;if(l=E,-1!==(E=t.indexOf(o,E+1))&&""===n(t.slice(l,E))){E=l;break}}return c=t.slice(0,E),""===n(c)?(e(c),null):!!a||(p=e.now(),e(c=r(c))({type:"paragraph",children:m.tokenizeInline(c,p)}))};var o="\n"},function(e,t,a){"use strict";var n=a(1111);function i(e,t,a){var n,i;if("\\"===t.charAt(0)&&(n=t.charAt(1),-1!==this.escape.indexOf(n)))return!!a||(i="\n"===n?{type:"break"}:{type:"text",value:n},e("\\"+n)(i))}e.exports=i,i.locator=n},function(e,t,a){"use strict";e.exports=function(e,t){return e.indexOf("\\",t)}},function(e,t,a){"use strict";var n=a(266),i=a(569),r=a(778);e.exports=l,l.locator=r,l.notInLink=!0;var s="mailto:",o=s.length;function l(e,t,a){var r,l,c,u,d,p,m,g,f,b,h,y;if("<"===t.charAt(0)){for(r=this,l="",c=t.length,u=0,d="",m=!1,g="",u++,l="<";u<c&&(p=t.charAt(u),!(n(p)||">"===p||"@"===p||":"===p&&"/"===t.charAt(u+1)));)d+=p,u++;if(d){if(g+=d,d="",g+=p=t.charAt(u),u++,"@"===p)m=!0;else{if(":"!==p||"/"!==t.charAt(u+1))return;g+="/",u++}for(;u<c&&(p=t.charAt(u),!n(p)&&">"!==p);)d+=p,u++;if(p=t.charAt(u),d&&">"===p)return!!a||(b=g+=d,l+=g+p,(f=e.now()).column++,f.offset++,m&&(g.slice(0,o).toLowerCase()===s?(b=b.substr(o),f.column+=o,f.offset+=o):g=s+g),h=r.inlineTokenizers,r.inlineTokenizers={text:h.text},y=r.enterLink(),b=r.tokenizeInline(b,f),r.inlineTokenizers=h,y(),e(l)({type:"link",title:null,url:i(g,{nonTerminated:!1}),children:b}))}}}},function(e,t,a){"use strict";var n=a(569),i=a(266),r=a(1114);e.exports=c,c.locator=r,c.notInLink=!0;var s="mailto:",o=["http://","https://",s],l=o.length;function c(e,t,a){var r,c,u,d,p,m,g,f,b,h,y,E,v=this;if(v.options.gfm){for(r="",d=-1,f=l;++d<f;)if(m=o[d],(g=t.slice(0,m.length)).toLowerCase()===m){r=g;break}if(r){for(d=r.length,f=t.length,b="",h=0;d<f&&(u=t.charAt(d),!i(u)&&"<"!==u)&&("."!==u&&","!==u&&":"!==u&&";"!==u&&'"'!==u&&"'"!==u&&")"!==u&&"]"!==u||(y=t.charAt(d+1))&&!i(y))&&("("!==u&&"["!==u||h++,")"!==u&&"]"!==u||!(--h<0));)b+=u,d++;if(b){if(c=r+=b,m===s){if(-1===(p=b.indexOf("@"))||p===f-1)return;c=c.substr(s.length)}return!!a||(E=v.enterLink(),c=v.tokenizeInline(c,e.now()),E(),e(r)({type:"link",title:null,url:n(r,{nonTerminated:!1}),children:c}))}}}}},function(e,t,a){"use strict";e.exports=function(e,t){var a,i=n.length,r=-1,s=-1;if(!this.options.gfm)return-1;for(;++r<i;)-1!==(a=e.indexOf(n[r],t))&&(a<s||-1===s)&&(s=a);return s};var n=["https://","http://","mailto:"]},function(e,t,a){"use strict";var n=a(1116),i=a(778),r=a(777).tag;e.exports=l,l.locator=i;var s=/^<a /i,o=/^<\/a>/i;function l(e,t,a){var i,l,c=this,u=t.length;if(!("<"!==t.charAt(0)||u<3)&&(i=t.charAt(1),(n(i)||"?"===i||"!"===i||"/"===i)&&(l=t.match(r))))return!!a||(l=l[0],!c.inLink&&s.test(l)?c.inLink=!0:c.inLink&&o.test(l)&&(c.inLink=!1),e(l)({type:"html",value:l}))}},function(e,t,a){e.exports=a(24)(570)},function(e,t,a){"use strict";var n=a(266),i=a(779);e.exports=u,u.locator=i;var r={}.hasOwnProperty,s="\\",o=")",l={'"':'"',"'":"'"},c={};function u(e,t,a){var i,u,d,p,m,g,f,b,h,y,E,v,T,k,x,S,O,w,j,C=this,I="",M=0,A=t.charAt(0),D=C.options.pedantic,q=C.options.commonmark,P=C.options.gfm;if("!"===A&&(h=!0,I=A,A=t.charAt(++M)),"["===A&&(h||!C.inLink)){for(I+=A,x="",M++,v=t.length,k=0,(O=e.now()).column+=M,O.offset+=M;M<v;){if(g=A=t.charAt(M),"`"===A){for(u=1;"`"===t.charAt(M+1);)g+=A,M++,u++;d?u>=d&&(d=0):d=u}else if(A===s)M++,g+=t.charAt(M);else if(d&&!P||"["!==A){if((!d||P)&&"]"===A){if(!k){if(!D)for(;M<v&&(A=t.charAt(M+1),n(A));)g+=A,M++;if("("!==t.charAt(M+1))return;g+="(",i=!0,M++;break}k--}}else k++;x+=g,g="",M++}if(i){for(y=x,I+=x+g,M++;M<v&&(A=t.charAt(M),n(A));)I+=A,M++;if(A=t.charAt(M),b=q?c:l,x="",p=I,"<"===A){for(M++,p+="<";M<v&&">"!==(A=t.charAt(M));){if(q&&"\n"===A)return;x+=A,M++}if(">"!==t.charAt(M))return;I+="<"+x+">",S=x,M++}else{for(A=null,g="";M<v&&(A=t.charAt(M),!g||!r.call(b,A));){if(n(A)){if(!D)break;g+=A}else{if("("===A)k++;else if(A===o){if(0===k)break;k--}x+=g,g="",A===s&&(x+=s,A=t.charAt(++M)),x+=A}M++}S=x,M=(I+=x).length}for(x="";M<v&&(A=t.charAt(M),n(A));)x+=A,M++;if(A=t.charAt(M),I+=x,x&&r.call(b,A))if(M++,I+=A,x="",E=b[A],m=I,q){for(;M<v&&(A=t.charAt(M))!==E;)A===s&&(x+=s,A=t.charAt(++M)),M++,x+=A;if((A=t.charAt(M))!==E)return;for(T=x,I+=x+A,M++;M<v&&(A=t.charAt(M),n(A));)I+=A,M++}else for(g="";M<v;){if((A=t.charAt(M))===E)f&&(x+=E+g,g=""),f=!0;else if(f){if(A===o){I+=x+E+g,T=x;break}n(A)?g+=A:(x+=E+g+A,g="",f=!1)}else x+=A;M++}if(t.charAt(M)===o)return!!a||(I+=o,S=C.decode.raw(C.unescape(S),e(p).test().end,{nonTerminated:!1}),T&&(m=e(m).test().end,T=C.decode.raw(C.unescape(T),m)),j={type:h?"image":"link",title:T||null,url:S},h?j.alt=C.decode.raw(C.unescape(y),O)||null:(w=C.enterLink(),j.children=C.tokenizeInline(y,O),w()),e(I)(j))}}}c['"']='"',c["'"]="'",c["("]=o},function(e,t,a){"use strict";var n=a(266),i=a(779),r=a(574);e.exports=m,m.locator=i;var s="link",o="image",l="footnote",c="full",u="\\",d="[",p="]";function m(e,t,a){var i,m,g,f,b,h,y,E,v=this,T=t.charAt(0),k=0,x=t.length,S="",O="",w=s,j="shortcut";if("!"===T&&(w=o,O=T,T=t.charAt(++k)),T===d){if(k++,O+=T,h="",v.options.footnotes&&"^"===t.charAt(k)){if(w===o)return;O+="^",k++,w=l}for(E=0;k<x;){if((T=t.charAt(k))===d)y=!0,E++;else if(T===p){if(!E)break;E--}T===u&&(h+=u,T=t.charAt(++k)),h+=T,k++}if(S=h,i=h,(T=t.charAt(k))===p){for(k++,S+=T,h="";k<x&&(T=t.charAt(k),n(T));)h+=T,k++;if(T=t.charAt(k),w!==l&&T===d){for(m="",h+=T,k++;k<x&&(T=t.charAt(k))!==d&&T!==p;)T===u&&(m+=u,T=t.charAt(++k)),m+=T,k++;(T=t.charAt(k))===p?(j=m?c:"collapsed",h+=m+T,k++):m="",S+=h,h=""}else{if(!i)return;m=i}if(j===c||!y)return S=O+S,w===s&&v.inLink?null:!!a||(w===l&&-1!==i.indexOf(" ")?e(S)({type:"footnote",children:this.tokenizeInline(i,e.now())}):((g=e.now()).column+=O.length,g.offset+=O.length,f={type:w+"Reference",identifier:r(m=j===c?m:i)},w!==s&&w!==o||(f.referenceType=j),w===s?(b=v.enterLink(),f.children=v.tokenizeInline(i,g),b()):w===o&&(f.alt=v.decode.raw(v.unescape(i),g)||null),e(S)(f)))}}}},function(e,t,a){"use strict";var n=a(386),i=a(266),r=a(1120);function s(e,t,a){var r,s,o,l,c,u,d,p=0,m=t.charAt(p);if(!("*"!==m&&"_"!==m||t.charAt(++p)!==m||(s=this.options.pedantic,c=(o=m)+o,u=t.length,p++,l="",m="",s&&i(t.charAt(p)))))for(;p<u;){if(d=m,!((m=t.charAt(p))!==o||t.charAt(p+1)!==o||s&&i(d))&&(m=t.charAt(p+2))!==o){if(!n(l))return;return!!a||((r=e.now()).column+=2,r.offset+=2,e(c+l+c)({type:"strong",children:this.tokenizeInline(l,r)}))}s||"\\"!==m||(l+=m,m=t.charAt(++p)),l+=m,p++}}e.exports=s,s.locator=r},function(e,t,a){"use strict";e.exports=function(e,t){var a=e.indexOf("**",t),n=e.indexOf("__",t);return-1===n?a:-1===a||n<a?n:a}},function(e,t,a){"use strict";var n=a(386),i=a(1122),r=a(266),s=a(1123);function o(e,t,a){var s,o,l,c,u,d,p,m=0,g=t.charAt(m);if(!("*"!==g&&"_"!==g||(o=this.options.pedantic,u=g,l=g,d=t.length,m++,c="",g="",o&&r(t.charAt(m)))))for(;m<d;){if(p=g,!((g=t.charAt(m))!==l||o&&r(p))){if((g=t.charAt(++m))!==l){if(!n(c)||p===l)return;if(!o&&"_"===l&&i(g)){c+=l;continue}return!!a||((s=e.now()).column++,s.offset++,e(u+c+l)({type:"emphasis",children:this.tokenizeInline(c,s)}))}c+=l}o||"\\"!==g||(c+=g,g=t.charAt(++m)),c+=g,m++}}e.exports=o,o.locator=s},function(e,t,a){e.exports=a(24)(3273)},function(e,t,a){"use strict";e.exports=function(e,t){var a=e.indexOf("*",t),n=e.indexOf("_",t);return-1===n?a:-1===a||n<a?n:a}},function(e,t,a){"use strict";var n=a(266),i=a(1125);e.exports=s,s.locator=i;var r="~";function s(e,t,a){var i,s,o,l="",c="",u="",d="";if(this.options.gfm&&t.charAt(0)===r&&t.charAt(1)===r&&!n(t.charAt(2)))for(i=1,s=t.length,(o=e.now()).column+=2,o.offset+=2;++i<s;){if(!((l=t.charAt(i))!==r||c!==r||u&&n(u)))return!!a||e("~~"+d+"~~")({type:"delete",children:this.tokenizeInline(d,o)});d+=c,u=c,c=l}}},function(e,t,a){"use strict";e.exports=function(e,t){return e.indexOf("~~",t)}},function(e,t,a){"use strict";var n=a(266),i=a(1127);e.exports=s,s.locator=i;var r="`";function s(e,t,a){for(var i,s,o,l,c,u,d,p,m=t.length,g=0,f="",b="";g<m&&t.charAt(g)===r;)f+=r,g++;if(f){for(c=f,l=g,f="",p=t.charAt(g),o=0;g<m;){if(u=p,p=t.charAt(g+1),u===r?(o++,b+=u):(o=0,f+=u),o&&p!==r){if(o===l){c+=f+b,d=!0;break}f+=b,b=""}g++}if(!d){if(l%2!=0)return;f=""}if(a)return!0;for(i="",s="",m=f.length,g=-1;++g<m;)u=f.charAt(g),n(u)?s+=u:(s&&(i&&(i+=s),s=""),i+=u);return e(c)({type:"inlineCode",value:i})}}},function(e,t,a){"use strict";e.exports=function(e,t){return e.indexOf("`",t)}},function(e,t,a){"use strict";var n=a(1129);function i(e,t,a){for(var n,i=t.length,r=-1,s="";++r<i;){if("\n"===(n=t.charAt(r))){if(r<2)return;return!!a||e(s+=n)({type:"break"})}if(" "!==n)return;s+=n}}e.exports=i,i.locator=n},function(e,t,a){"use strict";e.exports=function(e,t){for(var a=e.indexOf("\n",t);a>t&&" "===e.charAt(a-1);)a--;return a}},function(e,t,a){"use strict";e.exports=function(e,t,a){var n,i,r,s,o,l,c,u,d,p,m=this;if(a)return!0;for(s=(n=m.inlineMethods).length,i=m.inlineTokenizers,r=-1,d=t.length;++r<s;)"text"!==(u=n[r])&&i[u]&&((c=i[u].locator)||e.file.fail("Missing locator: `"+u+"`"),-1!==(l=c.call(m,t,1))&&l<d&&(d=l));o=t.slice(0,d),p=e.now(),m.decode(o,p,(function(t,a,n){e(n||t)({type:"text",value:t})}))}},function(e,t,a){var n=a(1132);e.exports=function(){return function(e){return n(e,"list",(function(e,t){var a,n,i=0;for(a=0,n=t.length;a<n;a++)"list"===t[a].type&&(i+=1);for(a=0,n=e.children.length;a<n;a++){var r=e.children[a];r.index=a,r.ordered=e.ordered}e.depth=i})),e}}},function(e,t,a){"use strict";e.exports=function(e,t,a){var n=[];"function"==typeof t&&(a=t,t=null),function e(i){var r;return t&&i.type!==t||(r=a(i,n.concat())),i.children&&!1!==r?function(t,a){var i,r=t.length,s=-1;for(n.push(a);++s<r;)if((i=t[s])&&!1===e(i))return!1;return n.pop(),!0}(i.children,i):r}(e)}},function(e,t,a){"use strict";var n=a(478),i="virtualHtml",r=/^<(area|base|br|col|embed|hr|img|input|keygen|link|meta|param|source|track|wbr)\s*\/?>$/i,s=/^<(\/?)([a-z]+)\s*>$/;e.exports=function(e){var t,a;return n(e,"html",(function(e,n,o){a!==o&&(t=[],a=o);var l=function(e){var t=e.value.match(r);return!!t&&t[1]}(e);if(l)return o.children.splice(n,1,{type:i,tag:l,position:e.position}),!0;var c=function(e,t){var a=e.value.match(s);return!!a&&{tag:a[2],opening:!a[1],node:e}}(e);if(!c)return!0;var u=function(e,t){for(var a=e.length;a--;)if(e[a].tag===t)return e.splice(a,1)[0];return!1}(t,c.tag);return u?o.children.splice(n,0,function(e,t,a){var n=a.children.indexOf(e.node),r=a.children.indexOf(t.node),s=a.children.splice(n,r-n+1).slice(1,-1);return{type:i,children:s,tag:e.tag,position:{start:e.node.position.start,end:t.node.position.end,indent:[]}}}(c,u,o)):c.opening||t.push(c),!0}),!0),e}},function(e,t,a){"use strict";var n=a(478);function i(e,t,a,n){if("remove"===n)a.children.splice(t,1);else if("unwrap"===n){var i=[t,1];e.children&&(i=i.concat(e.children)),Array.prototype.splice.apply(a.children,i)}}t.ofType=function(e,t){return function(t){return e.forEach((function(e){return n(t,e,a,!0)})),t};function a(e,a,n){n&&i(e,a,n,t)}},t.ifNotMatch=function(e,t){return function(e){return n(e,a,!0),e};function a(a,n,r){r&&!e(a,n,r)&&i(a,n,r,t)}}},function(e,t,a){"use strict";var n=a(5),i=a(318),r=a(142),s={start:{line:1,column:1,offset:0},end:{line:1,column:1,offset:0}};function o(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,c=t.renderers[e.type];void 0===e.position&&(e.position=a.node&&a.node.position||s);var u=e.position.start,d=[e.type,u.line,u.column,i].join("-");if(!r.isValidElementType(c))throw new Error("Renderer for type `".concat(e.type,"` not defined or is not renderable"));var p=l(e,d,t,c,a,i);return n.createElement(c,p,p.children||m()||void 0);function m(){return e.children&&e.children.map((function(a,n){return o(a,t,{node:e,props:p},n)}))}}function l(e,t,a,r,s,l){var u,d={key:t},p="string"==typeof r;a.sourcePos&&e.position&&(d["data-sourcepos"]=[(u=e.position).start.line,":",u.start.column,"-",u.end.line,":",u.end.column].map(String).join("")),a.rawSourcePos&&!p&&(d.sourcePosition=e.position),a.includeNodeIndex&&s.node&&s.node.children&&!p&&(d.index=s.node.children.indexOf(e),d.parentChildCount=s.node.children.length);var m=null!==e.identifier&&void 0!==e.identifier?a.definitions[e.identifier]||{}:null;switch(e.type){case"root":c(d,{className:a.className});break;case"text":d.nodeKey=t,d.children=e.value;break;case"heading":d.level=e.depth;break;case"list":d.start=e.start,d.ordered=e.ordered,d.tight=!e.loose,d.depth=e.depth;break;case"listItem":d.checked=e.checked,d.tight=!e.loose,d.ordered=e.ordered,d.index=e.index,d.children=function(e,t){return e.loose||t.node&&e.index>0&&t.node.children[e.index-1].loose?e.children:function(e){return e.children.reduce((function(e,t){return e.concat("paragraph"===t.type?t.children||[]:[t])}),[])}(e)}(e,s).map((function(t,n){return o(t,a,{node:e,props:d},n)}));break;case"definition":c(d,{identifier:e.identifier,title:e.title,url:e.url});break;case"code":c(d,{language:e.lang&&e.lang.split(/\s/,1)[0]});break;case"inlineCode":d.children=e.value,d.inline=!0;break;case"link":c(d,{title:e.title||void 0,target:"function"==typeof a.linkTarget?a.linkTarget(e.url,e.children,e.title):a.linkTarget,href:a.transformLinkUri?a.transformLinkUri(e.url,e.children,e.title):e.url});break;case"image":c(d,{alt:e.alt||void 0,title:e.title||void 0,src:a.transformImageUri?a.transformImageUri(e.url,e.children,e.title,e.alt):e.url});break;case"linkReference":c(d,i(m,{href:a.transformLinkUri?a.transformLinkUri(m.href):m.href}));break;case"imageReference":c(d,{src:a.transformImageUri&&m.href?a.transformImageUri(m.href,e.children,m.title,e.alt):m.href,title:m.title||void 0,alt:e.alt||void 0});break;case"table":case"tableHead":case"tableBody":d.columnAlignment=e.align;break;case"tableRow":d.isHeader="tableHead"===s.node.type,d.columnAlignment=s.props.columnAlignment;break;case"tableCell":c(d,{isHeader:s.props.isHeader,align:s.props.columnAlignment[l]});break;case"virtualHtml":d.tag=e.tag;break;case"html":d.isBlock=e.position.start.line!==e.position.end.line,d.escapeHtml=a.escapeHtml,d.skipHtml=a.skipHtml;break;case"parsedHtml":var g;e.children&&(g=e.children.map((function(t,n){return o(t,a,{node:e,props:d},n)}))),d.escapeHtml=a.escapeHtml,d.skipHtml=a.skipHtml,d.element=function(e,t){var a=e.element;if(Array.isArray(a)){var i=n.Fragment||"div";return n.createElement(i,null,a)}if(a.props.children||t){var r=n.Children.toArray(a.props.children).concat(t);return n.cloneElement(a,null,r)}return n.cloneElement(a,null)}(e,g);break;default:c(d,i(e,{type:void 0,position:void 0,children:void 0}))}return!p&&e.value&&(d.value=e.value),d}function c(e,t){for(var a in t)void 0!==t[a]&&(e[a]=t[a])}e.exports=o},function(e,t,a){"use strict";var n=a(478);function i(e){var t=e.children;e.children=[{type:"tableHead",align:e.align,children:[t[0]],position:t[0].position}],t.length>1&&e.children.push({type:"tableBody",align:e.align,children:t.slice(1),position:{start:t[1].position.start,end:t[t.length-1].position.end}})}e.exports=function(e){return n(e,"table",i),e}},function(e,t,a){"use strict";e.exports=function e(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(t.children||[]).reduce((function(t,a){return"definition"===a.type&&(t[a.identifier]={href:a.url,title:a.title}),e(a,t)}),a)}},function(e,t,a){"use strict";var n=["http","https","mailto","tel"];e.exports=function(e){var t=(e||"").trim(),a=t.charAt(0);if("#"===a||"/"===a)return t;var i=t.indexOf(":");if(-1===i)return t;for(var r=n.length,s=-1;++s<r;){var o=n[s];if(i===o.length&&t.slice(0,o.length).toLowerCase()===o)return t}return-1!==(s=t.indexOf("?"))&&i>s||-1!==(s=t.indexOf("#"))&&i>s?t:"javascript:void(0)"}},function(e,t,a){"use strict";var n=a(318),i=a(5),r=parseInt((i.version||"16").slice(0,2),10)>=16,s=i.createElement;function o(e,t){return s(e,l(t),t.children)}function l(e){return e["data-sourcepos"]?{"data-sourcepos":e["data-sourcepos"]}:{}}e.exports={break:"br",paragraph:"p",emphasis:"em",strong:"strong",thematicBreak:"hr",blockquote:"blockquote",delete:"del",link:"a",image:"img",linkReference:"a",imageReference:"img",table:o.bind(null,"table"),tableHead:o.bind(null,"thead"),tableBody:o.bind(null,"tbody"),tableRow:o.bind(null,"tr"),tableCell:function(e){var t=e.align?{textAlign:e.align}:void 0,a=l(e);return s(e.isHeader?"th":"td",t?n({style:t},a):a,e.children)},root:function(e){var t=!e.className,a=t&&i.Fragment||"div";return s(a,t?null:e,e.children)},text:function(e){return r?e.children:s("span",null,e.children)},list:function(e){var t=l(e);return null!==e.start&&1!==e.start&&void 0!==e.start&&(t.start=e.start.toString()),s(e.ordered?"ol":"ul",t,e.children)},listItem:function(e){var t=null;if(null!==e.checked&&void 0!==e.checked){var a=e.checked;t=s("input",{type:"checkbox",checked:a,readOnly:!0})}return s("li",l(e),t,e.children)},definition:function(){return null},heading:function(e){return s("h".concat(e.level),l(e),e.children)},inlineCode:function(e){return s("code",l(e),e.children)},code:function(e){var t=e.language&&"language-".concat(e.language),a=s("code",t?{className:t}:null,e.value);return s("pre",l(e),a)},html:function(e){if(e.skipHtml)return null;var t=e.isBlock?"div":"span";if(e.escapeHtml){var a=i.Fragment||t;return s(a,null,e.value)}var n={dangerouslySetInnerHTML:{__html:e.value}};return s(t,n)},virtualHtml:function(e){return s(e.tag,l(e),e.children)},parsedHtml:function(e){return e["data-sourcepos"]?i.cloneElement(e.element,{"data-sourcepos":e["data-sourcepos"]}):e.element}}},function(e,t,a){"use strict";var n="__RMD_HTML_PARSER__";t.HtmlParser="undefined"==typeof Symbol?n:Symbol(n)},function(e,t,a){var n,i,r,s;
/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */s=function(e){var t=Object.prototype.toString,a=Array.isArray||function(e){return"[object Array]"===t.call(e)};function n(e){return"function"==typeof e}function i(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function r(e,t){return null!=e&&"object"==typeof e&&t in e}var s=RegExp.prototype.test,o=/\S/;var l={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},c=/\s*/,u=/\s+/,d=/\s*=/,p=/\s*\}/,m=/#|\^|\/|>|\{|&|=|!/;function g(e){this.string=e,this.tail=e,this.pos=0}function f(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function b(){this.cache={}}g.prototype.eos=function(){return""===this.tail},g.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return"";var a=t[0];return this.tail=this.tail.substring(a.length),this.pos+=a.length,a},g.prototype.scanUntil=function(e){var t,a=this.tail.search(e);switch(a){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,a),this.tail=this.tail.substring(a)}return this.pos+=t.length,t},f.prototype.push=function(e){return new f(e,this)},f.prototype.lookup=function(e){var t,a=this.cache;if(a.hasOwnProperty(e))t=a[e];else{for(var i,s,o=this,l=!1;o;){if(e.indexOf(".")>0)for(t=o.view,i=e.split("."),s=0;null!=t&&s<i.length;)s===i.length-1&&(l=r(t,i[s])),t=t[i[s++]];else t=o.view[e],l=r(o.view,e);if(l)break;o=o.parent}a[e]=t}return n(t)&&(t=t.call(this.view)),t},b.prototype.clearCache=function(){this.cache={}},b.prototype.parse=function(t,n){var r=this.cache,l=r[t];return null==l&&(l=r[t]=function(t,n){if(!t)return[];var r,l,f,b,h=[],y=[],E=[],v=!1,T=!1;function k(){if(v&&!T)for(;E.length;)delete y[E.pop()];else E=[];v=!1,T=!1}function x(e){if("string"==typeof e&&(e=e.split(u,2)),!a(e)||2!==e.length)throw new Error("Invalid tags: "+e);r=new RegExp(i(e[0])+"\\s*"),l=new RegExp("\\s*"+i(e[1])),f=new RegExp("\\s*"+i("}"+e[1]))}x(n||e.tags);for(var S,O,w,j,C,I,M=new g(t);!M.eos();){if(S=M.pos,w=M.scanUntil(r))for(var A=0,D=w.length;A<D;++A)b=j=w.charAt(A),function(e,t){return s.call(e,t)}(o,b)?T=!0:E.push(y.length),y.push(["text",j,S,S+1]),S+=1,"\n"===j&&k();if(!M.scan(r))break;if(v=!0,O=M.scan(m)||"name",M.scan(c),"="===O?(w=M.scanUntil(d),M.scan(d),M.scanUntil(l)):"{"===O?(w=M.scanUntil(f),M.scan(p),M.scanUntil(l),O="&"):w=M.scanUntil(l),!M.scan(l))throw new Error("Unclosed tag at "+M.pos);if(C=[O,w,S,M.pos],y.push(C),"#"===O||"^"===O)h.push(C);else if("/"===O){if(!(I=h.pop()))throw new Error('Unopened section "'+w+'" at '+S);if(I[1]!==w)throw new Error('Unclosed section "'+I[1]+'" at '+S)}else"name"===O||"{"===O||"&"===O?T=!0:"="===O&&x(w)}if(I=h.pop())throw new Error('Unclosed section "'+I[1]+'" at '+M.pos);return function(e){for(var t,a=[],n=a,i=[],r=0,s=e.length;r<s;++r)switch((t=e[r])[0]){case"#":case"^":n.push(t),i.push(t),n=t[4]=[];break;case"/":i.pop()[5]=t[2],n=i.length>0?i[i.length-1][4]:a;break;default:n.push(t)}return a}(function(e){for(var t,a,n=[],i=0,r=e.length;i<r;++i)(t=e[i])&&("text"===t[0]&&a&&"text"===a[0]?(a[1]+=t[1],a[3]=t[3]):(n.push(t),a=t));return n}(y))}(t,n)),l},b.prototype.render=function(e,t,a){var n=this.parse(e),i=t instanceof f?t:new f(t);return this.renderTokens(n,i,a,e)},b.prototype.renderTokens=function(e,t,a,n){for(var i,r,s,o="",l=0,c=e.length;l<c;++l)s=void 0,"#"===(r=(i=e[l])[0])?s=this.renderSection(i,t,a,n):"^"===r?s=this.renderInverted(i,t,a,n):">"===r?s=this.renderPartial(i,t,a,n):"&"===r?s=this.unescapedValue(i,t):"name"===r?s=this.escapedValue(i,t):"text"===r&&(s=this.rawValue(i)),void 0!==s&&(o+=s);return o},b.prototype.renderSection=function(e,t,i,r){var s=this,o="",l=t.lookup(e[1]);if(l){if(a(l))for(var c=0,u=l.length;c<u;++c)o+=this.renderTokens(e[4],t.push(l[c]),i,r);else if("object"==typeof l||"string"==typeof l||"number"==typeof l)o+=this.renderTokens(e[4],t.push(l),i,r);else if(n(l)){if("string"!=typeof r)throw new Error("Cannot use higher-order sections without the original template");null!=(l=l.call(t.view,r.slice(e[3],e[5]),(function(e){return s.render(e,t,i)})))&&(o+=l)}else o+=this.renderTokens(e[4],t,i,r);return o}},b.prototype.renderInverted=function(e,t,n,i){var r=t.lookup(e[1]);if(!r||a(r)&&0===r.length)return this.renderTokens(e[4],t,n,i)},b.prototype.renderPartial=function(e,t,a){if(a){var i=n(a)?a(e[1]):a[e[1]];return null!=i?this.renderTokens(this.parse(i),t,a,i):void 0}},b.prototype.unescapedValue=function(e,t){var a=t.lookup(e[1]);if(null!=a)return a},b.prototype.escapedValue=function(t,a){var n=a.lookup(t[1]);if(null!=n)return e.escape(n)},b.prototype.rawValue=function(e){return e[1]},e.name="mustache.js",e.version="2.3.2",e.tags=["{{","}}"];var h=new b;return e.clearCache=function(){return h.clearCache()},e.parse=function(e,t){return h.parse(e,t)},e.render=function(e,t,n){if("string"!=typeof e)throw new TypeError('Invalid template! Template should be a "string" but "'+(a(i=e)?"array":typeof i)+'" was given as the first argument for mustache#render(template, view, partials)');var i;return h.render(e,t,n)},e.to_html=function(t,a,i,r){var s=e.render(t,a,i);if(!n(r))return s;r(s)},e.escape=function(e){return String(e).replace(/[&<>"'`=\/]/g,(function(e){return l[e]}))},e.Scanner=g,e.Context=f,e.Writer=b,e},t&&"string"!=typeof t.nodeName?s(t):(i=[t],void 0===(r="function"==typeof(n=s)?n.apply(t,i):n)||(e.exports=r))},function(e,t,a){e.exports=a.p+"ae37f7e28b2ba3954b127510d84d3ac5.svg"},function(e,t,a){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n,i=a(1144);Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===i[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}}))})),void 0!==e&&null!=(n=Object({IS_KIBANA_DISTRIBUTABLE:"true"}))&&n.RTL_SKIP_AUTO_CLEANUP||("function"==typeof afterEach?afterEach((()=>{(0,i.cleanup)()})):"function"==typeof teardown&&teardown((()=>{(0,i.cleanup)()})))}).call(this,a(359))},function(e,t,a){"use strict";var n=a(34);Object.defineProperty(t,"__esModule",{value:!0});var i={render:!0,cleanup:!0,act:!0,fireEvent:!0};Object.defineProperty(t,"act",{enumerable:!0,get:function(){return l.default}}),t.cleanup=function(){p.forEach(m)},Object.defineProperty(t,"fireEvent",{enumerable:!0,get:function(){return c.fireEvent}}),t.render=function e(t,{container:a,baseElement:n=a,queries:i,hydrate:c=!1,wrapper:u}={}){n||(n=document.body),a||(a=n.appendChild(document.createElement("div"))),p.add(a);const d=e=>u?r.createElement(u,null,e):e;return(0,l.default)((()=>{c?s.default.hydrate(d(t),a):s.default.render(d(t),a)})),{container:a,baseElement:n,debug:(e=n,t,a)=>Array.isArray(e)?e.forEach((e=>console.log((0,o.prettyDOM)(e,t,a)))):console.log((0,o.prettyDOM)(e,t,a)),unmount:()=>{(0,l.default)((()=>{s.default.unmountComponentAtNode(a)}))},rerender:t=>{e(d(t),{container:a,baseElement:n})},asFragment:()=>{if("function"==typeof document.createRange)return document.createRange().createContextualFragment(a.innerHTML);{const e=document.createElement("template");return e.innerHTML=a.innerHTML,e.content}},...(0,o.getQueriesForElement)(n,i)}};var r=d(a(5)),s=n(a(138)),o=a(780);Object.keys(o).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(i,e)||e in t&&t[e]===o[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}}))}));var l=d(a(1317)),c=a(1322);function u(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(u=function(e){return e?a:t})(e)}function d(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var a=u(t);if(a&&a.has(e))return a.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if("default"!==r&&Object.prototype.hasOwnProperty.call(e,r)){var s=i?Object.getOwnPropertyDescriptor(e,r):null;s&&(s.get||s.set)?Object.defineProperty(n,r,s):n[r]=e[r]}return n.default=e,a&&a.set(e,n),n}(0,o.configure)({asyncWrapper:async e=>{let t;return await(0,l.asyncAct)((async()=>{t=await e()})),t},eventWrapper:e=>{let t;return(0,l.default)((()=>{t=e()})),t}});const p=new Set;function m(e){(0,l.default)((()=>{s.default.unmountComponentAtNode(e)})),e.parentNode===document.body&&document.body.removeChild(e),p.delete(e)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.queryByLabelText=t.queryAllByLabelText=t.getByLabelText=t.getAllByLabelText=t.findByLabelText=t.findAllByLabelText=void 0;var n=a(319),i=a(253),r=a(783),s=a(320);const o=(e,t,{selector:a="*",exact:n=!0,collapseWhitespace:o,trim:l,normalizer:c}={})=>{(0,i.checkContainerType)(e);const u=n?s.matches:s.fuzzyMatches,d=(0,s.makeNormalizer)({collapseWhitespace:o,trim:l,normalizer:c}),p=Array.from(e.querySelectorAll("*")).filter((e=>(0,r.getRealLabels)(e).length||e.hasAttribute("aria-labelledby"))).reduce(((n,i)=>{const s=(0,r.getLabels)(e,i,{selector:a});s.filter((e=>Boolean(e.formControl))).forEach((e=>{u(e.content,e.formControl,t,d)&&e.formControl&&n.push(e.formControl)}));const o=s.filter((e=>Boolean(e.content))).map((e=>e.content));return u(o.join(" "),i,t,d)&&n.push(i),o.length>1&&o.forEach(((e,a)=>{u(e,i,t,d)&&n.push(i);const r=[...o];r.splice(a,1),r.length>1&&u(r.join(" "),i,t,d)&&n.push(i)})),n}),[]).concat((0,s.queryAllByAttribute)("aria-label",e,t,{exact:n,normalizer:d}));return Array.from(new Set(p)).filter((e=>e.matches(a)))},l=(e,t,...a)=>{const i=o(e,t,...a);if(!i.length){const i=((e,t,{exact:a=!0,trim:n,collapseWhitespace:i,normalizer:o}={})=>{const l=a?s.matches:s.fuzzyMatches,c=(0,s.makeNormalizer)({collapseWhitespace:i,trim:n,normalizer:o}),u=function(e){return Array.from(e.querySelectorAll("label,input")).map((e=>({node:e,textToMatch:(0,r.getLabelContent)(e)}))).filter((({textToMatch:e})=>null!==e))}(e);return u.filter((({node:e,textToMatch:a})=>l(a,e,t,c))).map((({node:e})=>e))})(e,t,...a);if(i.length){const a=i.map((t=>function(e,t){const a=t.getAttribute("for");if(!a)return null;const n=e.querySelector(`[id="${a}"]`);return n?n.tagName.toLowerCase():null}(e,t))).filter((e=>!!e));throw a.length?(0,n.getConfig)().getElementError(a.map((e=>`Found a label with the text of: ${t}, however the element associated with this label (<${e} />) is non-labellable [https://html.spec.whatwg.org/multipage/forms.html#category-label]. If you really need to label a <${e} />, you can use aria-label or aria-labelledby instead.`)).join("\n\n"),e):(0,n.getConfig)().getElementError(`Found a label with the text of: ${t}, however no form control was found associated to that label. Make sure you're using the "for" attribute or "aria-labelledby" attribute correctly.`,e)}throw(0,n.getConfig)().getElementError(`Unable to find a label with the text of: ${t}`,e)}return i},c=(e,t)=>`Found multiple elements with the text of: ${t}`,u=(0,s.wrapSingleQueryWithSuggestion)((0,s.makeSingleQuery)(o,c),o.name,"query");t.queryByLabelText=u;const d=(0,s.makeSingleQuery)(l,c),p=(0,s.makeFindQuery)((0,s.wrapAllByQueryWithSuggestion)(l,l.name,"findAll"));t.findAllByLabelText=p;const m=(0,s.makeFindQuery)((0,s.wrapSingleQueryWithSuggestion)(d,l.name,"find"));t.findByLabelText=m;const g=(0,s.wrapAllByQueryWithSuggestion)(l,l.name,"getAll");t.getAllByLabelText=g;const f=(0,s.wrapSingleQueryWithSuggestion)(d,l.name,"get");t.getByLabelText=f;const b=(0,s.wrapAllByQueryWithSuggestion)(o,o.name,"queryAll");t.queryAllByLabelText=b},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.DEFAULT_OPTIONS=void 0,t.format=_,t.plugins=void 0;var n=p(a(782)),i=a(483),r=p(a(1147)),s=p(a(1148)),o=p(a(1150)),l=p(a(1151)),c=p(a(1153)),u=p(a(1154)),d=p(a(1157));function p(e){return e&&e.__esModule?e:{default:e}}const m=Object.prototype.toString,g=Date.prototype.toISOString,f=Error.prototype.toString,b=RegExp.prototype.toString,h=e=>"function"==typeof e.constructor&&e.constructor.name||"Object",y=/^Symbol\((.*)\)(.*)$/,E=/\n/gi;class PrettyFormatPluginError extends Error{constructor(e,t){super(e),this.stack=t,this.name=this.constructor.name}}function v(e,t){return t?"[Function "+(e.name||"anonymous")+"]":"[Function]"}function T(e){return String(e).replace(y,"Symbol($1)")}function k(e){return"["+f.call(e)+"]"}function x(e,t,a,n){if(!0===e||!1===e)return""+e;if(void 0===e)return"undefined";if(null===e)return"null";const i=typeof e;if("number"===i)return function(e){return Object.is(e,-0)?"-0":String(e)}(e);if("bigint"===i)return function(e){return String(`${e}n`)}(e);if("string"===i)return n?'"'+e.replace(/"|\\/g,"\\$&")+'"':'"'+e+'"';if("function"===i)return v(e,t);if("symbol"===i)return T(e);const r=m.call(e);return"[object WeakMap]"===r?"WeakMap {}":"[object WeakSet]"===r?"WeakSet {}":"[object Function]"===r||"[object GeneratorFunction]"===r?v(e,t):"[object Symbol]"===r?T(e):"[object Date]"===r?isNaN(+e)?"Date { NaN }":g.call(e):"[object Error]"===r?k(e):"[object RegExp]"===r?a?b.call(e).replace(/[\\^$*+?.()|[\]{}]/g,"\\$&"):b.call(e):e instanceof Error?k(e):null}function S(e,t,a,n,r,s){if(-1!==r.indexOf(e))return"[Circular]";(r=r.slice()).push(e);const o=++n>t.maxDepth,l=t.min;if(t.callToJSON&&!o&&e.toJSON&&"function"==typeof e.toJSON&&!s)return j(e.toJSON(),t,a,n,r,!0);const c=m.call(e);return"[object Arguments]"===c?o?"[Arguments]":(l?"":"Arguments ")+"["+(0,i.printListItems)(e,t,a,n,r,j)+"]":function(e){return"[object Array]"===e||"[object ArrayBuffer]"===e||"[object DataView]"===e||"[object Float32Array]"===e||"[object Float64Array]"===e||"[object Int8Array]"===e||"[object Int16Array]"===e||"[object Int32Array]"===e||"[object Uint8Array]"===e||"[object Uint8ClampedArray]"===e||"[object Uint16Array]"===e||"[object Uint32Array]"===e}(c)?o?"["+e.constructor.name+"]":(l?"":t.printBasicPrototype||"Array"!==e.constructor.name?e.constructor.name+" ":"")+"["+(0,i.printListItems)(e,t,a,n,r,j)+"]":"[object Map]"===c?o?"[Map]":"Map {"+(0,i.printIteratorEntries)(e.entries(),t,a,n,r,j," => ")+"}":"[object Set]"===c?o?"[Set]":"Set {"+(0,i.printIteratorValues)(e.values(),t,a,n,r,j)+"}":o||(e=>"undefined"!=typeof window&&e===window)(e)?"["+h(e)+"]":(l?"":t.printBasicPrototype||"Object"!==h(e)?h(e)+" ":"")+"{"+(0,i.printObjectProperties)(e,t,a,n,r,j)+"}"}function O(e,t,a,n,i,r){let s;try{s=function(e){return null!=e.serialize}(e)?e.serialize(t,a,n,i,r,j):e.print(t,(e=>j(e,a,n,i,r)),(e=>{const t=n+a.indent;return t+e.replace(E,"\n"+t)}),{edgeSpacing:a.spacingOuter,min:a.min,spacing:a.spacingInner},a.colors)}catch(e){throw new PrettyFormatPluginError(e.message,e.stack)}if("string"!=typeof s)throw new Error(`pretty-format: Plugin must return type "string" but instead returned "${typeof s}".`);return s}function w(e,t){for(let a=0;a<e.length;a++)try{if(e[a].test(t))return e[a]}catch(e){throw new PrettyFormatPluginError(e.message,e.stack)}return null}function j(e,t,a,n,i,r){const s=w(t.plugins,e);if(null!==s)return O(s,e,t,a,n,i);const o=x(e,t.printFunctionName,t.escapeRegex,t.escapeString);return null!==o?o:S(e,t,a,n,i,r)}const C={comment:"gray",content:"reset",prop:"yellow",tag:"cyan",value:"green"},I=Object.keys(C),M={callToJSON:!0,compareKeys:void 0,escapeRegex:!1,escapeString:!0,highlight:!1,indent:2,maxDepth:1/0,min:!1,plugins:[],printBasicPrototype:!0,printFunctionName:!0,theme:C};t.DEFAULT_OPTIONS=M;const A=e=>I.reduce(((t,a)=>{const i=e.theme&&void 0!==e.theme[a]?e.theme[a]:C[a],r=i&&n.default[i];if(!r||"string"!=typeof r.close||"string"!=typeof r.open)throw new Error(`pretty-format: Option "theme" has a key "${a}" whose value "${i}" is undefined in ansi-styles.`);return t[a]=r,t}),Object.create(null)),D=e=>e&&void 0!==e.printFunctionName?e.printFunctionName:M.printFunctionName,q=e=>e&&void 0!==e.escapeRegex?e.escapeRegex:M.escapeRegex,P=e=>e&&void 0!==e.escapeString?e.escapeString:M.escapeString,R=e=>{var t,a;return{callToJSON:e&&void 0!==e.callToJSON?e.callToJSON:M.callToJSON,colors:e&&e.highlight?A(e):I.reduce(((e,t)=>(e[t]={close:"",open:""},e)),Object.create(null)),compareKeys:e&&"function"==typeof e.compareKeys?e.compareKeys:M.compareKeys,escapeRegex:q(e),escapeString:P(e),indent:e&&e.min?"":(a=e&&void 0!==e.indent?e.indent:M.indent,new Array(a+1).join(" ")),maxDepth:e&&void 0!==e.maxDepth?e.maxDepth:M.maxDepth,min:e&&void 0!==e.min?e.min:M.min,plugins:e&&void 0!==e.plugins?e.plugins:M.plugins,printBasicPrototype:null===(t=null==e?void 0:e.printBasicPrototype)||void 0===t||t,printFunctionName:D(e),spacingInner:e&&e.min?" ":"\n",spacingOuter:e&&e.min?"":"\n"}};function _(e,t){if(t&&(function(e){if(Object.keys(e).forEach((e=>{if(!M.hasOwnProperty(e))throw new Error(`pretty-format: Unknown option "${e}".`)})),e.min&&void 0!==e.indent&&0!==e.indent)throw new Error('pretty-format: Options "min" and "indent" cannot be used together.');if(void 0!==e.theme){if(null===e.theme)throw new Error('pretty-format: Option "theme" must not be null.');if("object"!=typeof e.theme)throw new Error(`pretty-format: Option "theme" must be of type "object" but instead received "${typeof e.theme}".`)}}(t),t.plugins)){const a=w(t.plugins,e);if(null!==a)return O(a,e,R(t),"",0,[])}const a=x(e,D(t),q(t),P(t));return null!==a?a:S(e,R(t),"",0,[])}const F={AsymmetricMatcher:r.default,ConvertAnsi:s.default,DOMCollection:o.default,DOMElement:l.default,Immutable:c.default,ReactElement:u.default,ReactTestComponent:d.default};t.plugins=F;var L=_;t.default=L},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.test=t.serialize=t.default=void 0;var n=a(483),i="undefined"!=typeof globalThis?globalThis:void 0!==i?i:"undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")(),r=i["jest-symbol-do-not-touch"]||i.Symbol;const s="function"==typeof r&&r.for?r.for("jest.asymmetricMatcher"):1267621,o=(e,t,a,i,r,s)=>{const o=e.toString();return"ArrayContaining"===o||"ArrayNotContaining"===o?++i>t.maxDepth?"["+o+"]":o+" ["+(0,n.printListItems)(e.sample,t,a,i,r,s)+"]":"ObjectContaining"===o||"ObjectNotContaining"===o?++i>t.maxDepth?"["+o+"]":o+" {"+(0,n.printObjectProperties)(e.sample,t,a,i,r,s)+"}":"StringMatching"===o||"StringNotMatching"===o||"StringContaining"===o||"StringNotContaining"===o?o+" "+s(e.sample,t,a,i,r):e.toAsymmetricMatcher()};t.serialize=o;const l=e=>e&&e.$$typeof===s;t.test=l;var c={serialize:o,test:l};t.default=c},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.test=t.serialize=t.default=void 0;var n=r(a(1149)),i=r(a(782));function r(e){return e&&e.__esModule?e:{default:e}}const s=e=>"string"==typeof e&&!!e.match((0,n.default)());t.test=s;const o=(e,t,a,r,s,o)=>o(e.replace((0,n.default)(),(e=>{switch(e){case i.default.red.close:case i.default.green.close:case i.default.cyan.close:case i.default.gray.close:case i.default.white.close:case i.default.yellow.close:case i.default.bgRed.close:case i.default.bgGreen.close:case i.default.bgYellow.close:case i.default.inverse.close:case i.default.dim.close:case i.default.bold.close:case i.default.reset.open:case i.default.reset.close:return"</>";case i.default.red.open:return"<red>";case i.default.green.open:return"<green>";case i.default.cyan.open:return"<cyan>";case i.default.gray.open:return"<gray>";case i.default.white.open:return"<white>";case i.default.yellow.open:return"<yellow>";case i.default.bgRed.open:return"<bgRed>";case i.default.bgGreen.open:return"<bgGreen>";case i.default.bgYellow.open:return"<bgYellow>";case i.default.inverse.open:return"<inverse>";case i.default.dim.open:return"<dim>";case i.default.bold.open:return"<bold>";default:return""}})),t,a,r,s);t.serialize=o;var l={serialize:o,test:s};t.default=l},function(e,t,a){"use strict";e.exports=({onlyFirst:e=!1}={})=>{const t=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~]))"].join("|");return new RegExp(t,e?void 0:"g")}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.test=t.serialize=t.default=void 0;var n=a(483);const i=["DOMStringMap","NamedNodeMap"],r=/^(HTML\w*Collection|NodeList)$/,s=e=>{return e&&e.constructor&&!!e.constructor.name&&(t=e.constructor.name,-1!==i.indexOf(t)||r.test(t));var t};t.test=s;const o=(e,t,a,r,s,o)=>{const l=e.constructor.name;return++r>t.maxDepth?"["+l+"]":(t.min?"":l+" ")+(-1!==i.indexOf(l)?"{"+(0,n.printObjectProperties)((e=>"NamedNodeMap"===e.constructor.name)(e)?Array.from(e).reduce(((e,t)=>(e[t.name]=t.value,e)),{}):{...e},t,a,r,s,o)+"}":"["+(0,n.printListItems)(Array.from(e),t,a,r,s,o)+"]")};t.serialize=o;var l={serialize:o,test:s};t.default=l},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.test=t.serialize=t.default=void 0;var n=a(577);const i=/^((HTML|SVG)\w*)?Element$/,r=e=>{var t;return(null==e||null===(t=e.constructor)||void 0===t?void 0:t.name)&&(e=>{const t=e.constructor.name,{nodeType:a,tagName:n}=e,r="string"==typeof n&&n.includes("-")||(e=>{try{return"function"==typeof e.hasAttribute&&e.hasAttribute("is")}catch{return!1}})(e);return 1===a&&(i.test(t)||r)||3===a&&"Text"===t||8===a&&"Comment"===t||11===a&&"DocumentFragment"===t})(e)};function s(e){return 11===e.nodeType}t.test=r;const o=(e,t,a,i,r,o)=>{if(function(e){return 3===e.nodeType}(e))return(0,n.printText)(e.data,t);if(function(e){return 8===e.nodeType}(e))return(0,n.printComment)(e.data,t);const l=s(e)?"DocumentFragment":e.tagName.toLowerCase();return++i>t.maxDepth?(0,n.printElementAsLeaf)(l,t):(0,n.printElement)(l,(0,n.printProps)(s(e)?[]:Array.from(e.attributes).map((e=>e.name)).sort(),s(e)?{}:Array.from(e.attributes).reduce(((e,t)=>(e[t.name]=t.value,e)),{}),t,a+t.indent,i,r,o),(0,n.printChildren)(Array.prototype.slice.call(e.childNodes||e.children),t,a+t.indent,i,r,o),t,a)};t.serialize=o;var l={serialize:o,test:r};t.default=l},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.replace(/</g,"&lt;").replace(/>/g,"&gt;")}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.test=t.serialize=t.default=void 0;var n=a(483);const i="@@__IMMUTABLE_ORDERED__@@",r=e=>"Immutable."+e,s=e=>"["+e+"]",o=" ",l=(e,t,a,i,l,c,u)=>++i>t.maxDepth?s(r(u)):r(u)+o+"["+(0,n.printIteratorValues)(e.values(),t,a,i,l,c)+"]",c=(e,t,a,c,u,d)=>e["@@__IMMUTABLE_MAP__@@"]?((e,t,a,i,l,c,u)=>++i>t.maxDepth?s(r(u)):r(u)+o+"{"+(0,n.printIteratorEntries)(e.entries(),t,a,i,l,c)+"}")(e,t,a,c,u,d,e[i]?"OrderedMap":"Map"):e["@@__IMMUTABLE_LIST__@@"]?l(e,t,a,c,u,d,"List"):e["@@__IMMUTABLE_SET__@@"]?l(e,t,a,c,u,d,e[i]?"OrderedSet":"Set"):e["@@__IMMUTABLE_STACK__@@"]?l(e,t,a,c,u,d,"Stack"):e["@@__IMMUTABLE_SEQ__@@"]?((e,t,a,i,l,c)=>{const u=r("Seq");return++i>t.maxDepth?s(u):e["@@__IMMUTABLE_KEYED__@@"]?u+o+"{"+(e._iter||e._object?(0,n.printIteratorEntries)(e.entries(),t,a,i,l,c):"â¦")+"}":u+o+"["+(e._iter||e._array||e._collection||e._iterable?(0,n.printIteratorValues)(e.values(),t,a,i,l,c):"â¦")+"]"})(e,t,a,c,u,d):((e,t,a,i,l,c)=>{const u=r(e._name||"Record");return++i>t.maxDepth?s(u):u+o+"{"+(0,n.printIteratorEntries)(function(e){let t=0;return{next(){if(t<e._keys.length){const a=e._keys[t++];return{done:!1,value:[a,e.get(a)]}}return{done:!0,value:void 0}}}}(e),t,a,i,l,c)+"}"})(e,t,a,c,u,d);t.serialize=c;const u=e=>e&&(!0===e["@@__IMMUTABLE_ITERABLE__@@"]||!0===e["@@__IMMUTABLE_RECORD__@@"]);t.test=u;var d={serialize:c,test:u};t.default=d},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.test=t.serialize=t.default=void 0;var n=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var a=r(t);if(a&&a.has(e))return a.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var o=i?Object.getOwnPropertyDescriptor(e,s):null;o&&(o.get||o.set)?Object.defineProperty(n,s,o):n[s]=e[s]}return n.default=e,a&&a.set(e,n),n}(a(1155)),i=a(577);function r(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(r=function(e){return e?a:t})(e)}const s=(e,t=[])=>(Array.isArray(e)?e.forEach((e=>{s(e,t)})):null!=e&&!1!==e&&t.push(e),t),o=e=>{const t=e.type;if("string"==typeof t)return t;if("function"==typeof t)return t.displayName||t.name||"Unknown";if(n.isFragment(e))return"React.Fragment";if(n.isSuspense(e))return"React.Suspense";if("object"==typeof t&&null!==t){if(n.isContextProvider(e))return"Context.Provider";if(n.isContextConsumer(e))return"Context.Consumer";if(n.isForwardRef(e)){if(t.displayName)return t.displayName;const e=t.render.displayName||t.render.name||"";return""!==e?"ForwardRef("+e+")":"ForwardRef"}if(n.isMemo(e)){const e=t.displayName||t.type.displayName||t.type.name||"";return""!==e?"Memo("+e+")":"Memo"}}return"UNDEFINED"},l=(e,t,a,n,r,l)=>++n>t.maxDepth?(0,i.printElementAsLeaf)(o(e),t):(0,i.printElement)(o(e),(0,i.printProps)((e=>{const{props:t}=e;return Object.keys(t).filter((e=>"children"!==e&&void 0!==t[e])).sort()})(e),e.props,t,a+t.indent,n,r,l),(0,i.printChildren)(s(e.props.children),t,a+t.indent,n,r,l),t,a);t.serialize=l;const c=e=>null!=e&&n.isElement(e);t.test=c;var u={serialize:l,test:c};t.default=u},function(e,t,a){"use strict";e.exports=a(1156)},function(e,t,a){"use strict";
/** @license React v17.0.2
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n=60103,i=60106,r=60107,s=60108,o=60114,l=60109,c=60110,u=60112,d=60113,p=60120,m=60115,g=60116,f=60121,b=60122,h=60117,y=60129,E=60131;if("function"==typeof Symbol&&Symbol.for){var v=Symbol.for;n=v("react.element"),i=v("react.portal"),r=v("react.fragment"),s=v("react.strict_mode"),o=v("react.profiler"),l=v("react.provider"),c=v("react.context"),u=v("react.forward_ref"),d=v("react.suspense"),p=v("react.suspense_list"),m=v("react.memo"),g=v("react.lazy"),f=v("react.block"),b=v("react.server.block"),h=v("react.fundamental"),y=v("react.debug_trace_mode"),E=v("react.legacy_hidden")}function T(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case r:case o:case s:case d:case p:return e;default:switch(e=e&&e.$$typeof){case c:case u:case g:case m:case l:return e;default:return t}}case i:return t}}}var k=l,x=n,S=u,O=r,w=g,j=m,C=i,I=o,M=s,A=d;t.ContextConsumer=c,t.ContextProvider=k,t.Element=x,t.ForwardRef=S,t.Fragment=O,t.Lazy=w,t.Memo=j,t.Portal=C,t.Profiler=I,t.StrictMode=M,t.Suspense=A,t.isAsyncMode=function(){return!1},t.isConcurrentMode=function(){return!1},t.isContextConsumer=function(e){return T(e)===c},t.isContextProvider=function(e){return T(e)===l},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===n},t.isForwardRef=function(e){return T(e)===u},t.isFragment=function(e){return T(e)===r},t.isLazy=function(e){return T(e)===g},t.isMemo=function(e){return T(e)===m},t.isPortal=function(e){return T(e)===i},t.isProfiler=function(e){return T(e)===o},t.isStrictMode=function(e){return T(e)===s},t.isSuspense=function(e){return T(e)===d},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===r||e===o||e===y||e===s||e===d||e===p||e===E||"object"==typeof e&&null!==e&&(e.$$typeof===g||e.$$typeof===m||e.$$typeof===l||e.$$typeof===c||e.$$typeof===u||e.$$typeof===h||e.$$typeof===f||e[0]===b)},t.typeOf=T},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.test=t.serialize=t.default=void 0;var n=a(577),i="undefined"!=typeof globalThis?globalThis:void 0!==i?i:"undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")(),r=i["jest-symbol-do-not-touch"]||i.Symbol;const s="function"==typeof r&&r.for?r.for("react.test.json"):245830487,o=(e,t,a,i,r,s)=>++i>t.maxDepth?(0,n.printElementAsLeaf)(e.type,t):(0,n.printElement)(e.type,e.props?(0,n.printProps)((e=>{const{props:t}=e;return t?Object.keys(t).filter((e=>void 0!==t[e])).sort():[]})(e),e.props,t,a+t.indent,i,r,s):"",e.children?(0,n.printChildren)(e.children,t,a+t.indent,i,r,s):"",t,a);t.serialize=o;const l=e=>e&&e.$$typeof===s;t.test=l;var c={serialize:o,test:l};t.default=c},function(e,t,a){"use strict";function n(e){return e.replace(/</g,"&lt;").replace(/>/g,"&gt;")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{test:e=>{var t;return(null==e||null==(t=e.constructor)?void 0:t.name)&&s(e)},serialize:(t,a,r,s,l,c)=>{if(function(e){return 3===e.nodeType}(t))return i(t.data,a);if(function(e){return 8===e.nodeType}(t))return((e,t)=>{const a=t.colors.comment;return a.open+"\x3c!--"+n(e)+"--\x3e"+a.close})(t.data,a);const u=o(t)?"DocumentFragment":t.tagName.toLowerCase();return++s>a.maxDepth?((e,t)=>{const a=t.colors.tag;return a.open+"<"+e+a.close+" â¦"+a.open+" />"+a.close})(u,a):((e,t,a,n,i)=>{const r=n.colors.tag;return r.open+"<"+e+(t&&r.close+t+n.spacingOuter+i+r.open)+(a?">"+r.close+a+n.spacingOuter+i+r.open+"</"+e:(t&&!n.min?"":" ")+"/")+">"+r.close})(u,((e,t,a,n,i,r,s)=>{const o=n+a.indent,l=a.colors;return e.map((e=>{const c=t[e];let u=s(c,a,o,i,r);return"string"!=typeof c&&(-1!==u.indexOf("\n")&&(u=a.spacingOuter+o+u+a.spacingOuter+n),u="{"+u+"}"),a.spacingInner+n+l.prop.open+e+l.prop.close+"="+l.value.open+u+l.value.close})).join("")})(o(t)?[]:Array.from(t.attributes).map((e=>e.name)).sort(),o(t)?{}:Array.from(t.attributes).reduce(((e,t)=>(e[t.name]=t.value,e)),{}),a,r+a.indent,s,l,c),((e,t,a,n,r,s)=>e.map((e=>{const o="string"==typeof e?i(e,t):s(e,t,a,n,r);return""===o&&"object"==typeof e&&null!==e&&3!==e.nodeType?"":t.spacingOuter+a+o})).join(""))(Array.prototype.slice.call(t.childNodes||t.children).filter(e),a,r+a.indent,s,l,c),a,r)}}},t.test=void 0;const i=(e,t)=>{const a=t.colors.content;return a.open+n(e)+a.close},r=/^((HTML|SVG)\w*)?Element$/,s=e=>{const t=e.constructor.name,{nodeType:a,tagName:n}=e,i="string"==typeof n&&n.includes("-")||"function"==typeof e.hasAttribute&&e.hasAttribute("is");return 1===a&&(r.test(t)||i)||3===a&&"Text"===t||8===a&&"Comment"===t||11===a&&"DocumentFragment"===t};function o(e){return 11===e.nodeType}t.test=e=>{var t;return(null==e||null==(t=e.constructor)?void 0:t.name)&&s(e)}},function(e,t,a){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.getUserCodeFrame=function(){if(!n||!i)return"";return function(e){const t=e.indexOf("(")+1,r=e.indexOf(")"),s=e.slice(t,r),o=s.split(":"),[l,c,u]=[o[0],parseInt(o[1],10),parseInt(o[2],10)];let d="";try{d=n(l,"utf-8")}catch{return""}const p=i(d,{start:{line:c,column:u}},{highlightCode:!0,linesBelow:0});return`${a.dim(s)}\n${p}\n`}((new Error).stack.split("\n").slice(1).find((e=>!e.includes("node_modules/"))))};let a=null,n=null,i=null;try{const t=e&&e.require;n=t.call(e,"fs").readFileSync,i=t.call(e,"@babel/code-frame").codeFrameColumns,a=t.call(e,"chalk")}catch{}}).call(this,a(303)(e))},function(e,t,a){"use strict";t.__esModule=!0,t.computeAccessibleDescription=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=(0,i.queryIdRefs)(e,"aria-describedby").map((function(e){return(0,n.computeTextAlternative)(e,s(s({},t),{},{compute:"description"}))})).join(" ");if(""===a){var r=e.getAttribute("title");a=null===r?"":r}return a};var n=a(785),i=a(581);function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}},function(e,t,a){"use strict";t.__esModule=!0,t.default=function(e,t){var a=Array,n=Object(e);if(null==e)throw new TypeError("Array.from requires an array-like object - not null or undefined");if(void 0!==t&&!i(t))throw new TypeError("Array.from: when provided, the second argument must be a function");for(var s,o=function(e){var t=function(e){var t=Number(e);return isNaN(t)?0:0!==t&&isFinite(t)?(t>0?1:-1)*Math.floor(Math.abs(t)):t}(e);return Math.min(Math.max(t,0),r)}(n.length),l=i(a)?Object(new a(o)):new Array(o),c=0;c<o;)s=n[c],l[c]=t?t(s,c):s,c+=1;return l.length=o,l};var n=Object.prototype.toString;function i(e){return"function"==typeof e||"[object Function]"===n.call(e)}var r=Math.pow(2,53)-1},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}t.__esModule=!0,t.default=void 0;var s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];n(this,e),r(this,"items",void 0),this.items=t}var t,a;return t=e,(a=[{key:"add",value:function(e){return!1===this.has(e)&&this.items.push(e),this}},{key:"clear",value:function(){this.items=[]}},{key:"delete",value:function(e){var t=this.items.length;return this.items=this.items.filter((function(t){return t!==e})),t!==this.items.length}},{key:"forEach",value:function(e){var t=this;this.items.forEach((function(a){e(a,a,t)}))}},{key:"has",value:function(e){return-1!==this.items.indexOf(e)}},{key:"size",get:function(){return this.items.length}}])&&i(t.prototype,a),Object.defineProperty(t,"prototype",{writable:!1}),e}(),o="undefined"==typeof Set?Set:s;t.default=o},function(e,t,a){"use strict";t.__esModule=!0,t.computeAccessibleName=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(e)?"":(0,n.computeTextAlternative)(e,t)};var n=a(785),i=a(581);function r(e){return(0,i.hasAnyConcreteRoles)(e,["caption","code","deletion","emphasis","generic","insertion","paragraph","presentation","strong","subscript","superscript"])}},function(e,t,a){"use strict";function n(e){var t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=a.getComputedStyle,i=void 0===n?null===(t=e.ownerDocument.defaultView)||void 0===t?void 0:t.getComputedStyle:n;if("function"!=typeof i)throw new TypeError("Owner document of the element needs to have an associated window.");return!0===e.hidden||"true"===e.getAttribute("aria-hidden")||"none"===i(e).display}t.__esModule=!0,t.isInaccessible=function(e){var t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=a.getComputedStyle,r=void 0===i?null===(t=e.ownerDocument.defaultView)||void 0===t?void 0:t.getComputedStyle:i,s=a.isSubtreeInaccessible,o=void 0===s?n:s;if("function"!=typeof r)throw new TypeError("Owner document of the element needs to have an associated window.");if("hidden"===r(e).visibility)return!0;for(var l=e;l;){if(o(l,{getComputedStyle:r}))return!0;l=l.parentElement}return!1},t.isSubtreeInaccessible=n},function(e,t,a){"use strict";function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,i,r=[],s=!0,o=!1;try{for(a=a.call(e);!(s=(n=a.next()).done)&&(r.push(n.value),!t||r.length!==t);s=!0);}catch(e){o=!0,i=e}finally{try{s||null==a.return||a.return()}finally{if(o)throw i}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?i(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=[["aria-activedescendant",{type:"id"}],["aria-atomic",{type:"boolean"}],["aria-autocomplete",{type:"token",values:["inline","list","both","none"]}],["aria-busy",{type:"boolean"}],["aria-checked",{type:"tristate"}],["aria-colcount",{type:"integer"}],["aria-colindex",{type:"integer"}],["aria-colspan",{type:"integer"}],["aria-controls",{type:"idlist"}],["aria-current",{type:"token",values:["page","step","location","date","time",!0,!1]}],["aria-describedby",{type:"idlist"}],["aria-details",{type:"id"}],["aria-disabled",{type:"boolean"}],["aria-dropeffect",{type:"tokenlist",values:["copy","execute","link","move","none","popup"]}],["aria-errormessage",{type:"id"}],["aria-expanded",{type:"boolean",allowundefined:!0}],["aria-flowto",{type:"idlist"}],["aria-grabbed",{type:"boolean",allowundefined:!0}],["aria-haspopup",{type:"token",values:[!1,!0,"menu","listbox","tree","grid","dialog"]}],["aria-hidden",{type:"boolean",allowundefined:!0}],["aria-invalid",{type:"token",values:["grammar",!1,"spelling",!0]}],["aria-keyshortcuts",{type:"string"}],["aria-label",{type:"string"}],["aria-labelledby",{type:"idlist"}],["aria-level",{type:"integer"}],["aria-live",{type:"token",values:["assertive","off","polite"]}],["aria-modal",{type:"boolean"}],["aria-multiline",{type:"boolean"}],["aria-multiselectable",{type:"boolean"}],["aria-orientation",{type:"token",values:["vertical","undefined","horizontal"]}],["aria-owns",{type:"idlist"}],["aria-placeholder",{type:"string"}],["aria-posinset",{type:"integer"}],["aria-pressed",{type:"tristate"}],["aria-readonly",{type:"boolean"}],["aria-relevant",{type:"tokenlist",values:["additions","all","removals","text"]}],["aria-required",{type:"boolean"}],["aria-roledescription",{type:"string"}],["aria-rowcount",{type:"integer"}],["aria-rowindex",{type:"integer"}],["aria-rowspan",{type:"integer"}],["aria-selected",{type:"boolean",allowundefined:!0}],["aria-setsize",{type:"integer"}],["aria-sort",{type:"token",values:["ascending","descending","none","other"]}],["aria-valuemax",{type:"number"}],["aria-valuemin",{type:"number"}],["aria-valuenow",{type:"number"}],["aria-valuetext",{type:"string"}]],s={entries:function(){return r},get:function(e){var t=r.find((function(t){return t[0]===e}));return t&&t[1]},has:function(e){return!!this.get(e)},keys:function(){return r.map((function(e){return n(e,1)[0]}))},values:function(){return r.map((function(e){return n(e,2)[1]}))}};t.default=s},function(e,t,a){"use strict";function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,i,r=[],s=!0,o=!1;try{for(a=a.call(e);!(s=(n=a.next()).done)&&(r.push(n.value),!t||r.length!==t);s=!0);}catch(e){o=!0,i=e}finally{try{s||null==a.return||a.return()}finally{if(o)throw i}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?i(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=[["a",{reserved:!1}],["abbr",{reserved:!1}],["acronym",{reserved:!1}],["address",{reserved:!1}],["applet",{reserved:!1}],["area",{reserved:!1}],["article",{reserved:!1}],["aside",{reserved:!1}],["audio",{reserved:!1}],["b",{reserved:!1}],["base",{reserved:!0}],["bdi",{reserved:!1}],["bdo",{reserved:!1}],["big",{reserved:!1}],["blink",{reserved:!1}],["blockquote",{reserved:!1}],["body",{reserved:!1}],["br",{reserved:!1}],["button",{reserved:!1}],["canvas",{reserved:!1}],["caption",{reserved:!1}],["center",{reserved:!1}],["cite",{reserved:!1}],["code",{reserved:!1}],["col",{reserved:!0}],["colgroup",{reserved:!0}],["content",{reserved:!1}],["data",{reserved:!1}],["datalist",{reserved:!1}],["dd",{reserved:!1}],["del",{reserved:!1}],["details",{reserved:!1}],["dfn",{reserved:!1}],["dialog",{reserved:!1}],["dir",{reserved:!1}],["div",{reserved:!1}],["dl",{reserved:!1}],["dt",{reserved:!1}],["em",{reserved:!1}],["embed",{reserved:!1}],["fieldset",{reserved:!1}],["figcaption",{reserved:!1}],["figure",{reserved:!1}],["font",{reserved:!1}],["footer",{reserved:!1}],["form",{reserved:!1}],["frame",{reserved:!1}],["frameset",{reserved:!1}],["h1",{reserved:!1}],["h2",{reserved:!1}],["h3",{reserved:!1}],["h4",{reserved:!1}],["h5",{reserved:!1}],["h6",{reserved:!1}],["head",{reserved:!0}],["header",{reserved:!1}],["hgroup",{reserved:!1}],["hr",{reserved:!1}],["html",{reserved:!0}],["i",{reserved:!1}],["iframe",{reserved:!1}],["img",{reserved:!1}],["input",{reserved:!1}],["ins",{reserved:!1}],["kbd",{reserved:!1}],["keygen",{reserved:!1}],["label",{reserved:!1}],["legend",{reserved:!1}],["li",{reserved:!1}],["link",{reserved:!0}],["main",{reserved:!1}],["map",{reserved:!1}],["mark",{reserved:!1}],["marquee",{reserved:!1}],["menu",{reserved:!1}],["menuitem",{reserved:!1}],["meta",{reserved:!0}],["meter",{reserved:!1}],["nav",{reserved:!1}],["noembed",{reserved:!0}],["noscript",{reserved:!0}],["object",{reserved:!1}],["ol",{reserved:!1}],["optgroup",{reserved:!1}],["option",{reserved:!1}],["output",{reserved:!1}],["p",{reserved:!1}],["param",{reserved:!0}],["picture",{reserved:!0}],["pre",{reserved:!1}],["progress",{reserved:!1}],["q",{reserved:!1}],["rp",{reserved:!1}],["rt",{reserved:!1}],["rtc",{reserved:!1}],["ruby",{reserved:!1}],["s",{reserved:!1}],["samp",{reserved:!1}],["script",{reserved:!0}],["section",{reserved:!1}],["select",{reserved:!1}],["small",{reserved:!1}],["source",{reserved:!0}],["spacer",{reserved:!1}],["span",{reserved:!1}],["strike",{reserved:!1}],["strong",{reserved:!1}],["style",{reserved:!0}],["sub",{reserved:!1}],["summary",{reserved:!1}],["sup",{reserved:!1}],["table",{reserved:!1}],["tbody",{reserved:!1}],["td",{reserved:!1}],["textarea",{reserved:!1}],["tfoot",{reserved:!1}],["th",{reserved:!1}],["thead",{reserved:!1}],["time",{reserved:!1}],["title",{reserved:!0}],["tr",{reserved:!1}],["track",{reserved:!0}],["tt",{reserved:!1}],["u",{reserved:!1}],["ul",{reserved:!1}],["var",{reserved:!1}],["video",{reserved:!1}],["wbr",{reserved:!1}],["xmp",{reserved:!1}]],s={entries:function(){return r},get:function(e){var t=r.find((function(t){return t[0]===e}));return t&&t[1]},has:function(e){return!!this.get(e)},keys:function(){return r.map((function(e){return n(e,1)[0]}))},values:function(){return r.map((function(e){return n(e,2)[1]}))}};t.default=s},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=f(a(1168)),i=f(a(1169)),r=f(a(1170)),s=f(a(1171)),o=f(a(1172)),l=f(a(1173)),c=f(a(1174)),u=f(a(1175)),d=f(a(1176)),p=f(a(1177)),m=f(a(1178)),g=f(a(1179));function f(e){return e&&e.__esModule?e:{default:e}}var b=[["command",n.default],["composite",i.default],["input",r.default],["landmark",s.default],["range",o.default],["roletype",l.default],["section",c.default],["sectionhead",u.default],["select",d.default],["structure",p.default],["widget",m.default],["window",g.default]];t.default=b},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"menuitem"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-activedescendant":null,"aria-disabled":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null},relatedConcepts:[{concept:{name:"input"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-valuemax":null,"aria-valuemin":null,"aria-valuenow":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:[],prohibitedProps:[],props:{"aria-atomic":null,"aria-busy":null,"aria-controls":null,"aria-current":null,"aria-describedby":null,"aria-details":null,"aria-dropeffect":null,"aria-flowto":null,"aria-grabbed":null,"aria-hidden":null,"aria-keyshortcuts":null,"aria-label":null,"aria-labelledby":null,"aria-live":null,"aria-owns":null,"aria-relevant":null,"aria-roledescription":null},relatedConcepts:[{concept:{name:"rel"},module:"HTML"},{concept:{name:"role"},module:"XHTML"},{concept:{name:"type"},module:"Dublin Core"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:[],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"frontmatter"},module:"DTB"},{concept:{name:"level"},module:"DTB"},{concept:{name:"level"},module:"SMIL"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-orientation":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","composite"],["roletype","structure","section","group"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:[],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:[],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-modal":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=Ae(a(1181)),i=Ae(a(1182)),r=Ae(a(1183)),s=Ae(a(1184)),o=Ae(a(1185)),l=Ae(a(1186)),c=Ae(a(1187)),u=Ae(a(1188)),d=Ae(a(1189)),p=Ae(a(1190)),m=Ae(a(1191)),g=Ae(a(1192)),f=Ae(a(1193)),b=Ae(a(1194)),h=Ae(a(1195)),y=Ae(a(1196)),E=Ae(a(1197)),v=Ae(a(1198)),T=Ae(a(1199)),k=Ae(a(1200)),x=Ae(a(1201)),S=Ae(a(1202)),O=Ae(a(1203)),w=Ae(a(1204)),j=Ae(a(1205)),C=Ae(a(1206)),I=Ae(a(1207)),M=Ae(a(1208)),A=Ae(a(1209)),D=Ae(a(1210)),q=Ae(a(1211)),P=Ae(a(1212)),R=Ae(a(1213)),_=Ae(a(1214)),F=Ae(a(1215)),L=Ae(a(1216)),N=Ae(a(1217)),B=Ae(a(1218)),z=Ae(a(1219)),U=Ae(a(1220)),H=Ae(a(1221)),$=Ae(a(1222)),V=Ae(a(1223)),Q=Ae(a(1224)),W=Ae(a(1225)),G=Ae(a(1226)),K=Ae(a(1227)),Y=Ae(a(1228)),J=Ae(a(1229)),X=Ae(a(1230)),Z=Ae(a(1231)),ee=Ae(a(1232)),te=Ae(a(1233)),ae=Ae(a(1234)),ne=Ae(a(1235)),ie=Ae(a(1236)),re=Ae(a(1237)),se=Ae(a(1238)),oe=Ae(a(1239)),le=Ae(a(1240)),ce=Ae(a(1241)),ue=Ae(a(1242)),de=Ae(a(1243)),pe=Ae(a(1244)),me=Ae(a(1245)),ge=Ae(a(1246)),fe=Ae(a(1247)),be=Ae(a(1248)),he=Ae(a(1249)),ye=Ae(a(1250)),Ee=Ae(a(1251)),ve=Ae(a(1252)),Te=Ae(a(1253)),ke=Ae(a(1254)),xe=Ae(a(1255)),Se=Ae(a(1256)),Oe=Ae(a(1257)),we=Ae(a(1258)),je=Ae(a(1259)),Ce=Ae(a(1260)),Ie=Ae(a(1261)),Me=Ae(a(1262));function Ae(e){return e&&e.__esModule?e:{default:e}}var De=[["alert",n.default],["alertdialog",i.default],["application",r.default],["article",s.default],["banner",o.default],["blockquote",l.default],["button",c.default],["caption",u.default],["cell",d.default],["checkbox",p.default],["code",m.default],["columnheader",g.default],["combobox",f.default],["complementary",b.default],["contentinfo",h.default],["definition",y.default],["deletion",E.default],["dialog",v.default],["directory",T.default],["document",k.default],["emphasis",x.default],["feed",S.default],["figure",O.default],["form",w.default],["generic",j.default],["grid",C.default],["gridcell",I.default],["group",M.default],["heading",A.default],["img",D.default],["insertion",q.default],["link",P.default],["list",R.default],["listbox",_.default],["listitem",F.default],["log",L.default],["main",N.default],["marquee",B.default],["math",z.default],["menu",U.default],["menubar",H.default],["menuitem",$.default],["menuitemcheckbox",V.default],["menuitemradio",Q.default],["meter",W.default],["navigation",G.default],["none",K.default],["note",Y.default],["option",J.default],["paragraph",X.default],["presentation",Z.default],["progressbar",ee.default],["radio",te.default],["radiogroup",ae.default],["region",ne.default],["row",ie.default],["rowgroup",re.default],["rowheader",se.default],["scrollbar",oe.default],["search",le.default],["searchbox",ce.default],["separator",ue.default],["slider",de.default],["spinbutton",pe.default],["status",me.default],["strong",ge.default],["subscript",fe.default],["superscript",be.default],["switch",he.default],["tab",ye.default],["table",Ee.default],["tablist",ve.default],["tabpanel",Te.default],["term",ke.default],["textbox",xe.default],["time",Se.default],["timer",Oe.default],["toolbar",we.default],["tooltip",je.default],["tree",Ce.default],["treegrid",Ie.default],["treeitem",Me.default]];t.default=De},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-atomic":"true","aria-live":"assertive"},relatedConcepts:[{concept:{name:"alert"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"alert"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","alert"],["roletype","window","dialog"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-activedescendant":null,"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"Device Independence Delivery Unit"}}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-posinset":null,"aria-setsize":null},relatedConcepts:[{concept:{name:"article"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","document"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{constraints:["direct descendant of document"],name:"header"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-disabled":null,"aria-expanded":null,"aria-haspopup":null,"aria-pressed":null},relatedConcepts:[{concept:{attributes:[{constraints:["set"],name:"aria-pressed"},{name:"type",value:"checkbox"}],name:"input"},module:"HTML"},{concept:{attributes:[{name:"aria-expanded",value:"false"}],name:"summary"},module:"HTML"},{concept:{attributes:[{name:"aria-expanded",value:"true"}],constraints:["direct descendant of details element with the open attribute defined"],name:"summary"},module:"HTML"},{concept:{attributes:[{name:"type",value:"button"}],name:"input"},module:"HTML"},{concept:{attributes:[{name:"type",value:"image"}],name:"input"},module:"HTML"},{concept:{attributes:[{name:"type",value:"reset"}],name:"input"},module:"HTML"},{concept:{attributes:[{name:"type",value:"submit"}],name:"input"},module:"HTML"},{concept:{name:"button"},module:"HTML"},{concept:{name:"trigger"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[],requireContextRole:["figure","grid","table"],requiredContextRole:["figure","grid","table"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-colindex":null,"aria-colspan":null,"aria-rowindex":null,"aria-rowspan":null},relatedConcepts:[{concept:{constraints:["descendant of table"],name:"td"},module:"HTML"}],requireContextRole:["row"],requiredContextRole:["row"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-checked":null,"aria-errormessage":null,"aria-expanded":null,"aria-invalid":null,"aria-readonly":null,"aria-required":null},relatedConcepts:[{concept:{attributes:[{name:"type",value:"checkbox"}],name:"input"},module:"HTML"},{concept:{name:"option"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-checked":null},superClass:[["roletype","widget","input"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-sort":null},relatedConcepts:[{attributes:[{name:"scope",value:"col"}],concept:{name:"th"},module:"HTML"}],requireContextRole:["row"],requiredContextRole:["row"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","cell"],["roletype","structure","section","cell","gridcell"],["roletype","widget","gridcell"],["roletype","structure","sectionhead"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-activedescendant":null,"aria-autocomplete":null,"aria-errormessage":null,"aria-invalid":null,"aria-readonly":null,"aria-required":null,"aria-expanded":"false","aria-haspopup":"listbox"},relatedConcepts:[{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"email"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"search"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"tel"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"text"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"url"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"url"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"multiple"},{constraints:["undefined"],name:"size"}],name:"select"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"multiple"},{name:"size",value:1}],name:"select"},module:"HTML"},{concept:{name:"select"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-controls":null,"aria-expanded":"false"},superClass:[["roletype","widget","input"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"aside"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{constraints:["direct descendant of document"],name:"footer"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"dd"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"dialog"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","window"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{module:"DAISY Guide"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","list"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"Device Independence Delivery Unit"}},{concept:{name:"body"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["article"]],requiredProps:{},superClass:[["roletype","structure","section","list"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"figure"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{attributes:[{constraints:["set"],name:"aria-label"}],name:"form"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"aria-labelledby"}],name:"form"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"name"}],name:"form"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"span"},module:"HTML"},{concept:{name:"div"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-multiselectable":null,"aria-readonly":null},relatedConcepts:[{concept:{attributes:[{name:"role",value:"grid"}],name:"table"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["row"],["row","rowgroup"]],requiredProps:{},superClass:[["roletype","widget","composite"],["roletype","structure","section","table"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null,"aria-readonly":null,"aria-required":null,"aria-selected":null},relatedConcepts:[{concept:{attributes:[{name:"role",value:"gridcell"}],name:"td"},module:"HTML"}],requireContextRole:["row"],requiredContextRole:["row"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","cell"],["roletype","widget"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-activedescendant":null,"aria-disabled":null},relatedConcepts:[{concept:{name:"details"},module:"HTML"},{concept:{name:"fieldset"},module:"HTML"},{concept:{name:"optgroup"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-level":"2"},relatedConcepts:[{concept:{name:"h1"},module:"HTML"},{concept:{name:"h2"},module:"HTML"},{concept:{name:"h3"},module:"HTML"},{concept:{name:"h4"},module:"HTML"},{concept:{name:"h5"},module:"HTML"},{concept:{name:"h6"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-level":"2"},superClass:[["roletype","structure","sectionhead"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{attributes:[{constraints:["set"],name:"alt"}],name:"img"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"alt"}],name:"img"},module:"HTML"},{concept:{name:"imggroup"},module:"DTB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-disabled":null,"aria-expanded":null,"aria-haspopup":null},relatedConcepts:[{concept:{attributes:[{name:"href"}],name:"a"},module:"HTML"},{concept:{attributes:[{name:"href"}],name:"area"},module:"HTML"},{concept:{attributes:[{name:"href"}],name:"link"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"menu"},module:"HTML"},{concept:{name:"ol"},module:"HTML"},{concept:{name:"ul"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["listitem"]],requiredProps:{},superClass:[["roletype","structure","section"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-expanded":null,"aria-invalid":null,"aria-multiselectable":null,"aria-readonly":null,"aria-required":null,"aria-orientation":"vertical"},relatedConcepts:[{concept:{attributes:[{constraints:[">1"],name:"size"},{name:"multiple"}],name:"select"},module:"HTML"},{concept:{attributes:[{constraints:[">1"],name:"size"}],name:"select"},module:"HTML"},{concept:{attributes:[{name:"multiple"}],name:"select"},module:"HTML"},{concept:{name:"datalist"},module:"HTML"},{concept:{name:"list"},module:"ARIA"},{concept:{name:"select"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["option","group"],["option"]],requiredProps:{},superClass:[["roletype","widget","composite","select"],["roletype","structure","section","group","select"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-level":null,"aria-posinset":null,"aria-setsize":null},relatedConcepts:[{concept:{constraints:["direct descendant of ol, ul or menu"],name:"li"},module:"HTML"},{concept:{name:"item"},module:"XForms"}],requireContextRole:["directory","list"],requiredContextRole:["directory","list"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-live":"polite"},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"main"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"math"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-orientation":"vertical"},relatedConcepts:[{concept:{name:"MENU"},module:"JAPI"},{concept:{name:"list"},module:"ARIA"},{concept:{name:"select"},module:"XForms"},{concept:{name:"sidebar"},module:"DTB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["menuitem","group"],["menuitemradio","group"],["menuitemcheckbox","group"],["menuitem"],["menuitemcheckbox"],["menuitemradio"]],requiredProps:{},superClass:[["roletype","widget","composite","select"],["roletype","structure","section","group","select"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-orientation":"horizontal"},relatedConcepts:[{concept:{name:"toolbar"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["menuitem","group"],["menuitemradio","group"],["menuitemcheckbox","group"],["menuitem"],["menuitemcheckbox"],["menuitemradio"]],requiredProps:{},superClass:[["roletype","widget","composite","select","menu"],["roletype","structure","section","group","select","menu"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-disabled":null,"aria-expanded":null,"aria-haspopup":null,"aria-posinset":null,"aria-setsize":null},relatedConcepts:[{concept:{name:"MENU_ITEM"},module:"JAPI"},{concept:{name:"listitem"},module:"ARIA"},{concept:{name:"menuitem"},module:"HTML"},{concept:{name:"option"},module:"ARIA"}],requireContextRole:["group","menu","menubar"],requiredContextRole:["group","menu","menubar"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"menuitem"},module:"ARIA"}],requireContextRole:["group","menu","menubar"],requiredContextRole:["group","menu","menubar"],requiredOwnedElements:[],requiredProps:{"aria-checked":null},superClass:[["roletype","widget","input","checkbox"],["roletype","widget","command","menuitem"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"menuitem"},module:"ARIA"}],requireContextRole:["group","menu","menubar"],requiredContextRole:["group","menu","menubar"],requiredOwnedElements:[],requiredProps:{"aria-checked":null},superClass:[["roletype","widget","input","checkbox","menuitemcheckbox"],["roletype","widget","command","menuitem","menuitemcheckbox"],["roletype","widget","input","radio"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-valuetext":null,"aria-valuemax":"100","aria-valuemin":"0"},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-valuenow":null},superClass:[["roletype","structure","range"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"nav"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:[],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-checked":null,"aria-posinset":null,"aria-setsize":null,"aria-selected":"false"},relatedConcepts:[{concept:{name:"item"},module:"XForms"},{concept:{name:"listitem"},module:"ARIA"},{concept:{name:"option"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-selected":"false"},superClass:[["roletype","widget","input"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-valuetext":null},relatedConcepts:[{concept:{name:"progress"},module:"HTML"},{concept:{name:"status"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","range"],["roletype","widget"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-checked":null,"aria-posinset":null,"aria-setsize":null},relatedConcepts:[{concept:{attributes:[{name:"type",value:"radio"}],name:"input"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-checked":null},superClass:[["roletype","widget","input"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null,"aria-readonly":null,"aria-required":null},relatedConcepts:[{concept:{name:"list"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["radio"]],requiredProps:{},superClass:[["roletype","widget","composite","select"],["roletype","structure","section","group","select"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{attributes:[{constraints:["set"],name:"aria-label"}],name:"section"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"aria-labelledby"}],name:"section"},module:"HTML"},{concept:{name:"Device Independence Glossart perceivable unit"}},{concept:{name:"frame"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-colindex":null,"aria-expanded":null,"aria-level":null,"aria-posinset":null,"aria-rowindex":null,"aria-selected":null,"aria-setsize":null},relatedConcepts:[{concept:{name:"tr"},module:"HTML"}],requireContextRole:["grid","rowgroup","table","treegrid"],requiredContextRole:["grid","rowgroup","table","treegrid"],requiredOwnedElements:[["cell"],["columnheader"],["gridcell"],["rowheader"]],requiredProps:{},superClass:[["roletype","structure","section","group"],["roletype","widget"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"tbody"},module:"HTML"},{concept:{name:"tfoot"},module:"HTML"},{concept:{name:"thead"},module:"HTML"}],requireContextRole:["grid","table","treegrid"],requiredContextRole:["grid","table","treegrid"],requiredOwnedElements:[["row"]],requiredProps:{},superClass:[["roletype","structure"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-sort":null},relatedConcepts:[{concept:{attributes:[{name:"scope",value:"row"}],name:"th"},module:"HTML"}],requireContextRole:["row"],requiredContextRole:["row"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","cell"],["roletype","structure","section","cell","gridcell"],["roletype","widget","gridcell"],["roletype","structure","sectionhead"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-valuetext":null,"aria-orientation":"vertical","aria-valuemax":"100","aria-valuemin":"0"},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-controls":null,"aria-valuenow":null},superClass:[["roletype","structure","range"],["roletype","widget"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{attributes:[{constraints:["undefined"],name:"list"},{name:"type",value:"search"}],name:"input"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","input","textbox"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-orientation":"horizontal","aria-valuemax":"100","aria-valuemin":"0","aria-valuenow":null,"aria-valuetext":null},relatedConcepts:[{concept:{name:"hr"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-haspopup":null,"aria-invalid":null,"aria-readonly":null,"aria-valuetext":null,"aria-orientation":"horizontal","aria-valuemax":"100","aria-valuemin":"0"},relatedConcepts:[{concept:{attributes:[{name:"type",value:"range"}],name:"input"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-valuenow":null},superClass:[["roletype","widget","input"],["roletype","structure","range"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null,"aria-readonly":null,"aria-required":null,"aria-valuetext":null,"aria-valuenow":"0"},relatedConcepts:[{concept:{attributes:[{name:"type",value:"number"}],name:"input"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","composite"],["roletype","widget","input"],["roletype","structure","range"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-atomic":"true","aria-live":"polite"},relatedConcepts:[{concept:{name:"output"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"button"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-checked":null},superClass:[["roletype","widget","input","checkbox"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-disabled":null,"aria-expanded":null,"aria-haspopup":null,"aria-posinset":null,"aria-setsize":null,"aria-selected":"false"},relatedConcepts:[],requireContextRole:["tablist"],requiredContextRole:["tablist"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","sectionhead"],["roletype","widget"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-colcount":null,"aria-rowcount":null},relatedConcepts:[{concept:{name:"table"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["row"],["row","rowgroup"]],requiredProps:{},superClass:[["roletype","structure","section"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-level":null,"aria-multiselectable":null,"aria-orientation":"horizontal"},relatedConcepts:[{module:"DAISY",concept:{name:"guide"}}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["tab"]],requiredProps:{},superClass:[["roletype","widget","composite"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"dfn"},module:"HTML"},{concept:{name:"dt"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-activedescendant":null,"aria-autocomplete":null,"aria-errormessage":null,"aria-haspopup":null,"aria-invalid":null,"aria-multiline":null,"aria-placeholder":null,"aria-readonly":null,"aria-required":null},relatedConcepts:[{concept:{attributes:[{constraints:["undefined"],name:"type"},{constraints:["undefined"],name:"list"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"list"},{name:"type",value:"email"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"list"},{name:"type",value:"tel"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"list"},{name:"type",value:"text"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"list"},{name:"type",value:"url"}],name:"input"},module:"HTML"},{concept:{name:"input"},module:"XForms"},{concept:{name:"textarea"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","input"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","status"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-orientation":"horizontal"},relatedConcepts:[{concept:{name:"menubar"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","group"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null,"aria-multiselectable":null,"aria-required":null,"aria-orientation":"vertical"},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["treeitem","group"],["treeitem"]],requiredProps:{},superClass:[["roletype","widget","composite","select"],["roletype","structure","section","group","select"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["row"],["row","rowgroup"]],requiredProps:{},superClass:[["roletype","widget","composite","grid"],["roletype","structure","section","table","grid"],["roletype","widget","composite","select","tree"],["roletype","structure","section","group","select","tree"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-expanded":null,"aria-haspopup":null},relatedConcepts:[],requireContextRole:["group","tree"],requiredContextRole:["group","tree"],requiredOwnedElements:[],requiredProps:{"aria-selected":null},superClass:[["roletype","structure","section","listitem"],["roletype","widget","input","option"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=U(a(1264)),i=U(a(1265)),r=U(a(1266)),s=U(a(1267)),o=U(a(1268)),l=U(a(1269)),c=U(a(1270)),u=U(a(1271)),d=U(a(1272)),p=U(a(1273)),m=U(a(1274)),g=U(a(1275)),f=U(a(1276)),b=U(a(1277)),h=U(a(1278)),y=U(a(1279)),E=U(a(1280)),v=U(a(1281)),T=U(a(1282)),k=U(a(1283)),x=U(a(1284)),S=U(a(1285)),O=U(a(1286)),w=U(a(1287)),j=U(a(1288)),C=U(a(1289)),I=U(a(1290)),M=U(a(1291)),A=U(a(1292)),D=U(a(1293)),q=U(a(1294)),P=U(a(1295)),R=U(a(1296)),_=U(a(1297)),F=U(a(1298)),L=U(a(1299)),N=U(a(1300)),B=U(a(1301)),z=U(a(1302));function U(e){return e&&e.__esModule?e:{default:e}}var H=[["doc-abstract",n.default],["doc-acknowledgments",i.default],["doc-afterword",r.default],["doc-appendix",s.default],["doc-backlink",o.default],["doc-biblioentry",l.default],["doc-bibliography",c.default],["doc-biblioref",u.default],["doc-chapter",d.default],["doc-colophon",p.default],["doc-conclusion",m.default],["doc-cover",g.default],["doc-credit",f.default],["doc-credits",b.default],["doc-dedication",h.default],["doc-endnote",y.default],["doc-endnotes",E.default],["doc-epigraph",v.default],["doc-epilogue",T.default],["doc-errata",k.default],["doc-example",x.default],["doc-footnote",S.default],["doc-foreword",O.default],["doc-glossary",w.default],["doc-glossref",j.default],["doc-index",C.default],["doc-introduction",I.default],["doc-noteref",M.default],["doc-notice",A.default],["doc-pagebreak",D.default],["doc-pagelist",q.default],["doc-part",P.default],["doc-preface",R.default],["doc-prologue",_.default],["doc-pullquote",F.default],["doc-qna",L.default],["doc-subtitle",N.default],["doc-tip",B.default],["doc-toc",z.default]];t.default=H},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"abstract [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"acknowledgments [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"afterword [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"appendix [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","content"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"referrer [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command","link"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"EPUB biblioentry [EPUB-SSV]"},module:"EPUB"}],requireContextRole:["doc-bibliography"],requiredContextRole:["doc-bibliography"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","listitem"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"bibliography [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["doc-biblioentry"]],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"biblioref [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command","link"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"chapter [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"colophon [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"conclusion [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"cover [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","img"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"credit [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"credits [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"dedication [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"rearnote [EPUB-SSV]"},module:"EPUB"}],requireContextRole:["doc-endnotes"],requiredContextRole:["doc-endnotes"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","listitem"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"rearnotes [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["doc-endnote"]],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"epigraph [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"epilogue [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"errata [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"footnote [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"foreword [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"glossary [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["definition"],["term"]],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"glossref [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command","link"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"index [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark","navigation"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"introduction [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"noteref [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command","link"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"notice [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","note"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"pagebreak [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","separator"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"page-list [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark","navigation"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"part [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"preface [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"prologue [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"pullquote [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["none"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"qna [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"subtitle [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","sectionhead"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"help [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","note"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"toc [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark","navigation"]]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=a(583))&&n.__esModule?n:{default:n};function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,i,r=[],s=!0,o=!1;try{for(a=a.call(e);!(s=(n=a.next()).done)&&(r.push(n.value),!t||r.length!==t);s=!0);}catch(e){o=!0,i=e}finally{try{s||null==a.return||a.return()}finally{if(o)throw i}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return s(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?s(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}for(var o=[],l=i.default.keys(),c=0;c<l.length;c++){var u=l[c],d=i.default.get(u);if(d)for(var p=[].concat(d.baseConcepts,d.relatedConcepts),m=0;m<p.length;m++){var g=p[m];if("HTML"===g.module){var f=g.concept;f&&function(){var e=JSON.stringify(f),t=o.find((function(t){return JSON.stringify(t[0])===e})),a=void 0;a=t?t[1]:[];for(var n=!0,i=0;i<a.length;i++)if(a[i]===u){n=!1;break}n&&a.push(u),o.push([f,a])}()}}}var b={entries:function(){return o},get:function(e){var t=o.find((function(t){return JSON.stringify(t[0])===JSON.stringify(e)}));return t&&t[1]},has:function(e){return!!this.get(e)},keys:function(){return o.map((function(e){return r(e,1)[0]}))},values:function(){return o.map((function(e){return r(e,2)[1]}))}};t.default=b},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=a(583))&&n.__esModule?n:{default:n};function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,i,r=[],s=!0,o=!1;try{for(a=a.call(e);!(s=(n=a.next()).done)&&(r.push(n.value),!t||r.length!==t);s=!0);}catch(e){o=!0,i=e}finally{try{s||null==a.return||a.return()}finally{if(o)throw i}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return s(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?s(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}for(var o=[],l=i.default.keys(),c=function(e){var t=l[e],a=i.default.get(t);if(a)for(var n=[].concat(a.baseConcepts,a.relatedConcepts),r=0;r<n.length;r++){var s=n[r];if("HTML"===s.module){var c=s.concept;if(c){var u=o.find((function(e){return e[0]===t})),d=void 0;(d=u?u[1]:[]).push(c),o.push([t,d])}}}},u=0;u<l.length;u++)c(u);var d={entries:function(){return o},get:function(e){var t=o.find((function(t){return t[0]===e}));return t&&t[1]},has:function(e){return!!this.get(e)},keys:function(){return o.map((function(e){return r(e,1)[0]}))},values:function(){return o.map((function(e){return r(e,2)[1]}))}};t.default=d},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.queryByPlaceholderText=t.queryAllByPlaceholderText=t.getByPlaceholderText=t.getAllByPlaceholderText=t.findByPlaceholderText=t.findAllByPlaceholderText=void 0;var n=a(304),i=a(253),r=a(320);const s=(...e)=>((0,i.checkContainerType)(e[0]),(0,r.queryAllByAttribute)("placeholder",...e)),o=(0,n.wrapAllByQueryWithSuggestion)(s,s.name,"queryAll");t.queryAllByPlaceholderText=o;const[l,c,u,d,p]=(0,r.buildQueries)(s,((e,t)=>`Found multiple elements with the placeholder text of: ${t}`),((e,t)=>`Unable to find an element with the placeholder text of: ${t}`));t.findByPlaceholderText=p,t.findAllByPlaceholderText=d,t.getByPlaceholderText=u,t.getAllByPlaceholderText=c,t.queryByPlaceholderText=l},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.queryByText=t.queryAllByText=t.getByText=t.getAllByText=t.findByText=t.findAllByText=void 0;var n=a(304),i=a(253),r=a(578),s=a(320);const o=(e,t,{selector:a="*",exact:n=!0,collapseWhitespace:o,trim:l,ignore:c=r.DEFAULT_IGNORE_TAGS,normalizer:u}={})=>{(0,i.checkContainerType)(e);const d=n?s.matches:s.fuzzyMatches,p=(0,s.makeNormalizer)({collapseWhitespace:o,trim:l,normalizer:u});let m=[];return"function"==typeof e.matches&&e.matches(a)&&(m=[e]),[...m,...Array.from(e.querySelectorAll(a))].filter((e=>!c||!e.matches(c))).filter((e=>d((0,s.getNodeText)(e),e,t,p)))},l=(0,n.wrapAllByQueryWithSuggestion)(o,o.name,"queryAll");t.queryAllByText=l;const[c,u,d,p,m]=(0,s.buildQueries)(o,((e,t)=>`Found multiple elements with the text: ${t}`),((e,t,a={})=>{const{collapseWhitespace:n,trim:i,normalizer:r}=a,o=(0,s.makeNormalizer)({collapseWhitespace:n,trim:i,normalizer:r})(t.toString());return`Unable to find an element with the text: ${o!==t.toString()?`${o} (normalized from '${t}')`:t}. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.`}));t.findByText=m,t.findAllByText=p,t.getByText=d,t.getAllByText=u,t.queryByText=c},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.queryByDisplayValue=t.queryAllByDisplayValue=t.getByDisplayValue=t.getAllByDisplayValue=t.findByDisplayValue=t.findAllByDisplayValue=void 0;var n=a(304),i=a(253),r=a(320);const s=(e,t,{exact:a=!0,collapseWhitespace:n,trim:s,normalizer:o}={})=>{(0,i.checkContainerType)(e);const l=a?r.matches:r.fuzzyMatches,c=(0,r.makeNormalizer)({collapseWhitespace:n,trim:s,normalizer:o});return Array.from(e.querySelectorAll("input,textarea,select")).filter((e=>"SELECT"===e.tagName?Array.from(e.options).filter((e=>e.selected)).some((e=>l((0,r.getNodeText)(e),e,t,c))):l(e.value,e,t,c)))},o=(0,n.wrapAllByQueryWithSuggestion)(s,s.name,"queryAll");t.queryAllByDisplayValue=o;const[l,c,u,d,p]=(0,r.buildQueries)(s,((e,t)=>`Found multiple elements with the display value: ${t}.`),((e,t)=>`Unable to find an element with the display value: ${t}.`));t.findByDisplayValue=p,t.findAllByDisplayValue=d,t.getByDisplayValue=u,t.getAllByDisplayValue=c,t.queryByDisplayValue=l},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.queryByAltText=t.queryAllByAltText=t.getByAltText=t.getAllByAltText=t.findByAltText=t.findAllByAltText=void 0;var n=a(304),i=a(253),r=a(320);const s=/^(img|input|area|.+-.+)$/i,o=(e,t,a={})=>((0,i.checkContainerType)(e),(0,n.queryAllByAttribute)("alt",e,t,a).filter((e=>s.test(e.tagName)))),l=(0,n.wrapAllByQueryWithSuggestion)(o,o.name,"queryAll");t.queryAllByAltText=l;const[c,u,d,p,m]=(0,r.buildQueries)(o,((e,t)=>`Found multiple elements with the alt text: ${t}`),((e,t)=>`Unable to find an element with the alt text: ${t}`));t.findByAltText=m,t.findAllByAltText=p,t.getByAltText=d,t.getAllByAltText=u,t.queryByAltText=c},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.queryByTitle=t.queryAllByTitle=t.getByTitle=t.getAllByTitle=t.findByTitle=t.findAllByTitle=void 0;var n=a(304),i=a(253),r=a(320);const s=(e,t,{exact:a=!0,collapseWhitespace:n,trim:s,normalizer:o}={})=>{(0,i.checkContainerType)(e);const l=a?r.matches:r.fuzzyMatches,c=(0,r.makeNormalizer)({collapseWhitespace:n,trim:s,normalizer:o});return Array.from(e.querySelectorAll("[title], svg > title")).filter((e=>l(e.getAttribute("title"),e,t,c)||(e=>{var t;return"title"===e.tagName.toLowerCase()&&"svg"===(null==(t=e.parentElement)?void 0:t.tagName.toLowerCase())})(e)&&l((0,r.getNodeText)(e),e,t,c)))},o=(0,n.wrapAllByQueryWithSuggestion)(s,s.name,"queryAll");t.queryAllByTitle=o;const[l,c,u,d,p]=(0,r.buildQueries)(s,((e,t)=>`Found multiple elements with the title: ${t}.`),((e,t)=>`Unable to find an element with the title: ${t}.`));t.findByTitle=p,t.findAllByTitle=d,t.getByTitle=u,t.getAllByTitle=c,t.queryByTitle=l},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.queryByRole=t.queryAllByRole=t.getByRole=t.getAllByRole=t.findByRole=t.findAllByRole=void 0;var n=a(580),i=a(787),r=a(582),s=a(304),o=a(253),l=a(320);function c(e,t,{exact:a=!0,collapseWhitespace:s,hidden:c=(0,l.getConfig)().defaultHidden,name:u,trim:d,normalizer:p,queryFallbacks:m=!1,selected:g,checked:f,pressed:b,current:h,level:y,expanded:E}={}){(0,o.checkContainerType)(e);const v=a?l.matches:l.fuzzyMatches,T=(0,l.makeNormalizer)({collapseWhitespace:s,trim:d,normalizer:p});var k,x,S,O,w;if(void 0!==g&&void 0===(null==(k=i.roles.get(t))?void 0:k.props["aria-selected"]))throw new Error(`"aria-selected" is not supported on role "${t}".`);if(void 0!==f&&void 0===(null==(x=i.roles.get(t))?void 0:x.props["aria-checked"]))throw new Error(`"aria-checked" is not supported on role "${t}".`);if(void 0!==b&&void 0===(null==(S=i.roles.get(t))?void 0:S.props["aria-pressed"]))throw new Error(`"aria-pressed" is not supported on role "${t}".`);if(void 0!==h&&void 0===(null==(O=i.roles.get(t))?void 0:O.props["aria-current"]))throw new Error(`"aria-current" is not supported on role "${t}".`);if(void 0!==y&&"heading"!==t)throw new Error(`Role "${t}" cannot have "level" property.`);if(void 0!==E&&void 0===(null==(w=i.roles.get(t))?void 0:w.props["aria-expanded"]))throw new Error(`"aria-expanded" is not supported on role "${t}".`);const j=new WeakMap;function C(e){return j.has(e)||j.set(e,(0,r.isSubtreeInaccessible)(e)),j.get(e)}return Array.from(e.querySelectorAll(function(e,t,a){var n;if("string"!=typeof e)return"*";const r=t&&!a?`*[role~="${e}"]`:"*[role]",s=null!=(n=i.roleElements.get(e))?n:new Set,o=new Set(Array.from(s).map((({name:e})=>e)));return[r].concat(Array.from(o)).join(",")}(t,a,p?T:void 0))).filter((e=>{if(e.hasAttribute("role")){const a=e.getAttribute("role");if(m)return a.split(" ").filter(Boolean).some((a=>v(a,e,t,T)));if(p)return v(a,e,t,T);const[n]=a.split(" ");return v(n,e,t,T)}return(0,r.getImplicitAriaRoles)(e).some((a=>v(a,e,t,T)))})).filter((e=>void 0!==g?g===(0,r.computeAriaSelected)(e):void 0!==f?f===(0,r.computeAriaChecked)(e):void 0!==b?b===(0,r.computeAriaPressed)(e):void 0!==h?h===(0,r.computeAriaCurrent)(e):void 0!==E?E===(0,r.computeAriaExpanded)(e):void 0===y||y===(0,r.computeHeadingLevel)(e))).filter((e=>void 0===u||(0,l.matches)((0,n.computeAccessibleName)(e,{computedStyleSupportsPseudoElements:(0,l.getConfig)().computedStyleSupportsPseudoElements}),e,u,(e=>e)))).filter((e=>!1!==c||!1===(0,r.isInaccessible)(e,{isSubtreeInaccessible:C})))}const u=(0,s.wrapAllByQueryWithSuggestion)(c,c.name,"queryAll");t.queryAllByRole=u;const[d,p,m,g,f]=(0,l.buildQueries)(c,((e,t,{name:a}={})=>{let n="";return n=void 0===a?"":"string"==typeof a?` and name "${a}"`:` and name \`${a}\``,`Found multiple elements with the role "${t}"${n}`}),((e,t,{hidden:a=(0,l.getConfig)().defaultHidden,name:n}={})=>{if((0,l.getConfig)()._disableExpensiveErrorDiagnostics)return`Unable to find role="${t}"`;let i,s="";Array.from(e.children).forEach((e=>{s+=(0,r.prettyRoles)(e,{hidden:a,includeName:void 0!==n})})),i=0===s.length?!1===a?"There are no accessible roles. But there might be some inaccessible roles. If you wish to access them, then set the `hidden` option to `true`. Learn more about this here: https://testing-library.com/docs/dom-testing-library/api-queries#byrole":"There are no available roles.":`\nHere are the ${!1===a?"accessible":"available"} roles:\n\n  ${s.replace(/\n/g,"\n  ").replace(/\n\s\s\n/g,"\n\n")}\n`.trim();let o="";return o=void 0===n?"":"string"==typeof n?` and name "${n}"`:` and name \`${n}\``,`\nUnable to find an ${!1===a?"accessible ":""}element with the role "${t}"${o}\n\n${i}`.trim()}));t.findByRole=f,t.findAllByRole=g,t.getByRole=m,t.getAllByRole=p,t.queryByRole=d},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.queryByTestId=t.queryAllByTestId=t.getByTestId=t.getAllByTestId=t.findByTestId=t.findAllByTestId=void 0;var n=a(253),i=a(304),r=a(320);const s=()=>(0,r.getConfig)().testIdAttribute,o=(...e)=>((0,n.checkContainerType)(e[0]),(0,r.queryAllByAttribute)(s(),...e)),l=(0,i.wrapAllByQueryWithSuggestion)(o,o.name,"queryAll");t.queryAllByTestId=l;const[c,u,d,p,m]=(0,r.buildQueries)(o,((e,t)=>`Found multiple elements by: [${s()}="${t}"]`),((e,t)=>`Unable to find an element by: [${s()}="${t}"]`));t.findByTestId=m,t.findAllByTestId=p,t.getByTestId=d,t.getAllByTestId=u,t.queryByTestId=c},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.waitForElementToBeRemoved=async function(e,t){const a=new Error("Timed out in waitForElementToBeRemoved.");if("function"!=typeof e){r(e);const t=(Array.isArray(e)?e:[e]).map((e=>{let t=e.parentElement;if(null===t)return()=>null;for(;t.parentElement;)t=t.parentElement;return()=>t.contains(e)?e:null}));e=()=>t.map((e=>e())).filter(Boolean)}return r(e()),(0,n.waitFor)((()=>{let t;try{t=e()}catch(e){if("TestingLibraryElementError"===e.name)return;throw e}if(!i(t))throw a}),t)};var n=a(584);const i=e=>!e||Array.isArray(e)&&!e.length;function r(e){if(i(e))throw new Error("The element(s) given to waitForElementToBeRemoved are already removed. waitForElementToBeRemoved requires that the element(s) exist(s) before waiting for removal.")}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createEvent=o,t.fireEvent=s;var n=a(319),i=a(253),r=a(1314);function s(e,t){return(0,n.getConfig)().eventWrapper((()=>{if(!t)throw new Error("Unable to fire an event - please provide an event object.");if(!e)throw new Error(`Unable to fire a "${t.type}" event - please provide a DOM element.`);return e.dispatchEvent(t)}))}function o(e,t,a,{EventType:n="Event",defaultInit:r={}}={}){if(!t)throw new Error(`Unable to fire a "${e}" event - please provide a DOM element.`);const s={...r,...a},{target:{value:o,files:l,...c}={}}=s;void 0!==o&&function(e,t){const{set:a}=Object.getOwnPropertyDescriptor(e,"value")||{},n=Object.getPrototypeOf(e),{set:i}=Object.getOwnPropertyDescriptor(n,"value")||{};if(i&&a!==i)i.call(e,t);else{if(!a)throw new Error("The given element does not have a value setter");a.call(e,t)}}(t,o),void 0!==l&&Object.defineProperty(t,"files",{configurable:!0,enumerable:!0,writable:!0,value:l}),Object.assign(t,c);const u=(0,i.getWindowFromNode)(t),d=u[n]||u.Event;let p;if("function"==typeof d)p=new d(e,s);else{p=u.document.createEvent(n);const{bubbles:t,cancelable:a,detail:i,...r}=s;p.initEvent(e,t,a,i),Object.keys(r).forEach((e=>{p[e]=r[e]}))}return["dataTransfer","clipboardData"].forEach((e=>{const t=s[e];"object"==typeof t&&("function"==typeof u.DataTransfer?Object.defineProperty(p,e,{value:Object.getOwnPropertyNames(t).reduce(((e,a)=>(Object.defineProperty(e,a,{value:t[a]}),e)),new u.DataTransfer)}):Object.defineProperty(p,e,{value:t}))})),p}Object.keys(r.eventMap).forEach((e=>{const{EventType:t,defaultInit:a}=r.eventMap[e],n=e.toLowerCase();o[e]=(e,i)=>o(n,e,i,{EventType:t,defaultInit:a}),s[e]=(t,a)=>s(t,o[e](t,a))})),Object.keys(r.eventAliasMap).forEach((e=>{const t=r.eventAliasMap[e];s[e]=(...e)=>s[t](...e)}))},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.eventMap=t.eventAliasMap=void 0,t.eventMap={copy:{EventType:"ClipboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},cut:{EventType:"ClipboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},paste:{EventType:"ClipboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},compositionEnd:{EventType:"CompositionEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},compositionStart:{EventType:"CompositionEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},compositionUpdate:{EventType:"CompositionEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},keyDown:{EventType:"KeyboardEvent",defaultInit:{bubbles:!0,cancelable:!0,charCode:0,composed:!0}},keyPress:{EventType:"KeyboardEvent",defaultInit:{bubbles:!0,cancelable:!0,charCode:0,composed:!0}},keyUp:{EventType:"KeyboardEvent",defaultInit:{bubbles:!0,cancelable:!0,charCode:0,composed:!0}},focus:{EventType:"FocusEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},blur:{EventType:"FocusEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},focusIn:{EventType:"FocusEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},focusOut:{EventType:"FocusEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},change:{EventType:"Event",defaultInit:{bubbles:!0,cancelable:!1}},input:{EventType:"InputEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},invalid:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!0}},submit:{EventType:"Event",defaultInit:{bubbles:!0,cancelable:!0}},reset:{EventType:"Event",defaultInit:{bubbles:!0,cancelable:!0}},click:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,button:0,composed:!0}},contextMenu:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},dblClick:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},drag:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},dragEnd:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},dragEnter:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},dragExit:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},dragLeave:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},dragOver:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},dragStart:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},drop:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseDown:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseEnter:{EventType:"MouseEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},mouseLeave:{EventType:"MouseEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},mouseMove:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseOut:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseOver:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseUp:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},select:{EventType:"Event",defaultInit:{bubbles:!0,cancelable:!1}},touchCancel:{EventType:"TouchEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},touchEnd:{EventType:"TouchEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},touchMove:{EventType:"TouchEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},touchStart:{EventType:"TouchEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},resize:{EventType:"UIEvent",defaultInit:{bubbles:!1,cancelable:!1}},scroll:{EventType:"UIEvent",defaultInit:{bubbles:!1,cancelable:!1}},wheel:{EventType:"WheelEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},abort:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},canPlay:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},canPlayThrough:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},durationChange:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},emptied:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},encrypted:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},ended:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},loadedData:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},loadedMetadata:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},loadStart:{EventType:"ProgressEvent",defaultInit:{bubbles:!1,cancelable:!1}},pause:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},play:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},playing:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},progress:{EventType:"ProgressEvent",defaultInit:{bubbles:!1,cancelable:!1}},rateChange:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},seeked:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},seeking:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},stalled:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},suspend:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},timeUpdate:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},volumeChange:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},waiting:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},load:{EventType:"UIEvent",defaultInit:{bubbles:!1,cancelable:!1}},error:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},animationStart:{EventType:"AnimationEvent",defaultInit:{bubbles:!0,cancelable:!1}},animationEnd:{EventType:"AnimationEvent",defaultInit:{bubbles:!0,cancelable:!1}},animationIteration:{EventType:"AnimationEvent",defaultInit:{bubbles:!0,cancelable:!1}},transitionCancel:{EventType:"TransitionEvent",defaultInit:{bubbles:!0,cancelable:!1}},transitionEnd:{EventType:"TransitionEvent",defaultInit:{bubbles:!0,cancelable:!0}},transitionRun:{EventType:"TransitionEvent",defaultInit:{bubbles:!0,cancelable:!1}},transitionStart:{EventType:"TransitionEvent",defaultInit:{bubbles:!0,cancelable:!1}},pointerOver:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerEnter:{EventType:"PointerEvent",defaultInit:{bubbles:!1,cancelable:!1}},pointerDown:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerMove:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerUp:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerCancel:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},pointerOut:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerLeave:{EventType:"PointerEvent",defaultInit:{bubbles:!1,cancelable:!1}},gotPointerCapture:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},lostPointerCapture:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},popState:{EventType:"PopStateEvent",defaultInit:{bubbles:!0,cancelable:!1}}},t.eventAliasMap={doubleClick:"dblClick"}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.screen=void 0;var n=a(1316),i=a(781),r=a(253),s=a(482),o=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var a=l(t);if(a&&a.has(e))return a.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if("default"!==r&&Object.prototype.hasOwnProperty.call(e,r)){var s=i?Object.getOwnPropertyDescriptor(e,r):null;s&&(s.get||s.set)?Object.defineProperty(n,r,s):n[r]=e[r]}return n.default=e,a&&a.set(e,n),n}(a(576));function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(l=function(e){return e?a:t})(e)}const c={debug:(e,t,a)=>Array.isArray(e)?e.forEach((e=>(0,s.logDOM)(e,t,a))):(0,s.logDOM)(e,t,a),logTestingPlaygroundURL:(e=(0,r.getDocument)().body)=>{var t,a;e&&"innerHTML"in e?e.innerHTML?console.log("Open this URL in your browser\n\n"+(t=e.innerHTML,`https://testing-playground.com/#markup=${a=t,(0,n.compressToEncodedURIComponent)(a.replace(/[ \t]*[\n][ \t]*/g,"\n"))}`)):console.log("The provided element doesn't have any children."):console.log("The element you're providing isn't a valid DOM element.")}},u="undefined"!=typeof document&&document.body?(0,i.getQueriesForElement)(document.body,o,c):Object.keys(o).reduce(((e,t)=>(e[t]=()=>{throw new TypeError("For queries bound to document.body a global document has to be available... Learn more: https://testing-library.com/s/screen-global-error")},e)),c);t.screen=u},function(e,t,a){var n,i=function(){var e=String.fromCharCode,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",n={};function i(e,t){if(!n[e]){n[e]={};for(var a=0;a<e.length;a++)n[e][e.charAt(a)]=a}return n[e][t]}var r={compressToBase64:function(e){if(null==e)return"";var a=r._compress(e,6,(function(e){return t.charAt(e)}));switch(a.length%4){default:case 0:return a;case 1:return a+"===";case 2:return a+"==";case 3:return a+"="}},decompressFromBase64:function(e){return null==e?"":""==e?null:r._decompress(e.length,32,(function(a){return i(t,e.charAt(a))}))},compressToUTF16:function(t){return null==t?"":r._compress(t,15,(function(t){return e(t+32)}))+" "},decompressFromUTF16:function(e){return null==e?"":""==e?null:r._decompress(e.length,16384,(function(t){return e.charCodeAt(t)-32}))},compressToUint8Array:function(e){for(var t=r.compress(e),a=new Uint8Array(2*t.length),n=0,i=t.length;n<i;n++){var s=t.charCodeAt(n);a[2*n]=s>>>8,a[2*n+1]=s%256}return a},decompressFromUint8Array:function(t){if(null==t)return r.decompress(t);for(var a=new Array(t.length/2),n=0,i=a.length;n<i;n++)a[n]=256*t[2*n]+t[2*n+1];var s=[];return a.forEach((function(t){s.push(e(t))})),r.decompress(s.join(""))},compressToEncodedURIComponent:function(e){return null==e?"":r._compress(e,6,(function(e){return a.charAt(e)}))},decompressFromEncodedURIComponent:function(e){return null==e?"":""==e?null:(e=e.replace(/ /g,"+"),r._decompress(e.length,32,(function(t){return i(a,e.charAt(t))})))},compress:function(t){return r._compress(t,16,(function(t){return e(t)}))},_compress:function(e,t,a){if(null==e)return"";var n,i,r,s={},o={},l="",c="",u="",d=2,p=3,m=2,g=[],f=0,b=0;for(r=0;r<e.length;r+=1)if(l=e.charAt(r),Object.prototype.hasOwnProperty.call(s,l)||(s[l]=p++,o[l]=!0),c=u+l,Object.prototype.hasOwnProperty.call(s,c))u=c;else{if(Object.prototype.hasOwnProperty.call(o,u)){if(u.charCodeAt(0)<256){for(n=0;n<m;n++)f<<=1,b==t-1?(b=0,g.push(a(f)),f=0):b++;for(i=u.charCodeAt(0),n=0;n<8;n++)f=f<<1|1&i,b==t-1?(b=0,g.push(a(f)),f=0):b++,i>>=1}else{for(i=1,n=0;n<m;n++)f=f<<1|i,b==t-1?(b=0,g.push(a(f)),f=0):b++,i=0;for(i=u.charCodeAt(0),n=0;n<16;n++)f=f<<1|1&i,b==t-1?(b=0,g.push(a(f)),f=0):b++,i>>=1}0==--d&&(d=Math.pow(2,m),m++),delete o[u]}else for(i=s[u],n=0;n<m;n++)f=f<<1|1&i,b==t-1?(b=0,g.push(a(f)),f=0):b++,i>>=1;0==--d&&(d=Math.pow(2,m),m++),s[c]=p++,u=String(l)}if(""!==u){if(Object.prototype.hasOwnProperty.call(o,u)){if(u.charCodeAt(0)<256){for(n=0;n<m;n++)f<<=1,b==t-1?(b=0,g.push(a(f)),f=0):b++;for(i=u.charCodeAt(0),n=0;n<8;n++)f=f<<1|1&i,b==t-1?(b=0,g.push(a(f)),f=0):b++,i>>=1}else{for(i=1,n=0;n<m;n++)f=f<<1|i,b==t-1?(b=0,g.push(a(f)),f=0):b++,i=0;for(i=u.charCodeAt(0),n=0;n<16;n++)f=f<<1|1&i,b==t-1?(b=0,g.push(a(f)),f=0):b++,i>>=1}0==--d&&(d=Math.pow(2,m),m++),delete o[u]}else for(i=s[u],n=0;n<m;n++)f=f<<1|1&i,b==t-1?(b=0,g.push(a(f)),f=0):b++,i>>=1;0==--d&&(d=Math.pow(2,m),m++)}for(i=2,n=0;n<m;n++)f=f<<1|1&i,b==t-1?(b=0,g.push(a(f)),f=0):b++,i>>=1;for(;;){if(f<<=1,b==t-1){g.push(a(f));break}b++}return g.join("")},decompress:function(e){return null==e?"":""==e?null:r._decompress(e.length,32768,(function(t){return e.charCodeAt(t)}))},_decompress:function(t,a,n){var i,r,s,o,l,c,u,d=[],p=4,m=4,g=3,f="",b=[],h={val:n(0),position:a,index:1};for(i=0;i<3;i+=1)d[i]=i;for(s=0,l=Math.pow(2,2),c=1;c!=l;)o=h.val&h.position,h.position>>=1,0==h.position&&(h.position=a,h.val=n(h.index++)),s|=(o>0?1:0)*c,c<<=1;switch(s){case 0:for(s=0,l=Math.pow(2,8),c=1;c!=l;)o=h.val&h.position,h.position>>=1,0==h.position&&(h.position=a,h.val=n(h.index++)),s|=(o>0?1:0)*c,c<<=1;u=e(s);break;case 1:for(s=0,l=Math.pow(2,16),c=1;c!=l;)o=h.val&h.position,h.position>>=1,0==h.position&&(h.position=a,h.val=n(h.index++)),s|=(o>0?1:0)*c,c<<=1;u=e(s);break;case 2:return""}for(d[3]=u,r=u,b.push(u);;){if(h.index>t)return"";for(s=0,l=Math.pow(2,g),c=1;c!=l;)o=h.val&h.position,h.position>>=1,0==h.position&&(h.position=a,h.val=n(h.index++)),s|=(o>0?1:0)*c,c<<=1;switch(u=s){case 0:for(s=0,l=Math.pow(2,8),c=1;c!=l;)o=h.val&h.position,h.position>>=1,0==h.position&&(h.position=a,h.val=n(h.index++)),s|=(o>0?1:0)*c,c<<=1;d[m++]=e(s),u=m-1,p--;break;case 1:for(s=0,l=Math.pow(2,16),c=1;c!=l;)o=h.val&h.position,h.position>>=1,0==h.position&&(h.position=a,h.val=n(h.index++)),s|=(o>0?1:0)*c,c<<=1;d[m++]=e(s),u=m-1,p--;break;case 2:return b.join("")}if(0==p&&(p=Math.pow(2,g),g++),d[u])f=d[u];else{if(u!==m)return null;f=r+r.charAt(0)}b.push(f),d[m++]=r+f.charAt(0),r=f,0==--p&&(p=Math.pow(2,g),g++)}}};return r}();void 0===(n=function(){return i}.call(t,a,t,e))||(e.exports=n)},function(e,t,a){"use strict";var n=a(34);Object.defineProperty(t,"__esModule",{value:!0}),t.asyncAct=function(e){if(!0===c){if(null===p)return new Promise(((t,a)=>{const n=console.error;let i,r;console.error=function(...e){const t="string"==typeof e[0];t&&0===e[0].indexOf("Warning: Do not await the result of calling ReactTestUtils.act")?p=!1:t&&0===e[0].indexOf("Warning: The callback passed to ReactTestUtils.act(...) function must not return anything")||n.apply(console,e)};try{r=l((()=>(i=e(),i)))}catch(e){return console.error=n,void a(e)}r.then((()=>{console.error=n,p=!0,t()}),(e=>{console.error=n,p=!0,a(e)})),!1===p&&(console.error=n,d||(console.error('It looks like you\'re using a version of react-dom that supports the "act" function, but not an awaitable version of "act" which you will need. Please upgrade to at least react-dom@16.9.0 to remove this warning.'),d=!0),i.then((()=>{Promise.resolve().then((()=>{u((()=>{})),t()}))}),a))}));if(!1===p){let t;return u((()=>{t=e()})),t.then((()=>Promise.resolve().then((()=>{u((()=>{}))}))))}return u(e)}let t;return u((()=>{t=e()})),t.then((()=>Promise.resolve().then((()=>{u((()=>{}))}))))},t.default=void 0;var i=o(a(5)),r=n(a(138));function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(s=function(e){return e?a:t})(e)}function o(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var a=s(t);if(a&&a.has(e))return a.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if("default"!==r&&Object.prototype.hasOwnProperty.call(e,r)){var o=i?Object.getOwnPropertyDescriptor(e,r):null;o&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r]}return n.default=e,a&&a.set(e,n),n}const l=o(a(1318)).act,c=void 0!==l,u=l||function(e){r.default.unstable_batchedUpdates(e),r.default.render(i.createElement("div",null),document.createElement("div"))};let d=!1,p=null;var m=u;t.default=m},function(e,t,a){"use strict";e.exports=a(1319)},function(e,t,a){"use strict";(function(e){
/** @license React v16.14.0
 * react-dom-test-utils.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var t=a(1320),n=a(5),i=a(138),r=a(1321);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,a=1;a<arguments.length;a++)t+="&args[]="+encodeURIComponent(arguments[a]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function l(e){var t=e,a=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!=(1026&(t=e).effectTag)&&(a=t.return),e=t.return}while(e)}return 3===t.tag?a:null}function c(e){if(l(e)!==e)throw Error(s(188))}function u(){return!0}function d(){return!1}function p(e,t,a,n){for(var i in this.dispatchConfig=e,this._targetInst=t,this.nativeEvent=a,e=this.constructor.Interface)e.hasOwnProperty(i)&&((t=e[i])?this[i]=t(a):"target"===i?this.target=n:this[i]=a[i]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?u:d,this.isPropagationStopped=d,this}function m(e,t,a,n){if(this.eventPool.length){var i=this.eventPool.pop();return this.call(i,e,t,a,n),i}return new this(e,t,a,n)}function g(e){if(!(e instanceof this))throw Error(s(279));e.destructor(),10>this.eventPool.length&&this.eventPool.push(e)}function f(e){e.eventPool=[],e.getPooled=m,e.release=g}o.hasOwnProperty("ReactCurrentDispatcher")||(o.ReactCurrentDispatcher={current:null}),o.hasOwnProperty("ReactCurrentBatchConfig")||(o.ReactCurrentBatchConfig={suspense:null}),t(p.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=u)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=u)},persist:function(){this.isPersistent=u},isPersistent:d,destructor:function(){var e,t=this.constructor.Interface;for(e in t)this[e]=null;this.nativeEvent=this._targetInst=this.dispatchConfig=null,this.isPropagationStopped=this.isDefaultPrevented=d,this._dispatchInstances=this._dispatchListeners=null}}),p.Interface={type:null,target:null,currentTarget:function(){return null},eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null},p.extend=function(e){function a(){}function n(){return i.apply(this,arguments)}var i=this;a.prototype=i.prototype;var r=new a;return t(r,n.prototype),n.prototype=r,n.prototype.constructor=n,n.Interface=t({},i.Interface,e),n.extend=i.extend,f(n),n},f(p);var b=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement);function h(e,t){var a={};return a[e.toLowerCase()]=t.toLowerCase(),a["Webkit"+e]="webkit"+t,a["Moz"+e]="moz"+t,a}var y={animationend:h("Animation","AnimationEnd"),animationiteration:h("Animation","AnimationIteration"),animationstart:h("Animation","AnimationStart"),transitionend:h("Transition","TransitionEnd")},E={},v={};function T(e){if(E[e])return E[e];if(!y[e])return e;var t,a=y[e];for(t in a)if(a.hasOwnProperty(t)&&t in v)return E[e]=a[t];return e}b&&(v=document.createElement("div").style,"AnimationEvent"in window||(delete y.animationend.animation,delete y.animationiteration.animation,delete y.animationstart.animation),"TransitionEvent"in window||delete y.transitionend.transition);var k=T("animationend"),x=T("animationiteration"),S=T("animationstart"),O=T("transitionend"),w=null,j=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.Events,C=j[11],I=j[12],M=i.unstable_batchedUpdates,A=o.IsSomeRendererActing,D="function"==typeof r.unstable_flushAllWithoutAsserting,q=r.unstable_flushAllWithoutAsserting||function(){for(var e=!1;C();)e=!0;return e};function P(t){try{q(),function(t){if(null===w)try{var a=("require"+Math.random()).slice(0,7);w=(e&&e[a])("timers").setImmediate}catch(e){w=function(e){var t=new MessageChannel;t.port1.onmessage=e,t.port2.postMessage(void 0)}}w(t)}((function(){q()?P(t):t()}))}catch(e){t(e)}}var R=0,_=!1,F=i.findDOMNode,L=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.Events,N=L[0],B=L[4],z=L[5],U=L[6],H=L[7],$=L[8],V=L[9],Q=L[10];function W(){}function G(e,t){if(e&&!e._reactInternalFiber){var a=""+e;throw e=Array.isArray(e)?"an array":e&&1===e.nodeType&&e.tagName?"a DOM node":"[object Object]"===a?"object with keys {"+Object.keys(e).join(", ")+"}":a,Error(s(286,t,e))}}var K={renderIntoDocument:function(e){var t=document.createElement("div");return i.render(e,t)},isElement:function(e){return n.isValidElement(e)},isElementOfType:function(e,t){return n.isValidElement(e)&&e.type===t},isDOMComponent:function(e){return!(!e||1!==e.nodeType||!e.tagName)},isDOMComponentElement:function(e){return!!(e&&n.isValidElement(e)&&e.tagName)},isCompositeComponent:function(e){return!K.isDOMComponent(e)&&null!=e&&"function"==typeof e.render&&"function"==typeof e.setState},isCompositeComponentWithType:function(e,t){return!!K.isCompositeComponent(e)&&e._reactInternalFiber.type===t},findAllInRenderedTree:function(e,t){return G(e,"findAllInRenderedTree"),e?function(e,t){if(!e)return[];if(e=function(e){var t=e.alternate;if(!t){if(null===(t=l(e)))throw Error(s(188));return t!==e?null:e}for(var a=e,n=t;;){var i=a.return;if(null===i)break;var r=i.alternate;if(null===r){if(null!==(n=i.return)){a=n;continue}break}if(i.child===r.child){for(r=i.child;r;){if(r===a)return c(i),e;if(r===n)return c(i),t;r=r.sibling}throw Error(s(188))}if(a.return!==n.return)a=i,n=r;else{for(var o=!1,u=i.child;u;){if(u===a){o=!0,a=i,n=r;break}if(u===n){o=!0,n=i,a=r;break}u=u.sibling}if(!o){for(u=r.child;u;){if(u===a){o=!0,a=r,n=i;break}if(u===n){o=!0,n=r,a=i;break}u=u.sibling}if(!o)throw Error(s(189))}}if(a.alternate!==n)throw Error(s(190))}if(3!==a.tag)throw Error(s(188));return a.stateNode.current===a?e:t}(e),!e)return[];for(var a=e,n=[];;){if(5===a.tag||6===a.tag||1===a.tag||0===a.tag){var i=a.stateNode;t(i)&&n.push(i)}if(a.child)a.child.return=a,a=a.child;else{if(a===e)return n;for(;!a.sibling;){if(!a.return||a.return===e)return n;a=a.return}a.sibling.return=a.return,a=a.sibling}}}(e._reactInternalFiber,t):[]},scryRenderedDOMComponentsWithClass:function(e,t){return G(e,"scryRenderedDOMComponentsWithClass"),K.findAllInRenderedTree(e,(function(e){if(K.isDOMComponent(e)){var a=e.className;"string"!=typeof a&&(a=e.getAttribute("class")||"");var n=a.split(/\s+/);if(!Array.isArray(t)){if(void 0===t)throw Error(s(11));t=t.split(/\s+/)}return t.every((function(e){return-1!==n.indexOf(e)}))}return!1}))},findRenderedDOMComponentWithClass:function(e,t){if(G(e,"findRenderedDOMComponentWithClass"),1!==(e=K.scryRenderedDOMComponentsWithClass(e,t)).length)throw Error("Did not find exactly one match (found: "+e.length+") for class:"+t);return e[0]},scryRenderedDOMComponentsWithTag:function(e,t){return G(e,"scryRenderedDOMComponentsWithTag"),K.findAllInRenderedTree(e,(function(e){return K.isDOMComponent(e)&&e.tagName.toUpperCase()===t.toUpperCase()}))},findRenderedDOMComponentWithTag:function(e,t){if(G(e,"findRenderedDOMComponentWithTag"),1!==(e=K.scryRenderedDOMComponentsWithTag(e,t)).length)throw Error("Did not find exactly one match (found: "+e.length+") for tag:"+t);return e[0]},scryRenderedComponentsWithType:function(e,t){return G(e,"scryRenderedComponentsWithType"),K.findAllInRenderedTree(e,(function(e){return K.isCompositeComponentWithType(e,t)}))},findRenderedComponentWithType:function(e,t){if(G(e,"findRenderedComponentWithType"),1!==(e=K.scryRenderedComponentsWithType(e,t)).length)throw Error("Did not find exactly one match (found: "+e.length+") for componentType:"+t);return e[0]},mockComponent:function(e,t){return t=t||e.mockTagName||"div",e.prototype.render.mockImplementation((function(){return n.createElement(t,null,this.props.children)})),this},nativeTouchData:function(e,t){return{touches:[{pageX:e,pageY:t}]}},Simulate:null,SimulateNative:{},act:function(e){function t(){R--,A.current=a,I.current=n}!1===_&&(_=!0,console.error("act(...) is not supported in production builds of React, and might not behave as expected.")),R++;var a=A.current,n=I.current;A.current=!0,I.current=!0;try{var i=M(e)}catch(e){throw t(),e}if(null!==i&&"object"==typeof i&&"function"==typeof i.then)return{then:function(e,n){i.then((function(){1<R||!0===D&&!0===a?(t(),e()):P((function(a){t(),a?n(a):e()}))}),(function(e){t(),n(e)}))}};try{1!==R||!1!==D&&!1!==a||q(),t()}catch(e){throw t(),e}return{then:function(e){e()}}}};function Y(e){return function(a,r){if(n.isValidElement(a))throw Error(s(228));if(K.isCompositeComponent(a))throw Error(s(229));var o=B[e],l=new W;l.target=a,l.type=e.toLowerCase();var c=new p(o,N(a),l,a);c.persist(),t(c,r),o.phasedRegistrationNames?z(c):U(c),i.unstable_batchedUpdates((function(){H(a),Q(c)})),$()}}for(var J in K.Simulate={},B)K.Simulate[J]=Y(J);[["abort","abort"],[k,"animationEnd"],[x,"animationIteration"],[S,"animationStart"],["blur","blur"],["canplaythrough","canPlayThrough"],["canplay","canPlay"],["cancel","cancel"],["change","change"],["click","click"],["close","close"],["compositionend","compositionEnd"],["compositionstart","compositionStart"],["compositionupdate","compositionUpdate"],["contextmenu","contextMenu"],["copy","copy"],["cut","cut"],["dblclick","doubleClick"],["dragend","dragEnd"],["dragenter","dragEnter"],["dragexit","dragExit"],["dragleave","dragLeave"],["dragover","dragOver"],["dragstart","dragStart"],["drag","drag"],["drop","drop"],["durationchange","durationChange"],["emptied","emptied"],["encrypted","encrypted"],["ended","ended"],["error","error"],["focus","focus"],["input","input"],["keydown","keyDown"],["keypress","keyPress"],["keyup","keyUp"],["loadstart","loadStart"],["loadstart","loadStart"],["load","load"],["loadeddata","loadedData"],["loadedmetadata","loadedMetadata"],["mousedown","mouseDown"],["mousemove","mouseMove"],["mouseout","mouseOut"],["mouseover","mouseOver"],["mouseup","mouseUp"],["paste","paste"],["pause","pause"],["play","play"],["playing","playing"],["progress","progress"],["ratechange","rateChange"],["scroll","scroll"],["seeked","seeked"],["seeking","seeking"],["selectionchange","selectionChange"],["stalled","stalled"],["suspend","suspend"],["textInput","textInput"],["timeupdate","timeUpdate"],["toggle","toggle"],["touchcancel","touchCancel"],["touchend","touchEnd"],["touchmove","touchMove"],["touchstart","touchStart"],[O,"transitionEnd"],["volumechange","volumeChange"],["waiting","waiting"],["wheel","wheel"]].forEach((function(e){var a=e[1];K.SimulateNative[a]=function(e,a){return function(n,i){var r=new W(e);t(r,i),K.isDOMComponent(n)?(n=F(n),r.target=n,V(a,1,document,r)):n.tagName&&(r.target=n,V(a,1,document,r))}}(a,e[0])})),e.exports=K.default||K}).call(this,a(303)(e))},function(e,t,a){e.exports=a(24)(992)},function(e,t,a){e.exports=a(24)(2584)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fireEvent=void 0;var n=a(780);const i=(...e)=>(0,n.fireEvent)(...e);t.fireEvent=i,Object.keys(n.fireEvent).forEach((e=>{i[e]=(...t)=>n.fireEvent[e](...t)}));const r=i.mouseEnter,s=i.mouseLeave;i.mouseEnter=(...e)=>(r(...e),i.mouseOver(...e)),i.mouseLeave=(...e)=>(s(...e),i.mouseOut(...e));const o=i.pointerEnter,l=i.pointerLeave;i.pointerEnter=(...e)=>(o(...e),i.pointerOver(...e)),i.pointerLeave=(...e)=>(l(...e),i.pointerOut(...e));const c=i.select;i.select=(e,t)=>{c(e,t),e.focus(),i.keyUp(e,t)};const u=i.blur,d=i.focus;i.blur=(...e)=>(i.focusOut(...e),u(...e)),i.focus=(...e)=>(i.focusIn(...e),d(...e))},function(e,t,a){var n=a(1324),i=a(1325),r=a(1326),s=a(1327),o=a(1328),l=a(1329),c=a(1330);c.alea=n,c.xor128=i,c.xorwow=r,c.xorshift7=s,c.xor4096=o,c.tychei=l,e.exports=c},function(e,t,a){(function(e){var n;!function(e,i,r){function s(e){var t,a=this,n=(t=4022871197,function(e){e=String(e);for(var a=0;a<e.length;a++){var n=.02519603282416938*(t+=e.charCodeAt(a));n-=t=n>>>0,t=(n*=t)>>>0,t+=4294967296*(n-=t)}return 2.3283064365386963e-10*(t>>>0)});a.next=function(){var e=2091639*a.s0+2.3283064365386963e-10*a.c;return a.s0=a.s1,a.s1=a.s2,a.s2=e-(a.c=0|e)},a.c=1,a.s0=n(" "),a.s1=n(" "),a.s2=n(" "),a.s0-=n(e),a.s0<0&&(a.s0+=1),a.s1-=n(e),a.s1<0&&(a.s1+=1),a.s2-=n(e),a.s2<0&&(a.s2+=1),n=null}function o(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function l(e,t){var a=new s(e),n=t&&t.state,i=a.next;return i.int32=function(){return 4294967296*a.next()|0},i.double=function(){return i()+11102230246251565e-32*(2097152*i()|0)},i.quick=i,n&&("object"==typeof n&&o(n,a),i.state=function(){return o(a,{})}),i}i&&i.exports?i.exports=l:a(267)&&a(387)?void 0===(n=function(){return l}.call(t,a,t,i))||(i.exports=n):this.alea=l}(0,e,a(267))}).call(this,a(303)(e))},function(e,t,a){(function(e){var n;!function(e,i,r){function s(e){var t=this,a="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:a+=e;for(var n=0;n<a.length+64;n++)t.x^=0|a.charCodeAt(n),t.next()}function o(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function l(e,t){var a=new s(e),n=t&&t.state,i=function(){return(a.next()>>>0)/4294967296};return i.double=function(){do{var e=((a.next()>>>11)+(a.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=a.next,i.quick=i,n&&("object"==typeof n&&o(n,a),i.state=function(){return o(a,{})}),i}i&&i.exports?i.exports=l:a(267)&&a(387)?void 0===(n=function(){return l}.call(t,a,t,i))||(i.exports=n):this.xor128=l}(0,e,a(267))}).call(this,a(303)(e))},function(e,t,a){(function(e){var n;!function(e,i,r){function s(e){var t=this,a="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:a+=e;for(var n=0;n<a.length+64;n++)t.x^=0|a.charCodeAt(n),n==a.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function o(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function l(e,t){var a=new s(e),n=t&&t.state,i=function(){return(a.next()>>>0)/4294967296};return i.double=function(){do{var e=((a.next()>>>11)+(a.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=a.next,i.quick=i,n&&("object"==typeof n&&o(n,a),i.state=function(){return o(a,{})}),i}i&&i.exports?i.exports=l:a(267)&&a(387)?void 0===(n=function(){return l}.call(t,a,t,i))||(i.exports=n):this.xorwow=l}(0,e,a(267))}).call(this,a(303)(e))},function(e,t,a){(function(e){var n;!function(e,i,r){function s(e){var t=this;t.next=function(){var e,a,n=t.x,i=t.i;return e=n[i],a=(e^=e>>>7)^e<<24,a^=(e=n[i+1&7])^e>>>10,a^=(e=n[i+3&7])^e>>>3,a^=(e=n[i+4&7])^e<<7,e=n[i+7&7],a^=(e^=e<<13)^e<<9,n[i]=a,t.i=i+1&7,a},function(e,t){var a,n=[];if(t===(0|t))n[0]=t;else for(t=""+t,a=0;a<t.length;++a)n[7&a]=n[7&a]<<15^t.charCodeAt(a)+n[a+1&7]<<13;for(;n.length<8;)n.push(0);for(a=0;a<8&&0===n[a];++a);for(8==a?n[7]=-1:n[a],e.x=n,e.i=0,a=256;a>0;--a)e.next()}(t,e)}function o(e,t){return t.x=e.x.slice(),t.i=e.i,t}function l(e,t){null==e&&(e=+new Date);var a=new s(e),n=t&&t.state,i=function(){return(a.next()>>>0)/4294967296};return i.double=function(){do{var e=((a.next()>>>11)+(a.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=a.next,i.quick=i,n&&(n.x&&o(n,a),i.state=function(){return o(a,{})}),i}i&&i.exports?i.exports=l:a(267)&&a(387)?void 0===(n=function(){return l}.call(t,a,t,i))||(i.exports=n):this.xorshift7=l}(0,e,a(267))}).call(this,a(303)(e))},function(e,t,a){(function(e){var n;!function(e,i,r){function s(e){var t=this;t.next=function(){var e,a,n=t.w,i=t.X,r=t.i;return t.w=n=n+1640531527|0,a=i[r+34&127],e=i[r=r+1&127],a^=a<<13,e^=e<<17,a^=a>>>15,e^=e>>>12,a=i[r]=a^e,t.i=r,a+(n^n>>>16)|0},function(e,t){var a,n,i,r,s,o=[],l=128;for(t===(0|t)?(n=t,t=null):(t+="\0",n=0,l=Math.max(l,t.length)),i=0,r=-32;r<l;++r)t&&(n^=t.charCodeAt((r+32)%t.length)),0===r&&(s=n),n^=n<<10,n^=n>>>15,n^=n<<4,n^=n>>>13,r>=0&&(s=s+1640531527|0,i=0==(a=o[127&r]^=n+s)?i+1:0);for(i>=128&&(o[127&(t&&t.length||0)]=-1),i=127,r=512;r>0;--r)n=o[i+34&127],a=o[i=i+1&127],n^=n<<13,a^=a<<17,n^=n>>>15,a^=a>>>12,o[i]=n^a;e.w=s,e.X=o,e.i=i}(t,e)}function o(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function l(e,t){null==e&&(e=+new Date);var a=new s(e),n=t&&t.state,i=function(){return(a.next()>>>0)/4294967296};return i.double=function(){do{var e=((a.next()>>>11)+(a.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=a.next,i.quick=i,n&&(n.X&&o(n,a),i.state=function(){return o(a,{})}),i}i&&i.exports?i.exports=l:a(267)&&a(387)?void 0===(n=function(){return l}.call(t,a,t,i))||(i.exports=n):this.xor4096=l}(0,e,a(267))}).call(this,a(303)(e))},function(e,t,a){(function(e){var n;!function(e,i,r){function s(e){var t=this,a="";t.next=function(){var e=t.b,a=t.c,n=t.d,i=t.a;return e=e<<25^e>>>7^a,a=a-n|0,n=n<<24^n>>>8^i,i=i-e|0,t.b=e=e<<20^e>>>12^a,t.c=a=a-n|0,t.d=n<<16^a>>>16^i,t.a=i-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):a+=e;for(var n=0;n<a.length+20;n++)t.b^=0|a.charCodeAt(n),t.next()}function o(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function l(e,t){var a=new s(e),n=t&&t.state,i=function(){return(a.next()>>>0)/4294967296};return i.double=function(){do{var e=((a.next()>>>11)+(a.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=a.next,i.quick=i,n&&("object"==typeof n&&o(n,a),i.state=function(){return o(a,{})}),i}i&&i.exports?i.exports=l:a(267)&&a(387)?void 0===(n=function(){return l}.call(t,a,t,i))||(i.exports=n):this.tychei=l}(0,e,a(267))}).call(this,a(303)(e))},function(e,t,a){var n;!function(i,r,s){var o,l=256,c=s.pow(l,6),u=s.pow(2,52),d=2*u,p=255;function m(e,t,a){var n=[],p=h(b((t=1==t?{entropy:!0}:t||{}).entropy?[e,y(r)]:null==e?function(){try{var e;return o&&(e=o.randomBytes)?e=e(l):(e=new Uint8Array(l),(i.crypto||i.msCrypto).getRandomValues(e)),y(e)}catch(e){var t=i.navigator,a=t&&t.plugins;return[+new Date,i,a,i.screen,y(r)]}}():e,3),n),m=new g(n),E=function(){for(var e=m.g(6),t=c,a=0;e<u;)e=(e+a)*l,t*=l,a=m.g(1);for(;e>=d;)e/=2,t/=2,a>>>=1;return(e+a)/t};return E.int32=function(){return 0|m.g(4)},E.quick=function(){return m.g(4)/4294967296},E.double=E,h(y(m.S),r),(t.pass||a||function(e,t,a,n){return n&&(n.S&&f(n,m),e.state=function(){return f(m,{})}),a?(s.random=e,t):e})(E,p,"global"in t?t.global:this==s,t.state)}function g(e){var t,a=e.length,n=this,i=0,r=n.i=n.j=0,s=n.S=[];for(a||(e=[a++]);i<l;)s[i]=i++;for(i=0;i<l;i++)s[i]=s[r=p&r+e[i%a]+(t=s[i])],s[r]=t;(n.g=function(e){for(var t,a=0,i=n.i,r=n.j,s=n.S;e--;)t=s[i=p&i+1],a=a*l+s[p&(s[i]=s[r=p&r+t])+(s[r]=t)];return n.i=i,n.j=r,a})(l)}function f(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function b(e,t){var a,n=[],i=typeof e;if(t&&"object"==i)for(a in e)try{n.push(b(e[a],t-1))}catch(e){}return n.length?n:"string"==i?e:e+"\0"}function h(e,t){for(var a,n=e+"",i=0;i<n.length;)t[p&i]=p&(a^=19*t[p&i])+n.charCodeAt(i++);return y(t)}function y(e){return String.fromCharCode.apply(0,e)}if(h(s.random(),r),e.exports){e.exports=m;try{o=a(1331)}catch(e){}}else void 0===(n=function(){return m}.call(t,a,t,e))||(e.exports=n)}("undefined"!=typeof self?self:this,[],Math)},function(e,t){},function(e,t,a){!function(t){"use strict";const a="(0?\\d+|0x[a-f0-9]+)",n={fourOctet:new RegExp(`^${a}\\.${a}\\.${a}\\.${a}$`,"i"),threeOctet:new RegExp(`^${a}\\.${a}\\.${a}$`,"i"),twoOctet:new RegExp(`^${a}\\.${a}$`,"i"),longValue:new RegExp(`^${a}$`,"i")},i=new RegExp("^0[0-7]+$","i"),r=new RegExp("^0x[a-f0-9]+$","i"),s="%[0-9a-z]{1,}",o="(?:[0-9a-f]+::?)+",l={zoneIndex:new RegExp(s,"i"),native:new RegExp(`^(::)?(${o})?([0-9a-f]+)?(::)?(${s})?$`,"i"),deprecatedTransitional:new RegExp(`^(?:::)(${a}\\.${a}\\.${a}\\.${a}(${s})?)$`,"i"),transitional:new RegExp(`^((?:${o})|(?:::)(?:${o})?)${a}\\.${a}\\.${a}\\.${a}(${s})?$`,"i")};function c(e,t){if(e.indexOf("::")!==e.lastIndexOf("::"))return null;let a,n,i=0,r=-1,s=(e.match(l.zoneIndex)||[])[0];for(s&&(s=s.substring(1),e=e.replace(/%.+$/,""));(r=e.indexOf(":",r+1))>=0;)i++;if("::"===e.substr(0,2)&&i--,"::"===e.substr(-2,2)&&i--,i>t)return null;for(n=t-i,a=":";n--;)a+="0:";return":"===(e=e.replace("::",a))[0]&&(e=e.slice(1)),":"===e[e.length-1]&&(e=e.slice(0,-1)),{parts:t=function(){const t=e.split(":"),a=[];for(let e=0;e<t.length;e++)a.push(parseInt(t[e],16));return a}(),zoneId:s}}function u(e,t,a,n){if(e.length!==t.length)throw new Error("ipaddr: cannot match CIDR for objects with different lengths");let i,r=0;for(;n>0;){if(i=a-n,i<0&&(i=0),e[r]>>i!=t[r]>>i)return!1;n-=a,r+=1}return!0}function d(e){if(r.test(e))return parseInt(e,16);if("0"===e[0]&&!isNaN(parseInt(e[1],10))){if(i.test(e))return parseInt(e,8);throw new Error(`ipaddr: cannot parse ${e} as octal`)}return parseInt(e,10)}function p(e,t){for(;e.length<t;)e=`0${e}`;return e}const m={};m.IPv4=function(){function e(e){if(4!==e.length)throw new Error("ipaddr: ipv4 octet count should be 4");let t,a;for(t=0;t<e.length;t++)if(a=e[t],!(0<=a&&a<=255))throw new Error("ipaddr: ipv4 octet should fit in 8 bits");this.octets=e}return e.prototype.SpecialRanges={unspecified:[[new e([0,0,0,0]),8]],broadcast:[[new e([255,255,255,255]),32]],multicast:[[new e([224,0,0,0]),4]],linkLocal:[[new e([169,254,0,0]),16]],loopback:[[new e([127,0,0,0]),8]],carrierGradeNat:[[new e([100,64,0,0]),10]],private:[[new e([10,0,0,0]),8],[new e([172,16,0,0]),12],[new e([192,168,0,0]),16]],reserved:[[new e([192,0,0,0]),24],[new e([192,0,2,0]),24],[new e([192,88,99,0]),24],[new e([198,51,100,0]),24],[new e([203,0,113,0]),24],[new e([240,0,0,0]),4]]},e.prototype.kind=function(){return"ipv4"},e.prototype.match=function(e,t){let a;if(void 0===t&&(a=e,e=a[0],t=a[1]),"ipv4"!==e.kind())throw new Error("ipaddr: cannot match ipv4 address with non-ipv4 one");return u(this.octets,e.octets,8,t)},e.prototype.prefixLengthFromSubnetMask=function(){let e=0,t=!1;const a={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0};let n,i,r;for(n=3;n>=0;n-=1){if(i=this.octets[n],!(i in a))return null;if(r=a[i],t&&0!==r)return null;8!==r&&(t=!0),e+=r}return 32-e},e.prototype.range=function(){return m.subnetMatch(this,this.SpecialRanges)},e.prototype.toByteArray=function(){return this.octets.slice(0)},e.prototype.toIPv4MappedAddress=function(){return m.IPv6.parse(`::ffff:${this.toString()}`)},e.prototype.toNormalizedString=function(){return this.toString()},e.prototype.toString=function(){return this.octets.join(".")},e}(),m.IPv4.broadcastAddressFromCIDR=function(e){try{const t=this.parseCIDR(e),a=t[0].toByteArray(),n=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),i=[];let r=0;for(;r<4;)i.push(parseInt(a[r],10)|255^parseInt(n[r],10)),r++;return new this(i)}catch(e){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},m.IPv4.isIPv4=function(e){return null!==this.parser(e)},m.IPv4.isValid=function(e){try{return new this(this.parser(e)),!0}catch(e){return!1}},m.IPv4.isValidFourPartDecimal=function(e){return!(!m.IPv4.isValid(e)||!e.match(/^(0|[1-9]\d*)(\.(0|[1-9]\d*)){3}$/))},m.IPv4.networkAddressFromCIDR=function(e){let t,a,n,i,r;try{for(t=this.parseCIDR(e),n=t[0].toByteArray(),r=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),i=[],a=0;a<4;)i.push(parseInt(n[a],10)&parseInt(r[a],10)),a++;return new this(i)}catch(e){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},m.IPv4.parse=function(e){const t=this.parser(e);if(null===t)throw new Error("ipaddr: string is not formatted like an IPv4 Address");return new this(t)},m.IPv4.parseCIDR=function(e){let t;if(t=e.match(/^(.+)\/(\d+)$/)){const e=parseInt(t[2]);if(e>=0&&e<=32){const a=[this.parse(t[1]),e];return Object.defineProperty(a,"toString",{value:function(){return this.join("/")}}),a}}throw new Error("ipaddr: string is not formatted like an IPv4 CIDR range")},m.IPv4.parser=function(e){let t,a,i;if(t=e.match(n.fourOctet))return function(){const e=t.slice(1,6),n=[];for(let t=0;t<e.length;t++)a=e[t],n.push(d(a));return n}();if(t=e.match(n.longValue)){if(i=d(t[1]),i>4294967295||i<0)throw new Error("ipaddr: address outside defined range");return function(){const e=[];let t;for(t=0;t<=24;t+=8)e.push(i>>t&255);return e}().reverse()}return(t=e.match(n.twoOctet))?function(){const e=t.slice(1,4),a=[];if(i=d(e[1]),i>16777215||i<0)throw new Error("ipaddr: address outside defined range");return a.push(d(e[0])),a.push(i>>16&255),a.push(i>>8&255),a.push(255&i),a}():(t=e.match(n.threeOctet))?function(){const e=t.slice(1,5),a=[];if(i=d(e[2]),i>65535||i<0)throw new Error("ipaddr: address outside defined range");return a.push(d(e[0])),a.push(d(e[1])),a.push(i>>8&255),a.push(255&i),a}():null},m.IPv4.subnetMaskFromPrefixLength=function(e){if((e=parseInt(e))<0||e>32)throw new Error("ipaddr: invalid IPv4 prefix length");const t=[0,0,0,0];let a=0;const n=Math.floor(e/8);for(;a<n;)t[a]=255,a++;return n<4&&(t[n]=Math.pow(2,e%8)-1<<8-e%8),new this(t)},m.IPv6=function(){function e(e,t){let a,n;if(16===e.length)for(this.parts=[],a=0;a<=14;a+=2)this.parts.push(e[a]<<8|e[a+1]);else{if(8!==e.length)throw new Error("ipaddr: ipv6 part count should be 8 or 16");this.parts=e}for(a=0;a<this.parts.length;a++)if(n=this.parts[a],!(0<=n&&n<=65535))throw new Error("ipaddr: ipv6 part should fit in 16 bits");t&&(this.zoneId=t)}return e.prototype.SpecialRanges={unspecified:[new e([0,0,0,0,0,0,0,0]),128],linkLocal:[new e([65152,0,0,0,0,0,0,0]),10],multicast:[new e([65280,0,0,0,0,0,0,0]),8],loopback:[new e([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new e([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new e([0,0,0,0,0,65535,0,0]),96],rfc6145:[new e([0,0,0,0,65535,0,0,0]),96],rfc6052:[new e([100,65435,0,0,0,0,0,0]),96],"6to4":[new e([8194,0,0,0,0,0,0,0]),16],teredo:[new e([8193,0,0,0,0,0,0,0]),32],reserved:[[new e([8193,3512,0,0,0,0,0,0]),32]]},e.prototype.isIPv4MappedAddress=function(){return"ipv4Mapped"===this.range()},e.prototype.kind=function(){return"ipv6"},e.prototype.match=function(e,t){let a;if(void 0===t&&(a=e,e=a[0],t=a[1]),"ipv6"!==e.kind())throw new Error("ipaddr: cannot match ipv6 address with non-ipv6 one");return u(this.parts,e.parts,16,t)},e.prototype.prefixLengthFromSubnetMask=function(){let e=0,t=!1;const a={0:16,32768:15,49152:14,57344:13,61440:12,63488:11,64512:10,65024:9,65280:8,65408:7,65472:6,65504:5,65520:4,65528:3,65532:2,65534:1,65535:0};let n,i;for(let r=7;r>=0;r-=1){if(n=this.parts[r],!(n in a))return null;if(i=a[n],t&&0!==i)return null;16!==i&&(t=!0),e+=i}return 128-e},e.prototype.range=function(){return m.subnetMatch(this,this.SpecialRanges)},e.prototype.toByteArray=function(){let e;const t=[],a=this.parts;for(let n=0;n<a.length;n++)e=a[n],t.push(e>>8),t.push(255&e);return t},e.prototype.toFixedLengthString=function(){const e=function(){const e=[];for(let t=0;t<this.parts.length;t++)e.push(p(this.parts[t].toString(16),4));return e}.call(this).join(":");let t="";return this.zoneId&&(t=`%${this.zoneId}`),e+t},e.prototype.toIPv4Address=function(){if(!this.isIPv4MappedAddress())throw new Error("ipaddr: trying to convert a generic ipv6 address to ipv4");const e=this.parts.slice(-2),t=e[0],a=e[1];return new m.IPv4([t>>8,255&t,a>>8,255&a])},e.prototype.toNormalizedString=function(){const e=function(){const e=[];for(let t=0;t<this.parts.length;t++)e.push(this.parts[t].toString(16));return e}.call(this).join(":");let t="";return this.zoneId&&(t=`%${this.zoneId}`),e+t},e.prototype.toRFC5952String=function(){const e=/((^|:)(0(:|$)){2,})/g,t=this.toNormalizedString();let a,n=0,i=-1;for(;a=e.exec(t);)a[0].length>i&&(n=a.index,i=a[0].length);return i<0?t:`${t.substring(0,n)}::${t.substring(n+i)}`},e.prototype.toString=function(){return this.toNormalizedString().replace(/((^|:)(0(:|$))+)/,"::")},e}(),m.IPv6.isIPv6=function(e){return null!==this.parser(e)},m.IPv6.isValid=function(e){if("string"==typeof e&&-1===e.indexOf(":"))return!1;try{const t=this.parser(e);return new this(t.parts,t.zoneId),!0}catch(e){return!1}},m.IPv6.parse=function(e){const t=this.parser(e);if(null===t.parts)throw new Error("ipaddr: string is not formatted like an IPv6 Address");return new this(t.parts,t.zoneId)},m.IPv6.parseCIDR=function(e){let t,a,n;if((a=e.match(/^(.+)\/(\d+)$/))&&(t=parseInt(a[2]),t>=0&&t<=128))return n=[this.parse(a[1]),t],Object.defineProperty(n,"toString",{value:function(){return this.join("/")}}),n;throw new Error("ipaddr: string is not formatted like an IPv6 CIDR range")},m.IPv6.parser=function(e){let t,a,n,i,r,s;if(n=e.match(l.deprecatedTransitional))return this.parser(`::ffff:${n[1]}`);if(l.native.test(e))return c(e,8);if((n=e.match(l.transitional))&&(s=n[6]||"",t=c(n[1].slice(0,-1)+s,6),t.parts)){for(r=[parseInt(n[2]),parseInt(n[3]),parseInt(n[4]),parseInt(n[5])],a=0;a<r.length;a++)if(i=r[a],!(0<=i&&i<=255))return null;return t.parts.push(r[0]<<8|r[1]),t.parts.push(r[2]<<8|r[3]),{parts:t.parts,zoneId:t.zoneId}}return null},m.fromByteArray=function(e){const t=e.length;if(4===t)return new m.IPv4(e);if(16===t)return new m.IPv6(e);throw new Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")},m.isValid=function(e){return m.IPv6.isValid(e)||m.IPv4.isValid(e)},m.parse=function(e){if(m.IPv6.isValid(e))return m.IPv6.parse(e);if(m.IPv4.isValid(e))return m.IPv4.parse(e);throw new Error("ipaddr: the address has neither IPv6 nor IPv4 format")},m.parseCIDR=function(e){try{return m.IPv6.parseCIDR(e)}catch(t){try{return m.IPv4.parseCIDR(e)}catch(e){throw new Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}},m.process=function(e){const t=this.parse(e);return"ipv6"===t.kind()&&t.isIPv4MappedAddress()?t.toIPv4Address():t},m.subnetMatch=function(e,t,a){let n,i,r,s;for(i in null==a&&(a="unicast"),t)if(Object.prototype.hasOwnProperty.call(t,i))for(r=t[i],!r[0]||r[0]instanceof Array||(r=[r]),n=0;n<r.length;n++)if(s=r[n],e.kind()===s[0].kind()&&e.match.apply(e,s))return i;return a},e.exports?e.exports=m:t.ipaddr=m}(this)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){"use strict";a.r(t),a.d(t,"subPluginClasses",(function(){return XB}));var n={};a.r(n),a.d(n,"STATUS",(function(){return Tp})),a.d(n,"STATUS_AT",(function(){return kp})),a.d(n,"STATUS_DATE",(function(){return xp})),a.d(n,"REFRESH",(function(){return Sp})),a.d(n,"ERROR_CALLOUT_TITLE",(function(){return Op})),a.d(n,"PARTIAL_FAILURE_CALLOUT_TITLE",(function(){return wp}));var i=a(5),r=a.n(i),s=a(174),o=a(1),l=a(42),c=a(14),u=a(221),d=a(18),p=a(84),m=a(194),g=a(13),f=a(729),b=a(88),h=a(206),y=a(218),E=a(3),v=a(71),T=a(8),k=a(7);const x=(e,t)=>{const a=Object(l.useDispatch)(),{formatUrl:n}=Object(u.k)(T.a.timelines),r=Object(v.b)(p.b.selectInsertTimeline),s=Object(i.useCallback)(((a,i,r)=>{let s=`[${a}](${n(Object(u.j)(null!=i?i:"",r),{absolute:!0,skipSearch:!0})})`;Object(E.isEmpty)(e)||(s=`${e} ${s}`),t(s)}),[e,t,n]);return Object(i.useEffect)((()=>{null!=r&&null!=e&&(a(p.a.showTimeline({id:r.timelineId,show:!1})),s(r.timelineTitle,r.timelineSavedObjectId,r.graphEventId),a(Object(k.setInsertTimeline)(null)))}),[r,a,s,e]),{handleOnTimelineChange:s}};var S=a(803),O=a(355),w=a(291),j=a(734);const C=e=>{const{selectedPatterns:t}=Object(m.d)(g.SourcererScopeName.detections),a=Object(i.useMemo)((()=>Object(j.a)(e)),[e]),{loading:n,data:r}=Object(w.a)({query:a,indexName:t[0]});return[n,Object(i.useMemo)((()=>{var e;return null!==(e=null==r?void 0:r.hits.hits.reduce(((e,{_id:t,_index:a,_source:n})=>({...e,[t]:{...Object(j.b)(n),_id:t,_index:a,timestamp:n["@timestamp"]}})),{}))&&void 0!==e?e:{}}),[null==r?void 0:r.hits.hits])]},I=()=>{const{browserFields:e,docValueFields:t,runtimeMappings:a}=Object(m.d)(g.SourcererScopeName.detections);return r.a.createElement(O.a,{browserFields:e,docValueFields:t,entityType:"events",isFlyoutView:!0,runtimeMappings:a,timelineId:c.i.casePage})},M=()=>{var e;const{cases:t}=Object(d.j)().services,{getAppUrl:a,navigateTo:n}=Object(d.l)(),s=Object(d.h)(),m=Object(l.useDispatch)(),{formatUrl:g,search:E}=Object(u.k)(o.cc.rules),v=Object(i.useCallback)((e=>g(Object(u.g)(null!=e?e:"",E))),[g,E]),T=Object(i.useCallback)(((e,t)=>{m(p.a.toggleDetailPanel({panelView:"eventDetail",timelineId:c.i.casePage,params:{eventId:e,indexName:t}}))}),[m]),k=Object(i.useCallback)((()=>{m(p.a.createTimeline({id:c.i.casePage,columns:[],dataViewId:null,indexNames:[],expandedDetail:{},show:!1}))}),[m]),O=Object(i.useRef)(null);return r.a.createElement(b.a,{noPadding:!0},r.a.createElement(f.a.Provider,{value:O},t.ui.getCases({basePath:o.C,owner:[o.n],features:{metrics:["alerts.count","alerts.users","alerts.hosts","connectors","lifespan"]},refreshRef:O,onComponentInitialized:k,actionsNavigation:{href:e=>a({path:Object(h.d)({name:"endpointActivityLog",selected_endpoint:e})}),onClick:(e,t)=>(t&&t.preventDefault(),n({path:Object(h.d)({name:"endpointActivityLog",selected_endpoint:e})}))},ruleDetailsNavigation:{href:v,onClick:async(e,t)=>(t&&t.preventDefault(),n({deepLinkId:o.cc.rules,path:Object(u.g)(null!=e?e:"")}))},showAlertDetails:T,timelineIntegration:{editor_plugins:{parsingPlugin:S.a,processingPluginRenderer:S.c,uiPlugin:S.b},hooks:{useInsertTimeline:x},ui:{renderTimelineDetailsPanel:I}},useFetchAlertData:C,userCanCrud:null!==(e=null==s?void 0:s.crud)&&void 0!==e&&e})),r.a.createElement(y.a,{pageName:o.cc.case}))},A=r.a.memo(M),D=[{path:o.C,render:()=>r.a.createElement(s.TrackApplicationView,{viewId:"case"},r.a.createElement(A,null))}];var q=a(100),P=a(58),R=a(55),_=a(263),F=a(4);const L=F.i18n.translate("xpack.securitySolution.alerts.badge.readOnly.tooltip",{defaultMessage:"Unable to update alerts"});var N=a(16),B=a(23),z=a.n(B),U=a(21),H=a(213),$=a(308),V=a(246),Q=a(295),W=a(28),G=a(22),K=a(166),Y=a(496),J=a(46),X=a(192),Z=a(200),ee=a(265),te=a(621),ae=a(73),ne=a(79),ie=a(31),re=a(356),se=a(323),oe=a(207),le=a(87),ce=a(564),ue=a(543),de=a(168),pe=a.n(de),me=a(527),ge=a(424),fe=a(730),be=a(248);const he="open",ye=({status:e="open",onFilterGroupChanged:t})=>{const a=[{id:"open",label:be.E,"data-test-subj":"openAlerts"},{id:"acknowledged",label:be.a,"data-test-subj":"acknowledgedAlerts"},{id:"closed",label:be.x,"data-test-subj":"closedAlerts"}],n=Object(i.useCallback)((e=>{t(e)}),[t]);return r.a.createElement(N.EuiButtonGroup,{legend:"filter status",color:"primary",options:a,idSelected:e,"data-test-subj":"alerts-table-filter-group",onChange:n})},Ee=r.a.memo(ye),ve=z()(N.EuiFlexGroup).withConfig({displayName:"UtilityBarFlexGroup",componentId:"sc-jqzk8o-0"})(["min-width:175px;"]),Te=z()(N.EuiFlexItem).withConfig({displayName:"AdditionalFiltersItem",componentId:"sc-jqzk8o-1"})(["padding:",";"],(({theme:e})=>e.eui.paddingSizes.s)),ke=z()(Te).withConfig({displayName:"BuildingBlockContainer",componentId:"sc-jqzk8o-2"})(["background:",";"],(({theme:e})=>e.eui.euiColorHighlight)),xe=({areEventsLoading:e,clearSelection:t,currentFilter:a,hasIndexMaintenance:n,hasIndexWrite:s,onShowBuildingBlockAlertsChanged:l,onShowOnlyThreatIndicatorAlertsChanged:c,selectAll:u,selectedEventIds:p,showBuildingBlockAlerts:m,showClearSelection:g,showOnlyThreatIndicatorAlerts:f,totalCount:b,updateAlertsStatus:h})=>{const[y]=Object(d.p)(o.V),v=Object(i.useCallback)((async e=>{await h({alertIds:Object.keys(p),status:a,selectedStatus:e})}),[a,p,h]),T=pe()(b).format(y),k=pe()(Object.keys(p).length).format(y),x=Object(i.useCallback)((()=>{g?t():u()}),[t,u,g]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(ge.a,null,r.a.createElement(ge.d,{grow:!0},r.a.createElement(ge.c,null,r.a.createElement(ge.f,{dataTestSubj:"showingAlerts"},fe.j(T,b))),r.a.createElement(ge.c,{grow:!0},s&&n&&r.a.createElement(r.a.Fragment,null,r.a.createElement(ge.f,{dataTestSubj:"selectedAlerts"},fe.h(g?T:k,g?b:Object.keys(p).length)),r.a.createElement(ge.b,{dataTestSubj:"alertActionPopover",disabled:e||Object(E.isEmpty)(p)&&!1===g,iconType:"arrowDown",iconSide:"right",ownFocus:!1,popoverContent:e=>r.a.createElement(ve,{direction:"column"},a!==he&&r.a.createElement(N.EuiFlexItem,null,r.a.createElement(me.a,{"aria-label":"openSelectedAlerts",onClick:()=>{e(),v("open")},color:"text","data-test-subj":"openSelectedAlertsButton"},fe.f)),"closed"!==a&&r.a.createElement(N.EuiFlexItem,null,r.a.createElement(me.a,{"aria-label":"closeSelectedAlerts",onClick:()=>{e(),v("closed")},color:"text","data-test-subj":"closeSelectedAlertsButton"},fe.e)),"acknowledged"!==a&&r.a.createElement(N.EuiFlexItem,null,r.a.createElement(me.a,{"aria-label":"markSelectedAlertsAcknowledged",onClick:()=>{e(),v("acknowledged")},color:"text","data-test-subj":"markSelectedAlertsAcknowledgedButton"},fe.d)))},fe.k),r.a.createElement(ge.b,{"aria-label":"selectAllAlerts",dataTestSubj:"selectAllAlertsButton",iconType:g?"cross":"pagesSelect",onClick:x},g?fe.g:fe.i(T,b))),r.a.createElement(ge.e,null),r.a.createElement(Oe,{areEventsLoading:e,onShowBuildingBlockAlertsChanged:l,showBuildingBlockAlerts:m,onShowOnlyThreatIndicatorAlertsChanged:c,showOnlyThreatIndicatorAlerts:f})))))},Se=r.a.memo(xe,((e,t)=>e.areEventsLoading===t.areEventsLoading&&e.selectedEventIds===t.selectedEventIds&&e.totalCount===t.totalCount&&e.showClearSelection===t.showClearSelection&&e.showBuildingBlockAlerts===t.showBuildingBlockAlerts&&e.showOnlyThreatIndicatorAlerts===t.showOnlyThreatIndicatorAlerts)),Oe=({areEventsLoading:e,onShowBuildingBlockAlertsChanged:t,showBuildingBlockAlerts:a,onShowOnlyThreatIndicatorAlertsChanged:n,showOnlyThreatIndicatorAlerts:i})=>r.a.createElement(ge.b,{dataTestSubj:"additionalFilters",disabled:e,iconType:"arrowDown",iconSide:"right",ownFocus:!0,popoverContent:e=>r.a.createElement(ve,{direction:"column",gutterSize:"none"},r.a.createElement(ke,null,r.a.createElement(N.EuiCheckbox,{id:"showBuildingBlockAlertsCheckbox","aria-label":"showBuildingBlockAlerts",onChange:a=>{e(),t(a.target.checked)},checked:a,color:"text","data-test-subj":"showBuildingBlockAlertsCheckbox",label:fe.b})),r.a.createElement(Te,null,r.a.createElement(N.EuiCheckbox,{id:"showOnlyThreatIndicatorAlertsCheckbox","aria-label":"showOnlyThreatIndicatorAlerts",onChange:t=>{e(),n(t.target.checked)},checked:i,color:"text","data-test-subj":"showOnlyThreatIndicatorAlertsCheckbox",label:fe.c})))},fe.a);var we=a(300),je=a(733);const Ce=({clearSelected:e,defaultFilters:t,from:a,globalFilters:n,globalQuery:s,hasIndexMaintenance:o,hasIndexWrite:c,isSelectAllChecked:u,loading:f,loadingEventIds:b,onRuleChange:h,onShowBuildingBlockAlertsChanged:y,onShowOnlyThreatIndicatorAlertsChanged:v,selectedEventIds:T,setEventsDeleted:k,setEventsLoading:x,showBuildingBlockAlerts:S,showOnlyThreatIndicatorAlerts:O,timelineId:w,to:j,filterGroup:C="open"})=>{var I,M;const A=Object(l.useDispatch)(),[D,q]=Object(i.useState)(!1),{browserFields:P,indexPattern:R,selectedPatterns:_}=Object(m.d)(g.SourcererScopeName.detections),F=Object(d.j)(),[,L]=Object(J.g)(),{addWarning:N}=Object(X.a)(),B=Object(i.useCallback)((e=>null!=P&&null!=R?Object(oe.i)({config:Object(K.getEsQueryConfig)(F.services.uiSettings),dataProviders:[],indexPattern:R,browserFields:P,filters:[...null!=t?t:[],...n,...e,...Object(je.a)(a,j)],kqlQuery:s,kqlMode:s.language,isEventViewer:!0}):null),[P,t,n,s,R,F,j,a]);Object(ee.a)({id:w,filterQuery:null===(I=B([]))||void 0===I?void 0:I.filterQuery,kqlError:null===(M=B([]))||void 0===M?void 0:M.kqlError,query:s,startDate:a,endDate:j});const z=Object(i.useCallback)((({eventIds:e,isLoading:t})=>{x({id:w,eventIds:e,isLoading:t})}),[x,w]),U=Object(i.useCallback)((({eventIds:e,isDeleted:t})=>{k({id:w,eventIds:e,isDeleted:t})}),[k,w]),H=Object(i.useCallback)(((e,t,a)=>{if(t>0)N({title:ne.c(t),text:ne.d(e,t)});else{let t="";switch(a){case"closed":t=be.z(e);break;case"open":t=be.D(e);break;case"acknowledged":case"in-progress":t=be.c(e)}Object(J.e)(t,L)}}),[N,L]),$=Object(i.useCallback)(((e,t)=>{let a="";switch(e){case"closed":a=be.y;break;case"open":a=be.C;break;case"acknowledged":case"in-progress":a=be.b}Object(J.d)(a,[t.message],L)}),[L]);Object(i.useEffect)((()=>{u?A(p.a.setTGridSelectAll({id:w,selectAll:!1})):q(!1)}),[A,u,w]);const V=Object(i.useCallback)((()=>{e({id:w}),A(p.a.setTGridSelectAll({id:w,selectAll:!1})),q(!1)}),[e,A,w]),Q=Object(i.useCallback)((()=>{A(p.a.setTGridSelectAll({id:w,selectAll:!0})),q(!0)}),[A,w]),W=Object(i.useCallback)((async(e,{status:t,selectedStatus:a})=>{var n;await Object(ue.c)({query:D?null===(n=B(Object(we.c)(t)))||void 0===n?void 0:n.filterQuery:void 0,alertIds:Object.keys(T),selectedStatus:a,setEventsDeleted:U,setEventsLoading:z,onAlertStatusUpdateSuccess:H,onAlertStatusUpdateFailure:$}),e()}),[B,T,U,z,D,H,$]),G=Object(i.useCallback)(((e,t)=>r.a.createElement(Se,{areEventsLoading:b.length>0,clearSelection:V,currentFilter:C,hasIndexMaintenance:o,hasIndexWrite:c,onShowBuildingBlockAlertsChanged:y,onShowOnlyThreatIndicatorAlertsChanged:v,selectAll:Q,selectedEventIds:T,showBuildingBlockAlerts:S,showClearSelection:D,showOnlyThreatIndicatorAlerts:O,totalCount:t,updateAlertsStatus:W.bind(null,e)})),[V,C,o,c,b.length,y,v,Q,T,S,D,O,W]),ae=Object(i.useMemo)((()=>r.a.createElement(Oe,{areEventsLoading:b.length>0,onShowBuildingBlockAlertsChanged:y,showBuildingBlockAlerts:S,onShowOnlyThreatIndicatorAlertsChanged:v,showOnlyThreatIndicatorAlerts:O})),[b.length,y,v,S,O]),le=Object(i.useMemo)((()=>{const e=Object(we.c)(C);return Object(E.isEmpty)(t)?e:null==t||Object(E.isEmpty)(t)?void 0:[...t,...e]}),[t,C]),{filterManager:de}=Object(d.j)().services.data.query,pe=Object(Z.a)("tGridEnabled");Object(i.useEffect)((()=>{A(p.a.initializeTGridSettings({defaultColumns:ce.b.map((e=>pe||null!=e.initialWidth?e:{...e,initialWidth:ie.a})),documentType:be.m,excludedRowRendererIds:we.a.excludedRowRendererIds,filterManager:de,footerText:be.G,id:w,loadingText:be.A,selectAll:!1,queryFields:we.h,title:"",showCheckboxes:!0}))}),[A,de,pe,w]);const me=Object(i.useMemo)((()=>Object(re.a)(5)),[]);return f||Object(E.isEmpty)(_)?null:r.a.createElement(Y.a,{additionalFilters:ae,currentFilter:C,defaultCellActions:te.a,defaultModel:we.a,end:j,entityType:"events",hasAlertsCrud:c&&o,id:w,leadingControlColumns:me,onRuleChange:h,pageFilters:le,renderCellValue:ce.a,rowRenderers:se.b,scopeId:g.SourcererScopeName.detections,start:a,utilityBar:G})},Ie=Object(l.connect)((()=>{const e=p.b.getTimelineByIdSelector(),t=ae.e.globalSelector();return(a,n)=>{var i;const{timelineId:r}=n,s=null!==(i=e(a,r))&&void 0!==i?i:le.a,{deletedEventIds:o,isSelectAllChecked:l,loadingEventIds:c,selectedEventIds:u}=s,d=t(a),{query:p,filters:m}=d;return{globalQuery:p,globalFilters:m,deletedEventIds:o,isSelectAllChecked:l,loadingEventIds:c,selectedEventIds:u}}}),(e=>({clearSelected:({id:t})=>e(p.a.clearSelected({id:t})),setEventsLoading:({id:t,eventIds:a,isLoading:n})=>e(p.a.setEventsLoading({id:t,eventIds:a,isLoading:n})),setEventsDeleted:({id:t,eventIds:a,isDeleted:n})=>e(p.a.setEventsDeleted({id:t,eventIds:a,isDeleted:n}))})))(r.a.memo(Ce)),Me=F.i18n.translate("xpack.securitySolution.detectionEngine.noApiIntegrationKeyCallOutTitle",{defaultMessage:"API integration key required"}),Ae=F.i18n.translate("xpack.securitySolution.detectionEngine.noApiIntegrationKeyCallOutMsg",{defaultMessage:"A new encryption key is generated for saved objects each time you start Kibana. Without a persistent key, you cannot delete or modify rules after Kibana restarts. To set a persistent key, add the xpack.encryptedSavedObjects.encryptionKey setting with any text value of 32 or more characters to the kibana.yml file."}),De=F.i18n.translate("xpack.securitySolution.detectionEngine.dismissNoApiIntegrationKeyButton",{defaultMessage:"Dismiss"}),qe=()=>{const[e,t]=Object(i.useState)(!0),a=Object(i.useCallback)((()=>t(!1)),[t]);return e?r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiCallOut,{title:Me,color:"danger",iconType:"alert"},r.a.createElement("p",null,Ae),r.a.createElement(N.EuiButton,{color:"danger",onClick:a},De)),r.a.createElement(N.EuiSpacer,{size:"l"})):null},Pe=Object(i.memo)(qe);var Re=a(610),_e=a(255),Fe=a(102);F.i18n.translate("xpack.securitySolution.detectionEngine.detectionsBreadcrumbTitle",{defaultMessage:"Detections"});const Le=F.i18n.translate("xpack.securitySolution.detectionEngine.detectionsPageTitle",{defaultMessage:"Alerts"}),Ne=(F.i18n.translate("xpack.securitySolution.detectionEngine.lastSignalTitle",{defaultMessage:"Last alert"}),F.i18n.translate("xpack.securitySolution.detectionEngine.totalSignalTitle",{defaultMessage:"Total"}),F.i18n.translate("xpack.securitySolution.detectionEngine.signalTitle",{defaultMessage:"Detected alerts"}),F.i18n.translate("xpack.securitySolution.detectionEngine.alertTitle",{defaultMessage:"Alerts"})),Be=F.i18n.translate("xpack.securitySolution.detectionEngine.buttonManageRules",{defaultMessage:"Manage rules"}),ze=(F.i18n.translate("xpack.securitySolution.detectionEngine.panelSubtitleShowing",{defaultMessage:"Showing"}),F.i18n.translate("xpack.securitySolution.detectionEngine.emptyTitle",{defaultMessage:"It looks like you donât have any indices relevant to the detection engine in the Security application"}),F.i18n.translate("xpack.securitySolution.detectionEngine.emptyActionBeats",{defaultMessage:"View setup instructions"}),F.i18n.translate("xpack.securitySolution.detectionEngine.emptyActionSecondary",{defaultMessage:"Go to documentation"}),F.i18n.translate("xpack.securitySolution.detectionEngine.noIndexTitle",{defaultMessage:"Letâs set up your detection engine"})),Ue=F.i18n.translate("xpack.securitySolution.detectionEngine.needsSignalsAndListsIndexesMessage",{defaultMessage:"You need permissions for the signals and lists indices."}),He=F.i18n.translate("xpack.securitySolution.detectionEngine.needsSignalsIndexMessage",{defaultMessage:"You need permissions for the signals index."}),$e=F.i18n.translate("xpack.securitySolution.detectionEngine.needsListsIndexesMessage",{defaultMessage:"You need permissions for the lists indices."}),Ve=F.i18n.translate("xpack.securitySolution.detectionEngine.goToDocumentationButton",{defaultMessage:"View documentation"}),Qe=F.i18n.translate("xpack.securitySolution.detectionEngine.userUnauthenticatedTitle",{defaultMessage:"Detection engine permissions required"}),We=F.i18n.translate("xpack.securitySolution.detectionEngine.userUnauthenticatedMsgBody",{defaultMessage:"You do not have the required permissions for viewing the detection engine. For more help, contact your administrator."}),Ge=F.i18n.translate("xpack.securitySolution.detectionEngine.mlRulesDisabledMessageTitle",{defaultMessage:"ML rules require Platinum License and ML Admin Permissions"}),Ke=F.i18n.translate("xpack.securitySolution.detectionEngine.noPermissionsTitle",{defaultMessage:"Privileges required"}),Ye=F.i18n.translate("xpack.securitySolution.detectionEngine.noPermissionsMessage",{defaultMessage:"To view alerts, you must update privileges. For more information, contact your Kibana administrator."}),Je=({needsListsIndex:e,needsSignalsIndex:t})=>{const a=Object(d.j)().services.docLinks,n=Object(i.useMemo)((()=>({detections:{icon:"documents",label:Ve,url:`${a.links.siem.detectionsReq}`,target:"_blank"}})),[a]),s=((e,t)=>{return a=t&&e?Ue:t?He:e?$e:"",F.i18n.translate("xpack.securitySolution.detectionEngine.needsIndexPermissionsMessage",{values:{additionalContext:a},defaultMessage:"To use the detection engine, a user with the required cluster and index privileges must first access this page. {additionalContext} For more help, contact your Elastic Stack administrator."});var a})(e,t);return r.a.createElement(Fe.a,{actions:n,"data-test-subj":"no_index",message:s,title:ze})},Xe=r.a.memo(Je);var Ze=a(86),et=a(305);const tt=F.i18n.translate("xpack.securitySolution.containers.detectionEngine.alerts.fetchListsIndex.errorDescription",{defaultMessage:"Failed to retrieve the lists index"}),at=F.i18n.translate("xpack.securitySolution.containers.detectionEngine.alerts.createListsIndex.errorDescription",{defaultMessage:"Failed to create the lists index"});var nt=a(224);const it=e=>{const[t]=Object.keys(e),a=e[t];return null!=a&&a.manage},rt=e=>{const[t]=Object.keys(e),a=e[t];return null!=a&&a.read},st=e=>{const[t]=Object.keys(e),a=e[t];return null!=a&&(a.create||a.create_doc||a.index||a.write)},ot=()=>{const[e,t]=Object(i.useState)({isAuthenticated:null,canManageIndex:null,canReadIndex:null,canWriteIndex:null}),{listPrivileges:a}=Object(nt.a)();return Object(i.useEffect)((()=>{if(null!=a.result){const{is_authenticated:e,lists:{index:n},listItems:{index:i}}=a.result;t({isAuthenticated:e,canReadIndex:rt(n)&&rt(i),canManageIndex:it(n)&&it(i),canWriteIndex:st(n)&&st(i)})}}),[a.result]),Object(i.useEffect)((()=>{null!=a.error&&t({isAuthenticated:!1,canManageIndex:!1,canReadIndex:!1,canWriteIndex:!1})}),[a.error]),{loading:a.loading,...e}},lt=()=>{const{createIndex:e,indexExists:t,loading:a,error:n}=(()=>{const[e,t]=Object(i.useState)(null),[a,n]=Object(i.useState)(null),{lists:r}=Object(d.j)().services,s=Object(d.i)(),{addError:o}=Object(X.a)(),{canReadIndex:l}=ot(),{loading:c,start:u,...p}=Object(et.i)(),{loading:m,start:g,...f}=Object(et.b)(),b=c||m,h=Object(i.useCallback)((()=>{r&&l&&u({http:s})}),[s,r,u,l]),y=Object(i.useCallback)((()=>{r&&g({http:s})}),[g,s,r]);return Object(i.useEffect)((()=>{c||a||null!==e||h()}),[a,e,h,c]),Object(i.useEffect)((()=>{null!=p.result&&t(p.result.list_index&&p.result.list_item_index)}),[p.result]),Object(i.useEffect)((()=>{null!=f.result&&h()}),[f.result,h]),Object(i.useEffect)((()=>{const e=p.error;null!=e&&(Object(Ze.t)(e)&&404===e.body.status_code?t(!1):(n(e),o(e,{title:tt})))}),[o,p.error]),Object(i.useEffect)((()=>{const e=f.error;null!=e&&(n(e),o(e,{title:at}))}),[o,f.error]),{createIndex:y,error:a,indexExists:e,loading:b}})(),{canManageIndex:r,canWriteIndex:s,loading:o}=ot(),{lists:l}=Object(d.j)().services,c=null!=l,u=a||o,p=!1===t,m=!c||p&&(!1===r||!0===r&&null!=n);return Object(i.useEffect)((()=>{p&&r&&e()}),[r,e,p]),{canManageIndex:r,canWriteIndex:s,enabled:c,loading:u,needsConfiguration:m}},ct=r.a.memo((()=>{const e=Object(d.j)().services.docLinks,t=Object(i.useMemo)((()=>({detectionUnauthenticated:{icon:"documents",label:Ve,url:`${e.links.siem.detectionsReq}`,target:"_blank"}})),[e]);return r.a.createElement(Fe.a,{actions:t,message:We,"data-test-subj":"no_index",title:Qe})}));ct.displayName="DetectionEngineUserUnauthenticated";var ut=a(195),dt=a(89);const pt=z.a.div.withConfig({displayName:"Display",componentId:"sc-1njjyjq-0"})(["",";"],(({show:e})=>e?"":"display: none;"));pt.displayName="Display";var mt=a(520),gt=a(2);const ft=F.i18n.translate("xpack.securitySolution.callouts.dismissButton",{defaultMessage:"Dismiss"}),bt=({message:e,text:t,onClick:a=E.noop})=>{const{type:n}=e,s=n,o=null!=t?t:ft,l=Object(i.useCallback)((()=>a(e)),[a,e]);return r.a.createElement(N.EuiButton,{color:s,"data-test-subj":"callout-dismiss-btn",onClick:l},o)},ht=({message:e,iconType:t,dismissButtonText:a,onDismiss:n,showDismissButton:i=!0})=>{const{type:s,id:o,title:l,description:c}=e,u=null!=t?t:yt(s);return r.a.createElement(N.EuiCallOut,{color:s,title:l,iconType:u,"data-test-subj":`callout-${o}`,"data-test-messages":`[${o}]`},c,i&&r.a.createElement(bt,{message:e,text:a,onClick:n}))},yt=e=>{switch(e){case"primary":return"iInCircle";case"success":return"cheer";case"warning":return"help";case"danger":return"alert";default:return Object(gt.a)(e)}},Et=Object(i.memo)(ht);var vt=a(1028),Tt=a.n(vt);const kt=()=>{const{storage:e}=Object(d.j)().services,t=Object(i.useCallback)((t=>{var a;return null!==(a=e.get(`${t}-messages`))&&void 0!==a?a:[]}),[e]),a=Object(i.useCallback)(((t,a)=>{var n;const i=null!==(n=e.get(`${t}-messages`))&&void 0!==n?n:[];e.set(`${t}-messages`,[...i,a])}),[e]),n=Object(i.useCallback)(((t,a)=>{var n;return(null!==(n=e.get(`${t}-messages`))&&void 0!==n?n:[]).filter((e=>e===a)).length>0}),[e]),r=Object(i.useCallback)(((t,a)=>{var n;const i=null!==(n=e.get(`${t}-messages`))&&void 0!==n?n:[];e.set(`${t}-messages`,[...i.filter((e=>e!==a))])}),[e]);return{getMessages:t,addMessage:a,clearAllMessages:Object(i.useCallback)((t=>e.remove(`${t}-messages`)),[e]),removeMessage:r,hasMessage:n}},xt=(e,t)=>St(e,E.identity,(()=>t)),St=(e,t,a)=>{const n=e.map((e=>[t(e),a(e)]));return Object(E.fromPairs)(n)},Ot=({namespace:e,condition:t,message:a})=>{const{isVisible:n,dismiss:s}=((e,t="common")=>{const{getMessages:a,addMessage:n}=kt(),[r,s]=Tt()({}),o=(e=>`kibana.securitySolution.${e}.callouts.dismissed`)(t),l=Object(i.useCallback)((()=>Object.entries(r).filter((([e,t])=>t)).map((([e,t])=>e))),[r]),c=Object(i.useCallback)((e=>{var t;return null!==(t=r[e.id])&&void 0!==t&&t}),[r]),u=Object(i.useCallback)((e=>{const{id:t,type:a}=e;s.set(t,!1),"primary"!==a&&"success"!==a||n(o,t)}),[s,n,o]),d=Object(i.useCallback)((e=>{const t=a(o),n=Object(E.difference)(e,t),i=Object(E.intersection)(e,t);s.setAll({...xt(n,!0),...xt(i,!1)})}),[a,o,s]);return Object(i.useEffect)((()=>{const t=e.map((e=>e.id)),a=Object.keys(r);Object(E.isEqual)(t,a)||d(t)}),[e,r,d]),{getVisibleMessageIds:l,isVisible:c,dismiss:u}})([a],e);return t&&n(a)?r.a.createElement(r.a.Fragment,null,r.a.createElement(Et,{message:a,onDismiss:s}),r.a.createElement(N.EuiSpacer,{size:"l"})):null},wt=Object(i.memo)(Ot),jt=({condition:e,message:t})=>e?r.a.createElement(Et,{message:t,showDismissButton:!1}):null,Ct=Object(i.memo)(jt);var It=a(165);const Mt=({url:e,children:t,ariaLabel:a})=>t?r.a.createElement(N.EuiToolTip,{content:e,position:"top","data-test-subj":"externalLinkTooltip"},r.a.createElement(N.EuiLink,{href:e,"aria-label":a,external:!0,target:"_blank",rel:"noopener","data-test-subj":"externalLink"},t)):null,At=F.i18n.translate("xpack.securitySolution.documentationLinks.ariaLabelEnding",{defaultMessage:"click to open documentation in a new tab"}),Dt=F.i18n.translate("xpack.securitySolution.documentationLinks.solutionRequirements.text",{defaultMessage:"Elastic Security system requirements"}),qt=F.i18n.translate("xpack.securitySolution.documentationLinks.detectionsRequirements.text",{defaultMessage:"Detections prerequisites and requirements"}),Pt=F.i18n.translate("xpack.securitySolution.documentationLinks.mlJobCompatibility.text",{defaultMessage:"ML job compatibility"}),Rt=({guidePath:e="security",docPath:t,linkText:a})=>{const{services:n}=Object(d.j)(),{ELASTIC_WEBSITE_URL:i,DOC_LINK_VERSION:s}=n.docLinks,o=`${i}guide/en/${e}/${s}/${t}`,l=`${a} - ${At}`;return r.a.createElement(Mt,{url:o,ariaLabel:l},a)},_t=Object(i.memo)(Rt),Ft=()=>r.a.createElement(_t,{docPath:"sec-requirements.html",linkText:Dt}),Lt=()=>r.a.createElement(_t,{docPath:"detections-permissions-section.html",linkText:qt}),Nt=()=>r.a.createElement(_t,{docPath:"alerts-ui-monitor.html#ml-job-compatibility",linkText:Pt}),Bt={type:"primary",id:"need-admin-for-update-rules",title:F.i18n.translate("xpack.securitySolution.detectionEngine.needAdminForUpdateCallOutBody.messageTitle",{defaultMessage:"Administration permissions required for alert migration"}),description:r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.needAdminForUpdateCallOutBody.messageBody.messageDetail",defaultMessage:"{essence} Related documentation: {docs}",values:{essence:r.a.createElement("p",null,r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.needAdminForUpdateCallOutBody.messageBody.essenceDescription",defaultMessage:"You are currently missing the required permissions to auto migrate your alert data. Please have your administrator visit this page one time to auto migrate your alert data."})),docs:r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(Lt,null)),r.a.createElement("li",null,r.a.createElement(Ft,null)))}})},zt=()=>{const[{signalIndexMappingOutdated:e,hasIndexManage:t}]=Object(_e.b)();return null!=e&&e&&null!=t&&!t?r.a.createElement(r.a.Fragment,null,r.a.createElement(Ct,{condition:!0,message:Bt}),r.a.createElement(N.EuiSpacer,{size:"l"})):null},Ut=Object(i.memo)(zt);var Ht=a(1029),$t=a.n(Ht);const Vt=({values:e})=>r.a.createElement(r.a.Fragment,null,e.map(((t,a)=>r.a.createElement(r.a.Fragment,{key:a},r.a.createElement(N.EuiCode,null,t),a<e.length-1?", ":"")))),Qt=F.i18n.translate("xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.messageTitle",{defaultMessage:"Insufficient privileges"}),Wt=F.i18n.translate("xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.cannotEditRules",{defaultMessage:"Without that privilege you cannot create or edit detection engine rules."}),Gt=F.i18n.translate("xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.cannotEditLists",{defaultMessage:"Without these privileges, you cannot create or edit value lists."}),Kt=F.i18n.translate("xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.cannotEditAlerts",{defaultMessage:"Without these privileges, you cannot view or change status of alerts."}),Yt=({indexPrivileges:e,featurePrivileges:t=[]})=>r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.messageBody.messageDetail",defaultMessage:"{essence} {indexPrivileges} {featurePrivileges} Related documentation: {docs}",values:{essence:r.a.createElement("p",null,r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.messageBody.essenceDescription",defaultMessage:"You need the following privileges to fully access this functionality. Contact your administrator for further assistance."})),indexPrivileges:e.length>0?r.a.createElement(r.a.Fragment,null,r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.messageBody.indexPrivilegesTitle",defaultMessage:"Missing Elasticsearch index privileges:"}),r.a.createElement("ul",null,e.map((([e,t])=>r.a.createElement("li",{key:e},Zt(e,t)))))):null,featurePrivileges:t.length>0?r.a.createElement(r.a.Fragment,null,r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.messageBody.featurePrivilegesTitle",defaultMessage:"Missing Kibana feature privileges:"}),r.a.createElement("ul",null,t.map((([e,t])=>r.a.createElement("li",{key:e},ea(e,t)))))):null,docs:r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(Lt,null)),r.a.createElement("li",null,r.a.createElement(Ft,null)))}}),Jt={[o.Yb]:{all:Wt},[o.Z]:{write:Kt},[o.T]:{write:Gt},[o.S]:{write:Gt}},Xt=(e,t)=>{var a;const n=null===(a=Object.entries(Jt).find((([e])=>t.startsWith(e))))||void 0===a?void 0:a[1];return e.map((e=>null==n?void 0:n[e])).filter(Boolean).join(" ")},Zt=(e,t)=>r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.messageBody.missingIndexPrivileges",defaultMessage:"Missing {privileges} privileges for the {index} index. {explanation}",values:{privileges:r.a.createElement(Vt,{values:t}),index:r.a.createElement(N.EuiCode,null,e),explanation:Xt(t,e)}}),ea=(e,t)=>r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.messageBody.missingFeaturePrivileges",defaultMessage:"Missing {privileges} privileges for the {index} feature. {explanation}",values:{privileges:r.a.createElement(Vt,{values:t}),index:r.a.createElement(N.EuiCode,null,e),explanation:Xt(t,e)}}),ta=["read","write","view_index_metadata","maintenance"],aa=e=>{const t=(e=>{const[t]=Object.keys(e);return t})(e),a=e[t],n=ta.filter((e=>!a[e]));if(n.length)return[t,n]},na=()=>{const e=(()=>{const{detectionEnginePrivileges:e,listPrivileges:t}=Object(nt.a)(),[{canUserCRUD:a}]=Object(_e.b)();return Object(i.useMemo)((()=>{const n=[],i=[];if(null==a||null==t.result||null==e.result)return{featurePrivileges:n,indexPrivileges:i};!1===a&&n.push([o.Yb,["all"]]);const r=aa(t.result.listItems.index);r&&i.push(r);const s=aa(t.result.lists.index);s&&i.push(s);const l=aa(e.result.index);return l&&i.push(l),{featurePrivileges:n,indexPrivileges:i}}),[a,t,e])})(),t=Object(i.useMemo)((()=>e.indexPrivileges.length>0||e.featurePrivileges.length>0?{type:"primary",id:`missing-user-privileges-${$t()(e)}`,title:Qt,description:Yt(e)}:null),[e]);return t&&r.a.createElement(wt,{namespace:"detections",condition:!0,message:t})},ia=Object(i.memo)(na);var ra=a(43),sa=a.n(ra),oa=a(39),la=a(216),ca=a(220);const ua=(e,t,a,n=[],i)=>({size:0,aggs:{alertsByGroupingCount:{terms:{field:e,order:{_count:"desc"},size:o.U}}},query:{bool:{filter:[...n,{range:{"@timestamp":{gte:t,lte:a}}}]}},runtime_mappings:i});a(559);const da=F.i18n.translate("xpack.securitySolution.detectionEngine.alerts.count.countTableColumnTitle",{defaultMessage:"Count"}),pa=F.i18n.translate("xpack.securitySolution.detectionEngine.alerts.count.countTableTitle",{defaultMessage:"Count"});var ma=a(196);const ga=z.a.div.withConfig({displayName:"Wrapper",componentId:"sc-1p6ej67-0"})(["margin-top:-",";"],(({theme:e})=>e.eui.euiSizeS)),fa=Object(i.memo)((({loading:e,selectedStackByOption:t,data:a})=>{var n,s,l;const[c]=Object(d.p)(o.V),u=null!==(n=null==a||null===(s=a.aggregations)||void 0===s||null===(l=s.alertsByGroupingCount)||void 0===l?void 0:l.buckets)&&void 0!==n?n:[],p=Object(i.useMemo)((()=>((e,t)=>[{field:"key",name:e,truncateText:!1,render:function(t){return r.a.createElement(ma.b,{isDraggable:!1,field:e,hideTopN:!0,id:`alert-count-draggable-${e}-${t}`,value:t,tooltipContent:null})}},{field:"doc_count",name:da,sortable:!0,textOnly:!0,dataType:"number",render:e=>pe()(e).format(t)}])(t,c)),[t,c]);return r.a.createElement(r.a.Fragment,null,e&&r.a.createElement(N.EuiProgress,{size:"xs",position:"absolute",color:"accent"}),r.a.createElement(ga,{"data-test-subj":"alertsCountTable",className:"eui-yScroll"},r.a.createElement(N.EuiInMemoryTable,{isSelectable:!1,columns:p,items:u,loading:e,sorting:!0})))}));fa.displayName="AlertsCount";var ba=a(469),ha=a(767),ya=a(558),Ea=a(197);const va=Object(i.memo)((({filters:e,query:t,signalIndexName:a,runtimeMappings:n})=>{const{to:s,from:o,deleteQuery:l,setQuery:c}=Object(H.a)(),u=Object(i.useMemo)((()=>`detections-alerts-count-${sa.a.v4()}`),[]),[d,p]=Object(i.useState)(ba.b),m=Object(i.useMemo)((()=>{try{var a;return[Object(oa.c)(void 0,null!=t?[t]:[],null!==(a=null==e?void 0:e.filter((e=>!1===e.meta.disabled)))&&void 0!==a?a:[])]}catch(e){return[]}}),[t,e]),{toggleStatus:g,setToggleStatus:f}=Object(Ea.a)("detections-alerts-count"),[b,h]=Object(i.useState)(!g);Object(i.useEffect)((()=>{h(!g)}),[g]);const y=Object(i.useCallback)((e=>{f(e),h(!e)}),[h,f]),{loading:E,data:v,setQuery:T,response:k,request:x,refetch:S}=Object(w.a)({query:ua(d,o,s,m,n),indexName:a,skip:b});return Object(i.useEffect)((()=>{T(ua(d,o,s,m,n))}),[T,d,o,s,m,n]),Object(ya.a)({setQuery:c,response:k,request:x,refetch:S,uniqueQueryId:u,deleteQuery:l,loading:E}),r.a.createElement(ca.c,{show:g},r.a.createElement(ha.a,{$toggleStatus:g,hasBorder:!0,"data-test-subj":"alertsCountPanel"},r.a.createElement(la.a,{id:u,title:pa,titleSize:"s",hideSubtitle:!0,toggleStatus:g,toggleQuery:y},r.a.createElement(ha.b,{selected:d,onSelect:p})),g&&r.a.createElement(fa,{data:v,loading:E,selectedStackByOption:d})))}));va.displayName="AlertsCountPanel";var Ta=a(241),ka=a(278);const xa=z.a.div.withConfig({displayName:"StyledFullHeightContainer",componentId:"sc-7rr6ls-0"})(["display:flex;flex-direction:column;flex:1 1 auto;"]),Sa=({clearEventsDeleted:e,clearEventsLoading:t,clearSelected:a})=>{const n=Object(l.useDispatch)(),s=Object(i.useRef)(null),o=Object(i.useMemo)((()=>p.b.getTimelineByIdSelector()),[]),f=Object(v.b)((e=>{var t;return(null!==(t=o(e,c.i.detectionsPage))&&void 0!==t?t:le.a).graphEventId})),h=Object(v.b)((e=>{var t;return(null!==(t=o(e,c.i.detectionsPage))&&void 0!==t?t:le.a).updated})),y=Object(v.b)((e=>{var t;return(null!==(t=o(e,c.i.detectionsPage))&&void 0!==t?t:le.a).isLoading})),k=Object(i.useMemo)((()=>W.d.globalFiltersQuerySelector()),[]),x=Object(i.useMemo)((()=>W.d.globalQuerySelector()),[]),S=Object(v.a)(x),O=Object(v.a)(k),{to:w,from:j}=Object(H.a)(),{globalFullScreen:C}=Object(dt.a)(),[{loading:I,isAuthenticated:M,hasEncryptionKey:A,signalIndexName:D,hasIndexWrite:q=!1,hasIndexMaintenance:P=!1,canUserREAD:R,hasIndexRead:_}]=Object(_e.b)(),{loading:F,needsConfiguration:L}=lt(),{indexPattern:B,runtimeMappings:z,loading:K}=Object(m.d)(g.SourcererScopeName.detections),{formatUrl:Y}=Object(u.k)(T.a.rules),[J,X]=Object(i.useState)(!1),[Z,ee]=Object(i.useState)(!1),te=I||F,{application:{navigateToUrl:ae},timelines:ne,docLinks:ie}=Object(d.j)().services,[re,se]=Object(i.useState)(he),ce=Object(i.useMemo)((()=>y||te),[y,te]),ue=Object(i.useCallback)((({x:e})=>{if(!e)return;const[t,a]=e;n(Object(G.setAbsoluteRangeDatePicker)({id:"global",from:new Date(t).toISOString(),to:new Date(a).toISOString()}))}),[n]),de=Object(i.useCallback)((e=>{e.preventDefault(),ae(Y(Object(V.d)()))}),[Y,ae]),pe=Object(i.useCallback)((a=>{const n=c.i.detectionsPage;t({id:n}),e({id:n}),se(a)}),[t,e,se]),me=Object(i.useMemo)((()=>[...O,...Object(we.f)(J),...Object(we.c)(re),...Object(we.g)(Z)]),[O,J,Z,re]),ge=Object(i.useMemo)((()=>[...Object(we.f)(J),...Object(we.g)(Z)]),[J,Z]),fe=Object(i.useCallback)((e=>{X(e)}),[X]),be=Object(i.useCallback)((e=>{ee(e)}),[ee]),{signalIndexNeedsInit:ye,pollForSignalIndex:ve}=Object(mt.a)(),Te=Object(i.useCallback)((()=>{Object(oe.k)(s.current)}),[s]),ke=Object(i.useCallback)((()=>{Object(oe.m)()}),[]),xe=Object(i.useCallback)((e=>{Object(U.isTab)(e)&&Object(oe.l)({containerElement:s.current,keyboardEvent:e,onSkipFocusBeforeEventsTable:Te,onSkipFocusAfterEventsTable:ke})}),[s,Te,ke]),Se=Object(i.useMemo)((()=>({feature:{icon:"documents",label:Ve,url:`${ie.links.siem.privileges}`,target:"_blank"}})),[ie]);return te?r.a.createElement(b.a,null,r.a.createElement(Ta.a,{border:!0,title:Le,isLoading:te}),r.a.createElement(N.EuiFlexGroup,{justifyContent:"center",alignItems:"center"},r.a.createElement(N.EuiLoadingSpinner,{size:"xl"}))):null==M||M||te?!te&&ye||L?r.a.createElement(b.a,null,r.a.createElement(Ta.a,{border:!0,title:Le}),r.a.createElement(Xe,{needsSignalsIndex:ye,needsListsIndex:L})):r.a.createElement(r.a.Fragment,null,null!=A&&!A&&r.a.createElement(Pe,null),r.a.createElement(Ut,null),r.a.createElement(ia,null),ye||!1!==_&&!1!==R?!ye&&_&&R?r.a.createElement(xa,{onKeyDown:xe,ref:s},r.a.createElement(N.EuiWindowEvent,{event:"resize",handler:E.noop}),r.a.createElement($.a,{show:Object(oe.n)({globalFullScreen:C,graphEventId:f})},r.a.createElement(Q.a,{id:"global",pollForSignalIndex:ve,indexPattern:B})),r.a.createElement(b.a,{noPadding:C,"data-test-subj":"detectionsAlertsPage"},r.a.createElement(pt,{show:!C},r.a.createElement(Ta.a,{title:Le},r.a.createElement(ut.f,{onClick:de,href:Y(Object(V.d)()),"data-test-subj":"manage-alert-detection-rules"},Be)),r.a.createElement(N.EuiHorizontalRule,{margin:"m"}),r.a.createElement(N.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween"},r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(Ee,{status:re,onFilterGroupChanged:pe})),r.a.createElement(N.EuiFlexItem,{grow:!1},h&&ne.getLastUpdated({updatedAt:h||Date.now(),showUpdating:ce}))),r.a.createElement(N.EuiSpacer,{size:"m"}),r.a.createElement(N.EuiFlexGroup,{wrap:!0},r.a.createElement(N.EuiFlexItem,{grow:1},K?r.a.createElement(N.EuiLoadingSpinner,{size:"xl"}):r.a.createElement(va,{filters:me,query:S,signalIndexName:D,runtimeMappings:z})),r.a.createElement(N.EuiFlexItem,{grow:2},K?r.a.createElement(N.EuiLoadingSpinner,{size:"xl"}):r.a.createElement(Re.a,{chartHeight:ba.a,filters:me,query:S,showTotalAlertsCount:!1,titleSize:"s",signalIndexName:D,updateDateRange:ue,runtimeMappings:z}))),r.a.createElement(N.EuiSpacer,{size:"l"})),r.a.createElement(Ie,{timelineId:c.i.detectionsPage,loading:te,hasIndexWrite:null!=q&&q,hasIndexMaintenance:null!=P&&P,from:j,defaultFilters:ge,showBuildingBlockAlerts:J,onShowBuildingBlockAlertsChanged:fe,showOnlyThreatIndicatorAlerts:Z,onShowOnlyThreatIndicatorAlertsChanged:be,to:w,filterGroup:re}))):r.a.createElement(ka.a,null):r.a.createElement(Fe.a,{actions:Se,message:Ye,"data-test-subj":"no_feature_permissions-alerts",title:Ke})):r.a.createElement(b.a,null,r.a.createElement(Ta.a,{border:!0,title:Le}),r.a.createElement(ct,null))},Oa=Object(l.connect)(null,(e=>({clearSelected:({id:t})=>e(p.a.clearSelected({id:t})),clearEventsLoading:({id:t})=>e(p.a.clearEventsLoading({id:t})),clearEventsDeleted:({id:t})=>e(p.a.clearEventsDeleted({id:t}))})))(r.a.memo(Sa)),wa=F.i18n.translate("xpack.securitySolution.badge.readOnly.text",{defaultMessage:"Read only"});var ja=a(361);function Ca(e){const{hasKibanaREAD:t,hasKibanaCRUD:a}=Object(ja.a)(),n=Object(d.j)().services.chrome;Object(i.useEffect)((()=>(t&&!a&&n.setBadge({text:wa,tooltip:e,iconType:"glasses"}),()=>{n.setBadge()})),[n,t,a,e])}const Ia=()=>r.a.createElement(s.TrackApplicationView,{viewId:o.cc.alerts},r.a.createElement(Oa,null),r.a.createElement(y.a,{pageName:o.cc.alerts})),Ma=()=>(Ca(L),r.a.createElement(P.Switch,null,r.a.createElement(R.Route,{path:o.c,exact:!0,component:Ia}),r.a.createElement(R.Route,{component:_.a}))),Aa=r.a.memo(Ma),Da=[{path:o.eb,render:({location:e})=>e.pathname===o.eb?r.a.createElement(P.Redirect,{to:{...e,pathname:o.c}}):r.a.createElement(P.Redirect,{to:{...e,pathname:e.pathname.replace(o.eb,"")}})},{path:o.c,render:()=>r.a.createElement(Aa,null)}],qa=[c.i.detectionsRulesDetailsPage,c.i.detectionsPage],Pa=F.i18n.translate("xpack.securitySolution.exceptions.badge.readOnly.tooltip",{defaultMessage:"Unable to create, edit or delete exceptions"}),Ra=z.a.a.withConfig({displayName:"InvisibleAnchor",componentId:"sc-bxvucm-0"})(["display:none;"]),_a=({blob:e,name:t,onDownload:a})=>{const n=Object(i.useRef)(null);return Object(i.useEffect)((()=>{if(e&&null!=n&&n.current){if("function"==typeof window.navigator.msSaveOrOpenBlob)window.navigator.msSaveBlob(e);else{const a=window.URL.createObjectURL(e);n.current.href=a,n.current.download=null!=t?t:"download.txt",n.current.click(),window.URL.revokeObjectURL(a)}a&&a()}}),[e,t,a]),r.a.createElement(Ra,{ref:n})};var Fa=a(239);const La=F.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.idTitle",{defaultMessage:"List ID"}),Na=F.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.listName",{defaultMessage:"Name"}),Ba=F.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.actionsTitle",{defaultMessage:"Actions"}),za=(F.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.numberRulesAssignedTitle",{defaultMessage:"Number of rules assigned to"}),F.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.rulesAssignedTitle",{defaultMessage:"Rules assigned to"})),Ua=F.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.dateCreatedTitle",{defaultMessage:"Date created"}),Ha=F.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.dateUpdatedTitle",{defaultMessage:"Last edited"}),$a=F.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.errorFetching",{defaultMessage:"Error fetching exception lists"}),Va=F.i18n.translate("xpack.securitySolution.detectionEngine.rules.allExceptionLists.filters.noExceptionsTitle",{defaultMessage:"No exception lists found"}),Qa=F.i18n.translate("xpack.securitySolution.detectionEngine.rules.allExceptionLists.search.placeholder",{defaultMessage:"Search exception lists"}),Wa=F.i18n.translate("xpack.securitySolution.detectionEngine.rules.allExceptions.tableTitle",{defaultMessage:"Exception lists"}),Ga=F.i18n.translate("xpack.securitySolution.detectionEngine.rules.allExceptions.filters.noListsBody",{defaultMessage:"We weren't able to find any exception lists."}),Ka=F.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.exportSuccess",{defaultMessage:"Exception list export success"}),Ya=F.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.exportError",{defaultMessage:"Exception list export error"}),Ja=F.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.deleteError",{defaultMessage:"Error occurred deleting exception list"}),Xa=e=>F.i18n.translate("xpack.securitySolution.exceptions.referenceModalSuccessDescription",{defaultMessage:"Exception list - {listId} - deleted successfully.",values:{listId:e}}),Za=F.i18n.translate("xpack.securitySolution.exceptions.referenceModalTitle",{defaultMessage:"Remove exception list"}),en=F.i18n.translate("xpack.securitySolution.exceptions.referenceModalCancelButton",{defaultMessage:"Cancel"}),tn=F.i18n.translate("xpack.securitySolution.exceptions.referenceModalDeleteButton",{defaultMessage:"Remove exception list"}),an=F.i18n.translate("xpack.securitySolution.exceptions.searchPlaceholder",{defaultMessage:"e.g. Example List Name"});var nn=a(205),rn=a(10),sn=a.n(rn);class invariant_InvariantError extends Error{constructor(...e){super(...e),sn()(this,"name","InvariantError")}}function on(e,t){if(!e)throw new invariant_InvariantError(t)}var ln=a(215),cn=a(232),un=a(292);const dn="findRules",pn=(e,t,a)=>{const{addError:n}=Object(X.a)();return Object(ln.useQuery)([dn,...e,t],(async({signal:e})=>{const a=await Object(cn.f)({signal:e,...t});return{rules:a.data,total:a.total}}),{refetchIntervalInBackground:!1,onError:e=>n(e,{title:un.h}),...a})},mn=()=>{const e=Object(ln.useQueryClient)();return Object(i.useCallback)((()=>{e.invalidateQueries(dn,{refetchActive:!0,refetchInactive:!1})}),[e])};function gn(e,t){const a=new Map(t.map((e=>[e.id,e])));return e.some((e=>a.has(e.id)))?e.map((e=>{var t;return null!==(t=a.get(e.id))&&void 0!==t?t:e})):e}var fn=a(6);const bn=(e,t,a)=>e>t?a:e<t?-a:0,hn={filter:"",tags:[],showCustomRules:!1,showElasticRules:!1},yn={field:"enabled",order:"desc"},En=Object(i.createContext)(null),vn="detection-rules-table-in-memory",Tn=({children:e,refetchPrePackagedRulesStatus:t})=>{var a;const[n]=Object(d.p)(o.Y),{storage:s}=Object(d.j)().services,[l,c]=Object(i.useState)(null!==(a=s.get(vn))&&void 0!==a&&a),[u,p]=Object(i.useState)(hn),[m,g]=Object(i.useState)(yn),[f,b]=Object(i.useState)(!1),[h,y]=Object(i.useState)(n.on),[E,v]=Object(i.useState)({ids:[],action:null}),[T,k]=Object(i.useState)(1),[x,S]=Object(i.useState)(20),[O,w]=Object(i.useState)([]),j=Object(i.useCallback)((e=>{c(e),s.set(vn,e),!1===e&&g(yn)}),[s]),C=Object(i.useMemo)((()=>{var e;return E.ids.length>0&&!["disable","enable","edit"].includes(null!==(e=E.action)&&void 0!==e?e:"")}),[E.action,E.ids.length]),I=Object(i.useMemo)((()=>({page:T,perPage:x})),[T,x]),M=Object(i.useCallback)((e=>{p((t=>({...t,...e}))),k(1),w([]),b(!1)}),[]),{data:{rules:A,total:D}={rules:[],total:0},refetch:q,dataUpdatedAt:P,isFetched:R,isFetching:_,isLoading:F,isRefetching:L}=(e=>{const{pagination:t,filterOptions:a,sortingOptions:n,isInMemorySorting:i,refetchInterval:r}=e,s=pn(["all"],{pagination:{page:1,perPage:1e4},filterOptions:a},{refetchInterval:r,enabled:i,keepPreviousData:!0}),o=pn(["paged"],{pagination:t,filterOptions:a,sortingOptions:n},{refetchInterval:r,enabled:!i,keepPreviousData:!0});return i?s:o})({isInMemorySorting:l,filterOptions:u,sortingOptions:m,pagination:I,refetchInterval:h&&!C&&n.value});Object(i.useEffect)((()=>{R&&L&&t()}),[R,L,t]);const N=l?A.sort(function(e){return(t,a)=>{const{field:n,order:i}=e,r="asc"===i?1:-1;switch(n){case"enabled":{const e=Object(fn.get)(t,n),i=Object(fn.get)(a,n);return bn(Number(e),Number(i),r)}case"version":case"risk_score":case"execution_summary.last_execution.metrics.execution_gap_duration_s":case"execution_summary.last_execution.metrics.total_indexing_duration_ms":case"execution_summary.last_execution.metrics.total_search_duration_ms":{var s,o;const e=null!==(s=Object(fn.get)(t,n))&&void 0!==s?s:-1/0,i=null!==(o=Object(fn.get)(a,n))&&void 0!==o?o:-1/0;return bn(e,i,r)}case"updated_at":case"created_at":case"execution_summary.last_execution.date":{const e=Object(fn.get)(t,n),i=Object(fn.get)(a,n);return bn(null==e?0:new Date(e).getTime(),null==i?0:new Date(i).getTime(),r)}case"execution_summary.last_execution.status":case"severity":case"name":{const e=Object(fn.get)(t,n),i=Object(fn.get)(a,n);return(e||"").localeCompare(i||"")*r}}}}(m)).slice((T-1)*x,T*x):A,B=Object(i.useMemo)((()=>({state:{rules:N,pagination:{page:T,perPage:x,total:l?A.length:D},filterOptions:u,isActionInProgress:C,isAllSelected:f,isFetched:R,isFetching:_,isInMemorySorting:l,isLoading:F,isRefetching:L,isRefreshOn:h,lastUpdated:P,loadingRuleIds:E.ids,loadingRulesAction:E.action,selectedRuleIds:O,sortingOptions:m},actions:{reFetchRules:q,setFilterOptions:M,setIsAllSelected:b,setIsInMemorySorting:j,setIsRefreshOn:y,setLoadingRules:v,setPage:k,setPerPage:S,setSelectedRuleIds:w,setSortingOptions:g}})),[P,u,M,C,f,R,_,l,F,L,h,E.action,E.ids,T,x,q,A.length,N,O,m,j,D]);return r.a.createElement(En.Provider,{value:B},e)},kn=()=>{const e=Object(i.useContext)(En);return on(e,"useRulesTableContext should be used inside RulesTableContextProvider"),e},xn=()=>Object(i.useContext)(En),Sn=r.a.memo((({canBulkEdit:e,isAllSelected:t,isAutoRefreshOn:a,numberSelectedItems:n,onGetBulkItemsPopoverContent:s,onRefresh:o,onRefreshSwitch:l,onToggleSelectAll:c,paginationTotal:u,hasBulkActions:p=!0,hasPagination:m,isBulkActionInProgress:g,hasDisabledActions:f})=>{const{timelines:b}=Object(d.j)().services,h=xn(),y=Object(i.useCallback)((e=>null!=s?r.a.createElement(N.EuiContextMenu,{initialPanelId:0,panels:s(e)}):null),[s]),E=Object(i.useCallback)((e=>t=>{null!=l&&(l(t.target.checked),e())}),[l]),v=Object(i.useCallback)((e=>r.a.createElement(N.EuiContextMenuPanel,{items:[r.a.createElement(N.EuiSwitch,{key:"allRulesAutoRefreshSwitch",label:nn.Qb,checked:null!=a&&a,onChange:E(e),compressed:!0,"data-test-subj":"refreshSettingsSwitch"})]})),[a,E]);return r.a.createElement(ge.a,{border:!0},r.a.createElement(ge.d,null,r.a.createElement(ge.c,null,p?r.a.createElement(ge.f,{dataTestSubj:"showingRules"},nn.Ac(u)):r.a.createElement(ge.f,{dataTestSubj:"showingExceptionLists"},nn.zc(u))),p?r.a.createElement(r.a.Fragment,null,r.a.createElement(ge.c,{"data-test-subj":"tableBulkActions"},r.a.createElement(ge.f,{dataTestSubj:"selectedRules"},nn.wc(n)),e&&c&&m&&r.a.createElement(ge.b,{disabled:f,dataTestSubj:"selectAllRules",iconType:t?"cross":"pagesSelect",iconSide:"left",onClick:c},t?nn.S:nn.xc(u)),e&&r.a.createElement(ge.b,{disabled:f,inProgress:g,dataTestSubj:"bulkActions",iconSide:"right",iconType:"arrowDown",popoverPanelPaddingSize:"none",popoverContent:y},nn.f),r.a.createElement(ge.b,{disabled:f,dataTestSubj:"refreshRulesAction",iconSide:"left",iconType:"refresh",onClick:o},nn.Pb),r.a.createElement(ge.b,{disabled:f,dataTestSubj:"refreshSettings",iconSide:"right",iconType:"arrowDown",popoverContent:v},nn.Rb))):r.a.createElement(ge.c,null,r.a.createElement(ge.b,{dataTestSubj:"refreshRulesAction",iconSide:"left",iconType:"refresh",onClick:o},nn.Pb))),h&&r.a.createElement(ge.d,null,b.getLastUpdated({showUpdating:h.state.isFetching,updatedAt:h.state.lastUpdated})))}));Sn.displayName="AllRulesUtilityBar";var On=a(518),wn=a(201),jn=a(274);const Cn=z.a.div.withConfig({displayName:"MarkdownContainer",componentId:"sc-1c9tzb5-0"})(["max-height:200px;overflow-y:auto;&::-webkit-scrollbar{height:",";width:",";}&::-webkit-scrollbar-thumb{background-clip:content-box;background-color:",";border:"," solid transparent;}&::-webkit-scrollbar-corner,&::-webkit-scrollbar-track{background-color:transparent;}"],(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>Object(jn.rgba)(e.eui.euiColorDarkShade,.5)),(({theme:e})=>e.eui.euiScrollBarCorner)),In=({cancelText:e,confirmText:t,contentText:a,onClose:n,onCancel:i,onConfirm:s,references:o=[],showModal:l,titleText:c})=>l?r.a.createElement(N.EuiConfirmModal,{maxWidth:460,title:c,onCancel:i,onConfirm:s,cancelButtonText:e,confirmButtonText:t,buttonColor:"danger",defaultFocusedButton:"confirm","data-test-subj":"referenceErrorModal"},r.a.createElement("p",null,a),r.a.createElement(Cn,null,r.a.createElement(N.EuiListGroup,{gutterSize:"none",showToolTips:!0},o.map(((e,t)=>r.a.createElement(N.EuiListGroupItem,{key:`${t}-${e}`,label:e})))))):null;In.displayName="ReferenceErrorModalComponent";const Mn=r.a.memo(In);Mn.displayName="ReferenceErrorModal";const An={strict:!0,fields:{created_by:{type:"string"},name:{type:"string"},type:{type:"string"},list_id:{type:"string"},tags:{type:"string"}}},Dn=r.a.memo((({onSearch:e})=>r.a.createElement(N.EuiSearchBar,{"data-test-subj":"exceptionsHeaderSearch","aria-label":Qa,onChange:e,box:{"data-test-subj":"exceptionsHeaderSearchInput",placeholder:an,incremental:!1,schema:An}})));Dn.displayName="ExceptionsSearchBar";const qn=e=>e.sort(((e,t)=>e.toLowerCase().localeCompare(t.toLowerCase())));var Pn=a(95),Rn=a.n(Pn),_n=a(51),Fn=a.n(_n),Ln=a(62),Nn=a.n(Ln),Bn=a(202),zn=a(293);const Un=({group:e,id:t,action_type_id:a,params:n})=>({group:e,id:t,params:n,actionTypeId:a}),Hn=({group:e,id:t,actionTypeId:a,params:n})=>({group:e,id:t,params:n,action_type_id:a});var $n=a(170);const Vn=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.advancedSettingsButton",{defaultMessage:"Advanced settings"}),Qn=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.addReferenceDescription",{defaultMessage:"Add reference URL"}),Wn=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.addFalsePositiveDescription",{defaultMessage:"Add false positive example"}),Gn=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.endpointExceptionListLabel",{defaultMessage:"Elastic Endpoint exceptions"}),Kn=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.buildingBlockLabel",{defaultMessage:"Building block"}),Yn=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionLowDescription",{defaultMessage:"Low"}),Jn=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionMediumDescription",{defaultMessage:"Medium"}),Xn=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionHighDescription",{defaultMessage:"High"}),Zn=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionCriticalDescription",{defaultMessage:"Critical"}),ei=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.referencesUrlInvalidError",{defaultMessage:"URL is invalid format"}),ti=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutrule.noteHelpText",{defaultMessage:"Add rule investigation guide..."}),ai=z()(N.EuiHealth).withConfig({displayName:"StyledEuiHealth",componentId:"sc-1mv5h4i-0"})(["line-height:inherit;"]),ni=[{value:"low",inputDisplay:r.a.createElement(ai,{color:$n.euiLightVars.euiColorVis0},Yn)},{value:"medium",inputDisplay:r.a.createElement(ai,{color:$n.euiLightVars.euiColorVis5},Jn)},{value:"high",inputDisplay:r.a.createElement(ai,{color:$n.euiLightVars.euiColorVis7},Xn)},{value:"critical",inputDisplay:r.a.createElement(ai,{color:$n.euiLightVars.euiColorVis9},Zn)}],ii={low:21,medium:47,high:73,critical:99},ri=({rule:e,detailsView:t=!1})=>{const a=oi(e);return{aboutRuleData:ui(e,t),modifiedAboutRuleDetailsData:gi(e),defineRuleData:a,scheduleRuleData:li(e),ruleActionsData:si(e)}},si=e=>{const{enabled:t,throttle:a,meta:n,actions:i=[]}=e;return{actions:null==i?void 0:i.map(Un),throttle:a,kibanaSiemAppUrl:null==n?void 0:n.kibana_siem_app_url,enabled:t}},oi=e=>{var t,a,n,i,r,s,o,l,c,u,d,p,m,g,f,b,h,y,E,v;return{ruleType:e.type,anomalyThreshold:null!==(t=e.anomaly_threshold)&&void 0!==t?t:50,machineLearningJobId:null!==(a=e.machine_learning_job_id)&&void 0!==a?a:[],index:null!==(n=e.index)&&void 0!==n?n:[],threatIndex:null!==(i=e.threat_index)&&void 0!==i?i:[],threatQueryBar:{query:{query:null!==(r=e.threat_query)&&void 0!==r?r:"",language:null!==(s=e.threat_language)&&void 0!==s?s:""},filters:null!==(o=e.threat_filters)&&void 0!==o?o:[],saved_id:null},threatMapping:null!==(l=e.threat_mapping)&&void 0!==l?l:[],queryBar:{query:{query:null!==(c=e.query)&&void 0!==c?c:"",language:null!==(u=e.language)&&void 0!==u?u:""},filters:null!==(d=e.filters)&&void 0!==d?d:[],saved_id:null!==(p=e.saved_id)&&void 0!==p?p:null},relatedIntegrations:null!==(m=e.related_integrations)&&void 0!==m?m:[],requiredFields:null!==(g=e.required_fields)&&void 0!==g?g:[],timeline:{id:null!==(f=e.timeline_id)&&void 0!==f?f:null,title:null!==(b=e.timeline_title)&&void 0!==b?b:null},threshold:{field:Object(zn.f)(null===(h=e.threshold)||void 0===h?void 0:h.field),value:`${(null===(y=e.threshold)||void 0===y?void 0:y.value)||100}`,...null!==(E=e.threshold)&&void 0!==E&&null!==(v=E.cardinality)&&void 0!==v&&v.length?{cardinality:{field:[`${e.threshold.cardinality[0].field}`],value:`${e.threshold.cardinality[0].value}`}}:{}},eqlOptions:{timestampField:e.timestamp_field,eventCategoryField:e.event_category_override,tiebreakerField:e.tiebreaker_field}}},li=e=>{const{interval:t,from:a}=e;return{interval:t,from:ci(a,t)}},ci=(e,t)=>{var a,n;const i=null!==(a=Rn.a.parse(e))&&void 0!==a?a:Fn()(),r=null!==(n=Rn.a.parse(`now-${t}`))&&void 0!==n?n:Fn()(),s=Fn.a.duration(r.diff(i)),o=Math.floor(s.asSeconds());return 0===o?"0s":o%3600==0?o/3600+"h":o%60==0?o/60+"m":`${o}s`},ui=(e,t)=>{var a;const{name:n,description:i,note:r}=mi(e,t),{author:s,building_block_type:o,exceptions_list:l,license:c,risk_score_mapping:u,rule_name_override:d,severity_mapping:p,timestamp_override:m,references:g,severity:f,false_positives:b,risk_score:h,tags:y,threat:E,threat_indicator_path:v}=e;return{author:s,isAssociatedToEndpointList:null!==(a=null==l?void 0:l.some((({id:e})=>e===Bn.j)))&&void 0!==a&&a,isBuildingBlock:void 0!==o,license:null!=c?c:"",ruleNameOverride:null!=d?d:"",timestampOverride:null!=m?m:"",name:n,description:i,note:r,references:g,severity:{value:f,mapping:pi(p),isMappingChecked:p.length>0},tags:y,riskScore:{value:h,mapping:u,isMappingChecked:u.length>0},falsePositives:b,threat:E,threatIndicatorPath:v}},di={low:0,medium:1,high:2,critical:3},pi=e=>{const t=ni.flatMap((t=>null==e.find((e=>e.severity===t.value))?[{field:"",value:"",operator:"equals",severity:t.value}]:[]));return[...e,...t].sort(((e,t)=>di[e.severity]-di[t.severity]))},mi=(e,t)=>{const{name:a,description:n,note:i}=e;return t?{name:"",description:"",note:""}:{name:a,description:n,note:null!=i?i:""}},gi=e=>{var t,a;return{note:null!==(t=e.note)&&void 0!==t?t:"",description:e.description,setup:null!==(a=e.setup)&&void 0!==a?a:""}},fi=(e,t,a)=>null!=t&&0===e&&t>0&&0===a?"ruleNotInstalled":null!=e&&e>0&&0===t&&0===a?"ruleInstalled":null!=e&&null!=t&&e>0&&t>0&&0===a?"someRuleUninstall":null!=e&&null!=t&&null!=a&&e>0&&t>=0&&a>0?"ruleNeedUpdate":"unknown",bi=(e,t,a)=>null!=t&&0===e&&t>0&&0===a?"timelinesNotInstalled":null!=e&&e>0&&0===t&&0===a?"timelinesInstalled":null!=e&&null!=t&&e>0&&t>0&&0===a?"someTimelineUninstall":null!=e&&null!=t&&null!=a&&e>0&&t>=0&&a>0?"timelineNeedUpdate":"unknown",hi=(e,t,a,n)=>!1===e||!1===t||!1===a||n,yi=e=>{const t=["index","filters","language","query","saved_id"];switch(e){case"machine_learning":return["anomaly_threshold","machine_learning_job_id"];case"threshold":return["threshold",...t];case"threat_match":case"query":case"saved_query":case"eql":return t}Object(gt.a)(e)},Ei=Nn()((e=>{if(!e)return{state:[],params:[]};const t=(e=>["id","name","description","false_positives","rule_id","max_signals","risk_score","output_index","references","severity","timeline_id","timeline_title","threat","type","version",...yi(e)].sort())(e);return{state:[{name:"signals_count",description:"state.signals_count"}],params:[],context:[{name:"results_link",description:"context.results_link",useWithTripleBracesInTemplates:!0},{name:"alerts",description:"context.alerts"},...t.map((e=>{const t=`rule.${e}`;return{name:t,description:`context.${t}`}}))]}})),vi=e=>null==e||e,Ti=z()(N.EuiFlexItem).withConfig({displayName:"MaxWidthEuiFlexItem",componentId:"sc-97v502-0"})(["max-width:1000px;overflow:hidden;"]);var ki=a(245);const xi={contentText:"",rulesReferences:[],isLoading:!1,listId:"",listNamespaceType:"single"},Si=r.a.memo((()=>{var e;const{formatUrl:t}=Object(u.k)(o.cc.rules),[{loading:a,canUserCRUD:n,canUserREAD:s}]=Object(_e.b)(),l=vi(n),{loading:c}=lt(),p=a||c,{services:{http:m,notifications:g,timelines:f,application:b}}=Object(d.j)(),{exportExceptionList:h,deleteExceptionList:y}=Object(et.a)(m),[E,v]=Object(i.useState)(!1),[T,k]=Object(i.useState)(xi),[x,S]=Object(i.useState)(void 0),[O,w,j,C,I]=Object(et.f)({errorMessage:$a,filterOptions:x,http:m,namespaceTypes:["single","agnostic"],notifications:g,hideLists:ki.a}),[M,A,D]=(({exceptionLists:e})=>{const[t,a]=Object(i.useState)(!0),[n,r]=Object(i.useState)([]),[s,o]=Object(i.useState)({}),l=Object(i.useCallback)((t=>{const a=e.reduce(((e,{id:t,...a})=>(e[t]={...a,id:t,rules:[]},e)),{});return t.reduce(((e,t)=>{const a=t.exceptions_list;return null!=a&&a.length>0&&a.forEach((a=>{const n=e[a.id];null!=n&&(e[a.id]={...n,rules:[...n.rules,t]})})),e}),a)}),[e]);return Object(i.useEffect)((()=>{let t=!0;const n=new AbortController;return(async()=>{if(0===e.length&&t)return a(!1),r([]),void o({});try{a(!0);const{data:e}=await Object(cn.f)({pagination:{page:1,perPage:1e4},signal:n.signal}),i=l(e),s=Object.keys(i).map((e=>i[e]));r(s),o(i),t&&a(!1)}catch(e){t&&a(!1)}})(),()=>{t=!1,n.abort()}}),[e.length,l]),[t,n,s]})({exceptionLists:null!=w?w:[]}),[q,P]=Object(i.useState)(!0),[R,_]=Object(i.useState)(Date.now()),[L,B]=Object(i.useState)([]),[z,U]=Object(i.useState)([]),[H,$]=Object(i.useState)({}),{navigateToUrl:Q}=b,{addError:W,addSuccess:G}=Object(X.a)(),K=Object(i.useCallback)((e=>()=>{g.toasts.addSuccess({title:Xa(null!=e?e:T.listId)})}),[g.toasts,T.listId]),Y=Object(i.useCallback)((e=>{W(e,{title:Ja})}),[W]),J=Object(i.useCallback)((({id:e,listId:t,namespaceType:a})=>async()=>{try{B((t=>[...t,e])),null!=I&&I(),null!=D[e]&&0===D[e].rules.length?(await y({id:e,namespaceType:a,onError:Y,onSuccess:K(t)}),null!=I&&I()):(k({contentText:(n=D[e].rules.length,F.i18n.translate("xpack.securitySolution.exceptions.referenceModalDescription",{defaultMessage:"This exception list is associated with ({referenceCount}) {referenceCount, plural, =1 {rule} other {rules}}. Removing this exception list will also remove its reference from the associated rules.",values:{referenceCount:n}})),rulesReferences:D[e].rules.map((({name:e})=>e)),isLoading:!0,listId:e,listNamespaceType:a}),v(!0))}catch(e){Y(e)}finally{B((t=>t.filter((t=>t!==e))))}var n}),[y,D,Y,K,I]),Z=Object(i.useCallback)((e=>t=>{G(Ka),$({name:e,blob:t})}),[G]),ee=Object(i.useCallback)((e=>{W(e,{title:Ya})}),[W]),te=Object(i.useCallback)((({id:e,listId:t,namespaceType:a})=>async()=>{U((t=>[...t,e])),await h({id:e,listId:t,namespaceType:a,onError:ee,onSuccess:Z(t)})}),[h,ee,Z]),ae=Object(i.useMemo)((()=>{var e;const a=null===(e=s&&!n)||void 0===e||e;return((e,t,a,n,i)=>[{align:"left",field:"list_id",name:La,truncateText:!0,dataType:"string",width:"20%",render:e=>r.a.createElement(N.EuiToolTip,{content:e,anchorClassName:"eui-textTruncate"},r.a.createElement("span",{"data-test-subj":"exceptionsTableListId"},e))},{align:"left",field:"name",name:Na,truncateText:!0,dataType:"string",width:"20%",render:e=>r.a.createElement(N.EuiToolTip,{content:e,anchorClassName:"eui-textTruncate"},r.a.createElement("span",{"data-test-subj":"exceptionsTableName"},e))},{field:"rules",name:za,dataType:"string",width:"30%",render:e=>{return r.a.createElement(On.a,{items:e,numberOfItemsToDisplay:1,popoverTitle:za,popoverButtonTitle:(t=e.length-1,F.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.rulesPopoverButton",{defaultMessage:"+{rulesCount} {rulesCount, plural, =1 {Rule} other {Rules}}",values:{rulesCount:t}})),renderItem:({id:e,name:t},i,s)=>{const o=a(Object(V.c)(e)),l=i!==s.length-1;return r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiToolTip,{content:t,anchorClassName:"eui-textTruncate"},r.a.createElement(r.a.Fragment,null,r.a.createElement(ut.f,{key:e,"data-test-subj":"ruleNameLink",onClick:e=>{e.preventDefault(),n(o)},href:o},t,l&&","))),l&&" ")},dataTestPrefix:"rules"});var t}},{align:"left",field:"created_at",name:Ua,truncateText:!0,dataType:"date",width:"15%",render:e=>r.a.createElement(wn.b,{relativeThresholdInHrs:o.X,value:e,tooltipFieldName:Ua,tooltipAnchorClassName:"eui-textTruncate"})},{align:"left",field:"updated_at",name:Ha,truncateText:!0,width:"15%",render:e=>r.a.createElement(wn.b,{relativeThresholdInHrs:o.X,value:e,tooltipFieldName:Ha,tooltipAnchorClassName:"eui-textTruncate"})},{align:"left",width:"76px",name:Ba,actions:[{render:({id:t,list_id:a,namespace_type:n})=>r.a.createElement(N.EuiButtonIcon,{onClick:e({id:t,listId:a,namespaceType:n}),"aria-label":"Export exception list",iconType:"download","data-test-subj":"exceptionsTableExportButton"})},{render:({id:e,list_id:a,namespace_type:n})=>"endpoint_list"===a||i?r.a.createElement(r.a.Fragment,null):r.a.createElement(N.EuiButtonIcon,{color:"danger",onClick:t({id:e,listId:a,namespaceType:n}),"aria-label":"Delete exception list",iconType:"trash","data-test-subj":"exceptionsTableDeleteButton"})}]}])(te,J,t,Q,a)}),[te,J,t,Q,s,n]),ne=Object(i.useCallback)((()=>{null!=I&&(_(Date.now()),I())}),[I]);Object(i.useEffect)((()=>{!q||p||O||M||P(!1)}),[q,p,O,M]);const ie=Object(i.useMemo)((()=>r.a.createElement(N.EuiEmptyPrompt,{title:r.a.createElement("h3",null,Va),titleSize:"xs",body:Ga})),[]),re=Object(i.useCallback)((async({query:e,queryText:t})=>{const a=(({query:e,searchValue:t,filterOptions:a,defaultSearchTerm:n})=>{const i=null==e?void 0:e.ast.getFieldClauses();return null!=i&&i.length>0?i.reduce(((e,{field:t,value:a})=>(e[t]=`${a}`,e)),a):{[n]:t}})({defaultSearchTerm:"name",filterOptions:{name:null,list_id:null,created_by:null,type:null,tags:null},query:e,searchValue:t});S(a)}),[]),se=Object(i.useCallback)((()=>{B([]),v(!1),k({contentText:"",rulesReferences:[],isLoading:!1,listId:"",listNamespaceType:"single"})}),[]),oe=Object(i.useCallback)((async()=>{const e=T.listId,t=T.listNamespaceType,a=D[e].rules;try{await Promise.all(a.map((t=>{var a;const n=new AbortController,i=(null!==(a=t.exceptions_list)&&void 0!==a?a:[]).filter((({id:t})=>t!==e));return Object(cn.j)({ruleProperties:{rule_id:t.rule_id,exceptions_list:i},signal:n.signal})}))),await y({id:e,namespaceType:t,onError:Y,onSuccess:K()})}catch(e){Y(e)}finally{k(xi),B([]),v(!1),null!=I&&I()}}),[T.listId,T.listNamespaceType,D,y,Y,K,I]),le=Object(i.useMemo)((()=>({pageIndex:j.page-1,pageSize:j.perPage,totalItemCount:j.total||0,pageSizeOptions:[5,10,20,50,100,200,300]})),[j]),ce=Object(i.useCallback)((()=>{$({})}),[]),ue=Object(i.useMemo)((()=>(null!=A?A:[]).map((e=>({...e,isDeleting:L.includes(e.id),isExporting:z.includes(e.id)})))),[L,A,z]),de=Object(i.useCallback)((e=>{const{index:t,size:a}=e.page;C((e=>({...e,perPage:a,page:t+1})))}),[C]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(ia,null),r.a.createElement(N.EuiPageHeader,{pageTitle:Wa,description:r.a.createElement("p",null,f.getLastUpdated({showUpdating:p,updatedAt:R}))}),r.a.createElement(N.EuiHorizontalRule,null),r.a.createElement("div",{"data-test-subj":"allExceptionListsPanel"},M&&r.a.createElement(N.EuiProgress,{"data-test-subj":"loadingRulesInfoProgress",size:"xs",position:"absolute",color:"accent"}),!q&&r.a.createElement(Dn,{onSearch:re}),r.a.createElement(N.EuiSpacer,{size:"m"}),M&&!q&&!E&&r.a.createElement(Fa.a,{"data-test-subj":"loadingPanelAllRulesTable",overlay:!0,size:"xl"}),q?r.a.createElement(N.EuiLoadingContent,{"data-test-subj":"initialLoadingPanelAllRulesTable",lines:10}):r.a.createElement(r.a.Fragment,null,r.a.createElement(Sn,{hasBulkActions:!1,canBulkEdit:l,paginationTotal:null!==(e=A.length)&&void 0!==e?e:0,numberSelectedItems:0,onRefresh:ne}),r.a.createElement(N.EuiBasicTable,{"data-test-subj":"exceptions-table",columns:ae,isSelectable:l,itemId:"id",items:ue,noItemsMessage:ie,onChange:de,pagination:le})),r.a.createElement(_a,{blob:H.blob,name:`${H.name}.ndjson`,onDownload:ce}),r.a.createElement(Mn,{cancelText:en,confirmText:tn,contentText:T.contentText,onCancel:se,onClose:se,onConfirm:oe,references:T.rulesReferences,showModal:E,titleText:Za})))}));Si.displayName="ExceptionListsTable";const Oi=()=>r.a.createElement(s.TrackApplicationView,{viewId:o.cc.exceptions},r.a.createElement(Si,null),r.a.createElement(y.a,{pageName:o.cc.exceptions})),wi=()=>(Ca(Pa),r.a.createElement(P.Switch,null,r.a.createElement(R.Route,{path:o.xb,exact:!0,component:Oi}),r.a.createElement(R.Route,{component:_.a}))),ji=r.a.memo(wi),Ci=[{path:o.xb,render:()=>r.a.createElement(ji,null)}];var Ii=a(72),Mi=a(393),Ai=a(466),Di=a(751),qi=a(259),Pi=a(235),Ri=a(276),_i=a(52),Fi=a(85),Li=a.n(Fi),Ni=a(270),Bi=a(271),zi=a(816),Ui=a(65);const Hi=({disabled:e,hrefWithSearch:t,id:a,name:n,isSelected:s,isBeta:o})=>{const{getAppUrl:l,navigateTo:c}=Object(d.l)(),u=Object(i.useCallback)((e=>{e.preventDefault(),c({path:t}),Object(Ui.e)(Ui.a.CLICK,`${Ui.b.TAB_CLICKED}${a}`)}),[c,t,a]),p=l({path:t});return r.a.createElement(N.EuiTab,{"data-href":p,"data-test-subj":`navigation-${a}`,disabled:e,isSelected:s,href:p,onClick:u,append:o&&r.a.createElement(N.EuiBetaBadge,{label:ne.a,size:"s"})},n)},$i=r.a.memo(Hi),Vi=({display:e,navTabs:t,tabName:a})=>{const n=Object(i.useCallback)((()=>Object(E.getOr)("","id",Object.values(t).find((e=>a===e.id)))),[a,t]),[s,o]=Object(i.useState)(n());Object(i.useEffect)((()=>{const e=n();e!==s&&o(e)}),[a,t,n,s]);const{search:l}=Object(P.useLocation)(),c=Object(i.useMemo)((()=>Object.values(t).map((e=>{const t=s===e.id;return r.a.createElement($i,{key:`navigation-${e.id}`,id:e.id,hrefWithSearch:e.href+l,name:e.name,disabled:e.disabled,isSelected:t,isBeta:e.isBeta})}))),[t,s,l]);return r.a.createElement(N.EuiTabs,{display:e},c)};Vi.displayName="TabNavigationComponent";const Qi=r.a.memo(Vi,((e,t)=>e.display===t.display&&e.tabName===t.tabName&&Li()(e.navTabs,t.navTabs)));Qi.displayName="TabNavigation";const Wi=r.a.memo((({detailName:e,display:t,flowTarget:a,navTabs:n,pageName:s,pathName:o,search:l,state:c,tabName:u,urlState:p})=>{const{chrome:m,application:{getUrlForApp:g,navigateToUrl:f}}=Object(d.j)().services,b=Object(zi.a)();return Object(i.useEffect)((()=>{(o||s)&&b({detailName:e,flowTarget:a,navTabs:n,pageName:s,pathName:o,search:l,state:c,tabName:u},m,f)}),[m,s,o,l,n,c,e,a,u,g,f,b]),r.a.createElement(Qi,{query:p.query,display:t,filters:p.filters,navTabs:n,pageName:s,pathName:o,sourcerer:p.sourcerer,savedQuery:p.savedQuery,tabName:u,timeline:p.timeline,timerange:p.timerange})}));Wi.displayName="TabNavigationComponent";const Gi=Object(_i.compose)(Object(l.connect)(Bi.i))(r.a.memo(Wi,((e,t)=>e.pathName===t.pathName&&e.search===t.search&&Li()(e.navTabs,t.navTabs)&&Li()(e.urlState,t.urlState)&&Li()(e.state,t.state)))),Ki=r.a.memo((e=>{const[t]=Object(Ni.a)(),a={...t,...e};return r.a.createElement(Gi,a)}),((e,t)=>Li()(e.navTabs,t.navTabs)));Ki.displayName="SecuritySolutionTabNavigation";var Yi=a(341);const Ji={title:"[Host] User authentications - bar ",description:"",visualizationType:"lnsXY",state:{visualization:{axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!0},fittingFunction:"None",gridlinesVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},labelsOrientation:{x:0,yLeft:0,yRight:0},layers:[{accessors:["938b445a-a291-4bbc-84fe-4f47b69c20e4"],layerId:"31213ae3-905b-4e88-b987-0cccb1f3209f",layerType:"data",seriesType:"bar_horizontal_stacked",xAccessor:"430e690c-9992-414f-9bce-00812d99a5e7",yConfig:[]},{accessors:["c8165fc3-7180-4f1b-8c87-bc3ea04c6df7"],layerId:"b9acd453-f476-4467-ad38-203e37b73e55",layerType:"data",seriesType:"bar_horizontal_stacked",xAccessor:"e959c351-a3a2-4525-b244-9623f215a8fd",yConfig:[{color:"#e7664c",forAccessor:"c8165fc3-7180-4f1b-8c87-bc3ea04c6df7"}]}],legend:{isVisible:!1,position:"right",showSingleSeries:!1},preferredSeriesType:"bar_horizontal_stacked",tickLabelsVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},valueLabels:"hide",yLeftExtent:{mode:"full"},yRightExtent:{mode:"full"}},query:{language:"kuery",query:""},filters:[{$state:{store:"appState"},meta:{alias:null,disabled:!1,indexRefName:"filter-index-pattern-0",key:"query",negate:!1,type:"custom",value:'{"bool":{"filter":[{"term":{"event.category":"authentication"}}]}}'},query:{bool:{filter:[{term:{"event.category":"authentication"}}]}}}],datasourceStates:{indexpattern:{layers:{"31213ae3-905b-4e88-b987-0cccb1f3209f":{columnOrder:["430e690c-9992-414f-9bce-00812d99a5e7","938b445a-a291-4bbc-84fe-4f47b69c20e4"],columns:{"430e690c-9992-414f-9bce-00812d99a5e7":{dataType:"string",isBucketed:!0,label:"Filters",operationType:"filters",params:{filters:[{input:{language:"kuery",query:'event.outcome : "success" '},label:Yi.j}]},scale:"ordinal"},"938b445a-a291-4bbc-84fe-4f47b69c20e4":{dataType:"number",isBucketed:!1,label:Yi.j,operationType:"count",scale:"ratio",sourceField:"___records___"}},incompleteColumns:{}},"b9acd453-f476-4467-ad38-203e37b73e55":{columnOrder:["e959c351-a3a2-4525-b244-9623f215a8fd","c8165fc3-7180-4f1b-8c87-bc3ea04c6df7"],columns:{"c8165fc3-7180-4f1b-8c87-bc3ea04c6df7":{dataType:"number",isBucketed:!1,label:"Fail",operationType:"count",scale:"ratio",sourceField:"___records___"},"e959c351-a3a2-4525-b244-9623f215a8fd":{customLabel:!0,dataType:"string",isBucketed:!0,label:Yi.e,operationType:"filters",params:{filters:[{input:{language:"kuery",query:'event.outcome:"failure" '},label:Yi.e}]},scale:"ordinal"}},incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-31213ae3-905b-4e88-b987-0cccb1f3209f"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-b9acd453-f476-4467-ad38-203e37b73e55"}]};var Xi=a(19),Zi=a(211);const er=F.i18n.translate("xpack.securitySolution.hostsKpiAuthentications.errorSearchDescription",{defaultMessage:"An error has occurred on hosts kpi authentications search"}),tr=F.i18n.translate("xpack.securitySolution.hostsKpiAuthentications.failSearchDescription",{defaultMessage:"Failed to run search on hosts kpi authentications"});var ar=a(74);const nr="hostsKpiAuthenticationsQuery";var ir=a(50),rr=a.n(ir),sr=a(203),or=a(171),lr=a(299),cr=a(700),ur=a(370),dr=a(491),pr=a(290);const mr=e=>!!Object(E.get)("value.length",e)&&Object(E.get)("value",e).every((({x:e,y:t})=>!Object(E.isNull)(e)&&Object(E.isNumber)(t)&&t>0)),gr={tickLine:{visible:!1},tickLabel:{padding:3}},fr=({data:e,...t})=>{const a=Object(ur.h)(),n=Object(d.m)(),i=Object(E.get)("configs.axis.xTickFormatter",t),s=Object(E.get)("configs.axis.yTickFormatter",t),o=`group-${e[0].key}-x`,l=`group-${e[0].key}-y`,c={...ur.d,theme:a,...Object(E.get)("configs.settings",t)};return t.width&&t.height?r.a.createElement("div",{style:{height:t.height,width:t.width,position:"relative"}},r.a.createElement(or.Chart,null,r.a.createElement(or.Settings,c),e.map((e=>{const a=e.key;return mr(e)?r.a.createElement(or.AreaSeries,{id:a,key:a,name:e.key.replace("Histogram",""),data:e.value||[],xScaleType:Object(E.getOr)(or.ScaleType.Linear,"configs.series.xScaleType",t),yScaleType:Object(E.getOr)(or.ScaleType.Linear,"configs.series.yScaleType",t),timeZone:n,xAccessor:"x",yAccessors:["y"],areaSeriesStyle:{area:{opacity:.04,visible:!0},line:{strokeWidth:1,visible:!0},point:{visible:!1,radius:.2,strokeWidth:1,opacity:1}},color:e.color?e.color:void 0}):null})),r.a.createElement(or.Axis,{id:o,position:or.Position.Bottom,showOverlappingTicks:!1,tickFormat:i,style:gr}),r.a.createElement(or.Axis,{id:l,position:or.Position.Left,style:gr,tickFormat:s}))):null};fr.displayName="AreaChartBaseComponent";const br=r.a.memo(fr);br.displayName="AreaChartBase";const hr=({areaChart:e,configs:t,visualizationActionsOptions:a})=>{const{ref:n,width:s,height:o}=Object(lr.b)(),l=Object(E.get)("customHeight",t),c=Object(E.get)("customWidth",t),u=Object(ur.f)(l,o),d=Object(ur.g)(c,s),p=Object(i.useMemo)((()=>{return t=e,Array.isArray(t)&&t.some(mr);var t}),[e]);return r.a.createElement(ur.c,null,r.a.createElement(pr.a,{targetClassNames:[dr.a]},p&&e&&r.a.createElement(ur.a,{gutterSize:"none"},r.a.createElement(N.EuiFlexItem,{grow:!0},r.a.createElement(ur.b,{ref:n,height:u},r.a.createElement(br,{data:e,height:u,width:d,configs:t})))),!p&&r.a.createElement(cr.a,{height:u,width:d,data:e}),null!=a&&r.a.createElement(dr.b,rr()({},a,{className:"viz-actions"}))))},yr=r.a.memo(hr);var Er=a(452),vr=a(193),Tr=a(704);const kr=z()(N.EuiFlexGroup).withConfig({displayName:"FlexGroup",componentId:"sc-1rm4ik7-0"})([".no-margin{margin-top:0 !important;margin-bottom:0 !important;}"]),xr=z()(N.EuiFlexItem).withConfig({displayName:"FlexItem",componentId:"sc-1rm4ik7-1"})(["min-width:0;position:relative;"]);xr.displayName="FlexItem";const Sr=z()(N.EuiTitle).withConfig({displayName:"StatValue",componentId:"sc-1rm4ik7-2"})(["overflow:hidden;text-overflow:ellipsis;white-space:nowrap;"]);Sr.displayName="StatValue";const Or=e=>e.toLocaleString(),wr=e=>({series:{xScaleType:or.ScaleType.Time,yScaleType:or.ScaleType.Linear},axis:{xTickFormatter:Object(E.get)("xTickFormatter",e),yTickFormatter:Or},settings:{onBrushEnd:Object(E.getOr)((()=>{}),"onBrushEnd",e)},customHeight:74}),jr=(e,t)=>e.map((e=>({...e,value:Object(E.get)(e.key,t)}))),Cr=(e,t)=>e.filter((e=>null!=Object(E.get)(`${e.key}Histogram`,t))).map((({lensAttributes:e,...a})=>({...a,value:Object(E.get)(`${a.key}Histogram`,t),key:`${a.key}Histogram`}))),Ir=(e,t)=>0===e.length?[]:e.reduce(((a,n,i)=>{const{key:r,color:s}=n,o=Object(E.getOr)(null,r,t);return[...a,{key:r,color:s,value:[{x:Object(E.get)(`${i}.name`,e)||Object(E.getOr)("",`${i}.description`,e),y:o,g:r,y0:0}]}]}),[]),Mr=z.a.h6.withConfig({displayName:"StyledTitle",componentId:"sc-1rm4ik7-3"})(["line-height:200%;"]),Ar=r.a.memo((({areaChart:e,barChart:t,description:a,enableAreaChart:n,enableBarChart:s,fields:o,from:l,grow:c,id:u,loading:d=!1,showInspectButton:p=!0,index:m,narrowDateRange:g,statKey:f="item",to:b,barChartLensAttributes:h,areaChartLensAttributes:y,setQuerySkip:v})=>{const T=t&&t.length&&t.every((e=>null!=e.value&&e.value.length>0)),k=e&&e.length&&e.every((e=>null!=e.value&&e.value.length>0)),x=Object(i.useMemo)((()=>({from:l,to:b})),[l,b]),{toggleStatus:S,setToggleStatus:O}=Object(Ea.a)(u),w=Object(i.useCallback)((e=>{O(e),v(!e)}),[v,O]),j=Object(i.useCallback)((()=>w(!S)),[w,S]);return r.a.createElement(xr,{grow:c,"data-test-subj":`stat-${f}`},r.a.createElement(N.EuiPanel,{hasBorder:!0},r.a.createElement(kr,{gutterSize:"none"},r.a.createElement(N.EuiFlexItem,{className:S?"":"no-margin"},r.a.createElement(N.EuiFlexGroup,{gutterSize:"none",responsive:!1},r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiButtonIcon,{"aria-label":Tr.a(S),"data-test-subj":"query-toggle-stat",color:"text",display:"empty",iconType:S?"arrowDown":"arrowRight",onClick:j,size:"xs",title:Tr.a(S)})),r.a.createElement(N.EuiFlexItem,null,r.a.createElement(N.EuiTitle,{size:"xxxs"},r.a.createElement(Mr,null,a))))),p&&S&&!d&&r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(ca.b,{queryId:u,title:a,inspectIndex:m}))),d&&r.a.createElement(N.EuiFlexGroup,{justifyContent:"center",alignItems:"center"},r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiLoadingSpinner,{size:"l"}))),S&&!d&&r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiFlexGroup,null,o.map((e=>r.a.createElement(xr,{key:`stat-items-field-${e.key}`},r.a.createElement(N.EuiFlexGroup,{alignItems:"center",gutterSize:"m",responsive:!1},(k||T)&&e.icon&&r.a.createElement(xr,{grow:!1},r.a.createElement(N.EuiIcon,{type:e.icon,color:e.color,size:"l","data-test-subj":"stat-icon"})),r.a.createElement(xr,null,r.a.createElement(pr.a,{targetClassNames:[dr.a]},r.a.createElement(Sr,null,r.a.createElement("p",{"data-test-subj":"stat-title"},null!=e.value?e.value.toLocaleString():Object(vr.d)()," ",e.description)),e.lensAttributes&&x&&r.a.createElement(dr.b,{lensAttributes:e.lensAttributes,queryId:u,inspectIndex:m,timerange:x,title:a,className:"viz-actions"})))))))),(n||s)&&r.a.createElement(N.EuiHorizontalRule,null),r.a.createElement(N.EuiFlexGroup,null,s&&r.a.createElement(xr,null,r.a.createElement(Er.a,{barChart:t,configs:{series:{xScaleType:or.ScaleType.Ordinal,yScaleType:or.ScaleType.Linear,stackAccessors:["y0"]},axis:{xTickFormatter:Or},settings:{onElementClick:Object(E.getOr)((()=>{}),"onElementClick",undefined),rotation:90},customHeight:74},visualizationActionsOptions:{lensAttributes:h,queryId:u,inspectIndex:m,timerange:x,title:a}})),n&&null!=l&&null!=b&&r.a.createElement(r.a.Fragment,null,r.a.createElement(xr,null,r.a.createElement(yr,{areaChart:e,configs:wr({xTickFormatter:Object(lr.a)([l,b]),onBrushEnd:g}),visualizationActionsOptions:{lensAttributes:y,queryId:u,inspectIndex:m,timerange:x,title:a}})))))))}),((e,t)=>e.description===t.description&&e.enableAreaChart===t.enableAreaChart&&e.enableBarChart===t.enableBarChart&&e.from===t.from&&e.grow===t.grow&&e.loading===t.loading&&e.setQuerySkip===t.setQuerySkip&&e.id===t.id&&e.index===t.index&&e.narrowDateRange===t.narrowDateRange&&e.statKey===t.statKey&&e.to===t.to&&Li()(e.areaChart,t.areaChart)&&Li()(e.barChart,t.barChart)&&Li()(e.fields,t.fields)));Ar.displayName="StatItemsComponent",z()(N.EuiFlexGroup).withConfig({displayName:"FlexGroup",componentId:"sc-17i7jd7-0"})(["min-height:","px;"],247).displayName="FlexGroup";const Dr=r.a.memo((({fieldsMapping:e,data:t,id:a,loading:n=!1,from:i,to:s,narrowDateRange:o,setQuerySkip:l})=>{const c=((e,t,a,n,i,r,s,o)=>e.map((e=>({...e,areaChart:e.enableAreaChart?Cr(e.fields,t):void 0,barChart:e.enableBarChart?Ir(e.fields,t):void 0,fields:jr(e.fields,t),id:a,key:`kpi-summary-${e.key}`,statKey:`${e.key}`,from:n,to:i,narrowDateRange:r,setQuerySkip:s,loading:o}))))(e,t,a,i,s,o,l,n);return r.a.createElement(N.EuiFlexGroup,{wrap:!0},c.map((e=>r.a.createElement(Ar,rr()({},e,{showInspectButton:!1})))))}),((e,t)=>e.fieldsMapping===t.fieldsMapping&&e.id===t.id&&e.loading===t.loading&&e.from===t.from&&e.to===t.to&&e.narrowDateRange===t.narrowDateRange&&Li()(e.data,t.data)));Dr.displayName="KpiBaseComponent";const qr=Object(sr.a)(Dr);let Pr;!function(e){e.authenticationsSuccess="#54B399",e.authenticationsFailure="#E7664C",e.uniqueSourceIps="#D36086",e.uniqueDestinationIps="#9170B8",e.hosts="#6092C0"}(Pr||(Pr={}));const Rr=F.i18n.translate("xpack.securitySolution.kpiHosts.userAuthentications.title",{defaultMessage:"User authentications"}),_r=F.i18n.translate("xpack.securitySolution.kpiHosts.userAuthentications.successUnitLabel",{defaultMessage:"success"}),Fr=F.i18n.translate("xpack.securitySolution.kpiHosts.userAuthentications.failUnitLabel",{defaultMessage:"fail"}),Lr=F.i18n.translate("xpack.securitySolution.kpiHosts.userAuthentications.successChartLabel",{defaultMessage:"Succ."}),Nr=F.i18n.translate("xpack.securitySolution.kpiHosts.userAuthentications.failChartLabel",{defaultMessage:"Fail"}),Br=[{key:"authentication",fields:[{key:"authenticationsSuccess",name:Lr,description:_r,value:null,color:Pr.authenticationsSuccess,icon:"check",lensAttributes:{title:"[Host] User authentications - metric success ",description:"",visualizationType:"lnsMetric",state:{visualization:{accessor:"0eb97c09-a351-4280-97da-944e4bd30dd7",layerId:"4590dafb-4ac7-45aa-8641-47a3ff0b817c",layerType:"data"},query:{language:"kuery",query:""},filters:[{$state:{store:"appState"},meta:{alias:null,disabled:!1,indexRefName:"filter-index-pattern-0",key:"query",negate:!1,type:"custom",value:'{"bool":{"filter":[{"term":{"event.category":"authentication"}}]}}'},query:{bool:{filter:[{term:{"event.category":"authentication"}}]}}}],datasourceStates:{indexpattern:{layers:{"4590dafb-4ac7-45aa-8641-47a3ff0b817c":{columnOrder:["0eb97c09-a351-4280-97da-944e4bd30dd7"],columns:{"0eb97c09-a351-4280-97da-944e4bd30dd7":{customLabel:!0,dataType:"number",filter:{language:"kuery",query:'event.outcome : "success" '},isBucketed:!1,label:" ",operationType:"count",scale:"ratio",sourceField:"___records___"}},incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-4590dafb-4ac7-45aa-8641-47a3ff0b817c"}]}},{key:"authenticationsFailure",name:Nr,description:Fr,value:null,color:Pr.authenticationsFailure,icon:"cross",lensAttributes:{title:"[Host] User authentications - metric failure ",description:"",visualizationType:"lnsMetric",state:{visualization:{accessor:"0eb97c09-a351-4280-97da-944e4bd30dd7",layerId:"4590dafb-4ac7-45aa-8641-47a3ff0b817c",layerType:"data"},query:{language:"kuery",query:""},filters:[{$state:{store:"appState"},meta:{alias:null,disabled:!1,indexRefName:"filter-index-pattern-0",key:"query",negate:!1,type:"custom",value:'{"bool":{"filter":[{"term":{"event.category":"authentication"}}]}}'},query:{bool:{filter:[{term:{"event.category":"authentication"}}]}}}],datasourceStates:{indexpattern:{layers:{"4590dafb-4ac7-45aa-8641-47a3ff0b817c":{columnOrder:["0eb97c09-a351-4280-97da-944e4bd30dd7"],columns:{"0eb97c09-a351-4280-97da-944e4bd30dd7":{dataType:"number",filter:{language:"kuery",query:'event.outcome : "failure" '},isBucketed:!1,label:"",operationType:"count",scale:"ratio",sourceField:"___records___"}},incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-4590dafb-4ac7-45aa-8641-47a3ff0b817c"}]}}],enableAreaChart:!0,enableBarChart:!0,description:Rr,areaChartLensAttributes:{title:"[Host] User authentications - area ",description:"",visualizationType:"lnsXY",state:{visualization:{axisTitlesVisibilitySettings:{x:!0,yLeft:!1,yRight:!0},fittingFunction:"None",gridlinesVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},labelsOrientation:{x:0,yLeft:0,yRight:0},layers:[{accessors:["0eb97c09-a351-4280-97da-944e4bd30dd7"],layerId:"4590dafb-4ac7-45aa-8641-47a3ff0b817c",layerType:"data",seriesType:"area",xAccessor:"49a42fe6-ebe8-4adb-8eed-1966a5297b7e",yConfig:[{color:"#54b399",forAccessor:"0eb97c09-a351-4280-97da-944e4bd30dd7"}]},{accessors:["2b27c80e-a20d-46f1-8fb2-79626ef4563c"],layerId:"31213ae3-905b-4e88-b987-0cccb1f3209f",layerType:"data",seriesType:"area",xAccessor:"33a6163d-0c0a-451d-aa38-8ca6010dd5bf",yConfig:[{color:"#e7664c",forAccessor:"2b27c80e-a20d-46f1-8fb2-79626ef4563c"}]}],legend:{isVisible:!1,position:"right",showSingleSeries:!1},preferredSeriesType:"area",tickLabelsVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},valueLabels:"hide",yLeftExtent:{mode:"full"},yRightExtent:{mode:"full"}},query:{language:"kuery",query:""},filters:[{$state:{store:"appState"},meta:{alias:null,disabled:!1,indexRefName:"filter-index-pattern-0",key:"query",negate:!1,type:"custom",value:'{"bool":{"filter":[{"term":{"event.category":"authentication"}}]}}'},query:{bool:{filter:[{term:{"event.category":"authentication"}}]}}}],datasourceStates:{indexpattern:{layers:{"31213ae3-905b-4e88-b987-0cccb1f3209f":{columnOrder:["33a6163d-0c0a-451d-aa38-8ca6010dd5bf","2b27c80e-a20d-46f1-8fb2-79626ef4563c"],columns:{"2b27c80e-a20d-46f1-8fb2-79626ef4563c":{customLabel:!0,dataType:"number",filter:{language:"kuery",query:'event.outcome: "failure" '},isBucketed:!1,label:"Fail",operationType:"count",scale:"ratio",sourceField:"___records___"},"33a6163d-0c0a-451d-aa38-8ca6010dd5bf":{dataType:"date",isBucketed:!0,label:"@timestamp",operationType:"date_histogram",params:{interval:"auto"},scale:"interval",sourceField:"@timestamp"}},incompleteColumns:{}},"4590dafb-4ac7-45aa-8641-47a3ff0b817c":{columnOrder:["49a42fe6-ebe8-4adb-8eed-1966a5297b7e","0eb97c09-a351-4280-97da-944e4bd30dd7"],columns:{"0eb97c09-a351-4280-97da-944e4bd30dd7":{customLabel:!0,dataType:"number",filter:{language:"kuery",query:'event.outcome : "success" '},isBucketed:!1,label:"Succ.",operationType:"count",scale:"ratio",sourceField:"___records___"},"49a42fe6-ebe8-4adb-8eed-1966a5297b7e":{dataType:"date",isBucketed:!0,label:"@timestamp",operationType:"date_histogram",params:{interval:"auto"},scale:"interval",sourceField:"@timestamp"}},incompleteColumns:{}}}}}},references:[{type:"{dataViewId}",id:"security-solution-default",name:"indexpattern-datasource-current-indexpattern"},{type:"{dataViewId}",id:"security-solution-default",name:"indexpattern-datasource-layer-31213ae3-905b-4e88-b987-0cccb1f3209f"},{type:"{dataViewId}",id:"security-solution-default",name:"indexpattern-datasource-layer-4590dafb-4ac7-45aa-8641-47a3ff0b817c"}]},barChartLensAttributes:Ji}],zr=({filterQuery:e,from:t,indexNames:a,to:n,narrowDateRange:s,setQuery:o,skip:l})=>{const{toggleStatus:c}=Object(Ea.a)(nr),[u,p]=Object(i.useState)(l||!c);Object(i.useEffect)((()=>{p(l||!c)}),[l,c]);const[m,{refetch:g,id:f,inspect:b,...h}]=(({filterQuery:e,endDate:t,indexNames:a,skip:n=!1,startDate:r})=>{const{data:s}=Object(d.j)().services,o=Object(i.useRef)(E.noop),l=Object(i.useRef)(new AbortController),c=Object(i.useRef)(new Xi.Subscription),[u,p]=Object(i.useState)(!1),[m,g]=Object(i.useState)(null),[f,b]=Object(i.useState)({authenticationsSuccess:0,authenticationsSuccessHistogram:[],authenticationsFailure:0,authenticationsFailureHistogram:[],id:nr,inspect:{dsl:[],response:[]},isInspected:!1,refetch:o.current}),{addError:h,addWarning:y}=Object(X.a)(),v=Object(i.useCallback)((e=>{if(null==e||n)return;const t=async()=>{l.current=new AbortController,p(!0),c.current=s.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:l.current.signal}).subscribe({next:e=>{e.isPartial||e.isRunning?e.isPartial&&!e.isRunning&&(p(!1),y(er),c.current.unsubscribe()):(p(!1),b((t=>({...t,authenticationsSuccess:e.authenticationsSuccess,authenticationsSuccessHistogram:e.authenticationsSuccessHistogram,authenticationsFailure:e.authenticationsFailure,authenticationsFailureHistogram:e.authenticationsFailureHistogram,inspect:Object(ar.c)(e,t.inspect),refetch:o.current}))),c.current.unsubscribe())},error:e=>{p(!1),h(e,{title:tr}),c.current.unsubscribe()}})};c.current.unsubscribe(),l.current.abort(),t(),o.current=t}),[s.search,h,y,n]);return Object(i.useEffect)((()=>{g((n=>{const i={...null!=n?n:{},defaultIndex:a,factoryQueryType:Ii.g.kpiAuthentications,filterQuery:Object(Zi.a)(e),timerange:{interval:"12h",from:r,to:t}};return Li()(n,i)?n:i}))}),[a,t,e,r]),Object(i.useEffect)((()=>(v(m),()=>{c.current.unsubscribe(),l.current.abort()})),[m,v]),Object(i.useEffect)((()=>{n&&(p(!1),c.current.unsubscribe(),l.current.abort())}),[n]),[u,f]})({filterQuery:e,endDate:n,indexNames:a,startDate:t,skip:u});return r.a.createElement(qr,{data:h,id:f,inspect:b,loading:m,fieldsMapping:Br,from:t,to:n,narrowDateRange:s,refetch:g,setQuery:o,setQuerySkip:p})};zr.displayName="HostsKpiAuthenticationsComponent";const Ur=r.a.memo(zr),Hr=F.i18n.translate("xpack.securitySolution.hostsKpiHosts.errorSearchDescription",{defaultMessage:"An error has occurred on hosts kpi hosts search"}),$r=F.i18n.translate("xpack.securitySolution.hostsKpiHosts.failSearchDescription",{defaultMessage:"Failed to run search on hosts kpi hosts"}),Vr="hostsKpiHostsQuery",Qr=F.i18n.translate("xpack.securitySolution.kpiHosts.hosts.title",{defaultMessage:"Hosts"}),Wr=[{key:"hosts",fields:[{key:"hosts",value:null,color:Pr.hosts,icon:"storage",lensAttributes:{description:"",state:{datasourceStates:{indexpattern:{layers:{"416b6fad-1923-4f6a-a2df-b223bb287e30":{columnOrder:["b00c65ea-32be-4163-bfc8-f795b1ef9d06"],columns:{"b00c65ea-32be-4163-bfc8-f795b1ef9d06":{customLabel:!0,dataType:"number",isBucketed:!1,label:" ",operationType:"unique_count",scale:"ratio",sourceField:"host.name"}},incompleteColumns:{}}}}},filters:[],query:{language:"kuery",query:""},visualization:{accessor:"b00c65ea-32be-4163-bfc8-f795b1ef9d06",layerId:"416b6fad-1923-4f6a-a2df-b223bb287e30",layerType:"data"}},title:"[Host] Hosts - metric",visualizationType:"lnsMetric",references:[{id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-416b6fad-1923-4f6a-a2df-b223bb287e30",type:"index-pattern"}]}}],enableAreaChart:!0,description:Qr,areaChartLensAttributes:{description:"",state:{datasourceStates:{indexpattern:{layers:{"416b6fad-1923-4f6a-a2df-b223bb287e30":{columnOrder:["5eea817b-67b7-4268-8ecb-7688d1094721","b00c65ea-32be-4163-bfc8-f795b1ef9d06"],columns:{"5eea817b-67b7-4268-8ecb-7688d1094721":{dataType:"date",isBucketed:!0,label:"@timestamp",operationType:"date_histogram",params:{interval:"auto"},scale:"interval",sourceField:"@timestamp"},"b00c65ea-32be-4163-bfc8-f795b1ef9d06":{customLabel:!0,dataType:"number",isBucketed:!1,label:" ",operationType:"unique_count",scale:"ratio",sourceField:"host.name"}},incompleteColumns:{}}}}},filters:[],query:{language:"kuery",query:""},visualization:{axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!1},fittingFunction:"None",gridlinesVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},labelsOrientation:{x:0,yLeft:0,yRight:0},layers:[{accessors:["b00c65ea-32be-4163-bfc8-f795b1ef9d06"],layerId:"416b6fad-1923-4f6a-a2df-b223bb287e30",layerType:"data",seriesType:"area",xAccessor:"5eea817b-67b7-4268-8ecb-7688d1094721"}],legend:{isVisible:!0,position:"right"},preferredSeriesType:"area",tickLabelsVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},valueLabels:"hide",yLeftExtent:{mode:"full"},yRightExtent:{mode:"full"}}},title:"[Host] Hosts - area",visualizationType:"lnsXY",references:[{id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-416b6fad-1923-4f6a-a2df-b223bb287e30",type:"index-pattern"}]}}],Gr=({filterQuery:e,from:t,indexNames:a,to:n,narrowDateRange:s,setQuery:o,skip:l})=>{const{toggleStatus:c}=Object(Ea.a)(Vr),[u,p]=Object(i.useState)(l||!c);Object(i.useEffect)((()=>{p(l||!c)}),[l,c]);const[m,{refetch:g,id:f,inspect:b,...h}]=(({filterQuery:e,endDate:t,indexNames:a,skip:n=!1,startDate:r})=>{const{data:s}=Object(d.j)().services,o=Object(i.useRef)(E.noop),l=Object(i.useRef)(new AbortController),c=Object(i.useRef)(new Xi.Subscription),[u,p]=Object(i.useState)(!1),[m,g]=Object(i.useState)(null),[f,b]=Object(i.useState)({hosts:0,hostsHistogram:[],id:Vr,inspect:{dsl:[],response:[]},isInspected:!1,refetch:o.current}),{addError:h,addWarning:y}=Object(X.a)(),v=Object(i.useCallback)((e=>{if(null==e||n)return;const t=async()=>{l.current=new AbortController,p(!0),c.current=s.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:l.current.signal}).subscribe({next:e=>{e.isPartial||e.isRunning?e.isPartial&&!e.isRunning&&(p(!1),y(Hr),c.current.unsubscribe()):(p(!1),b((t=>({...t,hosts:e.hosts,hostsHistogram:e.hostsHistogram,inspect:Object(ar.c)(e,t.inspect),refetch:o.current}))),c.current.unsubscribe())},error:e=>{p(!1),h(e,{title:$r}),c.current.unsubscribe()}})};c.current.unsubscribe(),l.current.abort(),t(),o.current=t}),[s.search,h,y,n]);return Object(i.useEffect)((()=>{g((n=>{const i={...null!=n?n:{},defaultIndex:a,factoryQueryType:Ii.g.kpiHosts,filterQuery:Object(Zi.a)(e),timerange:{interval:"12h",from:r,to:t}};return Li()(n,i)?n:i}))}),[a,t,e,r]),Object(i.useEffect)((()=>(v(m),()=>{c.current.unsubscribe(),l.current.abort()})),[m,v]),Object(i.useEffect)((()=>{n&&(p(!1),c.current.unsubscribe(),l.current.abort())}),[n]),[u,f]})({filterQuery:e,endDate:n,indexNames:a,startDate:t,skip:u});return r.a.createElement(qr,{data:h,id:f,inspect:b,loading:m,fieldsMapping:Wr,from:t,to:n,narrowDateRange:s,refetch:g,setQuery:o,setQuerySkip:p})},Kr=r.a.memo(Gr),Yr={description:"",state:{datasourceStates:{indexpattern:{layers:{"8be0156b-d423-4a39-adf1-f54d4c9f2e69":{columnOrder:["a0cb6400-f708-46c3-ad96-24788f12dae4","d9a6eb6b-8b78-439e-98e7-a718f8ffbebe"],columns:{"a0cb6400-f708-46c3-ad96-24788f12dae4":{dataType:"date",isBucketed:!0,label:"@timestamp",operationType:"date_histogram",params:{interval:"auto"},scale:"interval",sourceField:"@timestamp"},"d9a6eb6b-8b78-439e-98e7-a718f8ffbebe":{customLabel:!0,dataType:"number",isBucketed:!1,label:Yi.i,operationType:"unique_count",scale:"ratio",sourceField:"source.ip"}},incompleteColumns:{}},"ca05ecdb-0fa4-49a8-9305-b23d91012a46":{columnOrder:["f95e74e6-99dd-4b11-8faf-439b4d959df9","e7052671-fb9e-481f-8df3-7724c98cfc6f"],columns:{"e7052671-fb9e-481f-8df3-7724c98cfc6f":{customLabel:!0,dataType:"number",isBucketed:!1,label:Yi.d,operationType:"unique_count",scale:"ratio",sourceField:"destination.ip"},"f95e74e6-99dd-4b11-8faf-439b4d959df9":{dataType:"date",isBucketed:!0,label:"@timestamp",operationType:"date_histogram",params:{interval:"auto"},scale:"interval",sourceField:"@timestamp"}},incompleteColumns:{}}}}},filters:[],query:{language:"kuery",query:""},visualization:{axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!0},fittingFunction:"None",gridlinesVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},labelsOrientation:{x:0,yLeft:0,yRight:0},layers:[{accessors:["d9a6eb6b-8b78-439e-98e7-a718f8ffbebe"],layerId:"8be0156b-d423-4a39-adf1-f54d4c9f2e69",layerType:"data",seriesType:"area",xAccessor:"a0cb6400-f708-46c3-ad96-24788f12dae4",yConfig:[{color:"#d36186",forAccessor:"d9a6eb6b-8b78-439e-98e7-a718f8ffbebe"}]},{accessors:["e7052671-fb9e-481f-8df3-7724c98cfc6f"],layerId:"ca05ecdb-0fa4-49a8-9305-b23d91012a46",layerType:"data",seriesType:"area",xAccessor:"f95e74e6-99dd-4b11-8faf-439b4d959df9",yConfig:[{color:"#9170b8",forAccessor:"e7052671-fb9e-481f-8df3-7724c98cfc6f"}]}],legend:{isVisible:!1,position:"right",showSingleSeries:!1},preferredSeriesType:"area",tickLabelsVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},valueLabels:"hide",yLeftExtent:{mode:"full"},yRightExtent:{mode:"full"}}},title:"[Host] Unique IPs - area",visualizationType:"lnsXY",references:[{id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-8be0156b-d423-4a39-adf1-f54d4c9f2e69",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-ca05ecdb-0fa4-49a8-9305-b23d91012a46",type:"index-pattern"}],type:"lens",updated_at:"2022-02-09T17:44:03.359Z",version:"WzI5MTI5OSwzXQ=="},Jr={description:"",state:{datasourceStates:{indexpattern:{layers:{"8be0156b-d423-4a39-adf1-f54d4c9f2e69":{columnOrder:["f8bfa719-5c1c-4bf2-896e-c318d77fc08e","32f66676-f4e1-48fd-b7f8-d4de38318601"],columns:{"32f66676-f4e1-48fd-b7f8-d4de38318601":{dataType:"number",isBucketed:!1,label:"Unique count of source.ip",operationType:"unique_count",scale:"ratio",sourceField:"source.ip"},"f8bfa719-5c1c-4bf2-896e-c318d77fc08e":{dataType:"string",isBucketed:!0,label:"Filters",operationType:"filters",params:{filters:[{input:{language:"kuery",query:""},label:Yi.i}]},scale:"ordinal"}},incompleteColumns:{}},"ec84ba70-2adb-4647-8ef0-8ad91a0e6d4e":{columnOrder:["c72aad6a-fc9c-43dc-9194-e13ca3ee8aff","b7e59b08-96e6-40d1-84fd-e97b977d1c47"],columns:{"b7e59b08-96e6-40d1-84fd-e97b977d1c47":{dataType:"number",isBucketed:!1,label:"Unique count of destination.ip",operationType:"unique_count",scale:"ratio",sourceField:"destination.ip"},"c72aad6a-fc9c-43dc-9194-e13ca3ee8aff":{customLabel:!0,dataType:"string",isBucketed:!0,label:Yi.d,operationType:"filters",params:{filters:[{input:{language:"kuery",query:""},label:"Dest."}]},scale:"ordinal"}},incompleteColumns:{}}}}},filters:[],query:{language:"kuery",query:""},visualization:{axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!0},fittingFunction:"None",gridlinesVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},labelsOrientation:{x:0,yLeft:0,yRight:0},layers:[{accessors:["32f66676-f4e1-48fd-b7f8-d4de38318601"],layerId:"8be0156b-d423-4a39-adf1-f54d4c9f2e69",layerType:"data",seriesType:"bar_horizontal_stacked",xAccessor:"f8bfa719-5c1c-4bf2-896e-c318d77fc08e",yConfig:[{color:"#d36186",forAccessor:"32f66676-f4e1-48fd-b7f8-d4de38318601"}]},{accessors:["b7e59b08-96e6-40d1-84fd-e97b977d1c47"],layerId:"ec84ba70-2adb-4647-8ef0-8ad91a0e6d4e",layerType:"data",seriesType:"bar_horizontal_stacked",xAccessor:"c72aad6a-fc9c-43dc-9194-e13ca3ee8aff",yConfig:[{color:"#9170b8",forAccessor:"b7e59b08-96e6-40d1-84fd-e97b977d1c47"}]}],legend:{isVisible:!1,position:"right",showSingleSeries:!1},preferredSeriesType:"bar_horizontal_stacked",tickLabelsVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},valueLabels:"hide",yLeftExtent:{mode:"full"},yRightExtent:{mode:"full"}}},title:"[Host] Unique IPs - bar",visualizationType:"lnsXY",references:[{id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-8be0156b-d423-4a39-adf1-f54d4c9f2e69",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-ec84ba70-2adb-4647-8ef0-8ad91a0e6d4e",type:"index-pattern"}]},Xr=F.i18n.translate("xpack.securitySolution.hostsKpiUniqueIps.errorSearchDescription",{defaultMessage:"An error has occurred on hosts kpi unique ips search"}),Zr=F.i18n.translate("xpack.securitySolution.hostsKpiUniqueIps.failSearchDescription",{defaultMessage:"Failed to run search on hosts kpi unique ips"}),es="hostsKpiUniqueIpsQuery",ts=F.i18n.translate("xpack.securitySolution.kpiHosts.uniqueIps.title",{defaultMessage:"Unique IPs"}),as=F.i18n.translate("xpack.securitySolution.kpiHosts.uniqueIps.sourceUnitLabel",{defaultMessage:"source"}),ns=F.i18n.translate("xpack.securitySolution.kpiHosts.uniqueIps.destinationUnitLabel",{defaultMessage:"destination"}),is=F.i18n.translate("xpack.securitySolution.kpiHosts.uniqueIps.sourceChartLabel",{defaultMessage:"Src."}),rs=F.i18n.translate("xpack.securitySolution.kpiHosts.uniqueIps.destinationChartLabel",{defaultMessage:"Dest."}),ss=[{key:"uniqueIps",fields:[{key:"uniqueSourceIps",name:is,description:as,value:null,color:Pr.uniqueSourceIps,icon:"visMapCoordinate",lensAttributes:{description:"",state:{datasourceStates:{indexpattern:{layers:{"8be0156b-d423-4a39-adf1-f54d4c9f2e69":{columnOrder:["d9a6eb6b-8b78-439e-98e7-a718f8ffbebe"],columns:{"d9a6eb6b-8b78-439e-98e7-a718f8ffbebe":{customLabel:!0,dataType:"number",isBucketed:!1,label:" ",operationType:"unique_count",scale:"ratio",sourceField:"source.ip"}},incompleteColumns:{}}}}},filters:[],query:{language:"kuery",query:""},visualization:{accessor:"d9a6eb6b-8b78-439e-98e7-a718f8ffbebe",layerId:"8be0156b-d423-4a39-adf1-f54d4c9f2e69",layerType:"data"}},title:"[Host] Unique IPs - source metric",visualizationType:"lnsMetric",references:[{id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-8be0156b-d423-4a39-adf1-f54d4c9f2e69",type:"index-pattern"}]}},{key:"uniqueDestinationIps",name:rs,description:ns,value:null,color:Pr.uniqueDestinationIps,icon:"visMapCoordinate",lensAttributes:{description:"",state:{datasourceStates:{indexpattern:{layers:{"8be0156b-d423-4a39-adf1-f54d4c9f2e69":{columnOrder:["d9a6eb6b-8b78-439e-98e7-a718f8ffbebe"],columns:{"d9a6eb6b-8b78-439e-98e7-a718f8ffbebe":{customLabel:!0,dataType:"number",isBucketed:!1,label:" ",operationType:"unique_count",scale:"ratio",sourceField:"destination.ip"}},incompleteColumns:{}}}}},filters:[],query:{language:"kuery",query:""},visualization:{accessor:"d9a6eb6b-8b78-439e-98e7-a718f8ffbebe",layerId:"8be0156b-d423-4a39-adf1-f54d4c9f2e69",layerType:"data"}},title:"[Host] Unique IPs - destination metric",visualizationType:"lnsMetric",references:[{id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-8be0156b-d423-4a39-adf1-f54d4c9f2e69",type:"index-pattern"}]}}],enableAreaChart:!0,enableBarChart:!0,description:ts,areaChartLensAttributes:Yr,barChartLensAttributes:Jr}],os=({filterQuery:e,from:t,indexNames:a,to:n,narrowDateRange:s,setQuery:o,skip:l})=>{const{toggleStatus:c}=Object(Ea.a)(es),[u,p]=Object(i.useState)(l||!c);Object(i.useEffect)((()=>{p(l||!c)}),[l,c]);const[m,{refetch:g,id:f,inspect:b,...h}]=(({filterQuery:e,endDate:t,indexNames:a,skip:n=!1,startDate:r})=>{const{data:s}=Object(d.j)().services,o=Object(i.useRef)(E.noop),l=Object(i.useRef)(new AbortController),c=Object(i.useRef)(new Xi.Subscription),[u,p]=Object(i.useState)(!1),[m,g]=Object(i.useState)(null),[f,b]=Object(i.useState)({uniqueSourceIps:0,uniqueSourceIpsHistogram:[],uniqueDestinationIps:0,uniqueDestinationIpsHistogram:[],id:es,inspect:{dsl:[],response:[]},isInspected:!1,refetch:o.current}),{addError:h,addWarning:y}=Object(X.a)(),v=Object(i.useCallback)((e=>{if(null==e||n)return;const t=async()=>{l.current=new AbortController,p(!0),c.current=s.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:l.current.signal}).subscribe({next:e=>{e.isPartial||e.isRunning?e.isPartial&&!e.isRunning&&(p(!1),y(Xr),c.current.unsubscribe()):(p(!1),b((t=>({...t,uniqueSourceIps:e.uniqueSourceIps,uniqueSourceIpsHistogram:e.uniqueSourceIpsHistogram,uniqueDestinationIps:e.uniqueDestinationIps,uniqueDestinationIpsHistogram:e.uniqueDestinationIpsHistogram,inspect:Object(ar.c)(e,t.inspect),refetch:o.current}))),c.current.unsubscribe())},error:e=>{p(!1),h(e,{title:Zr}),c.current.unsubscribe()}})};c.current.unsubscribe(),l.current.abort(),t(),o.current=t}),[s.search,h,y,n]);return Object(i.useEffect)((()=>{g((n=>{const i={...null!=n?n:{},defaultIndex:a,factoryQueryType:Ii.g.kpiUniqueIps,filterQuery:Object(Zi.a)(e),timerange:{interval:"12h",from:r,to:t}};return Li()(n,i)?n:i}))}),[a,t,e,n,r]),Object(i.useEffect)((()=>(v(m),()=>{c.current.unsubscribe(),l.current.abort()})),[m,v]),Object(i.useEffect)((()=>{n&&(p(!1),c.current.unsubscribe(),l.current.abort())}),[n]),[u,f]})({filterQuery:e,endDate:n,indexNames:a,startDate:t,skip:u});return r.a.createElement(qr,{data:h,id:f,inspect:b,loading:m,fieldsMapping:ss,from:t,to:n,narrowDateRange:s,refetch:g,setQuery:o,setQuerySkip:p})},ls=r.a.memo(os);var cs=a(455);const us=F.i18n.translate("xpack.securitySolution.kpiHost.learnMore",{defaultMessage:"Learn more about"}),ds=F.i18n.translate("xpack.securitySolution.kpiHost.hostRiskData",{defaultMessage:"host risk data"}),ps=F.i18n.translate("xpack.securitySolution.kpiHost.enableHostRiskText",{defaultMessage:"Enable host risk module to see more data"});var ms=a(268);const gs=r.a.memo((({filterQuery:e,from:t,indexNames:a,to:n,setQuery:i,skip:s,narrowDateRange:o})=>{const[l,{isModuleEnabled:c}]=Object(ms.c)({}),u=Object(Z.a)("usersEnabled");return r.a.createElement(r.a.Fragment,null,!1===c&&r.a.createElement(r.a.Fragment,null,r.a.createElement(wt,{namespace:"hosts",condition:!0,message:{type:"primary",id:"hostRiskModule",title:ps,description:r.a.createElement(r.a.Fragment,null,us," ",r.a.createElement(N.EuiLink,{href:cs.a,target:"_blank"},ds),r.a.createElement(N.EuiSpacer,null))}}),r.a.createElement(N.EuiSpacer,{size:"l"})),r.a.createElement(N.EuiFlexGroup,{wrap:!0},r.a.createElement(N.EuiFlexItem,{grow:1},r.a.createElement(Kr,{filterQuery:e,from:t,indexNames:a,to:n,narrowDateRange:o,setQuery:i,skip:s})),!u&&r.a.createElement(N.EuiFlexItem,{grow:2},r.a.createElement(Ur,{filterQuery:e,from:t,indexNames:a,to:n,narrowDateRange:o,setQuery:i,skip:s})),r.a.createElement(N.EuiFlexItem,{grow:2},r.a.createElement(ls,{filterQuery:e,from:t,indexNames:a,to:n,narrowDateRange:o,setQuery:i,skip:s}))))}));gs.displayName="HostsKpiComponent";const fs=r.a.memo((({filterQuery:e,from:t,indexNames:a,to:n,setQuery:i,skip:s,narrowDateRange:o})=>{const l=Object(Z.a)("usersEnabled");return r.a.createElement(N.EuiFlexGroup,{wrap:!0},!l&&r.a.createElement(N.EuiFlexItem,{grow:1},r.a.createElement(Ur,{filterQuery:e,from:t,indexNames:a,to:n,narrowDateRange:o,setQuery:i,skip:s})),r.a.createElement(N.EuiFlexItem,{grow:1},r.a.createElement(ls,{filterQuery:e,from:t,indexNames:a,to:n,narrowDateRange:o,setQuery:i,skip:s})))}));fs.displayName="HostsDetailsKpiComponent";var bs=a(804),hs=a(231),ys=a(451),Es=a(225),vs=a(391),Ts=a(392),ks=a(353),xs=a(258),Ss=a(470),Os=a(624);var ws=a(418);const js=(e,t)=>"host.name"===e.entityName&&(null==t||e.entityValue===t);var Cs=a(560);const Is=(e,t)=>e===Es.HostsType.details&&null!=t?[{fieldName:"host.name",fieldValue:t}]:[];var Ms=a(312),As=a(561);const Ds={sort:{field:"anomaly.severity",direction:"desc"}},qs=({startDate:e,endDate:t,hostName:a,skip:n,type:s})=>{const o=Object(Pi.a)(),{toggleStatus:l,setToggleStatus:c}=Object(Ea.a)("AnomaliesHostTable"),[u,d]=Object(i.useState)(n||!l);Object(i.useEffect)((()=>{d(n||!l)}),[n,l]);const p=Object(i.useCallback)((e=>{c(e),d(!e)}),[d,c]),[m,g]=Object(Ts.a)({startDate:e,endDate:t,skip:u,criteriaFields:Is(s,a),filterQuery:{exists:{field:"host.name"}}}),f=((e,t)=>null==e?[]:e.anomalies.reduce(((e,a)=>{if(js(a,t))return[...e,{hostName:a.entityValue,anomaly:a}];{const n=((e=[],t)=>{const a=e.find((e=>{const[a,n]=Object(ws.a)(e);return"host.name"===a&&(null==t||n===t)}));return null!=a?Object.values(a)[0]:null})(a.influencers,t);return null!=n?[...e,{hostName:n,anomaly:a}]:e}}),[]))(g,a),b=((e,t,a)=>{const n=((e,t)=>[{name:ks.d,field:"hostName",sortable:!0,render:(e,t)=>Object(xs.b)({rowItem:e,attrName:"host.name",idPrefix:`anomalies-host-table-hostName-${Object(Ss.a)(t.anomaly)}-hostName`,render:e=>r.a.createElement(ut.d,{hostName:e}),isAggregatable:!0,fieldType:"keyword"})},...Object(Os.a)(e,t)])(t,a);return e===Es.HostsType.details?n.filter((e=>e.name!==ks.d)):n})(s,e,t),h={initialPageIndex:0,initialPageSize:10,totalItemCount:f.length,pageSizeOptions:[5,10,20,50],showPerPageOptions:!0};return Object(qi.a)(o)?r.a.createElement(Ms.a,{loading:m},r.a.createElement(la.a,{subtitle:`${ks.h}: ${h.totalItemCount.toLocaleString()} ${ks.k(h.totalItemCount)}`,title:ks.a,toggleQuery:p,toggleStatus:l,tooltip:ks.j,isInspectDisabled:n}),l&&r.a.createElement(Cs.a,{"data-test-subj":"host-anomalies-table",columns:b,items:f,pagination:h,sorting:Ds}),m&&r.a.createElement(Fa.a,{"data-test-subj":"anomalies-host-table-loading-panel",overlay:!0,size:"xl"})):null},Ps=r.a.memo(qs,As.a);var Rs=a(428),_s=a(525),Fs=a(326),Ls=a(262);const Ns=F.i18n.translate("xpack.securitySolution.authenticationsTable.authentications",{defaultMessage:"Authentications"}),Bs=e=>F.i18n.translate("xpack.securitySolution.authenticationsTable.usersUnit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {user} other {users}}"}),zs=e=>F.i18n.translate("xpack.securitySolution.authenticationsTable.hostsUnit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {host} other {hosts}}"}),Us=F.i18n.translate("xpack.securitySolution.authenticationsTable.lastSuccessfulSource",{defaultMessage:"Last successful source"}),Hs=F.i18n.translate("xpack.securitySolution.authenticationsTable.lastSuccessfulDestination",{defaultMessage:"Last successful destination"}),$s=F.i18n.translate("xpack.securitySolution.authenticationsTable.lastSuccessfulTime",{defaultMessage:"Last success"}),Vs=F.i18n.translate("xpack.securitySolution.authenticationsTable.lastFailedSource",{defaultMessage:"Last failed source"}),Qs=F.i18n.translate("xpack.securitySolution.authenticationsTable.lastFailedDestination",{defaultMessage:"Last failed destination"}),Ws=F.i18n.translate("xpack.securitySolution.authenticationsTable.lastFailedTime",{defaultMessage:"Last failure"}),Gs=F.i18n.translate("xpack.securitySolution.authenticationsTable.successes",{defaultMessage:"Successes"}),Ks=F.i18n.translate("xpack.securitySolution.authenticationsTable.failures",{defaultMessage:"Failures"}),Ys=F.i18n.translate("xpack.securitySolution.authenticationsTable.user",{defaultMessage:"User"}),Js=F.i18n.translate("xpack.securitySolution.authenticationsTable.host",{defaultMessage:"Host"}),Xs=F.i18n.translate("xpack.securitySolution.authenticationsTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),Zs=F.i18n.translate("xpack.securitySolution.authenticationsTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),eo=F.i18n.translate("xpack.securitySolution.hosts.navigation.authenticationsTitle",{defaultMessage:"Authentications"}),to=F.i18n.translate("xpack.securitySolution.hosts.navigaton.matrixHistogram.errorFetchingAuthenticationsData",{defaultMessage:"Failed to query authentications data"});var ao;const no=e=>[mo(e),fo,ro,so,oo,lo,co,uo,po],io=[{text:Xs,numberOfRow:5},{text:Zs,numberOfRow:10}],ro={name:Ks,field:"node.failures",truncateText:!1,mobileOptions:{show:!0},width:"8%"},so={name:$s,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>{var t,a;return Object(E.has)("lastSuccess.timestamp",e)&&null!=(null===(t=e.lastSuccess)||void 0===t?void 0:t.timestamp)?r.a.createElement(wn.b,{value:null===(a=e.lastSuccess)||void 0===a?void 0:a.timestamp}):Object(vr.d)()}},oo={name:Us,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>{var t,a;return Object(xs.c)({rowItems:(null===(t=e.lastSuccess)||void 0===t||null===(a=t.source)||void 0===a?void 0:a.ip)||null,isAggregatable:!0,fieldType:"ip",attrName:"source.ip",idPrefix:`authentications-table-${e._id}-lastSuccessSource`,render:e=>r.a.createElement(ut.h,{ip:e})})}},lo={name:Hs,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>{var t,a,n;return Object(xs.c)({rowItems:null!==(t=null===(a=e.lastSuccess)||void 0===a||null===(n=a.host)||void 0===n?void 0:n.name)&&void 0!==t?t:null,isAggregatable:!0,fieldType:"keyword",attrName:"host.name",idPrefix:`authentications-table-${e._id}-lastSuccessfulDestination`,render:e=>r.a.createElement(ut.d,{hostName:e})})}},co={name:Ws,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>{var t,a;return Object(E.has)("lastFailure.timestamp",e)&&null!=(null===(t=e.lastFailure)||void 0===t?void 0:t.timestamp)?r.a.createElement(wn.b,{value:null===(a=e.lastFailure)||void 0===a?void 0:a.timestamp}):Object(vr.d)()}},uo={name:Vs,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>{var t,a;return Object(xs.c)({rowItems:(null===(t=e.lastFailure)||void 0===t||null===(a=t.source)||void 0===a?void 0:a.ip)||null,isAggregatable:!0,fieldType:"ip",attrName:"source.ip",idPrefix:`authentications-table-${e._id}-lastFailureSource`,render:e=>r.a.createElement(ut.h,{ip:e})})}},po={name:Qs,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>{var t,a;return Object(xs.c)({rowItems:(null===(t=e.lastFailure)||void 0===t||null===(a=t.host)||void 0===a?void 0:a.name)||null,attrName:"host.name",idPrefix:`authentications-table-${e._id}-lastFailureDestination`,render:e=>r.a.createElement(ut.d,{hostName:e}),isAggregatable:!0,fieldType:"ip"})}},mo=e=>({name:Ys,truncateText:!1,mobileOptions:{show:!0},render:({node:t})=>Object(xs.c)({rowItems:t.stackedValue,attrName:"user.name",isAggregatable:!0,fieldType:"keyword",idPrefix:`authentications-table-${t._id}-userName`,render:t=>e?r.a.createElement(ut.m,{userName:t}):r.a.createElement(r.a.Fragment,null,t)})}),go={name:Js,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>Object(xs.c)({rowItems:e.stackedValue,attrName:"host.name",isAggregatable:!0,fieldType:"keyword",idPrefix:`authentications-table-${e._id}-hostName`,render:e=>r.a.createElement(ut.d,{hostName:e})})},fo={name:Gs,field:"node.successes",truncateText:!1,mobileOptions:{show:!0},width:"8%"},bo=[{text:"event.outcome",value:"event.outcome"}];var ho;let yo;!function(e){e.authenticationsSuccess="success",e.authenticationsFailure="failure"}(ho||(ho={})),function(e){e.authenticationsSuccess="#54B399",e.authenticationsFailure="#E7664C"}(yo||(yo={}));const Eo={[ho.authenticationsSuccess]:{key:ho.authenticationsSuccess,value:null,color:yo.authenticationsSuccess},[ho.authenticationsFailure]:{key:ho.authenticationsFailure,value:null,color:yo.authenticationsFailure}},vo={defaultStackByOption:null!==(ao=bo.find((e=>"event.outcome"===e.text)))&&void 0!==ao?ao:bo[0],errorMessage:to,histogramType:Ii.j.authentications,mapping:Eo,stackByOptions:bo,title:eo,lensAttributes:{title:"Authentication",description:"",visualizationType:"lnsXY",state:{visualization:{title:"Empty XY chart",legend:{isVisible:!0,position:"right"},valueLabels:"hide",preferredSeriesType:"bar_stacked",layers:[{layerId:"3fd0c5d5-f762-4a27-8c56-14eee0223e13",accessors:["5417777d-d9d9-4268-9cdc-eb29b873bd65"],position:"top",seriesType:"bar_stacked",showGridlines:!1,layerType:"data",xAccessor:"b41a2958-650b-470a-84c4-c6fd8f0c6d37",yConfig:[{forAccessor:"5417777d-d9d9-4268-9cdc-eb29b873bd65",color:"#54b399"}]},{layerId:"bef502be-e5ff-442f-9e3e-229f86ca2afa",seriesType:"bar_stacked",accessors:["a3bf9dc1-c8d2-42d6-9e60-31892a4c509e"],layerType:"data",xAccessor:"cded27f7-8ef8-458c-8d9b-70db48ae340d",yConfig:[{forAccessor:"a3bf9dc1-c8d2-42d6-9e60-31892a4c509e",color:"#da8b45"}]}],yRightExtent:{mode:"full"},yLeftExtent:{mode:"full"},axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!0}},query:{query:"",language:"kuery"},filters:[{meta:{index:"6f4dbdc7-35b6-4e20-ac53-1272167e3919",type:"custom",disabled:!1,negate:!1,alias:null,key:"query",value:'{"bool":{"must":[{"term":{"event.category":"authentication"}}]}}'},$state:{store:"appState"},query:{bool:{must:[{term:{"event.category":"authentication"}}]}}}],datasourceStates:{indexpattern:{layers:{"3fd0c5d5-f762-4a27-8c56-14eee0223e13":{columns:{"b41a2958-650b-470a-84c4-c6fd8f0c6d37":{label:"@timestamp",dataType:"date",operationType:"date_histogram",sourceField:"@timestamp",isBucketed:!0,scale:"interval",params:{interval:"auto"}},"5417777d-d9d9-4268-9cdc-eb29b873bd65":{label:"Success",dataType:"number",operationType:"count",isBucketed:!1,scale:"ratio",sourceField:"___records___",filter:{query:'event.outcome : "success"',language:"kuery"},customLabel:!0}},columnOrder:["b41a2958-650b-470a-84c4-c6fd8f0c6d37","5417777d-d9d9-4268-9cdc-eb29b873bd65"],incompleteColumns:{}},"bef502be-e5ff-442f-9e3e-229f86ca2afa":{columns:{"cded27f7-8ef8-458c-8d9b-70db48ae340d":{label:"@timestamp",dataType:"date",operationType:"date_histogram",sourceField:"@timestamp",isBucketed:!0,scale:"interval",params:{interval:"auto"}},"a3bf9dc1-c8d2-42d6-9e60-31892a4c509e":{label:"Failure",dataType:"number",operationType:"count",isBucketed:!1,scale:"ratio",sourceField:"___records___",filter:{query:'event.outcome : "failure"',language:"kuery"},customLabel:!0}},columnOrder:["cded27f7-8ef8-458c-8d9b-70db48ae340d","a3bf9dc1-c8d2-42d6-9e60-31892a4c509e"],incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-3fd0c5d5-f762-4a27-8c56-14eee0223e13"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-bef502be-e5ff-442f-9e3e-229f86ca2afa"},{type:"index-pattern",name:"6f4dbdc7-35b6-4e20-ac53-1272167e3919",id:"{dataViewId}"}]}};var To=a(96),ko=a(294);const xo=F.i18n.translate("xpack.securitySolution.authentications.errorSearchDescription",{defaultMessage:"An error has occurred on authentications search"}),So=F.i18n.translate("xpack.securitySolution.authentications.failSearchDescription",{defaultMessage:"Failed to run search on authentications"}),Oo=({docValueFields:e,filterQuery:t,endDate:a,indexNames:n,startDate:r,activePage:s,limit:o,skip:l,stackByField:c})=>{const{data:u}=Object(d.j)().services,p=Object(i.useRef)(E.noop),m=Object(i.useRef)(new AbortController),g=Object(i.useRef)(new Xi.Subscription),[f,b]=Object(i.useState)(!1),[h,y]=Object(i.useState)(null),{addError:v,addWarning:T}=Object(X.a)(),k=Object(i.useCallback)((e=>{y((t=>t?{...t,pagination:Object(ko.a)(e,o)}:t))}),[o]),[x,S]=Object(i.useState)({authentications:[],inspect:{dsl:[],response:[]},isInspected:!1,loading:!0,loadPage:k,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1},refetch:p.current,totalCount:-1}),O=Object(i.useCallback)((e=>{if(null==e||l)return;const t=async()=>{m.current=new AbortController,b(!0),g.current=u.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:m.current.signal}).subscribe({next:e=>{Object(K.isCompleteResponse)(e)?(b(!1),S((t=>({...t,authentications:e.edges,inspect:Object(ar.c)(e,t.inspect),pageInfo:e.pageInfo,refetch:p.current,totalCount:e.totalCount}))),g.current.unsubscribe()):Object(K.isErrorResponse)(e)&&(b(!1),T(xo),g.current.unsubscribe())},error:e=>{b(!1),v(e,{title:So}),g.current.unsubscribe()}})};g.current.unsubscribe(),m.current.abort(),t(),p.current=t}),[u.search,v,T,l]);return Object(i.useEffect)((()=>{y((i=>{const l={...null!=i?i:{},defaultIndex:n,docValueFields:null!=e?e:[],factoryQueryType:To.u.authentications,filterQuery:Object(Zi.a)(t),stackByField:c,pagination:Object(ko.a)(s,o),timerange:{interval:"12h",from:r,to:a},sort:{}};return Li()(i,l)?i:l}))}),[s,e,a,t,n,c,o,r]),Object(i.useEffect)((()=>(O(h),()=>{g.current.unsubscribe(),m.current.abort()})),[h,O]),Object(i.useEffect)((()=>{l&&(b(!1),g.current.unsubscribe(),m.current.abort())}),[l]),[f,x]};var wo=a(283);const jo="authenticationsHostsTableQuery",Co=wo.b.HostsTableType.authentications,Io=({docValueFields:e,endDate:t,filterQuery:a,indexNames:n,skip:s,startDate:o,type:c,setQuery:u,deleteQuery:d})=>{const p=Object(Z.a)("usersEnabled"),m=Object(l.useDispatch)(),{toggleStatus:g}=Object(Ea.a)(jo),[f,b]=Object(i.useState)(s||!g);Object(i.useEffect)((()=>{b(s||!g)}),[s,g]);const h=wo.d.authenticationsSelector(),{activePage:y,limit:T}=Object(v.a)((e=>h(e,c))),[k,{authentications:x,totalCount:S,pageInfo:O,loadPage:w,inspect:j,isInspected:C,refetch:I}]=Oo({docValueFields:e,endDate:t,filterQuery:a,indexNames:n,skip:f,startDate:o,stackByField:Ii.a.userName,activePage:y,limit:T}),M=c===wo.b.HostsType.details?(e=>[mo(e),fo,ro,so,oo,co,uo])(p):no(p),A=Object(i.useCallback)((e=>m(wo.a.updateTableLimit({hostsType:c,limit:e,tableType:Co}))),[c,m]),D=Object(i.useCallback)((e=>m(wo.a.updateTableActivePage({activePage:e,hostsType:c,tableType:Co}))),[c,m]);return Object(sr.b)({queryId:jo,loading:k,refetch:I,setQuery:u,deleteQuery:d,inspect:j}),r.a.createElement(Ls.a,{activePage:y,columns:M,dataTestSubj:"authentications-host-table",headerCount:S,headerTitle:Ns,headerUnit:Bs(S),id:jo,isInspect:C,itemsPerRow:io,limit:T,loading:k,loadPage:w,pageOfItems:x,setQuerySkip:b,showMorePagesIndicator:Object(E.getOr)(!1,"showMorePagesIndicator",O),totalCount:Object(E.getOr)(50,"fakeTotalCount",O),updateLimitPagination:A,updateActivePage:D})};Io.displayName="AuthenticationsHostTableComponent";const Mo=r.a.memo(Io),Ao=({deleteQuery:e,docValueFields:t,endDate:a,filterQuery:n,indexNames:i,skip:s,setQuery:o,startDate:l,type:c})=>r.a.createElement(r.a.Fragment,null,r.a.createElement(Fs.a,rr()({endDate:a,filterQuery:n,id:"authenticationsHistogramQuery",indexNames:i,setQuery:o,startDate:l},vo)),r.a.createElement(Mo,{endDate:a,filterQuery:n,indexNames:i,setQuery:o,deleteQuery:e,startDate:l,type:c,skip:s,docValueFields:t}));Ao.displayName="AuthenticationsQueryTabBodyComponent";const Do=r.a.memo(Ao);Do.displayName="AuthenticationsQueryTabBody";const qo=F.i18n.translate("xpack.securitySolution.allHost.errorSearchDescription",{defaultMessage:"An error has occurred on all hosts search"}),Po=F.i18n.translate("xpack.securitySolution.allHost.failSearchDescription",{defaultMessage:"Failed to run search on all hosts"}),Ro=(F.i18n.translate("xpack.securitySolution.hostOverview.errorSearchDescription",{defaultMessage:"An error has occurred on host overview search"}),F.i18n.translate("xpack.securitySolution.hostOverview.failSearchDescription",{defaultMessage:"Failed to run search on host overview"}),"hostsAllQuery");var _o=a(242),Fo=a(204),Lo=a(30),No=a(249);const Bo=F.i18n.translate("xpack.securitySolution.hostsTable.hostsTitle",{defaultMessage:"All hosts"}),zo=e=>F.i18n.translate("xpack.securitySolution.hostsTable.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {host} other {hosts}}"}),Uo=(F.i18n.translate("xpack.securitySolution.hostsRiskTable.tableTitle",{defaultMessage:"Host risk"}),F.i18n.translate("xpack.securitySolution.hostsTable.nameTitle",{defaultMessage:"Host name"})),Ho=F.i18n.translate("xpack.securitySolution.hostsTable.lastSeenTitle",{defaultMessage:"Last seen"}),$o=F.i18n.translate("xpack.securitySolution.hostsTable.firstLastSeenToolTip",{defaultMessage:"Relative to the selected date range"}),Vo=F.i18n.translate("xpack.securitySolution.hostsTable.hostRiskToolTip",{defaultMessage:"Host risk classifcation is determined by host risk score. Hosts classified as Critical or High are indicated as risky."}),Qo=F.i18n.translate("xpack.securitySolution.hostsTable.osLastSeenToolTip",{defaultMessage:"Last observed operating system"}),Wo=F.i18n.translate("xpack.securitySolution.hostsTable.osTitle",{defaultMessage:"Operating system"}),Go=F.i18n.translate("xpack.securitySolution.hostsTable.versionTitle",{defaultMessage:"Version"}),Ko=F.i18n.translate("xpack.securitySolution.hostsTable.hostRiskTitle",{defaultMessage:"Host risk classification"}),Yo=F.i18n.translate("xpack.securitySolution.hostsTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),Jo=F.i18n.translate("xpack.securitySolution.hostsTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),Xo=F.i18n.translate("xpack.securitySolution.hostsRiskTable.hostNameTitle",{defaultMessage:"Host Name"}),Zo=F.i18n.translate("xpack.securitySolution.hostsRiskTable.hostRiskScoreTitle",{defaultMessage:"Host risk score"}),el=F.i18n.translate("xpack.securitySolution.hostsRiskTable.riskTitle",{defaultMessage:"Host risk classification"}),tl=F.i18n.translate("xpack.securitySolution.hostsRiskTable.hostRiskToolTip",{defaultMessage:"Host risk classification is determined by host risk score. Hosts classified as Critical or High are indicated as risky."}),al=F.i18n.translate("xpack.securitySolution.hostsRiskTable.hostRiskTitle",{defaultMessage:"Host risk"}),nl=F.i18n.translate("xpack.securitySolution.hostsRiskTable.hostsTableTitle",{defaultMessage:"The host risk table is not affected by the KQL time range. This table shows the latest recorded risk score for each host."}),il=e=>F.i18n.translate("xpack.securitySolution.hostsRiskTable.filteredHostsTitle",{values:{severity:e},defaultMessage:"View {severity} risk hosts"});var rl=a(275),sl=a(103),ol=a(91);const ll=wo.b.HostsTableType.hosts,cl=[{text:Yo,numberOfRow:5},{text:Jo,numberOfRow:10}],ul=({data:e,fakeTotalCount:t,id:a,isInspect:n,loading:s,loadPage:c,setQuerySkip:u,showMorePagesIndicator:d,totalCount:p,type:m})=>{const g=Object(l.useDispatch)(),{navigateTo:f}=Object(ol.h)(),b=Object(i.useMemo)((()=>wo.d.hostsSelector()),[]),{activePage:h,direction:y,limit:E,sortField:T}=Object(v.a)((e=>b(e,m))),k=Object(i.useCallback)((e=>g(wo.a.updateTableLimit({hostsType:m,limit:e,tableType:ll}))),[m,g]),x=Object(i.useCallback)((e=>g(wo.a.updateTableActivePage({activePage:e,hostsType:m,tableType:ll}))),[m,g]),S=Object(i.useCallback)((e=>{if(null!=e.sort){const t={field:dl(e.sort.field),direction:e.sort.direction};t.direction===y&&t.field===T||g(wo.a.updateHostsSort({sort:t,hostsType:m}))}}),[y,T,m,g]),O=Object(Z.a)("riskyHostsEnabled"),w=Object(i.useCallback)((e=>{g(wo.a.updateHostRiskScoreSeverityFilter({severitySelection:[e],hostsType:m})),f({deepLinkId:o.cc.hosts,path:Es.HostsTableType.risk})}),[g,f,m]),j=Object(i.useMemo)((()=>((e,t)=>{const a=[{field:"node.host.name",name:Uo,truncateText:!1,mobileOptions:{show:!0},sortable:!0,render:e=>{if(null!=e&&e.length>0){const t=Object(Fo.h)(`hosts-table-hostName-${e[0]}`);return r.a.createElement(_o.b,{key:t,dataProvider:{and:[],enabled:!0,excluded:!1,id:t,name:e[0],kqlQuery:"",queryMatch:{field:"host.name",value:e[0],operator:Lo.c}},isAggregatable:!0,fieldType:"keyword",render:(t,a,n)=>n.isDragging?r.a.createElement(_o.a,null,r.a.createElement(No.a,{dataProvider:t})):r.a.createElement(ut.d,{hostName:e[0]})})}return Object(vr.d)()},width:"35%"},{field:"node.lastSeen",name:r.a.createElement(N.EuiToolTip,{content:$o},r.a.createElement(r.a.Fragment,null,Ho," ",r.a.createElement(N.EuiIcon,{color:"subdued",type:"iInCircle",className:"eui-alignTop"}))),truncateText:!1,mobileOptions:{show:!0},sortable:!0,render:e=>null!=e&&e.length>0?r.a.createElement(wn.b,{value:Array.isArray(e)?e[0]:e}):Object(vr.d)()},{field:"node.host.os.name",name:r.a.createElement(N.EuiToolTip,{content:Qo},r.a.createElement(r.a.Fragment,null,Wo," ",r.a.createElement(N.EuiIcon,{color:"subdued",type:"iInCircle",className:"eui-alignTop"}))),truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:e=>null!=e?r.a.createElement(ma.b,{id:`host-page-draggable-host.os.name-${e[0]}`,field:"host.os.name",value:e[0],isDraggable:!1,hideTopN:!0,tooltipContent:null}):Object(vr.d)()},{field:"node.host.os.version",name:Go,truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:e=>null!=e?r.a.createElement(ma.b,{id:`host-page-draggable-host.os.version-${e[0]}`,field:"host.os.version",value:e[0],isDraggable:!1,hideTopN:!0,tooltipContent:null}):Object(vr.d)()}];return e&&a.push({field:"node.risk",name:r.a.createElement(N.EuiToolTip,{content:Vo},r.a.createElement(r.a.Fragment,null,Ko," ",r.a.createElement(N.EuiIcon,{color:"subdued",type:"iInCircle",className:"eui-alignTop"}))),truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:e=>null!=e?r.a.createElement(rl.b,{toolTipContent:r.a.createElement(N.EuiLink,{onClick:()=>t(e)},r.a.createElement(N.EuiText,{size:"xs"},il(e.toLowerCase()))),severity:e}):Object(vr.d)()}),a})(O,w)),[w,O]),C=Object(i.useMemo)((()=>((e,t)=>({field:pl(e),direction:t}))(T,y)),[T,y]);return r.a.createElement(Ls.a,{activePage:h,columns:j,dataTestSubj:`table-${ll}`,headerCount:p,headerTitle:Bo,headerUnit:zo(p),id:a,isInspect:n,itemsPerRow:cl,limit:E,loading:s,loadPage:c,onChange:S,pageOfItems:e,setQuerySkip:u,showMorePagesIndicator:d,sorting:C,totalCount:t,updateLimitPagination:k,updateActivePage:x})};ul.displayName="HostsTableComponent";const dl=e=>"node.host.name"===e?sl.b.hostName:sl.b.lastSeen,pl=e=>{switch(e){case sl.b.hostName:return"node.host.name";case sl.b.lastSeen:return"node.lastSeen"}},ml=r.a.memo(ul);ml.displayName="HostsTable";const gl=Object(sr.a)(ml),fl=({deleteQuery:e,docValueFields:t,endDate:a,filterQuery:n,indexNames:s,skip:o,setQuery:l,startDate:c,type:u})=>{const{toggleStatus:p}=Object(Ea.a)(Ro),[m,g]=Object(i.useState)(o||!p);Object(i.useEffect)((()=>{g(o||!p)}),[o,p]);const[f,{hosts:b,totalCount:h,pageInfo:y,loadPage:T,id:k,inspect:x,isInspected:S,refetch:O}]=(({docValueFields:e,filterQuery:t,endDate:a,indexNames:n,skip:r=!1,startDate:s,type:o})=>{const l=Object(i.useMemo)((()=>wo.d.hostsSelector()),[]),{activePage:c,direction:u,limit:p,sortField:m}=Object(v.a)((e=>l(e,o))),{data:g}=Object(d.j)().services,f=Object(i.useRef)(E.noop),b=Object(i.useRef)(new AbortController),h=Object(i.useRef)(new Xi.Subscription),[y,T]=Object(i.useState)(!1),[k,x]=Object(i.useState)(null),{addError:S,addWarning:O}=Object(X.a)(),w=Object(i.useCallback)((e=>{x((t=>t?{...t,pagination:Object(ko.a)(e,p)}:t))}),[p]),[j,C]=Object(i.useState)({endDate:a,hosts:[],id:Ro,inspect:{dsl:[],response:[]},isInspected:!1,loadPage:w,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1},refetch:f.current,startDate:s,totalCount:-1}),I=Object(i.useCallback)((e=>{if(null==e||r)return;const t=async()=>{b.current=new AbortController,T(!0),h.current=g.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:b.current.signal}).subscribe({next:e=>{Object(K.isCompleteResponse)(e)?(T(!1),C((t=>({...t,hosts:e.edges,inspect:Object(ar.c)(e,t.inspect),pageInfo:e.pageInfo,refetch:f.current,totalCount:e.totalCount}))),h.current.unsubscribe()):Object(K.isErrorResponse)(e)&&(T(!1),O(qo),h.current.unsubscribe())},error:e=>{T(!1),S(e,{title:Po}),h.current.unsubscribe()}})};h.current.unsubscribe(),b.current.abort(),t(),f.current=t}),[g.search,S,O,r]);return Object(i.useEffect)((()=>{x((i=>{const r={...null!=i?i:{},defaultIndex:n,docValueFields:null!=e?e:[],factoryQueryType:Ii.h.hosts,filterQuery:Object(Zi.a)(t),pagination:Object(ko.a)(c,p),timerange:{interval:"12h",from:s,to:a},sort:{direction:u,field:m}};return Li()(i,r)?i:r}))}),[c,u,e,a,t,n,p,s,m]),Object(i.useEffect)((()=>(I(k),()=>{h.current.unsubscribe(),b.current.abort()})),[k,I]),Object(i.useEffect)((()=>{r&&(T(!1),h.current.unsubscribe(),b.current.abort())}),[r]),[y,j]})({docValueFields:t,endDate:a,filterQuery:n,indexNames:s,skip:m,startDate:c,type:u});return r.a.createElement(gl,{deleteQuery:e,data:b,fakeTotalCount:Object(E.getOr)(50,"fakeTotalCount",y),id:k,inspect:x,isInspect:S,loading:f,loadPage:T,refetch:O,setQuery:l,setQuerySkip:g,showMorePagesIndicator:Object(E.getOr)(!1,"showMorePagesIndicator",y),totalCount:h,type:u})};fl.displayName="HostsQueryTabBody";const bl=F.i18n.translate("xpack.securitySolution.uncommonProcesses.errorSearchDescription",{defaultMessage:"An error has occurred on uncommon processes search"}),hl=F.i18n.translate("xpack.securitySolution.uncommonProcesses.failSearchDescription",{defaultMessage:"Failed to run search on uncommon processes"}),yl="hostsUncommonProcessesQuery",El=F.i18n.translate("xpack.securitySolution.authenticationsTable.uncommonProcessTable",{defaultMessage:"Uncommon processes"}),vl=e=>F.i18n.translate("xpack.securitySolution.uncommonProcessTable.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {process} other {processes}}"}),Tl=F.i18n.translate("xpack.securitySolution.uncommonProcessTable.hostsTitle",{defaultMessage:"Host names"}),kl=F.i18n.translate("xpack.securitySolution.uncommonProcessTable.numberOfHostsTitle",{defaultMessage:"Hosts"}),xl=F.i18n.translate("xpack.securitySolution.uncommonProcessTable.numberOfInstances",{defaultMessage:"Instances"}),Sl=F.i18n.translate("xpack.securitySolution.uncommonProcessTable.lastCommandTitle",{defaultMessage:"Last command"}),Ol=F.i18n.translate("xpack.securitySolution.uncommonProcessTable.lastUserTitle",{defaultMessage:"Last user"}),wl=F.i18n.translate("xpack.securitySolution.uncommonProcessTable.nameTitle",{defaultMessage:"Process name"}),jl=F.i18n.translate("xpack.securitySolution.uncommonProcessTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),Cl=F.i18n.translate("xpack.securitySolution.uncommonProcessTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),Il=wo.b.HostsTableType.uncommonProcesses,Ml=[{text:jl,numberOfRow:5},{text:Cl,numberOfRow:10}],Al=r.a.memo((({data:e,fakeTotalCount:t,id:a,isInspect:n,loading:s,loadPage:o,totalCount:c,setQuerySkip:u,showMorePagesIndicator:d,type:p})=>{const m=Object(l.useDispatch)(),g=Object(i.useMemo)((()=>wo.d.uncommonProcessesSelector()),[]),{activePage:f,limit:b}=Object(v.a)((e=>g(e,p))),h=Object(i.useCallback)((e=>m(wo.a.updateTableLimit({hostsType:p,limit:e,tableType:Il}))),[p,m]),y=Object(i.useCallback)((e=>m(wo.a.updateTableActivePage({activePage:e,hostsType:p,tableType:Il}))),[p,m]),E=Object(i.useMemo)((()=>Pl(p)),[p]);return r.a.createElement(Ls.a,{activePage:f,columns:E,dataTestSubj:`table-${Il}`,headerCount:c,headerTitle:El,headerUnit:vl(c),id:a,isInspect:n,itemsPerRow:Ml,limit:b,loading:s,loadPage:o,pageOfItems:e,setQuerySkip:u,showMorePagesIndicator:d,totalCount:t,updateLimitPagination:h,updateActivePage:y})}));Al.displayName="UncommonProcessTableComponent";const Dl=r.a.memo(Al);Dl.displayName="UncommonProcessTable";const ql=e=>null!=e.hosts?e.hosts.filter((e=>null!=e.name&&null!=e.name[0])).map((e=>null!=e.name&&null!=e.name[0]?e.name[0]:"")):[],Pl=e=>{const t=[{name:wl,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>Object(xs.c)({rowItems:e.process.name,attrName:"process.name",idPrefix:`uncommon-process-table-${e._id}-processName`,isAggregatable:!0,fieldType:"keyword"}),width:"20%"},{align:"right",name:kl,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>r.a.createElement(r.a.Fragment,null,null!=e.hosts?e.hosts.length:Object(vr.e)()),width:"8%"},{align:"right",name:xl,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>Object(vr.a)(e.instances),width:"8%"},{name:Tl,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>Object(xs.c)({rowItems:ql(e),attrName:"host.name",idPrefix:`uncommon-process-table-${e._id}-processHost`,render:e=>r.a.createElement(ut.d,{hostName:e}),isAggregatable:!0,fieldType:"keyword"}),width:"25%"},{name:Sl,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>Object(xs.c)({rowItems:null!=e.process?e.process.args:null,attrName:"process.args",idPrefix:`uncommon-process-table-${e._id}-processArgs`,displayCount:1,isAggregatable:!0,fieldType:"keyword"}),width:"25%"},{name:Ol,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>Object(xs.c)({rowItems:null!=e.user?e.user.name:null,attrName:"user.name",idPrefix:`uncommon-process-table-${e._id}-processUser`,isAggregatable:!0,fieldType:"keyword"})}];return e===Es.HostsType.details?[Tl,kl].reduce(((e,t)=>(e.splice(e.findIndex((e=>e.name===t)),1),e)),t):t},Rl=Object(sr.a)(Dl),_l=({deleteQuery:e,docValueFields:t,endDate:a,filterQuery:n,indexNames:s,skip:o,setQuery:l,startDate:c,type:u})=>{const{toggleStatus:p}=Object(Ea.a)(yl),[m,g]=Object(i.useState)(o||!p);Object(i.useEffect)((()=>{g(o||!p)}),[o,p]);const[f,{uncommonProcesses:b,totalCount:h,pageInfo:y,loadPage:T,id:k,inspect:x,isInspected:S,refetch:O}]=(({docValueFields:e,filterQuery:t,endDate:a,indexNames:n,skip:r=!1,startDate:s,type:o})=>{const l=Object(i.useMemo)((()=>wo.d.uncommonProcessesSelector()),[]),{activePage:c,limit:u}=Object(v.a)((e=>l(e,o))),{data:p}=Object(d.j)().services,m=Object(i.useRef)(E.noop),g=Object(i.useRef)(new AbortController),f=Object(i.useRef)(new Xi.Subscription),[b,h]=Object(i.useState)(!1),[y,T]=Object(i.useState)(null),{addError:k,addWarning:x}=Object(X.a)(),S=Object(i.useCallback)((e=>{T((t=>t?{...t,pagination:Object(ko.a)(e,u)}:t))}),[u]),[O,w]=Object(i.useState)({uncommonProcesses:[],id:yl,inspect:{dsl:[],response:[]},isInspected:!1,loadPage:S,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1},refetch:m.current,totalCount:-1}),j=Object(i.useCallback)((e=>{if(null==e||r)return;const t=async()=>{g.current=new AbortController,h(!0),f.current=p.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:g.current.signal}).subscribe({next:e=>{Object(K.isCompleteResponse)(e)?(h(!1),w((t=>({...t,uncommonProcesses:e.edges,inspect:Object(ar.c)(e,t.inspect),pageInfo:e.pageInfo,refetch:m.current,totalCount:e.totalCount}))),f.current.unsubscribe()):Object(K.isErrorResponse)(e)&&(h(!1),x(bl),f.current.unsubscribe())},error:e=>{h(!1),k(e,{title:hl}),f.current.unsubscribe()}})};f.current.unsubscribe(),g.current.abort(),t(),m.current=t}),[p.search,k,x,r]);return Object(i.useEffect)((()=>{T((i=>{const r={...null!=i?i:{},defaultIndex:n,docValueFields:null!=e?e:[],factoryQueryType:Ii.h.uncommonProcesses,filterQuery:Object(Zi.a)(t),pagination:Object(ko.a)(c,u),timerange:{interval:"12h",from:s,to:a},sort:{}};return Li()(i,r)?i:r}))}),[c,n,e,a,t,u,s]),Object(i.useEffect)((()=>(j(y),()=>{f.current.unsubscribe(),g.current.abort()})),[y,j]),Object(i.useEffect)((()=>{r&&(h(!1),f.current.unsubscribe(),g.current.abort())}),[r]),[b,O]})({docValueFields:t,endDate:a,filterQuery:n,indexNames:s,skip:m,startDate:c,type:u});return r.a.createElement(Rl,{deleteQuery:e,data:b,fakeTotalCount:Object(E.getOr)(50,"fakeTotalCount",y),id:k,inspect:x,isInspect:S,loading:f,loadPage:T,refetch:O,setQuery:l,setQuerySkip:g,showMorePagesIndicator:Object(E.getOr)(!1,"showMorePagesIndicator",y),totalCount:h,type:u})};_l.dispalyName="UncommonProcessQueryTabBody";var Fl=a(649),Ll=a(381);const Nl=F.i18n.translate("xpack.securitySolution.alertsView.alertsDocumentType",{defaultMessage:"External alerts"}),Bl=F.i18n.translate("xpack.securitySolution.alertsView.totalCountOfAlerts",{defaultMessage:"external alerts"}),zl=F.i18n.translate("xpack.securitySolution.alertsView.alertsTableTitle",{defaultMessage:"External alerts"}),Ul=F.i18n.translate("xpack.securitySolution.alertsView.alertsGraphTitle",{defaultMessage:"External alert trend"}),Hl=(F.i18n.translate("xpack.securitySolution.alertsView.alertsStackByOptions.module",{defaultMessage:"module"}),F.i18n.translate("xpack.securitySolution.alertsView.showing",{defaultMessage:"Showing"})),$l=e=>F.i18n.translate("xpack.securitySolution.alertsView.unit",{values:{totalCount:e},defaultMessage:"external {totalCount, plural, =1 {alert} other {alerts}}"}),Vl=F.i18n.translate("xpack.securitySolution.alertsView.errorFetchingAlertsData",{defaultMessage:"Failed to query alerts data"}),Ql=(F.i18n.translate("xpack.securitySolution.alertsView.categoryLabel",{defaultMessage:"category"}),F.i18n.translate("xpack.securitySolution.alertsView.moduleLabel",{defaultMessage:"module"}),[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:"event.kind",params:{query:"alert"}},query:{bool:{filter:[{bool:{should:[{match:{"event.kind":"alert"}}],minimum_should_match:1}}]}}}]),Wl=({timelineId:e,endDate:t,entityType:a="alerts",startDate:n,pageFilters:s=[]})=>{const o=Object(l.useDispatch)(),c=Object(i.useMemo)((()=>[...Ql,...s]),[s]),{filterManager:u}=Object(d.j)().services.data.query,m=Object(Z.a)("tGridEnabled");Object(i.useEffect)((()=>{o(p.a.initializeTGridSettings({id:e,documentType:Nl,filterManager:u,defaultColumns:Fl.a.columns.map((e=>m||null!=e.initialWidth?e:{...e,initialWidth:ie.a})),excludedRowRendererIds:Fl.a.excludedRowRendererIds,footerText:Bl,title:zl}))}),[o,u,m,e]);const f=Object(i.useMemo)((()=>Object(re.a)(5)),[]);return r.a.createElement(Y.a,{pageFilters:c,defaultModel:Fl.a,defaultCellActions:te.a,end:t,entityType:a,id:e,leadingControlColumns:f,renderCellValue:Ll.a,rowRenderers:se.b,scopeId:g.SourcererScopeName.default,start:n})},Gl=r.a.memo(Wl);var Kl,Yl=a(107);const Jl=[{text:"event.category",value:"event.category"},{text:"event.module",value:"event.module"}],Xl={defaultStackByOption:null!==(Kl=Jl.find((e=>"event.module"===e.text)))&&void 0!==Kl?Kl:Jl[1],errorMessage:Vl,histogramType:Yl.b.alerts,stackByOptions:Jl,subtitle:void 0,title:Ul,getLensAttributes:(e="event.module")=>({title:"External alerts",description:"",visualizationType:"lnsXY",state:{visualization:{title:"Empty XY chart",legend:{isVisible:!0,position:"right"},valueLabels:"hide",preferredSeriesType:"bar_stacked",layers:[{layerId:"a3c54471-615f-4ff9-9fda-69b5b2ea3eef",accessors:["0a923af2-c880-4aa3-aa93-a0b9c2801f6d"],position:"top",seriesType:"bar_stacked",showGridlines:!1,layerType:"data",xAccessor:"37bdf546-3c11-4b08-8c5d-e37debc44f1d",splitAccessor:"42334c6e-98d9-47a2-b4cb-a445abb44c93"}],yRightExtent:{mode:"full"},yLeftExtent:{mode:"full"}},query:{query:"",language:"kuery"},filters:[{meta:{index:"a04472fc-94a3-4b8d-ae05-9d30ea8fbd6a",alias:null,negate:!1,disabled:!1,type:"phrase",key:"event.kind",params:{query:"alert"}},query:{match_phrase:{"event.kind":"alert"}},$state:{store:"appState"}}],datasourceStates:{indexpattern:{layers:{"a3c54471-615f-4ff9-9fda-69b5b2ea3eef":{columns:{"37bdf546-3c11-4b08-8c5d-e37debc44f1d":{label:"@timestamp",dataType:"date",operationType:"date_histogram",sourceField:"@timestamp",isBucketed:!0,scale:"interval",params:{interval:"auto"}},"0a923af2-c880-4aa3-aa93-a0b9c2801f6d":{label:"Count of records",dataType:"number",operationType:"count",isBucketed:!1,scale:"ratio",sourceField:"___records___"},"42334c6e-98d9-47a2-b4cb-a445abb44c93":{label:`Top values of ${e}`,dataType:"string",operationType:"terms",scale:"ordinal",sourceField:`${e}`,isBucketed:!0,params:{size:10,orderBy:{type:"column",columnId:"0a923af2-c880-4aa3-aa93-a0b9c2801f6d"},orderDirection:"desc",otherBucket:!0,missingBucket:!1,parentFormat:{id:"terms"}}}},columnOrder:["42334c6e-98d9-47a2-b4cb-a445abb44c93","37bdf546-3c11-4b08-8c5d-e37debc44f1d","0a923af2-c880-4aa3-aa93-a0b9c2801f6d"],incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-a3c54471-615f-4ff9-9fda-69b5b2ea3eef"},{type:"index-pattern",name:"723c4653-681b-4105-956e-abef287bf025",id:"{dataViewId}"},{type:"index-pattern",name:"a04472fc-94a3-4b8d-ae05-9d30ea8fbd6a",id:"{dataViewId}"}]})},Zl="alertsHistogramQuery",ec=({timelineId:e,deleteQuery:t,endDate:a,entityType:n,filterQuery:s,indexNames:l,pageFilters:c,setQuery:u,startDate:p})=>{const[m]=Object(d.p)(o.V),{globalFullScreen:g}=Object(dt.a)(),f=Object(i.useCallback)((e=>`${Hl}: ${pe()(e).format(m)} ${$l(e)}`),[m]),b=Object(i.useMemo)((()=>({...Xl,subtitle:f})),[f]);return Object(i.useEffect)((()=>()=>{t&&t({id:Zl})}),[t]),r.a.createElement(r.a.Fragment,null,!g&&r.a.createElement(Fs.a,rr()({endDate:a,filterQuery:s,id:Zl,indexNames:l,setQuery:u,startDate:p},b)),r.a.createElement(Gl,{timelineId:e,endDate:a,entityType:n,startDate:p,pageFilters:c}))};ec.displayName="AlertsViewComponent";const tc=r.a.memo(ec);var ac=a(340);const nc=r.a.memo((e=>{const{pageFilters:t,...a}=e,n=Object(i.useMemo)((()=>null!=t?[...ac.d,...t]:ac.d),[t]);return r.a.createElement(tc,rr()({entityType:"events",timelineId:c.i.hostsPageExternalAlerts},a,{pageFilters:n}))}));nc.displayName="HostAlertsQueryTabBody";var ic=a(369);F.i18n.translate("xpack.securitySolution.hosts.hostRiskInformation.informationAriaLabel",{defaultMessage:"Information"});const rc=F.i18n.translate("xpack.securitySolution.hosts.hostRiskInformation.classificationHeader",{defaultMessage:"Classification"}),sc=F.i18n.translate("xpack.securitySolution.hosts.hostRiskInformation.riskHeader",{defaultMessage:"Host risk score range"}),oc=F.i18n.translate("xpack.securitySolution.hosts.hostRiskInformation.unknownRiskDescription",{defaultMessage:"Less than 20"}),lc=F.i18n.translate("xpack.securitySolution.hosts.hostRiskInformation.criticalRiskDescription",{defaultMessage:"90 and above"}),cc=F.i18n.translate("xpack.securitySolution.hosts.hostRiskInformation.title",{defaultMessage:"How is host risk calculated?"}),uc=F.i18n.translate("xpack.securitySolution.hosts.hostRiskInformation.introduction",{defaultMessage:"The Host Risk Score capability surfaces risky hosts from within your environment."}),dc=F.i18n.translate("xpack.securitySolution.hosts.hostRiskInformation.explanation",{defaultMessage:'This feature utilizes a transform, with a scripted metric aggregation to calculate host risk scores based on detection rule alerts with an "open" status, within a 5 day time window. The transform runs hourly to keep the score updated as new detection rule alerts stream in.'}),pc=F.i18n.translate("xpack.securitySolution.hosts.hostRiskInformation.closeBtn",{defaultMessage:"Close"}),mc=F.i18n.translate("xpack.securitySolution.hosts.hostRiskInformation.buttonLabel",{defaultMessage:"How is risk score calculated?"}),gc=()=>{const[e,t]=Object(i.useState)(!1),a=Object(i.useCallback)((()=>{t(!1)}),[]);return[e,Object(i.useCallback)((()=>{t(!0)}),[]),a]},fc=[{field:"classification",name:rc,render:e=>{if(null!=e)return r.a.createElement(rl.b,{severity:e,hideBackgroundColor:!0})}},{field:"range",name:sc}],bc=[{classification:Ii.u.critical,range:lc},{classification:Ii.u.high,range:"70 - 90 "},{classification:Ii.u.moderate,range:"40 - 70"},{classification:Ii.u.low,range:"20 - 40"},{classification:Ii.u.unknown,range:oc}],hc=()=>{const[e,t,a]=gc();return r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiButtonEmpty,{onClick:t,"data-test-subj":"open-risk-information-flyout-trigger"},mc),e&&r.a.createElement(yc,{handleOnClose:a}))},yc=({handleOnClose:e})=>{const t=Object(N.useGeneratedHtmlId)({prefix:"HostRiskInformation"});return r.a.createElement(N.EuiFlyout,{ownFocus:!0,onClose:e,"aria-labelledby":t,size:450,"data-test-subj":"open-risk-information-flyout"},r.a.createElement(N.EuiFlyoutHeader,{hasBorder:!0},r.a.createElement(N.EuiTitle,{size:"m"},r.a.createElement("h2",{id:t},cc))),r.a.createElement(N.EuiFlyoutBody,null,r.a.createElement(N.EuiText,{size:"s"},r.a.createElement("p",null,uc),r.a.createElement("p",null,dc)),r.a.createElement(N.EuiSpacer,null),r.a.createElement(N.EuiBasicTable,{columns:fc,items:bc,"data-test-subj":"risk-information-table"}),r.a.createElement(N.EuiSpacer,{size:"l"}),r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.hosts.hostRiskInformation.learnMore",defaultMessage:"You can learn more about host risk {hostsRiskScoreDocumentationLink}",values:{hostsRiskScoreDocumentationLink:r.a.createElement(N.EuiLink,{href:cs.a,target:"_blank"},r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.hosts.hostRiskInformation.link",defaultMessage:"here"}))}})),r.a.createElement(N.EuiFlyoutFooter,null,r.a.createElement(N.EuiFlexGroup,{justifyContent:"flexEnd"},r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiButton,{onClick:e},pc)))))},Ec=F.i18n.translate("xpack.securitySolution.hosts.hostScoreOverTime.riskyThresholdHeader",{defaultMessage:"Risky threshold"}),vc=F.i18n.translate("xpack.securitySolution.hosts.hostScoreOverTime.riskyLabel",{defaultMessage:"Risky"}),Tc=F.i18n.translate("xpack.securitySolution.hosts.hostScoreOverTime.riskScore",{defaultMessage:"Risk score"}),kc=z()(N.EuiText).withConfig({displayName:"StyledEuiText",componentId:"sc-qe1azf-0"})(["font-size:9px;font-weight:",";margin-right:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold),(({theme:e})=>e.eui.paddingSizes.xs)),xc=z()(N.EuiLoadingChart).withConfig({displayName:"LoadingChart",componentId:"sc-qe1azf-1"})(["display:block;text-align:center;"]),Sc=e=>Math.round(e).toString(),Oc=({from:e,to:t,riskScore:a,loading:n,queryId:s,title:o,toggleStatus:l,toggleQuery:c})=>{const u=Object(d.m)(),p=Object(i.useMemo)((()=>Object(lr.a)([e,t])),[e,t]),m=Object(i.useCallback)((e=>r.a.createElement(wn.c,{value:e.value})),[]),g=Object(ur.h)(),f=Object(i.useMemo)((()=>{var e;return null!==(e=null==a?void 0:a.map((e=>({x:e["@timestamp"],y:e.risk_stats.risk_score}))).reverse())&&void 0!==e?e:[]}),[a]);return r.a.createElement(ca.c,null,r.a.createElement(N.EuiPanel,{hasBorder:!0,"data-test-subj":"RiskScoreOverTime"},r.a.createElement(N.EuiFlexGroup,{gutterSize:"none"},r.a.createElement(N.EuiFlexItem,{grow:1},r.a.createElement(la.a,{title:o,hideSubtitle:!0,toggleQuery:c,toggleStatus:l})),l&&r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(ca.b,{queryId:s,title:o}))),l&&r.a.createElement(N.EuiFlexGroup,{gutterSize:"none",direction:"column"},r.a.createElement(N.EuiFlexItem,{grow:1},r.a.createElement("div",{style:{height:250}},n?r.a.createElement(xc,{size:"l","data-test-subj":"RiskScoreOverTime-loading"}):r.a.createElement(or.Chart,null,r.a.createElement(or.Settings,rr()({},ur.d,{theme:g,tooltip:{headerFormatter:m}})),r.a.createElement(or.Axis,{id:"bottom",position:or.Position.Bottom,tickFormat:p,showGridLines:!0,gridLine:{strokeWidth:1,opacity:1,dash:[3,5]}}),r.a.createElement(or.Axis,{domain:{min:0,max:100},id:"left",position:or.Position.Left,ticks:3,style:{tickLine:{visible:!1},tickLabel:{padding:10}}}),r.a.createElement(or.LineSeries,{id:"RiskOverTime",name:Tc,xScaleType:or.ScaleType.Time,yScaleType:or.ScaleType.Linear,xAccessor:"x",yAccessors:["y"],timeZone:u,data:f,tickFormat:Sc}),r.a.createElement(or.LineAnnotation,{id:"RiskOverTime_annotation",domainType:or.AnnotationDomainType.YDomain,dataValues:[{dataValue:70,details:"70",header:Ec}],markerPosition:"left",style:{line:{strokeWidth:1,stroke:$n.euiThemeVars.euiColorDanger,opacity:1}},marker:r.a.createElement(kc,{color:$n.euiThemeVars.euiColorDarkestShade},vc)})))))))};Oc.displayName="RiskScoreOverTimeComponent";const wc=r.a.memo(Oc);wc.displayName="RiskScoreOverTime";const jc=F.i18n.translate("xpack.securitySolution.hosts.topRiskScoreContributors.title",{defaultMessage:"Top risk score contributors"}),Cc=F.i18n.translate("xpack.securitySolution.hosts.topRiskScoreContributors.rankColumnTitle",{defaultMessage:"Rank"}),Ic=F.i18n.translate("xpack.securitySolution.hosts.topRiskScoreContributors.ruleNameColumnTitle",{defaultMessage:"Rule name"});var Mc=a(1030),Ac=a.n(Mc);const Dc=(e,t)=>null==t?`${Object(fn.capitalize)(e)}`:`${Object(fn.capitalize)(e)} ${Object(fn.capitalize)(t)}`,qc=e=>{var t;return null!==(t=Ac.a.valid(Ac.a.coerce(e)))&&void 0!==t?t:""},Pc=(e,t,a)=>`app/integrations/detail/${a?`${e}-${a}`:e}/overview${t?`?integration=${t}`:""}`,Rc=e=>{const{data:t}=(({packages:e})=>Object(ln.useQuery)(["installedIntegrations",{packages:e}],(async({signal:t})=>{var a;return null!==(a=(await Object(cn.c)({packages:e,signal:t})).installed_integrations)&&void 0!==a?a:[]}),{keepPreviousData:!0,onError:e=>{}}))({packages:[]});return Object(i.useMemo)((()=>{const a=((e,t)=>((e,t)=>e.map((e=>{if(null==t)return{related:e,installed:null,isLoaded:!1};{const a=t.find((t=>t.package_name===e.package&&(null==t?void 0:t.integration_name)===(null==e?void 0:e.integration)));return{related:e,installed:null!=a?a:null,isLoaded:!0}}})))(e,t).map((e=>(e=>{var t;const{related:a,installed:n,isLoaded:i}=e,r=a.package,s=null!==(t=a.integration)&&void 0!==t?t:null,o=a.version;if(!i){const e=Dc(r,s),t=qc(o);return{packageName:r,integrationName:s,integrationTitle:e,requiredVersion:o,targetVersion:t,targetUrl:Pc(r,s,t),installationStatus:{isKnown:!1}}}if(null==n){const e=Dc(r,s),t=qc(o);return{packageName:r,integrationName:s,integrationTitle:e,requiredVersion:o,targetVersion:t,targetUrl:Pc(r,s,t),installationStatus:{isKnown:!0,isInstalled:!1,isEnabled:!1,isVersionMismatch:!1,installedVersion:""}}}{var l;const e=null!==(l=n.integration_title)&&void 0!==l?l:n.package_title,t=n.package_version,a=Ac.a.satisfies(t,o),i=a?t:qc(o);return{packageName:r,integrationName:s,integrationTitle:e,requiredVersion:o,targetVersion:i,targetUrl:Pc(r,s,i),installationStatus:{isKnown:!0,isInstalled:!0,isEnabled:n.is_enabled,isVersionMismatch:!a,installedVersion:t}}}})(e))).sort(((e,t)=>e.integrationTitle.localeCompare(t.integrationTitle))))(e,t);return{integrations:a,isLoaded:null!=t}}),[e,t])},_c=({integration:e})=>{const t=Object(d.e)(),a=e.integrationTitle,n=`${t}/${e.targetUrl}`;return r.a.createElement(N.EuiLink,{href:n,target:"_blank","data-test-subj":"integrationLink"},a)},Fc=r.a.memo(_c);Fc.displayName="IntegrationLink";const Lc=F.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.installedTitle",{defaultMessage:"Installed"}),Nc=F.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.installedTooltip",{defaultMessage:"Integration is installed. Configure an integration policy and ensure Elastic Agents are assigned this policy to ingest compatible events."}),Bc=F.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.uninstalledTitle",{defaultMessage:"Not installed"}),zc=F.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.uninstalledTooltip",{defaultMessage:"Integration is not installed. Follow the integration link to install and configure the integration."}),Uc=F.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.enabledTitle",{defaultMessage:"Installed: enabled"}),Hc=F.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.enabledTooltip",{defaultMessage:"Integration is installed and an integration policy with the required configuration exists. Ensure Elastic Agents are assigned this policy to ingest compatible events."}),$c=F.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.badgeTitle",{defaultMessage:"integrations"}),Vc=(F.i18n.translate("xpack.securitySolution.containers.detectionEngine.relatedIntegrations.fetchFailDescription",{defaultMessage:"Failed to fetch installed integrations"}),z()(N.EuiBadge).withConfig({displayName:"PaddedBadge",componentId:"sc-q84pbl-0"})(["margin-left:5px;"])),Qc=({integration:e})=>{const{installationStatus:t}=e;if(!t.isKnown)return null;const{isInstalled:a,isEnabled:n}=t,i=a?"success":"#E0E5EE",s=a?n?Hc:Nc:zc,o=a?n?Uc:Lc:Bc;return r.a.createElement(N.EuiToolTip,{content:s},r.a.createElement(Vc,{color:i,"data-test-subj":"statusBadge"},o))},Wc=r.a.memo(Qc);Wc.displayName="IntegrationStatusBadge";const Gc=z.a.span.withConfig({displayName:"VersionWarningIconContainer",componentId:"sc-1qsec7-0"})(["margin-left:5px;"]),Kc=({integration:e})=>{const{installationStatus:t}=e;return t.isKnown&&t.isInstalled&&t.isVersionMismatch?r.a.createElement(Gc,null,r.a.createElement(N.EuiIconTip,{type:"alert",color:"warning",content:(a=t.installedVersion,n=e.requiredVersion,F.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.popoverDescriptionInstalledVersionTooltip",{values:{installedVersion:a,requiredVersion:n},defaultMessage:"Version mismatch -- please resolve! Installed version `{installedVersion}` when required version `{requiredVersion}`"}))})):null;var a,n},Yc=r.a.memo(Kc);Yc.displayName="IntegrationVersionMismatchIcon";const Jc=z.a.div.withConfig({displayName:"Wrapper",componentId:"sc-ea1y1-0"})(["overflow:hidden;"]),Xc=({integration:e})=>r.a.createElement(Jc,null,r.a.createElement(Fc,{integration:e})," ",r.a.createElement(Wc,{integration:e}),r.a.createElement(Yc,{integration:e})),Zc=r.a.memo(Xc),eu=({relatedIntegrations:e})=>{const{integrations:t}=Rc(e);return r.a.createElement(r.a.Fragment,null,t.map(((e,t)=>r.a.createElement(Zc,{key:`${e.packageName}-${t}`,integration:e}))))},tu=z()(N.EuiFlexGroup).withConfig({displayName:"IntegrationsPopoverWrapper",componentId:"sc-1rv38wr-0"})(["width:100%;"]),au=z()(N.EuiPopoverTitle).withConfig({displayName:"PopoverTitleWrapper",componentId:"sc-1rv38wr-1"})(["max-width:390px;"]),nu=z()("div").withConfig({displayName:"PopoverContentWrapper",componentId:"sc-1rv38wr-2"})(["max-height:400px;max-width:390px;overflow:auto;line-height:",";"],(({theme:e})=>e.eui.euiLineHeight)),iu=z()("li").withConfig({displayName:"IntegrationListItem",componentId:"sc-1rv38wr-3"})(["list-style-type:disc;margin-left:25px;margin-bottom:5px;"]),ru=({relatedIntegrations:e})=>{const[t,a]=Object(i.useState)(!1),{integrations:n,isLoaded:s}=Rc(e),o=Object(i.useMemo)((()=>n.filter((e=>e.installationStatus.isKnown&&e.installationStatus.isEnabled))),[n]),l=n.length,c=o.length,u=Object(i.useMemo)((()=>s?`${c}/${l} ${$c}`:`${l} ${$c}`),[s,l,c]);return r.a.createElement(tu,{alignItems:"center",gutterSize:"s","data-test-subj":"IntegrationsWrapper"},r.a.createElement(N.EuiPopover,{ownFocus:!0,"data-test-subj":"IntegrationsDisplayPopover",button:r.a.createElement(N.EuiBadge,{iconType:"package",color:"hollow","data-test-subj":"IntegrationsDisplayPopoverButton",onClick:()=>a(!t),onClickAriaLabel:u},u),isOpen:t,closePopover:()=>a(!t),repositionOnScroll:!0},r.a.createElement(au,{"data-test-subj":"IntegrationsPopoverTitle"},(d=l,F.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.popoverTitle",{values:{integrationsCount:d},defaultMessage:"[{integrationsCount}] Related {integrationsCount, plural, =1 {integration} other {integrations}} available"}))),r.a.createElement(nu,{"data-test-subj":"IntegrationsPopoverContentWrapper"},r.a.createElement(N.EuiText,{size:"s"},(e=>F.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.popoverDescription",{values:{integrationsCount:e},defaultMessage:"Install and configure {integrationsCount, plural, =1 {the below integration} other {one or more of the below integrations}} to ingest the necessary data for this detection rule:"}))(l)),r.a.createElement(N.EuiSpacer,{size:"s"}),r.a.createElement("ul",null,n.map(((e,t)=>r.a.createElement(iu,{key:`${e.packageName}-${t}`},r.a.createElement(Zc,{integration:e}))))))));var d},su=r.a.memo(ru);su.displayName="IntegrationsPopover";const ou=su;var lu=a(289);const cu=e=>"boolean"==typeof e,uu=(e,t)=>{var a;return null==e||!((null===(a=e.actions)||void 0===a?void 0:a.length)>0&&cu(t))||t},du=(e,t,a)=>null==e?void 0:Object(lu.d)(e.type)&&!t?Ge:uu(e,a)?void 0:nn.vb;var pu=a(0),mu=a(15);let gu;!function(e){e["going to run"]="going to run",e.running="running",e["partial failure"]="partial failure",e.failed="failed",e.succeeded="succeeded"}(gu||(gu={}));const fu=Object(mu.p)("RuleExecutionStatus",gu),bu=mu.l,hu=(gu.succeeded,gu["going to run"],gu.running,gu["partial failure"],gu.failed,mu.l),yu=pu.partial({total_search_duration_ms:hu,total_indexing_duration_ms:hu,execution_gap_duration_s:hu}),Eu=pu.type({last_execution:pu.type({date:mu.g,status:fu,status_order:bu,message:pu.string,metrics:yu})}),vu=(pu.type({date:mu.g,status:fu,message:pu.string}),pu.type({execution_uuid:pu.string,timestamp:mu.g,duration_ms:pu.number,status:pu.string,message:pu.string,num_active_alerts:pu.number,num_new_alerts:pu.number,num_recovered_alerts:pu.number,num_triggered_actions:pu.number,num_succeeded_actions:pu.number,num_errored_actions:pu.number,total_search_duration_ms:pu.number,es_search_duration_ms:pu.number,schedule_delay_ms:pu.number,timed_out:pu.boolean,indexing_duration_ms:pu.number,search_duration_ms:pu.number,gap_duration_s:pu.number,security_status:pu.string,security_message:pu.string}),pu.keyof({timestamp:mu.g,duration_ms:pu.number,gap_duration_s:pu.number,indexing_duration_ms:pu.number,search_duration_ms:pu.number,schedule_delay_ms:pu.number}),pu.exact(pu.intersection([pu.type({package:mu.i,version:mu.i}),pu.partial({integration:mu.i})]))),Tu=pu.array(vu),ku=pu.exact(pu.type({name:mu.i,type:mu.i,ecs:pu.boolean})),xu=pu.array(ku),Su=pu.string;var Ou=a(44);const wu="securitySolution singleRuleActions enable",ju="securitySolution singleRuleActions disable",Cu="securitySolution singleRuleActions duplicate",Iu="securitySolution singleRuleActions export",Mu="securitySolution singleRuleActions delete",Au="securitySolution singleRuleActions preview",Du="securitySolution singleRuleActions save",qu="securitySolution bulkRuleActions enable",Pu="securitySolution bulkRuleActions disable",Ru="securitySolution bulkRuleActions duplicate",_u="securitySolution bulkRuleActions export",Fu="securitySolution bulkRuleActions delete",Lu="securitySolution bulkRuleActions edit",Nu="securitySolution rulesTable refresh",Bu="securitySolution rulesTable filter",zu="securitySolution rulesTable loadPrebuilt",Uu="securitySolution rulesTable technicalPreview on",Hu="securitySolution rulesTable technicalPreview off",$u={managed:!0},Vu=()=>{const{services:{apm:e}}=Object(d.j)();return{startTransaction:Object(i.useCallback)((({name:t,type:a="user-interaction"})=>e.startTransaction(t,a,$u)),[e])}};var Qu=a(708),Wu=a(376),Gu=a(219),Ku=pu.recursion("saved_object_attribute_single",(function(){return pu.union([pu.string,pu.number,pu.boolean,pu.null,pu[void 0],Ju])})),Yu=pu.recursion("saved_object_attribute",(function(){return pu.union([Ku,pu.array(Ku)])})),Ju=pu.recursion("saved_object_attributes",(function(){return pu.record(pu.string,Yu)})),Xu=pu.string,Zu=pu.string,ed=pu.string,td=Ju,ad=pu.exact(pu.type({group:Xu,id:Zu,action_type_id:ed,params:td})),nd=pu.array(ad),id=(pu.array(pu.exact(pu.type({group:Xu,id:Zu,actionTypeId:ed,params:td}))),new pu.Type("DefaultActionsArray",nd.is,(function(e,t){return null==e?pu.success([]):nd.validate(e,t)}),pu.identity),new pu.Type("DefaultExportFileName",pu.string.is,(function(e,t){return null==e?pu.success("export.ndjson"):pu.string.validate(e,t)}),pu.identity),a(490)),rd=new pu.Type("From",pu.string.is,(function(e,t){return function(e){return"string"==typeof e}(e)&&null==Object(id.a)(e)?pu.failure(e,t,'Failed to parse "from" on rule param'):pu.string.validate(e,t)}),pu.identity),sd=(pu.union([rd,pu[void 0]]),new pu.Type("DefaultFromString",pu.string.is,(function(e,t){return null==e?pu.success("now-6m"):rd.validate(e,t)}),pu.identity),new pu.Type("DefaultIntervalString",pu.string.is,(function(e,t){return null==e?pu.success("5m"):pu.string.validate(e,t)}),pu.identity),pu.keyof({eql:null,kuery:null,lucene:null})),od=(pu.union([sd,pu[void 0]]),new pu.Type("DefaultLanguageString",pu.string.is,(function(e,t){return null==e?pu.success("kuery"):sd.validate(e,t)}),pu.identity),mu.m),ld=(pu.union([od,pu[void 0]]),new pu.Type("DefaultMaxSignals",pu.number.is,(function(e,t){return null==e?pu.success(100):od.validate(e,t)}),pu.identity),new pu.Type("DefaultPerPage",pu.number.is,(function(e,t){return null==e?pu.success(1):"string"==typeof e?mu.m.validate(parseInt(e,10),t):mu.m.validate(e,t)}),pu.identity),new pu.Type("DefaultPerPage",pu.number.is,(function(e,t){return null==e?pu.success(20):"string"==typeof e?mu.m.validate(parseInt(e,10),t):mu.m.validate(e,t)}),pu.identity),new pu.Type("RiskScore",pu.number.is,(function(e,t){return"number"==typeof e&&Number.isSafeInteger(e)&&e>=0&&e<=100?pu.success(e):pu.failure(e,t)}),pu.identity)),cd=pu.union([ld,pu[void 0]]),ud=pu.string,dd=pu.string,pd=pu.exact(pu.type({field:ud,value:dd,operator:mu.r,risk_score:cd})),md=pu.array(pd),gd=(pu.union([md,pu[void 0]]),new pu.Type("DefaultRiskScoreMappingArray",md.is,(function(e,t){return null==e?pu.success([]):md.validate(e,t)}),pu.identity),pu.keyof({low:null,medium:null,high:null,critical:null})),fd=(pu.union([gd,pu[void 0]]),pu.string),bd=pu.string,hd=pu.exact(pu.type({field:fd,operator:mu.r,value:bd,severity:gd})),yd=pu.array(hd),Ed=(pu.union([yd,pu[void 0]]),new pu.Type("DefaultSeverityMappingArray",yd.is,(function(e,t){return null==e?pu.success([]):yd.validate(e,t)}),pu.identity),pu.string),vd=pu.string,Td=pu.string,kd=pu.type({id:Ed,name:vd,reference:Td}),xd=pu.string,Sd=pu.string,Od=pu.string,wd=pu.type({id:xd,name:Sd,reference:Od}),jd=pu.array(wd),Cd=pu.string,Id=pu.string,Md=pu.string,Ad=pu.intersection([pu.exact(pu.type({id:Cd,name:Id,reference:Md})),pu.exact(pu.partial({subtechnique:jd}))]),Dd=pu.array(Ad),qd=pu.string,Pd=pu.intersection([pu.exact(pu.type({framework:qd,tactic:kd})),pu.exact(pu.partial({technique:Dd}))]),Rd=pu.array(Pd),_d=(pu.union([Rd,pu[void 0]]),new pu.Type("DefaultThreatArray",Rd.is,(function(e,t){return null==e?pu.success([]):Rd.validate(e,t)}),pu.identity),pu.string),Fd=(pu.union([_d,pu.null]),pu.union([_d,pu.null,pu[void 0]]),new pu.Type("DefaultThreatNull",_d.is,(function(e,t){return null==e?pu.success(null):_d.validate(e,t)}),pu.identity),new pu.Type("DefaultToString",pu.string.is,(function(e,t){return null==e?pu.success("now"):pu.string.validate(e,t)}),pu.identity),new pu.Type("DefaultUuid",pu.string.is,(function(e,t){return null==e?pu.success(sa.a.v4()):mu.i.validate(e,t)}),pu.identity),Object(mu.h)(pu.string)),Ld=(pu.union([Fd,pu[void 0]]),pu.union([pu.string,Fd])),Nd=(pu.union([Ld,pu[void 0]]),new pu.Type("referencesWithDefaultArray",pu.array(pu.string).is,(function(e,t){return null==e?pu.success([]):pu.array(pu.string).validate(e,t)}),pu.identity),pu.string),Bd=(pu.union([Nd,pu[void 0]]),pu.string),zd=(pu.union([Bd,pu[void 0]]),pu.array(pu.unknown)),Ud=(pu.union([zd,pu[void 0]]),pu.exact(pu.type({field:mu.i,type:pu.keyof({mapping:null}),value:mu.i}))),Hd=pu.array(Ud),$d=pu.exact(pu.type({entries:Hd})),Vd=Object(mu.h)($d,"NonEmptyArray<ThreatMap>"),Qd=(pu.union([Vd,pu[void 0]]),pu.array(pu.string)),Wd=(pu.union([Qd,pu[void 0]]),pu.union([sd,pu[void 0]])),Gd=(pu.union([Wd,pu[void 0]]),mu.m),Kd=(pu.union([Gd,pu[void 0]]),mu.m),Yd=(pu.union([Kd,pu[void 0]]),pu.keyof({eql:null,machine_learning:null,query:null,saved_query:null,threshold:null,threat_match:null}));pu.union([Yd,pu[void 0]]);const Jd=pu.exact(pu.type({group:pu.string,id:pu.string,action_type_id:pu.string,params:pu.record(pu.string,pu.any)})),Xd=pu.intersection([pu.type({from:pu.string}),pu.partial({throttle:pu.string,kibana_siem_app_url:pu.string})]),Zd=pu.intersection([pu.type({author:Ou.d,created_at:pu.string,created_by:pu.string,description:pu.string,enabled:pu.boolean,false_positives:pu.array(pu.string),from:pu.string,id:pu.string,interval:pu.string,immutable:pu.boolean,name:pu.string,max_signals:pu.number,references:pu.array(pu.string),related_integrations:Tu,required_fields:xu,risk_score:pu.number,risk_score_mapping:md,rule_id:pu.string,severity:gd,severity_mapping:yd,setup:Su,tags:pu.array(pu.string),type:Yd,to:pu.string,threat:Rd,updated_at:pu.string,updated_by:pu.string,actions:pu.array(Jd),throttle:pu.union([pu.string,pu.null])}),pu.partial({outcome:Ou.i,alias_target_id:pu.string,alias_purpose:Ou.c,building_block_type:Ou.e,anomaly_threshold:pu.number,filters:pu.array(pu.unknown),index:pu.array(pu.string),language:pu.string,license:Ou.g,meta:Xd,machine_learning_job_id:pu.array(pu.string),output_index:pu.string,query:pu.string,rule_name_override:Ou.k,saved_id:pu.string,threshold:Ou.o,threat_query:Nd,threat_filters:zd,threat_index:Qd,threat_indicator_path:Bd,threat_mapping:Vd,threat_language:Wd,timeline_id:pu.string,timeline_title:pu.string,timestamp_override:Ou.r,timestamp_field:Ou.q,event_category_override:Ou.f,tiebreaker_field:Ou.p,note:pu.string,exceptions_list:Gu.x,uuid:pu.string,version:pu.number,execution_summary:Eu})]),ep=(pu.array(Zd),e=>{const[t,a]=Object(i.useState)(null),[n,r]=Object(i.useState)(!0),{addError:s}=Object(X.a)();return Object(i.useEffect)((()=>{let t=!0;const n=new AbortController;return null!=e&&(async e=>{try{r(!0);const i=Object(Wu.a)(await Object(cn.d)({id:e,signal:n.signal}));t&&a(i)}catch(e){t&&(a(null),s(e,{title:un.h}))}t&&r(!1)})(e),()=>{t=!1,n.abort()}}),[e,s]),[n,t]}),tp=({canUserCRUD:e,hasIndexWrite:t,isAuthenticated:a,hasEncryptionKey:n,isSignalIndexExists:s})=>{const[o,l]=Object(i.useState)({createPrePackagedRules:null,refetchPrePackagedRulesStatus:null,rulesCustomInstalled:null,rulesInstalled:null,rulesNotInstalled:null,rulesNotUpdated:null,timelinesInstalled:null,timelinesNotInstalled:null,timelinesNotUpdated:null}),[c,u]=Object(i.useState)(!1),[d,p]=Object(i.useState)(!0),{addError:m,addSuccess:g}=Object(X.a)();Object(i.useEffect)((()=>{let i=!0;const r=new AbortController,o=async()=>{try{p(!0);const e=await Object(cn.h)({signal:r.signal});i&&l({createPrePackagedRules:c,refetchPrePackagedRulesStatus:o,rulesCustomInstalled:e.rules_custom_installed,rulesInstalled:e.rules_installed,rulesNotInstalled:e.rules_not_installed,rulesNotUpdated:e.rules_not_updated,timelinesInstalled:e.timelines_installed,timelinesNotInstalled:e.timelines_not_installed,timelinesNotUpdated:e.timelines_not_updated})}catch(e){i&&(l({createPrePackagedRules:null,refetchPrePackagedRulesStatus:null,rulesCustomInstalled:null,rulesInstalled:null,rulesNotInstalled:null,rulesNotUpdated:null,timelinesInstalled:null,timelinesNotInstalled:null,timelinesNotUpdated:null}),m(e,{title:un.h}))}i&&p(!1)},c=async()=>new Promise((async d=>{try{if(e&&t&&a&&n&&s){u(!0);const e=await Object(cn.a)({signal:r.signal});if(i){let t=0,a=-1;const n=()=>{-1!==a&&window.clearTimeout(a)},s=()=>window.setTimeout((async()=>{t+=1;const p=await Object(cn.h)({signal:r.signal});i&&(0===p.rules_not_installed&&0===p.rules_not_updated&&0===p.timelines_not_installed&&0===p.timelines_not_updated||t>100)?(u(!1),l({createPrePackagedRules:c,refetchPrePackagedRulesStatus:o,rulesCustomInstalled:p.rules_custom_installed,rulesInstalled:p.rules_installed,rulesNotInstalled:p.rules_not_installed,rulesNotUpdated:p.rules_not_updated,timelinesInstalled:p.timelines_installed,timelinesNotInstalled:p.timelines_not_installed,timelinesNotUpdated:p.timelines_not_updated}),g((e=>{const{rules_installed:t,rules_updated:a,timelines_installed:n,timelines_updated:i}=e;return 0===t&&(n>0||i>0)?un.n:(t>0||a>0)&&0===n?un.l:un.j})(e)),n(),d(!0)):a=s()}),300);a=s()}}else d(!1)}catch(e){i&&(u(!1),m(e,{title:un.i}),d(!1))}}));return o(),()=>{i=!1,r.abort()}}),[e,t,a,n,s,m,g]);const f=Object(i.useMemo)((()=>fi(o.rulesInstalled,o.rulesNotInstalled,o.rulesNotUpdated)),[o.rulesInstalled,o.rulesNotInstalled,o.rulesNotUpdated]),b=Object(i.useMemo)((()=>bi(o.timelinesInstalled,o.timelinesNotInstalled,o.timelinesNotUpdated)),[o.timelinesInstalled,o.timelinesNotInstalled,o.timelinesNotUpdated]),h=Object(i.useCallback)((({isDisabled:e,onClick:t,fill:a,"data-test-subj":n="loadPrebuiltRulesBtn"})=>"ruleNotInstalled"!==f&&"timelinesNotInstalled"!==b||"someRuleUninstall"===f?null:r.a.createElement(N.EuiButton,{fill:a,iconType:"indexOpen",isLoading:c,isDisabled:e,onClick:t,"data-test-subj":n},"ruleNotInstalled"===f&&"timelinesNotInstalled"===b&&un.b,"ruleNotInstalled"===f&&"timelinesNotInstalled"!==b&&un.a,"ruleNotInstalled"!==f&&"timelinesNotInstalled"===b&&un.c)),[c,f,b]),y=Object(i.useCallback)(((e,t)=>e>0&&0===t?un.d(e):0===e&&t>0?un.f(t):e>0&&t>0?un.e(e,t):void 0),[]),E=Object(i.useCallback)((({isDisabled:e,onClick:t,fill:a=!1})=>{var n,i;return"someRuleUninstall"===f||"someTimelineUninstall"===b?r.a.createElement(N.EuiButton,{fill:a,iconType:"plusInCircle",isLoading:c,isDisabled:e,onClick:t,"data-test-subj":"reloadPrebuiltRulesBtn"},y(null!==(n=o.rulesNotInstalled)&&void 0!==n?n:0,null!==(i=o.timelinesNotInstalled)&&void 0!==i?i:0)):null}),[y,c,f,b,o.rulesNotInstalled,o.timelinesNotInstalled]);return{loading:d,loadingCreatePrePackagedRules:c,...o,getLoadPrebuiltRulesAndTemplatesButton:h,getReloadPrebuiltRulesAndTemplatesButton:E}},ap=(e,t)=>{t(o.y,{deepLinkId:T.a.rules,path:Object(V.b)(null!=e?e:"")})},np=async({visibleRuleIds:e=[],action:t,setLoadingRules:a,toasts:n,search:i,payload:r,onSuccess:s=rp,onError:o=ip,onFinish:l})=>{try{if(null==a||a({ids:e,action:t}),t!==Ou.a.export){const e=await Object(cn.k)({...i,action:t,edit:null==r?void 0:r.edit});return function(e,t){e!==Ou.a.disable&&e!==Ou.a.enable||(t.attributes.results.updated.some((e=>e.immutable))&&Object(Ui.e)(Ui.a.COUNT,e===Ou.a.enable?Ui.b.SIEM_RULE_ENABLED:Ui.b.SIEM_RULE_DISABLED),t.attributes.results.updated.some((e=>!e.immutable))&&Object(Ui.e)(Ui.a.COUNT,e===Ou.a.disable?Ui.b.CUSTOM_RULE_ENABLED:Ui.b.CUSTOM_RULE_DISABLED))}(t,e),s(n,t,e.attributes.summary),e}{const e=await Object(cn.k)({...i,action:t});Object(Qu.a)(e,`${nn.Ab}.ndjson`),s(n,t,await(async e=>{const t=await(async e=>{const t=(await e.text()).split("\n").filter(Boolean).slice(-1)[0];return JSON.parse(t)})(e);return{succeeded:t.exported_rules_count,failed:t.missing_rules_count,total:t.exported_rules_count+t.missing_rules_count}})(e))}}catch(e){o(n,t,e)}finally{null==a||a({ids:[],action:null}),null==l||l()}};function ip(e,t,a){var n,i;const r=null==a||null===(n=a.body)||void 0===n||null===(i=n.attributes)||void 0===i?void 0:i.summary;let s,o;switch(a.stack=JSON.stringify(a.body,null,2),t){case Ou.a.export:s=nn.mc,r&&(o=nn.nc(r.failed));break;case Ou.a.duplicate:s=nn.ac,r&&(o=nn.bc(r.failed));break;case Ou.a.delete:s=nn.Sb,r&&(o=nn.Tb(r.failed));break;case Ou.a.enable:s=nn.ic,r&&(o=nn.jc(r.failed));break;case Ou.a.disable:s=nn.Wb,r&&(o=nn.Xb(r.failed));break;case Ou.a.edit:s=nn.ec,r&&(o=nn.fc(r.failed))}e.addError(a,{title:s,toastMessage:o})}async function rp(e,t,a){let n,i;switch(t){case Ou.a.export:n=nn.oc,i=nn.pc(a.succeeded,a.total);break;case Ou.a.duplicate:n=nn.cc,i=nn.dc(a.succeeded);break;case Ou.a.delete:n=nn.Ub,i=nn.Vb(a.succeeded);break;case Ou.a.enable:n=nn.kc,i=nn.lc(a.succeeded);break;case Ou.a.disable:n=nn.Yb,i=nn.Zb(a.succeeded);break;case Ou.a.edit:n=nn.gc,i=nn.hc(a.succeeded)}e.addSuccess({title:n,text:i})}const sp=z()(N.EuiSwitch).withConfig({displayName:"StaticSwitch",componentId:"sc-12pilng-0"})([".euiSwitch__thumb,.euiSwitch__icon{transition:none;}"]);sp.displayName="StaticSwitch";const op=({id:e,isDisabled:t,isLoading:a,enabled:n,onChange:s})=>{const[o,l]=Object(i.useState)(!1),c=xn(),u=(()=>{const e=Object(ln.useQueryClient)();return Object(i.useCallback)((t=>{e.setQueriesData(dn,(e=>e?{rules:gn(e.rules,t),total:e.total}:void 0))}),[e])})(),d=Object(X.a)(),{startTransaction:p}=Vu(),m=Object(i.useCallback)((async t=>{l(!0),p({name:n?ju:wu});const a=await np({setLoadingRules:null==c?void 0:c.actions.setLoadingRules,toasts:d,onSuccess:c?void 0:fn.noop,action:t.target.checked?Ou.a.enable:Ou.a.disable,search:{ids:[e]},visibleRuleIds:[]});null!=a&&a.attributes.results.updated.length&&(u(a.attributes.results.updated),null==s||s(a.attributes.results.updated[0].enabled)),l(!1)}),[n,e,s,c,p,d,u]),g=Object(i.useMemo)((()=>o!==a&&a||o),[o,a]);return r.a.createElement(N.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceAround"},r.a.createElement(N.EuiFlexItem,{grow:!1},g?r.a.createElement(N.EuiLoadingSpinner,{size:"m","data-test-subj":"ruleSwitchLoader"}):r.a.createElement(sp,{"data-test-subj":"ruleSwitch",label:void 0,disabled:t,checked:n,onChange:m})))},lp=r.a.memo(op);lp.displayName="RuleSwitch";var cp=a(542);const up=({columnName:e,children:t})=>{const[a,n]=Object(i.useState)(!1);return r.a.createElement(N.EuiPopover,{anchorPosition:"upCenter",isOpen:a,closePopover:()=>n(!1),button:r.a.createElement(N.EuiButtonIcon,{"aria-label":nn.Ob(e),onClick:e=>{n(!a),e.stopPropagation()},size:"xs",color:"primary",iconType:"questionInCircle",style:{height:"auto"}})},t)},dp=r.a.memo(up);dp.displayName="PopoverTooltip";const pp=({title:e,tooltipContent:t,customTooltip:a})=>r.a.createElement(N.EuiFlexGrid,{gutterSize:"none"},r.a.createElement(N.EuiFlexItem,{style:{width:"calc(100% - 20px)"}},r.a.createElement("span",{className:"eui-textTruncate"},e)),null!=a?a:r.a.createElement(N.EuiToolTip,{content:t},r.a.createElement(N.EuiIcon,{"data-test-subj":"tableHeaderIcon",size:"m",color:"subdued",type:"questionInCircle",style:{marginLeft:4}}))),mp=r.a.memo(pp);mp.displayName="TableHeaderTooltipCell";const gp=()=>{const{services:{application:{capabilities:{actions:e}}}}=Object(d.j)();return!cu(e.show)||e.show};var fp=a(445),bp=a(366);const hp=()=>{const e=Object(Pi.a)();return Object(bp.a)(e)&&Object(fp.a)(e)},yp=(e,t,a,n,i,s)=>[{type:"icon","data-test-subj":"editRuleAction",description:nn.ub,name:n?nn.ub:r.a.createElement(N.EuiToolTip,{position:"left",content:nn.vb},r.a.createElement(r.a.Fragment,null,nn.ub)),icon:"controlsHorizontal",onClick:e=>ap(e.id,t),enabled:e=>uu(e,n)},{type:"icon","data-test-subj":"duplicateRuleAction",description:nn.sb,icon:"copy",name:n?nn.sb:r.a.createElement(N.EuiToolTip,{position:"left",content:nn.vb},r.a.createElement(r.a.Fragment,null,nn.sb)),enabled:e=>uu(e,n),onClick:async n=>{s({name:Cu});const r=await np({action:Ou.a.duplicate,setLoadingRules:i,visibleRuleIds:[n.id],toasts:e,search:{ids:[n.id]}});a();const o=null==r?void 0:r.attributes.results.created;null!=o&&o.length&&ap(o[0].id,t)}},{type:"icon","data-test-subj":"exportRuleAction",description:nn.Bb,icon:"exportAction",name:nn.Bb,onClick:async t=>{s({name:Iu}),await np({action:Ou.a.export,setLoadingRules:i,visibleRuleIds:[t.id],toasts:e,search:{ids:[t.id]}})},enabled:e=>!e.immutable},{type:"icon","data-test-subj":"deleteRuleAction",description:nn.rb,icon:"trash",name:nn.rb,onClick:async t=>{s({name:Mu}),await np({action:Ou.a.delete,setLoadingRules:i,visibleRuleIds:[t.id],toasts:e,search:{ids:[t.id]}}),a()}}],Ep=e=>null==e?null:e===gu["partial failure"]?"warning":e,vp=e=>null==e?"subdued":e===gu.succeeded?"success":e===gu.failed?"danger":e===gu.running||e===gu["partial failure"]||e===gu["going to run"]?"warning":Object(gt.a)(e,"Unknown rule execution status"),Tp=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleStatus.statusDescription",{defaultMessage:"Last response"}),kp=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleStatus.statusAtDescription",{defaultMessage:"at"}),xp=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleStatus.statusDateDescription",{defaultMessage:"Status date"}),Sp=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleStatus.refreshButton",{defaultMessage:"Refresh"}),Op=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleStatus.errorCalloutTitle",{defaultMessage:"Rule failure at"}),wp=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleStatus.partialErrorCalloutTitle",{defaultMessage:"Warning at"}),jp=({status:e,date:t,children:a})=>{const n=Ep(e),i=vp(e);return r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiHealth,{color:i},r.a.createElement(N.EuiText,{"data-test-subj":"ruleStatus",size:"xs"},null!=n?n:Object(vr.d)()))),null!=t&&null!=e&&r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(r.a.Fragment,null,kp)),r.a.createElement(N.EuiFlexItem,{grow:!0},r.a.createElement(wn.a,{value:t,fieldName:xp}))),r.a.createElement(N.EuiFlexItem,{grow:!1},a))},Cp=r.a.memo(jp);Cp.displayName="RuleStatus";var Ip=a(727);const Mp=({status:e})=>{const t=(e=>{const t=Ep(e);return null!=t?Object(fn.capitalize)(t):null})(e),a=vp(e);return r.a.createElement(Ip.a,{tooltipContent:t,healthColor:a,dataTestSubj:"ruleExecutionStatus"},null!=t?t:Object(vr.d)())},Ap=r.a.memo(Mp);Ap.displayName="RuleStatusBadge";const Dp=({date:e,message:t,status:a})=>{const{shouldBeDisplayed:n,color:i,title:s}=Pp(a);return n?r.a.createElement(N.EuiCallOut,{title:r.a.createElement(N.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",justifyContent:"flexStart"},r.a.createElement(N.EuiFlexItem,{grow:!1},s),r.a.createElement(N.EuiFlexItem,{grow:!0},r.a.createElement(wn.a,{value:e,fieldName:"execution_summary.last_execution.date"}))),color:i,iconType:"alert","data-test-subj":"ruleStatusFailedCallOut"},r.a.createElement("p",null,t)):null},qp=r.a.memo(Dp);qp.displayName="RuleStatusFailedCallOut";const Pp=e=>{switch(e){case gu.failed:return{shouldBeDisplayed:!0,color:"danger",title:Op};case gu["partial failure"]:return{shouldBeDisplayed:!0,color:"warning",title:wp};default:return{shouldBeDisplayed:!1,color:"warning",title:""}}},Rp=({hasPermissions:e})=>{const t=hp(),a=gp(),{loadingRulesAction:n,loadingRuleIds:s}=kn().state,o=Object(i.useMemo)((()=>["disable","enable","edit"].includes(null!=n?n:"")?s:[]),[s,n]);return Object(i.useMemo)((()=>({field:"enabled",name:nn.T,render:(n,i)=>r.a.createElement(N.EuiToolTip,{position:"top",content:du(i,t,a)},r.a.createElement(lp,{id:i.id,enabled:i.enabled,isDisabled:!uu(i,a)||!e||Object(lu.d)(i.type)&&!t&&!i.enabled,isLoading:o.includes(i.id)})),width:"95px",sortable:!0})),[a,t,e,o])},_p=({name:e,id:t})=>{const{formatUrl:a}=Object(u.k)(o.cc.rules),{navigateToApp:n}=Object(d.j)().services.application;return r.a.createElement(N.EuiToolTip,{content:e,anchorClassName:"eui-textTruncate"},r.a.createElement(ut.f,{"data-test-subj":"ruleName",onClick:e=>{e.preventDefault(),n(o.y,{deepLinkId:o.cc.rules,path:Object(V.c)(t)})},href:a(Object(V.c)(t))},e))},Fp=()=>Object(i.useMemo)((()=>({field:"name",name:nn.eb,render:(e,t)=>r.a.createElement(_p,{id:t.id,name:e}),sortable:!0,truncateText:!0,width:"38%"})),[]),Lp={field:"tags",name:null,align:"center",render:e=>0===e.length?null:r.a.createElement(On.a,{items:e,popoverTitle:nn.gb,popoverButtonTitle:e.length.toString(),popoverButtonIcon:"tag",dataTestPrefix:"tags",renderItem:(e,t)=>r.a.createElement(N.EuiBadge,{color:"hollow",key:`${e}-${t}`,"data-test-subj":"tag"},e)}),width:"65px",truncateText:!0},Np={field:"related_integrations",name:null,align:"center",render:e=>null==e||0===e.length?null:r.a.createElement(ou,{relatedIntegrations:e}),width:"143px",truncateText:!0},Bp=()=>{const{navigateToApp:e}=Object(d.j)().services.application,t=gp(),a=Object(X.a)(),{reFetchRules:n,setLoadingRules:r}=kn().actions,{startTransaction:s}=Vu();return Object(i.useMemo)((()=>({actions:yp(a,e,n,t,r,s),width:"40px"})),[t,e,n,r,s,a])},zp=[{name:Cc,field:"rank",width:"45px",align:"right"},{name:Ic,field:"name",sortable:!0,truncateText:!0,render:(e,{id:t})=>t?r.a.createElement(_p,{id:t,name:e}):e}],Up=({rules:e=[],loading:t,queryId:a,toggleStatus:n,toggleQuery:s})=>{const o=Object(i.useMemo)((()=>null==e?void 0:e.sort(((e,t)=>t.rule_risk-e.rule_risk)).map((({rule_name:e,rule_id:t},a)=>({rank:a+1,name:e,id:t})))),[e]),l=Object(i.useMemo)((()=>({showPerPageOptions:!1,pageSize:5,totalItemCount:o.length})),[o.length]);return r.a.createElement(ca.c,null,r.a.createElement(N.EuiPanel,{hasBorder:!0,"data-test-subj":"topRiskScoreContributors"},r.a.createElement(N.EuiFlexGroup,{gutterSize:"none"},r.a.createElement(N.EuiFlexItem,{grow:1},r.a.createElement(la.a,{title:jc,hideSubtitle:!0,toggleQuery:s,toggleStatus:n})),n&&r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(ca.b,{queryId:a,title:jc}))),n&&r.a.createElement(N.EuiFlexGroup,{"data-test-subj":"topRiskScoreContributors-table",gutterSize:"none",direction:"column"},r.a.createElement(N.EuiFlexItem,{grow:1},r.a.createElement(N.EuiInMemoryTable,{items:o,columns:zp,pagination:l,loading:t})))))},Hp=r.a.memo(Up);Hp.displayName="TopRiskScoreContributors";var $p=a(538),Vp=a(724);const Qp=z()(N.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-846lzt-0"})(["margin-top:",";"],(({theme:e})=>e.eui.paddingSizes.l)),Wp=ms.a.HOST_DETAILS_RISK_SCORE,Gp=({hostName:e,startDate:t,endDate:a,setQuery:n,deleteQuery:s})=>{const{buttonHref:o}=Object($p.a)({from:t,to:a,title:Vp.a}),l=Object(i.useMemo)((()=>({from:t,to:a})),[t,a]),{toggleStatus:c,setToggleStatus:u}=Object(Ea.a)(`${Wp} overTime`),{toggleStatus:d,setToggleStatus:p}=Object(Ea.a)(`${Wp} contributors`),[m,{data:g,refetch:f,inspect:b}]=Object(ms.c)({filterQuery:e?Object(Ii.w)([e]):void 0,onlyLatest:!1,skip:!c&&!d,timerange:l});Object(sr.b)({queryId:Wp,loading:m,refetch:f,setQuery:n,deleteQuery:s,inspect:b});const h=Object(i.useCallback)((e=>{p(e)}),[p]),y=Object(i.useCallback)((e=>{u(e)}),[u]),E=g&&g.length>0?g[g.length-1].risk_stats.rule_risks:[];return r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiFlexGroup,{direction:"row"},r.a.createElement(N.EuiFlexItem,{grow:2},r.a.createElement(wc,{from:t,to:a,loading:m,riskScore:g,queryId:Wp,title:ic.c,toggleStatus:c,toggleQuery:y})),r.a.createElement(N.EuiFlexItem,{grow:1},r.a.createElement(Hp,{loading:m,queryId:Wp,toggleStatus:d,toggleQuery:h,rules:E}))),r.a.createElement(Qp,{gutterSize:"s"},r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiButton,{href:o,isDisabled:!o,"data-test-subj":"risky-hosts-view-dashboard-button",target:"_blank"},ic.m)),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(hc,null))))};Gp.displayName="HostRiskTabBodyComponent";const Kp=r.a.memo(Gp);Kp.displayName="HostRiskTabBody";const Yp=r.a.memo((({severityCount:e})=>r.a.createElement(N.EuiFlexGroup,{justifyContent:"spaceBetween",gutterSize:"m","data-test-subj":"risk-score-severity-badges"},r.a.createElement(N.EuiFlexItem,{grow:!1}),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiFlexGroup,{gutterSize:"m"},Object.keys(rl.a).map((t=>r.a.createElement(N.EuiFlexItem,{key:t,grow:!1},r.a.createElement(Jp,{status:t,count:e[t]||0})))))))));Yp.displayName="SeverityBadges";const Jp=r.a.memo((({status:e,count:t})=>r.a.createElement(N.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(rl.b,{severity:e})),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiNotificationBadge,{size:"s",color:"subdued"},t)))));Jp.displayName="SeverityBadge";const Xp=z()(N.EuiColorPaletteDisplay).withConfig({displayName:"StyledEuiColorPaletteDisplay",componentId:"sc-s3n26r-0"})(["&.risk-score-severity-bar{border:none;border-radius:0;&:after{border:none;}}"]),Zp=({severityCount:e})=>{const t=Object(i.useMemo)((()=>Object.keys(rl.a).reduce(((t,a)=>{const n={stop:(t.length>0?t[t.length-1].stop:0)+(e[a]||0),color:rl.a[a]};return t.push(n),t}),[])),[e]);return r.a.createElement(Xp,{className:"risk-score-severity-bar","data-test-subj":"risk-score-severity-bar",size:"s",palette:t})},em=({severityCount:e,selectedSeverities:t,onSelect:a,title:n})=>{const[s,o]=Object(i.useState)(!1),l=Object(i.useCallback)((()=>{o(!s)}),[s]),c=Object(i.useCallback)((()=>{o(!1)}),[]),u=Object(N.useGeneratedHtmlId)({prefix:"filterGroupPopover"}),d=Object(i.useMemo)((()=>Object.keys(e).map((a=>({risk:a,count:e[a],checked:t.includes(a)?"on":void 0})))),[e,t]),p=Object(i.useCallback)((e=>{const n=null!=t?t:[],i=n.includes(e)?n.filter((t=>t!==e)):[...n,e];a(i)}),[t,a]),m=Object(i.useMemo)((()=>d.reduce(((e,t)=>"on"===t.checked?e+t.count:e),0)),[d]),g=Object(i.useMemo)((()=>r.a.createElement(N.EuiFilterButton,{"data-test-subj":"risk-filter-button",hasActiveFilters:!!d.find((e=>"on"===e.checked)),iconType:"arrowDown",isSelected:s,numActiveFilters:m,onClick:l},n)),[s,d,l,m,n]);return r.a.createElement(N.EuiFilterGroup,null,r.a.createElement(N.EuiPopover,{id:u,button:g,isOpen:s,closePopover:c,panelPaddingSize:"none"},r.a.createElement("div",{className:"euiFilterSelect__items"},d.map(((e,t)=>r.a.createElement(N.EuiFilterSelectItem,{"data-test-subj":`risk-filter-item-${e.risk}`,checked:e.checked,key:t+e.risk,onClick:()=>p(e.risk)},r.a.createElement(rl.b,{severity:e.risk})))))))},tm=[{text:Yo,numberOfRow:5},{text:Jo,numberOfRow:10}],am=z.a.span.withConfig({displayName:"IconWrapper",componentId:"sc-1nrygb8-0"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeS)),nm=wo.b.HostsTableType.risk,im=({data:e,id:t,isInspect:a,loading:n,loadPage:s,setQuerySkip:o,severityCount:c,totalCount:u,type:d})=>{const p=Object(l.useDispatch)(),m=Object(i.useMemo)((()=>wo.d.hostRiskScoreSelector()),[]),{activePage:g,limit:f,sort:b}=Object(v.a)((e=>m(e,wo.b.HostsType.page))),h=Object(i.useCallback)((e=>p(wo.a.updateTableLimit({hostsType:d,limit:e,tableType:nm}))),[d,p]),y=Object(i.useCallback)((e=>p(wo.a.updateTableActivePage({activePage:e,hostsType:d,tableType:nm}))),[d,p]),E=Object(i.useCallback)((e=>{if(null!=e.sort){const t=e.sort;t.direction===b.direction&&t.field===b.field||p(wo.a.updateHostRiskScoreSort({sort:t,hostsType:d}))}}),[p,b,d]),T=Object(i.useCallback)((e=>{p(wo.a.updateHostRiskScoreSeverityFilter({severitySelection:[e],hostsType:d}))}),[p,d]),k=Object(i.useMemo)((()=>(({dispatchSeverityUpdate:e})=>[{field:"host.name",name:Xo,truncateText:!1,mobileOptions:{show:!0},sortable:!0,render:e=>{if(null!=e&&e.length>0){const t=Object(Fo.h)(`host-risk-score-table-hostName-${e}`);return r.a.createElement(_o.b,{key:t,dataProvider:{and:[],enabled:!0,excluded:!1,id:t,name:e,kqlQuery:"",queryMatch:{field:"host.name",value:e,operator:Lo.c}},isAggregatable:!0,fieldType:"keyword",render:(t,a,n)=>n.isDragging?r.a.createElement(_o.a,null,r.a.createElement(No.a,{dataProvider:t})):r.a.createElement(ut.d,{hostName:e,hostTab:Es.HostsTableType.risk})})}return Object(vr.d)()}},{field:"risk_stats.risk_score",name:Zo,truncateText:!0,mobileOptions:{show:!0},sortable:!0,render:e=>null!=e?r.a.createElement("span",{"data-test-subj":"risk-score-truncate",title:`${e}`},e.toFixed(2)):Object(vr.d)()},{field:"risk",name:r.a.createElement(N.EuiToolTip,{content:tl},r.a.createElement(r.a.Fragment,null,el," ",r.a.createElement(N.EuiIcon,{color:"subdued",type:"iInCircle",className:"eui-alignTop"}))),truncateText:!1,mobileOptions:{show:!0},sortable:!0,render:t=>null!=t?r.a.createElement(rl.b,{toolTipContent:r.a.createElement(N.EuiLink,{onClick:()=>e(t)},r.a.createElement(N.EuiText,{size:"xs"},il(t.toLowerCase()))),severity:t}):Object(vr.d)()}])({dispatchSeverityUpdate:T})),[T]),x=r.a.createElement(N.EuiFlexGroup,{direction:"column",gutterSize:"s"},r.a.createElement(N.EuiFlexItem,null,r.a.createElement(Yp,{severityCount:c})),r.a.createElement(N.EuiFlexItem,null,r.a.createElement(Zp,{severityCount:c}))),S=r.a.createElement(r.a.Fragment,null,al,r.a.createElement(am,null,r.a.createElement(N.EuiIconTip,{color:"subdued",content:nl,position:"right",size:"l",type:"iInCircle"}))),O=Object(i.useMemo)((()=>wo.d.hostRiskScoreSeverityFilterSelector()),[]),w=Object(v.a)((e=>O(e,d))),j=Object(i.useCallback)((e=>{p(wo.a.updateHostRiskScoreSeverityFilter({severitySelection:e,hostsType:d}))}),[p,d]);return r.a.createElement(Ls.a,{activePage:g,columns:k,dataTestSubj:`table-${nm}`,headerCount:u,headerFilters:r.a.createElement(em,{selectedSeverities:w,severityCount:c,title:Ko,onSelect:j}),headerSupplement:x,headerTitle:S,headerUnit:zo(u),id:t,isInspect:a,itemsPerRow:tm,limit:f,loading:n,loadPage:s,onChange:E,pageOfItems:e,setQuerySkip:o,showMorePagesIndicator:!1,sorting:b,split:!0,stackHeader:!0,totalCount:u,updateLimitPagination:h,updateActivePage:y})};im.displayName="HostRiskScoreTableComponent";const rm=r.a.memo(im);rm.displayName="HostRiskScoreTable";const sm=Object(sr.a)(rm),om=({deleteQuery:e,endDate:t,filterQuery:a,skip:n,setQuery:s,startDate:o,type:l})=>{const c=Object(i.useMemo)((()=>wo.d.hostRiskScoreSelector()),[]),{activePage:u,limit:d,sort:p}=Object(v.a)((e=>c(e,wo.b.HostsType.page))),m=Object(i.useMemo)((()=>({cursorStart:u*d,querySize:d})),[u,d]),{toggleStatus:g}=Object(Ea.a)(ms.a.HOSTS_BY_RISK),[f,b]=Object(i.useState)(n||!g);Object(i.useEffect)((()=>{b(!g)}),[g]);const[h,{data:y,totalCount:T,inspect:k,isInspected:x,refetch:S}]=Object(ms.c)({filterQuery:a,skip:f,pagination:m,sort:p}),{severityCount:O,loading:w}=Object(ms.d)({filterQuery:a,skip:f});return r.a.createElement(sm,{deleteQuery:e,data:null!=y?y:[],id:ms.a.HOSTS_BY_RISK,inspect:k,isInspect:x,loading:h||w,loadPage:E.noop,refetch:S,setQuery:s,setQuerySkip:b,severityCount:O,totalCount:T,type:l})};om.displayName="HostRiskScoreQueryTabBody";var lm=a(75);const cm=F.i18n.translate("xpack.securitySolution.sessionsView.totalCountOfSessions",{defaultMessage:"sessions"}),um=F.i18n.translate("xpack.securitySolution.sessionsView.singleCountOfSessions",{defaultMessage:"session"}),dm=F.i18n.translate("xpack.securitySolution.sessionsView.columnSessionStart",{defaultMessage:"Started"}),pm=F.i18n.translate("xpack.securitySolution.sessionsView.columnExecutable",{defaultMessage:"Executable"}),mm=F.i18n.translate("xpack.securitySolution.sessionsView.columnEntryUser",{defaultMessage:"User"}),gm=F.i18n.translate("xpack.securitySolution.sessionsView.columnInteractive",{defaultMessage:"Interactive"}),fm=F.i18n.translate("xpack.securitySolution.sessionsView.columnHostName",{defaultMessage:"Hostname"}),bm=F.i18n.translate("xpack.securitySolution.sessionsView.columnEntryType",{defaultMessage:"Type"}),hm=F.i18n.translate("xpack.securitySolution.sessionsView.columnEntrySourceIp",{defaultMessage:"Source IP"}),ym=[{columnHeaderType:lm.a,id:"process.entry_leader.start",initialWidth:ie.b,display:dm},{columnHeaderType:lm.a,id:"process.entry_leader.executable",display:pm},{columnHeaderType:lm.a,id:"process.entry_leader.user.name",display:mm},{columnHeaderType:lm.a,id:"process.entry_leader.interactive",display:gm},{columnHeaderType:lm.a,id:"host.hostname",display:fm},{columnHeaderType:lm.a,id:"process.entry_leader.entry_meta.type",display:bm},{id:"process.entry_leader.entry_meta.source.ip",columnHeaderType:lm.a,display:hm}],Em={...le.a,columns:ym,defaultColumns:ym,excludedRowRendererIds:Object.values(c.d),sort:[{columnId:"process.entry_leader.start",columnType:"date",sortDirection:"desc"}]},vm={query:{bool:{filter:[{exists:{field:"process.entry_leader.entity_id"}}]}},meta:{alias:null,disabled:!1,key:"process.entry_leader.entity_id",negate:!1,params:{},type:"string"}},Tm=({timelineId:e,endDate:t,entityType:a="sessions",pageFilters:n,startDate:s,filterQuery:o})=>{const l=Object(i.useMemo)((()=>o&&""!==o?JSON.parse(o):{}),[o]),c=Object(i.useMemo)((()=>[{...vm,query:{...vm.query,bool:{...vm.query.bool,filter:vm.query.bool.filter.concat(l)}}},...n]),[n,l]),u=Object(i.useMemo)((()=>Object(re.a)(5)),[]);return r.a.createElement("div",{"data-test-subj":"security_solution:sessions_viewer:sessions_view"},r.a.createElement(Y.a,{pageFilters:c,defaultModel:Em,end:t,entityType:a,id:e,leadingControlColumns:u,renderCellValue:Ll.a,rowRenderers:se.b,scopeId:g.SourcererScopeName.default,start:s,unit:e=>e>1?cm:um}))};Tm.displayName="SessionsViewComponent";const km=r.a.memo(Tm),xm=r.a.memo((e=>{const{pageFilters:t,filterQuery:a,...n}=e,s=Object(i.useMemo)((()=>null!=t?[...ac.d,...t]:ac.d),[t]);return r.a.createElement(km,rr()({entityType:"sessions",timelineId:c.i.hostsPageSessions},n,{pageFilters:s,filterQuery:a}))}));xm.displayName="SessionsTabBody";var Sm=a(228);const Om=r.a.memo((({detailName:e,docValueFields:t,filterQuery:a,indexNames:n,indexPattern:s,pageFilters:o,setAbsoluteRangeDatePicker:l,hostDetailsPagePath:c})=>{const{from:u,to:d,isInitializing:p,deleteQuery:m,setQuery:g}=Object(H.a)(),f=Object(i.useCallback)(((e,t)=>{const a=Object(Ri.a)(e,t);l({id:"global",from:a.from,to:a.to})}),[l]),b=Object(i.useCallback)((({x:e})=>{if(!e)return;const[t,a]=e;l({id:"global",from:new Date(t).toISOString(),to:new Date(a).toISOString()})}),[l]),h={deleteQuery:m,endDate:d,filterQuery:a,skip:p||void 0===a,setQuery:g,startDate:u,type:_s.b,indexPattern:s,indexNames:n,hostName:e,narrowDateRange:f,updateDateRange:b};return r.a.createElement(P.Switch,null,r.a.createElement(R.Route,{path:`${c}/:tabName(${Es.HostsTableType.authentications})`},r.a.createElement(Do,rr()({docValueFields:t},h))),r.a.createElement(R.Route,{path:`${c}/:tabName(${Es.HostsTableType.hosts})`},r.a.createElement(fl,h)),r.a.createElement(R.Route,{path:`${c}/:tabName(${Es.HostsTableType.uncommonProcesses})`},r.a.createElement(_l,h)),r.a.createElement(R.Route,{path:`${c}/:tabName(${Es.HostsTableType.anomalies})`},r.a.createElement(vs.a,rr()({},h,{AnomaliesTableComponent:Ps}))),r.a.createElement(R.Route,{path:`${c}/:tabName(${Es.HostsTableType.events})`},r.a.createElement(Rs.a,rr()({},h,{pageFilters:o,timelineId:Sm.b.hostsPageEvents}))),r.a.createElement(R.Route,{path:`${c}/:tabName(${Es.HostsTableType.alerts})`},r.a.createElement(nc,rr()({},h,{pageFilters:o}))),r.a.createElement(R.Route,{path:`${c}/:tabName(${Es.HostsTableType.risk})`},r.a.createElement(Kp,h)),r.a.createElement(R.Route,{path:`${c}/:tabName(${Es.HostsTableType.sessions})`},r.a.createElement(xm,h)))}));Om.displayName="HostDetailsTabs";const wm=(e,t)=>`${o.Ab}/${e}/${t}`,jm=({hasMlUserPermissions:e,isRiskyHostsEnabled:t,hostName:a})=>{const n=[],i={[Es.HostsTableType.authentications]:{id:Es.HostsTableType.authentications,name:ic.g,href:wm(a,Es.HostsTableType.authentications),disabled:!1},[Es.HostsTableType.uncommonProcesses]:{id:Es.HostsTableType.uncommonProcesses,name:ic.k,href:wm(a,Es.HostsTableType.uncommonProcesses),disabled:!1},[Es.HostsTableType.anomalies]:{id:Es.HostsTableType.anomalies,name:ic.f,href:wm(a,Es.HostsTableType.anomalies),disabled:!1},[Es.HostsTableType.events]:{id:Es.HostsTableType.events,name:ic.h,href:wm(a,Es.HostsTableType.events),disabled:!1},[Es.HostsTableType.alerts]:{id:Es.HostsTableType.alerts,name:ic.d,href:wm(a,Es.HostsTableType.alerts),disabled:!1},[Es.HostsTableType.risk]:{id:Es.HostsTableType.risk,name:ic.i,href:wm(a,Es.HostsTableType.risk),disabled:!1},[Es.HostsTableType.sessions]:{id:Es.HostsTableType.sessions,name:ic.j,href:wm(a,Es.HostsTableType.sessions),disabled:!1,isBeta:!0}};return e||n.push(Es.HostsTableType.anomalies),t||n.push(Es.HostsTableType.risk),Object(E.omit)(n,i)};var Cm=a(840);const Im=Object(sr.a)(bs.a),Mm=({detailName:e,hostDetailsPagePath:t})=>{const a=Object(l.useDispatch)(),n=Object(i.useMemo)((()=>p.b.getTimelineByIdSelector()),[]),s=Object(v.b)((e=>{var t;return(null!==(t=n(e,c.i.hostsPageEvents))&&void 0!==t?t:le.a).graphEventId})),o=Object(i.useMemo)((()=>ae.e.globalFiltersQuerySelector()),[]),u=Object(i.useMemo)((()=>ae.e.globalQuerySelector()),[]),g=Object(v.a)(u),f=Object(v.a)(o),{to:h,from:k,deleteQuery:x,setQuery:S,isInitializing:O}=Object(H.a)(),{globalFullScreen:w}=Object(dt.a)(),j=Object(Pi.a)(),C=Object(d.j)(),I=Object(i.useMemo)((()=>{return[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:"host.name",value:t=e,params:{query:t}},query:{match:{"host.name":{query:t,type:"phrase"}}}}];var t}),[e]),M=Object(i.useCallback)((({x:e})=>{if(!e)return;const[t,n]=e;a(Object(G.setAbsoluteRangeDatePicker)({id:"global",from:new Date(t).toISOString(),to:new Date(n).toISOString()}))}),[a]),{docValueFields:A,indexPattern:D,indicesExist:q,selectedPatterns:P}=Object(m.d)(),[R,{inspect:_,hostDetails:F,id:L,refetch:B}]=Object(Cm.b)({endDate:h,startDate:k,hostName:e,indexNames:P,skip:0===P.length}),[z,U]=Object(hs.b)({config:Object(K.getEsQueryConfig)(C.services.uiSettings),indexPattern:D,queries:[g],filters:[...I,...f]});Object(ee.a)({id:Cm.a,filterQuery:z,kqlError:U,query:g,startDate:k,endDate:h}),Object(i.useEffect)((()=>{a(Object(ys.setHostDetailsTablesActivePageToZero)())}),[a,e]);const V=Object(Z.a)("riskyHostsEnabled");return r.a.createElement(r.a.Fragment,null,q?r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiWindowEvent,{event:"resize",handler:E.noop}),r.a.createElement($.a,{show:Object(oe.n)({globalFullScreen:w,graphEventId:s})},r.a.createElement(Q.a,{indexPattern:D,id:"global"})),r.a.createElement(b.a,{noPadding:w,"data-test-subj":"hostDetailsPage"},r.a.createElement(pt,{show:!w},r.a.createElement(Ta.a,{border:!0,subtitle:r.a.createElement(Mi.a,{docValueFields:A,indexKey:Ii.i.hostDetails,hostName:e,indexNames:P}),title:e}),r.a.createElement(Ai.a,{criteriaFields:Object(Di.a)(F),startDate:k,endDate:h,skip:O},(({isLoadingAnomaliesData:t,anomaliesData:a})=>r.a.createElement(Im,{docValueFields:A,id:L,isInDetailsSidePanel:!1,data:F,anomaliesData:a,isLoadingAnomaliesData:t,indexNames:P,loading:R,startDate:k,endDate:h,narrowDateRange:(e,t)=>{const a=Object(Ri.a)(e,t);Object(G.setAbsoluteRangeDatePicker)({id:"global",from:a.from,to:a.to})},setQuery:S,refetch:B,inspect:_,hostName:e}))),r.a.createElement(N.EuiHorizontalRule,null),r.a.createElement(fs,{filterQuery:z,from:k,indexNames:P,setQuery:S,to:h,narrowDateRange:M,skip:O}),r.a.createElement(N.EuiSpacer,null),r.a.createElement(Ki,{navTabs:jm({hasMlUserPermissions:Object(qi.a)(j),isRiskyHostsEnabled:V,hostName:e})}),r.a.createElement(N.EuiSpacer,null)),r.a.createElement(Om,{docValueFields:A,indexNames:P,isInitializing:O,deleteQuery:x,pageFilters:I,to:h,from:k,detailName:e,type:_s.b,setQuery:S,filterQuery:z,hostDetailsPagePath:t,indexPattern:D,setAbsoluteRangeDatePicker:G.setAbsoluteRangeDatePicker}))):r.a.createElement(ka.a,null),r.a.createElement(y.a,{pageName:T.a.hosts}))};Mm.displayName="HostDetailsComponent";const Am=r.a.memo(Mm);var Dm=a(396),qm=a(98),Pm=a(175);const Rm=e=>{try{return Object(Pm.decode)(e)}catch(e){return null}},_m=e=>Object(E.isObject)(e),Fm=e=>Object(E.isString)(e),Lm=(e,t)=>t.reduce(((t,a,n)=>{const i=((e,t)=>1===e.length?`${e[0]}: "${t}"`:e.reduce(((e,a,n,i)=>0===n?`(${a}: "${t}"`:n===i.length-1?`${e} or ${a}: "${t}")`:`${e} or ${a}: "${t}"`),""))(e,a);return 0===n?i:`${t} or ${i}`}),""),Nm=(e,t,a)=>{const n=Rm(a);if(_m(n)){const a=n;if(_m(a)&&Fm(a.query)){const i=Lm(e,t);return""!==a.query&&""!==i?a.query=`(${i}) and (${a.query})`:""===a.query&&""!==i&&(a.query=`(${i})`),Object(Pm.encode)(n)}}else if(null==n){const a=Lm(e,t);return Object(Pm.encode)({query:`(${a})`,language:"kuery"})}return a},Bm=(e,t,a)=>`(${a.split(",").reduce(((e,a,n)=>0===n?`${t}: "${a}"`:`${e} or ${t}: "${a}"`),"")})`,zm=e=>{const t=Rm(e);if(_m(t)){const e=t;if(_m(e)&&Fm(e.query))return e.query=e.query.replace(/([\w\.\-\[\]]+)\s*:\s*"(([\w\.\-\(\)\[\]]+,[\w\.\-\(\)\[\]]+){1,})"/g,Bm),Object(Pm.encode)(t)}return e},Um=["and","or","not"],Hm=(e,...t)=>{if(null==t)return"";const a=t.reduce(((e,t)=>null!=t&&Um.includes(t)?[...e,t]:e),[]);return a.length>1?` ${a[a.length-1].trim()} `:""},$m=e=>{const t=Rm(e);if(_m(t)){const e=t;if(_m(e)&&Fm(e.query))return e.query=e.query.replace(/(\s+)*(and|or|not){0,1}(\s+)*([\w\.\-\[\]]+)\s*:\s*"(\$[\w\.\-\(\)\[\]]+\$)"(\s+)*(and|or|not){0,1}(\s+)*/g,Hm),Object(Pm.encode)(t)}return e},Vm=e=>Object(E.flow)(zm,$m)(e),Qm=e=>""===e.trim()||e.startsWith("$")&&e.endsWith("$"),Wm=e=>e.split(",").length>1,Gm=e=>e.split(","),Km=r.a.memo((()=>{const{path:e}=Object(P.useRouteMatch)();return r.a.createElement(P.Switch,null,r.a.createElement(R.Route,{strict:!0,exact:!0,path:e,render:({location:e})=>{const t=Object(Dm.parse)(e.search.substring(1),{sort:!1});null!=t.query&&(t.query=Vm(t.query));const a=Object(Dm.stringify)(qm.url.encodeQuery(t),{sort:!1,encode:!1});return r.a.createElement(P.Redirect,{to:`${o.Ab}?${a}`})}}),r.a.createElement(R.Route,{path:`${e}/:hostName`,render:({location:e,match:{params:{hostName:t}}})=>{const a=Object(Dm.parse)(e.search.substring(1),{sort:!1});if(null!=a.query&&(a.query=Vm(a.query)),Qm(t)){const e=Object(Dm.stringify)(qm.url.encodeQuery(a),{sort:!1,encode:!1});return r.a.createElement(P.Redirect,{to:`${o.Ab}/${Es.HostsTableType.anomalies}?${e}`})}if(Wm(t)){const e=Gm(t);a.query=Nm(["host.name"],e,a.query||"");const n=Object(Dm.stringify)(qm.url.encodeQuery(a),{sort:!1,encode:!1});return r.a.createElement(P.Redirect,{to:`${o.Ab}/${Es.HostsTableType.anomalies}?${n}`})}{const e=Object(Dm.stringify)(qm.url.encodeQuery(a),{sort:!1,encode:!1});return r.a.createElement(P.Redirect,{to:`${o.Ab}/${t}/${Es.HostsTableType.anomalies}?${e}`})}}}),r.a.createElement(R.Route,{path:`${o.Ab}/ml-hosts/`,render:({location:{search:e=""}})=>r.a.createElement(P.Redirect,{from:`${o.Ab}/ml-hosts/`,to:`${o.Ab}/ml-hosts${e}`})}))}));Km.displayName="MlHostConditionalContainer";const Ym=Object(i.memo)((({deleteQuery:e,docValueFields:t,filterQuery:a,pageFilters:n,from:s,indexNames:l,isInitializing:c,setAbsoluteRangeDatePicker:u,setQuery:d,to:p,type:m})=>{const g={deleteQuery:e,endDate:p,filterQuery:a,indexNames:l,skip:c||void 0===a,setQuery:d,startDate:s,type:m,narrowDateRange:Object(i.useCallback)(((e,t)=>{const a=Object(Ri.a)(e,t);u({id:"global",from:a.from,to:a.to})}),[u]),updateDateRange:Object(i.useCallback)((({x:e})=>{if(!e)return;const[t,a]=e;u({id:"global",from:new Date(t).toISOString(),to:new Date(a).toISOString()})}),[u])};return r.a.createElement(P.Switch,null,r.a.createElement(R.Route,{path:`${o.Ab}/:tabName(${Es.HostsTableType.hosts})`},r.a.createElement(fl,rr()({docValueFields:t},g))),r.a.createElement(R.Route,{path:`${o.Ab}/:tabName(${Es.HostsTableType.authentications})`},r.a.createElement(Do,rr()({docValueFields:t},g))),r.a.createElement(R.Route,{path:`${o.Ab}/:tabName(${Es.HostsTableType.risk})`},r.a.createElement(om,g)),r.a.createElement(R.Route,{path:`${o.Ab}/:tabName(${Es.HostsTableType.uncommonProcesses})`},r.a.createElement(_l,g)),r.a.createElement(R.Route,{path:`${o.Ab}/:tabName(${Es.HostsTableType.anomalies})`},r.a.createElement(vs.a,rr()({},g,{AnomaliesTableComponent:Ps}))),r.a.createElement(R.Route,{path:`${o.Ab}/:tabName(${Es.HostsTableType.events})`},r.a.createElement(Rs.a,rr()({},g,{timelineId:Sm.b.hostsPageEvents,pageFilters:n}))),r.a.createElement(R.Route,{path:`${o.Ab}/:tabName(${Es.HostsTableType.alerts})`},r.a.createElement(nc,rr()({},g,{pageFilters:n}))),r.a.createElement(R.Route,{path:`${o.Ab}/:tabName(${Es.HostsTableType.sessions})`},r.a.createElement(xm,g)))}));Ym.displayName="HostsTabs";const Jm=e=>`${o.Ab}/${e}`,Xm=({hasMlUserPermissions:e,isRiskyHostsEnabled:t,isUsersEnabled:a})=>{const n=[],i={[Es.HostsTableType.hosts]:{id:Es.HostsTableType.hosts,name:ic.e,href:Jm(Es.HostsTableType.hosts),disabled:!1},[Es.HostsTableType.authentications]:{id:Es.HostsTableType.authentications,name:ic.g,href:Jm(Es.HostsTableType.authentications),disabled:!1},[Es.HostsTableType.uncommonProcesses]:{id:Es.HostsTableType.uncommonProcesses,name:ic.k,href:Jm(Es.HostsTableType.uncommonProcesses),disabled:!1},[Es.HostsTableType.anomalies]:{id:Es.HostsTableType.anomalies,name:ic.f,href:Jm(Es.HostsTableType.anomalies),disabled:!1},[Es.HostsTableType.events]:{id:Es.HostsTableType.events,name:ic.h,href:Jm(Es.HostsTableType.events),disabled:!1},[Es.HostsTableType.alerts]:{id:Es.HostsTableType.alerts,name:ic.d,href:Jm(Es.HostsTableType.alerts),disabled:!1},[Es.HostsTableType.risk]:{id:Es.HostsTableType.risk,name:ic.i,href:Jm(Es.HostsTableType.risk),disabled:!1},[Es.HostsTableType.sessions]:{id:Es.HostsTableType.sessions,name:ic.j,href:Jm(Es.HostsTableType.sessions),disabled:!1,isBeta:!0}};return e||n.push(Es.HostsTableType.anomalies),t||n.push(Es.HostsTableType.risk),a&&n.push(Es.HostsTableType.authentications),Object(E.omit)(n,i)};var Zm=a(526);const eg=z.a.div.withConfig({displayName:"StyledFullHeightContainer",componentId:"sc-13ka402-0"})(["display:flex;flex-direction:column;flex:1 1 auto;"]),tg=()=>{const e=Object(l.useDispatch)(),t=Object(i.useRef)(null),a=Object(i.useMemo)((()=>p.b.getTimelineByIdSelector()),[]),n=Object(v.b)((e=>{var t,n;return(null!==(t=null!==(n=a(e,c.i.hostsPageEvents))&&void 0!==n?n:a(e,c.i.hostsPageExternalAlerts))&&void 0!==t?t:le.a).graphEventId})),s=Object(i.useMemo)((()=>ae.e.globalFiltersQuerySelector()),[]),o=Object(i.useMemo)((()=>ae.e.globalQuerySelector()),[]),u=Object(v.a)(o),g=Object(v.a)(s),f=Object(i.useMemo)((()=>wo.d.hostRiskScoreSeverityFilterSelector()),[]),h=Object(v.a)((e=>f(e,wo.b.HostsType.page))),{to:k,from:x,deleteQuery:S,setQuery:O,isInitializing:w}=Object(H.a)(),{globalFullScreen:j}=Object(dt.a)(),C=Object(Pi.a)(),{uiSettings:I}=Object(d.j)().services,{tabName:M}=Object(P.useParams)(),A=r.a.useMemo((()=>M===Es.HostsTableType.alerts||M===Es.HostsTableType.events?g.length>0?[...g,...ac.d]:ac.d:M===Es.HostsTableType.risk?[...Object(Zm.a)(h),...ac.d,...g]:g),[h,M,g]),D=Object(i.useCallback)((({x:t})=>{if(!t)return;const[a,n]=t;e(Object(G.setAbsoluteRangeDatePicker)({id:"global",from:new Date(a).toISOString(),to:new Date(n).toISOString()}))}),[e]),{docValueFields:q,indicesExist:R,indexPattern:_,selectedPatterns:F,loading:L}=Object(m.d)(),[B,z]=Object(i.useMemo)((()=>Object(hs.b)({config:Object(K.getEsQueryConfig)(I),indexPattern:_,queries:[u],filters:g})),[g,_,I,u]),[V]=Object(i.useMemo)((()=>Object(hs.b)({config:Object(K.getEsQueryConfig)(I),indexPattern:_,queries:[u],filters:A})),[_,u,A,I]),W=Object(Z.a)("riskyHostsEnabled"),Y=Object(Z.a)("usersEnabled");Object(ee.a)({id:Ro,filterQuery:B,kqlError:z,query:u,startDate:x,endDate:k});const J=Object(i.useCallback)((()=>{var e,a;null===(e=t.current)||void 0===e||null===(a=e.querySelector(".inspectButtonComponent:last-of-type"))||void 0===a||a.focus()}),[t]),X=Object(i.useCallback)((()=>{Object(oe.m)()}),[]),te=Object(i.useCallback)((e=>{Object(U.isTab)(e)&&Object(oe.l)({containerElement:t.current,keyboardEvent:e,onSkipFocusBeforeEventsTable:J,onSkipFocusAfterEventsTable:X})}),[t,J,X]);return L?r.a.createElement(Fa.a,{"data-test-subj":"loadingPanelExploreHosts",overlay:!0,size:"xl"}):r.a.createElement(r.a.Fragment,null,R?r.a.createElement(eg,{onKeyDown:te,ref:t},r.a.createElement(N.EuiWindowEvent,{event:"resize",handler:E.noop}),r.a.createElement($.a,{show:Object(oe.n)({globalFullScreen:j,graphEventId:n})},r.a.createElement(Q.a,{indexPattern:_,id:"global"})),r.a.createElement(b.a,{noPadding:j},r.a.createElement(pt,{show:!j},r.a.createElement(Ta.a,{subtitle:r.a.createElement(Mi.a,{docValueFields:q,indexKey:Ii.i.hosts,indexNames:F}),title:ic.l,border:!0}),r.a.createElement(gs,{filterQuery:B,indexNames:F,from:x,setQuery:O,to:k,skip:w||!B,narrowDateRange:D}),r.a.createElement(N.EuiSpacer,null),r.a.createElement(Ki,{navTabs:Xm({hasMlUserPermissions:Object(qi.a)(C),isRiskyHostsEnabled:W,isUsersEnabled:Y})}),r.a.createElement(N.EuiSpacer,null)),r.a.createElement(Ym,{deleteQuery:S,docValueFields:q,to:k,filterQuery:V||"",isInitializing:w,indexNames:F,setAbsoluteRangeDatePicker:G.setAbsoluteRangeDatePicker,setQuery:O,from:x,type:wo.b.HostsType.page,pageFilters:A}))):r.a.createElement(ka.a,null),r.a.createElement(y.a,{pageName:T.a.hosts}))};tg.displayName="HostsComponent";const ag=r.a.memo(tg),ng=`${o.Ab}/:detailName`,ig=r.a.memo((()=>r.a.createElement(P.Switch,null,r.a.createElement(R.Route,{path:`${o.Ab}/ml-hosts`},r.a.createElement(Km,null)),r.a.createElement(R.Route,{path:`${o.Ab}/:tabName(${Es.HostsTableType.hosts}|${Es.HostsTableType.authentications}|${Es.HostsTableType.uncommonProcesses}|${Es.HostsTableType.anomalies}|${Es.HostsTableType.events}|${Es.HostsTableType.risk}|${Es.HostsTableType.alerts}|${Es.HostsTableType.sessions})`},r.a.createElement(ag,null)),r.a.createElement(R.Route,{path:`${ng}/:tabName(${Es.HostsTableType.authentications}|${Es.HostsTableType.uncommonProcesses}|${Es.HostsTableType.anomalies}|${Es.HostsTableType.events}|${Es.HostsTableType.risk}|${Es.HostsTableType.alerts}|${Es.HostsTableType.sessions})`,render:({match:{params:{detailName:e}}})=>r.a.createElement(Am,{hostDetailsPagePath:ng,detailName:decodeURIComponent(e)})}),r.a.createElement(R.Route,{path:ng,render:({match:{params:{detailName:e}},location:{search:t=""}})=>r.a.createElement(P.Redirect,{to:{pathname:`${o.Ab}/${e}/${Es.HostsTableType.authentications}`,search:t}})}),r.a.createElement(R.Route,{path:o.Ab,render:({location:{search:e=""}})=>r.a.createElement(P.Redirect,{to:{pathname:`${o.Ab}/${Es.HostsTableType.hosts}`,search:e}})}))));ig.displayName="HostsContainer";const rg=[{path:o.Ab,render:()=>r.a.createElement(s.TrackApplicationView,{viewId:T.a.hosts},r.a.createElement(ig,null))}],sg=[c.i.hostsPageEvents,c.i.hostsPageExternalAlerts,c.i.hostsPageSessions];var og=a(233);const lg=F.i18n.translate("xpack.securitySolution.usersTable.title",{defaultMessage:"Users"}),cg=F.i18n.translate("xpack.securitySolution.usersTable.userNameTitle",{defaultMessage:"User name"}),ug=F.i18n.translate("xpack.securitySolution.usersTable.lastSeenTitle",{defaultMessage:"Last seen"}),dg=F.i18n.translate("xpack.securitySolution.usersTable.domainTitle",{defaultMessage:"Domain"}),pg=F.i18n.translate("xpack.securitySolution.usersTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),mg=F.i18n.translate("xpack.securitySolution.usersTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),gg=e=>F.i18n.translate("xpack.securitySolution.usersTable.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {user} other {users}}"});var fg=a(306);const bg=fg.c.UsersTableType.allUsers,hg=[{text:pg,numberOfRow:5},{text:mg,numberOfRow:10}],yg=({users:e,totalCount:t,type:a,id:n,fakeTotalCount:s,loading:o,loadPage:c,showMorePagesIndicator:u,sort:d,setQuerySkip:p})=>{const m=Object(l.useDispatch)(),g=Object(i.useMemo)((()=>fg.e.allUsersSelector()),[]),{activePage:f,limit:b}=Object(v.a)((e=>g(e))),h=Object(i.useCallback)((e=>{m(fg.b.updateTableLimit({usersType:a,limit:e,tableType:bg}))}),[a,m]),y=Object(i.useCallback)((e=>{m(fg.b.updateTableActivePage({activePage:e,usersType:a,tableType:bg}))}),[a,m]),E=Object(i.useCallback)((e=>{if(null!=e.sort){const t=e.sort;t.direction===d.direction&&t.field===d.field||m(fg.b.updateTableSorting({sort:t,tableType:bg}))}}),[m,d]),T=Object(i.useMemo)((()=>[{field:"name",name:cg,truncateText:!1,sortable:!0,mobileOptions:{show:!0},render:e=>null!=e&&e.length>0?Object(xs.c)({rowItems:[e],attrName:"user.name",idPrefix:`users-table-${e}-name`,render:e=>r.a.createElement(ut.m,{userName:e}),isAggregatable:!0,fieldType:"keyword"}):Object(vr.f)(e)},{field:"lastSeen",name:ug,sortable:!0,truncateText:!1,mobileOptions:{show:!0},render:e=>r.a.createElement(wn.b,{value:e})},{field:"domain",name:dg,sortable:!1,truncateText:!1,mobileOptions:{show:!0},render:e=>null!=e&&e.length>0?Object(xs.c)({rowItems:[e],attrName:"user.domain",idPrefix:`users-table-${e}-domain`,isAggregatable:!0,fieldType:"keyword"}):Object(vr.f)(e)}]),[]);return r.a.createElement(Ls.a,{activePage:f,columns:T,dataTestSubj:`table-${bg}`,headerCount:t,headerTitle:lg,headerUnit:gg(t),id:n,itemsPerRow:hg,limit:b,loading:o,loadPage:c,pageOfItems:e,showMorePagesIndicator:u,totalCount:s,updateLimitPagination:h,updateActivePage:y,sorting:d,onChange:E,setQuerySkip:p})};yg.displayName="UsersTableComponent";const Eg=r.a.memo(yg);var vg=a(9),Tg=a(234),kg=a(169),xg=a(188);const Sg=e=>F.i18n.translate("xpack.securitySolution.searchStrategy.error",{values:{factoryQueryType:e},defaultMessage:"Failed to run search: {factoryQueryType}"}),Og=e=>(({data:e,signal:t,factoryQueryType:a,defaultIndex:n,filterQuery:i,timerange:r,...s})=>e.search.search({...s,factoryQueryType:a,defaultIndex:n,timerange:r,filterQuery:i},{strategy:"securitySolutionSearchStrategy",abortSignal:t}))(e).pipe(Object(vg.filter)((e=>Object(kg.isErrorResponse)(e)||Object(kg.isCompleteResponse)(e)))),wg={dsl:[],response:[]},jg=({factoryQueryType:e,initialResult:t,errorMessage:a,abort:n=!1})=>{const r=Object(i.useRef)(new AbortController),s=Object(i.useRef)(E.noop),{data:o}=Object(d.j)().services,{addError:l}=Object(X.a)(),{start:c,error:u,result:p,loading:m}=Object(Tg.c)(Og);Object(i.useEffect)((()=>{null==u||u instanceof xg.AbortError||l(u,{title:null!=a?a:Sg(e)})}),[l,u,a,e]);const g=Object(i.useCallback)((t=>{const a=()=>{r.current=new AbortController,c({...t,data:o,factoryQueryType:e,signal:r.current.signal})};r.current.abort(),a(),s.current=a}),[o,c,e]);Object(i.useEffect)((()=>()=>{r.current.abort()}),[]),Object(i.useEffect)((()=>{n&&r.current.abort()}),[n]);const[f,b]=Object(i.useMemo)((()=>[p?Object(E.omit)("rawResponse",p):t,p?Object(ar.c)(p,wg):wg]),[p,t]);return{loading:m,result:f,error:u,search:g,refetch:s.current,inspect:b}};var Cg=a(104);const Ig=F.i18n.translate("xpack.securitySolution.userTab.errorFetchingsData",{defaultMessage:"Failed to query users data"}),Mg=Object(sr.a)(Eg),Ag="UsersTable",Dg=({endDate:e,filterQuery:t,indexNames:a,skip:n,setQuery:s,startDate:o,type:l,docValueFields:c,deleteQuery:u})=>{const{toggleStatus:d}=Object(Ea.a)(Ag),[p,m]=Object(i.useState)(n||!d);Object(i.useEffect)((()=>{m(n||!d)}),[n,d]);const g=Object(i.useMemo)((()=>fg.e.allUsersSelector()),[]),{activePage:f,limit:b,sort:h}=Object(v.a)((e=>g(e))),{loading:y,result:{users:T,pageInfo:k,totalCount:x},search:S,refetch:O,inspect:w}=jg({factoryQueryType:Cg.b.users,initialResult:{users:[],totalCount:0,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1}},errorMessage:Ig,abort:p});return Object(i.useEffect)((()=>{p||S({filterQuery:t,defaultIndex:a,docValueFields:c,timerange:{interval:"12h",from:o,to:e},pagination:Object(ko.a)(f,b),sort:h})}),[S,o,e,t,a,p,c,f,b,h]),r.a.createElement(Mg,{users:T,deleteQuery:u,fakeTotalCount:Object(E.getOr)(50,"fakeTotalCount",k),id:Ag,inspect:w,loading:y,loadPage:E.noop,refetch:O,showMorePagesIndicator:Object(E.getOr)(!1,"showMorePagesIndicator",k),setQuery:s,totalCount:x,type:l,sort:h,setQuerySkip:m})};Dg.displayName="AllUsersQueryTabBody";var qg=a(114);const Pg="authenticationsUsersTableQuery",Rg=({docValueFields:e,endDate:t,filterQuery:a,indexNames:n,skip:s,startDate:o,type:c,setQuery:u,deleteQuery:d,userName:p})=>{const m=Object(l.useDispatch)(),{toggleStatus:g}=Object(Ea.a)(Pg),[f,b]=Object(i.useState)(s||!g);Object(i.useEffect)((()=>{b(s||!g)}),[s,g]);const h=Object(i.useMemo)((()=>fg.e.authenticationsSelector()),[]),{activePage:y,limit:T}=Object(v.a)((e=>h(e))),[k,{authentications:x,totalCount:S,pageInfo:O,loadPage:w,inspect:j,isInspected:C,refetch:I}]=Oo({docValueFields:e,endDate:t,filterQuery:a,indexNames:n,skip:f,startDate:o,activePage:y,limit:T,stackByField:p?qg.a.hostName:qg.a.userName}),M=Object(i.useMemo)((()=>p?[go,fo,ro,so,oo,co,uo]:no(!0)),[p]),A=Object(i.useCallback)((e=>m(fg.b.updateTableLimit({usersType:c,limit:e,tableType:fg.c.UsersTableType.authentications}))),[c,m]),D=Object(i.useCallback)((e=>m(fg.b.updateTableActivePage({activePage:e,usersType:c,tableType:fg.c.UsersTableType.authentications}))),[c,m]);return Object(sr.b)({queryId:Pg,loading:k,refetch:I,setQuery:u,deleteQuery:d,inspect:j}),r.a.createElement(Ls.a,{activePage:y,columns:M,dataTestSubj:"table-users-authentications",headerCount:S,headerTitle:Ns,headerUnit:p?zs(S):Bs(S),id:Pg,isInspect:C,itemsPerRow:io,limit:T,loading:k,loadPage:w,pageOfItems:x,setQuerySkip:b,showMorePagesIndicator:Object(E.getOr)(!1,"showMorePagesIndicator",O),totalCount:Object(E.getOr)(50,"fakeTotalCount",O),updateLimitPagination:A,updateActivePage:D})};Rg.displayName="AuthenticationsUserTableComponent";const _g=r.a.memo(Rg),Fg=({endDate:e,filterQuery:t,indexNames:a,skip:n,setQuery:i,startDate:s,type:o,docValueFields:l,deleteQuery:c,userName:u})=>r.a.createElement(r.a.Fragment,null,r.a.createElement(Fs.a,rr()({endDate:e,filterQuery:t,id:"usersAuthenticationsHistogramQuery",indexNames:a,setQuery:i,startDate:s},vo)),r.a.createElement(_g,{endDate:e,filterQuery:t,indexNames:a,setQuery:i,deleteQuery:c,startDate:s,type:o,skip:n,docValueFields:l,userName:u}));Fg.displayName="AllUsersQueryTabBody";var Lg=a(549);const Ng=(e,t)=>"user.name"===e.entityName&&(null==t||e.entityValue===t),Bg={sort:{field:"anomaly.severity",direction:"desc"}},zg=({startDate:e,endDate:t,userName:a,skip:n,type:s})=>{const o=Object(Pi.a)(),{toggleStatus:l,setToggleStatus:c}=Object(Ea.a)("AnomaliesUserTable"),[u,d]=Object(i.useState)(n||!l);Object(i.useEffect)((()=>{d(n||!l)}),[n,l]);const p=Object(i.useCallback)((e=>{c(e),d(!e)}),[d,c]),[m,g]=Object(Ts.a)({startDate:e,endDate:t,skip:u,criteriaFields:Object(Lg.a)(s,a),filterQuery:{exists:{field:"user.name"}}}),f=((e,t)=>null==e?[]:e.anomalies.reduce(((e,a)=>{if(Ng(a,t))return[...e,{userName:a.entityValue,anomaly:a}];{const n=((e=[],t)=>{const a=e.find((e=>{const[a,n]=Object(ws.a)(e);return"user.name"===a&&(null==t||n===t)}));return null!=a?Object.values(a)[0]:null})(a.influencers,t);return null!=n?[...e,{userName:n,anomaly:a}]:e}}),[]))(g,a),b=((e,t,a)=>{const n=((e,t)=>[{name:ks.l,field:"userName",sortable:!0,render:(e,t)=>Object(xs.b)({rowItem:e,attrName:"user.name",idPrefix:`anomalies-user-table-userName-${Object(Ss.a)(t.anomaly)}-userName`,render:e=>r.a.createElement(ut.m,{userName:e}),isAggregatable:!0,fieldType:"keyword"})},...Object(Os.a)(e,t)])(t,a);return e===og.UsersType.details?n.filter((e=>e.name!==ks.l)):n})(s,e,t),h={initialPageIndex:0,initialPageSize:10,totalItemCount:f.length,pageSizeOptions:[5,10,20,50],showPerPageOptions:!0};return Object(qi.a)(o)?r.a.createElement(Ms.a,{loading:m,"data-test-subj":"user-anomalies-tab"},r.a.createElement(la.a,{subtitle:`${ks.h}: ${h.totalItemCount.toLocaleString()} ${ks.k(h.totalItemCount)}`,title:ks.a,toggleQuery:p,toggleStatus:l,tooltip:ks.j,isInspectDisabled:n}),l&&r.a.createElement(Cs.a,{"data-test-subj":"user-anomalies-table",columns:b,items:f,pagination:h,sorting:Bg}),m&&r.a.createElement(Fa.a,{"data-test-subj":"anomalies-host-table-loading-panel",overlay:!0,size:"xl"})):null},Ug=r.a.memo(zg,As.a),Hg=F.i18n.translate("xpack.securitySolution.usersRiskTable.userNameTitle",{defaultMessage:"User Name"}),$g=F.i18n.translate("xpack.securitySolution.usersRiskTable.userRiskScoreTitle",{defaultMessage:"User risk score"}),Vg=F.i18n.translate("xpack.securitySolution.usersRiskTable.userRiskToolTip",{defaultMessage:"User risk classification is determined by user risk score. Users classified as Critical or High are indicated as risky."}),Qg=F.i18n.translate("xpack.securitySolution.usersRiskTable.riskTitle",{defaultMessage:"User risk classification"}),Wg=e=>F.i18n.translate("xpack.securitySolution.usersTable.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {user} other {users}}"}),Gg=F.i18n.translate("xpack.securitySolution.usersTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),Kg=F.i18n.translate("xpack.securitySolution.usersTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),Yg=F.i18n.translate("xpack.securitySolution.hostsRiskTable.usersTableTitle",{defaultMessage:"The user risk table is not affected by the KQL time range. This table shows the latest recorded risk score for each user."});var Jg=a(382);const Xg=z.a.span.withConfig({displayName:"IconWrapper",componentId:"sc-y8w1ia-0"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeS)),Zg=[{text:Gg,numberOfRow:5},{text:Kg,numberOfRow:10}],ef=fg.c.UsersTableType.risk,tf=({data:e,id:t,isInspect:a,loading:n,loadPage:s,setQuerySkip:o,severityCount:c,totalCount:u,type:d})=>{const p=Object(l.useDispatch)(),m=Object(i.useMemo)((()=>fg.e.userRiskScoreSelector()),[]),{activePage:g,limit:f,sort:b}=Object(v.a)((e=>m(e))),h=Object(i.useCallback)((e=>{p(fg.b.updateTableLimit({usersType:d,limit:e,tableType:ef}))}),[d,p]),y=Object(i.useCallback)((e=>{p(fg.b.updateTableActivePage({activePage:e,usersType:d,tableType:ef}))}),[d,p]),E=Object(i.useCallback)((e=>{if(null!=e.sort){const t=e.sort;t.direction===b.direction&&t.field===b.field||p(fg.b.updateTableSorting({sort:t,tableType:ef}))}}),[p,b]),T=Object(i.useCallback)((e=>{p(fg.b.updateUserRiskScoreSeverityFilter({severitySelection:[e]}))}),[p]),k=Object(i.useMemo)((()=>(({dispatchSeverityUpdate:e})=>[{field:"user.name",name:Hg,truncateText:!1,mobileOptions:{show:!0},sortable:!0,render:e=>{if(null!=e&&e.length>0){const t=Object(Fo.h)(`user-risk-score-table-userName-${e}`);return r.a.createElement(_o.b,{key:t,dataProvider:{and:[],enabled:!0,excluded:!1,id:t,name:e,kqlQuery:"",queryMatch:{field:"user.name",value:e,operator:Lo.c}},render:(t,a,n)=>n.isDragging?r.a.createElement(_o.a,null,r.a.createElement(No.a,{dataProvider:t})):r.a.createElement(ut.m,{userName:e,userTab:og.UsersTableType.risk}),isAggregatable:!0,fieldType:"keyword"})}return Object(vr.d)()}},{field:"risk_stats.risk_score",name:$g,truncateText:!0,mobileOptions:{show:!0},sortable:!0,render:e=>null!=e?r.a.createElement("span",{"data-test-subj":"risk-score-truncate",title:`${e}`},e.toFixed(2)):Object(vr.d)()},{field:"risk",name:r.a.createElement(N.EuiToolTip,{content:Vg},r.a.createElement(r.a.Fragment,null,Qg," ",r.a.createElement(N.EuiIcon,{color:"subdued",type:"iInCircle",className:"eui-alignTop"}))),truncateText:!1,mobileOptions:{show:!0},sortable:!0,render:t=>{return null!=t?r.a.createElement(rl.b,{toolTipContent:r.a.createElement(N.EuiLink,{onClick:()=>e(t)},r.a.createElement(N.EuiText,{size:"xs"},(a=t.toLowerCase(),F.i18n.translate("xpack.securitySolution.usersRiskTable.filteredUsersTitle",{values:{severity:a},defaultMessage:"View {severity} risk users"})))),severity:t}):Object(vr.d)();var a}}])({dispatchSeverityUpdate:T})),[T]),x=r.a.createElement(N.EuiFlexGroup,{direction:"column",gutterSize:"s"},r.a.createElement(N.EuiFlexItem,null,r.a.createElement(Yp,{severityCount:c})),r.a.createElement(N.EuiFlexItem,null,r.a.createElement(Zp,{severityCount:c}))),S=r.a.createElement(r.a.Fragment,null,Jg.f,r.a.createElement(Xg,null,r.a.createElement(N.EuiIconTip,{color:"subdued",content:Yg,position:"right",size:"l",type:"iInCircle"}))),O=Object(i.useMemo)((()=>fg.e.usersRiskScoreSeverityFilterSelector()),[]),w=Object(v.a)((e=>O(e))),j=Object(i.useCallback)((e=>{p(fg.b.updateUserRiskScoreSeverityFilter({severitySelection:e}))}),[p]);return r.a.createElement(Ls.a,{activePage:g,columns:k,dataTestSubj:`table-${ef}`,headerCount:u,headerFilters:r.a.createElement(em,{selectedSeverities:w,severityCount:c,title:Qg,onSelect:j}),headerSupplement:x,headerTitle:S,headerUnit:Wg(u),id:t,isInspect:a,itemsPerRow:Zg,limit:f,loading:n,loadPage:s,onChange:E,pageOfItems:e,setQuerySkip:o,showMorePagesIndicator:!1,sorting:b,split:!0,stackHeader:!0,totalCount:u,updateLimitPagination:h,updateActivePage:y})};tf.displayName="UserRiskScoreTableComponent";const af=r.a.memo(tf);af.displayName="UserRiskScoreTable";const nf=Object(sr.a)(af),rf=({filterQuery:e,skip:t,setQuery:a,type:n,deleteQuery:s})=>{const o=Object(i.useMemo)((()=>fg.e.userRiskScoreSelector()),[]),{activePage:l,limit:c,sort:u}=Object(v.a)((e=>o(e))),d=Object(i.useMemo)((()=>({cursorStart:l*c,querySize:c})),[l,c]),{toggleStatus:p}=Object(Ea.a)(ms.b.USERS_BY_RISK),[m,g]=Object(i.useState)(t||!p);Object(i.useEffect)((()=>{g(t||!p)}),[t,p]);const[f,{data:b,totalCount:h,inspect:y,isInspected:T,refetch:k}]=Object(ms.e)({filterQuery:e,skip:m,pagination:d,sort:u}),{severityCount:x,loading:S}=Object(ms.f)({filterQuery:e,skip:m});return r.a.createElement(nf,{deleteQuery:s,data:null!=b?b:[],id:ms.b.USERS_BY_RISK,inspect:y,isInspect:T,loading:f||S,loadPage:E.noop,refetch:k,setQuery:a,setQuerySkip:g,severityCount:x,totalCount:h,type:n})};rf.displayName="UserRiskScoreQueryTabBody";const sf=Object(i.memo)((({deleteQuery:e,filterQuery:t,pageFilters:a,from:n,indexNames:s,isInitializing:l,setQuery:c,to:u,type:d,setAbsoluteRangeDatePicker:p})=>{const m={deleteQuery:e,endDate:u,filterQuery:t,indexNames:s,skip:l||void 0===t,setQuery:c,startDate:n,type:d,narrowDateRange:Object(i.useCallback)(((e,t)=>{const a=Object(Ri.a)(e,t);p({id:"global",from:a.from,to:a.to})}),[p]),updateDateRange:Object(i.useCallback)((({x:e})=>{if(!e)return;const[t,a]=e;p({id:"global",from:new Date(t).toISOString(),to:new Date(a).toISOString()})}),[p])};return r.a.createElement(P.Switch,null,r.a.createElement(R.Route,{path:`${o.oc}/:tabName(${og.UsersTableType.allUsers})`},r.a.createElement(Dg,m)),r.a.createElement(R.Route,{path:`${o.oc}/:tabName(${og.UsersTableType.authentications})`},r.a.createElement(Fg,m)),r.a.createElement(R.Route,{path:`${o.oc}/:tabName(${og.UsersTableType.anomalies})`},r.a.createElement(vs.a,rr()({},m,{AnomaliesTableComponent:Ug}))),r.a.createElement(R.Route,{path:`${o.oc}/:tabName(${og.UsersTableType.risk})`},r.a.createElement(rf,m)),r.a.createElement(R.Route,{path:`${o.oc}/:tabName(${og.UsersTableType.events})`},r.a.createElement(Rs.a,rr()({},m,{timelineId:Sm.b.usersPageEvents,pageFilters:a}))),r.a.createElement(R.Route,{path:`${o.oc}/:tabName(${og.UsersTableType.alerts})`},r.a.createElement(tc,rr()({entityType:"events",timelineId:Sm.b.usersPageExternalAlerts,pageFilters:null!=a?a:[]},m))))}));sf.displayName="UsersTabs";const of=e=>`${o.oc}/${e}`,lf=F.i18n.translate("xpack.securitySolution.kpiUsers.totalUsers.title",{defaultMessage:"Users"}),cf=F.i18n.translate("xpack.securitySolution.kpiUsers.totalUsers.errorSearchDescription",{defaultMessage:"An error has occurred on total users kpi search"}),uf=[{key:"users",fields:[{key:"users",value:null,color:Object(N.euiPaletteColorBlind)()[1],icon:"storage",lensAttributes:{description:"",state:{datasourceStates:{indexpattern:{layers:{"416b6fad-1923-4f6a-a2df-b223bb287e30":{columnOrder:["3e51b035-872c-4b44-824b-fe069c222e91"],columns:{"3e51b035-872c-4b44-824b-fe069c222e91":{dataType:"number",isBucketed:!1,label:"Unique count of user.name",operationType:"unique_count",scale:"ratio",sourceField:"user.name"}},incompleteColumns:{}}}}},filters:[],query:{language:"kuery",query:""},visualization:{accessor:"3e51b035-872c-4b44-824b-fe069c222e91",layerId:"416b6fad-1923-4f6a-a2df-b223bb287e30",layerType:"data"}},title:"[User] Users - metric",visualizationType:"lnsMetric",references:[{id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-416b6fad-1923-4f6a-a2df-b223bb287e30",type:"index-pattern"}]}}],enableAreaChart:!0,description:lf,areaChartLensAttributes:{description:"",state:{datasourceStates:{indexpattern:{layers:{"416b6fad-1923-4f6a-a2df-b223bb287e30":{columnOrder:["5eea817b-67b7-4268-8ecb-7688d1094721","b00c65ea-32be-4163-bfc8-f795b1ef9d06"],columns:{"5eea817b-67b7-4268-8ecb-7688d1094721":{dataType:"date",isBucketed:!0,label:"@timestamp",operationType:"date_histogram",params:{interval:"auto"},scale:"interval",sourceField:"@timestamp"},"b00c65ea-32be-4163-bfc8-f795b1ef9d06":{customLabel:!0,dataType:"number",isBucketed:!1,label:" ",operationType:"unique_count",scale:"ratio",sourceField:"user.name"}},incompleteColumns:{}}}}},filters:[],query:{language:"kuery",query:""},visualization:{axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!1},fittingFunction:"None",gridlinesVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},labelsOrientation:{x:0,yLeft:0,yRight:0},layers:[{accessors:["b00c65ea-32be-4163-bfc8-f795b1ef9d06"],layerId:"416b6fad-1923-4f6a-a2df-b223bb287e30",layerType:"data",seriesType:"area",xAccessor:"5eea817b-67b7-4268-8ecb-7688d1094721"}],legend:{isVisible:!0,position:"right"},preferredSeriesType:"area",tickLabelsVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},valueLabels:"hide",yLeftExtent:{mode:"full"},yRightExtent:{mode:"full"}}},title:"[User] Users - area",visualizationType:"lnsXY",references:[{id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-416b6fad-1923-4f6a-a2df-b223bb287e30",type:"index-pattern"}]}}],df="TotalUsersKpiQuery",pf=({filterQuery:e,from:t,indexNames:a,to:n,narrowDateRange:s,setQuery:o,skip:l})=>{const{toggleStatus:c}=Object(Ea.a)(df),[u,d]=Object(i.useState)(l||!c);Object(i.useEffect)((()=>{d(l||!c)}),[l,c]);const{loading:p,result:m,search:g,refetch:f,inspect:b}=jg({factoryQueryType:Cg.b.kpiTotalUsers,initialResult:{users:0,usersHistogram:[]},errorMessage:cf,abort:u});return Object(i.useEffect)((()=>{u||g({filterQuery:e,defaultIndex:a,timerange:{interval:"12h",from:t,to:n}})}),[g,t,n,e,a,u]),r.a.createElement(qr,{data:m,id:df,inspect:b,loading:p,fieldsMapping:uf,from:t,to:n,narrowDateRange:s,refetch:f,setQuery:o,setQuerySkip:d})},mf=r.a.memo(pf),gf=F.i18n.translate("xpack.securitySolution.kpiUser.enableUserRiskText",{defaultMessage:"Enable user risk module to see more data"}),ff=F.i18n.translate("xpack.securitySolution.kpiUser.learnMore",{defaultMessage:"Learn more about"}),bf=F.i18n.translate("xpack.securitySolution.kpiUser.userRiskData",{defaultMessage:"user risk data"}),hf="https://www.github.com/elastic/detection-rules/blob/main/docs/experimental-machine-learning/user-risk-score.md",yf=r.a.memo((({filterQuery:e,from:t,indexNames:a,to:n,setQuery:i,skip:s,narrowDateRange:o})=>{const[l,{isModuleEnabled:c}]=Object(ms.e)({});return r.a.createElement(r.a.Fragment,null,!1===c&&r.a.createElement(r.a.Fragment,null,r.a.createElement(wt,{namespace:"users",condition:!0,message:{type:"primary",id:"userRiskModule",title:gf,description:r.a.createElement(r.a.Fragment,null,ff," ",r.a.createElement(N.EuiLink,{href:hf,target:"_blank"},bf),r.a.createElement(N.EuiSpacer,null))}}),r.a.createElement(N.EuiSpacer,{size:"l"})),r.a.createElement(N.EuiFlexGroup,{wrap:!0},r.a.createElement(N.EuiFlexItem,{grow:1},r.a.createElement(mf,{filterQuery:e,from:t,indexNames:a,to:n,narrowDateRange:o,setQuery:i,skip:s})),r.a.createElement(N.EuiFlexItem,{grow:2},r.a.createElement(Ur,{filterQuery:e,from:t,indexNames:a,to:n,narrowDateRange:o,setQuery:i,skip:s}))))}));yf.displayName="UsersKpiComponent";const Ef=[{query:{bool:{filter:[{bool:{should:[{exists:{field:"user.name"}}],minimum_should_match:1}}]}},meta:{alias:"",disabled:!1,key:"bool",negate:!1,type:"custom",value:'{"query": {"bool": {"filter": [{"bool": {"should": [{"exists": {"field": "user.name"}}],"minimum_should_match": 1}}]}}}'}}],vf=z.a.div.withConfig({displayName:"StyledFullHeightContainer",componentId:"sc-1ndcmza-0"})(["display:flex;flex-direction:column;flex:1 1 auto;"]),Tf=()=>{const e=Object(l.useDispatch)(),t=Object(i.useRef)(null),a=Object(i.useMemo)((()=>ae.e.globalFiltersQuerySelector()),[]),n=Object(i.useMemo)((()=>ae.e.globalQuerySelector()),[]),s=Object(v.a)(n),o=Object(v.a)(a),c=Object(i.useMemo)((()=>fg.e.usersRiskScoreSeverityFilterSelector()),[]),u=Object(v.a)((e=>c(e))),{to:p,from:g,deleteQuery:f,setQuery:h,isInitializing:k}=Object(H.a)(),{globalFullScreen:x}=Object(dt.a)(),{uiSettings:S}=Object(d.j)().services,{tabName:O}=Object(P.useParams)(),w=r.a.useMemo((()=>O===og.UsersTableType.alerts||O===og.UsersTableType.events?o.length>0?[...o,...Ef]:Ef:O===og.UsersTableType.risk?[...Object(Zm.a)(u),...o]:o),[u,O,o]),{docValueFields:j,indicesExist:C,indexPattern:I,selectedPatterns:M}=Object(m.d)(),[A,D]=Object(i.useMemo)((()=>Object(hs.b)({config:Object(K.getEsQueryConfig)(S),indexPattern:I,queries:[s],filters:o})),[o,I,S,s]),[q]=Object(i.useMemo)((()=>Object(hs.b)({config:Object(K.getEsQueryConfig)(S),indexPattern:I,queries:[s],filters:w})),[I,s,w,S]);Object(ee.a)({id:"UsersQueryId",filterQuery:A,kqlError:D,query:s,startDate:g,endDate:p});const R=Object(i.useCallback)((()=>{var e,a;null===(e=t.current)||void 0===e||null===(a=e.querySelector(".inspectButtonComponent:last-of-type"))||void 0===a||a.focus()}),[t]),_=Object(i.useCallback)((()=>{Object(oe.m)()}),[]),F=Object(i.useCallback)((e=>{Object(U.isTab)(e)&&Object(oe.l)({containerElement:t.current,keyboardEvent:e,onSkipFocusBeforeEventsTable:R,onSkipFocusAfterEventsTable:_})}),[t,R,_]),L=Object(i.useCallback)((({x:t})=>{if(!t)return;const[a,n]=t;e(Object(G.setAbsoluteRangeDatePicker)({id:"global",from:new Date(a).toISOString(),to:new Date(n).toISOString()}))}),[e]),B=Object(Pi.a)(),z=Object(Z.a)("riskyUsersEnabled"),V=Object(i.useMemo)((()=>((e,t)=>{const a=[],n={[og.UsersTableType.allUsers]:{id:og.UsersTableType.allUsers,name:Jg.b,href:of(og.UsersTableType.allUsers),disabled:!1},[og.UsersTableType.authentications]:{id:og.UsersTableType.authentications,name:Jg.d,href:of(og.UsersTableType.authentications),disabled:!1},[og.UsersTableType.anomalies]:{id:og.UsersTableType.anomalies,name:Jg.c,href:of(og.UsersTableType.anomalies),disabled:!1},[og.UsersTableType.events]:{id:og.UsersTableType.events,name:Jg.e,href:of(og.UsersTableType.events),disabled:!1},[og.UsersTableType.alerts]:{id:og.UsersTableType.alerts,name:Jg.a,href:of(og.UsersTableType.alerts),disabled:!1},[og.UsersTableType.risk]:{id:og.UsersTableType.risk,name:Jg.f,href:of(og.UsersTableType.risk),disabled:!1}};return e||a.push(og.UsersTableType.anomalies),t||a.push(og.UsersTableType.risk),Object(E.omit)(a,n)})(Object(qi.a)(B),z)),[B,z]);return r.a.createElement(r.a.Fragment,null,C?r.a.createElement(vf,{onKeyDown:F,ref:t},r.a.createElement(N.EuiWindowEvent,{event:"resize",handler:E.noop}),r.a.createElement($.a,null,r.a.createElement(Q.a,{indexPattern:I,id:"global"})),r.a.createElement(b.a,{noPadding:x},r.a.createElement(Ta.a,{subtitle:r.a.createElement(Mi.a,{docValueFields:j,indexKey:Ii.i.users,indexNames:M}),border:!0,title:Jg.g}),r.a.createElement(yf,{filterQuery:A,indexNames:M,from:g,setQuery:h,to:p,skip:k||!A,narrowDateRange:L}),r.a.createElement(N.EuiSpacer,null),r.a.createElement(Ki,{navTabs:V}),r.a.createElement(N.EuiSpacer,null),r.a.createElement(sf,{deleteQuery:f,docValueFields:j,filterQuery:q||"",from:g,indexNames:M,isInitializing:k,setAbsoluteRangeDatePicker:G.setAbsoluteRangeDatePicker,setQuery:h,to:p,type:fg.c.UsersType.page,pageFilters:w}))):r.a.createElement(ka.a,null),r.a.createElement(y.a,{pageName:T.a.users}))};Tf.displayName="UsersComponent";const kf=r.a.memo(Tf);var xf=a(471);const Sf=`${o.oc}/:detailName`,Of=`${o.oc}/:tabName(${og.UsersTableType.allUsers}|${og.UsersTableType.authentications}|${og.UsersTableType.anomalies}|${og.UsersTableType.risk}|${og.UsersTableType.events}|${og.UsersTableType.alerts})`,wf=`${Sf}/:tabName(${og.UsersTableType.authentications}|${og.UsersTableType.anomalies}|${og.UsersTableType.events}|${og.UsersTableType.alerts}|${og.UsersTableType.risk})`,jf=(F.i18n.translate("xpack.securitySolution.users.userRiskInformation.informationAriaLabel",{defaultMessage:"Information"}),F.i18n.translate("xpack.securitySolution.users.userRiskInformation.classificationHeader",{defaultMessage:"Classification"})),Cf=F.i18n.translate("xpack.securitySolution.users.userRiskInformation.riskHeader",{defaultMessage:"User risk score range"}),If=F.i18n.translate("xpack.securitySolution.users.userRiskInformation.unknownRiskDescription",{defaultMessage:"Less than 20"}),Mf=F.i18n.translate("xpack.securitySolution.users.userRiskInformation.criticalRiskDescription",{defaultMessage:"90 and above"}),Af=F.i18n.translate("xpack.securitySolution.users.userRiskInformation.title",{defaultMessage:"How is user risk calculated?"}),Df=F.i18n.translate("xpack.securitySolution.users.userRiskInformation.introduction",{defaultMessage:"The User Risk Score capability surfaces risky users from within your environment."}),qf=F.i18n.translate("xpack.securitySolution.users.userRiskInformation.explanation",{defaultMessage:'This feature utilizes a transform, with a scripted metric aggregation to calculate user risk scores based on detection rule alerts with an "open" status, within a 5 day time window. The transform runs hourly to keep the score updated as new detection rule alerts stream in.'}),Pf=F.i18n.translate("xpack.securitySolution.users.userRiskInformation.closeBtn",{defaultMessage:"Close"}),Rf=F.i18n.translate("xpack.securitySolution.users.userRiskInformation.buttonLabel",{defaultMessage:"How is risk score calculated?"}),_f=[{field:"classification",name:jf,render:e=>{if(null!=e)return r.a.createElement(rl.b,{severity:e,hideBackgroundColor:!0})}},{field:"range",name:Cf}],Ff=[{classification:Ii.u.critical,range:Mf},{classification:Ii.u.high,range:"70 - 90 "},{classification:Ii.u.moderate,range:"40 - 70"},{classification:Ii.u.low,range:"20 - 40"},{classification:Ii.u.unknown,range:If}],Lf=()=>{const[e,t,a]=gc();return r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiButtonEmpty,{onClick:t,"data-test-subj":"open-risk-information-flyout-trigger"},Rf),e&&r.a.createElement(Nf,{handleOnClose:a}))},Nf=({handleOnClose:e})=>{const t=Object(N.useGeneratedHtmlId)({prefix:"UserRiskInformation"});return r.a.createElement(N.EuiFlyout,{ownFocus:!0,onClose:e,"aria-labelledby":t,size:450,"data-test-subj":"open-risk-information-flyout"},r.a.createElement(N.EuiFlyoutHeader,{hasBorder:!0},r.a.createElement(N.EuiTitle,{size:"m"},r.a.createElement("h2",{id:t},Af))),r.a.createElement(N.EuiFlyoutBody,null,r.a.createElement(N.EuiText,{size:"s"},r.a.createElement("p",null,Df),r.a.createElement("p",null,qf)),r.a.createElement(N.EuiSpacer,null),r.a.createElement(N.EuiBasicTable,{columns:_f,items:Ff,"data-test-subj":"risk-information-table"}),r.a.createElement(N.EuiSpacer,{size:"l"}),r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.users.userRiskInformation.learnMore",defaultMessage:"You can learn more about user risk {usersRiskScoreDocumentationLink}",values:{usersRiskScoreDocumentationLink:r.a.createElement(N.EuiLink,{href:hf,target:"_blank"},r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.users.userRiskInformation.link",defaultMessage:"here"}))}})),r.a.createElement(N.EuiFlyoutFooter,null,r.a.createElement(N.EuiFlexGroup,{justifyContent:"flexEnd"},r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiButton,{onClick:e},Pf)))))},Bf=ms.b.USER_DETAILS_RISK_SCORE,zf=z()(N.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-npiiwf-0"})(["margin-top:",";"],(({theme:e})=>e.eui.paddingSizes.l)),Uf=({userName:e,startDate:t,endDate:a,setQuery:n,deleteQuery:s})=>{const{buttonHref:o}=Object($p.a)({to:a,from:t,title:"Current Risk Score For Users"}),l=Object(i.useMemo)((()=>({from:t,to:a})),[t,a]),{toggleStatus:c,setToggleStatus:u}=Object(Ea.a)(`${Bf} overTime`),{toggleStatus:d,setToggleStatus:p}=Object(Ea.a)(`${Bf} contributors`),[m,{data:g,refetch:f,inspect:b}]=Object(ms.e)({filterQuery:e?Object(Ii.x)([e]):void 0,onlyLatest:!1,skip:!c&&!d,timerange:l});Object(sr.b)({queryId:Bf,loading:m,refetch:f,setQuery:n,deleteQuery:s,inspect:b});const h=Object(i.useCallback)((e=>{p(e)}),[p]),y=Object(i.useCallback)((e=>{u(e)}),[u]),E=g&&g.length>0?g[g.length-1].risk_stats.rule_risks:[];return r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiFlexGroup,{direction:"row"},r.a.createElement(N.EuiFlexItem,{grow:2},r.a.createElement(wc,{from:t,to:a,loading:m,riskScore:g,queryId:Bf,title:Jg.h,toggleStatus:c,toggleQuery:y})),r.a.createElement(N.EuiFlexItem,{grow:1},r.a.createElement(Hp,{loading:m,queryId:Bf,toggleStatus:d,toggleQuery:h,rules:E}))),r.a.createElement(zf,{gutterSize:"s"},r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiButton,{href:o,isDisabled:!o,"data-test-subj":"risky-users-view-dashboard-button",target:"_blank"},Jg.i)),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(Lf,null))))};Uf.displayName="UserRiskTabBodyComponent";const Hf=r.a.memo(Uf);Hf.displayName="UserRiskTabBody";const $f=r.a.memo((({deleteQuery:e,filterQuery:t,from:a,indexNames:n,isInitializing:s,setQuery:o,to:l,type:c,setAbsoluteRangeDatePicker:u,detailName:d,pageFilters:p})=>{const m=Object(i.useCallback)(((e,t)=>{const a=Object(Ri.a)(e,t);u({id:"global",from:a.from,to:a.to})}),[u]),g=Object(i.useCallback)((({x:e})=>{if(!e)return;const[t,a]=e;u({id:"global",from:new Date(t).toISOString(),to:new Date(a).toISOString()})}),[u]),f=Object(i.useMemo)((()=>null!=p?[...Ef,...p]:Ef),[p]),b={deleteQuery:e,endDate:l,filterQuery:t,indexNames:n,skip:s||void 0===t,setQuery:o,startDate:a,type:c,narrowDateRange:m,updateDateRange:g,userName:d};return r.a.createElement(P.Switch,null,r.a.createElement(R.Route,{path:`${Sf}/:tabName(${og.UsersTableType.authentications})`},r.a.createElement(Fg,b)),r.a.createElement(R.Route,{path:`${Sf}/:tabName(${og.UsersTableType.anomalies})`},r.a.createElement(vs.a,rr()({},b,{AnomaliesTableComponent:Ug}))),r.a.createElement(R.Route,{path:`${Sf}/:tabName(${og.UsersTableType.events})`},r.a.createElement(Rs.a,rr()({},b,{pageFilters:p,timelineId:Sm.b.usersPageEvents}))),r.a.createElement(R.Route,{path:`${Sf}/:tabName(${og.UsersTableType.alerts})`},r.a.createElement(tc,rr()({entityType:"events",timelineId:Sm.b.usersPageExternalAlerts,pageFilters:f},b))),r.a.createElement(R.Route,{path:`${Sf}/:tabName(${og.UsersTableType.risk})`},r.a.createElement(Hf,b)))}));$f.displayName="UsersDetailsTabs";const Vf=(e,t)=>`${o.oc}/${e}/${t}`,Qf=(e,t,a)=>{const n=[],i={[og.UsersTableType.authentications]:{id:og.UsersTableType.authentications,name:Jg.d,href:Vf(e,og.UsersTableType.authentications),disabled:!1},[og.UsersTableType.anomalies]:{id:og.UsersTableType.anomalies,name:Jg.c,href:Vf(e,og.UsersTableType.anomalies),disabled:!1},[og.UsersTableType.events]:{id:og.UsersTableType.events,name:Jg.e,href:Vf(e,og.UsersTableType.events),disabled:!1},[og.UsersTableType.alerts]:{id:og.UsersTableType.alerts,name:Jg.a,href:Vf(e,og.UsersTableType.alerts),disabled:!1},[og.UsersTableType.risk]:{id:og.UsersTableType.risk,name:Jg.f,href:Vf(e,og.UsersTableType.risk),disabled:!1}};return t||n.push(og.UsersTableType.anomalies),a||n.push(og.UsersTableType.risk),Object(E.omit)(n,i)};var Wf=a(769),Gf=a(843),Kf=a(844);const Yf="UsersDetailsQueryId",Jf=({detailName:e,usersDetailsPagePath:t})=>{const a=Object(l.useDispatch)(),n=Object(Z.a)("riskyUsersEnabled"),s=Object(i.useMemo)((()=>p.b.getTimelineByIdSelector()),[]),o=Object(v.b)((e=>{var t;return(null!==(t=s(e,c.i.hostsPageEvents))&&void 0!==t?t:le.a).graphEventId})),u=Object(i.useMemo)((()=>ae.e.globalFiltersQuerySelector()),[]),g=Object(i.useMemo)((()=>ae.e.globalQuerySelector()),[]),f=Object(v.a)(g),h=Object(v.a)(u),{to:k,from:x,deleteQuery:S,setQuery:O,isInitializing:w}=Object(H.a)(),{globalFullScreen:j}=Object(dt.a)(),C=Object(d.j)(),I=Object(i.useMemo)((()=>{return[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:"user.name",value:t=e,params:{query:t}},query:{match:{"user.name":{query:t,type:"phrase"}}}}];var t}),[e]),{docValueFields:M,indicesExist:A,indexPattern:D,selectedPatterns:q}=Object(m.d)(),[P,R]=Object(hs.b)({config:Object(K.getEsQueryConfig)(C.services.uiSettings),indexPattern:D,queries:[f],filters:[...I,...h]});Object(ee.a)({id:Yf,filterQuery:P,kqlError:R,query:f,startDate:x,endDate:k}),Object(i.useEffect)((()=>{a(Object(xf.setUsersDetailsTablesActivePageToZero)())}),[a,e]);const[_,{inspect:F,userDetails:L,refetch:B}]=Object(Kf.a)({id:Yf,endDate:k,startDate:x,userName:e,indexNames:q,skip:0===q.length}),z=Object(Pi.a)();return Object(sr.b)({setQuery:O,deleteQuery:S,refetch:B,inspect:F,loading:_,queryId:Yf}),r.a.createElement(r.a.Fragment,null,A?r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiWindowEvent,{event:"resize",handler:E.noop}),r.a.createElement($.a,{show:Object(oe.n)({globalFullScreen:j,graphEventId:o})},r.a.createElement(Q.a,{indexPattern:D,id:"global"})),r.a.createElement(b.a,{noPadding:j},r.a.createElement(Ta.a,{border:!0,subtitle:r.a.createElement(Mi.a,{docValueFields:M,indexKey:Ii.i.userDetails,indexNames:q,userName:e}),title:e}),r.a.createElement(Ai.a,{criteriaFields:Object(Lg.a)(og.UsersType.details,e),startDate:x,endDate:k,skip:w},(({isLoadingAnomaliesData:t,anomaliesData:a})=>r.a.createElement(Gf.a,{userName:e,id:Yf,isInDetailsSidePanel:!1,data:L,anomaliesData:a,isLoadingAnomaliesData:t,loading:_,startDate:x,endDate:k,narrowDateRange:(e,t)=>{const a=Object(Ri.a)(e,t);Object(G.setAbsoluteRangeDatePicker)({id:"global",from:a.from,to:a.to})}}))),r.a.createElement(N.EuiSpacer,null),r.a.createElement(Ki,{navTabs:Qf(e,Object(qi.a)(z),n)}),r.a.createElement(N.EuiSpacer,null),r.a.createElement($f,{deleteQuery:S,detailName:e,docValueFields:M,filterQuery:P,from:x,indexNames:q,indexPattern:D,isInitializing:w,pageFilters:I,setAbsoluteRangeDatePicker:G.setAbsoluteRangeDatePicker,setQuery:O,to:k,type:Wf.b,usersDetailsPagePath:t}))):r.a.createElement(ka.a,null),r.a.createElement(y.a,{pageName:T.a.users}))};Jf.displayName="UsersDetailsComponent";const Xf=r.a.memo(Jf),Zf=r.a.memo((()=>r.a.createElement(P.Switch,null,r.a.createElement(R.Route,{path:Of},r.a.createElement(kf,null)),r.a.createElement(R.Route,{path:wf,render:({match:{params:{detailName:e}}})=>r.a.createElement(Xf,{usersDetailsPagePath:Sf,detailName:decodeURIComponent(e)})}),r.a.createElement(R.Route,{path:Sf,render:({match:{params:{detailName:e}},location:{search:t=""}})=>r.a.createElement(P.Redirect,{to:{pathname:`${o.oc}/${e}/${og.UsersTableType.authentications}`,search:t}})}),r.a.createElement(R.Route,{path:o.oc,render:({location:{search:e=""}})=>r.a.createElement(P.Redirect,{to:{pathname:`${o.oc}/${og.UsersTableType.allUsers}`,search:e}})}))));Zf.displayName="UsersContainer";const eb=[{path:o.oc,render:()=>r.a.createElement(s.TrackApplicationView,{viewId:T.a.users},r.a.createElement(Zf,null))}];var tb=a(800),ab=a(296),nb=a(185);const ib=z()(N.EuiPanel).withConfig({displayName:"Panel",componentId:"sc-4inzan-0"})(["overflow:hidden;"]);ib.displayName="Panel";const rb=r.a.memo((({children:e})=>r.a.createElement("section",{className:"siemEmbeddable","data-test-subj":"siemEmbeddable"},r.a.createElement(ib,{paddingSize:"none",hasBorder:!0},e))));rb.displayName="Embeddable",a(1056);var sb=a(189),ob=a(190);const lb=F.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.embeddableHeaderTitle",{defaultMessage:"Network map"}),cb=F.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.embeddableHeaderHelp",{defaultMessage:"Map configuration help"}),ub=F.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.embeddablePanelTitle",{defaultMessage:"Source -> Destination Point-to-Point Map"}),db=F.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.sourceLayerLabel",{defaultMessage:"Source Point"}),pb=F.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.destinationLayerLabel",{defaultMessage:"Destination Point"}),mb=F.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.clientLayerLabel",{defaultMessage:"Client Point"}),gb=F.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.serverLayerLabel",{defaultMessage:"Server Point"}),fb=F.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.lineLayerLabel",{defaultMessage:"Line"}),bb=(F.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.errorConfiguringEmbeddableApiTitle",{defaultMessage:"Error configuring Embeddables API"}),F.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.errorCreatingMapEmbeddableTitle",{defaultMessage:"Error creating Map Embeddable"})),hb=F.i18n.translate("xpack.securitySolution.components.embeddables.indexPatternsMissingPrompt.errorTitle",{defaultMessage:"Required index patterns not configured"}),yb=F.i18n.translate("xpack.securitySolution.components.embeddables.indexPatternsMissingPrompt.errorButtonLabel",{defaultMessage:"Configure index patterns"}),Eb=(F.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.filterForValueHoverAction",{defaultMessage:"Filter for value"}),F.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.errorTitle",{defaultMessage:"Error loading map features"})),vb=F.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.hostTitle",{defaultMessage:"Host"}),Tb=F.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.sourceIPTitle",{defaultMessage:"Source IP"}),kb=F.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.destinationIPTitle",{defaultMessage:"Destination IP"}),xb=F.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.clientIPTitle",{defaultMessage:"Client IP"}),Sb=F.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.serverIPTitle",{defaultMessage:"Server IP"}),Ob=F.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.sourceDomainTitle",{defaultMessage:"Source domain"}),wb=F.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.destinationDomainTitle",{defaultMessage:"Destination domain"}),jb=F.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.clientDomainTitle",{defaultMessage:"Client domain"}),Cb=F.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.serverDomainTitle",{defaultMessage:"Server domain"}),Ib=F.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.locationTitle",{defaultMessage:"Location"}),Mb=F.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.asnTitle",{defaultMessage:"ASN"}),Ab=F.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.lineContent.sourceLabel",{defaultMessage:"Source"}),Db=F.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.lineContent.destinationLabel",{defaultMessage:"Destination"}),qb=F.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.lineContent.clientLabel",{defaultMessage:"Client"}),Pb=F.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.lineContent.serverLabel",{defaultMessage:"Server"}),Rb=Object(N.euiPaletteColorBlind)(),_b={"host.name":vb,"source.ip":Tb,"source.domain":Ob,"source.geo.country_iso_code":Ib,"source.as.organization.name":Mb},Fb={"host.name":vb,"destination.ip":kb,"destination.domain":wb,"destination.geo.country_iso_code":Ib,"destination.as.organization.name":Mb},Lb={"host.name":vb,"client.ip":xb,"client.domain":jb,"client.geo.country_iso_code":Ib,"client.as.organization.name":Mb},Nb={"host.name":vb,"server.ip":Sb,"server.domain":Cb,"server.geo.country_iso_code":Ib,"server.as.organization.name":Mb},Bb={..._b,...Fb,...Lb,...Nb},zb="sum_of_source.bytes",Ub={source:{metricField:"client.bytes",geoField:"client.geo.location",tooltipProperties:Object.keys(Lb),label:mb},destination:{metricField:"server.bytes",geoField:"server.geo.location",tooltipProperties:Object.keys(Nb),label:gb}},Hb={default:{source:{metricField:"source.bytes",geoField:"source.geo.location",tooltipProperties:Object.keys(_b),label:db},destination:{metricField:"destination.bytes",geoField:"destination.geo.location",tooltipProperties:Object.keys(Fb),label:pb}},"apm-*":Ub,"traces-apm*,logs-apm*,metrics-apm*,apm-*":Ub},$b=e=>[{sourceDescriptor:{type:ob.SOURCE_TYPES.EMS_TMS,isAutoSelect:!0},id:sa.a.v4(),label:null,minZoom:0,maxZoom:24,alpha:1,visible:!0,style:null,type:ob.LAYER_TYPE.EMS_VECTOR_TILE},...e.reduce(((e,{title:t,id:a})=>{var n,i,r,s,o;return[...e,Wb(t,a,null!==(n=Hb[t])&&void 0!==n?n:Hb.default),Qb(t,a,null!==(i=null===(r=Hb[t])||void 0===r?void 0:r.destination)&&void 0!==i?i:Hb.default.destination),Vb(t,a,null!==(s=null===(o=Hb[t])||void 0===o?void 0:o.source)&&void 0!==s?s:Hb.default.source)]}),[])],Vb=(e,t,a)=>({sourceDescriptor:{id:sa.a.v4(),type:"ES_SEARCH",applyGlobalQuery:!0,geoField:a.geoField,filterByMapBounds:!1,tooltipProperties:a.tooltipProperties,useTopHits:!1,topHitsTimeField:"@timestamp",topHitsSize:1,indexPatternId:t},style:{type:"VECTOR",properties:{fillColor:{type:"STATIC",options:{color:Rb[1]}},lineColor:{type:"STATIC",options:{color:"#FFFFFF"}},lineWidth:{type:"STATIC",options:{size:2}},iconSize:{type:"STATIC",options:{size:8}},iconOrientation:{type:"STATIC",options:{orientation:0}},symbolizeAs:{options:{value:"icon"}},icon:{type:"STATIC",options:{value:"home"}}}},id:sa.a.v4(),label:`${e} | ${a.label}`,minZoom:0,maxZoom:24,alpha:1,visible:!0,type:ob.LAYER_TYPE.GEOJSON_VECTOR,query:{query:"",language:"kuery"},joins:[]}),Qb=(e,t,a)=>({sourceDescriptor:{id:sa.a.v4(),type:"ES_SEARCH",scalingType:ob.SCALING_TYPES.LIMIT,applyGlobalQuery:!0,geoField:a.geoField,filterByMapBounds:!0,tooltipProperties:a.tooltipProperties,useTopHits:!1,topHitsTimeField:"@timestamp",topHitsSize:1,indexPatternId:t},style:{type:"VECTOR",properties:{fillColor:{type:"STATIC",options:{color:Rb[2]}},lineColor:{type:"STATIC",options:{color:"#FFFFFF"}},lineWidth:{type:"STATIC",options:{size:2}},iconSize:{type:"STATIC",options:{size:8}},iconOrientation:{type:"STATIC",options:{orientation:0}},symbolizeAs:{options:{value:"icon"}},icon:{type:"STATIC",options:{value:"marker"}}}},id:sa.a.v4(),label:`${e} | ${a.label}`,minZoom:0,maxZoom:24,alpha:1,visible:!0,type:ob.LAYER_TYPE.GEOJSON_VECTOR,query:{query:"",language:"kuery"}}),Wb=(e,t,a)=>({sourceDescriptor:{type:ob.SOURCE_TYPES.ES_PEW_PEW,applyGlobalQuery:!0,id:sa.a.v4(),indexPatternId:t,sourceGeoField:a.source.geoField,destGeoField:a.destination.geoField,metrics:[{type:"sum",field:a.source.metricField,label:a.source.metricField},{type:"sum",field:a.destination.metricField,label:a.destination.metricField}]},style:{type:"VECTOR",properties:{fillColor:{type:"STATIC",options:{color:"#1EA593"}},lineColor:{type:"STATIC",options:{color:Rb[1]}},lineWidth:{type:"DYNAMIC",options:{field:{label:"count",name:"doc_count",origin:"source"},minSize:1,maxSize:8,fieldMetaOptions:{isEnabled:!0,sigma:3}}},iconSize:{type:"STATIC",options:{size:10}},iconOrientation:{type:"STATIC",options:{orientation:0}},symbolizeAs:{options:{value:"icon"}},icon:{type:"STATIC",options:{value:"airfield"}}}},id:sa.a.v4(),label:`${e} | ${fb}`,minZoom:0,maxZoom:24,alpha:.5,visible:!0,type:ob.LAYER_TYPE.GEOJSON_VECTOR,query:{query:"",language:"kuery"}}),Gb=()=>{const{docLinks:e}=Object(d.j)().services,t=`${Object(d.e)()}/app`;return r.a.createElement(N.EuiEmptyPrompt,{iconType:"gisApp",title:r.a.createElement("h2",null,hb),titleSize:"xs",body:r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,r.a.createElement(It.FormattedMessage,{defaultMessage:"To display map data, you must define SIEM indices ({defaultIndex}) and Kibana index patterns with matching glob patterns. When using {beats}, you can run the {setup} command on your hosts to automatically create the index patterns. For example: {example}.",id:"xpack.securitySolution.components.embeddables.indexPatternsMissingPrompt.errorDescription1",values:{defaultIndex:r.a.createElement("a",{href:`${t}/management/kibana/settings`,rel:"noopener noreferrer",target:"_blank"},"securitySolution:defaultIndex"),beats:r.a.createElement("a",{href:`${e.links.libbeat.getStarted}`,rel:"noopener noreferrer",target:"_blank"},"beats"),setup:r.a.createElement(N.EuiCode,null,"setup"),example:r.a.createElement(N.EuiCode,null,"./packetbeat setup")}})),r.a.createElement("p",null,r.a.createElement(It.FormattedMessage,{defaultMessage:"You can also configure index patterns manually in Kibana.",id:"xpack.securitySolution.components.embeddables.indexPatternsMissingPrompt.errorDescription2"}))),actions:r.a.createElement(N.EuiButton,{href:`${t}/management/kibana/dataViews`,color:"primary",target:"_blank",fill:!0},yb)})};Gb.displayName="IndexPatternsMissingPromptComponent";const Kb=r.a.memo(Gb);Kb.displayName="IndexPatternsMissingPrompt",z()(N.EuiIcon).withConfig({displayName:"Icon",componentId:"sc-s0r863-0"})(["margin-right:",";"],$n.euiLightVars.euiSizeS).displayName="Icon";const Yb=({featureIndex:e,totalFeatures:t,previousFeature:a,nextFeature:n})=>r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiHorizontalRule,{margin:"s"}),r.a.createElement(N.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center",gutterSize:"xs"},r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiText,{size:"xs"},((e,t)=>F.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.footerLabel",{values:{currentFeature:e,totalFeatures:t},defaultMessage:"{currentFeature} of {totalFeatures} {totalFeatures, plural, =1 {feature} other {features}}"}))(e+1,t))),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement("span",null,r.a.createElement(N.EuiButtonIcon,{"data-test-subj":"previous-feature-button",color:"text",onClick:a,iconType:"arrowLeft","aria-label":"Next",isDisabled:e<=0}),r.a.createElement(N.EuiButtonIcon,{"data-test-subj":"next-feature-button",color:"text",onClick:n,iconType:"arrowRight","aria-label":"Next",isDisabled:e>=t-1})))));Yb.displayName="ToolTipFooterComponent";const Jb=r.a.memo(Yb);Jb.displayName="ToolTipFooter";var Xb=a(492);const Zb=z()(N.EuiBadge).withConfig({displayName:"FlowBadge",componentId:"sc-120vo88-0"})(["height:45px;min-width:85px;"]),eh=z()(N.EuiFlexGroup).withConfig({displayName:"EuiFlexGroupStyled",componentId:"sc-120vo88-1"})(["margin:0 auto;"]),th=({contextId:e,featureProps:t})=>{const a=t.reduce(((e,t)=>{var a;const n=null!==(a=t.getRawValue())&&void 0!==a?a:[];return{...e,[t.getPropertyKey()]:Array.isArray(n)?n:[n]}}),{}),n=Object.keys(a).includes(zb);return r.a.createElement(N.EuiFlexGroup,{justifyContent:"center",gutterSize:"none"},r.a.createElement(N.EuiFlexItem,null,r.a.createElement(Zb,{color:"hollow"},r.a.createElement(eh,{direction:"column"},r.a.createElement(N.EuiFlexItem,{grow:!1},n?Ab:qb)))),r.a.createElement(Xb.e,{contextId:e,destinationBytes:n?a["sum_of_destination.bytes"]:a["sum_of_server.bytes"],eventId:`map-line-tooltip-${e}`,sourceBytes:n?a[zb]:a["sum_of_client.bytes"]}),r.a.createElement(N.EuiFlexItem,null,r.a.createElement(Zb,{color:"hollow"},r.a.createElement(eh,null,r.a.createElement(N.EuiFlexItem,{grow:!1},n?Db:Pb)))))};th.displayName="LineToolTipContentComponent";const ah=r.a.memo(th);ah.displayName="LineToolTipContent";var nh=a(93),ih=a(346);const rh=({contextId:e,featureProps:t})=>{const a=Object(i.useMemo)((()=>t.map((t=>{var a;const n=t.getPropertyKey(),i=null!==(a=t.getRawValue())&&void 0!==a?a:[];return{title:Bb[n],description:r.a.createElement(r.a.Fragment,null,null!=i?r.a.createElement(ih.a,{rowItems:Array.isArray(i)?i:[i],attrName:n,idPrefix:`map-point-tooltip-${e}-${n}-${i}`,render:e=>oh(n,e)}):Object(vr.d)())}}))),[e,t]);return r.a.createElement(nh.d,{listItems:a})};rh.displayName="PointToolTipContentComponent";const sh=r.a.memo(rh);sh.displayName="PointToolTipContent";const oh=(e,t)=>{if(""===t)return Object(vr.f)(t);if(["host.name"].includes(e))return r.a.createElement(ut.d,{hostName:t});if(["source.ip","destination.ip"].includes(e)){const a=e.split(".")[0];return r.a.createElement(ut.h,{ip:t,flowTarget:a})}return r.a.createElement(r.a.Fragment,null,t)},lh=({closeTooltip:e,features:t=[],getLayerName:a,loadFeatureProperties:n,loadFeatureGeometry:s})=>{const[o,l]=Object(i.useState)(!0),[c,u]=Object(i.useState)(!1),[d,p]=Object(i.useState)(!1),[m,g]=Object(i.useState)(0),[f,b]=Object(i.useState)([]),[h,y]=Object(i.useState)(null),[,E]=Object(i.useState)(""),v=Object(i.useCallback)((()=>{null!=e&&(e(),g(0))}),[e]),T=Object(i.useCallback)((()=>{g((e=>e-1)),u(!0)}),[]),k=Object(i.useCallback)((()=>{g((e=>e+1)),u(!0)}),[]),x=Object(i.useMemo)((()=>d?r.a.createElement(N.EuiFlexGroup,{justifyContent:"spaceAround"},r.a.createElement(N.EuiFlexItem,{grow:!1},Eb)):o&&!c?r.a.createElement(N.EuiFlexGroup,{justifyContent:"spaceAround"},r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiLoadingSpinner,{size:"m"}))):r.a.createElement("div",null,null!=h&&"LineString"===h.type?r.a.createElement(ah,{contextId:`${t[m].layerId}-${t[m].id}-${m}`,featureProps:f}):r.a.createElement(sh,{contextId:`${t[m].layerId}-${t[m].id}-${m}`,featureProps:f}),t.length>1&&r.a.createElement(Jb,{featureIndex:m,totalFeatures:t.length,previousFeature:T,nextFeature:k}),c&&r.a.createElement(Fa.a,{"data-test-subj":"loading-panel",overlay:!0,size:"m"}))),[h,m,f,t,k,T,d,o,c]);return Object(i.useEffect)((()=>{0!==t.length&&null!=a&&null!=n&&null!=s&&(c||l(!0),p(!1),(async()=>{if(null!=t[m]){const e=t[m].layerId,i=t[m].id;try{const r=s({layerId:e,featureId:i}),[o,c]=await Promise.all([n({layerId:e,properties:t[m].mbProperties}),a(e)]);b(o),y(r),c&&E(c)}catch(e){p(!0)}finally{l(!1),u(!1)}}})())}),[m,t,a,c,s,n]),r.a.createElement(N.EuiOutsideClickDetector,{onOutsideClick:v},x)};lh.displayName="MapToolTipComponent";const ch=r.a.memo(lh);ch.displayName="MapToolTip";var uh=a(29);const dh="network_map_visbile",ph=z.a.div.attrs((()=>({className:"siemEmbeddable__map"}))).withConfig({displayName:"EmbeddableMap",componentId:"sc-1t0ky4k-0"})([".embPanel{border:none;box-shadow:none;}.mapToolbarOverlay__button{display:none;}",""],(({maintainRatio:e})=>e&&Object(B.css)(["padding-top:calc(3 / 4 * 100%);position:relative;@media only screen and (min-width:","){padding-top:calc(9 / 32 * 100%);}@media only screen and (min-width:1441px) and (min-height:901px){padding-top:calc(9 / 21 * 100%);}.embPanel{bottom:0;left:0;position:absolute;right:0;top:0;}"],(({theme:e})=>e.eui.euiBreakpoints.m)))),mh=z()(N.EuiText).withConfig({displayName:"StyledEuiText",componentId:"sc-1t0ky4k-1"})(["margin-right:16px;"]),gh=z()(N.EuiAccordion).withConfig({displayName:"StyledEuiAccordion",componentId:"sc-1t0ky4k-2"})(["& .euiAccordion__triggerWrapper{padding:16px;}"]);ph.displayName="EmbeddableMap";const fh=({endDate:e,filters:t,query:a,setQuery:n,startDate:s})=>{var o;const[l,c]=r.a.useState(void 0),{services:u}=Object(d.j)(),{storage:p}=u,[f,b]=Object(i.useState)(!1),[h,y]=Object(i.useState)(!1),[E,T]=Object(i.useState)(null===(o=p.get(dh))||void 0===o||o),[,k]=Object(J.g)(),x=Object(i.useMemo)((()=>uh.d.getSourcererDataViewsSelector()),[]),{kibanaDataViews:S}=Object(v.a)((e=>x(e))),{selectedPatterns:O}=Object(m.d)(g.SourcererScopeName.default),[w,j]=Object(i.useState)(S.filter((e=>O.includes(e.title)))),C=r.a.useMemo((()=>Object(ab.c)()),[]);Object(i.useEffect)((()=>{j((e=>{const t=S.filter((e=>O.includes(e.title)));return Li()(t,e)?e:(0===t.length&&b(!0),t)}))}),[S,O]),Object(i.useEffect)((()=>{let i=!0;return null==l&&O.length>0&&async function(){try{const o=await(async(e,t,a,n,i,s,o,l)=>{const c=l.getEmbeddableFactory(sb.MAP_SAVED_OBJECT_TYPE);if(!c)throw new Error("Map embeddable factory undefined");const u={title:ub,attributes:{title:""},id:sa.a.v4(),filters:e,hidePanelTitles:!0,query:a,timeRange:{from:new Date(n).toISOString(),to:new Date(i).toISOString()},viewMode:nb.ViewMode.VIEW,isLayerTOCOpen:!1,openTOCDetails:[],hideFilterActions:!1,mapCenter:{lon:-1.05469,lat:15.96133,zoom:1},disabledActions:["CUSTOM_TIME_RANGE","CUSTOM_TIME_RANGE_BADGE"]},d=await c.create(u);if(!d)throw new Error("Map embeddable is undefined");return Object(nb.isErrorEmbeddable)(d)||(d.setRenderTooltipContent((({addFilters:e,closeTooltip:t,features:a,isLocked:n,getLayerName:i,loadFeatureProperties:s,loadFeatureGeometry:l})=>{const c={addFilters:e,closeTooltip:t,features:a,isLocked:n,getLayerName:i,loadFeatureProperties:s,loadFeatureGeometry:l};return r.a.createElement(ab.b,rr()({node:o},c))})),d.setLayerList($b(t))),s({id:"embeddedMap",inspect:null,loading:!1,refetch:()=>d.reload()}),d})(t,w,a,s,e,n,C,u.embeddable);i&&(0===w.length?y(!0):(c(o),y(!1)))}catch(e){i&&(Object(J.d)(bb,[e.message],k),b(!0))}}(),()=>{i=!1}}),[k,e,l,t,w,a,C,u.embeddable,O,n,s]),Object(i.useEffect)((()=>{null==l||Object(nb.isErrorEmbeddable)(l)||(async()=>{null!=l&&(await l.setLayerList($b(w)),l.reload())})()}),[l,w]),Object(i.useEffect)((()=>{null!=l&&l.updateInput({query:a})}),[l,a]),Object(i.useEffect)((()=>{null!=l&&l.updateInput({filters:t})}),[l,t]),Object(i.useEffect)((()=>{if(null!=l&&null!=s&&null!=e){const t={from:new Date(s).toISOString(),to:new Date(e).toISOString()};l.updateInput({timeRange:t})}}),[l,s,e]);const I=Object(i.useCallback)((e=>{p.set(dh,e),T(e)}),[p]),M=Object(i.useMemo)((()=>E?r.a.createElement(rb,null,r.a.createElement(ab.a,{node:C},r.a.createElement(ch,null)),r.a.createElement(ph,{maintainRatio:!h},h?r.a.createElement(Kb,{"data-test-subj":"missing-prompt"}):null!=l?r.a.createElement(u.embeddable.EmbeddablePanel,{embeddable:l}):r.a.createElement(Fa.a,{"data-test-subj":"loading-panel",overlay:!0,size:"xl"}))):null),[l,h,C,u,E]);return f?null:r.a.createElement(gh,{onToggle:I,id:"network-map",arrowDisplay:"right",arrowProps:{color:"primary","data-test-subj":`${E}-toggle-network-map`},buttonContent:r.a.createElement("strong",null,lb),extraAction:r.a.createElement(mh,{size:"xs"},r.a.createElement(N.EuiLink,{href:`${u.docLinks.links.siem.networkMap}`,target:"_blank"},cb)),paddingSize:"none",initialIsOpen:E},M)};fh.displayName="EmbeddedMapComponent";const bh=r.a.memo(fh);bh.displayName="EmbeddedMap";const hh=F.i18n.translate("xpack.securitySolution.networkKpiDns.errorSearchDescription",{defaultMessage:"An error has occurred on network kpi dns search"}),yh=F.i18n.translate("xpack.securitySolution.networkKpiDns.failSearchDescription",{defaultMessage:"Failed to run search on network kpi dns"}),Eh="networkKpiDnsQuery",vh=[{key:"dnsQueries",fields:[{key:"dnsQueries",value:null,lensAttributes:{title:"[Network] DNS metric",description:"",visualizationType:"lnsMetric",state:{visualization:{layerId:"cea37c70-8f91-43bf-b9fe-72d8c049f6a3",accessor:"0374e520-eae0-4ac1-bcfe-37565e7fc9e3",layerType:"data",colorMode:"None"},query:{query:"",language:"kuery"},filters:[{meta:{index:"196d783b-3779-4c39-898e-6606fe633d05",type:"custom",disabled:!1,negate:!1,alias:null,key:"query",value:'{"bool":{"should":[{"exists":{"field":"dns.question.name"}},{"term":{"suricata.eve.dns.type":{"value":"query"}}},{"exists":{"field":"zeek.dns.query"}}],"minimum_should_match":1}}'},$state:{store:"appState"},query:{bool:{should:[{exists:{field:"dns.question.name"}},{term:{"suricata.eve.dns.type":{value:"query"}}},{exists:{field:"zeek.dns.query"}}],minimum_should_match:1}}}],datasourceStates:{indexpattern:{layers:{"cea37c70-8f91-43bf-b9fe-72d8c049f6a3":{columns:{"0374e520-eae0-4ac1-bcfe-37565e7fc9e3":{label:"",dataType:"number",operationType:"count",isBucketed:!1,scale:"ratio",sourceField:"___records___",customLabel:!0}},columnOrder:["0374e520-eae0-4ac1-bcfe-37565e7fc9e3"],incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-cea37c70-8f91-43bf-b9fe-72d8c049f6a3"},{type:"index-pattern",name:"196d783b-3779-4c39-898e-6606fe633d05",id:"{dataViewId}"}]}}],description:F.i18n.translate("xpack.securitySolution.kpiNetwork.dnsQueries.title",{defaultMessage:"DNS queries"})}],Th=({filterQuery:e,from:t,indexNames:a,to:n,narrowDateRange:s,setQuery:o,skip:l})=>{const{toggleStatus:c}=Object(Ea.a)(Eh),[u,p]=Object(i.useState)(l||!c);Object(i.useEffect)((()=>{p(l||!c)}),[l,c]);const[m,{refetch:g,id:f,inspect:b,...h}]=(({filterQuery:e,endDate:t,indexNames:a,skip:n=!1,startDate:r})=>{const{data:s}=Object(d.j)().services,o=Object(i.useRef)(E.noop),l=Object(i.useRef)(new AbortController),c=Object(i.useRef)(new Xi.Subscription),[u,p]=Object(i.useState)(!1),[m,g]=Object(i.useState)(null),[f,b]=Object(i.useState)({dnsQueries:0,id:Eh,inspect:{dsl:[],response:[]},isInspected:!1,refetch:o.current}),{addError:h,addWarning:y}=Object(X.a)(),v=Object(i.useCallback)((e=>{if(null==e||n)return;const t=async()=>{l.current=new AbortController,p(!0),c.current=s.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:l.current.signal}).subscribe({next:e=>{Object(K.isCompleteResponse)(e)?(p(!1),b((t=>({...t,dnsQueries:e.dnsQueries,inspect:Object(ar.c)(e,t.inspect),refetch:o.current}))),c.current.unsubscribe()):Object(K.isErrorResponse)(e)&&(p(!1),y(hh),c.current.unsubscribe())},error:e=>{p(!1),h(e,{title:yh}),c.current.unsubscribe()}})};c.current.unsubscribe(),l.current.abort(),t(),o.current=t}),[s.search,h,y,n]);return Object(i.useEffect)((()=>{g((n=>{const i={...null!=n?n:{},defaultIndex:a,factoryQueryType:Ii.n.dns,filterQuery:Object(Zi.a)(e),timerange:{interval:"12h",from:r,to:t}};return Li()(n,i)?n:i}))}),[a,t,e,r]),Object(i.useEffect)((()=>(v(m),()=>{c.current.unsubscribe(),l.current.abort()})),[m,v]),Object(i.useEffect)((()=>{n&&(p(!1),c.current.unsubscribe(),l.current.abort())}),[n]),[u,f]})({filterQuery:e,endDate:n,indexNames:a,startDate:t,skip:u});return r.a.createElement(qr,{data:h,id:f,inspect:b,loading:m,fieldsMapping:vh,from:t,to:n,narrowDateRange:s,refetch:g,setQuery:o,setQuerySkip:p})},kh=r.a.memo(Th),xh=F.i18n.translate("xpack.securitySolution.networkKpiNetworkEvents.errorSearchDescription",{defaultMessage:"An error has occurred on network kpi network events search"}),Sh=F.i18n.translate("xpack.securitySolution.networkKpiNetworkEvents.failSearchDescription",{defaultMessage:"Failed to run search on network kpi network events"}),Oh="networkKpiNetworkEventsQuery",wh=F.i18n.translate("xpack.securitySolution.kpiNetwork.networkEvents.title",{defaultMessage:"Network events"}),jh=[{key:"networkEvents",fields:[{key:"networkEvents",value:null,color:Object(N.euiPaletteColorBlind)()[1],lensAttributes:{title:"[Network] Network events",description:"",visualizationType:"lnsMetric",state:{visualization:{layerId:"eaadfec7-deaa-4aeb-a403-3b4e516416d2",accessor:"370ebd07-5ce0-4f46-a847-0e363c50d037",layerType:"data"},query:{query:"",language:"kuery"},filters:[{meta:{index:"security-solution-default",alias:null,negate:!1,disabled:!1,type:"exists",key:"source.ip",value:"exists"},query:{exists:{field:"source.ip"}},$state:{store:"appState"}},{meta:{index:"security-solution-default",alias:null,negate:!1,disabled:!1,type:"exists",key:"destination.ip",value:"exists"},query:{exists:{field:"destination.ip"}},$state:{store:"appState"}}],datasourceStates:{indexpattern:{layers:{"eaadfec7-deaa-4aeb-a403-3b4e516416d2":{columns:{"370ebd07-5ce0-4f46-a847-0e363c50d037":{label:" ",dataType:"number",operationType:"count",isBucketed:!1,scale:"ratio",sourceField:"___records___",customLabel:!0}},columnOrder:["370ebd07-5ce0-4f46-a847-0e363c50d037"],incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-eaadfec7-deaa-4aeb-a403-3b4e516416d2"},{type:"index-pattern",name:"861af17d-be25-45a3-a82d-d6e697b76e51",id:"{dataViewId}"},{type:"index-pattern",name:"09617767-f732-410e-af53-bebcbd0bf4b9",id:"{dataViewId}"}]}}],description:wh}],Ch=({filterQuery:e,from:t,indexNames:a,to:n,narrowDateRange:s,setQuery:o,skip:l})=>{const{toggleStatus:c}=Object(Ea.a)(Oh),[u,p]=Object(i.useState)(l||!c);Object(i.useEffect)((()=>{p(l||!c)}),[l,c]);const[m,{refetch:g,id:f,inspect:b,...h}]=(({filterQuery:e,endDate:t,indexNames:a,skip:n=!1,startDate:r})=>{const{data:s}=Object(d.j)().services,o=Object(i.useRef)(E.noop),l=Object(i.useRef)(new AbortController),c=Object(i.useRef)(new Xi.Subscription),[u,p]=Object(i.useState)(!1),[m,g]=Object(i.useState)(null),[f,b]=Object(i.useState)({networkEvents:0,id:Oh,inspect:{dsl:[],response:[]},isInspected:!1,refetch:o.current}),{addError:h,addWarning:y}=Object(X.a)(),v=Object(i.useCallback)((e=>{if(null==e||n)return;const t=async()=>{l.current=new AbortController,p(!0),c.current=s.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:l.current.signal}).subscribe({next:e=>{Object(K.isCompleteResponse)(e)?(p(!1),b((t=>({...t,networkEvents:e.networkEvents,inspect:Object(ar.c)(e,t.inspect),refetch:o.current}))),c.current.unsubscribe()):Object(K.isErrorResponse)(e)&&(p(!1),y(xh),c.current.unsubscribe())},error:e=>{p(!1),h(e,{title:Sh}),c.current.unsubscribe()}})};c.current.unsubscribe(),l.current.abort(),t(),o.current=t}),[s.search,h,y,n]);return Object(i.useEffect)((()=>{g((n=>{const i={...null!=n?n:{},defaultIndex:a,factoryQueryType:Ii.n.networkEvents,filterQuery:Object(Zi.a)(e),timerange:{interval:"12h",from:r,to:t}};return Li()(n,i)?n:i}))}),[a,t,e,r]),Object(i.useEffect)((()=>(v(m),()=>{c.current.unsubscribe(),l.current.abort()})),[m,v]),Object(i.useEffect)((()=>{n&&(p(!1),c.current.unsubscribe(),l.current.abort())}),[n]),[u,f]})({filterQuery:e,endDate:n,indexNames:a,startDate:t,skip:u});return r.a.createElement(qr,{data:h,id:f,inspect:b,loading:m,fieldsMapping:jh,from:t,to:n,narrowDateRange:s,refetch:g,setQuery:o,setQuerySkip:p})},Ih=r.a.memo(Ch),Mh=F.i18n.translate("xpack.securitySolution.networkKpiTlsHandshakes.errorSearchDescription",{defaultMessage:"An error has occurred on network kpi tls handshakes search"}),Ah=F.i18n.translate("xpack.securitySolution.networkKpiTlsHandshakes.failSearchDescription",{defaultMessage:"Failed to run search on network kpi tls handshakes"}),Dh="networkKpiTlsHandshakesQuery",qh=[{key:"tlsHandshakes",fields:[{key:"tlsHandshakes",value:null,lensAttributes:{title:"[Network] TLS handshakes",description:"",visualizationType:"lnsMetric",state:{visualization:{layerId:"1f48a633-8eee-45ae-9471-861227e9ca03",accessor:"21052b6b-5504-4084-a2e2-c17f772345cf",layerType:"data"},query:{query:"(source.ip: * or destination.ip: *) and (tls.version: * or suricata.eve.tls.version: * or zeek.ssl.version: * )",language:"kuery"},filters:[{meta:{index:"32ee22d9-2e77-4aee-8073-87750e92c3ee",type:"custom",disabled:!1,negate:!1,alias:null,key:"query",value:'{"bool":{"should":[{"exists":{"field":"source.ip"}},{"exists":{"field":"destination.ip"}}],"minimum_should_match":1}}'},$state:{store:"appState"},query:{bool:{should:[{exists:{field:"source.ip"}},{exists:{field:"destination.ip"}}],minimum_should_match:1}}},{meta:{index:"1e93f984-9374-4755-a198-de57751533c6",type:"custom",disabled:!1,negate:!1,alias:null,key:"query",value:'{"bool":{"should":[{"exists":{"field":"tls.version"}},{"exists":{"field":"suricata.eve.tls.version"}},{"exists":{"field":"zeek.ssl.version"}}],"minimum_should_match":1}}'},$state:{store:"appState"},query:{bool:{should:[{exists:{field:"tls.version"}},{exists:{field:"suricata.eve.tls.version"}},{exists:{field:"zeek.ssl.version"}}],minimum_should_match:1}}}],datasourceStates:{indexpattern:{layers:{"1f48a633-8eee-45ae-9471-861227e9ca03":{columns:{"21052b6b-5504-4084-a2e2-c17f772345cf":{label:" ",dataType:"number",operationType:"count",isBucketed:!1,scale:"ratio",sourceField:"___records___",customLabel:!0}},columnOrder:["21052b6b-5504-4084-a2e2-c17f772345cf"],incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-1f48a633-8eee-45ae-9471-861227e9ca03"}]}}],description:F.i18n.translate("xpack.securitySolution.kpiNetwork.tlsHandshakes.title",{defaultMessage:"TLS handshakes"})}],Ph=({filterQuery:e,from:t,indexNames:a,to:n,narrowDateRange:s,setQuery:o,skip:l})=>{const{toggleStatus:c}=Object(Ea.a)(Dh),[u,p]=Object(i.useState)(l||!c);Object(i.useEffect)((()=>{p(l||!c)}),[l,c]);const[m,{refetch:g,id:f,inspect:b,...h}]=(({filterQuery:e,endDate:t,indexNames:a,skip:n=!1,startDate:r})=>{const{data:s}=Object(d.j)().services,o=Object(i.useRef)(E.noop),l=Object(i.useRef)(new AbortController),c=Object(i.useRef)(new Xi.Subscription),[u,p]=Object(i.useState)(!1),[m,g]=Object(i.useState)(null),[f,b]=Object(i.useState)({tlsHandshakes:0,id:Dh,inspect:{dsl:[],response:[]},isInspected:!1,refetch:o.current}),{addError:h,addWarning:y}=Object(X.a)(),v=Object(i.useCallback)((e=>{if(null==e||n)return;const t=async()=>{l.current=new AbortController,p(!0),c.current=s.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:l.current.signal}).subscribe({next:e=>{Object(K.isCompleteResponse)(e)?(p(!1),b((t=>({...t,tlsHandshakes:e.tlsHandshakes,inspect:Object(ar.c)(e,t.inspect),refetch:o.current}))),c.current.unsubscribe()):Object(K.isErrorResponse)(e)&&(p(!1),y(Mh),c.current.unsubscribe())},error:e=>{p(!1),h(e,{title:Ah}),c.current.unsubscribe()}})};c.current.unsubscribe(),l.current.abort(),t(),o.current=t}),[s.search,h,y,n]);return Object(i.useEffect)((()=>{g((n=>{const i={...null!=n?n:{},defaultIndex:a,factoryQueryType:Ii.n.tlsHandshakes,filterQuery:Object(Zi.a)(e),timerange:{interval:"12h",from:r,to:t}};return Li()(n,i)?n:i}))}),[a,t,e,r]),Object(i.useEffect)((()=>(v(m),()=>{c.current.unsubscribe(),l.current.abort()})),[m,v]),Object(i.useEffect)((()=>{n&&(p(!1),c.current.unsubscribe(),l.current.abort())}),[n]),[u,f]})({filterQuery:e,endDate:n,indexNames:a,startDate:t,skip:u});return r.a.createElement(qr,{data:h,id:f,inspect:b,loading:m,fieldsMapping:qh,from:t,to:n,narrowDateRange:s,refetch:g,setQuery:o,setQuerySkip:p})},Rh=r.a.memo(Ph),_h=F.i18n.translate("xpack.securitySolution.networkKpiUniqueFlows.errorSearchDescription",{defaultMessage:"An error has occurred on network kpi unique flows search"}),Fh=F.i18n.translate("xpack.securitySolution.networkKpiUniqueFlows.failSearchDescription",{defaultMessage:"Failed to run search on network kpi unique flows"}),Lh="networkKpiUniqueFlowsQuery",Nh=[{key:"uniqueFlowId",fields:[{key:"uniqueFlowId",value:null,lensAttributes:{title:"[Network] Unique flow IDs",description:"",visualizationType:"lnsMetric",state:{visualization:{layerId:"5d46d48f-6ce8-46be-a797-17ad50642564",accessor:"a27f3503-9c73-4fc1-86bb-12461dae4b70",layerType:"data"},query:{query:"source.ip: * or destination.ip: * ",language:"kuery"},filters:[{meta:{index:"c01edc8a-90ce-4d49-95f0-76954a034eb2",type:"custom",disabled:!1,negate:!1,alias:null,key:"query",value:'{"bool":{"should":[{"exists":{"field":"source.ip"}},{"exists":{"field":"destination.ip"}}],"minimum_should_match":1}}'},$state:{store:"appState"},query:{bool:{should:[{exists:{field:"source.ip"}},{exists:{field:"destination.ip"}}],minimum_should_match:1}}}],datasourceStates:{indexpattern:{layers:{"5d46d48f-6ce8-46be-a797-17ad50642564":{columns:{"a27f3503-9c73-4fc1-86bb-12461dae4b70":{label:" ",dataType:"number",operationType:"unique_count",scale:"ratio",sourceField:"network.community_id",isBucketed:!1,customLabel:!0}},columnOrder:["a27f3503-9c73-4fc1-86bb-12461dae4b70"],incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-5d46d48f-6ce8-46be-a797-17ad50642564"}]}}],description:F.i18n.translate("xpack.securitySolution.kpiNetwork.uniqueFlowIds.title",{defaultMessage:"Unique flow IDs"})}],Bh=({filterQuery:e,from:t,indexNames:a,to:n,narrowDateRange:s,setQuery:o,skip:l})=>{const{toggleStatus:c}=Object(Ea.a)(Lh),[u,p]=Object(i.useState)(l||!c);Object(i.useEffect)((()=>{p(l||!c)}),[l,c]);const[m,{refetch:g,id:f,inspect:b,...h}]=(({filterQuery:e,endDate:t,indexNames:a,skip:n=!1,startDate:r})=>{const{data:s}=Object(d.j)().services,o=Object(i.useRef)(E.noop),l=Object(i.useRef)(new AbortController),c=Object(i.useRef)(new Xi.Subscription),[u,p]=Object(i.useState)(!1),[m,g]=Object(i.useState)(null),[f,b]=Object(i.useState)({uniqueFlowId:0,id:Lh,inspect:{dsl:[],response:[]},isInspected:!1,refetch:o.current}),{addError:h,addWarning:y}=Object(X.a)(),v=Object(i.useCallback)((e=>{if(null==e||n)return;const t=async()=>{l.current=new AbortController,p(!0),c.current=s.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:l.current.signal}).subscribe({next:e=>{Object(K.isCompleteResponse)(e)?(p(!1),b((t=>({...t,uniqueFlowId:e.uniqueFlowId,inspect:Object(ar.c)(e,t.inspect),refetch:o.current}))),c.current.unsubscribe()):Object(K.isErrorResponse)(e)&&(p(!1),y(_h),c.current.unsubscribe())},error:e=>{p(!1),h(e,{title:Fh}),c.current.unsubscribe()}})};c.current.unsubscribe(),l.current.abort(),t(),o.current=t}),[s.search,h,y,n]);return Object(i.useEffect)((()=>{g((n=>{const i={...null!=n?n:{},defaultIndex:a,factoryQueryType:Ii.n.uniqueFlows,filterQuery:Object(Zi.a)(e),timerange:{interval:"12h",from:r,to:t}};return Li()(n,i)?n:i}))}),[a,t,e,r]),Object(i.useEffect)((()=>(v(m),()=>{c.current.unsubscribe(),l.current.abort()})),[m,v]),Object(i.useEffect)((()=>{n&&(p(!1),c.current.unsubscribe(),l.current.abort())}),[n]),[u,f]})({filterQuery:e,endDate:n,indexNames:a,startDate:t,skip:u});return r.a.createElement(qr,{data:h,id:f,inspect:b,loading:m,fieldsMapping:Nh,from:t,to:n,narrowDateRange:s,refetch:g,setQuery:o,setQuerySkip:p})},zh=r.a.memo(Bh),Uh=F.i18n.translate("xpack.securitySolution.networkKpiUniquePrivateIps.errorSearchDescription",{defaultMessage:"An error has occurred on network kpi unique private ips search"}),Hh=F.i18n.translate("xpack.securitySolution.networkKpiUniquePrivateIps.failSearchDescription",{defaultMessage:"Failed to run search on network kpi unique private ips"}),$h="networkKpiUniquePrivateIpsQuery",Vh=F.i18n.translate("xpack.securitySolution.kpiNetwork.uniquePrivateIps.title",{defaultMessage:"Unique private IPs"}),Qh=F.i18n.translate("xpack.securitySolution.kpiNetwork.uniquePrivateIps.sourceUnitLabel",{defaultMessage:"source"}),Wh=F.i18n.translate("xpack.securitySolution.kpiNetwork.uniquePrivateIps.destinationUnitLabel",{defaultMessage:"destination"}),Gh=F.i18n.translate("xpack.securitySolution.kpiNetwork.uniquePrivateIps.sourceChartLabel",{defaultMessage:"Src."}),Kh=F.i18n.translate("xpack.securitySolution.kpiNetwork.uniquePrivateIps.destinationChartLabel",{defaultMessage:"Dest."}),Yh={title:"[Network] Unique private IPs - bar chart",description:"",visualizationType:"lnsXY",state:{visualization:{legend:{isVisible:!1,position:"right",showSingleSeries:!1},valueLabels:"hide",fittingFunction:"None",yLeftExtent:{mode:"full"},yRightExtent:{mode:"full"},axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!0},tickLabelsVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},labelsOrientation:{x:0,yLeft:0,yRight:0},gridlinesVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},preferredSeriesType:"bar_horizontal_stacked",layers:[{layerId:"e406bf4f-942b-41ac-b516-edb5cef06ec8",accessors:["5acd4c9d-dc3b-4b21-9632-e4407944c36d"],position:"top",seriesType:"bar_horizontal_stacked",showGridlines:!1,layerType:"data",yConfig:[{forAccessor:"5acd4c9d-dc3b-4b21-9632-e4407944c36d",color:"#d36186"}],xAccessor:"d9c438c5-f776-4436-9d20-d62dc8c03be8"},{layerId:"38aa6532-6bf9-4c8f-b2a6-da8d32f7d0d7",seriesType:"bar_horizontal_stacked",accessors:["d27e0966-daf9-41f4-9033-230cf1e76dc9"],layerType:"data",yConfig:[{forAccessor:"d27e0966-daf9-41f4-9033-230cf1e76dc9",color:"#9170b8"}],xAccessor:"4607c585-3af3-43b9-804f-e49b27796d79"}]},query:{query:"",language:"kuery"},filters:[],datasourceStates:{indexpattern:{layers:{"e406bf4f-942b-41ac-b516-edb5cef06ec8":{columns:{"5acd4c9d-dc3b-4b21-9632-e4407944c36d":{label:Yi.i,dataType:"number",isBucketed:!1,operationType:"unique_count",scale:"ratio",sourceField:"source.ip",filter:{query:'source.ip: "10.0.0.0/8" or source.ip: "192.168.0.0/16" or source.ip: "172.16.0.0/12" or source.ip: "fd00::/8"',language:"kuery"}},"d9c438c5-f776-4436-9d20-d62dc8c03be8":{label:"Filters",dataType:"string",operationType:"filters",scale:"ordinal",isBucketed:!0,params:{filters:[{input:{query:"",language:"kuery"},label:Yi.i}]}}},columnOrder:["d9c438c5-f776-4436-9d20-d62dc8c03be8","5acd4c9d-dc3b-4b21-9632-e4407944c36d"],incompleteColumns:{}},"38aa6532-6bf9-4c8f-b2a6-da8d32f7d0d7":{columns:{"d27e0966-daf9-41f4-9033-230cf1e76dc9":{label:Yi.d,dataType:"number",isBucketed:!1,operationType:"unique_count",scale:"ratio",sourceField:"destination.ip",filter:{query:'"destination.ip": "10.0.0.0/8" or "destination.ip": "192.168.0.0/16" or "destination.ip": "172.16.0.0/12" or "destination.ip": "fd00::/8"',language:"kuery"}},"4607c585-3af3-43b9-804f-e49b27796d79":{label:"Filters",dataType:"string",operationType:"filters",scale:"ordinal",isBucketed:!0,params:{filters:[{input:{query:"",language:"kuery"},label:Yi.d}]}}},columnOrder:["4607c585-3af3-43b9-804f-e49b27796d79","d27e0966-daf9-41f4-9033-230cf1e76dc9"],incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-e406bf4f-942b-41ac-b516-edb5cef06ec8"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-38aa6532-6bf9-4c8f-b2a6-da8d32f7d0d7"}]},Jh=Object(N.euiPaletteColorBlind)(),Xh=[{key:"UniqueIps",fields:[{key:"uniqueSourcePrivateIps",value:null,name:Gh,description:Qh,color:Jh[2],icon:"visMapCoordinate",lensAttributes:{description:"",state:{datasourceStates:{indexpattern:{layers:{"cea37c70-8f91-43bf-b9fe-72d8c049f6a3":{columnOrder:["bd17c23e-4f83-4108-8005-2669170d064b"],columns:{"bd17c23e-4f83-4108-8005-2669170d064b":{customLabel:!0,dataType:"number",isBucketed:!1,label:"",operationType:"unique_count",scale:"ratio",sourceField:"source.ip",filter:{query:'source.ip: "10.0.0.0/8" or source.ip: "192.168.0.0/16" or source.ip: "172.16.0.0/12" or source.ip: "fd00::/8"',language:"kuery"}}},incompleteColumns:{}}}}},filters:[],query:{language:"kuery",query:""},visualization:{accessor:"bd17c23e-4f83-4108-8005-2669170d064b",layerId:"cea37c70-8f91-43bf-b9fe-72d8c049f6a3",layerType:"data"}},title:"[Network] Unique private IPs - source metric",visualizationType:"lnsMetric",references:[{id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-cea37c70-8f91-43bf-b9fe-72d8c049f6a3",type:"index-pattern"}]}},{key:"uniqueDestinationPrivateIps",value:null,name:Kh,description:Wh,color:Jh[3],icon:"visMapCoordinate",lensAttributes:{description:"",state:{datasourceStates:{indexpattern:{layers:{"cea37c70-8f91-43bf-b9fe-72d8c049f6a3":{columnOrder:["bd17c23e-4f83-4108-8005-2669170d064b"],columns:{"bd17c23e-4f83-4108-8005-2669170d064b":{customLabel:!0,dataType:"number",isBucketed:!1,label:"",operationType:"unique_count",scale:"ratio",sourceField:"destination.ip",filter:{language:"kuery",query:'"destination.ip": "10.0.0.0/8" or "destination.ip": "192.168.0.0/16" or "destination.ip": "172.16.0.0/12" or "destination.ip": "fd00::/8"'}}},incompleteColumns:{}}}}},filters:[],query:{language:"kuery",query:""},visualization:{accessor:"bd17c23e-4f83-4108-8005-2669170d064b",layerId:"cea37c70-8f91-43bf-b9fe-72d8c049f6a3",layerType:"data"}},title:"[Network] Unique private IPs - destination metric",visualizationType:"lnsMetric",references:[{id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-cea37c70-8f91-43bf-b9fe-72d8c049f6a3",type:"index-pattern"}]}}],description:Vh,enableAreaChart:!0,enableBarChart:!0,areaChartLensAttributes:{title:"[Network] Unique private IPs - area chart",description:"",visualizationType:"lnsXY",state:{visualization:{legend:{isVisible:!1,position:"right",showSingleSeries:!1},valueLabels:"hide",fittingFunction:"None",yLeftExtent:{mode:"full"},yRightExtent:{mode:"full"},axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!0},tickLabelsVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},labelsOrientation:{x:0,yLeft:0,yRight:0},gridlinesVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},preferredSeriesType:"area",layers:[{layerId:"38aa6532-6bf9-4c8f-b2a6-da8d32f7d0d7",seriesType:"area",accessors:["5f317308-cfbb-4ee5-bfb9-07653184fabf"],layerType:"data",xAccessor:"662cd5e5-82bf-4325-a703-273f84b97e09",yConfig:[{forAccessor:"5f317308-cfbb-4ee5-bfb9-07653184fabf",color:"#d36186"}]},{layerId:"72dc4b99-b07d-4dc9-958b-081d259e11fa",seriesType:"area",accessors:["ac1eb80c-ddde-46c4-a90c-400261926762"],layerType:"data",xAccessor:"36444b8c-7e10-4069-8298-6c1b46912be2",yConfig:[{forAccessor:"ac1eb80c-ddde-46c4-a90c-400261926762",color:"#9170b8"}]}]},query:{query:"",language:"kuery"},filters:[],datasourceStates:{indexpattern:{layers:{"38aa6532-6bf9-4c8f-b2a6-da8d32f7d0d7":{columns:{"662cd5e5-82bf-4325-a703-273f84b97e09":{label:"@timestamp",dataType:"date",operationType:"date_histogram",sourceField:"@timestamp",isBucketed:!0,scale:"interval",params:{interval:"auto"}},"5f317308-cfbb-4ee5-bfb9-07653184fabf":{label:"Src.",dataType:"number",operationType:"unique_count",scale:"ratio",sourceField:"source.ip",isBucketed:!1,customLabel:!0,filter:{query:'"source.ip": "10.0.0.0/8" or "source.ip": "192.168.0.0/16" or "source.ip": "172.16.0.0/12" or "source.ip": "fd00::/8"',language:"kuery"}}},columnOrder:["662cd5e5-82bf-4325-a703-273f84b97e09","5f317308-cfbb-4ee5-bfb9-07653184fabf"],incompleteColumns:{}},"72dc4b99-b07d-4dc9-958b-081d259e11fa":{columns:{"36444b8c-7e10-4069-8298-6c1b46912be2":{label:"@timestamp",dataType:"date",operationType:"date_histogram",sourceField:"@timestamp",isBucketed:!0,scale:"interval",params:{interval:"auto"}},"ac1eb80c-ddde-46c4-a90c-400261926762":{label:"Dest.",dataType:"number",operationType:"unique_count",scale:"ratio",sourceField:"destination.ip",isBucketed:!1,filter:{query:'"destination.ip": "10.0.0.0/8" or "destination.ip": "192.168.0.0/16" or "destination.ip": "172.16.0.0/12" or "destination.ip": "fd00::/8"',language:"kuery"}}},columnOrder:["36444b8c-7e10-4069-8298-6c1b46912be2","ac1eb80c-ddde-46c4-a90c-400261926762"],incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-38aa6532-6bf9-4c8f-b2a6-da8d32f7d0d7"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-72dc4b99-b07d-4dc9-958b-081d259e11fa"}]},barChartLensAttributes:Yh}],Zh=({filterQuery:e,from:t,indexNames:a,to:n,narrowDateRange:s,setQuery:o,skip:l})=>{const{toggleStatus:c}=Object(Ea.a)($h),[u,p]=Object(i.useState)(l||!c);Object(i.useEffect)((()=>{p(l||!c)}),[l,c]);const[m,{refetch:g,id:f,inspect:b,...h}]=(({filterQuery:e,endDate:t,indexNames:a,skip:n=!1,startDate:r})=>{const{data:s}=Object(d.j)().services,o=Object(i.useRef)(E.noop),l=Object(i.useRef)(new AbortController),c=Object(i.useRef)(new Xi.Subscription),[u,p]=Object(i.useState)(!1),[m,g]=Object(i.useState)(null),[f,b]=Object(i.useState)({uniqueDestinationPrivateIps:0,uniqueDestinationPrivateIpsHistogram:null,uniqueSourcePrivateIps:0,uniqueSourcePrivateIpsHistogram:null,id:$h,inspect:{dsl:[],response:[]},isInspected:!1,refetch:o.current}),{addError:h,addWarning:y}=Object(X.a)(),v=Object(i.useCallback)((e=>{if(null==e||n)return;const t=async()=>{l.current=new AbortController,p(!0),c.current=s.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:l.current.signal}).subscribe({next:e=>{Object(K.isCompleteResponse)(e)?(p(!1),b((t=>({...t,uniqueDestinationPrivateIps:e.uniqueDestinationPrivateIps,uniqueDestinationPrivateIpsHistogram:e.uniqueDestinationPrivateIpsHistogram,uniqueSourcePrivateIps:e.uniqueSourcePrivateIps,uniqueSourcePrivateIpsHistogram:e.uniqueSourcePrivateIpsHistogram,inspect:Object(ar.c)(e,t.inspect),refetch:o.current}))),c.current.unsubscribe()):Object(K.isErrorResponse)(e)&&(p(!1),y(Uh),c.current.unsubscribe())},error:e=>{p(!1),h(e,{title:Hh}),c.current.unsubscribe()}})};c.current.unsubscribe(),l.current.abort(),t(),o.current=t}),[s.search,h,y,n]);return Object(i.useEffect)((()=>{g((n=>{const i={...null!=n?n:{},defaultIndex:a,factoryQueryType:Ii.n.uniquePrivateIps,filterQuery:Object(Zi.a)(e),timerange:{interval:"12h",from:r,to:t}};return Li()(n,i)?n:i}))}),[a,t,e,r]),Object(i.useEffect)((()=>(v(m),()=>{c.current.unsubscribe(),l.current.abort()})),[m,v]),Object(i.useEffect)((()=>{n&&(p(!1),c.current.unsubscribe(),l.current.abort())}),[n]),[u,f]})({filterQuery:e,endDate:n,indexNames:a,startDate:t,skip:u});return r.a.createElement(qr,{data:h,id:f,inspect:b,loading:m,fieldsMapping:Xh,from:t,to:n,narrowDateRange:s,refetch:g,setQuery:o,setQuerySkip:p})},ey=r.a.memo(Zh),ty=r.a.memo((({filterQuery:e,from:t,indexNames:a,to:n,setQuery:i,skip:s,narrowDateRange:o})=>r.a.createElement(N.EuiFlexGroup,{wrap:!0},r.a.createElement(N.EuiFlexItem,{grow:1},r.a.createElement(N.EuiFlexGroup,{wrap:!0},r.a.createElement(N.EuiFlexItem,null,r.a.createElement(Ih,{filterQuery:e,from:t,indexNames:a,to:n,narrowDateRange:o,setQuery:i,skip:s})),r.a.createElement(N.EuiFlexItem,null,r.a.createElement(kh,{filterQuery:e,from:t,indexNames:a,to:n,narrowDateRange:o,setQuery:i,skip:s}))),r.a.createElement(N.EuiSpacer,{size:"l"}),r.a.createElement(N.EuiFlexGroup,{wrap:!0},r.a.createElement(N.EuiFlexItem,null,r.a.createElement(zh,{filterQuery:e,from:t,indexNames:a,to:n,narrowDateRange:o,setQuery:i,skip:s})),r.a.createElement(N.EuiFlexItem,null,r.a.createElement(Rh,{filterQuery:e,from:t,indexNames:a,to:n,narrowDateRange:o,setQuery:i,skip:s})))),r.a.createElement(N.EuiFlexItem,{grow:1},r.a.createElement(ey,{filterQuery:e,from:t,indexNames:a,to:n,narrowDateRange:o,setQuery:i,skip:s})))));ty.displayName="NetworkKpiComponent";var ay=a(214),ny=a(94),iy=a(828),ry=a(851);const sy=Object(sr.a)(iy.a),oy=({endDate:e,filterQuery:t,indexNames:a,skip:n,startDate:s,setQuery:o,flowTarget:l})=>{const{toggleStatus:c}=Object(Ea.a)(`${ry.a}-${l}`),[u,d]=Object(i.useState)(n||!c);Object(i.useEffect)((()=>{d(n||!c)}),[n,c]);const[p,{id:m,inspect:g,isInspected:f,loadPage:b,networkTopNFlow:h,pageInfo:y,refetch:v,totalCount:T}]=Object(ry.b)({endDate:e,flowTarget:l,filterQuery:t,indexNames:a,skip:u,startDate:s,type:ay.c.NetworkType.page});return r.a.createElement(sy,{data:h,fakeTotalCount:Object(E.getOr)(50,"fakeTotalCount",y),flowTargeted:l,id:m,inspect:g,isInspect:f,loading:p,loadPage:b,refetch:v,setQuery:o,setQuerySkip:d,showMorePagesIndicator:Object(E.getOr)(!1,"showMorePagesIndicator",y),totalCount:T,type:ay.c.NetworkType.page})};oy.displayName="IPsQueryTabBody";var ly=a(827),cy=a(850);const uy=Object(sr.a)(ly.a),dy=({endDate:e,filterQuery:t,indexNames:a,skip:n,startDate:s,setQuery:o,indexPattern:l,flowTarget:c})=>{const{toggleStatus:u}=Object(Ea.a)(`${cy.a}-${c}`),[d,p]=Object(i.useState)(n||!u);Object(i.useEffect)((()=>{p(n||!u)}),[n,u]);const[m,{id:g,inspect:f,isInspected:b,loadPage:h,networkTopCountries:y,pageInfo:v,refetch:T,totalCount:k}]=Object(cy.b)({endDate:e,flowTarget:c,filterQuery:t,indexNames:a,skip:d,startDate:s,type:ay.c.NetworkType.page});return r.a.createElement(uy,{data:y,fakeTotalCount:Object(E.getOr)(50,"fakeTotalCount",v),flowTargeted:c,id:g,indexPattern:l,inspect:f,isInspect:b,loading:m,loadPage:h,refetch:T,setQuery:o,setQuerySkip:p,showMorePagesIndicator:Object(E.getOr)(!1,"showMorePagesIndicator",v),totalCount:k,type:ay.c.NetworkType.page})};dy.displayName="CountriesQueryTabBody";var py=a(826),my=a(849);const gy=Object(sr.a)(py.a),fy=({endDate:e,filterQuery:t,indexNames:a,skip:n,startDate:s,setQuery:o})=>{const{toggleStatus:l}=Object(Ea.a)(my.a),[c,u]=Object(i.useState)(n||!l);Object(i.useEffect)((()=>{u(n||!l)}),[n,l]);const[d,{id:p,inspect:m,isInspected:g,loadPage:f,networkHttp:b,pageInfo:h,refetch:y,totalCount:v}]=Object(my.b)({endDate:e,filterQuery:t,indexNames:a,skip:c,startDate:s,type:ay.c.NetworkType.page});return r.a.createElement(gy,{data:b,fakeTotalCount:Object(E.getOr)(50,"fakeTotalCount",h),id:p,inspect:m,isInspect:g,loading:d,loadPage:f,refetch:y,setQuery:o,setQuerySkip:u,showMorePagesIndicator:Object(E.getOr)(!1,"showMorePagesIndicator",h),totalCount:v,type:ay.c.NetworkType.page})};fy.displayName="HttpQueryTabBody";var by=a(805),hy=a(373);const yy=F.i18n.translate("xpack.securitySolution.networkDnsTable.title",{defaultMessage:"Top DNS domains"}),Ey=e=>F.i18n.translate("xpack.securitySolution.networkDnsTable.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {domain} other {domains}}"}),vy=F.i18n.translate("xpack.securitySolution.networkDnsTable.helperTooltip",{defaultMessage:"This shows DNS protocol traffic only and can be useful for hunting domains used in DNS data exfiltration."}),Ty=F.i18n.translate("xpack.securitySolution.networkDnsTable.column.registeredDomain",{defaultMessage:"Registered domain"}),ky=F.i18n.translate("xpack.securitySolution.networkDnsTable.column.TotalQueriesTitle",{defaultMessage:"Total queries"}),xy=F.i18n.translate("xpack.securitySolution.networkDnsTable.column.uniqueDomainsTitle",{defaultMessage:"Unique domains"}),Sy=F.i18n.translate("xpack.securitySolution.networkDnsTable.column.bytesInTitle",{defaultMessage:"DNS bytes in"}),Oy=F.i18n.translate("xpack.securitySolution.networkDnsTable.column.bytesOutTitle",{defaultMessage:"DNS bytes out"}),wy=F.i18n.translate("xpack.securitySolution.networkDnsTable.select.includePtrRecords",{defaultMessage:"Include PTR records"}),jy=F.i18n.translate("xpack.securitySolution.networkDnsTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),Cy=F.i18n.translate("xpack.securitySolution.networkDnsTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),Iy=r.a.memo((({isPtrIncluded:e,onChange:t})=>r.a.createElement(N.EuiSwitch,{name:"switch-ptr-included",label:wy,checked:e,onChange:t})));Iy.displayName="IsPtrIncluded";const My=ay.c.NetworkTableType.dns,Ay=[{text:jy,numberOfRow:5},{text:Cy,numberOfRow:10}],Dy=({data:e,fakeTotalCount:t,id:a,isInspect:n,loading:s,loadPage:o,showMorePagesIndicator:c,setQuerySkip:u,totalCount:d,type:p})=>{const m=Object(l.useDispatch)(),g=Object(i.useMemo)((()=>ay.e.dnsSelector()),[]),{activePage:f,isPtrIncluded:b,limit:h,sort:y}=Object(v.a)(g),E=Object(i.useCallback)((e=>m(ay.b.updateNetworkTable({networkType:p,tableType:My,updates:{limit:e}}))),[p,m]),T=Object(i.useCallback)((e=>m(ay.b.updateNetworkTable({networkType:p,tableType:My,updates:{activePage:e}}))),[m,p]),k=Object(i.useCallback)((e=>{if(null!=e.sort){const t={field:e.sort.field.split(".")[1],direction:e.sort.direction};Li()(t,y)||m(ay.b.updateNetworkTable({networkType:p,tableType:My,updates:{sort:t}}))}}),[y,p,m]),x=Object(i.useCallback)((()=>m(ay.b.updateNetworkTable({networkType:p,tableType:My,updates:{isPtrIncluded:!b}}))),[m,p,b]),S=Object(i.useMemo)((()=>[{field:`node.${Ii.l.dnsName}`,name:Ty,truncateText:!1,mobileOptions:{show:!0},sortable:!0,render:e=>{if(null!=e){const t=Object(Fo.h)(`networkDns-table--name-${e}`);return r.a.createElement(_o.b,{key:t,dataProvider:{and:[],enabled:!0,id:t,name:e,excluded:!1,kqlQuery:"",queryMatch:{field:"dns.question.registered_domain",value:e,operator:Lo.c}},isAggregatable:!0,fieldType:"keyword",render:(t,a,n)=>n.isDragging?r.a.createElement(_o.a,null,r.a.createElement(No.a,{dataProvider:t})):Object(vr.a)(e)})}return Object(vr.d)()}},{align:"right",field:`node.${Ii.l.queryCount}`,name:ky,sortable:!0,truncateText:!1,mobileOptions:{show:!0},render:e=>null!=e?pe()(e).format("0"):Object(vr.d)()},{align:"right",field:`node.${Ii.l.uniqueDomains}`,name:xy,sortable:!0,truncateText:!1,mobileOptions:{show:!0},render:e=>null!=e?pe()(e).format("0"):Object(vr.d)()},{align:"right",field:`node.${Ii.l.dnsBytesIn}`,name:Sy,sortable:!0,truncateText:!1,mobileOptions:{show:!0},render:e=>null!=e?r.a.createElement(hy.a,{value:e}):Object(vr.d)()},{align:"right",field:`node.${Ii.l.dnsBytesOut}`,name:Oy,sortable:!0,truncateText:!1,mobileOptions:{show:!0},render:e=>null!=e?r.a.createElement(hy.a,{value:e}):Object(vr.d)()}]),[]),O=Object(i.useMemo)((()=>({field:`node.${y.field}`,direction:y.direction})),[y.direction,y.field]),w=Object(i.useMemo)((()=>r.a.createElement(Iy,{isPtrIncluded:b,onChange:x})),[b,x]);return r.a.createElement(Ls.a,{activePage:f,columns:S,dataTestSubj:`table-${My}`,headerCount:d,headerSupplement:w,headerTitle:yy,headerTooltip:vy,headerUnit:Ey(d),id:a,itemsPerRow:Ay,isInspect:n,limit:h,loading:s,loadPage:o,onChange:k,pageOfItems:e,setQuerySkip:u,showMorePagesIndicator:c,sorting:O,totalCount:t,updateActivePage:T,updateLimitPagination:E})};Dy.displayName="NetworkDnsTableComponent";const qy=r.a.memo(Dy),Py=F.i18n.translate("xpack.securitySolution.networkDns.errorSearchDescription",{defaultMessage:"An error has occurred on network dns search"}),Ry=F.i18n.translate("xpack.securitySolution.networkDns.failSearchDescription",{defaultMessage:"Failed to run search on network dns"}),_y="networkDnsQuery";var Fy,Ly=a(472);const Ny="networkDnsHistogramQuery",By=Object(sr.a)(qy),zy=[{text:"dns.question.registered_domain",value:"dns.question.registered_domain"}],Uy={defaultStackByOption:null!==(Fy=zy.find((e=>"dns.question.registered_domain"===e.text)))&&void 0!==Fy?Fy:zy[0],errorMessage:Ly.b,histogramType:To.h.dns,stackByOptions:zy,subtitle:void 0,lensAttributes:{title:"Top domains by dns.question.registered_domain",description:"Security Solution Network DNS",visualizationType:"lnsXY",state:{visualization:{legend:{isVisible:!0,position:"right"},valueLabels:"hide",fittingFunction:"None",yLeftExtent:{mode:"full"},yRightExtent:{mode:"full"},axisTitlesVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},tickLabelsVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},labelsOrientation:{x:0,yLeft:0,yRight:0},gridlinesVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},preferredSeriesType:"bar",layers:[{layerId:"b1c3efc6-c886-4fba-978f-3b6bb5e7948a",accessors:["2a4d5e20-f570-48e4-b9ab-ff3068919377"],position:"top",seriesType:"bar",showGridlines:!1,layerType:"data",xAccessor:"d1452b87-0e9e-4fc0-a725-3727a18e0b37",splitAccessor:"e8842815-2a45-4c74-86de-c19a391e2424"}]},query:{query:"",language:"kuery"},filters:[{meta:{alias:null,negate:!0,disabled:!1,type:"phrase",key:"dns.question.type",params:{query:"PTR"},indexRefName:"filter-index-pattern-0"},query:{match_phrase:{"dns.question.type":"PTR"}},$state:{store:"appState"}}],datasourceStates:{indexpattern:{layers:{"b1c3efc6-c886-4fba-978f-3b6bb5e7948a":{columns:{"d1452b87-0e9e-4fc0-a725-3727a18e0b37":{label:"@timestamp",dataType:"date",operationType:"date_histogram",sourceField:"@timestamp",isBucketed:!0,scale:"interval",params:{interval:"auto"}},"2a4d5e20-f570-48e4-b9ab-ff3068919377":{label:"Unique count of dns.question.registered_domain",dataType:"number",operationType:"unique_count",scale:"ratio",sourceField:"dns.question.registered_domain",isBucketed:!1},"e8842815-2a45-4c74-86de-c19a391e2424":{label:"Top values of dns.question.name",dataType:"string",operationType:"terms",scale:"ordinal",sourceField:"dns.question.name",isBucketed:!0,params:{size:6,orderBy:{type:"column",columnId:"2a4d5e20-f570-48e4-b9ab-ff3068919377"},orderDirection:"desc",otherBucket:!0,missingBucket:!1}}},columnOrder:["e8842815-2a45-4c74-86de-c19a391e2424","d1452b87-0e9e-4fc0-a725-3727a18e0b37","2a4d5e20-f570-48e4-b9ab-ff3068919377"],incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-b1c3efc6-c886-4fba-978f-3b6bb5e7948a"},{name:"filter-index-pattern-0",type:"index-pattern",id:"{dataViewId}"}]}},Hy=({deleteQuery:e,docValueFields:t,endDate:a,filterQuery:n,indexNames:s,skip:o,startDate:l,setQuery:c,type:u})=>{const p=ay.e.dnsSelector(),m=Object(v.b)((e=>p(e).isPtrIncluded));Object(i.useEffect)((()=>()=>{e&&e({id:Ny})}),[e]);const{toggleStatus:g}=Object(Ea.a)(_y),[f,b]=Object(i.useState)(o||!g);Object(i.useEffect)((()=>{b(o||!g)}),[o,g]);const[h,{totalCount:y,networkDns:T,pageInfo:k,loadPage:x,id:S,inspect:O,isInspected:w,refetch:j}]=(({docValueFields:e,endDate:t,filterQuery:a,indexNames:n,skip:r,startDate:s,type:o})=>{const l=Object(i.useMemo)((()=>ay.e.dnsSelector()),[]),{activePage:c,sort:u,isPtrIncluded:p,limit:m}=Object(v.a)(l),{data:g}=Object(d.j)().services,f=Object(i.useRef)(E.noop),b=Object(i.useRef)(new AbortController),h=Object(i.useRef)(new Xi.Subscription),[y,T]=Object(i.useState)(!1),[k,x]=Object(i.useState)(null),S=Object(i.useCallback)((e=>{x((t=>t?{...t,pagination:Object(ko.a)(e,m)}:t))}),[m]),[O,w]=Object(i.useState)({networkDns:[],histogram:[],id:_y,inspect:{dsl:[],response:[]},isInspected:!1,loadPage:S,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1},refetch:f.current,totalCount:-1}),{addError:j,addWarning:C}=Object(X.a)(),I=Object(i.useCallback)((e=>{if(null==e||r)return;const t=async()=>{b.current=new AbortController,T(!0),h.current=g.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:b.current.signal}).subscribe({next:e=>{Object(K.isCompleteResponse)(e)?(T(!1),w((t=>{var a;return{...t,networkDns:e.edges,inspect:Object(ar.c)(e,t.inspect),pageInfo:e.pageInfo,refetch:f.current,totalCount:e.totalCount,histogram:null!==(a=e.histogram)&&void 0!==a?a:t.histogram}})),h.current.unsubscribe()):Object(K.isErrorResponse)(e)&&(T(!1),C(Py),h.current.unsubscribe())},error:e=>{T(!1),j(e,{title:Ry}),h.current.unsubscribe()}})};h.current.unsubscribe(),b.current.abort(),t(),f.current=t}),[g.search,j,C,r]);return Object(i.useEffect)((()=>{x((i=>{const r={...null!=i?i:{},defaultIndex:n,docValueFields:null!=e?e:[],isPtrIncluded:p,factoryQueryType:Ii.o.dns,filterQuery:Object(Zi.a)(a),pagination:Object(ko.a)(c,m,!0),sort:u,timerange:{interval:"12h",from:s,to:t}};return Li()(i,r)?i:r}))}),[c,n,t,a,m,s,u,p,e]),Object(i.useEffect)((()=>(I(k),()=>{h.current.unsubscribe(),b.current.abort()})),[k,I]),Object(i.useEffect)((()=>{r&&(T(!1),h.current.unsubscribe(),b.current.abort())}),[r]),[y,O]})({docValueFields:null!=t?t:[],endDate:a,filterQuery:n,indexNames:s,skip:f,startDate:l,type:u}),C=Object(i.useCallback)((e=>Ly.a(e.text)),[]),I=Object(i.useMemo)((()=>({...Uy,title:C})),[C]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Fs.a,rr()({id:Ny,isPtrIncluded:m,docValueFields:t,endDate:a,filterQuery:n,indexNames:s,setQuery:c,showLegend:!0,startDate:l},I)),r.a.createElement(By,{data:T,fakeTotalCount:Object(E.getOr)(50,"fakeTotalCount",k),id:S,inspect:O,isInspect:w,loading:h,loadPage:x,refetch:j,setQuery:c,setQuerySkip:b,showMorePagesIndicator:Object(E.getOr)(!1,"showMorePagesIndicator",k),totalCount:y,type:u}))};Hy.displayName="DnsQueryTabBodyComponent";const $y=r.a.memo(Hy);var Vy=a(768),Qy=a(339),Wy=a(852),Gy=a(829);const Ky=Object(sr.a)(Gy.a),Yy=({endDate:e,filterQuery:t,flowTarget:a,indexNames:n,ip:s="",setQuery:o,skip:l,startDate:c,type:u})=>{const{toggleStatus:d}=Object(Ea.a)(Wy.a),[p,m]=Object(i.useState)(l||!d);Object(i.useEffect)((()=>{m(l||!d)}),[l,d]);const[g,{id:f,inspect:b,isInspected:h,tls:y,totalCount:v,pageInfo:T,loadPage:k,refetch:x}]=Object(Wy.b)({endDate:e,filterQuery:t,flowTarget:a,indexNames:n,ip:s,skip:p,startDate:c,type:u});return r.a.createElement(Ky,{data:y,id:f,inspect:b,isInspect:h,fakeTotalCount:Object(E.getOr)(50,"fakeTotalCount",T),loading:g,loadPage:k,showMorePagesIndicator:Object(E.getOr)(!1,"showMorePagesIndicator",T),refetch:x,setQuery:o,setQuerySkip:m,totalCount:v,type:u})};Yy.displayName="TlsQueryTabBodyComponent";const Jy=r.a.memo(Yy),Xy=r.a.memo((e=>r.a.createElement(tc,rr()({entityType:"events",timelineId:c.i.networkPageExternalAlerts},e,{pageFilters:ac.a}))));Xy.displayName="NetworkAlertsQueryTabBody";const Zy=r.a.memo((({docValueFields:e,type:t,to:a,filterQuery:n,isInitializing:s,from:l,indexPattern:c,indexNames:u,setQuery:d,setAbsoluteRangeDatePicker:p})=>{const m=Object(i.useCallback)(((e,t)=>{const a=Object(Ri.a)(e,t);p({id:"global",from:a.from,to:a.to})}),[p]),g=Object(i.useCallback)((({x:e})=>{if(!e)return;const[t,a]=e;p({id:"global",from:new Date(t).toISOString(),to:new Date(a).toISOString()})}),[p]),f={startDate:l,endDate:a,indexNames:u,skip:s,type:t,narrowDateRange:m,setQuery:d,filterQuery:n},b={...f,indexPattern:c,updateDateRange:g},h={...f,anomaliesFilterQuery:{bool:{should:[{exists:{field:"source.ip"}},{exists:{field:"destination.ip"}}],minimum_should_match:1}},AnomaliesTableComponent:by.a};return r.a.createElement(P.Switch,null,r.a.createElement(R.Route,{path:`${o.Hb}/:tabName(${Qy.a.dns})`},r.a.createElement($y,rr()({},b,{docValueFields:e}))),r.a.createElement(R.Route,{path:`${o.Hb}/:tabName(${Qy.a.flows})`},r.a.createElement(r.a.Fragment,null,r.a.createElement(Vy.a,{direction:"column"},r.a.createElement(N.EuiFlexItem,null,r.a.createElement(oy,rr()({},b,{flowTarget:ny.b.source}))),r.a.createElement(N.EuiFlexItem,null,r.a.createElement(oy,rr()({},b,{flowTarget:ny.b.destination})))),r.a.createElement(N.EuiSpacer,null),r.a.createElement(Vy.a,{direction:"column"},r.a.createElement(N.EuiFlexItem,null,r.a.createElement(dy,rr()({},b,{flowTarget:ny.b.source}))),r.a.createElement(N.EuiFlexItem,null,r.a.createElement(dy,rr()({},b,{flowTarget:ny.b.destination})))))),r.a.createElement(R.Route,{path:`${o.Hb}/:tabName(${Qy.a.http})`},r.a.createElement(fy,b)),r.a.createElement(R.Route,{path:`${o.Hb}/:tabName(${Qy.a.tls})`},r.a.createElement(Jy,rr()({},b,{flowTarget:ny.b.source}))),r.a.createElement(R.Route,{path:`${o.Hb}/:tabName(${Qy.a.anomalies})`},r.a.createElement(vs.a,rr()({},h,{AnomaliesTableComponent:by.a}))),r.a.createElement(R.Route,{path:`${o.Hb}/:tabName(${Qy.a.alerts})`},r.a.createElement(Xy,b)))}));Zy.displayName="NetworkRoutes";const eE=z()(N.EuiFlexGroup).withConfig({displayName:"FlexGroup",componentId:"sc-1sbaj97-0"})(["min-height:200px;"]);eE.displayName="FlexGroup";const tE=()=>r.a.createElement(eE,{justifyContent:"center",alignItems:"center"},r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiLoadingSpinner,{size:"xl"})));tE.displayName="NetworkRoutesLoading";const aE=e=>`${o.Hb}/${e}`,nE=e=>{const t={[Qy.a.flows]:{id:Qy.a.flows,name:Ly.f,href:aE(Qy.a.flows),disabled:!1},[Qy.a.dns]:{id:Qy.a.dns,name:Ly.e,href:aE(Qy.a.dns),disabled:!1},[Qy.a.http]:{id:Qy.a.http,name:Ly.g,href:aE(Qy.a.http),disabled:!1},[Qy.a.tls]:{id:Qy.a.tls,name:Ly.h,href:aE(Qy.a.tls),disabled:!1},[Qy.a.anomalies]:{id:Qy.a.anomalies,name:Ly.d,href:aE(Qy.a.anomalies),disabled:!1},[Qy.a.alerts]:{id:Qy.a.alerts,name:Ly.c,href:aE(Qy.a.alerts),disabled:!1}};return e?t:Object(E.omit)([Qy.a.anomalies],t)},iE=z.a.div.withConfig({displayName:"StyledFullHeightContainer",componentId:"sc-5donvf-0"})(["display:flex;flex-direction:column;flex:1 1 auto;"]),rE=r.a.memo((({hasMlUserPermissions:e,capabilitiesFetched:t})=>{const a=Object(l.useDispatch)(),n=Object(i.useRef)(null),s=Object(i.useMemo)((()=>p.b.getTimelineByIdSelector()),[]),o=Object(v.b)((e=>{var t;return(null!==(t=s(e,c.i.networkPageExternalAlerts))&&void 0!==t?t:le.a).graphEventId})),u=Object(i.useMemo)((()=>ae.e.globalFiltersQuerySelector()),[]),g=Object(i.useMemo)((()=>ae.e.globalQuerySelector()),[]),f=Object(v.a)(g),h=Object(v.a)(u),{to:k,from:x,setQuery:S,isInitializing:O}=Object(H.a)(),{globalFullScreen:w}=Object(dt.a)(),j=Object(d.j)(),{tabName:C}=Object(P.useParams)(),I=j.services.application.capabilities.maps.show,M=Object(i.useMemo)((()=>C===Qy.a.alerts?h.length>0?[...h,...ac.a]:ac.a:h),[C,h]),A=Object(i.useCallback)((({x:e})=>{if(!e)return;const[t,n]=e;a(Object(G.setAbsoluteRangeDatePicker)({id:"global",from:new Date(t).toISOString(),to:new Date(n).toISOString()}))}),[a]),{docValueFields:D,indicesExist:q,indexPattern:R,selectedPatterns:_}=Object(m.d)(),F=Object(i.useCallback)((()=>{var e,t;null===(e=n.current)||void 0===e||null===(t=e.querySelector(".inspectButtonComponent:last-of-type"))||void 0===t||t.focus()}),[n]),L=Object(i.useCallback)((()=>{Object(oe.m)()}),[]),B=Object(i.useCallback)((e=>{Object(U.isTab)(e)&&Object(oe.l)({containerElement:n.current,keyboardEvent:e,onSkipFocusBeforeEventsTable:F,onSkipFocusAfterEventsTable:L})}),[n,F,L]),[z,V]=Object(hs.b)({config:Object(K.getEsQueryConfig)(j.services.uiSettings),indexPattern:R,queries:[f],filters:h}),[W]=Object(hs.b)({config:Object(K.getEsQueryConfig)(j.services.uiSettings),indexPattern:R,queries:[f],filters:M});return Object(ee.a)({id:"NetworkQueryId",filterQuery:z,kqlError:V,query:f,startDate:x,endDate:k}),r.a.createElement(r.a.Fragment,null,q?r.a.createElement(iE,{onKeyDown:B,ref:n},r.a.createElement(N.EuiWindowEvent,{event:"resize",handler:E.noop}),r.a.createElement($.a,{show:Object(oe.n)({globalFullScreen:w,graphEventId:o})},r.a.createElement(Q.a,{indexPattern:R,id:"global"})),r.a.createElement(b.a,{noPadding:w},r.a.createElement(pt,{show:!w},r.a.createElement(Ta.a,{subtitle:r.a.createElement(Mi.a,{docValueFields:D,indexKey:Ii.i.network,indexNames:_}),title:Ly.i,border:!0}),I&&r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiPanel,{hasBorder:!0,paddingSize:"none","data-test-subj":"conditional-embeddable-map"},r.a.createElement(bh,{query:f,filters:h,startDate:x,endDate:k,setQuery:S})),r.a.createElement(N.EuiSpacer,null)),r.a.createElement(ty,{filterQuery:z,from:x,indexNames:_,narrowDateRange:A,setQuery:S,skip:O||void 0===z,to:k})),t&&!O?r.a.createElement(r.a.Fragment,null,r.a.createElement(pt,{show:!w},r.a.createElement(N.EuiSpacer,null),r.a.createElement(Ki,{navTabs:nE(e)}),r.a.createElement(N.EuiSpacer,null)),r.a.createElement(Zy,{docValueFields:D,filterQuery:W,from:x,isInitializing:O,indexPattern:R,indexNames:_,setQuery:S,setAbsoluteRangeDatePicker:G.setAbsoluteRangeDatePicker,type:ay.c.NetworkType.page,to:k})):r.a.createElement(tE,null))):r.a.createElement(ka.a,null),r.a.createElement(y.a,{pageName:T.a.network}))}));rE.displayName="NetworkComponent";const sE=r.a.memo(rE),oE=r.a.memo((()=>{const{path:e}=Object(P.useRouteMatch)();return r.a.createElement(P.Switch,null,r.a.createElement(R.Route,{strict:!0,exact:!0,path:e,render:({location:e})=>{const t=Object(Dm.parse)(e.search.substring(1),{sort:!1});null!=t.query&&(t.query=Vm(t.query));const a=Object(Dm.stringify)(qm.url.encodeQuery(t),{sort:!1,encode:!1});return r.a.createElement(P.Redirect,{to:`${o.Hb}?${a}`})}}),r.a.createElement(R.Route,{path:`${e}/ip/:ip`,render:({location:e,match:{params:{ip:t}}})=>{const a=Object(Dm.parse)(e.search.substring(1),{sort:!1});if(null!=a.query&&(a.query=Vm(a.query)),Qm(t)){const e=Object(Dm.stringify)(qm.url.encodeQuery(a),{sort:!1,encode:!1});return r.a.createElement(P.Redirect,{to:`${o.Hb}?${e}`})}if(Wm(t)){const e=Gm(t);a.query=Nm(["source.ip","destination.ip"],e,a.query||"");const n=Object(Dm.stringify)(qm.url.encodeQuery(a),{sort:!1,encode:!1});return r.a.createElement(P.Redirect,{to:`${o.Hb}?${n}`})}{const e=Object(Dm.stringify)(qm.url.encodeQuery(a),{sort:!1,encode:!1});return r.a.createElement(P.Redirect,{to:`${o.Hb}/ip/${t}?${e}`})}}}),r.a.createElement(R.Route,{path:`${o.Hb}/ml-network/`,render:({location:{search:e=""}})=>r.a.createElement(P.Redirect,{from:`${o.Hb}/ml-network/`,to:{pathname:`${o.Hb}/ml-network`,search:e}})}))}));oE.displayName="MlNetworkConditionalContainer";const lE=`${o.Hb}/ip/:detailName`,cE=()=>{const e=Object(Pi.a)(),t=e.capabilitiesFetched,a=Object(i.useMemo)((()=>Object(qi.a)(e)),[e]),n=Object(i.useMemo)((()=>((e,t)=>e&&!t?`${o.Hb}/:tabName(${Qy.a.flows}|${Qy.a.dns}|${Qy.a.http}|${Qy.a.tls}|${Qy.a.alerts})`:`${o.Hb}/:tabName(${Qy.a.flows}|${Qy.a.dns}|${Qy.a.anomalies}|${Qy.a.http}|${Qy.a.tls}|${Qy.a.alerts})`)(t,a)),[t,a]);return r.a.createElement(P.Switch,null,r.a.createElement(R.Route,{exact:!0,strict:!0,path:o.Hb,render:({location:{search:e=""}})=>r.a.createElement(P.Redirect,{to:{pathname:`${o.Hb}/${Qy.a.flows}`,search:e}})}),r.a.createElement(R.Route,{path:`${o.Hb}/ml-network`},r.a.createElement(oE,null)),r.a.createElement(R.Route,{strict:!0,path:n},r.a.createElement(sE,{capabilitiesFetched:e.capabilitiesFetched,hasMlUserPermissions:a})),r.a.createElement(R.Route,{path:`${lE}/:flowTarget`},r.a.createElement(tb.a,null)),r.a.createElement(R.Route,{path:lE,render:({location:{search:e=""},match:{params:{detailName:t}}})=>r.a.createElement(P.Redirect,{to:{pathname:`${o.Hb}/ip/${t}/${Ii.d.source}`,search:e}})}))},uE=r.a.memo(cE),dE=[{path:o.Hb,render:()=>r.a.createElement(s.TrackApplicationView,{viewId:T.a.network},r.a.createElement(uE,null))}],pE=Object(i.memo)((()=>r.a.createElement(r.a.Fragment,null,r.a.createElement(ka.a,null),r.a.createElement(y.a,{pageName:o.cc.landing}))));pE.displayName="LandingPage";var mE=a(352),gE=a(336);const fE="alertsByCategoryOverview",bE=z()(N.EuiButton).withConfig({displayName:"StyledLinkButton",componentId:"sc-1vx58sq-0"})(["margin-left:0;@media only screen and (min-width:","){margin-left:",";}"],(e=>e.theme.eui.euiBreakpoints.m),(({theme:e})=>e.eui.paddingSizes.l)),hE=({deleteQuery:e,filters:t,from:a,hideHeaderChildren:n=!1,indexPattern:s,indexNames:l,query:c,setQuery:p,to:m})=>{const{uiSettings:g,application:{navigateToApp:f}}=Object(d.j)().services,{formatUrl:b,search:h}=Object(u.k)(T.a.hosts),[y]=Object(d.p)(o.V),E=Object(i.useCallback)((e=>{e.preventDefault(),f(o.y,{deepLinkId:T.a.hosts,path:Object(gE.c)(Es.HostsTableType.alerts,h)})}),[f,h]),v=Object(i.useMemo)((()=>r.a.createElement(bE,{"data-test-subj":"view-alerts",onClick:E,href:b(Object(gE.c)(Es.HostsTableType.alerts))},mE.i)),[E,b]),k=Object(i.useMemo)((()=>{var e;return{...Xl,defaultStackByOption:null!==(e=Jl.find((e=>"event.module"===e.text)))&&void 0!==e?e:Jl[0],subtitle:e=>`${Hl}: ${pe()(e).format(y)} ${$l(e)}`,legendPosition:or.Position.Right}}),[]),[x,S]=Object(i.useMemo)((()=>Object(hs.b)({config:Object(K.getEsQueryConfig)(g),indexPattern:s,queries:[c],filters:t})),[t,s,g,c]);return Object(ee.a)({id:fE,filterQuery:x,kqlError:S,query:c,startDate:a,endDate:m}),Object(i.useEffect)((()=>()=>{e&&e({id:fE})}),[e]),r.a.createElement(Fs.a,rr()({endDate:m,filterQuery:x,headerChildren:n?null:v,id:fE,indexNames:l,setQuery:p,startDate:a},k))};hE.displayName="AlertsByCategoryComponent";const yE=r.a.memo(hE);var EE=a(288),vE=a(698);const TE=F.i18n.translate("xpack.securitySolution.allHost.errorSearchDescription",{defaultMessage:"An error has occurred on all hosts search"}),kE=F.i18n.translate("xpack.securitySolution.allHost.failSearchDescription",{defaultMessage:"Failed to run search on all hosts"}),xE="overviewHostQuery",SE=z.a.div.withConfig({displayName:"ProgressContainer",componentId:"sc-1qvjg2g-0"})(["margin-left:8px;min-width:100px;@media only screen and (min-width:1400px){min-width:200px;}"]),OE=z()(N.EuiLoadingContent).withConfig({displayName:"LoadingContent",componentId:"sc-1qvjg2g-1"})([".euiLoadingContent__singleLine{margin-bottom:0px;}"]),wE=({count:e,isGroupStat:t,isLoading:a,max:n})=>{const[s]=Object(d.p)(o.V),[l,c]=Object(i.useState)(!0);return Object(i.useEffect)((()=>{l&&!a&&c(!1)}),[a,l,c]),r.a.createElement(N.EuiFlexGroup,{alignItems:"center",gutterSize:"none",responsive:!1,justifyContent:"spaceBetween"},r.a.createElement(N.EuiFlexItem,{grow:!1},!l&&r.a.createElement(N.EuiText,{color:t?"default":"subdued",size:t?"m":"s"},pe()(e).format(s))),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(SE,null,a?r.a.createElement(OE,{"data-test-subj":"stat-value-loading-spinner",lines:1}):r.a.createElement(N.EuiProgress,{color:t?"primary":"subdued",max:n,size:"m",value:e}))))};wE.displayName="StatValueComponent";const jE=r.a.memo(wE),CE=e=>{var t,a,n,i,s,o,l,c,u,d,p,m,g,f,b,h;return[{count:null!==(t=e.auditbeatAuditd)&&void 0!==t?t:0,title:r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.overview.auditBeatAuditTitle",defaultMessage:"Audit"}),id:"auditbeatAuditd"},{count:null!==(a=e.auditbeatFIM)&&void 0!==a?a:0,title:r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.overview.auditBeatFimTitle",defaultMessage:"File Integrity Module"}),id:"auditbeatFIM"},{count:null!==(n=e.auditbeatLogin)&&void 0!==n?n:0,title:r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.overview.auditBeatLoginTitle",defaultMessage:"Login"}),id:"auditbeatLogin"},{count:null!==(i=e.auditbeatPackage)&&void 0!==i?i:0,title:r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.overview.auditBeatPackageTitle",defaultMessage:"Package"}),id:"auditbeatPackage"},{count:null!==(s=e.auditbeatProcess)&&void 0!==s?s:0,title:r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.overview.auditBeatProcessTitle",defaultMessage:"Process"}),id:"auditbeatProcess"},{count:null!==(o=e.auditbeatUser)&&void 0!==o?o:0,title:r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.overview.auditBeatUserTitle",defaultMessage:"User"}),id:"auditbeatUser"},{count:null!==(l=e.endgameDns)&&void 0!==l?l:0,title:r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.overview.endgameDnsTitle",defaultMessage:"DNS"}),id:"endgameDns"},{count:null!==(c=e.endgameFile)&&void 0!==c?c:0,title:r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.overview.endgameFileTitle",defaultMessage:"File"}),id:"endgameFile"},{count:null!==(u=e.endgameImageLoad)&&void 0!==u?u:0,title:r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.overview.endgameImageLoadTitle",defaultMessage:"Image Load"}),id:"endgameImageLoad"},{count:null!==(d=e.endgameNetwork)&&void 0!==d?d:0,title:r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.overview.endgameNetworkTitle",defaultMessage:"Network"}),id:"endgameNetwork"},{count:null!==(p=e.endgameProcess)&&void 0!==p?p:0,title:r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.overview.endgameProcessTitle",defaultMessage:"Process"}),id:"endgameProcess"},{count:null!==(m=e.endgameRegistry)&&void 0!==m?m:0,title:r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.overview.endgameRegistryTitle",defaultMessage:"Registry"}),id:"endgameRegistry"},{count:null!==(g=e.endgameSecurity)&&void 0!==g?g:0,title:r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.overview.endgameSecurityTitle",defaultMessage:"Security"}),id:"endgameSecurity"},{count:null!==(f=e.filebeatSystemModule)&&void 0!==f?f:0,title:r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.overview.filebeatSystemModuleTitle",defaultMessage:"System Module"}),id:"filebeatSystemModule"},{count:null!==(b=e.winlogbeatSecurity)&&void 0!==b?b:0,title:r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.overview.winlogbeatSecurityTitle",defaultMessage:"Security"}),id:"winlogbeatSecurity"},{count:null!==(h=e.winlogbeatMWSysmonOperational)&&void 0!==h?h:0,title:r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.overview.winlogbeatMWSysmonOperational",defaultMessage:"Microsoft-Windows-Sysmon/Operational"}),id:"winlogbeatMWSysmonOperational"}]},IE=z.a.div.withConfig({displayName:"HostStatsContainer",componentId:"sc-ej4zfy-0"})([".accordion-button{width:100%;}"]),ME=[{groupId:"auditbeat",name:r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.overview.hostStatGroupAuditbeat",defaultMessage:"Auditbeat"}),statIds:["auditbeatAuditd","auditbeatFIM","auditbeatLogin","auditbeatPackage","auditbeatProcess","auditbeatUser"]},{groupId:"endgame",name:r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.overview.hostStatGroupElasticEndpointSecurity",defaultMessage:"Endpoint Security"}),statIds:["endgameDns","endgameFile","endgameImageLoad","endgameNetwork","endgameProcess","endgameRegistry","endgameSecurity"]},{groupId:"filebeat",name:r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.overview.hostStatGroupFilebeat",defaultMessage:"Filebeat"}),statIds:["filebeatSystemModule"]},{groupId:"winlogbeat",name:r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.overview.hostStatGroupWinlogbeat",defaultMessage:"Winlogbeat"}),statIds:["winlogbeatSecurity","winlogbeatMWSysmonOperational"]}],AE=z.a.div.withConfig({displayName:"MoveItLeftTitle",componentId:"sc-ej4zfy-1"})(["margin-left:24px;@media only screen and (min-width:","){max-width:40px;}"],(({theme:e})=>e.eui.euiBreakpoints.m)),DE=z.a.div.withConfig({displayName:"MoveItLeft",componentId:"sc-ej4zfy-2"})(["margin-left:24px;"]),qE=z()(N.EuiFlexItem).withConfig({displayName:"NoMarginTopFlexItem",componentId:"sc-ej4zfy-3"})(["@media only screen and (max-width:","){margin-top:-10px !important;}"],(({theme:e})=>e.eui.euiBreakpoints.m)),PE=z.a.div.withConfig({displayName:"AccordionContent",componentId:"sc-ej4zfy-4"})(["margin-top:8px;"]),RE=({data:e,loading:t})=>{const a=CE(e),n=a.reduce(((e,t)=>e+t.count),0);return r.a.createElement(IE,{"data-test-subj":"overview-hosts-stats"},ME.map(((e,i)=>{const s=a.filter((t=>e.statIds.includes(t.id))),o=s.reduce(((e,t)=>e+t.count),0);return r.a.createElement(r.a.Fragment,{key:e.groupId},r.a.createElement(N.EuiHorizontalRule,{margin:"xs"}),r.a.createElement(N.EuiAccordion,{id:`host-stat-accordion-group${e.groupId}`,buttonContent:r.a.createElement(N.EuiFlexGroup,{gutterSize:"s",justifyContent:"spaceBetween"},r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiText,null,e.name)),r.a.createElement(qE,{grow:!1},r.a.createElement(jE,{count:o,isGroupStat:!0,isLoading:t,max:n}))),buttonContentClassName:"accordion-button"},r.a.createElement(PE,null,s.map((e=>r.a.createElement(N.EuiFlexGroup,{key:e.id,gutterSize:"s",justifyContent:"spaceBetween"},r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiText,{color:"subdued",size:"s"},r.a.createElement(AE,null,e.title))),r.a.createElement(qE,{"data-test-subj":`host-stat-${e.id}`,grow:!1},r.a.createElement(DE,null,r.a.createElement(jE,{count:e.count,isGroupStat:!1,isLoading:t,max:o})))))))))})))},_E=r.a.memo(RE),FE=Object(sr.a)(_E),LE=({endDate:e,filterQuery:t,indexNames:a,startDate:n,setQuery:s})=>{const{formatUrl:l,search:c}=Object(u.k)(T.a.hosts),{navigateToApp:p}=Object(d.j)().services.application,[m]=Object(d.p)(o.V),{toggleStatus:g,setToggleStatus:f}=Object(Ea.a)(xE),[b,h]=Object(i.useState)(void 0===t||!g);Object(i.useEffect)((()=>{h(void 0===t||!g)}),[t,g]);const y=Object(i.useCallback)((e=>{f(e),h(!e)}),[h,f]),[v,{overviewHost:k,id:x,inspect:S,refetch:O}]=(({filterQuery:e,endDate:t,indexNames:a,skip:n=!1,startDate:r})=>{const{data:s}=Object(d.j)().services,o=Object(i.useRef)(E.noop),l=Object(i.useRef)(new AbortController),c=Object(i.useRef)(new Xi.Subscription),[u,p]=Object(i.useState)(!1),[m,g]=Object(i.useState)(null),[f,b]=Object(i.useState)({overviewHost:{},id:xE,inspect:{dsl:[],response:[]},isInspected:!1,refetch:o.current}),{addError:h,addWarning:y}=Object(X.a)(),v=Object(i.useCallback)((e=>{if(null==e||n)return;const t=async()=>{l.current=new AbortController,p(!0),c.current=s.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:l.current.signal}).subscribe({next:e=>{Object(K.isCompleteResponse)(e)?(p(!1),b((t=>({...t,overviewHost:e.overviewHost,inspect:Object(ar.c)(e,t.inspect),refetch:o.current}))),c.current.unsubscribe()):Object(K.isErrorResponse)(e)&&(p(!1),y(TE),c.current.unsubscribe())},error:e=>{p(!1),h(e,{title:kE}),c.current.unsubscribe()}})};c.current.unsubscribe(),l.current.abort(),t(),o.current=t}),[s.search,h,y,n]);return Object(i.useEffect)((()=>{g((n=>{const i={...null!=n?n:{},defaultIndex:a,factoryQueryType:To.f.overview,filterQuery:Object(Zi.a)(e),timerange:{interval:"12h",from:r,to:t}};return Li()(n,i)?n:i}))}),[a,t,e,r]),Object(i.useEffect)((()=>(v(m),()=>{c.current.unsubscribe(),l.current.abort()})),[m,v]),Object(i.useEffect)((()=>{n&&(c.current.unsubscribe(),l.current.abort())}),[n]),[u,f]})({endDate:e,filterQuery:t,indexNames:a,startDate:n,skip:b}),w=Object(i.useCallback)((e=>{e.preventDefault(),p(o.y,{deepLinkId:T.a.hosts,path:Object(u.d)("allHosts",c)})}),[p,c]),j=Object(i.useMemo)((()=>CE(k).reduce(((e,t)=>e+t.count),0)),[k]),C=Object(i.useMemo)((()=>pe()(j).format(m)),[m,j]),I=Object(i.useMemo)((()=>r.a.createElement(ut.g,{onClick:w,href:l("/allHosts")},r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.overview.hostsAction",defaultMessage:"View hosts"}))),[w,l]),M=Object(i.useMemo)((()=>r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.overview.hostsTitle",defaultMessage:"Host events"})),[]),A=Object(i.useMemo)((()=>Object(E.isEmpty)(k)?r.a.createElement(r.a.Fragment,null,""):r.a.createElement(It.FormattedMessage,{defaultMessage:"Showing: {formattedHostEventsCount} {hostEventsCount, plural, one {event} other {events}}",id:"xpack.securitySolution.overview.overviewHost.hostsSubtitle",values:{hostEventsCount:j,formattedHostEventsCount:C}})),[C,j,k]);return r.a.createElement(ca.c,{show:g},r.a.createElement(N.EuiPanel,{hasBorder:!0},r.a.createElement(la.a,{id:xE,subtitle:A,toggleStatus:g,toggleQuery:y,title:M,isInspectDisabled:void 0===t},r.a.createElement(r.a.Fragment,null,I)),g&&r.a.createElement(FE,{loading:v,data:k,setQuery:s,id:x,inspect:S,refetch:O})))};LE.displayName="OverviewHostComponent";const NE=r.a.memo(LE),BE=F.i18n.translate("xpack.securitySolution.allHost.errorSearchDescription",{defaultMessage:"An error has occurred on all hosts search"}),zE=F.i18n.translate("xpack.securitySolution.allHost.failSearchDescription",{defaultMessage:"Failed to run search on all hosts"}),UE="overviewNetworkQuery",HE=e=>{var t,a,n,i,s,o,l,c,u;return[{count:null!==(t=e.auditbeatSocket)&&void 0!==t?t:0,title:r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.overview.auditBeatSocketTitle",defaultMessage:"Socket"}),id:"auditbeatSocket"},{count:null!==(a=e.filebeatCisco)&&void 0!==a?a:0,title:r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.overview.filebeatCiscoTitle",defaultMessage:"Cisco"}),id:"filebeatCisco"},{count:null!==(n=e.filebeatNetflow)&&void 0!==n?n:0,title:r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.overview.filebeatNetflowTitle",defaultMessage:"Netflow"}),id:"filebeatNetflow"},{count:null!==(i=e.filebeatPanw)&&void 0!==i?i:0,title:r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.overview.filebeatPanwTitle",defaultMessage:"Palo Alto Networks"}),id:"filebeatPanw"},{count:null!==(s=e.filebeatSuricata)&&void 0!==s?s:0,title:r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.overview.fileBeatSuricataTitle",defaultMessage:"Suricata"}),id:"filebeatSuricata"},{count:null!==(o=e.filebeatZeek)&&void 0!==o?o:0,title:r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.overview.fileBeatZeekTitle",defaultMessage:"Zeek"}),id:"filebeatZeek"},{count:null!==(l=e.packetbeatDNS)&&void 0!==l?l:0,title:r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.overview.packetBeatDnsTitle",defaultMessage:"DNS"}),id:"packetbeatDNS"},{count:null!==(c=e.packetbeatFlow)&&void 0!==c?c:0,title:r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.overview.packetBeatFlowTitle",defaultMessage:"Flow"}),id:"packetbeatFlow"},{count:null!==(u=e.packetbeatTLS)&&void 0!==u?u:0,title:r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.overview.packetbeatTLSTitle",defaultMessage:"TLS"}),id:"packetbeatTLS"}]},$E=[{groupId:"auditbeat",name:r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.overview.networkStatGroupAuditbeat",defaultMessage:"Auditbeat"}),statIds:["auditbeatSocket"]},{groupId:"filebeat",name:r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.overview.networkStatGroupFilebeat",defaultMessage:"Filebeat"}),statIds:["filebeatCisco","filebeatNetflow","filebeatPanw","filebeatSuricata","filebeatZeek"]},{groupId:"packetbeat",name:r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.overview.networkStatGroupPacketbeat",defaultMessage:"Packetbeat"}),statIds:["packetbeatDNS","packetbeatFlow","packetbeatTLS"]}],VE=z.a.div.withConfig({displayName:"NetworkStatsContainer",componentId:"sc-1wm45zw-0"})([".accordion-button{width:100%;}"]),QE=z.a.div.withConfig({displayName:"MoveItLeftTitle",componentId:"sc-1wm45zw-1"})(["margin-left:24px;@media only screen and (min-width:","){max-width:40px;}"],(({theme:e})=>e.eui.euiBreakpoints.m)),WE=z.a.div.withConfig({displayName:"MoveItLeft",componentId:"sc-1wm45zw-2"})(["margin-left:24px;"]),GE=z()(N.EuiFlexItem).withConfig({displayName:"NoMarginTopFlexItem",componentId:"sc-1wm45zw-3"})(["@media only screen and (max-width:","){margin-top:-10px !important;}"],(({theme:e})=>e.eui.euiBreakpoints.m)),KE=z.a.div.withConfig({displayName:"AccordionContent",componentId:"sc-1wm45zw-4"})(["margin-top:8px;"]),YE=({data:e,loading:t})=>{const a=HE(e),n=a.reduce(((e,t)=>e+t.count),0);return r.a.createElement(VE,{"data-test-subj":"overview-network-stats"},$E.map(((e,i)=>{const s=a.filter((t=>e.statIds.includes(t.id))),o=s.reduce(((e,t)=>e+t.count),0);return r.a.createElement(r.a.Fragment,{key:e.groupId},r.a.createElement(N.EuiHorizontalRule,{margin:"xs"}),r.a.createElement(N.EuiAccordion,{id:`network-stat-accordion-group${e.groupId}`,buttonContent:r.a.createElement(N.EuiFlexGroup,{"data-test-subj":`network-stat-group-${e.groupId}`,justifyContent:"spaceBetween",gutterSize:"s"},r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiText,null,e.name)),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(jE,{count:o,isGroupStat:!0,isLoading:t,max:n}))),buttonContentClassName:"accordion-button"},r.a.createElement(KE,null,s.map((e=>r.a.createElement(N.EuiFlexGroup,{key:e.id,gutterSize:"s",justifyContent:"spaceBetween"},r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiText,{color:"subdued",size:"s"},r.a.createElement(QE,null,e.title))),r.a.createElement(GE,{"data-test-subj":`network-stat-${e.id}`,grow:!1},r.a.createElement(WE,null,r.a.createElement(jE,{count:e.count,isGroupStat:!1,isLoading:t,max:o})))))))))})))},JE=r.a.memo(YE),XE=Object(sr.a)(JE),ZE=({endDate:e,filterQuery:t,indexNames:a,startDate:n,setQuery:s})=>{const{formatUrl:l,search:c}=Object(u.k)(T.a.network),{navigateToApp:p}=Object(d.j)().services.application,[m]=Object(d.p)(o.V),{toggleStatus:g,setToggleStatus:f}=Object(Ea.a)(UE),[b,h]=Object(i.useState)(void 0===t||!g);Object(i.useEffect)((()=>{h(void 0===t||!g)}),[t,g]);const y=Object(i.useCallback)((e=>{f(e),h(!e)}),[h,f]),[v,{overviewNetwork:k,id:x,inspect:S,refetch:O}]=(({filterQuery:e,endDate:t,indexNames:a,skip:n=!1,startDate:r})=>{const{data:s}=Object(d.j)().services,o=Object(i.useRef)(E.noop),l=Object(i.useRef)(new AbortController),c=Object(i.useRef)(new Xi.Subscription),[u,p]=Object(i.useState)(!1),[m,g]=Object(i.useState)(null),[f,b]=Object(i.useState)({overviewNetwork:{},id:UE,inspect:{dsl:[],response:[]},isInspected:!1,refetch:o.current}),{addError:h,addWarning:y}=Object(X.a)(),v=Object(i.useCallback)((e=>{if(null==e||n)return;const t=async()=>{l.current=new AbortController,p(!0),c.current=s.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:l.current.signal}).subscribe({next:e=>{Object(K.isCompleteResponse)(e)?(p(!1),b((t=>({...t,overviewNetwork:e.overviewNetwork,inspect:Object(ar.c)(e,t.inspect),refetch:o.current}))),c.current.unsubscribe()):Object(K.isErrorResponse)(e)&&(p(!1),y(BE),c.current.unsubscribe())},error:e=>{p(!1),h(e,{title:zE}),c.current.unsubscribe()}})};c.current.unsubscribe(),l.current.abort(),t(),o.current=t}),[s.search,h,y,n]);return Object(i.useEffect)((()=>{g((n=>{const i={...null!=n?n:{},defaultIndex:a,factoryQueryType:To.n.overview,filterQuery:Object(Zi.a)(e),timerange:{interval:"12h",from:r,to:t}};return Li()(n,i)?n:i}))}),[a,t,e,r]),Object(i.useEffect)((()=>(v(m),()=>{c.current.unsubscribe(),l.current.abort()})),[m,v]),Object(i.useEffect)((()=>{n&&(c.current.unsubscribe(),l.current.abort())}),[n]),[u,f]})({endDate:e,filterQuery:t,indexNames:a,startDate:n,skip:b}),w=Object(i.useCallback)((e=>{e.preventDefault(),p(o.y,{deepLinkId:T.a.network,path:Object(u.f)(c)})}),[p,c]),j=Object(i.useMemo)((()=>HE(k).reduce(((e,t)=>e+t.count),0)),[k]),C=Object(i.useMemo)((()=>pe()(j).format(m)),[m,j]),I=Object(i.useMemo)((()=>r.a.createElement(ut.g,{"data-test-subj":"overview-network-go-to-network-page",onClick:w,href:l(Object(u.f)())},r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.overview.networkAction",defaultMessage:"View network"}))),[w,l]),M=Object(i.useMemo)((()=>r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.overview.networkTitle",defaultMessage:"Network events"})),[]),A=Object(i.useMemo)((()=>Object(E.isEmpty)(k)?r.a.createElement(r.a.Fragment,null,""):r.a.createElement(It.FormattedMessage,{defaultMessage:"Showing: {formattedNetworkEventsCount} {networkEventsCount, plural, one {event} other {events}}",id:"xpack.securitySolution.overview.overviewNetwork.networkSubtitle",values:{formattedNetworkEventsCount:C,networkEventsCount:j}})),[C,j,k]);return r.a.createElement(ca.c,{show:g},r.a.createElement(N.EuiPanel,{hasBorder:!0,"data-test-subj":"overview-network-query"},r.a.createElement(r.a.Fragment,null,r.a.createElement(la.a,{id:UE,subtitle:A,title:M,toggleStatus:g,toggleQuery:y,isInspectDisabled:void 0===t},I),g&&r.a.createElement(XE,{loading:v,data:k,id:x,inspect:S,setQuery:s,refetch:O}))))};ZE.displayName="OverviewNetworkComponent";const ev=r.a.memo(ZE),tv=({filters:e,from:t,indexNames:a,indexPattern:n,query:s,setQuery:o,to:l})=>{const{uiSettings:c}=Object(d.j)().services,[u,p]=Object(i.useMemo)((()=>Object(hs.b)({config:Object(K.getEsQueryConfig)(c),indexPattern:n,queries:[s],filters:[...e,...ac.d]})),[e,n,s,c]),[m]=Object(i.useMemo)((()=>Object(hs.b)({config:Object(K.getEsQueryConfig)(c),indexPattern:n,queries:[s],filters:[...e,...ac.a]})),[e,n,c,s]);return Object(ee.a)({id:xE,filterQuery:u||m,kqlError:p,query:s,startDate:t,endDate:l}),r.a.createElement(N.EuiFlexGroup,{direction:"row"},r.a.createElement(N.EuiFlexItem,{grow:1},r.a.createElement(NE,{endDate:l,filterQuery:u,indexNames:a,startDate:t,setQuery:o})),r.a.createElement(N.EuiFlexItem,{grow:1},r.a.createElement(ev,{endDate:l,filterQuery:m,indexNames:a,startDate:t,setQuery:o})))},av=r.a.memo(tv),nv=(F.i18n.translate("xpack.securitySolution.recentTimelines.errorRetrievingUserDetailsMessage",{defaultMessage:"Recent Timelines: An error occurred while retrieving user details"}),F.i18n.translate("xpack.securitySolution.recentTimelines.favoritesButtonLabel",{defaultMessage:"Favorites"})),iv=F.i18n.translate("xpack.securitySolution.recentTimelines.noFavoriteTimelinesMessage",{defaultMessage:"You haven't favorited any timelines yet. Get out there and start threat hunting!"}),rv=F.i18n.translate("xpack.securitySolution.recentTimelines.lastUpdatedButtonLabel",{defaultMessage:"Last updated"}),sv=F.i18n.translate("xpack.securitySolution.recentTimelines.noTimelinesMessage",{defaultMessage:"You haven't created any timelines yet. Get out there and start threat hunting!"}),ov=F.i18n.translate("xpack.securitySolution.recentTimelines.notesTooltip",{defaultMessage:"Notes"}),lv=F.i18n.translate("xpack.securitySolution.recentTimelines.openAsDuplicateTooltip",{defaultMessage:"Open as a timeline duplicate"}),cv=F.i18n.translate("xpack.securitySolution.recentTimelines.openAsDuplicateTemplateTooltip",{defaultMessage:"Open as a template duplicate"}),uv=F.i18n.translate("xpack.securitySolution.recentTimelines.pinnedEventsTooltip",{defaultMessage:"Pinned events"}),dv=F.i18n.translate("xpack.securitySolution.recentTimelines.untitledTimelineLabel",{defaultMessage:"Untitled timeline"}),pv=F.i18n.translate("xpack.securitySolution.recentTimelines.viewAllTimelinesLink",{defaultMessage:"View all timelines"}),mv=F.i18n.translate("xpack.securitySolution.recentTimelines.filterControlLegend",{defaultMessage:"Timelines filter"}),gv=[{id:"favorites",label:nv,iconType:"starFilled"},{id:"recently-updated",label:rv,iconType:"documentEdit"}],fv=r.a.memo((({filterBy:e,setFilterBy:t})=>r.a.createElement(N.EuiButtonGroup,{options:gv,idSelected:e,onChange:e=>{t(e)},isIconOnly:!0,legend:mv})));fv.displayName="Filters";var bv=a(105),hv=a(257);const yv=r.a.memo((({onOpenTimeline:e,timeline:t,timeline:{title:a,savedObjectId:n}})=>{const s=Object(i.useCallback)((()=>e({duplicate:!1,timelineId:`${n}`})),[e,n]);return r.a.createElement(N.EuiText,{size:"s"},r.a.createElement(N.EuiLink,{onClick:s},Object(hv.f)(t)?dv:a))}));yv.displayName="RecentTimelineHeader";var Ev=a(528);const vv=z()(N.EuiIcon).withConfig({displayName:"Icon",componentId:"sc-1ht70gq-0"})(["margin-right:8px;"]),Tv=z()(N.EuiFlexGroup).withConfig({displayName:"FlexGroup",componentId:"sc-1ht70gq-1"})(["margin-right:16px;"]),kv=r.a.memo((({count:e,icon:t,tooltip:a})=>r.a.createElement(N.EuiToolTip,{content:a},r.a.createElement(Tv,{alignItems:"center",gutterSize:"none"},r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(vv,{color:"subdued",size:"s",type:t})),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiText,{color:"subdued",size:"xs"},e))))));kv.displayName="IconWithCount";const xv=r.a.memo((({timeline:e})=>r.a.createElement("div",null,r.a.createElement(kv,{count:Object(hv.e)(e),icon:"pinFilled",tooltip:uv}),r.a.createElement(kv,{count:Object(hv.d)(e),icon:"editorComment",tooltip:ov}))));xv.displayName="RecentTimelineCounts";const Sv=z.a.div.withConfig({displayName:"ClampText",componentId:"sc-1pmjzib-0"})(["display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden;word-break:break-word;"]),Ov=r.a.memo((({timeline:e,onOpenTimeline:t,isLastItem:a})=>{const n=Object(i.useCallback)((()=>t({duplicate:!0,timelineId:`${e.savedObjectId}`})),[t,e.savedObjectId]),s=Object(i.useCallback)((a=>r.a.createElement(N.EuiFlexGroup,{gutterSize:"none",justifyContent:"spaceBetween","data-test-subj":"overview-recent-timelines"},r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(yv,{onOpenTimeline:t,timeline:e}),r.a.createElement(xv,{timeline:e}),e.description&&e.description.length&&r.a.createElement(N.EuiText,{color:"subdued",size:"xs"},r.a.createElement(Sv,null,e.description))),a&&r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiToolTip,{content:e.timelineType===c.m.default?lv:cv},r.a.createElement(N.EuiButtonIcon,{"aria-label":e.timelineType===c.m.default?lv:cv,"data-test-subj":"open-duplicate",isDisabled:null==e.savedObjectId,iconSize:"s",iconType:"copy",onClick:n,size:"s"}))))),[n,t,e]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ev.a,{render:s}),r.a.createElement(r.a.Fragment,null,!a&&r.a.createElement(N.EuiSpacer,{size:"l"})))}));Ov.displayName="RecentTimelinesItem";const wv=r.a.memo((({noTimelinesMessage:e,onOpenTimeline:t,timelines:a})=>{const n=Object(i.useMemo)((()=>a.map(((e,n)=>r.a.createElement(Ov,{key:`${e.savedObjectId}-${e.title}`,timeline:e,onOpenTimeline:t,isLastItem:n===a.length-1})))),[t,a]);return 0===a.length?r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiText,{color:"subdued",size:"s"},e)):r.a.createElement(r.a.Fragment,null,n)}));wv.displayName="RecentTimelines";const jv=({lines:e,placeholders:t})=>r.a.createElement(r.a.Fragment,null,[...Array(t).keys()].map(((a,n)=>r.a.createElement(r.a.Fragment,{key:n},r.a.createElement(N.EuiLoadingContent,{lines:e}),n!==t-1&&r.a.createElement(N.EuiSpacer,{size:"l"})))));jv.displayName="LoadingPlaceholdersComponent";const Cv=r.a.memo(jv);var Iv=a(712);const Mv=({filterBy:e})=>{const t=Object(l.useDispatch)(),a=Object(i.useCallback)((e=>t(Object(k.updateIsLoading)(e))),[t]),n=Object(i.useMemo)((()=>Object(hv.b)(t)),[t]),{formatUrl:s}=Object(u.k)(T.a.timelines),{navigateToApp:p}=Object(d.j)().services.application,m=Object(i.useCallback)((({duplicate:e,timelineId:t})=>{Object(hv.h)({duplicate:e,timelineId:t,updateIsLoading:a,updateTimeline:n})}),[a,n]),g=Object(i.useCallback)((e=>{e.preventDefault(),p(o.y,{deepLinkId:T.a.timelines})}),[p]),f="favorites"===e?iv:sv,b=Object(i.useMemo)((()=>r.a.createElement(ut.f,{onClick:g,href:s("")},pv)),[g,s]),h=Object(i.useMemo)((()=>r.a.createElement(Cv,{lines:2,placeholders:"favorites"===e?1:3})),[e]),{fetchAllTimeline:y,timelines:E,loading:v}=Object(bv.b)(),x=c.m.default,{timelineStatus:S}=Object(Iv.a)({timelineType:x});return Object(i.useEffect)((()=>{y({pageInfo:{pageIndex:1,pageSize:3},search:"",sort:{sortField:c.f.updated,sortOrder:Ii.b.desc},onlyUserFavorite:"favorites"===e,status:S,timelineType:x})}),[y,e,S,x]),r.a.createElement(r.a.Fragment,null,v?h:r.a.createElement(wv,{noTimelinesMessage:f,onOpenTimeline:m,timelines:null!=E?E:[]}),r.a.createElement(N.EuiHorizontalRule,{margin:"s"}),r.a.createElement(N.EuiText,{size:"xs"},b))};Mv.displayName="StatefulRecentTimelinesComponent";const Av=r.a.memo(Mv);var Dv=a(773),qv=a.n(Dv);const Pv="en",Rv=[],_v=r.a.memo((({children:e,title:t})=>r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiFlexGroup,{alignItems:"center",gutterSize:"none",justifyContent:"spaceBetween"},r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiTitle,{size:"xs"},r.a.createElement("h2",null,t))),r.a.createElement(N.EuiFlexItem,{grow:!1},e)),r.a.createElement(N.EuiHorizontalRule,{margin:"s"}))));_v.displayName="SidebarHeader";const Fv=F.i18n.translate("xpack.securitySolution.newsFeed.noNewsMessage",{defaultMessage:"Your current news feed URL returned no recent news."}),Lv=F.i18n.translate("xpack.securitySolution.newsFeed.noNewsMessageForAdmin",{defaultMessage:"Your current news feed URL returned no recent news. You may update the URL or disable security news via"}),Nv=F.i18n.translate("xpack.securitySolution.newsFeed.advancedSettingsLinkTitle",{defaultMessage:"Security Solution advanced settings"}),Bv=r.a.memo((()=>{var e;const{getUrlForApp:t,navigateToApp:a,capabilities:n}=Object(d.j)().services.application,s=null!==(e=n.management.kibana.settings)&&void 0!==e&&e,o=Object(i.useCallback)((()=>a("management",{path:"/kibana/settings"})),[a]);return r.a.createElement(N.EuiText,{color:"subdued",size:"s"},s?Lv:Fv,s&&r.a.createElement(r.a.Fragment,null," ",r.a.createElement(ut.f,{onClick:o,href:`${t("management",{path:"/kibana/settings"})}`},Nv),"."))}));Bv.displayName="NoNews";const zv=({href:e,children:t})=>r.a.createElement(N.EuiLink,{href:e,rel:"noopener nofollow noreferrer",target:"_blank"},t),Uv=z.a.img.withConfig({displayName:"NewsItemPreviewImage",componentId:"sc-e9sq8j-0"})(["height:56px;margin-left:16px;min-width:56px;padding:4px;width:56px;"]),Hv=r.a.memo((({newsItem:e})=>{const{linkUrl:t,title:a,publishOn:n,description:i,imageUrl:s}=e;return(({publishOn:e,expireOn:t})=>Fn()(Date.now()).isAfter(e)&&Fn()(Date.now()).isBefore(t))(e)?r.a.createElement(N.EuiFlexGroup,{gutterSize:"none",justifyContent:"spaceBetween"},r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiText,{size:"s"},r.a.createElement(zv,{href:t},a)),r.a.createElement(N.EuiText,{color:"subdued",size:"xs"},r.a.createElement(wn.e,{value:n}),r.a.createElement(N.EuiSpacer,{size:"s"}),r.a.createElement("div",null,i),r.a.createElement(N.EuiSpacer,{size:"l"}))),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement("div",null,s&&r.a.createElement(Uv,{alt:a,className:"euiPanel",src:s})))):null}));Hv.displayName="Post";const $v=({news:e})=>r.a.createElement(r.a.Fragment,null,r.a.createElement(_v,{title:mE.d}),null==e?r.a.createElement(Cv,{lines:4,placeholders:5}):0===e.length?r.a.createElement(Bv,null):e.map((e=>r.a.createElement(Hv,{key:e.hash,newsItem:e}))));$v.displayName="NewsFeedComponent";const Vv=r.a.memo($v),Qv=r.a.memo((({enableNewsFeedSetting:e,newsFeedSetting:t})=>{const a=Object(d.j)().services.newsfeed,[n]=Object(d.p)(e),[s]=Object(d.p)(t),[o,l]=Object(i.useState)(null),c=a&&n,u=(({newsFeedUrlSetting:e,getKibanaVersion:t})=>{return[null==e?void 0:e.trim().replace(/\/$/,""),`v${a=t(),null!==(n=null===(i=qv()(a))||void 0===i?void 0:i.version)&&void 0!==n?n:a}.json`].join("/");var a,n,i})({newsFeedUrlSetting:s,getKibanaVersion:()=>d.b.getKibanaVersion()});return Object(i.useEffect)((()=>{let e=!1;return c&&(async()=>{try{const t=await(async({newsFeedUrl:e})=>d.b.get().http.fetch(e,{method:"GET",credentials:"omit",mode:"cors"}))({newsFeedUrl:u});e||l((e=>{const t=""===document.documentElement.lang?"en":null!==(a=document.documentElement.lang)&&void 0!==a?a:"en";var a;return null==e||null==e.items?Rv:e.items.filter((e=>null!=e)).map((e=>{var a,n,i,r,s,o,l,c,u,d,p;return{description:null!==(a=null!==(n=Object(E.get)(t,e.description))&&void 0!==n?n:Object(E.get)(Pv,e.description))&&void 0!==a?a:"",expireOn:new Date(null!==(i=e.expire_on)&&void 0!==i?i:""),hash:null!==(r=e.hash)&&void 0!==r?r:sa.a.v4(),imageUrl:null!==(s=null!==(o=Object(E.get)(t,e.image_url))&&void 0!==o?o:Object(E.get)(Pv,e.image_url))&&void 0!==s?s:null,linkUrl:null!==(l=null!==(c=Object(E.get)(t,e.link_url))&&void 0!==c?c:Object(E.get)(Pv,e.link_url))&&void 0!==l?l:"",publishOn:new Date(null!==(u=e.publish_on)&&void 0!==u?u:""),title:null!==(d=null!==(p=Object(E.get)(t,e.title))&&void 0!==p?p:Object(E.get)(Pv,e.title))&&void 0!==d?d:""}}))})(t))}catch{e||l([])}})(),()=>{e=!0}}),[c,u]),r.a.createElement(r.a.Fragment,null,c?r.a.createElement(Vv,{news:o}):null)}));Qv.displayName="StatefulNewsFeed";const Wv=()=>{var e,t;const{cases:a}=Object(d.j)().services,n=null!==(e=null===(t=Object(d.h)())||void 0===t?void 0:t.crud)&&void 0!==e&&e;return a.ui.getRecentCases({userCanCrud:n,maxCasesToShow:3,owner:[o.n]})};Wv.displayName="RecentCasesComponent";const Gv=r.a.memo(Wv),Kv=r.a.memo((({recentTimelinesFilterBy:e,setRecentTimelinesFilterBy:t})=>{var a;const n=Object(i.useMemo)((()=>r.a.createElement(fv,{filterBy:e,setFilterBy:t})),[e,t]),s=null===(a=Object(d.h)())||void 0===a?void 0:a.read;return r.a.createElement(N.EuiFlexGroup,{direction:"column",responsive:!1,gutterSize:"l"},s&&r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(Gv,null)),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(_v,{title:mE.g},n),r.a.createElement(Av,{filterBy:e})),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(Qv,{enableNewsFeedSetting:o.sb,newsFeedSetting:o.Ib})))}));Kv.displayName="Sidebar";const Yv=r.a.memo((()=>{const[e,t]=Object(i.useState)("favorites");return r.a.createElement(Kv,{recentTimelinesFilterBy:e,setRecentTimelinesFilterBy:t})}));Yv.displayName="StatefulSidebar";var Jv=a(837),Xv=a(301);const Zv=Object(i.memo)((({onDismiss:e})=>{const{getUrlForApp:t}=Object(d.j)().services.application,a=Object(h.e)({name:"endpointList"}),n=t(o.y,{path:a}),i=Object(Xv.a)(o.y,{path:a});return r.a.createElement(N.EuiCallOut,{"data-test-subj":"endpoint-prompt-banner",iconType:"cheer",title:r.a.createElement(r.a.Fragment,null,r.a.createElement("b",null,r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.overview.endpointNotice.introducing",defaultMessage:"Introducing: "})),r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.overview.endpointNotice.title",defaultMessage:"Endpoint Security"}))},r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.overview.endpointNotice.message",defaultMessage:"Protect your hosts with threat prevention, detection, and deep security data visibility."})),r.a.createElement(N.EuiButton,{onClick:i,href:n},r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.overview.endpointNotice.tryButton",defaultMessage:"Try Endpoint Security"})),r.a.createElement(N.EuiButtonEmpty,{onClick:e},r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.overview.endpointNotice.dismiss",defaultMessage:"Dismiss message"}))))}));Zv.displayName="EndpointNotice";var eT=a(101),tT=a(456),aT=a(92);const nT="ctiEventCountQuery",iT=Object(Tg.d)((e=>(({data:e,defaultIndex:t,timerange:a,signal:n})=>e.search.search({defaultIndex:t,factoryQueryType:eT.a.dataSource,timerange:a},{strategy:"securitySolutionSearchStrategy",abortSignal:n}))(e).pipe(Object(vg.filter)((e=>Object(kg.isErrorResponse)(e)||Object(kg.isCompleteResponse)(e)))))),rT=({to:e,from:t,allTiDataSources:a,setQuery:n,deleteQuery:r})=>{const[s,l]=Object(i.useState)([]),[c,u]=Object(i.useState)(!1),{data:p,uiSettings:m}=Object(d.j)().services,g=m.get(o.ab),{result:f,start:b,loading:h}=Object(Tg.c)(iT);Object(i.useEffect)((()=>{b({data:p,timerange:e&&t?{to:e,from:t,interval:""}:void 0,defaultIndex:g})}),[e,t,b,p,g]),Object(i.useEffect)((()=>{var e,t;!h&&null!=f&&f.rawResponse&&null!=f&&f.inspect&&n&&n({id:nT,inspect:{dsl:null!==(e=null==f||null===(t=f.inspect)||void 0===t?void 0:t.dsl)&&void 0!==e?e:[],response:[JSON.stringify(f.rawResponse,null,2)]},loading:h,refetch:()=>{}})}),[n,h,f]),Object(i.useEffect)((()=>()=>{r&&r({id:nT})}),[r]),Object(i.useEffect)((()=>{f&&!c&&u(!0)}),[c,f]),Object(i.useEffect)((()=>{if(!h&&f){var e,t,n,i;const r=null!==(e=null==f||null===(t=f.rawResponse)||void 0===t||null===(n=t.aggregations)||void 0===n||null===(i=n.dataset)||void 0===i?void 0:i.buckets)&&void 0!==e?e:[],s=e=>{var t,a;return null==e||null===(t=e.buckets)||void 0===t||null===(a=t[0])||void 0===a?void 0:a.key},o=r.reduce(((e,t)=>{const a=s(null==t?void 0:t.name);if(a)return{...e,[t.key]:{dataset:null==t?void 0:t.key,name:a,dashboardId:s(null==t?void 0:t.dashboard),count:null==t?void 0:t.doc_count}};{var n,i,r;const a=aT.o,s=null!==(n=null===(i=e[a])||void 0===i?void 0:i.count)&&void 0!==n?n:0;return{...e,[a]:{dataset:a,name:tT.d,count:s+(null!==(r=null==t?void 0:t.doc_count)&&void 0!==r?r:0)}}}}),{});Array.isArray(a)&&a.forEach((e=>{o[e.dataset]||(o[e.dataset]={...e,count:0})})),l(Object.values(o))}}),[f,h,a]);const y=s.reduce(((e,t)=>e+t.count),0);return{tiDataSources:s,totalCount:y,isInitiallyLoaded:c}},sT={type:"tag",search:"threat intel",searchFields:["name"]};var oT=a(854);var lT=a(723),cT=a(536);const uT=[{name:"Name",field:"title",sortable:!0,truncateText:!0,width:"100%"},{name:"Indicator",field:"count",render:e=>{var t;if(e<1e4)return e.toString();const{magnitude:a,unit:n}=null!==(t=[{magnitude:1e18,unit:"E"},{magnitude:1e15,unit:"P"},{magnitude:1e12,unit:"T"},{magnitude:1e9,unit:"B"},{magnitude:1e6,unit:"M"},{magnitude:1e3,unit:"K"}].find((t=>e>=t.magnitude)))&&void 0!==t?t:{magnitude:1,unit:""};return((e,t)=>{const a=e.toFixed(t);return+a<=e?a:(+a-Math.pow(.1,t)).toFixed(t)})(e/a,1).replace(/\.0+$|(\.[0-9]*[1-9])0+$/,"$1")+n},sortable:!0,truncateText:!0,width:"70px",align:"right"},{name:"",field:"path",truncateText:!0,width:"80px",render:e=>r.a.createElement(lT.a,{path:e,copy:cT.d})}],dT=({isInspectEnabled:e=!0,listItems:t,splitPanel:a,totalCount:n=0})=>r.a.createElement(oT.b,{columns:uT,dataTestSubj:"cti-dashboard-links",inspectQueryId:e?nT:void 0,listItems:t,panelTitle:tT.e,splitPanel:a,subtitle:Object(i.useMemo)((()=>r.a.createElement(It.FormattedMessage,{"data-test-subj":"cti-total-event-count",defaultMessage:"Showing: {totalCount} {totalCount, plural, one {indicator} other {indicators}}",id:"xpack.securitySolution.overview.ctiDashboardSubtitle",values:{totalCount:n}})),[n])}),pT=e=>{const{to:t,from:a,allTiDataSources:n,setQuery:s,deleteQuery:o}=e,{tiDataSources:l,totalCount:c}=rT({to:t,from:a,allTiDataSources:n,setQuery:s,deleteQuery:o}),{listItems:u}=(({to:e,from:t,tiDataSources:a=[]})=>{var n;const[r,s]=Object(i.useState)([]),o=null===(n=Object(d.j)().services.dashboard)||void 0===n?void 0:n.locator,l=Object(d.j)().services.savedObjects.client,c=Object(i.useCallback)((e=>{var t;if(null!=e&&null!==(t=e.savedObjects)&&void 0!==t&&t.length)return l.find({type:"dashboard",hasReference:{id:e.savedObjects[0].id,type:"tag"}})}),[l]);return Object(i.useEffect)((()=>{l&&l.find(sT).then(c).then((async e=>{var t;null!=e&&null!==(t=e.savedObjects)&&void 0!==t&&t.length&&s(e.savedObjects.map((e=>{var t;return null!==(t=e.id)&&void 0!==t?t:""})).filter(Boolean))}))}),[c,l]),{listItems:a.map((a=>{const n={title:a.name,count:a.count,path:""};return a.dashboardId&&r.includes(a.dashboardId)&&o&&(n.path=o.getRedirectUrl({dashboardId:a.dashboardId,timeRange:{to:e,from:t}})),n}))}})({to:t,from:a,tiDataSources:l});return r.a.createElement(dT,{listItems:u,totalCount:c})},mT=r.a.memo(pT);mT.displayName="CtiEnabledModule";var gT=a(722);const fT=()=>{const e=`${Object(d.e)()}/app/integrations/browse?q=threat%20intelligence`;return r.a.createElement(gT.a,{bodyCopy:tT.a,buttonCopy:tT.b,dataTestSubjPrefix:"cti",docLink:e,listItems:[],titleCopy:tT.c,LinkPanelViewComponent:dT})},bT=r.a.memo(fT);bT.displayName="CtiDisabledModule";const hT=e=>{const{allTiDataSources:t}=e;return t.length>0?r.a.createElement("div",{"data-test-subj":"cti-enabled-module"},r.a.createElement(mT,rr()({},e,{allTiDataSources:t}))):r.a.createElement("div",{"data-test-subj":"cti-disabled-module"},r.a.createElement(bT,null))},yT=r.a.memo(hT);yT.displayName="ThreatIntelDashboardLinksComponent";var ET=a(822);const vT=ms.a.OVERVIEW_RISKY_HOSTS,TT=({timerange:e,deleteQuery:t,setQuery:a})=>{const[n,{data:i,isModuleEnabled:s,inspect:o,refetch:l}]=Object(ms.c)({timerange:e});switch(Object(sr.b)({queryId:vT,loading:n,refetch:l,setQuery:a,deleteQuery:t,inspect:o}),s){case!0:return r.a.createElement(ET.a,{to:e.to,from:e.from,hostRiskScore:i});case!1:return r.a.createElement(cs.b,null);default:return null}},kT=r.a.memo(TT);kT.displayName="RiskyHostLinks";const xT=()=>{const e=Object(i.useMemo)((()=>ae.e.globalFiltersQuerySelector()),[]),t=Object(i.useMemo)((()=>ae.e.globalQuerySelector()),[]),a=Object(v.a)(t),n=Object(v.a)(e),{from:s,deleteQuery:l,setQuery:c,to:u}=Object(H.a)(),{indicesExist:d,indexPattern:p,selectedPatterns:g}=Object(m.d)(),f=Object(i.useMemo)((()=>[o.ub]),[]),[,{indexExists:h}]=Object(EE.b)(f,!0),{addMessage:E,hasMessage:k}=kt(),x=Object(i.useMemo)((()=>k("management","dismissEndpointNotice")),[k]),[S,O]=Object(i.useState)(x),w=Object(i.useCallback)((()=>{O(!0),E("management","dismissEndpointNotice")}),[E]),{endpointPrivileges:{canAccessFleet:j}}=Object(nt.a)(),{hasIndexRead:C,hasKibanaREAD:I}=Object(ja.a)(),{tiDataSources:M,isInitiallyLoaded:A}=(()=>{const{to:e,from:t}=Object(i.useMemo)((()=>({to:(new Date).toISOString(),from:new Date(0).toISOString()})),[]),{tiDataSources:a,isInitiallyLoaded:n}=rT({to:e,from:t});return{tiDataSources:a,isInitiallyLoaded:n}})(),D=Object(Z.a)("riskyHostsEnabled");return r.a.createElement(r.a.Fragment,null,d?r.a.createElement(r.a.Fragment,null,r.a.createElement($.a,null,r.a.createElement(Q.a,{id:"global",indexPattern:p})),r.a.createElement(b.a,null,!S&&!h&&j&&r.a.createElement(r.a.Fragment,null,r.a.createElement(Zv,{onDismiss:w}),r.a.createElement(N.EuiSpacer,{size:"l"})),r.a.createElement(N.EuiFlexGroup,null,r.a.createElement(N.EuiShowFor,{sizes:["xl"]},r.a.createElement(N.EuiFlexItem,{grow:1},r.a.createElement(Yv,null))),r.a.createElement(N.EuiFlexItem,{grow:3},r.a.createElement(N.EuiFlexGroup,{direction:"column",responsive:!1,gutterSize:"none"},C&&I&&r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(Jv.a,{filters:n,query:a}),r.a.createElement(N.EuiSpacer,{size:"l"})),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(yE,{deleteQuery:l,filters:n,from:s,indexPattern:p,indexNames:g,query:a,setQuery:c,to:u}))),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(vE.a,{deleteQuery:l,filters:n,from:s,indexPattern:p,indexNames:g,query:a,queryType:"overview",setQuery:c,to:u})),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(av,{filters:n,from:s,indexNames:g,indexPattern:p,query:a,setQuery:c,to:u})),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiFlexGroup,{direction:"row"},r.a.createElement(N.EuiFlexItem,{grow:1},A&&r.a.createElement(yT,{allTiDataSources:M,deleteQuery:l,from:s,setQuery:c,to:u})),r.a.createElement(N.EuiFlexItem,{grow:1},D&&r.a.createElement(kT,{deleteQuery:l,setQuery:c,timerange:{from:s,to:u}}))))))))):r.a.createElement(ka.a,null),r.a.createElement(y.a,{pageName:T.a.overview}))},ST=r.a.memo(xT);var OT=a(363),wT=a(622);const jT=z.a.div.withConfig({displayName:"BigRing",componentId:"sc-1yoqpxe-0"})(["border-radius:50%;",""],(({size:e})=>`height: ${e}px;\n    width: ${e}px;\n    background-color: #FAFBFD;\n    text-align: center;\n    line-height: ${e}px;`)),CT=z.a.div.withConfig({displayName:"SmallRing",componentId:"sc-1yoqpxe-1"})(["border-radius:50%;",""],(({size:e})=>`\n    height: ${e}px;\n    width: ${e}px;\n    background-color: white;\n    display: inline-block;\n    vertical-align: middle;`)),IT=({size:e=90,donutWidth:t=20})=>e-t>0?r.a.createElement(jT,{size:e,"data-test-subj":"empty-donut"},r.a.createElement(CT,{size:e-t,"data-test-subj":"empty-donut-small"})):null,MT=r.a.memo(IT),AT={chartMargins:{top:0,bottom:0,left:0,right:0},partition:{idealFontSizeJump:1.1,outerSizeRatio:1,emptySizeRatio:.8,circlePadding:4}},DT=z()(N.EuiFlexGroup).withConfig({displayName:"DonutTextWrapper",componentId:"sc-1oomqeq-0"})(["top:34%;width:100%;max-width:77px;position:absolute;z-index:1;"]),qT=z()(N.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-1oomqeq-1"})(["position:relative;align-items:center;"]),PT=({data:e,fillColor:t,height:a=90,label:n,legendItems:s,link:o,title:l,totalCount:c})=>{const u=Object(ur.h)(),{euiTheme:d}=Object(N.useEuiTheme)(),p=Object(i.useMemo)((()=>({color:d.colors.disabled})),[d.colors.disabled]);return r.a.createElement(N.EuiFlexGroup,{alignItems:"center",justifyContent:"center",responsive:!1,gutterSize:"l","data-test-subj":"donut-chart"},r.a.createElement(qT,{grow:!1},r.a.createElement(DT,{direction:"column",gutterSize:"none",alignItems:"center",justifyContent:"center"},r.a.createElement(N.EuiFlexItem,null,l),r.a.createElement(N.EuiFlexItem,{className:"eui-textTruncate"},e?r.a.createElement(N.EuiText,{className:"eui-textTruncate",size:"s"},n):r.a.createElement(N.EuiText,{className:"eui-textTruncate",size:"s",style:p},n))),null==e||null==c||0===c?r.a.createElement(MT,{size:a}):r.a.createElement(or.Chart,{size:a},r.a.createElement(or.Settings,{theme:AT,baseTheme:u}),r.a.createElement(or.Partition,{id:"donut-chart",data:e,layout:or.PartitionLayout.sunburst,valueAccessor:e=>e.value,valueFormatter:e=>`${Object(or.defaultPartitionValueFormatter)(e)}`,layers:[{groupByRollup:e=>{var t;return null!==(t=e.label)&&void 0!==t?t:e.key},nodeLabel:e=>e,shape:{fillColor:t}}]}))),s&&(null==s?void 0:s.length)>0&&r.a.createElement(N.EuiFlexItem,null,r.a.createElement(wT.a,{legendItems:s,height:a})))},RT=F.i18n.translate("xpack.securitySolution.detectionResponse.alertsByStatus.donut.criticalLabel",{defaultMessage:"Critical"}),_T=F.i18n.translate("xpack.securitySolution.detectionResponse.alertsByStatus.donut.highLabel",{defaultMessage:"High"}),FT=F.i18n.translate("xpack.securitySolution.detectionResponse.alertsByStatus.donut.mediumLabel",{defaultMessage:"Medium"}),LT=F.i18n.translate("xpack.securitySolution.detectionResponse.alertsByStatus.donut.lowLabel",{defaultMessage:"Low"}),NT=F.i18n.translate("xpack.securitySolution.detectionResponse.alertsByStatus.status.acknowledged",{defaultMessage:"Acknowledged"}),BT=F.i18n.translate("xpack.securitySolution.detectionResponse.status.open",{defaultMessage:"Open"}),zT=F.i18n.translate("xpack.securitySolution.detectionResponse.status.closed",{defaultMessage:"Closed"}),UT=F.i18n.translate("xpack.securitySolution.detectionResponse.status.inProgress",{defaultMessage:"In progress"}),HT=F.i18n.translate("xpack.securitySolution.detectionResponse.alerts",{defaultMessage:"Alerts"}),$T=F.i18n.translate("xpack.securitySolution.detectionResponse.updating",{defaultMessage:"Updating..."}),VT=F.i18n.translate("xpack.securitySolution.detectionResponse.updated",{defaultMessage:"Updated"}),QT=F.i18n.translate("xpack.securitySolution.detectionResponse.casesByStatusSectionTitle",{defaultMessage:"Cases"}),WT=F.i18n.translate("xpack.securitySolution.detectionResponse.viewCases",{defaultMessage:"View cases"}),GT=F.i18n.translate("xpack.securitySolution.detectionResponse.ruleAlertsSectionTitle",{defaultMessage:"Open alerts by rule"}),KT=F.i18n.translate("xpack.securitySolution.detectionResponse.hostAlertsSectionTitle",{defaultMessage:"Hosts by alert severity"}),YT=F.i18n.translate("xpack.securitySolution.detectionResponse.userAlertsSectionTitle",{defaultMessage:"Users by alert severity"}),JT=F.i18n.translate("xpack.securitySolution.detectionResponse.caseSectionTitle",{defaultMessage:"Recently created cases"}),XT=F.i18n.translate("xpack.securitySolution.detectionResponse.noRuleAlerts",{defaultMessage:"No alerts to display"}),ZT=F.i18n.translate("xpack.securitySolution.detectionResponse.noRecentCases",{defaultMessage:"No cases to display"}),ek=F.i18n.translate("xpack.securitySolution.detectionResponse.ruleAlertsColumnRuleName",{defaultMessage:"Rule name"}),tk=F.i18n.translate("xpack.securitySolution.detectionResponse.ruleAlertsColumnLastAlert",{defaultMessage:"Last alert"}),ak=F.i18n.translate("xpack.securitySolution.detectionResponse.ruleAlertsColumnAlertCount",{defaultMessage:"Alert count"}),nk=F.i18n.translate("xpack.securitySolution.detectionResponse.ruleAlertsColumnSeverity",{defaultMessage:"Severity"}),ik=F.i18n.translate("xpack.securitySolution.detectionResponse.openRuleDetailTooltip",{defaultMessage:"Open rule detail"}),rk=(F.i18n.translate("xpack.securitySolution.detectionResponse.openRuleAlertsTooltip",{defaultMessage:"Open rule alerts"}),F.i18n.translate("xpack.securitySolution.detectionResponse.openAllAlertsButton",{defaultMessage:"View all open alerts"})),sk=(F.i18n.translate("xpack.securitySolution.detectionResponse.viewAllUserAlerts",{defaultMessage:"View all users"}),F.i18n.translate("xpack.securitySolution.detectionResponse.viewRecentCases",{defaultMessage:"View recent cases"})),ok=(F.i18n.translate("xpack.securitySolution.detectionResponse.viewAllHostAlerts",{defaultMessage:"View all hosts"}),F.i18n.translate("xpack.securitySolution.detectionResponse.hostAlertsHostName",{defaultMessage:"Host name"})),lk=F.i18n.translate("xpack.securitySolution.detectionResponse.userAlertsUserName",{defaultMessage:"User name"}),ck=F.i18n.translate("xpack.securitySolution.detectionResponse.caseColumnName",{defaultMessage:"Name"}),uk=F.i18n.translate("xpack.securitySolution.detectionResponse.caseColumnTime",{defaultMessage:"Time"}),dk=F.i18n.translate("xpack.securitySolution.detectionResponse.caseColumnCreatedBy",{defaultMessage:"Created by"}),pk=F.i18n.translate("xpack.securitySolution.detectionResponse.caseColumnStatus",{defaultMessage:"Status"}),mk=F.i18n.translate("xpack.securitySolution.detectionResponse.errorMessage",{defaultMessage:"Error fetching case data"}),gk=F.i18n.translate("xpack.securitySolution.detectionResponse.hostSectionTooltip",{defaultMessage:"Maximum of 100 hosts. Please consult Alerts page for further information."}),fk=F.i18n.translate("xpack.securitySolution.detectionResponse.userSectionTooltip",{defaultMessage:"Maximum of 100 users. Please consult Alerts page for further information."}),bk={critical:RT,high:_T,medium:FT,low:LT},hk=({from:e,to:t})=>({size:0,query:{bool:{filter:[{range:{"@timestamp":{gte:e,lte:t}}}]}},aggs:{alertsByStatus:{terms:{field:"kibana.alert.workflow_status"},aggs:{statusBySeverity:{terms:{field:"kibana.alert.severity"}}}}}}),yk={critical:"#E7664C",high:"#DA8B45",medium:"#D6BF57",low:"#54B399"},Ek=({isUpdating:e,updatedAt:t})=>r.a.createElement(N.EuiFlexGroup,null,e?r.a.createElement(N.EuiFlexItem,{grow:!1},$T):r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(r.a.Fragment,null,VT," "),r.a.createElement(It.FormattedRelative,{"data-test-subj":"last-updated-at-date",key:`formattedRelative-${Date.now()}`,value:new Date(t)}))),vk=(e=0)=>Math.ceil(Math.min(e||0,100)/4);var Tk=a(328);const kk=z.a.div.withConfig({displayName:"PlaceHolder",componentId:"sc-u1bwbv-0"})(["padding:",";"],(e=>e.theme.eui.paddingSizes.s)),xk=({count:e})=>null!=e?r.a.createElement("b",null,r.a.createElement(Tk.a,{count:e})):r.a.createElement(kk,null);xk.displayName="ChartLabelComponent";const Sk=r.a.memo(xk);var Ok=a(405),wk=a(261);const jk=z.a.span.withConfig({displayName:"LegendText",componentId:"sc-11u62u-0"})(["font-size:10.5px;"]),Ck=r.a.memo((({value:e})=>Object(wk.a)(e)?r.a.createElement(jk,null,e):r.a.createElement(jk,{"data-test-subj":"value-wrapper-empty"},Ok.c)));Ck.displayName="ValueWrapper";const Ik=({legendItem:e})=>{const{color:t,value:a}=e;return r.a.createElement(N.EuiText,{size:"xs"},r.a.createElement(N.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},null!=t&&r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiHealth,{"data-test-subj":"legend-color",color:t})),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(Ck,{value:a}))))};Ik.displayName="LegendItemComponent";const Mk=r.a.memo(Ik),Ak=({legendItems:e})=>0===e.length?null:r.a.createElement(N.EuiText,{size:"xs","data-test-subj":"legend"},r.a.createElement(N.EuiFlexGroup,{direction:"column",gutterSize:"none"},e.map(((e,t)=>r.a.createElement(N.EuiFlexItem,{key:`legend-item-${t}`,grow:!1},r.a.createElement(Mk,{legendItem:e}),r.a.createElement(N.EuiSpacer,{"data-test-subj":"legend-spacer",size:"s"}))))));Ak.displayName="LegendComponent";const Dk=r.a.memo(Ak),qk=z()(N.EuiFlexItem).withConfig({displayName:"StyledFlexItem",componentId:"sc-3zhuyw-0"})(["padding:0 4px;"]),Pk=z()(N.EuiFlexItem).withConfig({displayName:"StyledLegendFlexItem",componentId:"sc-3zhuyw-1"})(["padding-left:32px;padding-top:45px;"]),Rk=[{key:"critical",label:RT,color:yk.critical},{key:"high",label:_T,color:yk.high},{key:"medium",label:FT,color:yk.medium},{key:"low",label:LT,color:yk.low}],_k="detection-response-alerts-by-status",Fk=({signalIndexName:e})=>{var t,a,n,s,l,c,p,m,g;const{toggleStatus:f,setToggleStatus:b}=Object(Ea.a)(_k),{formatUrl:h,search:y}=Object(u.k)(o.cc.alerts),{navigateTo:E}=Object(d.l)(),v=Object(i.useCallback)((e=>{e.preventDefault(),E({deepLinkId:o.cc.alerts,path:Object(u.c)(y)})}),[E,y]),T=Object(i.useMemo)((()=>({name:mE.i,href:h(Object(u.c)()),onClick:v})),[h,v]),{items:k,isLoading:x,updatedAt:S}=(({queryId:e,signalIndexName:t,skip:a=!1})=>{const{to:n,from:r,deleteQuery:s,setQuery:o}=Object(H.a)(),[l,c]=Object(i.useState)(Date.now()),[u,d]=Object(i.useState)(null),{data:p,loading:m,refetch:g,request:f,response:b,setQuery:h}=Object(w.a)({query:hk({from:r,to:n}),indexName:t,skip:a});Object(i.useEffect)((()=>{h(hk({from:r,to:n}))}),[h,r,n]),Object(i.useEffect)((()=>{d(null==p?null:(e=>{var t,a,n;const i=null!==(t=null==e||null===(a=e.aggregations)||void 0===a||null===(n=a.alertsByStatus)||void 0===n?void 0:n.buckets)&&void 0!==t?t:[];return 0===i.length?null:i.reduce(((e,t)=>{var a,n;const i=null!==(a=null===(n=t.statusBySeverity)||void 0===n?void 0:n.buckets)&&void 0!==a?a:[];return{...e,[t.key]:{total:t.doc_count,severities:i.map((e=>({key:e.key,value:e.doc_count,label:bk[e.key]})))}}}),{})})(p)),c(Date.now())}),[p]);const y=Object(i.useCallback)((()=>{!a&&g&&g()}),[a,g]);return Object(sr.b)({deleteQuery:s,inspect:{dsl:[f],response:[b]},refetch:y,setQuery:o,queryId:e,loading:m}),{items:u,isLoading:m,updatedAt:l}})({signalIndexName:e,queryId:_k,skip:!f}),O=Object(i.useMemo)((()=>Rk.map((e=>({color:e.color,field:"kibana.alert.severity",value:e.label})))),[]),j=null!==(t=null==k||null===(a=k.open)||void 0===a?void 0:a.total)&&void 0!==t?t:0,C=null!==(n=null==k||null===(s=k.acknowledged)||void 0===s?void 0:s.total)&&void 0!==n?n:0,I=null!==(l=null==k||null===(c=k.closed)||void 0===c?void 0:c.total)&&void 0!==l?l:0,M=x||null==k?0:j+C+I,A=Object(i.useCallback)((e=>{var t,a;return null!==(t=null===(a=Rk.find((t=>t.label===e.dataName)))||void 0===a?void 0:a.color)&&void 0!==t?t:"#FAFBFD"}),[]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(pr.a,{show:!0,targetClassNames:[ca.a]},r.a.createElement(N.EuiPanel,{hasBorder:!0,"data-test-subj":"detection-response-alerts-by-status-panel"},x&&r.a.createElement(N.EuiProgress,{"data-test-subj":"initialLoadingPanelMatrixOverTime",size:"xs",position:"absolute",color:"accent"}),r.a.createElement(la.a,{id:_k,title:HT,titleSize:"s",subtitle:r.a.createElement(Ek,{isUpdating:x,updatedAt:S}),inspectMultiple:!0,toggleStatus:f,toggleQuery:b},r.a.createElement(N.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(ut.g,{"data-test-subj":"view-details-button",onClick:T.onClick,href:T.href},T.name)))),f&&r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiFlexGroup,{justifyContent:"center",gutterSize:"none"},r.a.createElement(N.EuiFlexItem,{grow:!1},0!==M&&r.a.createElement(N.EuiText,{className:"eui-textCenter",size:"s"},r.a.createElement(r.a.Fragment,null,r.a.createElement("b",null,r.a.createElement(Tk.a,{count:M})),r.a.createElement(r.a.Fragment,null," "),r.a.createElement("small",null,(e=>F.i18n.translate("xpack.securitySolution.detectionResponse.alertsByStatus.totalAlerts",{values:{totalAlerts:e},defaultMessage:"total {totalAlerts, plural, =1 {alert} other {alerts}}"}))(M)))),r.a.createElement(N.EuiSpacer,{size:"l"}),r.a.createElement(N.EuiFlexGroup,{justifyContent:"center"},r.a.createElement(qk,{key:"alerts-status-open",grow:!1},r.a.createElement(PT,{data:null==k||null===(p=k.open)||void 0===p?void 0:p.severities,fillColor:A,height:120,label:BT,title:r.a.createElement(Sk,{count:j}),totalCount:j})),r.a.createElement(qk,{key:"alerts-status-acknowledged",grow:!1},r.a.createElement(PT,{data:null==k||null===(m=k.acknowledged)||void 0===m?void 0:m.severities,fillColor:A,height:120,label:NT,title:r.a.createElement(Sk,{count:C}),totalCount:C})),r.a.createElement(qk,{key:"alerts-status-closed",grow:!1},r.a.createElement(PT,{data:null==k||null===(g=k.closed)||void 0===g?void 0:g.severities,fillColor:A,height:120,label:zT,title:r.a.createElement(Sk,{count:I}),totalCount:I})))),r.a.createElement(Pk,{grow:!1},O.length>0&&r.a.createElement(Dk,{legendItems:O}))),r.a.createElement(N.EuiSpacer,{size:"m"})))))};var Lk=a(535),Nk=a(371);const Bk=()=>{const e=Object(l.useDispatch)(),t=Object(Nk.a)({timelineId:c.i.active,timelineType:c.m.default}),a=a=>{t(),e(Object(k.updateProviders)({id:c.i.active,providers:[a]})),e(uh.a.setSelectedDataView({id:g.SourcererScopeName.timeline,selectedDataViewId:"security-solution-default",selectedPatterns:[".alerts-security.alerts-default"]}))};return{openHostInTimeline:({hostName:e,severity:t})=>{const n=Object(Lk.a)("host.name","",e);t&&n.and.push(Object(Lk.a)("kibana.alert.severity","",t)),a(n)},openRuleInTimeline:e=>{const t=Object(Lk.a)("kibana.alert.rule.name","",e);a(t)},openUserInTimeline:({userName:e,severity:t})=>{const n=Object(Lk.a)("user.name","",e);t&&n.and.push(Object(Lk.a)("kibana.alert.severity","",t)),a(n)}}},zk={pageCount:0,currentPage:0},Uk=({from:e,to:t,currentPage:a})=>({query:{bool:{filter:[{term:{"kibana.alert.workflow_status":"open"}},{range:{"@timestamp":{gte:e,lte:t}}}]}},size:0,aggs:{host_count:{cardinality:{field:"host.name"}},hostsBySeverity:{terms:{size:100,field:"host.name",order:[{"critical.doc_count":"desc"},{"high.doc_count":"desc"},{"medium.doc_count":"desc"},{"low.doc_count":"desc"}]},aggs:{critical:{filter:{term:{"kibana.alert.severity":"critical"}}},high:{filter:{term:{"kibana.alert.severity":"high"}}},medium:{filter:{term:{"kibana.alert.severity":"medium"}}},low:{filter:{term:{"kibana.alert.severity":"low"}}},bucketOfPagination:{bucket_sort:{from:4*a,size:4}}}}}}),Hk="vulnerableHostsBySeverityQuery",$k=r.a.memo((({signalIndexName:e})=>{const{openHostInTimeline:t}=Bk(),{toggleStatus:a,setToggleStatus:n}=Object(Ea.a)(Hk),{items:s,isLoading:o,updatedAt:l,pagination:c}=(({skip:e,queryId:t,signalIndexName:a})=>{const[n,r]=Object(i.useState)(Date.now()),[s,o]=Object(i.useState)([]),[l,c]=Object(i.useState)(zk),{to:u,from:d,setQuery:p,deleteQuery:m}=Object(H.a)(),{data:g,request:f,response:b,setQuery:h,loading:y,refetch:E}=Object(w.a)({query:Uk({from:d,to:u,currentPage:l.currentPage}),indexName:a,skip:e});Object(i.useEffect)((()=>{h(Uk({from:d,to:u,currentPage:l.currentPage}))}),[h,d,u,l.currentPage]),Object(i.useEffect)((()=>{var e,t;null!=g&&g.aggregations?(o((null!==(t=null==(e=g.aggregations)?void 0:e.hostsBySeverity.buckets)&&void 0!==t?t:[]).reduce(((e,t)=>(e.push({hostName:t.key||"â",totalAlerts:t.doc_count,low:t.low.doc_count,medium:t.medium.doc_count,high:t.high.doc_count,critical:t.critical.doc_count}),e)),[])),c((e=>{var t;return{...e,pageCount:vk(null===(t=g.aggregations)||void 0===t?void 0:t.host_count.value)}}))):o([]),r(Date.now())}),[g]);const v=Object(i.useCallback)((()=>{!e&&E&&E()}),[e,E]);return Object(sr.b)({deleteQuery:m,inspect:{dsl:[f],response:[b]},refetch:v,setQuery:p,queryId:t,loading:y}),{items:s,isLoading:y,updatedAt:n,pagination:{...l,setPage:e=>{c((t=>({...t,currentPage:e})))}}}})({skip:!a,queryId:Hk,signalIndexName:e}),u=Object(i.useMemo)((()=>Vk(t)),[t]);return r.a.createElement(pr.a,{show:!0,targetClassNames:[ca.a]},r.a.createElement(N.EuiPanel,{hasBorder:!0,"data-test-subj":"severityHostAlertsPanel"},r.a.createElement(la.a,{id:Hk,title:KT,subtitle:r.a.createElement(Ek,{updatedAt:l,isUpdating:o}),titleSize:"s",toggleQuery:n,toggleStatus:a,tooltip:gk}),a&&r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiBasicTable,{items:s,columns:u,loading:o,"data-test-subj":"severityHostAlertsTable",noItemsMessage:r.a.createElement(N.EuiEmptyPrompt,{title:r.a.createElement("h3",null,XT),titleSize:"xs"})}),r.a.createElement(N.EuiSpacer,{size:"m"}),c.pageCount>1&&r.a.createElement(N.EuiTablePagination,{"data-test-subj":"hostTablePaginator",activePage:c.currentPage,itemsPerPage:4,pageCount:c.pageCount,onChangePage:c.setPage,showPerPageOptions:!1}))))}));$k.displayName="HostAlertsTable";const Vk=e=>[{field:"hostName",name:ok,truncateText:!0,textOnly:!0,"data-test-subj":"hostSeverityAlertsTable-hostName",render:e=>r.a.createElement(ut.d,{hostName:e})},{field:"totalAlerts",name:HT,"data-test-subj":"hostSeverityAlertsTable-totalAlerts",render:(t,{hostName:a})=>r.a.createElement(N.EuiLink,{disabled:0===t,onClick:()=>e({hostName:a})},r.a.createElement(Tk.a,{count:t}))},{field:"critical",name:RT,render:(t,{hostName:a})=>r.a.createElement(N.EuiHealth,{"data-test-subj":"hostSeverityAlertsTable-critical",color:yk.critical},r.a.createElement(N.EuiLink,{disabled:0===t,onClick:()=>e({hostName:a,severity:"critical"})},r.a.createElement(Tk.a,{count:t})))},{field:"high",name:_T,render:(t,{hostName:a})=>r.a.createElement(N.EuiHealth,{"data-test-subj":"hostSeverityAlertsTable-high",color:yk.high},r.a.createElement(N.EuiLink,{disabled:0===t,onClick:()=>e({hostName:a,severity:"high"})},r.a.createElement(Tk.a,{count:t})))},{field:"medium",name:FT,render:(t,{hostName:a})=>r.a.createElement(N.EuiHealth,{"data-test-subj":"hostSeverityAlertsTable-medium",color:yk.medium},r.a.createElement(N.EuiLink,{disabled:0===t,onClick:()=>e({hostName:a,severity:"medium"})},r.a.createElement(Tk.a,{count:t})))},{field:"low",name:LT,render:(t,{hostName:a})=>r.a.createElement(N.EuiHealth,{"data-test-subj":"hostSeverityAlertsTable-low",color:yk.low},r.a.createElement(N.EuiLink,{disabled:0===t,onClick:()=>e({hostName:a,severity:"low"})},r.a.createElement(Tk.a,{count:t})))}],Qk=({from:e,to:t})=>({size:0,query:{bool:{filter:[{term:{"kibana.alert.workflow_status":"open"}},{range:{"@timestamp":{gte:e,lte:t}}}]}},aggs:{alertsByRule:{terms:{field:"kibana.alert.rule.name",size:4,order:[{critical:"desc"},{high:"desc"},{medium:"desc"},{low:"desc"}]},aggs:{critical:{filter:{term:{"kibana.alert.severity":"critical"}}},high:{filter:{term:{"kibana.alert.severity":"high"}}},medium:{filter:{term:{"kibana.alert.severity":"medium"}}},low:{filter:{term:{"kibana.alert.severity":"low"}}},lastRuleAlert:{top_hits:{size:1,sort:{"@timestamp":"desc"}}}}}}}),Wk="detection-response-rule-alerts-severity-table",Gk=r.a.memo((({signalIndexName:e})=>{const{getAppUrl:t,navigateTo:a}=Object(d.l)(),{toggleStatus:n,setToggleStatus:s}=Object(Ea.a)(Wk),{items:l,isLoading:c,updatedAt:u}=(({queryId:e,signalIndexName:t,skip:a=!1})=>{const[n,r]=Object(i.useState)([]),[s,o]=Object(i.useState)(Date.now()),{to:l,from:c,deleteQuery:u,setQuery:d}=Object(H.a)(),{loading:p,data:m,setQuery:g,response:f,request:b,refetch:h}=Object(w.a)({query:Qk({from:c,to:l}),indexName:t,skip:a});Object(i.useEffect)((()=>{g(Qk({from:c,to:l}))}),[g,c,l]),Object(i.useEffect)((()=>{var e,t;r(null==m?[]:(null!==(t=null==(e=m.aggregations)?void 0:e.alertsByRule.buckets)&&void 0!==t?t:[]).map((e=>{const t=e.lastRuleAlert.hits.hits[0]._source;return{id:t["kibana.alert.rule.uuid"],alert_count:e.lastRuleAlert.hits.total.value,name:t["kibana.alert.rule.name"],last_alert_at:t["@timestamp"],severity:t["kibana.alert.severity"]}}))),o(Date.now())}),[m]);const y=Object(i.useCallback)((()=>{!a&&h&&h()}),[a,h]);return Object(sr.b)({deleteQuery:u,inspect:{dsl:[b],response:[f]},refetch:y,setQuery:d,queryId:e,loading:p}),{items:n,isLoading:p,updatedAt:s}})({signalIndexName:e,queryId:Wk,skip:!n}),{openRuleInTimeline:p}=Bk(),m=Object(i.useCallback)((()=>{a({deepLinkId:o.cc.alerts})}),[a]),g=Object(i.useMemo)((()=>(({getAppUrl:e,navigateTo:t,openRuleInTimeline:a})=>[{field:"name",name:ek,render:(a,{id:n})=>{const i=e({deepLinkId:o.cc.rules,path:`id/${n}`});return r.a.createElement(N.EuiToolTip,{"data-test-subj":`${n}-tooltip`,content:ik},r.a.createElement(N.EuiLink,{"data-test-subj":"severityRuleAlertsTable-name",href:i,onClick:e=>{e&&e.preventDefault(),t({url:i})}},a))}},{field:"last_alert_at",name:tk,"data-test-subj":"severityRuleAlertsTable-lastAlertAt",render:e=>r.a.createElement(It.FormattedRelative,{value:new Date(e)})},{field:"alert_count",name:ak,"data-test-subj":"severityRuleAlertsTable-alertCount",render:(e,{name:t})=>r.a.createElement(N.EuiLink,{disabled:0===e,onClick:()=>a(t)},r.a.createElement(Tk.a,{count:e}))},{field:"severity",name:nk,"data-test-subj":"severityRuleAlertsTable-severity",render:e=>r.a.createElement(N.EuiHealth,{color:yk[e]},Object(fn.capitalize)(e))}])({getAppUrl:t,navigateTo:a,openRuleInTimeline:p})),[t,a,p]);return r.a.createElement(pr.a,{show:!0,targetClassNames:[ca.a]},r.a.createElement(N.EuiPanel,{hasBorder:!0,"data-test-subj":"severityRuleAlertsPanel"},r.a.createElement(la.a,{id:Wk,title:GT,titleSize:"s",toggleStatus:n,toggleQuery:s,subtitle:r.a.createElement(Ek,{updatedAt:u,isUpdating:c})}),n&&r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiBasicTable,{"data-test-subj":"severityRuleAlertsTable",columns:g,items:l,loading:c,noItemsMessage:r.a.createElement(N.EuiEmptyPrompt,{title:r.a.createElement("h3",null,XT),titleSize:"xs"})}),r.a.createElement(N.EuiSpacer,{size:"m"}),r.a.createElement(N.EuiButton,{"data-test-subj":"severityRuleAlertsButton",onClick:m},rk))))}));Gk.displayName="RuleAlertsTable";const Kk={pageCount:0,currentPage:0},Yk=({from:e,to:t,currentPage:a})=>({query:{bool:{filter:[{term:{"kibana.alert.workflow_status":"open"}},{range:{"@timestamp":{gte:e,lte:t}}}]}},size:0,aggs:{user_count:{cardinality:{field:"user.name"}},usersBySeverity:{terms:{size:100,field:"user.name",order:[{"critical.doc_count":"desc"},{"high.doc_count":"desc"},{"medium.doc_count":"desc"},{"low.doc_count":"desc"}]},aggs:{critical:{filter:{term:{"kibana.alert.severity":"critical"}}},high:{filter:{term:{"kibana.alert.severity":"high"}}},medium:{filter:{term:{"kibana.alert.severity":"medium"}}},low:{filter:{term:{"kibana.alert.severity":"low"}}},bucketOfPagination:{bucket_sort:{from:4*a,size:4}}}}}}),Jk="vulnerableUsersBySeverityQuery",Xk=r.a.memo((({signalIndexName:e})=>{const{openUserInTimeline:t}=Bk(),{toggleStatus:a,setToggleStatus:n}=Object(Ea.a)(Jk),{items:s,isLoading:o,updatedAt:l,pagination:c}=(({skip:e,queryId:t,signalIndexName:a})=>{const[n,r]=Object(i.useState)(Date.now()),[s,o]=Object(i.useState)([]),[l,c]=Object(i.useState)(Kk),{to:u,from:d,setQuery:p,deleteQuery:m}=Object(H.a)(),{setQuery:g,data:f,loading:b,request:h,response:y,refetch:E}=Object(w.a)({query:Yk({from:d,to:u,currentPage:l.currentPage}),indexName:a,skip:e});Object(i.useEffect)((()=>{g(Yk({from:d,to:u,currentPage:l.currentPage}))}),[g,d,u,l.currentPage]),Object(i.useEffect)((()=>{var e,t;null!=f&&f.aggregations?(o((null!==(t=null==(e=f.aggregations)?void 0:e.usersBySeverity.buckets)&&void 0!==t?t:[]).reduce(((e,t)=>(e.push({userName:t.key||"â",totalAlerts:t.doc_count,low:t.low.doc_count,medium:t.medium.doc_count,high:t.high.doc_count,critical:t.critical.doc_count}),e)),[])),c((e=>{var t;return{...e,pageCount:vk(null===(t=f.aggregations)||void 0===t?void 0:t.user_count.value)}}))):o([]),r(Date.now())}),[f]);const v=Object(i.useCallback)((()=>{!e&&E&&E()}),[e,E]);return Object(sr.b)({deleteQuery:m,inspect:{dsl:[h],response:[y]},refetch:v,setQuery:p,queryId:t,loading:b}),{items:s,isLoading:b,updatedAt:n,pagination:{...l,setPage:e=>{c((t=>({...t,currentPage:e})))}}}})({skip:!a,queryId:Jk,signalIndexName:e}),u=Object(i.useMemo)((()=>Zk(t)),[t]);return r.a.createElement(pr.a,{show:!0,targetClassNames:[ca.a]},r.a.createElement(N.EuiPanel,{hasBorder:!0,"data-test-subj":"severityUserAlertsPanel"},r.a.createElement(la.a,{id:Jk,title:YT,titleSize:"s",toggleStatus:a,toggleQuery:n,subtitle:r.a.createElement(Ek,{updatedAt:l,isUpdating:o}),tooltip:fk}),a&&r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiBasicTable,{"data-test-subj":"severityUserAlertsTable",columns:u,items:s,loading:o,noItemsMessage:r.a.createElement(N.EuiEmptyPrompt,{title:r.a.createElement("h3",null,XT),titleSize:"xs"})}),r.a.createElement(N.EuiSpacer,{size:"m"}),c.pageCount>1&&r.a.createElement(N.EuiTablePagination,{"data-test-subj":"userTablePaginator",activePage:c.currentPage,itemsPerPage:4,pageCount:c.pageCount,onChangePage:c.setPage,showPerPageOptions:!1}))))}));Xk.displayName="UserAlertsTable";const Zk=e=>[{field:"userName",name:lk,truncateText:!0,textOnly:!0,"data-test-subj":"userSeverityAlertsTable-userName",render:e=>r.a.createElement(ut.m,{userName:e})},{field:"totalAlerts",name:HT,"data-test-subj":"userSeverityAlertsTable-totalAlerts",render:(t,{userName:a})=>r.a.createElement(N.EuiLink,{disabled:0===t,onClick:()=>e({userName:a})},r.a.createElement(Tk.a,{count:t}))},{field:"critical",name:RT,render:(t,{userName:a})=>r.a.createElement(N.EuiHealth,{"data-test-subj":"userSeverityAlertsTable-critical",color:yk.critical},r.a.createElement(N.EuiLink,{disabled:0===t,onClick:()=>e({userName:a,severity:"critical"})},r.a.createElement(Tk.a,{count:t})))},{field:"high",name:_T,render:(t,{userName:a})=>r.a.createElement(N.EuiHealth,{"data-test-subj":"userSeverityAlertsTable-high",color:yk.high},r.a.createElement(N.EuiLink,{disabled:0===t,onClick:()=>e({userName:a,severity:"high"})},r.a.createElement(Tk.a,{count:t})))},{field:"medium",name:FT,render:(t,{userName:a})=>r.a.createElement(N.EuiHealth,{"data-test-subj":"userSeverityAlertsTable-medium",color:yk.medium},r.a.createElement(N.EuiLink,{disabled:0===t,onClick:()=>e({userName:a,severity:"medium"})},r.a.createElement(Tk.a,{count:t})))},{field:"low",name:LT,render:(t,{userName:a})=>r.a.createElement(N.EuiHealth,{"data-test-subj":"userSeverityAlertsTable-low",color:yk.low},r.a.createElement(N.EuiLink,{disabled:0===t,onClick:()=>e({userName:a,severity:"low"})},r.a.createElement(Tk.a,{count:t})))}];var ex=a(48);const tx={[ex.CaseStatuses.open]:{color:"primary",label:BT},[ex.CaseStatuses["in-progress"]]:{color:"warning",label:UT},[ex.CaseStatuses.closed]:{color:"default",label:zT}},ax=({status:e})=>r.a.createElement(N.EuiBadge,{color:tx[e].color,"data-test-subj":"case-status-badge"},tx[e].label);ax.displayName="StatusBadge";var nx=a(25);const ix="recentlyCreatedCasesQuery",rx=r.a.memo((()=>{const{getAppUrl:e,navigateTo:t}=Object(d.l)(),{toggleStatus:a,setToggleStatus:n}=Object(Ea.a)(ix),{items:s,isLoading:l,updatedAt:c}=(({skip:e})=>{const{services:{cases:t}}=Object(d.j)(),{to:a,from:n,setQuery:r,deleteQuery:s}=Object(H.a)(),[l,c]=Object(i.useState)(!0),[u,p]=Object(i.useState)(Date.now()),[m,g]=Object(i.useState)([]),f=Object(i.useMemo)((()=>`useCaseItems-${sa.a.v4()}`),[]);return Object(i.useEffect)((()=>{let i=!0;const l=new AbortController,u=async()=>{try{const e=await t.api.cases.find({from:n,to:a,owner:o.n,sortField:"create_at",sortOrder:"desc",page:1,perPage:4});i&&(g(function(e){return(e.cases||[]).reduce(((e,t)=>(e.push({id:t.id,name:t.title,totalAlerts:t.totalAlerts,createdAt:t.createdAt,createdBy:t.createdBy.username||"â",status:t.status}),e)),[])}(e)),p(Date.now()))}catch(e){i&&Object(nx.addError)(e,{title:mk})}c(!1)};return e||(u(),r({id:f,inspect:null,loading:!1,refetch:u})),e&&(c(!1),i=!1,l.abort()),()=>{i=!1,l.abort(),s({id:f})}}),[t.api.cases,n,e,a,r,s,f]),{items:m,isLoading:l,updatedAt:u}})({skip:!a}),u=Object(i.useCallback)((()=>{t({deepLinkId:T.a.case})}),[t]),p=Object(i.useMemo)((()=>sx({getAppUrl:e,navigateTo:t})),[e,t]);return r.a.createElement(pr.a,{show:!0,targetClassNames:[ca.a]},r.a.createElement(N.EuiPanel,{hasBorder:!0,"data-test-subj":"recentlyCreatedCasesPanel"},r.a.createElement(la.a,{id:ix,title:JT,titleSize:"s",toggleStatus:a,toggleQuery:n,subtitle:r.a.createElement(Ek,{updatedAt:c,isUpdating:l}),showInspectButton:!1}),a&&r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiBasicTable,{"data-test-subj":"recentlyCreatedCasesTable",columns:p,items:s,loading:l,noItemsMessage:r.a.createElement(N.EuiEmptyPrompt,{title:r.a.createElement("h3",null,ZT),titleSize:"xs"})}),r.a.createElement(N.EuiSpacer,{size:"m"}),r.a.createElement(N.EuiButton,{"data-test-subj":"allCasesButton",onClick:u},sk))))}));rx.displayName="CasesTable";const sx=()=>[{field:"id",name:ck,truncateText:!0,textOnly:!0,"data-test-subj":"recentlyCreatedCaseName",render:(e,{name:t})=>r.a.createElement(ut.a,{detailName:e},t)},{field:"totalAlerts",name:HT,truncateText:!0,textOnly:!0,"data-test-subj":"recentlyCreatedCaseAlert",render:e=>r.a.createElement(Tk.a,{count:e})},{field:"createdAt",name:uk,render:e=>r.a.createElement(wn.a,{fieldName:uk,value:e,className:"eui-textTruncate",dateFormat:"MMMM D, YYYY"}),"data-test-subj":"recentlyCreatedCaseTime"},{field:"createdBy",name:dk,render:e=>r.a.createElement(N.EuiText,{"data-test-subj":"recentlyCreatedCaseCreatedBy",size:"s"},e)},{field:"status",name:pk,render:e=>r.a.createElement(ax,{status:e}),"data-test-subj":"recentlyCreatedCaseStatus"}];var ox=a(273);const lx="casesByStatus",cx={series:{xScaleType:or.ScaleType.Ordinal,yScaleType:or.ScaleType.Linear,stackAccessors:["g"],barSeriesStyle:{rect:{widthPixel:22,opacity:1}}},axis:{xTickFormatter:e=>e.toLocaleString(),left:{style:{tickLine:{size:0},tickLabel:{padding:16,fontSize:14}}},bottom:{style:{tickLine:{size:0},tickLabel:{padding:16,fontSize:10.5}},labelFormat:e=>pe()(e).format("0")}},settings:{rotation:90},customHeight:146},ux=z()(N.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-1ovqqq4-0"})(["align-items:center;width:70%;"]),dx=z.a.div.withConfig({displayName:"Wrapper",componentId:"sc-1ovqqq4-1"})(["width:100%;"]),px=()=>{const{toggleStatus:e,setToggleStatus:t}=Object(Ea.a)(lx),{getAppUrl:a,navigateTo:n}=Object(d.l)(),{search:s}=Object(u.k)(o.cc.case),l=a({deepLinkId:o.cc.case,path:Object(ox.a)(s)}),c=Object(i.useCallback)((e=>{e.preventDefault(),n({url:l})}),[l,n]),{closed:p,inProgress:m,isLoading:g,open:f,totalCounts:b,updatedAt:h}=(({skip:e=!1})=>{var t,a,n,r,s,l;const{services:{cases:c}}=Object(d.j)(),{to:u,from:p,setQuery:m,deleteQuery:g}=Object(H.a)(),f=Object(i.useMemo)((()=>`useCaseItems-${sa.a.v4()}`),[]),[b,h]=Object(i.useState)(Date.now()),[y,E]=Object(i.useState)(!0),[v,T]=Object(i.useState)(null);return Object(i.useEffect)((()=>{let t=!0;const a=new AbortController,n=async()=>{try{const e=await c.api.cases.getCasesStatus({from:p,to:u,owner:o.n},a.signal);t&&T(e)}catch(e){t&&T(null)}t&&(E(!1),h(Date.now()))};return e||(n(),m({id:f,inspect:null,loading:!1,refetch:n})),e&&(E(!1),t=!1,a.abort()),()=>{t=!1,a.abort(),g({id:f})}}),[c.api.cases,p,e,u,m,g,f]),{closed:null!==(t=null==v?void 0:v.countClosedCases)&&void 0!==t?t:0,inProgress:null!==(a=null==v?void 0:v.countInProgressCases)&&void 0!==a?a:0,isLoading:y,open:null!==(n=null==v?void 0:v.countOpenCases)&&void 0!==n?n:0,totalCounts:(null!==(r=null==v?void 0:v.countClosedCases)&&void 0!==r?r:0)+(null!==(s=null==v?void 0:v.countInProgressCases)&&void 0!==s?s:0)+(null!==(l=null==v?void 0:v.countOpenCases)&&void 0!==l?l:0),updatedAt:b}})({skip:!e}),y=Object(i.useMemo)((()=>[{key:"open",value:[{y:f,x:BT,g:BT}],color:"#79aad9"},{key:"in-progress",value:[{y:m,x:UT,g:UT}],color:"#f1d86f"},{key:"closed",value:[{y:p,x:zT,g:zT}],color:"#d3dae6"}]),[p,m,f]);return r.a.createElement(N.EuiPanel,{hasBorder:!0},r.a.createElement(la.a,{id:lx,title:QT,titleSize:"s",toggleStatus:e,toggleQuery:t,subtitle:r.a.createElement(Ek,{updatedAt:h,isUpdating:g}),showInspectButton:!1},r.a.createElement(N.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(ut.g,{href:l,onClick:c},WT)))),!g&&e&&r.a.createElement(N.EuiFlexGroup,{justifyContent:"center",alignItems:"center",direction:"column",gutterSize:"s"},r.a.createElement(N.EuiFlexItem,null,0!==b&&r.a.createElement(N.EuiText,{className:"eui-textCenter",size:"s",grow:!1},r.a.createElement(r.a.Fragment,null,r.a.createElement("b",null,r.a.createElement(It.FormattedNumber,{value:b}))," ",r.a.createElement("span",null," ",(E=b,F.i18n.translate("xpack.securitySolution.detectionResponse.casesByStatus.totalCases",{values:{totalCases:E},defaultMessage:"total {totalCases, plural, =1 {case} other {cases}}"})))))),r.a.createElement(ux,{grow:!1},r.a.createElement(dx,{"data-test-subj":"chart-wrapper"},r.a.createElement(Er.a,{configs:cx,barChart:y})))));var E},mx=r.a.memo(px),gx=()=>{const{docLinks:e}=Object(d.j)().services,t=Object(i.useMemo)((()=>({feature:{icon:"documents",label:mE.c,url:`${e.links.siem.privileges}`,target:"_blank"}})),[e]);return r.a.createElement(Fe.a,{"data-test-subj":"noPermissionPage",actions:t,title:mE.f,message:mE.e})},fx=()=>{var e;const{indicesExist:t,indexPattern:a,loading:n}=Object(m.d)(),{signalIndexName:i}=Object(OT.a)(),{hasKibanaREAD:s,hasIndexRead:o}=Object(ja.a)(),l=null===(e=Object(d.h)())||void 0===e?void 0:e.read,c=s&&o;return c||l?r.a.createElement(r.a.Fragment,null,t?r.a.createElement(r.a.Fragment,null,r.a.createElement(b.a,{"data-test-subj":"detectionResponsePage"},r.a.createElement(Ta.a,{title:mE.b},r.a.createElement(Q.a,{id:"global",indexPattern:a,hideFilterBar:!0,hideQueryInput:!0})),n?r.a.createElement(N.EuiLoadingSpinner,{size:"l","data-test-subj":"detectionResponseLoader"}):r.a.createElement(N.EuiFlexGroup,{direction:"column","data-test-subj":"detectionResponseSections"},r.a.createElement(N.EuiFlexItem,null,r.a.createElement(N.EuiFlexGroup,null,c&&r.a.createElement(N.EuiFlexItem,null,r.a.createElement(Fk,{signalIndexName:i})),l&&r.a.createElement(N.EuiFlexItem,null,r.a.createElement(mx,null)))),c&&r.a.createElement(N.EuiFlexItem,null,r.a.createElement(Gk,{signalIndexName:i})),l&&r.a.createElement(N.EuiFlexItem,null,r.a.createElement(rx,null)),c&&r.a.createElement(N.EuiFlexItem,null,r.a.createElement(N.EuiFlexGroup,null,r.a.createElement(N.EuiFlexItem,null,r.a.createElement($k,{signalIndexName:i})),r.a.createElement(N.EuiFlexItem,null,r.a.createElement(Xk,{signalIndexName:i}))))))):r.a.createElement(ka.a,null),r.a.createElement(y.a,{pageName:T.a.detectionAndResponse})):r.a.createElement(gx,null)},bx=r.a.memo(fx),hx=[{path:o.Ob,render:()=>r.a.createElement(s.TrackApplicationView,{viewId:o.cc.overview},r.a.createElement(ST,null))},{path:o.qb,render:()=>r.a.createElement(s.TrackApplicationView,{viewId:o.cc.detectionAndResponse},r.a.createElement(bx,null))},{path:o.Db,render:()=>r.a.createElement(s.TrackApplicationView,{viewId:o.cc.landing},r.a.createElement(pE,null))}],yx=F.i18n.translate("xpack.securitySolution.rules.badge.readOnly.tooltip",{defaultMessage:"Unable to create, edit or delete rules"}),Ex=F.i18n.translate("xpack.securitySolution.detectionEngine.mlJobUpgradeModal.messageTitle",{defaultMessage:"ML rule updates may override your existing rules"}),vx=F.i18n.translate("xpack.securitySolution.detectionEngine.mlJobUpgradeModal.cancelTitle",{defaultMessage:"Cancel"}),Tx=F.i18n.translate("xpack.securitySolution.detectionEngine.mlJobUpgradeModal.confirmTitle",{defaultMessage:"Load rules"}),kx=F.i18n.translate("xpack.securitySolution.detectionEngine.mlJobUpgradeModal.affectedJobsTitle",{defaultMessage:"Affected jobs:"}),xx=()=>r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.mlJobUpgradeModal.messageBody",defaultMessage:"{summary} Documentation: {docs}",values:{summary:r.a.createElement("p",null,r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.mlJobUpgradeModal.messageBody.summary",defaultMessage:"New V3 machine learning jobs have been released, and the latest corresponding prebuilt detection rules now use these new ML jobs. You're currently running one or more V1/V2 jobs, which only work with legacy prebuilt rules. To ensure continued coverage using V1/V2 jobs, you may need to duplicate or create new rules before updating your Elastic prebuilt detection rules. Check the documentation below for instructions on how to keep using the V1/V2 jobs, and how to start using the new V3 jobs."})),docs:r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(Nt,null)))}}),Sx=z.a.ul.withConfig({displayName:"JobsUL",componentId:"sc-yxot17-0"})(["max-height:200px;overflow-y:auto;&::-webkit-scrollbar{height:",";width:",";}&::-webkit-scrollbar-thumb{background-clip:content-box;background-color:",";border:"," solid transparent;}&::-webkit-scrollbar-corner,&::-webkit-scrollbar-track{background-color:transparent;}"],(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>Object(jn.rgba)(e.eui.euiColorDarkShade,.5)),(({theme:e})=>e.eui.euiScrollBarCorner)),Ox=({jobs:e,onCancel:t,onConfirm:a})=>r.a.createElement(N.EuiConfirmModal,{title:Ex,onCancel:t,onConfirm:a,cancelButtonText:vx,confirmButtonText:Tx,buttonColor:"danger",defaultFocusedButton:"confirm"},r.a.createElement(xx,null),kx,r.a.createElement(Sx,null,e.map((e=>r.a.createElement("li",{key:e.id},e.id))))),wx=Object(i.memo)(Ox),jx=["v2_rare_process_by_host_linux_ecs","v2_linux_rare_metadata_user","v2_linux_rare_metadata_process","v2_linux_anomalous_user_name_ecs","v2_linux_anomalous_process_all_hosts_ecs","v2_linux_anomalous_network_port_activity_ecs","v2_rare_process_by_host_windows_ecs","v2_windows_anomalous_network_activity_ecs","v2_windows_anomalous_path_activity_ecs","v2_windows_anomalous_process_all_hosts_ecs","v2_windows_anomalous_process_creation","v2_windows_anomalous_user_name_ecs","v2_windows_rare_metadata_process","v2_windows_rare_metadata_user","rare_process_by_host_linux_ecs","linux_anomalous_network_activity_ecs","linux_anomalous_network_port_activity_ecs","linux_anomalous_network_service","linux_anomalous_network_url_activity_ecs","linux_anomalous_process_all_hosts_ecs","linux_anomalous_user_name_ecs","linux_rare_metadata_process","linux_rare_metadata_user","linux_rare_user_compiler","linux_rare_kernel_module_arguments","linux_rare_sudo_user","linux_system_user_discovery","linux_system_information_discovery","linux_system_process_discovery","linux_network_connection_discovery","linux_network_configuration_discovery","rare_process_by_host_windows_ecs","windows_anomalous_network_activity_ecs","windows_anomalous_path_activity_ecs","windows_anomalous_process_all_hosts_ecs","windows_anomalous_process_creation","windows_anomalous_script","windows_anomalous_service","windows_anomalous_user_name_ecs","windows_rare_user_runas_event","windows_rare_metadata_process","windows_rare_metadata_user","windows_rare_user_type10_remote_login"];var Cx=a(432);const Ix=z.a.div.withConfig({displayName:"ToolbarLayout",componentId:"sc-51u63m-0"})(["display:grid;grid-template-columns:1fr auto;align-items:center;grid-gap:16px;box-shadow:inset 0 -1px 0 ",";"],(({theme:e})=>e.eui.euiBorderColor));let Mx;!function(e){e.rules="rules",e.monitoring="monitoring"}(Mx||(Mx={}));const Ax=[{id:Mx.rules,name:nn.qc,disabled:!1},{id:Mx.monitoring,name:nn.Hb,disabled:!1}],Dx=r.a.memo((({onTabChange:e,activeTab:t})=>{const{state:{isInMemorySorting:a},actions:{setIsInMemorySorting:n}}=kn(),{startTransaction:s}=Vu(),o=Object(i.useCallback)((e=>{s({name:a?Hu:Uu}),n(e.target.checked)}),[a,n,s]);return r.a.createElement(Ix,null,r.a.createElement(N.EuiTabs,null,Ax.map((a=>r.a.createElement(N.EuiTab,{"data-test-subj":`allRulesTableTab-${a.id}`,onClick:()=>e(a.id),isSelected:a.id===t,disabled:a.disabled,key:a.id},a.name)))),r.a.createElement(N.EuiToolTip,{content:nn.xb},r.a.createElement(N.EuiSwitch,{"data-test-subj":a?"allRulesTableTechnicalPreviewOff":"allRulesTableTechnicalPreviewOn",label:a?nn.zb:nn.yb,checked:a,onChange:o})))}));Dx.displayName="RulesTableToolbar";const qx=(e=!1)=>{const[t,a]=Object(i.useState)(e);return[t,Object(i.useCallback)((()=>{a(!0)}),[]),Object(i.useCallback)((()=>{a(!1)}),[]),Object(i.useCallback)((()=>{a((e=>!e))}),[])]},Px=F.i18n.translate("xpack.securitySolution.detectionEngine.rules.prePackagedRules.emptyPromptTitle",{defaultMessage:"Load Elastic prebuilt detection rules"}),Rx=F.i18n.translate("xpack.securitySolution.detectionEngine.rules.prePackagedRules.emptyPromptMessage",{defaultMessage:"Elastic Security comes with prebuilt detection rules that run in the background and create alerts when their conditions are met. By default, all prebuilt rules except the Endpoint Security rule are disabled. You can select additional rules you want to enable."}),_x=F.i18n.translate("xpack.securitySolution.detectionEngine.rules.prePackagedRules.createOwnRuletButton",{defaultMessage:"Create your own rules"}),Fx=F.i18n.translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedRulesTitle",{defaultMessage:"Update available for Elastic prebuilt rules or timeline templates"}),Lx=e=>F.i18n.translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedRulesMsg",{values:{updateRules:e},defaultMessage:"You can update {updateRules} Elastic prebuilt {updateRules, plural, =1 {rule} other {rules}}"}),Nx=(e,t)=>F.i18n.translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedRulesAndTimelinesMsg",{values:{updateRules:e,updateTimelines:t},defaultMessage:"You can update {updateRules} Elastic prebuilt {updateRules, plural, =1 {rule} other {rules}} and {updateTimelines} Elastic prebuilt {updateTimelines, plural, =1 {timeline} other {timelines}}. Note that this will reload deleted Elastic prebuilt rules."}),Bx=e=>F.i18n.translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedRulesButton",{values:{updateRules:e},defaultMessage:"Update {updateRules} Elastic prebuilt {updateRules, plural, =1 {rule} other {rules}}"}),zx=e=>F.i18n.translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedTimelinesButton",{values:{updateTimelines:e},defaultMessage:"Update {updateTimelines} Elastic prebuilt {updateTimelines, plural, =1 {timeline} other {timelines}}"}),Ux=(e,t)=>F.i18n.translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedRulesAndTimelinesButton",{values:{updateRules:e,updateTimelines:t},defaultMessage:"Update {updateRules} Elastic prebuilt {updateRules, plural, =1 {rule} other {rules}} and {updateTimelines} Elastic prebuilt {updateTimelines, plural, =1 {timeline} other {timelines}}"}),Hx=F.i18n.translate("xpack.securitySolution.detectionEngine.rules.releaseNotesHelp",{defaultMessage:"Release notes"}),$x=z()(N.EuiEmptyPrompt).withConfig({displayName:"EmptyPrompt",componentId:"sc-1rs1rob-0"})(["align-self:center;"]);$x.displayName="EmptyPrompt";const Vx=({createPrePackagedRules:e,loading:t=!1,userHasPermissions:a=!1})=>{const[{isSignalIndexExists:n,isAuthenticated:s,hasEncryptionKey:o,canUserCRUD:l,hasIndexWrite:c}]=Object(_e.b)(),{loading:u,jobs:d}=Object(Cx.a)(),p=d.filter((e=>jx.includes(e.id))),[m,g]=Object(i.useState)(!1),{getLoadPrebuiltRulesAndTemplatesButton:f}=tp({canUserCRUD:l,hasIndexWrite:c,isSignalIndexExists:n,isAuthenticated:s,hasEncryptionKey:o}),b=Object(i.useCallback)((()=>{g(!1),e()}),[e,g]),h=Object(i.useMemo)((()=>f({isDisabled:!a||t||u,onClick:()=>{p.length>0?g(!0):e()},fill:!0,"data-test-subj":"load-prebuilt-rules"})),[f,a,t,u,p,e]);return r.a.createElement($x,{"data-test-subj":"rulesEmptyPrompt",title:r.a.createElement("h2",null,Px),body:r.a.createElement("p",null,Rx),actions:r.a.createElement(N.EuiFlexGroup,{justifyContent:"center"},r.a.createElement(N.EuiFlexItem,{grow:!1},h),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(ut.l,{isDisabled:!a,iconType:"plusInCircle",deepLinkId:T.a.rulesCreate},_x)),m&&r.a.createElement(wx,{jobs:p,onCancel:()=>g(!1),onConfirm:b}))})},Qx=Object(i.memo)(Vx),Wx=({onInit:e,onFinish:t})=>{const a=Object(i.useRef)(),n=Object(i.useCallback)((()=>{var e;null===(e=a.current)||void 0===e||e.call(a,!0)}),[]),r=Object(i.useCallback)((()=>{var e;null===(e=a.current)||void 0===e||e.call(a,!1)}),[]);return[Object(i.useCallback)((()=>(e(),new Promise((e=>{a.current=e})).finally((()=>{t()})))),[e,t]),n,r]};var Gx=a(679);const Kx=z.a.div.withConfig({displayName:"PopoverContentWrapper",componentId:"sc-1c6dnvx-0"})(["width:275px;"]),Yx=z.a.div.withConfig({displayName:"ScrollableDiv",componentId:"sc-1c6dnvx-1"})(["max-height:250px;overflow-y:auto;"]),Jx=z.a.span.withConfig({displayName:"TagOverflowContainer",componentId:"sc-1c6dnvx-2"})(["overflow:hidden;text-overflow:ellipsis;white-space:nowrap;"]),Xx=({tags:e,selectedTags:t,onSelectedTagsChanged:a})=>{const n=Object(i.useMemo)((()=>qn(Array.from(new Set([...e,...t])))),[t,e]),[s,o]=Object(i.useState)(!1),[l,c]=Object(i.useState)(""),[u,d]=Object(i.useState)(n),p=Object(i.useMemo)((()=>u.map(((e,n)=>r.a.createElement(N.EuiFilterSelectItem,{checked:t.includes(e)?"on":void 0,key:`${n}-${e}`,onClick:()=>Object(Gx.a)(e,t,a),title:e},r.a.createElement(Jx,null,e))))),[a,t,u]),m=Object(i.useCallback)((e=>{c(e.target.value)}),[]);return Object(i.useEffect)((()=>{d(n.filter((e=>e.toLowerCase().includes(l.toLowerCase()))))}),[n,l]),r.a.createElement(N.EuiPopover,{ownFocus:!0,button:r.a.createElement(N.EuiFilterButton,{grow:!0,"data-test-subj":"tags-filter-popover-button",iconType:"arrowDown",onClick:()=>o(!s),numFilters:e.length,isSelected:s,hasActiveFilters:t.length>0,numActiveFilters:t.length},nn.Cc),isOpen:s,closePopover:()=>o(!s),panelPaddingSize:"none",repositionOnScroll:!0},r.a.createElement(Kx,null,r.a.createElement(N.EuiPopoverTitle,null,r.a.createElement(N.EuiFieldSearch,{placeholder:"Search tags",value:l,onChange:m,isClearable:!0,"aria-label":"Rules tag search"})),r.a.createElement(Yx,null,p),0===u.length&&r.a.createElement(N.EuiFlexGroup,{gutterSize:"m",justifyContent:"spaceAround"},r.a.createElement(N.EuiFlexItem,{grow:!0},r.a.createElement(N.EuiPanel,null,r.a.createElement(N.EuiText,null,nn.Kb))))))};Xx.displayName="TagsFilterPopoverComponent";const Zx=r.a.memo(Xx);Zx.displayName="TagsFilterPopover";const eS=z()(N.EuiFlexGroup).withConfig({displayName:"FilterWrapper",componentId:"sc-16jvv68-0"})(["margin-bottom:",";"],(({theme:e})=>e.eui.euiSizeXS)),tS=z()(N.EuiFlexItem).withConfig({displayName:"SearchBarWrapper",componentId:"sc-16jvv68-1"})(["& .euiPopover,& .euiPopover__anchor{display:block;}"]),aS=({rulesCustomInstalled:e,rulesInstalled:t,allTags:a})=>{const{startTransaction:n}=Vu(),{state:{filterOptions:s},actions:{setFilterOptions:o}}=kn(),{showCustomRules:l,showElasticRules:c,tags:u}=s,d=Object(i.useCallback)((e=>{n({name:Bu}),o({filter:e.trim()})}),[o,n]),p=Object(i.useCallback)((()=>{n({name:Bu}),o({showElasticRules:!c,showCustomRules:!1})}),[o,c,n]),m=Object(i.useCallback)((()=>{n({name:Bu}),o({showCustomRules:!l,showElasticRules:!1})}),[o,l,n]),g=Object(i.useCallback)((e=>{Object(E.isEqual)(e,u)||(n({name:Bu}),o({tags:e}))}),[u,o,n]);return r.a.createElement(eS,{gutterSize:"m",justifyContent:"flexEnd"},r.a.createElement(tS,{grow:!0},r.a.createElement(N.EuiFieldSearch,{"aria-label":nn.vc,fullWidth:!0,incremental:!1,placeholder:nn.uc,onSearch:d})),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiFilterGroup,null,r.a.createElement(Zx,{onSelectedTagsChanged:g,selectedTags:u,tags:a,"data-test-subj":"allRulesTagPopover"}))),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiFilterGroup,null,r.a.createElement(N.EuiFilterButton,{hasActiveFilters:c,onClick:p,"data-test-subj":"showElasticRulesFilterButton",withNext:!0},nn.wb,null!=t?` (${t})`:""),r.a.createElement(N.EuiFilterButton,{hasActiveFilters:l,onClick:m,"data-test-subj":"showCustomRulesFilterButton"},nn.jb,null!=e?` (${e})`:""))))};aS.displayName="RulesTableFiltersComponent";const nS=r.a.memo(aS);nS.displayName="RulesTableFilters";const iS="customRulesCount",rS=({onCancel:e,onConfirm:t,customRulesCount:a,elasticRulesCount:n})=>(Object(i.useEffect)((()=>{0===n&&setTimeout(t,0)}),[n,t]),0===n?null:0===a?r.a.createElement(N.EuiConfirmModal,{title:nn.w(n),onCancel:e,onConfirm:e,confirmButtonText:nn.u,defaultFocusedButton:"confirm","data-test-subj":"bulkEditRejectModal"},r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkEditRejectionDescription",defaultMessage:"Elastic rules are not modifiable. The update action will only be applied to Custom rules."})):r.a.createElement(N.EuiConfirmModal,{title:nn.w(n),onCancel:e,onConfirm:t,confirmButtonText:nn.v,cancelButtonText:nn.u,defaultFocusedButton:"confirm","data-test-subj":"bulkEditConfirmationModal"},r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkEditConfirmationDescription",defaultMessage:"The update action will only be applied to {customRulesCount, plural, =1 {# Custom rule} other {# Custom rules}} you've selected.",values:{customRulesCount:a}}))),sS=r.a.memo(rS);sS.displayName="BulkEditConfirmation";var oS=a(217);const lS=({form:e,title:t,banner:a,children:n,onClose:i,onSubmit:s})=>{const o=Object(N.useGeneratedHtmlId)({prefix:"RulesBulkEditForm"}),{isValid:l}=e;return r.a.createElement(N.EuiFlyout,{ownFocus:!0,onClose:i,"aria-labelledby":o,size:"s"},r.a.createElement(N.EuiFlyoutHeader,{hasBorder:!0},r.a.createElement(N.EuiTitle,{size:"m","data-test-subj":"rulesBulkEditFormTitle"},r.a.createElement("h2",{id:o},t))),r.a.createElement(N.EuiFlyoutBody,{banner:a},r.a.createElement(oS.c,{form:e},n)),r.a.createElement(N.EuiFlyoutFooter,null,r.a.createElement(N.EuiFlexGroup,{justifyContent:"spaceBetween"},r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiButtonEmpty,{onClick:i,flush:"left","data-test-subj":"rulesBulkEditFormCancelBtn"},nn.G)),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiButton,{onClick:s,fill:!0,disabled:!1===l,"data-test-subj":"rulesBulkEditFormSaveBtn"},nn.N)))))},cS=r.a.memo(lS);cS.displayName="BulkEditFormWrapper";const uS=Object(oS.j)({component:oS.b}),dS={index:{fieldsToValidateOnChange:["index"],type:oS.a.COMBO_BOX,validations:[{validator:oS.h.emptyField(nn.A)}]},overwrite:{type:oS.a.CHECKBOX,label:nn.z}},pS={index:[],overwrite:!1},mS=({editAction:e,rulesCount:t,onClose:a,onConfirm:n})=>{const{form:i}=Object(oS.k)({defaultValue:pS,schema:dS}),{indexHelpText:s,indexLabel:l,formTitle:c}=(e=>e===Ou.b.add_index_patterns?{indexLabel:nn.y,indexHelpText:nn.x,formTitle:nn.B}:{indexLabel:nn.I,indexHelpText:nn.H,formTitle:nn.J})(e),[{overwrite:u}]=Object(oS.m)({form:i,watch:["overwrite"]}),{uiSettings:p}=Object(d.j)().services,m=p.get(o.N);return r.a.createElement(cS,{form:i,onClose:a,onSubmit:async()=>{const{data:t,isValid:a}=await i.submit();if(!a)return;const r={value:t.index,type:t.overwrite?Ou.b.set_index_patterns:e};n(r)},title:c},r.a.createElement(uS,{path:"index",config:{...dS.index,label:l,helpText:s},componentProps:{idAria:"bulkEditRulesIndexPatterns","data-test-subj":"bulkEditRulesIndexPatterns",euiFieldProps:{fullWidth:!0,placeholder:"",noSuggestions:!1,options:m.map((e=>({label:e})))}}}),e===Ou.b.add_index_patterns&&r.a.createElement(uS,{path:"overwrite",componentProps:{idAria:"bulkEditRulesOverwriteIndexPatterns","data-test-subj":"bulkEditRulesOverwriteIndexPatterns"}}),u&&r.a.createElement(N.EuiFormRow,null,r.a.createElement(N.EuiCallOut,{color:"warning",size:"s","data-test-subj":"bulkEditRulesIndexPatternsWarning"},r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.setIndexPatternsWarningCallout",defaultMessage:"Youâre about to overwrite index patterns for {rulesCount, plural, one {# selected rule} other {# selected rules}}, press Save to apply changes.",values:{rulesCount:t}}))))},gS=r.a.memo(mS);gS.displayName="IndexPatternsForm";const fS=Object(oS.j)({component:oS.b}),bS={tags:{fieldsToValidateOnChange:["tags"],type:oS.a.COMBO_BOX,validations:[{validator:oS.h.emptyField(nn.O)}]},overwrite:{type:oS.a.CHECKBOX,label:nn.E}},hS={tags:[],overwrite:!1},yS=({editAction:e,rulesCount:t,onClose:a,onConfirm:n,tags:s})=>{const{form:o}=Object(oS.k)({defaultValue:hS,schema:bS}),[{overwrite:l}]=Object(oS.m)({form:o,watch:["overwrite"]}),c=Object(i.useMemo)((()=>qn(s)),[s]),{tagsLabel:u,tagsHelpText:d,formTitle:p}=(e=>e===Ou.b.add_tags?{tagsLabel:nn.D,tagsHelpText:nn.C,formTitle:nn.F}:{tagsLabel:nn.L,tagsHelpText:nn.K,formTitle:nn.M})(e);return r.a.createElement(cS,{form:o,onClose:a,onSubmit:async()=>{const{data:t,isValid:a}=await o.submit();if(!a)return;const i={value:t.tags,type:t.overwrite?Ou.b.set_tags:e};n(i)},title:p},r.a.createElement(fS,{path:"tags",config:{...bS.tags,label:u,helpText:d},componentProps:{idAria:"bulkEditRulesTags","data-test-subj":"bulkEditRulesTags",euiFieldProps:{fullWidth:!0,placeholder:"",noSuggestions:!1,options:c.map((e=>({label:e})))}}}),e===Ou.b.add_tags?r.a.createElement(fS,{path:"overwrite",componentProps:{idAria:"bulkEditRulesOverwriteTags","data-test-subj":"bulkEditRulesOverwriteTags"}}):null,l&&r.a.createElement(N.EuiFormRow,null,r.a.createElement(N.EuiCallOut,{color:"warning",size:"s","data-test-subj":"bulkEditRulesTagsWarning"},r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.setTagsWarningCallout",defaultMessage:"Youâre about to overwrite tags for {rulesCount, plural, one {# selected rule} other {# selected rules}}, press Save to apply changes.",values:{rulesCount:t}}))))},ES=r.a.memo(yS);ES.displayName="TagsForm";var vS=a(710),TS=a(338);const kS=z()(N.EuiFieldText).withConfig({displayName:"StyledEuiFieldText",componentId:"sc-oqcycb-0"})(["padding-left:12px;padding-right:40px;&[readonly]{cursor:pointer;background-size:0 100%;background-repeat:no-repeat;&:focus{background-color:#fff;background-image:linear-gradient( to top,#006bb4,#006bb4 2px,transparent 2px,transparent 100% );background-size:100% 100%;}}& + .euiFormControlLayoutIcons{left:unset;right:12px;}"]),xS=e=>[{description:TS.a,favorite:[],label:TS.b,id:void 0,title:TS.b,checked:"-1"===e?"on":void 0}],SS=({isDisabled:e,hideUntitled:t=!1,timelineId:a,timelineTitle:n,timelineType:s=c.m.template,onTimelineChange:o})=>{const[l,u]=Object(i.useState)(!1),d=Object(i.useCallback)((()=>{u(!1)}),[]),p=Object(i.useCallback)((()=>{u(!0)}),[]),m=Object(i.useMemo)((()=>r.a.createElement(kS,{readOnly:!0,disabled:e,onFocus:p,value:null!=n?n:TS.b,icon:"arrowDown"})),[p,e,n]),g=Object(i.useCallback)((({timelines:e,onlyFavorites:n,searchTimelineValue:i})=>[...n||""!==i?[]:xS(null==a?"-1":a),...e.filter((e=>!t||""!==e.title)).map(((e,t)=>({description:e.description,favorite:e.favorite,label:e.title,id:s===c.m.template?e.templateTimelineId:e.savedObjectId,key:`${e.title}-${t}`,title:e.title,checked:[e.savedObjectId,e.templateTimelineId].includes(a)?"on":void 0})))]),[t,a,s]);return r.a.createElement(N.EuiInputPopover,{id:"searchTimelinePopover",input:m,isOpen:l,closePopover:d},r.a.createElement(vS.a,{hideUntitled:t,getSelectableOptions:g,onClosePopover:d,onTimelineChange:o,timelineType:s}))},OS=Object(i.memo)(SS),wS=({dataTestSubj:e,field:t,idAria:a,isDisabled:n=!1})=>{const[s,o]=Object(i.useState)(null),[l,c]=Object(i.useState)(null),{isInvalid:u,errorMessage:d}=Object(oS.i)(t);Object(i.useEffect)((()=>{const{id:e,title:a}=t.value;l!==a&&s!==e&&(o(e),c(a))}),[t.value]);const p=Object(i.useCallback)(((e,a)=>{null===a?t.setValue({id:a,title:null}):l!==e&&s!==a&&t.setValue({id:a,title:e})}),[t]);return r.a.createElement(N.EuiFormRow,{label:t.label,labelAppend:t.labelAppend,helpText:t.helpText,error:d,isInvalid:u,"data-test-subj":e,describedByIds:a?[a]:void 0},r.a.createElement(OS,{isDisabled:n,hideUntitled:!0,timelineId:s,timelineTitle:l,onTimelineChange:p}))},jS={FORM_TITLE:F.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.applyTimelineTemplate.formTitle",{defaultMessage:"Apply Timeline template"}),TEMPLATE_SELECTOR_LABEL:F.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.applyTimelineTemplate.templateSelectorLabel",{defaultMessage:"Apply Timeline template to selected rules"}),TEMPLATE_SELECTOR_HELP_TEXT:F.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.applyTimelineTemplate.templateSelectorHelpText",{defaultMessage:"Select which Timeline to apply to selected rules when investigating generated alerts."}),TEMPLATE_SELECTOR_DEFAULT_VALUE:F.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.applyTimelineTemplate.templateSelectorDefaultValue",{defaultMessage:"None"}),warningCalloutMessage:e=>r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.applyTimelineTemplate.warningCalloutMessage",defaultMessage:"You're about to apply changes to {rulesCount, plural, one {# selected rule} other {# selected rules}}. If you previously applied Timeline templates to these rules, they will be overwritten or (if you select 'None') reset to none.",values:{rulesCount:e}})},CS={timeline:{label:jS.TEMPLATE_SELECTOR_LABEL,helpText:jS.TEMPLATE_SELECTOR_HELP_TEXT}},IS={timeline:{id:null,title:jS.TEMPLATE_SELECTOR_DEFAULT_VALUE}},MS=e=>{const{rulesCount:t,onClose:a,onConfirm:n}=e,{form:s}=Object(oS.k)({schema:CS,defaultValue:IS}),o=Object(i.useCallback)((async()=>{const{data:e,isValid:t}=await s.submit();if(!t)return;const a=e.timeline.id||"",i=a?e.timeline.title:"";n({type:Ou.b.set_timeline,value:{timeline_id:a,timeline_title:i}})}),[s,n]),l=r.a.createElement(N.EuiCallOut,{color:"warning","data-test-subj":"bulkEditRulesTimelineTemplateWarning"},jS.warningCalloutMessage(t));return r.a.createElement(cS,{form:s,title:jS.FORM_TITLE,banner:l,onClose:a,onSubmit:o},r.a.createElement(oS.e,{path:"timeline",component:wS,componentProps:{idAria:"bulkEditRulesTimelineTemplateSelector",dataTestSubj:"bulkEditRulesTimelineTemplateSelector"}}))},AS=r.a.memo(MS);AS.displayName="TimelineTemplateForm";const DS=({editAction:e,tags:t,...a})=>{switch(e){case Ou.b.add_index_patterns:case Ou.b.delete_index_patterns:case Ou.b.set_index_patterns:return r.a.createElement(gS,rr()({},a,{editAction:e}));case Ou.b.add_tags:case Ou.b.delete_tags:case Ou.b.set_tags:return r.a.createElement(ES,rr()({},a,{editAction:e,tags:t}));case Ou.b.set_timeline:return r.a.createElement(AS,a);default:return null}},qS=r.a.memo(DS);qS.displayName="BulkEditFlyout";var PS=a(186),RS=a(725);const _S=r.a.createElement(N.EuiEmptyPrompt,{title:r.a.createElement("h3",null,nn.Ib),titleSize:"xs",body:nn.Jb}),FS=r.a.memo((({createPrePackagedRules:e,hasPermissions:t,loadingCreatePrePackagedRules:a,rulesCustomInstalled:n,rulesInstalled:s,rulesNotInstalled:l,rulesNotUpdated:c,selectedTab:u})=>{var p,m;const{startTransaction:g}=Vu(),f=Object(i.useRef)(null),b=kn(),{state:{rules:h,filterOptions:y,isActionInProgress:v,isAllSelected:T,isFetched:k,isLoading:x,isRefetching:S,isRefreshOn:O,loadingRuleIds:w,loadingRulesAction:j,pagination:C,selectedRuleIds:I,sortingOptions:M},actions:{reFetchRules:A,setIsAllSelected:D,setIsRefreshOn:q,setPage:P,setPerPage:R,setSelectedRuleIds:_,setSortingOptions:L}}=b,B=fi(s,l,c),[,z,U]=(()=>{const[e,t]=Object(i.useState)([]),[a,n]=Object(i.useState)(!0),r=Object(i.useRef)(E.noop),{addError:s}=Object(X.a)();return Object(i.useEffect)((()=>{let e=!0;const a=new AbortController,i=async()=>{n(!0);try{const n=await Object(cn.g)({signal:a.signal});e&&t(n)}catch(t){e&&s(t,{title:un.m})}e&&n(!1)};return i(),r.current=i,()=>{e=!1,a.abort()}}),[s]),[a,e,r.current]})();Object(i.useEffect)((()=>{U()}),[n,s]);const[H,$,V]=qx(),[Q,W,G]=Wx({onInit:$,onFinish:V}),[K,Y,J]=qx(),[Z,ee,te]=Wx({onInit:Y,onFinish:J}),{customRulesCount:ae,isCustomRulesCountLoading:ne}=(({filterOptions:e,enabled:t})=>{var a;const{data:n,isFetching:i}=Object(ln.useQuery)([iS],(async({signal:t})=>({customRulesCount:(await Object(cn.f)({pagination:{perPage:1,page:1},filterOptions:{...e,showCustomRules:!0},signal:t})).total})),{enabled:t});return{customRulesCount:null!==(a=null==n?void 0:n.customRulesCount)&&void 0!==a?a:0,isCustomRulesCountLoading:i}})({enabled:K&&T,filterOptions:y}),{bulkEditActionType:ie,isBulkEditFlyoutVisible:re,handleBulkEditFormConfirm:se,handleBulkEditFormCancel:oe,completeBulkEditForm:le}=(()=>{const e=Object(i.useRef)(null),[t,a]=Object(i.useState)(),[n,r,s]=qx(),[o,l,c]=Wx({onInit:r,onFinish:s}),u=Object(i.useCallback)((async t=>(a(t),!0===await o()?e.current:null)),[o]);return{bulkEditActionType:t,isBulkEditFlyoutVisible:n,handleBulkEditFormConfirm:Object(i.useCallback)((t=>{e.current=t,l()}),[l]),handleBulkEditFormCancel:c,completeBulkEditForm:u}})(),ce=T?C.total:I.length,ue=C.total>C.perPage,[de,pe]=Object(i.useMemo)((()=>{const e=new Map(h.map((e=>[e.id,e.immutable])));return Object(E.partition)((t=>e.get(t)),I)}),[h,I]),me=(({filterOptions:e,confirmDeletion:t,confirmBulkEdit:a,completeBulkEditForm:n,reFetchTags:s})=>{const o=Object(ln.useQueryClient)(),l=hp(),c=kn(),u=mn(),d=gp(),p=Object(X.a)(),m=Object(Tg.b)(),g=Object(RS.a)(e),{startTransaction:f}=Vu(),b=Object(i.useCallback)((async e=>[Ou.b.add_tags,Ou.b.set_tags,Ou.b.delete_tags].includes(e)?s():null),[s]),{state:{isAllSelected:h,rules:y,loadingRuleIds:E,selectedRuleIds:v},actions:{setLoadingRules:T,setIsRefreshOn:k}}=c;return Object(i.useCallback)((i=>{const s=y.filter((({id:e})=>v.includes(e))),c=s.some((({enabled:e})=>e)),x=s.some((({enabled:e})=>!e)),S=v.some((e=>E.includes(e))),O=s.some((({immutable:e})=>e)),w=!d&&s.some((e=>!uu(e,d))),j=t=>async()=>{let l,c=!1;k(!1),i();const d=s.filter((e=>!1===e.immutable)).map((e=>e.id));if(!1===await a())return void k(!0);const g=await n(t);if(null==g)return void k(!0);f({name:Lu});const y=()=>{l&&p.api.remove(l)},E=h?(e=>{var t,a;return null!==(t=null===(a=e.getQueryData(iS))||void 0===a?void 0:a.customRulesCount)&&void 0!==t?t:0})(o):d.length;setTimeout((()=>{c||(l=p.addWarning({title:nn.R,text:Object(PS.mountReactNode)(r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,nn.P(E)),r.a.createElement(N.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiButton,{color:"warning",size:"s",onClick:y},nn.Q))))),iconType:void 0},{toastLifeTimeMs:6e5}))}),5e3),await np({visibleRuleIds:v,action:Ou.a.edit,setLoadingRules:T,toasts:p,payload:{edit:[g]},onFinish:()=>y(),search:h?{query:Object(RS.a)({...e,showCustomRules:!0})}:{ids:d}}),c=!0,u(),m()&&await b(t)},C=S||0===v.length,I=w||S||0===v.length;return[{id:0,title:nn.s,items:[{key:nn.p,name:nn.p,"data-test-subj":"enableRuleBulk",disabled:w||S||!x&&!h,onClick:async()=>{f({name:qu}),i();const e=s.filter((({enabled:e})=>!e)),t=e.filter((({type:e})=>!Object(lu.d)(e))),a=e.length-t.length;var n;!l&&a>0&&p.addWarning((n=a,F.i18n.translate("xpack.securitySolution.detectionEngine.mlUnavailableTitle",{values:{totalRules:n},defaultMessage:"{totalRules} {totalRules, plural, =1 {rule requires} other {rules require}} Machine Learning to enable."})));const r=l?e.map((({id:e})=>e)):t.map((({id:e})=>e));await np({visibleRuleIds:r,action:Ou.a.enable,setLoadingRules:T,toasts:p,search:h?{query:g}:{ids:r}}),u()},toolTipContent:w?nn.vb:void 0,toolTipPosition:"right",icon:void 0},{key:nn.o,name:nn.o,"data-test-subj":"duplicateRuleBulk",disabled:I,onClick:async()=>{f({name:Ru}),i(),await np({visibleRuleIds:v,action:Ou.a.duplicate,setLoadingRules:T,toasts:p,search:h?{query:g}:{ids:v}}),u()},toolTipContent:w?nn.vb:void 0,toolTipPosition:"right",icon:void 0},{key:nn.r,name:nn.r,"data-test-subj":"indexPatternsBulkEditRule",disabled:I,panel:2},{key:nn.t,name:nn.t,"data-test-subj":"tagsBulkEditRule",disabled:I,panel:1},{key:nn.j,name:nn.j,"data-test-subj":"applyTimelineTemplateBulk",disabled:I,onClick:j(Ou.b.set_timeline),toolTipContent:w?nn.vb:void 0,toolTipPosition:"right",icon:void 0},{key:nn.q,name:nn.q,"data-test-subj":"exportRuleBulk",disabled:O&&!h||S||0===v.length,onClick:async()=>{i(),f({name:_u}),await np({visibleRuleIds:v,action:Ou.a.export,setLoadingRules:T,toasts:p,search:h?{query:g}:{ids:v}})},icon:void 0},{key:nn.n,name:nn.n,"data-test-subj":"disableRuleBulk",disabled:w||S||!c&&!h,onClick:async()=>{f({name:Pu}),i();const e=s.filter((({enabled:e})=>e)).map((({id:e})=>e));await np({visibleRuleIds:e,action:Ou.a.disable,setLoadingRules:T,toasts:p,search:h?{query:g}:{ids:e}}),u()},toolTipContent:w?nn.vb:void 0,toolTipPosition:"right",icon:void 0},{key:nn.k,name:r.a.createElement(N.EuiTextColor,{color:C?$n.euiThemeVars.euiButtonColorDisabledText:"danger"},nn.k),"data-test-subj":"deleteRuleBulk",disabled:C,onClick:async()=>{i(),h&&!1===await t()||(f({name:Fu}),await np({visibleRuleIds:v,action:Ou.a.delete,setLoadingRules:T,toasts:p,search:h?{query:g}:{ids:v}}),u())},toolTipContent:O?nn.g:void 0,toolTipPosition:"right",icon:void 0}]},{id:1,title:nn.s,items:[{key:nn.i,name:nn.i,"data-test-subj":"addTagsBulkEditRule",onClick:j(Ou.b.add_tags),disabled:I,toolTipContent:w?nn.vb:void 0,toolTipPosition:"right"},{key:nn.m,name:nn.m,"data-test-subj":"deleteTagsBulkEditRule",onClick:j(Ou.b.delete_tags),disabled:I,toolTipContent:w?nn.vb:void 0,toolTipPosition:"right"}]},{id:2,title:nn.s,items:[{key:nn.h,name:nn.h,"data-test-subj":"addIndexPatternsBulkEditRule",onClick:j(Ou.b.add_index_patterns),disabled:I,toolTipContent:w?nn.vb:void 0,toolTipPosition:"right"},{key:nn.l,name:nn.l,"data-test-subj":"deleteIndexPatternsBulkEditRule",onClick:j(Ou.b.delete_index_patterns),disabled:I,toolTipContent:w?nn.vb:void 0,toolTipPosition:"right"}]}]}),[y,v,d,h,E,f,l,T,p,g,u,t,k,a,n,o,e,m,b])})({filterOptions:y,confirmDeletion:Q,confirmBulkEdit:Z,completeBulkEditForm:le,reFetchTags:U}),ge=Object(i.useMemo)((()=>({pageIndex:C.page-1,pageSize:C.perPage,totalItemCount:C.total,pageSizeOptions:o.Vb})),[C]),fe=Object(i.useCallback)((({page:e,sort:t})=>{var a,n;L({field:null!==(a=null==t?void 0:t.field)&&void 0!==a?a:"enabled",order:null!==(n=null==t?void 0:t.direction)&&void 0!==n?n:"desc"}),P(e.index+1),R(e.size)}),[P,R,L]),be=(({hasPermissions:e})=>{const t=Bp(),a=Rp({hasPermissions:e}),n=Fp(),{isInMemorySorting:s}=kn().state,[l]=Object(d.p)(o.ac);return Object(i.useMemo)((()=>[n,...l?[Np]:[],Lp,{field:"risk_score",name:nn.db,render:e=>r.a.createElement(N.EuiText,{"data-test-subj":"riskScore",size:"s"},e),sortable:!0,truncateText:!0,width:"85px"},{field:"severity",name:nn.fb,render:e=>r.a.createElement(cp.a,{value:e}),sortable:!0,truncateText:!0,width:"12%"},{field:"execution_summary.last_execution.date",name:nn.Y,render:e=>null==e?Object(vr.d)():r.a.createElement(wn.b,{tooltipFieldName:nn.Y,relativeThresholdInHrs:o.X,value:e,tooltipAnchorClassName:"eui-textTruncate"}),sortable:!!s,truncateText:!0,width:"16%"},{field:"execution_summary.last_execution.status",name:nn.Z,render:e=>r.a.createElement(Ap,{status:e}),sortable:!!s,truncateText:!0,width:"16%"},{field:"updated_at",name:nn.ab,render:e=>null==e?Object(vr.d)():r.a.createElement(wn.b,{tooltipFieldName:nn.ab,relativeThresholdInHrs:o.X,value:e,tooltipAnchorClassName:"eui-textTruncate"}),sortable:!0,width:"18%",truncateText:!0},{field:"version",name:nn.hb,render:e=>null==e?Object(vr.d)():r.a.createElement(N.EuiText,{"data-test-subj":"version",size:"s"},e),sortable:!!s,truncateText:!0,width:"65px"},a,...e?[t]:[]]),[t,a,e,s,n,l])})({hasPermissions:t}),he=(({hasPermissions:e})=>{const t=Object(d.j)().services.docLinks,a=Bp(),n=Rp({hasPermissions:e}),s=Fp(),{isInMemorySorting:l}=kn().state,[c]=Object(d.p)(o.ac);return Object(i.useMemo)((()=>[{...s,width:"28%"},...c?[Np]:[],Lp,{field:"execution_summary.last_execution.metrics.total_indexing_duration_ms",name:r.a.createElement(mp,{title:nn.W,tooltipContent:nn.X}),render:e=>r.a.createElement(N.EuiText,{"data-test-subj":"total_indexing_duration_ms",size:"s"},null!=e?e.toFixed():Object(vr.d)()),sortable:!!l,truncateText:!0,width:"16%"},{field:"execution_summary.last_execution.metrics.total_search_duration_ms",name:r.a.createElement(mp,{title:nn.bb,tooltipContent:nn.cb}),render:e=>r.a.createElement(N.EuiText,{"data-test-subj":"total_search_duration_ms",size:"s"},null!=e?e.toFixed():Object(vr.d)()),sortable:!!l,truncateText:!0,width:"14%"},{field:"execution_summary.last_execution.metrics.execution_gap_duration_s",name:r.a.createElement(mp,{title:nn.U,customTooltip:r.a.createElement("div",{style:{maxWidth:"20px"}},r.a.createElement(dp,{columnName:nn.U},r.a.createElement(N.EuiText,{style:{width:300}},r.a.createElement("p",null,r.a.createElement(It.FormattedMessage,{defaultMessage:"Duration of most recent gap in Rule execution. Adjust Rule look-back or {seeDocs} for mitigating gaps.",id:"xpack.securitySolution.detectionEngine.rules.allRules.columns.gapTooltip",values:{seeDocs:r.a.createElement(N.EuiLink,{href:`${t.links.siem.troubleshootGaps}`,target:"_blank"},nn.V)}})))))}),render:e=>r.a.createElement(N.EuiText,{"data-test-subj":"gap",size:"s"},null!=e?e.toFixed():Object(vr.d)()),sortable:!!l,truncateText:!0,width:"14%"},{field:"execution_summary.last_execution.status",name:nn.Z,render:e=>r.a.createElement(Ap,{status:e}),sortable:!!l,truncateText:!0,width:"12%"},{field:"execution_summary.last_execution.date",name:nn.Y,render:e=>null==e?Object(vr.d)():r.a.createElement(wn.b,{tooltipFieldName:nn.Y,relativeThresholdInHrs:o.X,value:e,tooltipAnchorClassName:"eui-textTruncate"}),sortable:!!l,truncateText:!0,width:"16%"},n,...e?[a]:[]]),[a,t.links.siem.troubleshootGaps,n,e,l,s,c])})({hasPermissions:t}),ye=Object(i.useCallback)((async()=>{null!=e&&(g({name:zu}),await e(),await A())}),[e,A,g]),Ee=Object(i.useCallback)((()=>{g({name:Nu}),A()}),[A,g]),ve=Object(i.useRef)(!1);((e,t)=>{const a=Object(i.useRef)(t);Object(i.useEffect)((()=>{JSON.stringify(a.current)!==JSON.stringify(t)&&(a.current=t,e(t))}),[e,t])})((e=>{null!=f.current&&f.current.setSelection(h.filter((t=>e.includes(t.id))))}),I);const Te=Object(i.useMemo)((()=>({selectable:e=>!w.includes(e.id),onSelectionChange:e=>{ve.current?ve.current=!1:(_(e.map((({id:e})=>e))),D(!1))}})),[w,D,_]),ke=Object(i.useCallback)((()=>{ve.current=!0,D(!T),_(T?[]:h.map((({id:e})=>e)))}),[h,T,D,_]),xe=Object(i.useCallback)((e=>{e&&A(),q(e)}),[q,A]),Se=Object(i.useMemo)((()=>(({rulesCustomInstalled:e,rulesInstalled:t})=>null!=e&&e>0||null!=t&&t>0)({rulesCustomInstalled:n,rulesInstalled:s})&&!x),[x,n,s]),Oe=Object(i.useMemo)((()=>null!=n&&0===n&&"ruleNotInstalled"===B&&!x),[x,B,n]),we=u===Mx.rules?{"data-test-subj":"rules-table",columns:be}:{"data-test-subj":"monitoring-table",columns:he},je=k&&S,Ce=!k&&S||v;return r.a.createElement(r.a.Fragment,null,je&&r.a.createElement(N.EuiProgress,{"data-test-subj":"loadingRulesInfoProgress",size:"xs",position:"absolute",color:"accent"}),Ce&&r.a.createElement(Fa.a,{"data-test-subj":"loadingPanelAllRulesTable",overlay:!0,size:"xl"}),Se&&r.a.createElement(nS,{rulesCustomInstalled:n,rulesInstalled:s,allTags:z}),Oe&&r.a.createElement(Qx,{createPrePackagedRules:ye,loading:a,userHasPermissions:t}),x&&r.a.createElement(N.EuiLoadingContent,{"data-test-subj":"initialLoadingPanelAllRulesTable",lines:10}),H&&r.a.createElement(N.EuiConfirmModal,{title:nn.qb,onCancel:G,onConfirm:W,confirmButtonText:nn.pb,cancelButtonText:nn.ob,buttonColor:"danger",defaultFocusedButton:"confirm","data-test-subj":"allRulesDeleteConfirmationModal"},r.a.createElement("p",null,nn.nb)),K&&!ne&&r.a.createElement(sS,{customRulesCount:T?ae:pe.length,elasticRulesCount:T?Math.max((null!==(p=C.total)&&void 0!==p?p:0)-ae,0):de.length,onCancel:te,onConfirm:ee}),re&&void 0!==ie&&r.a.createElement(qS,{rulesCount:T?ae:pe.length,editAction:ie,onClose:oe,onConfirm:se,tags:z}),Se&&r.a.createElement(r.a.Fragment,null,r.a.createElement(Sn,{canBulkEdit:t,hasPagination:ue,paginationTotal:null!==(m=C.total)&&void 0!==m?m:0,numberSelectedItems:ce,onGetBulkItemsPopoverContent:me,onRefresh:Ee,isAutoRefreshOn:O,onRefreshSwitch:xe,isAllSelected:T,onToggleSelectAll:ke,isBulkActionInProgress:ne||null!=j,hasDisabledActions:null!=j,hasBulkActions:!0}),r.a.createElement(N.EuiBasicTable,rr()({itemId:"id",items:h,isSelectable:t,noItemsMessage:_S,onChange:fe,pagination:ge,ref:f,selection:t?Te:void 0,sorting:{sort:{field:M.field,direction:M.order}}},we))))}));FS.displayName="RulesTables";const LS=r.a.memo((({createPrePackagedRules:e,hasPermissions:t,loadingCreatePrePackagedRules:a,rulesCustomInstalled:n,rulesInstalled:s,rulesNotInstalled:o,rulesNotUpdated:l})=>{const[c,u]=Object(i.useState)(Mx.rules);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Dx,{activeTab:c,onTabChange:u}),r.a.createElement(N.EuiSpacer,null),r.a.createElement(FS,{createPrePackagedRules:e,hasPermissions:t,loadingCreatePrePackagedRules:a,rulesCustomInstalled:n,rulesInstalled:s,rulesNotInstalled:o,rulesNotUpdated:l,selectedTab:c}))}));LS.displayName="AllRules";var NS=a(820),BS=a(254);const zS=F.i18n.translate("xpack.securitySolution.lists.uploadValueListTitle",{defaultMessage:"Upload value lists"}),US=F.i18n.translate("xpack.securitySolution.lists.uploadValueListDescription",{defaultMessage:"Upload single value lists to use while writing rule exceptions."}),HS=F.i18n.translate("xpack.securitySolution.lists.uploadValueListPrompt",{defaultMessage:"Select or drag and drop a file"}),$S=F.i18n.translate("xpack.securitySolution.lists.closeValueListsModalTitle",{defaultMessage:"Close"}),VS=F.i18n.translate("xpack.securitySolution.lists.cancelValueListsUploadTitle",{defaultMessage:"Cancel upload"}),QS=F.i18n.translate("xpack.securitySolution.lists.valueListsUploadButton",{defaultMessage:"Upload list"}),WS=F.i18n.translate("xpack.securitySolution.lists.valueListsUploadSuccessTitle",{defaultMessage:"Value list uploaded"}),GS=F.i18n.translate("xpack.securitySolution.lists.valueListsUploadError",{defaultMessage:"There was an error uploading the value list."}),KS=F.i18n.translate("xpack.securitySolution.lists.valueListsExportError",{defaultMessage:"There was an error exporting the value list."}),YS=F.i18n.translate("xpack.securitySolution.lists.valueListsTable.fileNameColumn",{defaultMessage:"Filename"}),JS=F.i18n.translate("xpack.securitySolution.lists.valueListsTable.typeColumn",{defaultMessage:"Type"}),XS=F.i18n.translate("xpack.securitySolution.lists.valueListsTable.uploadDateColumn",{defaultMessage:"Upload Date"}),ZS=F.i18n.translate("xpack.securitySolution.lists.valueListsTable.createdByColumn",{defaultMessage:"Created by"}),eO=F.i18n.translate("xpack.securitySolution.lists.valueListsTable.actionsColumn",{defaultMessage:"Actions"}),tO=(F.i18n.translate("xpack.securitySolution.lists.valueListsTable.exportActionName",{defaultMessage:"Export"}),F.i18n.translate("xpack.securitySolution.lists.valueListsTable.exportActionDescription",{defaultMessage:"Export value list"})),aO=(F.i18n.translate("xpack.securitySolution.lists.valueListsTable.deleteActionName",{defaultMessage:"Remove"}),F.i18n.translate("xpack.securitySolution.lists.valueListsTable.deleteActionDescription",{defaultMessage:"Remove value list"})),nO=F.i18n.translate("xpack.securitySolution.lists.valueListsTable.title",{defaultMessage:"Value lists"}),iO=F.i18n.translate("xpack.securitySolution.lists.valueListsForm.listTypesRadioLabel",{defaultMessage:"Type of value list"}),rO=F.i18n.translate("xpack.securitySolution.lists.valueListsForm.ipRadioLabel",{defaultMessage:"IP addresses"}),sO=F.i18n.translate("xpack.securitySolution.lists.valueListsForm.keywordsRadioLabel",{defaultMessage:"Keywords"}),oO=F.i18n.translate("xpack.securitySolution.lists.valueListsForm.ipRangesRadioLabel",{defaultMessage:"IP ranges"}),lO=F.i18n.translate("xpack.securitySolution.lists.valueListsForm.textRadioLabel",{defaultMessage:"Text"}),cO=F.i18n.translate("xpack.securitySolution.lists.referenceModalTitle",{defaultMessage:"Remove value list"}),uO=F.i18n.translate("xpack.securitySolution.lists.referenceModalCancelButton",{defaultMessage:"Cancel"}),dO=F.i18n.translate("xpack.securitySolution.lists.referenceModalDeleteButton",{defaultMessage:"Remove value list"}),pO=[{value:"keyword",text:sO},{value:"ip",text:rO},{value:"ip_range",text:oO},{value:"text",text:lO}],mO="keyword",gO=["text/csv","text/plain"],fO=({onError:e,onSuccess:t})=>{const a=Object(i.useRef)(new AbortController),[n,s]=Object(i.useState)(null),[o,l]=Object(i.useState)(mO),c=Object(i.useRef)(null),{http:u}=Object(d.j)().services,{start:p,...m}=Object(et.h)(),g=!n||gO.some((e=>n.type===e)),f=Object(i.useCallback)((e=>l(e.target.value)),[l]),b=Object(i.useCallback)((e=>{var t;s(null!==(t=null==e?void 0:e.item(0))&&void 0!==t?t:null)}),[]),h=Object(i.useCallback)((()=>{var e;null!==(e=c.current)&&void 0!==e&&e.fileInput&&(c.current.fileInput.value="",c.current.handleChange()),s(null),l(mO)}),[]),y=Object(i.useCallback)((()=>{a.current.abort()}),[]),E=Object(i.useCallback)((e=>{h(),t(e)}),[h,t]),v=Object(i.useCallback)((t=>{e(t)}),[e]),T=Object(i.useCallback)((()=>{!m.loading&&n&&(a.current=new AbortController,p({file:n,listId:void 0,http:u,signal:a.current.signal,type:o}))}),[m.loading,n,p,u,o]);return Object(i.useEffect)((()=>{!m.loading&&m.result?E(m.result):!m.loading&&m.error&&v(m.error)}),[v,E,m.error,m.loading,m.result]),Object(i.useEffect)((()=>y),[y]),r.a.createElement(N.EuiForm,null,r.a.createElement(N.EuiFormRow,{"data-test-subj":"value-list-file-picker-row",label:US,fullWidth:!0,isInvalid:!g,error:[(k=gO.join(", "),F.i18n.translate("xpack.securitySolution.lists.uploadValueListExtensionValidationMessage",{values:{fileTypes:k},defaultMessage:"File must be one of the following types: [{fileTypes}]"}))]},r.a.createElement(N.EuiFilePicker,{accept:gO.join(),"data-test-subj":"value-list-file-picker",id:"value-list-file-picker",initialPromptText:HS,ref:c,onChange:b,fullWidth:!0,isLoading:m.loading,isInvalid:!g})),r.a.createElement(N.EuiFormRow,{fullWidth:!0},r.a.createElement(N.EuiFlexGroup,null,r.a.createElement(N.EuiFlexItem,null,r.a.createElement(N.EuiFormRow,{label:iO},r.a.createElement(N.EuiSelect,{"data-test-subj":"value-lists-form-select-type-action",options:pO,value:o,onChange:f,name:"valueListType"}))),r.a.createElement(N.EuiFlexItem,null,r.a.createElement(N.EuiFormRow,{hasEmptyLabelSpace:!0},r.a.createElement(N.EuiFlexGroup,{alignItems:"flexEnd"},r.a.createElement(N.EuiFlexItem,null,m.loading&&r.a.createElement(N.EuiButtonEmpty,{onClick:y},VS)),r.a.createElement(N.EuiFlexItem,null,r.a.createElement(N.EuiButton,{"data-test-subj":"value-lists-form-import-action",onClick:T,disabled:null==n||!g||m.loading},QS))))))));var k};fO.displayName="ValueListsFormComponent";const bO=r.a.memo(fO);bO.displayName="ValueListsForm";const hO=z()(N.EuiLoadingSpinner).withConfig({displayName:"AlignedSpinner",componentId:"sc-j76bhq-0"})(["margin:",";vertical-align:middle;"],(({theme:e})=>e.eui.euiSizeXS)),yO={contentText:"",exceptionListReferences:[],isLoading:!1,valueListId:""},EO=({onClose:e,showModal:t})=>{var a,n,s,o;const[l,c]=Object(i.useState)(0),[u,p]=Object(i.useState)(5),[m,g]=Object(et.c)({pageIndex:l,pageSize:u}),{http:f}=Object(d.j)().services,{start:b,...h}=Object(et.g)(),{start:y,result:v,error:T}=Object(et.d)(),[k,x]=Object(i.useState)([]),[S,O]=Object(i.useState)([]),[w,j]=Object(i.useState)({}),{addError:C,addSuccess:I}=Object(X.a)(),[M,A]=Object(i.useState)(!1),[D,q]=Object(i.useState)(yO),P=Object(i.useCallback)((()=>{b({cursor:m,http:f,pageIndex:l+1,pageSize:u})}),[m,f,b,l,u]),R=Object(i.useCallback)((({deleteReferences:e,id:t})=>{x([...k,t]),y({deleteReferences:e,http:f,id:t})}),[y,k,f]),_=Object(i.useCallback)((async()=>{A(!1),y({deleteReferences:!0,http:f,id:D.valueListId}),q(yO),x([])}),[y,f,D.valueListId]);Object(i.useEffect)((()=>{null!=v&&(x((e=>[...e.filter((e=>e!==v.id))])),P())}),[v,P]),Object(i.useEffect)((()=>{if(!Object(E.isEmpty)(T)){var e,t,a,n,i,r,s,o;const c=null!==(e=null==T||null===(t=T.body)||void 0===t||null===(a=t.message)||void 0===a||null===(n=a.error)||void 0===n||null===(i=n.references)||void 0===i?void 0:i.map((e=>null==e?void 0:e.exception_list.name)))&&void 0!==e?e:[],u=Array.from(new Set(c));A(!0),q({contentText:(l=u.length,F.i18n.translate("xpack.securitySolution.lists.referenceModalDescription",{defaultMessage:"This value list is associated with ({referenceCount}) exception {referenceCount, plural, =1 {list} other {lists}}. Removing this list will remove all exception items that reference this value list.",values:{referenceCount:l}})),exceptionListReferences:u,isLoading:!1,valueListId:null==T||null===(r=T.body)||void 0===r||null===(s=r.message)||void 0===s||null===(o=s.error)||void 0===o?void 0:o.value_list_id})}var l}),[T]);const L=Object(i.useCallback)((async({id:e})=>{try{O((t=>[...t,e]));const t=await Object(BS.i)({http:f,listId:e,signal:(new AbortController).signal});j({name:e,blob:t})}catch(e){C(e,{title:KS})}finally{O((t=>[...t.filter((t=>t!==e))]))}}),[C,f]),B=Object(i.useCallback)((({page:{index:e,size:t}})=>{c(e),p(t)}),[c,p]),z=Object(i.useCallback)((e=>{"AbortError"!==e.name&&C(e,{title:GS})}),[C]),U=Object(i.useCallback)((e=>{var t;I({text:(t=e.name,F.i18n.translate("xpack.securitySolution.lists.valueListsUploadSuccess",{defaultMessage:"Value list '{fileName}' was uploaded",values:{fileName:t}})),title:WS}),P()}),[I]);Object(i.useEffect)((()=>{t&&P()}),[t,P]),Object(i.useEffect)((()=>{var e;!h.loading&&null!==(e=h.result)&&void 0!==e&&e.cursor&&g(h.result.cursor)}),[h.loading,h.result,g]);const H=Object(i.useCallback)((()=>{x([]),A(!1),q({contentText:"",exceptionListReferences:[],isLoading:!1,valueListId:""})}),[]);if(!t)return null;const $=(null!==(a=null===(n=h.result)||void 0===n?void 0:n.data)&&void 0!==a?a:[]).map((e=>({...e,isDeleting:k.includes(e.id),isExporting:S.includes(e.id)}))),V={pageIndex:l,pageSize:u,totalItemCount:null!==(s=null===(o=h.result)||void 0===o?void 0:o.total)&&void 0!==s?s:0,showPerPageOptions:!1},Q=(W=L,G=R,[{field:"name",name:YS,truncateText:!1},{field:"type",name:JS,width:"15%",truncateText:!0,render:e=>{const t=pO.find((({value:t})=>t===e));return r.a.createElement(r.a.Fragment,null,t?t.text:e)}},{field:"created_at",name:XS,render:e=>r.a.createElement(wn.a,{value:e,fieldName:"created_at"}),width:"30%"},{field:"created_by",name:ZS,truncateText:!0,width:"20%"},{name:eO,actions:[{render:e=>r.a.createElement(N.EuiToolTip,{content:tO},e.isExporting?r.a.createElement(hO,{size:"m"}):r.a.createElement(N.EuiButtonIcon,{"aria-label":tO,"data-test-subj":"action-export-value-list",iconType:"exportAction",onClick:()=>W(e)}))},{render:e=>r.a.createElement(N.EuiToolTip,{content:aO},e.isDeleting?r.a.createElement(hO,{size:"m"}):r.a.createElement(N.EuiButtonIcon,{"aria-label":aO,"data-test-subj":`action-delete-value-list-${e.name}`,iconType:"trash",onClick:()=>G(e)}))}],width:"15%"}]);var W,G;return r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiModal,{onClose:e,maxWidth:800},r.a.createElement(N.EuiModalHeader,null,r.a.createElement(N.EuiModalHeaderTitle,null,zS)),r.a.createElement(N.EuiModalBody,null,r.a.createElement(bO,{onSuccess:U,onError:z}),r.a.createElement(N.EuiSpacer,null),r.a.createElement(N.EuiPanel,{hasBorder:!0},r.a.createElement(N.EuiText,{size:"s"},r.a.createElement("h2",null,nO)),r.a.createElement(N.EuiBasicTable,{"data-test-subj":"value-lists-table",columns:Q,items:$,loading:h.loading,onChange:B,pagination:V}))),r.a.createElement(N.EuiModalFooter,null,r.a.createElement(N.EuiButton,{"data-test-subj":"value-lists-modal-close-action",onClick:e},$S))),r.a.createElement(Mn,{cancelText:uO,confirmText:dO,contentText:D.contentText,onCancel:H,onClose:H,onConfirm:_,references:D.exceptionListReferences,showModal:M,titleText:cO}),r.a.createElement(_a,{blob:w.blob,name:w.name,onDownload:()=>j({})}))};EO.displayName="ValueListsModalComponent";const vO=r.a.memo(EO);vO.displayName="ValueListsModal";const TO=({loading:e,numberOfUpdatedRules:t,numberOfUpdatedTimelines:a,updateRules:n})=>{const{services:s}=Object(d.j)(),o=Object(i.useMemo)((()=>{return t>0&&0===a?{callOutMessage:Lx(t),buttonTitle:Bx(t)}:0===t&&a>0?{callOutMessage:(e=a,F.i18n.translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedTimelinesMsg",{values:{updateTimelines:e},defaultMessage:"You can update {updateTimelines} Elastic prebuilt {updateTimelines, plural, =1 {timeline} other {timelines}}"})),buttonTitle:zx(a)}:t>0&&a>0?{callOutMessage:Nx(t,a),buttonTitle:Ux(t,a)}:void 0;var e}),[t,a]);return r.a.createElement(N.EuiCallOut,{title:Fx,"data-test-subj":"update-callout"},r.a.createElement("p",null,null==o?void 0:o.callOutMessage,r.a.createElement("br",null),r.a.createElement(N.EuiLink,{href:`${s.docLinks.links.siem.ruleChangeLog}`,target:"_blank"},Hx)),r.a.createElement(N.EuiButton,{onClick:n,size:"s",isLoading:e,"data-test-subj":"update-callout-button"},null==o?void 0:o.buttonTitle))},kO=Object(i.memo)(TO),xO=()=>r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.mlJobCompatibilityCallout.messageBody",defaultMessage:"{summary} Related documentation: {docs}",values:{summary:r.a.createElement("p",null,r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.mlJobCompatibilityCallout.messageBody.summary",defaultMessage:"Machine learning rules use ML jobs that in turn have dependencies on data fields populated by the Beats and Elastic Agent integrations that were current when the ML job was created. New ML jobs, prefixed with V3, have been released to operate on now-current ECS fields. If you're using multiple versions of Beats or Elastic Agent, you may need to duplicate or create new machine learning rules that specify the new ML (V3) jobs and enable them to run alongside your existing rules, to ensure continued rule coverage using V1/V2 jobs."})),docs:r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(Nt,null)))}}),SO={type:"primary",id:"ml-job-compatibility",title:F.i18n.translate("xpack.securitySolution.detectionEngine.mlJobCompatibilityCallout.messageTitle",{defaultMessage:"Your ML jobs may be incompatible with your data sources and/or ML rules"}),description:r.a.createElement(xO,null)},OO=()=>{const{loading:e,jobs:t}=Object(Cx.a)(),a=t.some((e=>jx.includes(e.id)));return r.a.createElement(wt,{namespace:"detections",condition:!e&&a,message:SO})},wO=Object(i.memo)(OO),jO=()=>{const[e,t,a]=qx(),[n,s,l]=qx(),{navigateToApp:c}=Object(d.j)().services.application,{startTransaction:u}=Vu(),p=mn(),{loading:m,jobs:g}=Object(Cx.a)(),f=g.filter((e=>jx.includes(e.id))),[h,E]=Object(i.useState)(!1),[{loading:v,isSignalIndexExists:k,isAuthenticated:x,hasEncryptionKey:S,canUserCRUD:O,hasIndexWrite:w}]=Object(_e.b)(),{loading:j,canWriteIndex:C,needsConfiguration:I}=lt(),M=v||j,{createPrePackagedRules:A,loadingCreatePrePackagedRules:D,refetchPrePackagedRulesStatus:q,rulesCustomInstalled:P,rulesInstalled:R,rulesNotInstalled:_,rulesNotUpdated:F,timelinesInstalled:L,timelinesNotInstalled:B,timelinesNotUpdated:z,getLoadPrebuiltRulesAndTemplatesButton:U,getReloadPrebuiltRulesAndTemplatesButton:H}=tp({canUserCRUD:O,hasIndexWrite:w,isSignalIndexExists:k,isAuthenticated:x,hasEncryptionKey:S}),$=fi(R,_,F),Q=bi(L,B,z),W=Object(i.useCallback)((async()=>{null!=A&&(u({name:zu}),await A(),p())}),[A,p,u]),G=Object(i.useCallback)((async()=>{E(!1),await W()}),[W,E]),K=Object(i.useCallback)((async()=>{f.length>0?E(!0):await W()}),[W,f.length]),Y=Object(i.useCallback)((()=>null!=q?q():Promise.resolve()),[q]),J=Object(i.useMemo)((()=>U({isDisabled:!vi(O)||M||m,onClick:K})),[O,U,K,M,m]),X=Object(i.useMemo)((()=>H({isDisabled:!vi(O)||M||m,onClick:K})),[O,H,K,M,m]);return hi(k,x,S,I)?(c(o.y,{deepLinkId:T.a.alerts,path:Object(V.a)()}),null):r.a.createElement(r.a.Fragment,null,r.a.createElement(Ut,null),r.a.createElement(ia,null),r.a.createElement(wO,null),h&&r.a.createElement(wx,{jobs:f,onCancel:()=>E(!1),onConfirm:G}),r.a.createElement(vO,{showModal:n,onClose:l}),r.a.createElement(NS.a,{checkBoxLabel:nn.Mb,closeModal:a,description:nn.yc,errorMessage:nn.Cb,failedDetailed:nn.Db,importComplete:p,importData:cn.i,successMessage:nn.Bc,showModal:e,submitBtnText:nn.Fb,subtitle:nn.Gb,title:nn.Eb,showExceptionsCheckBox:!0,showCheckBox:!0}),r.a.createElement(Tn,{refetchPrePackagedRulesStatus:Y},r.a.createElement(b.a,null,r.a.createElement(Ta.a,{title:nn.Nb},r.a.createElement(N.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1,wrap:!0},J&&r.a.createElement(N.EuiFlexItem,{grow:!1},J),X&&r.a.createElement(N.EuiFlexItem,{grow:!1},X),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiToolTip,{position:"top",content:nn.Ec},r.a.createElement(N.EuiButton,{"data-test-subj":"open-value-lists-modal-button",iconType:"importAction",isDisabled:!C||!O||M,onClick:s},nn.Dc))),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiButton,{"data-test-subj":"rules-import-modal-button",iconType:"importAction",isDisabled:!vi(O)||M,onClick:t},nn.Eb)),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(ut.l,{"data-test-subj":"create-new-rule",fill:!0,iconType:"plusInCircle",isDisabled:!vi(O)||M,deepLinkId:T.a.rulesCreate},nn.d)))),("ruleNeedUpdate"===$||"timelineNeedUpdate"===Q)&&r.a.createElement(kO,{"data-test-subj":"update-callout-button",loading:D,numberOfUpdatedRules:null!=F?F:0,numberOfUpdatedTimelines:null!=z?z:0,updateRules:K}),r.a.createElement(LS,{createPrePackagedRules:A,"data-test-subj":"all-rules",loadingCreatePrePackagedRules:D,hasPermissions:vi(O),rulesCustomInstalled:P,rulesInstalled:R,rulesNotInstalled:_,rulesNotUpdated:F}))),r.a.createElement(y.a,{pageName:T.a.rules}))},CO=r.a.memo(jO),IO=()=>{const[e]=Object(d.p)(o.J);return e?$n.euiDarkVars:$n.euiLightVars},MO=z.a.div.withConfig({displayName:"RuleStatusIconStyled",componentId:"sc-1sbrlhw-0"})(["position:relative;svg{position:absolute;top:8px;left:9px;}"]),AO=({name:e,type:t})=>{const a=IO(),n="passive"===t?a.euiColorLightestShade:a.euiColorPrimary;return r.a.createElement(MO,null,r.a.createElement(N.EuiAvatar,{color:n,name:"valid"===t?"":e,size:"l"}),"valid"===t?r.a.createElement(N.EuiIcon,{type:"check",color:a.euiColorEmptyShade,size:"l"}):null)},DO=Object(i.memo)(AO),qO=({name:e,title:t,type:a})=>r.a.createElement(N.EuiFlexGroup,{alignItems:"center",gutterSize:"m",responsive:!1},r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(DO,{name:e,type:a})),r.a.createElement(N.EuiFlexItem,null,r.a.createElement(N.EuiTitle,{size:"s",className:"euiAccordionForm__title"},r.a.createElement("h6",null,t)))),PO=r.a.memo(qO);var RO=a(453),_O=a.n(RO),FO=a(365),LO=a.n(FO);const NO=[{framework:"MITRE ATT&CK",tactic:{id:"none",name:"none",reference:"none"},technique:[]}],BO={author:[],name:"",description:"",isAssociatedToEndpointList:!1,isBuildingBlock:!1,severity:{value:"low",mapping:pi([]),isMappingChecked:!1},riskScore:{value:21,mapping:[],isMappingChecked:!1},references:[""],falsePositives:[""],license:"",ruleNameOverride:"",tags:[],timestampOverride:"",threat:NO,note:""};var zO,UO,HO=a(354),$O=a(36),VO=a(128),QO=a.n(VO),WO=a(129),GO=a.n(WO);!function(e){e._ID="_id",e._INDEX="_index",e._SOURCE="_source",e._TYPE="_type",e.STRING="string",e.TEXT="text",e.MATCH_ONLY_TEXT="match_only_text",e.KEYWORD="keyword",e.VERSION="version",e.BOOLEAN="boolean",e.OBJECT="object",e.DATE="date",e.DATE_NANOS="date_nanos",e.DATE_RANGE="date_range",e.GEO_POINT="geo_point",e.GEO_SHAPE="geo_shape",e.FLOAT="float",e.HALF_FLOAT="half_float",e.SCALED_FLOAT="scaled_float",e.DOUBLE="double",e.INTEGER="integer",e.LONG="long",e.SHORT="short",e.UNSIGNED_LONG="unsigned_long",e.FLOAT_RANGE="float_range",e.DOUBLE_RANGE="double_range",e.INTEGER_RANGE="integer_range",e.LONG_RANGE="long_range",e.NESTED="nested",e.BYTE="byte",e.IP="ip",e.IP_RANGE="ip_range",e.ATTACHMENT="attachment",e.TOKEN_COUNT="token_count",e.MURMUR3="murmur3",e.HISTOGRAM="histogram"}(zO||(zO={})),function(e){e._SOURCE="_source",e.ATTACHMENT="attachment",e.BOOLEAN="boolean",e.DATE="date",e.DATE_RANGE="date_range",e.GEO_POINT="geo_point",e.GEO_SHAPE="geo_shape",e.IP="ip",e.IP_RANGE="ip_range",e.MURMUR3="murmur3",e.NUMBER="number",e.NUMBER_RANGE="number_range",e.STRING="string",e.UNKNOWN="unknown",e.CONFLICT="conflict",e.OBJECT="object",e.NESTED="nested",e.HISTOGRAM="histogram",e.MISSING="missing"}(UO||(UO={}));var KO=QO()((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};GO()(this,e),sn()(this,"name",void 0),sn()(this,"sortable",void 0),sn()(this,"filterable",void 0),sn()(this,"esTypes",void 0),this.name=t.name||UO.UNKNOWN,this.sortable=t.sortable||!1,this.filterable=t.filterable||!1,this.esTypes=Object.freeze((t.esTypes||[]).slice())})),YO=new KO({name:UO.UNKNOWN}),JO=[new KO({name:UO.STRING,sortable:!0,filterable:!0,esTypes:[zO.STRING,zO.TEXT,zO.MATCH_ONLY_TEXT,zO.KEYWORD,zO.VERSION,zO._TYPE,zO._ID]}),new KO({name:UO.NUMBER,sortable:!0,filterable:!0,esTypes:[zO.FLOAT,zO.HALF_FLOAT,zO.SCALED_FLOAT,zO.DOUBLE,zO.INTEGER,zO.LONG,zO.UNSIGNED_LONG,zO.SHORT,zO.BYTE,zO.TOKEN_COUNT]}),new KO({name:UO.NUMBER_RANGE,sortable:!0,filterable:!0,esTypes:[zO.FLOAT_RANGE,zO.DOUBLE_RANGE,zO.INTEGER_RANGE,zO.LONG_RANGE]}),new KO({name:UO.DATE,sortable:!0,filterable:!0,esTypes:[zO.DATE,zO.DATE_NANOS]}),new KO({name:UO.DATE_RANGE,sortable:!0,filterable:!0,esTypes:[zO.DATE_RANGE]}),new KO({name:UO.IP,sortable:!0,filterable:!0,esTypes:[zO.IP]}),new KO({name:UO.IP_RANGE,sortable:!0,filterable:!0,esTypes:[zO.IP_RANGE]}),new KO({name:UO.BOOLEAN,sortable:!0,filterable:!0,esTypes:[zO.BOOLEAN]}),new KO({name:UO.OBJECT,esTypes:[zO.OBJECT]}),new KO({name:UO.NESTED,esTypes:[zO.NESTED]}),new KO({name:UO.GEO_POINT,esTypes:[zO.GEO_POINT]}),new KO({name:UO.GEO_SHAPE,esTypes:[zO.GEO_SHAPE]}),new KO({name:UO.ATTACHMENT,esTypes:[zO.ATTACHMENT]}),new KO({name:UO.MURMUR3,esTypes:[zO.MURMUR3]}),new KO({name:UO._SOURCE,esTypes:[zO._SOURCE]}),new KO({name:UO.HISTOGRAM,filterable:!0,esTypes:[zO.HISTOGRAM]}),new KO({name:UO.CONFLICT}),YO],XO=a(811),ZO=a(179);const ew=F.i18n.translate("xpack.securitySolution.threatMatch.fieldDescription",{defaultMessage:"Field"}),tw=F.i18n.translate("xpack.securitySolution.threatMatch.threatFieldDescription",{defaultMessage:"Indicator index field"}),aw=F.i18n.translate("xpack.securitySolution.threatMatch.fieldPlaceholderDescription",{defaultMessage:"Search"}),nw=F.i18n.translate("xpack.securitySolution.threatMatch.matchesLabel",{defaultMessage:"MATCHES"}),iw=F.i18n.translate("xpack.securitySolution.threatMatch.andDescription",{defaultMessage:"AND"}),rw=F.i18n.translate("xpack.securitySolution.threatMatch.orDescription",{defaultMessage:"OR"}),sw=F.i18n.translate("xpack.securitySolution.alerts.severityMapping.severityTitle",{defaultMessage:"Default severity"}),ow=F.i18n.translate("xpack.securitySolution.alerts.severityMapping.defaultSeverityTitle",{defaultMessage:"Severity"}),lw=F.i18n.translate("xpack.securitySolution.alerts.severityMapping.sourceFieldTitle",{defaultMessage:"Source field"}),cw=F.i18n.translate("xpack.securitySolution.alerts.severityMapping.sourceValueTitle",{defaultMessage:"Source value"}),uw=F.i18n.translate("xpack.securitySolution.alerts.severityMapping.severityMappingTitle",{defaultMessage:"Severity override"}),dw=F.i18n.translate("xpack.securitySolution.alerts.severityMapping.defaultDescriptionLabel",{defaultMessage:"Select a severity level for all alerts generated by this rule."}),pw=F.i18n.translate("xpack.securitySolution.alerts.severityMapping.mappingDescriptionLabel",{defaultMessage:"Use source event values to override the default severity."}),mw=F.i18n.translate("xpack.securitySolution.alerts.severityMapping.mappingDetailsLabel",{defaultMessage:"For multiple matches the highest severity match will apply. If no match is found, the default severity will be used."}),gw=F.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.riskScoreTitle",{defaultMessage:"Risk score"}),fw=F.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.defaultRiskScoreTitle",{defaultMessage:"Default risk score"}),bw=F.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.riskScoreFieldTitle",{defaultMessage:"kibana.alert.risk_score"}),hw=F.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.sourceFieldTitle",{defaultMessage:"Source field"}),yw=F.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.riskScoreMappingTitle",{defaultMessage:"Risk score override"}),Ew=F.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.defaultDescriptionLabel",{defaultMessage:"Select a risk score for all alerts generated by this rule."}),vw=F.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.mappingDescriptionLabel",{defaultMessage:"Use a source event value to override the default risk score."}),Tw=F.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.mappingDetailsLabel",{defaultMessage:"If value is out of bounds, or field is not present, the default risk score will be used."}),kw=[{id:"TA0009",name:"Collection",reference:"https://attack.mitre.org/tactics/TA0009",text:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.collectionDescription",{defaultMessage:"Collection (TA0009)"}),value:"collection"},{id:"TA0011",name:"Command and Control",reference:"https://attack.mitre.org/tactics/TA0011",text:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.commandAndControlDescription",{defaultMessage:"Command and Control (TA0011)"}),value:"commandAndControl"},{id:"TA0006",name:"Credential Access",reference:"https://attack.mitre.org/tactics/TA0006",text:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.credentialAccessDescription",{defaultMessage:"Credential Access (TA0006)"}),value:"credentialAccess"},{id:"TA0005",name:"Defense Evasion",reference:"https://attack.mitre.org/tactics/TA0005",text:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.defenseEvasionDescription",{defaultMessage:"Defense Evasion (TA0005)"}),value:"defenseEvasion"},{id:"TA0007",name:"Discovery",reference:"https://attack.mitre.org/tactics/TA0007",text:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.discoveryDescription",{defaultMessage:"Discovery (TA0007)"}),value:"discovery"},{id:"TA0002",name:"Execution",reference:"https://attack.mitre.org/tactics/TA0002",text:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.executionDescription",{defaultMessage:"Execution (TA0002)"}),value:"execution"},{id:"TA0010",name:"Exfiltration",reference:"https://attack.mitre.org/tactics/TA0010",text:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.exfiltrationDescription",{defaultMessage:"Exfiltration (TA0010)"}),value:"exfiltration"},{id:"TA0040",name:"Impact",reference:"https://attack.mitre.org/tactics/TA0040",text:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.impactDescription",{defaultMessage:"Impact (TA0040)"}),value:"impact"},{id:"TA0001",name:"Initial Access",reference:"https://attack.mitre.org/tactics/TA0001",text:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.initialAccessDescription",{defaultMessage:"Initial Access (TA0001)"}),value:"initialAccess"},{id:"TA0008",name:"Lateral Movement",reference:"https://attack.mitre.org/tactics/TA0008",text:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.lateralMovementDescription",{defaultMessage:"Lateral Movement (TA0008)"}),value:"lateralMovement"},{id:"TA0003",name:"Persistence",reference:"https://attack.mitre.org/tactics/TA0003",text:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.persistenceDescription",{defaultMessage:"Persistence (TA0003)"}),value:"persistence"},{id:"TA0004",name:"Privilege Escalation",reference:"https://attack.mitre.org/tactics/TA0004",text:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.privilegeEscalationDescription",{defaultMessage:"Privilege Escalation (TA0004)"}),value:"privilegeEscalation"},{id:"TA0043",name:"Reconnaissance",reference:"https://attack.mitre.org/tactics/TA0043",text:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.reconnaissanceDescription",{defaultMessage:"Reconnaissance (TA0043)"}),value:"reconnaissance"},{id:"TA0042",name:"Resource Development",reference:"https://attack.mitre.org/tactics/TA0042",text:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.resourceDevelopmentDescription",{defaultMessage:"Resource Development (TA0042)"}),value:"resourceDevelopment"}],xw=[{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.abuseElevationControlMechanismDescription",{defaultMessage:"Abuse Elevation Control Mechanism (T1548)"}),id:"T1548",name:"Abuse Elevation Control Mechanism",reference:"https://attack.mitre.org/techniques/T1548",tactics:"privilege-escalation,defense-evasion",value:"abuseElevationControlMechanism"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.accessTokenManipulationDescription",{defaultMessage:"Access Token Manipulation (T1134)"}),id:"T1134",name:"Access Token Manipulation",reference:"https://attack.mitre.org/techniques/T1134",tactics:"defense-evasion,privilege-escalation",value:"accessTokenManipulation"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.accountAccessRemovalDescription",{defaultMessage:"Account Access Removal (T1531)"}),id:"T1531",name:"Account Access Removal",reference:"https://attack.mitre.org/techniques/T1531",tactics:"impact",value:"accountAccessRemoval"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.accountDiscoveryDescription",{defaultMessage:"Account Discovery (T1087)"}),id:"T1087",name:"Account Discovery",reference:"https://attack.mitre.org/techniques/T1087",tactics:"discovery",value:"accountDiscovery"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.accountManipulationDescription",{defaultMessage:"Account Manipulation (T1098)"}),id:"T1098",name:"Account Manipulation",reference:"https://attack.mitre.org/techniques/T1098",tactics:"persistence",value:"accountManipulation"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.acquireInfrastructureDescription",{defaultMessage:"Acquire Infrastructure (T1583)"}),id:"T1583",name:"Acquire Infrastructure",reference:"https://attack.mitre.org/techniques/T1583",tactics:"resource-development",value:"acquireInfrastructure"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.activeScanningDescription",{defaultMessage:"Active Scanning (T1595)"}),id:"T1595",name:"Active Scanning",reference:"https://attack.mitre.org/techniques/T1595",tactics:"reconnaissance",value:"activeScanning"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.adversaryInTheMiddleDescription",{defaultMessage:"Adversary-in-the-Middle (T1557)"}),id:"T1557",name:"Adversary-in-the-Middle",reference:"https://attack.mitre.org/techniques/T1557",tactics:"credential-access,collection",value:"adversaryInTheMiddle"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.applicationLayerProtocolDescription",{defaultMessage:"Application Layer Protocol (T1071)"}),id:"T1071",name:"Application Layer Protocol",reference:"https://attack.mitre.org/techniques/T1071",tactics:"command-and-control",value:"applicationLayerProtocol"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.applicationWindowDiscoveryDescription",{defaultMessage:"Application Window Discovery (T1010)"}),id:"T1010",name:"Application Window Discovery",reference:"https://attack.mitre.org/techniques/T1010",tactics:"discovery",value:"applicationWindowDiscovery"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.archiveCollectedDataDescription",{defaultMessage:"Archive Collected Data (T1560)"}),id:"T1560",name:"Archive Collected Data",reference:"https://attack.mitre.org/techniques/T1560",tactics:"collection",value:"archiveCollectedData"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.audioCaptureDescription",{defaultMessage:"Audio Capture (T1123)"}),id:"T1123",name:"Audio Capture",reference:"https://attack.mitre.org/techniques/T1123",tactics:"collection",value:"audioCapture"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.automatedCollectionDescription",{defaultMessage:"Automated Collection (T1119)"}),id:"T1119",name:"Automated Collection",reference:"https://attack.mitre.org/techniques/T1119",tactics:"collection",value:"automatedCollection"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.automatedExfiltrationDescription",{defaultMessage:"Automated Exfiltration (T1020)"}),id:"T1020",name:"Automated Exfiltration",reference:"https://attack.mitre.org/techniques/T1020",tactics:"exfiltration",value:"automatedExfiltration"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.bitsJobsDescription",{defaultMessage:"BITS Jobs (T1197)"}),id:"T1197",name:"BITS Jobs",reference:"https://attack.mitre.org/techniques/T1197",tactics:"defense-evasion,persistence",value:"bitsJobs"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.bootOrLogonAutostartExecutionDescription",{defaultMessage:"Boot or Logon Autostart Execution (T1547)"}),id:"T1547",name:"Boot or Logon Autostart Execution",reference:"https://attack.mitre.org/techniques/T1547",tactics:"persistence,privilege-escalation",value:"bootOrLogonAutostartExecution"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.bootOrLogonInitializationScriptsDescription",{defaultMessage:"Boot or Logon Initialization Scripts (T1037)"}),id:"T1037",name:"Boot or Logon Initialization Scripts",reference:"https://attack.mitre.org/techniques/T1037",tactics:"persistence,privilege-escalation",value:"bootOrLogonInitializationScripts"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.browserBookmarkDiscoveryDescription",{defaultMessage:"Browser Bookmark Discovery (T1217)"}),id:"T1217",name:"Browser Bookmark Discovery",reference:"https://attack.mitre.org/techniques/T1217",tactics:"discovery",value:"browserBookmarkDiscovery"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.browserExtensionsDescription",{defaultMessage:"Browser Extensions (T1176)"}),id:"T1176",name:"Browser Extensions",reference:"https://attack.mitre.org/techniques/T1176",tactics:"persistence",value:"browserExtensions"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.browserSessionHijackingDescription",{defaultMessage:"Browser Session Hijacking (T1185)"}),id:"T1185",name:"Browser Session Hijacking",reference:"https://attack.mitre.org/techniques/T1185",tactics:"collection",value:"browserSessionHijacking"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.bruteForceDescription",{defaultMessage:"Brute Force (T1110)"}),id:"T1110",name:"Brute Force",reference:"https://attack.mitre.org/techniques/T1110",tactics:"credential-access",value:"bruteForce"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.buildImageOnHostDescription",{defaultMessage:"Build Image on Host (T1612)"}),id:"T1612",name:"Build Image on Host",reference:"https://attack.mitre.org/techniques/T1612",tactics:"defense-evasion",value:"buildImageOnHost"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.clipboardDataDescription",{defaultMessage:"Clipboard Data (T1115)"}),id:"T1115",name:"Clipboard Data",reference:"https://attack.mitre.org/techniques/T1115",tactics:"collection",value:"clipboardData"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.cloudInfrastructureDiscoveryDescription",{defaultMessage:"Cloud Infrastructure Discovery (T1580)"}),id:"T1580",name:"Cloud Infrastructure Discovery",reference:"https://attack.mitre.org/techniques/T1580",tactics:"discovery",value:"cloudInfrastructureDiscovery"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.cloudServiceDashboardDescription",{defaultMessage:"Cloud Service Dashboard (T1538)"}),id:"T1538",name:"Cloud Service Dashboard",reference:"https://attack.mitre.org/techniques/T1538",tactics:"discovery",value:"cloudServiceDashboard"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.cloudServiceDiscoveryDescription",{defaultMessage:"Cloud Service Discovery (T1526)"}),id:"T1526",name:"Cloud Service Discovery",reference:"https://attack.mitre.org/techniques/T1526",tactics:"discovery",value:"cloudServiceDiscovery"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.cloudStorageObjectDiscoveryDescription",{defaultMessage:"Cloud Storage Object Discovery (T1619)"}),id:"T1619",name:"Cloud Storage Object Discovery",reference:"https://attack.mitre.org/techniques/T1619",tactics:"discovery",value:"cloudStorageObjectDiscovery"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.commandAndScriptingInterpreterDescription",{defaultMessage:"Command and Scripting Interpreter (T1059)"}),id:"T1059",name:"Command and Scripting Interpreter",reference:"https://attack.mitre.org/techniques/T1059",tactics:"execution",value:"commandAndScriptingInterpreter"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.commonlyUsedPortDescription",{defaultMessage:"Commonly Used Port (T1043)"}),id:"T1043",name:"Commonly Used Port",reference:"https://attack.mitre.org/techniques/T1043",tactics:"command-and-control",value:"commonlyUsedPort"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.communicationThroughRemovableMediaDescription",{defaultMessage:"Communication Through Removable Media (T1092)"}),id:"T1092",name:"Communication Through Removable Media",reference:"https://attack.mitre.org/techniques/T1092",tactics:"command-and-control",value:"communicationThroughRemovableMedia"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.componentObjectModelAndDistributedComDescription",{defaultMessage:"Component Object Model and Distributed COM (T1175)"}),id:"T1175",name:"Component Object Model and Distributed COM",reference:"https://attack.mitre.org/techniques/T1175",tactics:"lateral-movement,execution",value:"componentObjectModelAndDistributedCom"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.compromiseAccountsDescription",{defaultMessage:"Compromise Accounts (T1586)"}),id:"T1586",name:"Compromise Accounts",reference:"https://attack.mitre.org/techniques/T1586",tactics:"resource-development",value:"compromiseAccounts"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.compromiseClientSoftwareBinaryDescription",{defaultMessage:"Compromise Client Software Binary (T1554)"}),id:"T1554",name:"Compromise Client Software Binary",reference:"https://attack.mitre.org/techniques/T1554",tactics:"persistence",value:"compromiseClientSoftwareBinary"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.compromiseInfrastructureDescription",{defaultMessage:"Compromise Infrastructure (T1584)"}),id:"T1584",name:"Compromise Infrastructure",reference:"https://attack.mitre.org/techniques/T1584",tactics:"resource-development",value:"compromiseInfrastructure"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.containerAdministrationCommandDescription",{defaultMessage:"Container Administration Command (T1609)"}),id:"T1609",name:"Container Administration Command",reference:"https://attack.mitre.org/techniques/T1609",tactics:"execution",value:"containerAdministrationCommand"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.containerAndResourceDiscoveryDescription",{defaultMessage:"Container and Resource Discovery (T1613)"}),id:"T1613",name:"Container and Resource Discovery",reference:"https://attack.mitre.org/techniques/T1613",tactics:"discovery",value:"containerAndResourceDiscovery"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.createAccountDescription",{defaultMessage:"Create Account (T1136)"}),id:"T1136",name:"Create Account",reference:"https://attack.mitre.org/techniques/T1136",tactics:"persistence",value:"createAccount"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.createOrModifySystemProcessDescription",{defaultMessage:"Create or Modify System Process (T1543)"}),id:"T1543",name:"Create or Modify System Process",reference:"https://attack.mitre.org/techniques/T1543",tactics:"persistence,privilege-escalation",value:"createOrModifySystemProcess"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.credentialsFromPasswordStoresDescription",{defaultMessage:"Credentials from Password Stores (T1555)"}),id:"T1555",name:"Credentials from Password Stores",reference:"https://attack.mitre.org/techniques/T1555",tactics:"credential-access",value:"credentialsFromPasswordStores"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataDestructionDescription",{defaultMessage:"Data Destruction (T1485)"}),id:"T1485",name:"Data Destruction",reference:"https://attack.mitre.org/techniques/T1485",tactics:"impact",value:"dataDestruction"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataEncodingDescription",{defaultMessage:"Data Encoding (T1132)"}),id:"T1132",name:"Data Encoding",reference:"https://attack.mitre.org/techniques/T1132",tactics:"command-and-control",value:"dataEncoding"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataEncryptedForImpactDescription",{defaultMessage:"Data Encrypted for Impact (T1486)"}),id:"T1486",name:"Data Encrypted for Impact",reference:"https://attack.mitre.org/techniques/T1486",tactics:"impact",value:"dataEncryptedForImpact"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataManipulationDescription",{defaultMessage:"Data Manipulation (T1565)"}),id:"T1565",name:"Data Manipulation",reference:"https://attack.mitre.org/techniques/T1565",tactics:"impact",value:"dataManipulation"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataObfuscationDescription",{defaultMessage:"Data Obfuscation (T1001)"}),id:"T1001",name:"Data Obfuscation",reference:"https://attack.mitre.org/techniques/T1001",tactics:"command-and-control",value:"dataObfuscation"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataStagedDescription",{defaultMessage:"Data Staged (T1074)"}),id:"T1074",name:"Data Staged",reference:"https://attack.mitre.org/techniques/T1074",tactics:"collection",value:"dataStaged"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataTransferSizeLimitsDescription",{defaultMessage:"Data Transfer Size Limits (T1030)"}),id:"T1030",name:"Data Transfer Size Limits",reference:"https://attack.mitre.org/techniques/T1030",tactics:"exfiltration",value:"dataTransferSizeLimits"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataFromCloudStorageObjectDescription",{defaultMessage:"Data from Cloud Storage Object (T1530)"}),id:"T1530",name:"Data from Cloud Storage Object",reference:"https://attack.mitre.org/techniques/T1530",tactics:"collection",value:"dataFromCloudStorageObject"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataFromConfigurationRepositoryDescription",{defaultMessage:"Data from Configuration Repository (T1602)"}),id:"T1602",name:"Data from Configuration Repository",reference:"https://attack.mitre.org/techniques/T1602",tactics:"collection",value:"dataFromConfigurationRepository"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataFromInformationRepositoriesDescription",{defaultMessage:"Data from Information Repositories (T1213)"}),id:"T1213",name:"Data from Information Repositories",reference:"https://attack.mitre.org/techniques/T1213",tactics:"collection",value:"dataFromInformationRepositories"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataFromLocalSystemDescription",{defaultMessage:"Data from Local System (T1005)"}),id:"T1005",name:"Data from Local System",reference:"https://attack.mitre.org/techniques/T1005",tactics:"collection",value:"dataFromLocalSystem"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataFromNetworkSharedDriveDescription",{defaultMessage:"Data from Network Shared Drive (T1039)"}),id:"T1039",name:"Data from Network Shared Drive",reference:"https://attack.mitre.org/techniques/T1039",tactics:"collection",value:"dataFromNetworkSharedDrive"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataFromRemovableMediaDescription",{defaultMessage:"Data from Removable Media (T1025)"}),id:"T1025",name:"Data from Removable Media",reference:"https://attack.mitre.org/techniques/T1025",tactics:"collection",value:"dataFromRemovableMedia"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.defacementDescription",{defaultMessage:"Defacement (T1491)"}),id:"T1491",name:"Defacement",reference:"https://attack.mitre.org/techniques/T1491",tactics:"impact",value:"defacement"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.deobfuscateDecodeFilesOrInformationDescription",{defaultMessage:"Deobfuscate/Decode Files or Information (T1140)"}),id:"T1140",name:"Deobfuscate/Decode Files or Information",reference:"https://attack.mitre.org/techniques/T1140",tactics:"defense-evasion",value:"deobfuscateDecodeFilesOrInformation"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.deployContainerDescription",{defaultMessage:"Deploy Container (T1610)"}),id:"T1610",name:"Deploy Container",reference:"https://attack.mitre.org/techniques/T1610",tactics:"defense-evasion,execution",value:"deployContainer"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.developCapabilitiesDescription",{defaultMessage:"Develop Capabilities (T1587)"}),id:"T1587",name:"Develop Capabilities",reference:"https://attack.mitre.org/techniques/T1587",tactics:"resource-development",value:"developCapabilities"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.directVolumeAccessDescription",{defaultMessage:"Direct Volume Access (T1006)"}),id:"T1006",name:"Direct Volume Access",reference:"https://attack.mitre.org/techniques/T1006",tactics:"defense-evasion",value:"directVolumeAccess"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.diskWipeDescription",{defaultMessage:"Disk Wipe (T1561)"}),id:"T1561",name:"Disk Wipe",reference:"https://attack.mitre.org/techniques/T1561",tactics:"impact",value:"diskWipe"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.domainPolicyModificationDescription",{defaultMessage:"Domain Policy Modification (T1484)"}),id:"T1484",name:"Domain Policy Modification",reference:"https://attack.mitre.org/techniques/T1484",tactics:"defense-evasion,privilege-escalation",value:"domainPolicyModification"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.domainTrustDiscoveryDescription",{defaultMessage:"Domain Trust Discovery (T1482)"}),id:"T1482",name:"Domain Trust Discovery",reference:"https://attack.mitre.org/techniques/T1482",tactics:"discovery",value:"domainTrustDiscovery"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.driveByCompromiseDescription",{defaultMessage:"Drive-by Compromise (T1189)"}),id:"T1189",name:"Drive-by Compromise",reference:"https://attack.mitre.org/techniques/T1189",tactics:"initial-access",value:"driveByCompromise"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dynamicResolutionDescription",{defaultMessage:"Dynamic Resolution (T1568)"}),id:"T1568",name:"Dynamic Resolution",reference:"https://attack.mitre.org/techniques/T1568",tactics:"command-and-control",value:"dynamicResolution"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.emailCollectionDescription",{defaultMessage:"Email Collection (T1114)"}),id:"T1114",name:"Email Collection",reference:"https://attack.mitre.org/techniques/T1114",tactics:"collection",value:"emailCollection"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.encryptedChannelDescription",{defaultMessage:"Encrypted Channel (T1573)"}),id:"T1573",name:"Encrypted Channel",reference:"https://attack.mitre.org/techniques/T1573",tactics:"command-and-control",value:"encryptedChannel"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.endpointDenialOfServiceDescription",{defaultMessage:"Endpoint Denial of Service (T1499)"}),id:"T1499",name:"Endpoint Denial of Service",reference:"https://attack.mitre.org/techniques/T1499",tactics:"impact",value:"endpointDenialOfService"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.escapeToHostDescription",{defaultMessage:"Escape to Host (T1611)"}),id:"T1611",name:"Escape to Host",reference:"https://attack.mitre.org/techniques/T1611",tactics:"privilege-escalation",value:"escapeToHost"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.establishAccountsDescription",{defaultMessage:"Establish Accounts (T1585)"}),id:"T1585",name:"Establish Accounts",reference:"https://attack.mitre.org/techniques/T1585",tactics:"resource-development",value:"establishAccounts"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.eventTriggeredExecutionDescription",{defaultMessage:"Event Triggered Execution (T1546)"}),id:"T1546",name:"Event Triggered Execution",reference:"https://attack.mitre.org/techniques/T1546",tactics:"privilege-escalation,persistence",value:"eventTriggeredExecution"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.executionGuardrailsDescription",{defaultMessage:"Execution Guardrails (T1480)"}),id:"T1480",name:"Execution Guardrails",reference:"https://attack.mitre.org/techniques/T1480",tactics:"defense-evasion",value:"executionGuardrails"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exfiltrationOverAlternativeProtocolDescription",{defaultMessage:"Exfiltration Over Alternative Protocol (T1048)"}),id:"T1048",name:"Exfiltration Over Alternative Protocol",reference:"https://attack.mitre.org/techniques/T1048",tactics:"exfiltration",value:"exfiltrationOverAlternativeProtocol"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exfiltrationOverC2ChannelDescription",{defaultMessage:"Exfiltration Over C2 Channel (T1041)"}),id:"T1041",name:"Exfiltration Over C2 Channel",reference:"https://attack.mitre.org/techniques/T1041",tactics:"exfiltration",value:"exfiltrationOverC2Channel"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exfiltrationOverOtherNetworkMediumDescription",{defaultMessage:"Exfiltration Over Other Network Medium (T1011)"}),id:"T1011",name:"Exfiltration Over Other Network Medium",reference:"https://attack.mitre.org/techniques/T1011",tactics:"exfiltration",value:"exfiltrationOverOtherNetworkMedium"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exfiltrationOverPhysicalMediumDescription",{defaultMessage:"Exfiltration Over Physical Medium (T1052)"}),id:"T1052",name:"Exfiltration Over Physical Medium",reference:"https://attack.mitre.org/techniques/T1052",tactics:"exfiltration",value:"exfiltrationOverPhysicalMedium"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exfiltrationOverWebServiceDescription",{defaultMessage:"Exfiltration Over Web Service (T1567)"}),id:"T1567",name:"Exfiltration Over Web Service",reference:"https://attack.mitre.org/techniques/T1567",tactics:"exfiltration",value:"exfiltrationOverWebService"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exploitPublicFacingApplicationDescription",{defaultMessage:"Exploit Public-Facing Application (T1190)"}),id:"T1190",name:"Exploit Public-Facing Application",reference:"https://attack.mitre.org/techniques/T1190",tactics:"initial-access",value:"exploitPublicFacingApplication"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exploitationForClientExecutionDescription",{defaultMessage:"Exploitation for Client Execution (T1203)"}),id:"T1203",name:"Exploitation for Client Execution",reference:"https://attack.mitre.org/techniques/T1203",tactics:"execution",value:"exploitationForClientExecution"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exploitationForCredentialAccessDescription",{defaultMessage:"Exploitation for Credential Access (T1212)"}),id:"T1212",name:"Exploitation for Credential Access",reference:"https://attack.mitre.org/techniques/T1212",tactics:"credential-access",value:"exploitationForCredentialAccess"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exploitationForDefenseEvasionDescription",{defaultMessage:"Exploitation for Defense Evasion (T1211)"}),id:"T1211",name:"Exploitation for Defense Evasion",reference:"https://attack.mitre.org/techniques/T1211",tactics:"defense-evasion",value:"exploitationForDefenseEvasion"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exploitationForPrivilegeEscalationDescription",{defaultMessage:"Exploitation for Privilege Escalation (T1068)"}),id:"T1068",name:"Exploitation for Privilege Escalation",reference:"https://attack.mitre.org/techniques/T1068",tactics:"privilege-escalation",value:"exploitationForPrivilegeEscalation"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exploitationOfRemoteServicesDescription",{defaultMessage:"Exploitation of Remote Services (T1210)"}),id:"T1210",name:"Exploitation of Remote Services",reference:"https://attack.mitre.org/techniques/T1210",tactics:"lateral-movement",value:"exploitationOfRemoteServices"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.externalRemoteServicesDescription",{defaultMessage:"External Remote Services (T1133)"}),id:"T1133",name:"External Remote Services",reference:"https://attack.mitre.org/techniques/T1133",tactics:"persistence,initial-access",value:"externalRemoteServices"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.fallbackChannelsDescription",{defaultMessage:"Fallback Channels (T1008)"}),id:"T1008",name:"Fallback Channels",reference:"https://attack.mitre.org/techniques/T1008",tactics:"command-and-control",value:"fallbackChannels"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.fileAndDirectoryDiscoveryDescription",{defaultMessage:"File and Directory Discovery (T1083)"}),id:"T1083",name:"File and Directory Discovery",reference:"https://attack.mitre.org/techniques/T1083",tactics:"discovery",value:"fileAndDirectoryDiscovery"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.fileAndDirectoryPermissionsModificationDescription",{defaultMessage:"File and Directory Permissions Modification (T1222)"}),id:"T1222",name:"File and Directory Permissions Modification",reference:"https://attack.mitre.org/techniques/T1222",tactics:"defense-evasion",value:"fileAndDirectoryPermissionsModification"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.firmwareCorruptionDescription",{defaultMessage:"Firmware Corruption (T1495)"}),id:"T1495",name:"Firmware Corruption",reference:"https://attack.mitre.org/techniques/T1495",tactics:"impact",value:"firmwareCorruption"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.forcedAuthenticationDescription",{defaultMessage:"Forced Authentication (T1187)"}),id:"T1187",name:"Forced Authentication",reference:"https://attack.mitre.org/techniques/T1187",tactics:"credential-access",value:"forcedAuthentication"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.forgeWebCredentialsDescription",{defaultMessage:"Forge Web Credentials (T1606)"}),id:"T1606",name:"Forge Web Credentials",reference:"https://attack.mitre.org/techniques/T1606",tactics:"credential-access",value:"forgeWebCredentials"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.gatherVictimHostInformationDescription",{defaultMessage:"Gather Victim Host Information (T1592)"}),id:"T1592",name:"Gather Victim Host Information",reference:"https://attack.mitre.org/techniques/T1592",tactics:"reconnaissance",value:"gatherVictimHostInformation"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.gatherVictimIdentityInformationDescription",{defaultMessage:"Gather Victim Identity Information (T1589)"}),id:"T1589",name:"Gather Victim Identity Information",reference:"https://attack.mitre.org/techniques/T1589",tactics:"reconnaissance",value:"gatherVictimIdentityInformation"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.gatherVictimNetworkInformationDescription",{defaultMessage:"Gather Victim Network Information (T1590)"}),id:"T1590",name:"Gather Victim Network Information",reference:"https://attack.mitre.org/techniques/T1590",tactics:"reconnaissance",value:"gatherVictimNetworkInformation"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.gatherVictimOrgInformationDescription",{defaultMessage:"Gather Victim Org Information (T1591)"}),id:"T1591",name:"Gather Victim Org Information",reference:"https://attack.mitre.org/techniques/T1591",tactics:"reconnaissance",value:"gatherVictimOrgInformation"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.graphicalUserInterfaceDescription",{defaultMessage:"Graphical User Interface (T1061)"}),id:"T1061",name:"Graphical User Interface",reference:"https://attack.mitre.org/techniques/T1061",tactics:"execution",value:"graphicalUserInterface"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.groupPolicyDiscoveryDescription",{defaultMessage:"Group Policy Discovery (T1615)"}),id:"T1615",name:"Group Policy Discovery",reference:"https://attack.mitre.org/techniques/T1615",tactics:"discovery",value:"groupPolicyDiscovery"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.hardwareAdditionsDescription",{defaultMessage:"Hardware Additions (T1200)"}),id:"T1200",name:"Hardware Additions",reference:"https://attack.mitre.org/techniques/T1200",tactics:"initial-access",value:"hardwareAdditions"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.hideArtifactsDescription",{defaultMessage:"Hide Artifacts (T1564)"}),id:"T1564",name:"Hide Artifacts",reference:"https://attack.mitre.org/techniques/T1564",tactics:"defense-evasion",value:"hideArtifacts"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.hijackExecutionFlowDescription",{defaultMessage:"Hijack Execution Flow (T1574)"}),id:"T1574",name:"Hijack Execution Flow",reference:"https://attack.mitre.org/techniques/T1574",tactics:"persistence,privilege-escalation,defense-evasion",value:"hijackExecutionFlow"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.hypervisorDescription",{defaultMessage:"Hypervisor (T1062)"}),id:"T1062",name:"Hypervisor",reference:"https://attack.mitre.org/techniques/T1062",tactics:"persistence",value:"hypervisor"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.impairDefensesDescription",{defaultMessage:"Impair Defenses (T1562)"}),id:"T1562",name:"Impair Defenses",reference:"https://attack.mitre.org/techniques/T1562",tactics:"defense-evasion",value:"impairDefenses"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.implantInternalImageDescription",{defaultMessage:"Implant Internal Image (T1525)"}),id:"T1525",name:"Implant Internal Image",reference:"https://attack.mitre.org/techniques/T1525",tactics:"persistence",value:"implantInternalImage"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.indicatorRemovalOnHostDescription",{defaultMessage:"Indicator Removal on Host (T1070)"}),id:"T1070",name:"Indicator Removal on Host",reference:"https://attack.mitre.org/techniques/T1070",tactics:"defense-evasion",value:"indicatorRemovalOnHost"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.indirectCommandExecutionDescription",{defaultMessage:"Indirect Command Execution (T1202)"}),id:"T1202",name:"Indirect Command Execution",reference:"https://attack.mitre.org/techniques/T1202",tactics:"defense-evasion",value:"indirectCommandExecution"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.ingressToolTransferDescription",{defaultMessage:"Ingress Tool Transfer (T1105)"}),id:"T1105",name:"Ingress Tool Transfer",reference:"https://attack.mitre.org/techniques/T1105",tactics:"command-and-control",value:"ingressToolTransfer"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.inhibitSystemRecoveryDescription",{defaultMessage:"Inhibit System Recovery (T1490)"}),id:"T1490",name:"Inhibit System Recovery",reference:"https://attack.mitre.org/techniques/T1490",tactics:"impact",value:"inhibitSystemRecovery"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.inputCaptureDescription",{defaultMessage:"Input Capture (T1056)"}),id:"T1056",name:"Input Capture",reference:"https://attack.mitre.org/techniques/T1056",tactics:"collection,credential-access",value:"inputCapture"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.interProcessCommunicationDescription",{defaultMessage:"Inter-Process Communication (T1559)"}),id:"T1559",name:"Inter-Process Communication",reference:"https://attack.mitre.org/techniques/T1559",tactics:"execution",value:"interProcessCommunication"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.internalSpearphishingDescription",{defaultMessage:"Internal Spearphishing (T1534)"}),id:"T1534",name:"Internal Spearphishing",reference:"https://attack.mitre.org/techniques/T1534",tactics:"lateral-movement",value:"internalSpearphishing"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.lcMainHijackingDescription",{defaultMessage:"LC_MAIN Hijacking (T1149)"}),id:"T1149",name:"LC_MAIN Hijacking",reference:"https://attack.mitre.org/techniques/T1149",tactics:"defense-evasion",value:"lcMainHijacking"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.lateralToolTransferDescription",{defaultMessage:"Lateral Tool Transfer (T1570)"}),id:"T1570",name:"Lateral Tool Transfer",reference:"https://attack.mitre.org/techniques/T1570",tactics:"lateral-movement",value:"lateralToolTransfer"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.masqueradingDescription",{defaultMessage:"Masquerading (T1036)"}),id:"T1036",name:"Masquerading",reference:"https://attack.mitre.org/techniques/T1036",tactics:"defense-evasion",value:"masquerading"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.modifyAuthenticationProcessDescription",{defaultMessage:"Modify Authentication Process (T1556)"}),id:"T1556",name:"Modify Authentication Process",reference:"https://attack.mitre.org/techniques/T1556",tactics:"credential-access,defense-evasion,persistence",value:"modifyAuthenticationProcess"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.modifyCloudComputeInfrastructureDescription",{defaultMessage:"Modify Cloud Compute Infrastructure (T1578)"}),id:"T1578",name:"Modify Cloud Compute Infrastructure",reference:"https://attack.mitre.org/techniques/T1578",tactics:"defense-evasion",value:"modifyCloudComputeInfrastructure"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.modifyRegistryDescription",{defaultMessage:"Modify Registry (T1112)"}),id:"T1112",name:"Modify Registry",reference:"https://attack.mitre.org/techniques/T1112",tactics:"defense-evasion",value:"modifyRegistry"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.modifySystemImageDescription",{defaultMessage:"Modify System Image (T1601)"}),id:"T1601",name:"Modify System Image",reference:"https://attack.mitre.org/techniques/T1601",tactics:"defense-evasion",value:"modifySystemImage"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.multiStageChannelsDescription",{defaultMessage:"Multi-Stage Channels (T1104)"}),id:"T1104",name:"Multi-Stage Channels",reference:"https://attack.mitre.org/techniques/T1104",tactics:"command-and-control",value:"multiStageChannels"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.multibandCommunicationDescription",{defaultMessage:"Multiband Communication (T1026)"}),id:"T1026",name:"Multiband Communication",reference:"https://attack.mitre.org/techniques/T1026",tactics:"command-and-control",value:"multibandCommunication"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.nativeApiDescription",{defaultMessage:"Native API (T1106)"}),id:"T1106",name:"Native API",reference:"https://attack.mitre.org/techniques/T1106",tactics:"execution",value:"nativeApi"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.networkBoundaryBridgingDescription",{defaultMessage:"Network Boundary Bridging (T1599)"}),id:"T1599",name:"Network Boundary Bridging",reference:"https://attack.mitre.org/techniques/T1599",tactics:"defense-evasion",value:"networkBoundaryBridging"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.networkDenialOfServiceDescription",{defaultMessage:"Network Denial of Service (T1498)"}),id:"T1498",name:"Network Denial of Service",reference:"https://attack.mitre.org/techniques/T1498",tactics:"impact",value:"networkDenialOfService"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.networkServiceScanningDescription",{defaultMessage:"Network Service Scanning (T1046)"}),id:"T1046",name:"Network Service Scanning",reference:"https://attack.mitre.org/techniques/T1046",tactics:"discovery",value:"networkServiceScanning"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.networkShareDiscoveryDescription",{defaultMessage:"Network Share Discovery (T1135)"}),id:"T1135",name:"Network Share Discovery",reference:"https://attack.mitre.org/techniques/T1135",tactics:"discovery",value:"networkShareDiscovery"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.networkSniffingDescription",{defaultMessage:"Network Sniffing (T1040)"}),id:"T1040",name:"Network Sniffing",reference:"https://attack.mitre.org/techniques/T1040",tactics:"credential-access,discovery",value:"networkSniffing"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.nonApplicationLayerProtocolDescription",{defaultMessage:"Non-Application Layer Protocol (T1095)"}),id:"T1095",name:"Non-Application Layer Protocol",reference:"https://attack.mitre.org/techniques/T1095",tactics:"command-and-control",value:"nonApplicationLayerProtocol"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.nonStandardPortDescription",{defaultMessage:"Non-Standard Port (T1571)"}),id:"T1571",name:"Non-Standard Port",reference:"https://attack.mitre.org/techniques/T1571",tactics:"command-and-control",value:"nonStandardPort"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.osCredentialDumpingDescription",{defaultMessage:"OS Credential Dumping (T1003)"}),id:"T1003",name:"OS Credential Dumping",reference:"https://attack.mitre.org/techniques/T1003",tactics:"credential-access",value:"osCredentialDumping"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.obfuscatedFilesOrInformationDescription",{defaultMessage:"Obfuscated Files or Information (T1027)"}),id:"T1027",name:"Obfuscated Files or Information",reference:"https://attack.mitre.org/techniques/T1027",tactics:"defense-evasion",value:"obfuscatedFilesOrInformation"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.obtainCapabilitiesDescription",{defaultMessage:"Obtain Capabilities (T1588)"}),id:"T1588",name:"Obtain Capabilities",reference:"https://attack.mitre.org/techniques/T1588",tactics:"resource-development",value:"obtainCapabilities"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.officeApplicationStartupDescription",{defaultMessage:"Office Application Startup (T1137)"}),id:"T1137",name:"Office Application Startup",reference:"https://attack.mitre.org/techniques/T1137",tactics:"persistence",value:"officeApplicationStartup"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.passwordPolicyDiscoveryDescription",{defaultMessage:"Password Policy Discovery (T1201)"}),id:"T1201",name:"Password Policy Discovery",reference:"https://attack.mitre.org/techniques/T1201",tactics:"discovery",value:"passwordPolicyDiscovery"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.pathInterceptionDescription",{defaultMessage:"Path Interception (T1034)"}),id:"T1034",name:"Path Interception",reference:"https://attack.mitre.org/techniques/T1034",tactics:"persistence,privilege-escalation",value:"pathInterception"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.peripheralDeviceDiscoveryDescription",{defaultMessage:"Peripheral Device Discovery (T1120)"}),id:"T1120",name:"Peripheral Device Discovery",reference:"https://attack.mitre.org/techniques/T1120",tactics:"discovery",value:"peripheralDeviceDiscovery"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.permissionGroupsDiscoveryDescription",{defaultMessage:"Permission Groups Discovery (T1069)"}),id:"T1069",name:"Permission Groups Discovery",reference:"https://attack.mitre.org/techniques/T1069",tactics:"discovery",value:"permissionGroupsDiscovery"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.phishingDescription",{defaultMessage:"Phishing (T1566)"}),id:"T1566",name:"Phishing",reference:"https://attack.mitre.org/techniques/T1566",tactics:"initial-access",value:"phishing"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.phishingForInformationDescription",{defaultMessage:"Phishing for Information (T1598)"}),id:"T1598",name:"Phishing for Information",reference:"https://attack.mitre.org/techniques/T1598",tactics:"reconnaissance",value:"phishingForInformation"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.preOsBootDescription",{defaultMessage:"Pre-OS Boot (T1542)"}),id:"T1542",name:"Pre-OS Boot",reference:"https://attack.mitre.org/techniques/T1542",tactics:"defense-evasion,persistence",value:"preOsBoot"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.processDiscoveryDescription",{defaultMessage:"Process Discovery (T1057)"}),id:"T1057",name:"Process Discovery",reference:"https://attack.mitre.org/techniques/T1057",tactics:"discovery",value:"processDiscovery"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.processInjectionDescription",{defaultMessage:"Process Injection (T1055)"}),id:"T1055",name:"Process Injection",reference:"https://attack.mitre.org/techniques/T1055",tactics:"defense-evasion,privilege-escalation",value:"processInjection"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.protocolTunnelingDescription",{defaultMessage:"Protocol Tunneling (T1572)"}),id:"T1572",name:"Protocol Tunneling",reference:"https://attack.mitre.org/techniques/T1572",tactics:"command-and-control",value:"protocolTunneling"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.proxyDescription",{defaultMessage:"Proxy (T1090)"}),id:"T1090",name:"Proxy",reference:"https://attack.mitre.org/techniques/T1090",tactics:"command-and-control",value:"proxy"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.queryRegistryDescription",{defaultMessage:"Query Registry (T1012)"}),id:"T1012",name:"Query Registry",reference:"https://attack.mitre.org/techniques/T1012",tactics:"discovery",value:"queryRegistry"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.redundantAccessDescription",{defaultMessage:"Redundant Access (T1108)"}),id:"T1108",name:"Redundant Access",reference:"https://attack.mitre.org/techniques/T1108",tactics:"defense-evasion,persistence",value:"redundantAccess"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.reflectiveCodeLoadingDescription",{defaultMessage:"Reflective Code Loading (T1620)"}),id:"T1620",name:"Reflective Code Loading",reference:"https://attack.mitre.org/techniques/T1620",tactics:"defense-evasion",value:"reflectiveCodeLoading"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.remoteAccessSoftwareDescription",{defaultMessage:"Remote Access Software (T1219)"}),id:"T1219",name:"Remote Access Software",reference:"https://attack.mitre.org/techniques/T1219",tactics:"command-and-control",value:"remoteAccessSoftware"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.remoteServiceSessionHijackingDescription",{defaultMessage:"Remote Service Session Hijacking (T1563)"}),id:"T1563",name:"Remote Service Session Hijacking",reference:"https://attack.mitre.org/techniques/T1563",tactics:"lateral-movement",value:"remoteServiceSessionHijacking"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.remoteServicesDescription",{defaultMessage:"Remote Services (T1021)"}),id:"T1021",name:"Remote Services",reference:"https://attack.mitre.org/techniques/T1021",tactics:"lateral-movement",value:"remoteServices"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.remoteSystemDiscoveryDescription",{defaultMessage:"Remote System Discovery (T1018)"}),id:"T1018",name:"Remote System Discovery",reference:"https://attack.mitre.org/techniques/T1018",tactics:"discovery",value:"remoteSystemDiscovery"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.replicationThroughRemovableMediaDescription",{defaultMessage:"Replication Through Removable Media (T1091)"}),id:"T1091",name:"Replication Through Removable Media",reference:"https://attack.mitre.org/techniques/T1091",tactics:"lateral-movement,initial-access",value:"replicationThroughRemovableMedia"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.resourceHijackingDescription",{defaultMessage:"Resource Hijacking (T1496)"}),id:"T1496",name:"Resource Hijacking",reference:"https://attack.mitre.org/techniques/T1496",tactics:"impact",value:"resourceHijacking"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.rogueDomainControllerDescription",{defaultMessage:"Rogue Domain Controller (T1207)"}),id:"T1207",name:"Rogue Domain Controller",reference:"https://attack.mitre.org/techniques/T1207",tactics:"defense-evasion",value:"rogueDomainController"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.rootkitDescription",{defaultMessage:"Rootkit (T1014)"}),id:"T1014",name:"Rootkit",reference:"https://attack.mitre.org/techniques/T1014",tactics:"defense-evasion",value:"rootkit"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.scheduledTaskJobDescription",{defaultMessage:"Scheduled Task/Job (T1053)"}),id:"T1053",name:"Scheduled Task/Job",reference:"https://attack.mitre.org/techniques/T1053",tactics:"execution,persistence,privilege-escalation",value:"scheduledTaskJob"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.scheduledTransferDescription",{defaultMessage:"Scheduled Transfer (T1029)"}),id:"T1029",name:"Scheduled Transfer",reference:"https://attack.mitre.org/techniques/T1029",tactics:"exfiltration",value:"scheduledTransfer"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.screenCaptureDescription",{defaultMessage:"Screen Capture (T1113)"}),id:"T1113",name:"Screen Capture",reference:"https://attack.mitre.org/techniques/T1113",tactics:"collection",value:"screenCapture"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.scriptingDescription",{defaultMessage:"Scripting (T1064)"}),id:"T1064",name:"Scripting",reference:"https://attack.mitre.org/techniques/T1064",tactics:"defense-evasion,execution",value:"scripting"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.searchClosedSourcesDescription",{defaultMessage:"Search Closed Sources (T1597)"}),id:"T1597",name:"Search Closed Sources",reference:"https://attack.mitre.org/techniques/T1597",tactics:"reconnaissance",value:"searchClosedSources"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.searchOpenTechnicalDatabasesDescription",{defaultMessage:"Search Open Technical Databases (T1596)"}),id:"T1596",name:"Search Open Technical Databases",reference:"https://attack.mitre.org/techniques/T1596",tactics:"reconnaissance",value:"searchOpenTechnicalDatabases"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.searchOpenWebsitesDomainsDescription",{defaultMessage:"Search Open Websites/Domains (T1593)"}),id:"T1593",name:"Search Open Websites/Domains",reference:"https://attack.mitre.org/techniques/T1593",tactics:"reconnaissance",value:"searchOpenWebsitesDomains"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.searchVictimOwnedWebsitesDescription",{defaultMessage:"Search Victim-Owned Websites (T1594)"}),id:"T1594",name:"Search Victim-Owned Websites",reference:"https://attack.mitre.org/techniques/T1594",tactics:"reconnaissance",value:"searchVictimOwnedWebsites"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.serverSoftwareComponentDescription",{defaultMessage:"Server Software Component (T1505)"}),id:"T1505",name:"Server Software Component",reference:"https://attack.mitre.org/techniques/T1505",tactics:"persistence",value:"serverSoftwareComponent"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.serviceStopDescription",{defaultMessage:"Service Stop (T1489)"}),id:"T1489",name:"Service Stop",reference:"https://attack.mitre.org/techniques/T1489",tactics:"impact",value:"serviceStop"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.sharedModulesDescription",{defaultMessage:"Shared Modules (T1129)"}),id:"T1129",name:"Shared Modules",reference:"https://attack.mitre.org/techniques/T1129",tactics:"execution",value:"sharedModules"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.sharedWebrootDescription",{defaultMessage:"Shared Webroot (T1051)"}),id:"T1051",name:"Shared Webroot",reference:"https://attack.mitre.org/techniques/T1051",tactics:"lateral-movement",value:"sharedWebroot"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.signedBinaryProxyExecutionDescription",{defaultMessage:"Signed Binary Proxy Execution (T1218)"}),id:"T1218",name:"Signed Binary Proxy Execution",reference:"https://attack.mitre.org/techniques/T1218",tactics:"defense-evasion",value:"signedBinaryProxyExecution"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.signedScriptProxyExecutionDescription",{defaultMessage:"Signed Script Proxy Execution (T1216)"}),id:"T1216",name:"Signed Script Proxy Execution",reference:"https://attack.mitre.org/techniques/T1216",tactics:"defense-evasion",value:"signedScriptProxyExecution"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.softwareDeploymentToolsDescription",{defaultMessage:"Software Deployment Tools (T1072)"}),id:"T1072",name:"Software Deployment Tools",reference:"https://attack.mitre.org/techniques/T1072",tactics:"execution,lateral-movement",value:"softwareDeploymentTools"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.softwareDiscoveryDescription",{defaultMessage:"Software Discovery (T1518)"}),id:"T1518",name:"Software Discovery",reference:"https://attack.mitre.org/techniques/T1518",tactics:"discovery",value:"softwareDiscovery"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.sourceDescription",{defaultMessage:"Source (T1153)"}),id:"T1153",name:"Source",reference:"https://attack.mitre.org/techniques/T1153",tactics:"execution",value:"source"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.stageCapabilitiesDescription",{defaultMessage:"Stage Capabilities (T1608)"}),id:"T1608",name:"Stage Capabilities",reference:"https://attack.mitre.org/techniques/T1608",tactics:"resource-development",value:"stageCapabilities"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.stealApplicationAccessTokenDescription",{defaultMessage:"Steal Application Access Token (T1528)"}),id:"T1528",name:"Steal Application Access Token",reference:"https://attack.mitre.org/techniques/T1528",tactics:"credential-access",value:"stealApplicationAccessToken"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.stealWebSessionCookieDescription",{defaultMessage:"Steal Web Session Cookie (T1539)"}),id:"T1539",name:"Steal Web Session Cookie",reference:"https://attack.mitre.org/techniques/T1539",tactics:"credential-access",value:"stealWebSessionCookie"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.stealOrForgeKerberosTicketsDescription",{defaultMessage:"Steal or Forge Kerberos Tickets (T1558)"}),id:"T1558",name:"Steal or Forge Kerberos Tickets",reference:"https://attack.mitre.org/techniques/T1558",tactics:"credential-access",value:"stealOrForgeKerberosTickets"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.subvertTrustControlsDescription",{defaultMessage:"Subvert Trust Controls (T1553)"}),id:"T1553",name:"Subvert Trust Controls",reference:"https://attack.mitre.org/techniques/T1553",tactics:"defense-evasion",value:"subvertTrustControls"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.supplyChainCompromiseDescription",{defaultMessage:"Supply Chain Compromise (T1195)"}),id:"T1195",name:"Supply Chain Compromise",reference:"https://attack.mitre.org/techniques/T1195",tactics:"initial-access",value:"supplyChainCompromise"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemInformationDiscoveryDescription",{defaultMessage:"System Information Discovery (T1082)"}),id:"T1082",name:"System Information Discovery",reference:"https://attack.mitre.org/techniques/T1082",tactics:"discovery",value:"systemInformationDiscovery"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemLocationDiscoveryDescription",{defaultMessage:"System Location Discovery (T1614)"}),id:"T1614",name:"System Location Discovery",reference:"https://attack.mitre.org/techniques/T1614",tactics:"discovery",value:"systemLocationDiscovery"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemNetworkConfigurationDiscoveryDescription",{defaultMessage:"System Network Configuration Discovery (T1016)"}),id:"T1016",name:"System Network Configuration Discovery",reference:"https://attack.mitre.org/techniques/T1016",tactics:"discovery",value:"systemNetworkConfigurationDiscovery"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemNetworkConnectionsDiscoveryDescription",{defaultMessage:"System Network Connections Discovery (T1049)"}),id:"T1049",name:"System Network Connections Discovery",reference:"https://attack.mitre.org/techniques/T1049",tactics:"discovery",value:"systemNetworkConnectionsDiscovery"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemOwnerUserDiscoveryDescription",{defaultMessage:"System Owner/User Discovery (T1033)"}),id:"T1033",name:"System Owner/User Discovery",reference:"https://attack.mitre.org/techniques/T1033",tactics:"discovery",value:"systemOwnerUserDiscovery"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemServiceDiscoveryDescription",{defaultMessage:"System Service Discovery (T1007)"}),id:"T1007",name:"System Service Discovery",reference:"https://attack.mitre.org/techniques/T1007",tactics:"discovery",value:"systemServiceDiscovery"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemServicesDescription",{defaultMessage:"System Services (T1569)"}),id:"T1569",name:"System Services",reference:"https://attack.mitre.org/techniques/T1569",tactics:"execution",value:"systemServices"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemShutdownRebootDescription",{defaultMessage:"System Shutdown/Reboot (T1529)"}),id:"T1529",name:"System Shutdown/Reboot",reference:"https://attack.mitre.org/techniques/T1529",tactics:"impact",value:"systemShutdownReboot"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemTimeDiscoveryDescription",{defaultMessage:"System Time Discovery (T1124)"}),id:"T1124",name:"System Time Discovery",reference:"https://attack.mitre.org/techniques/T1124",tactics:"discovery",value:"systemTimeDiscovery"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.taintSharedContentDescription",{defaultMessage:"Taint Shared Content (T1080)"}),id:"T1080",name:"Taint Shared Content",reference:"https://attack.mitre.org/techniques/T1080",tactics:"lateral-movement",value:"taintSharedContent"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.templateInjectionDescription",{defaultMessage:"Template Injection (T1221)"}),id:"T1221",name:"Template Injection",reference:"https://attack.mitre.org/techniques/T1221",tactics:"defense-evasion",value:"templateInjection"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.trafficSignalingDescription",{defaultMessage:"Traffic Signaling (T1205)"}),id:"T1205",name:"Traffic Signaling",reference:"https://attack.mitre.org/techniques/T1205",tactics:"defense-evasion,persistence,command-and-control",value:"trafficSignaling"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.transferDataToCloudAccountDescription",{defaultMessage:"Transfer Data to Cloud Account (T1537)"}),id:"T1537",name:"Transfer Data to Cloud Account",reference:"https://attack.mitre.org/techniques/T1537",tactics:"exfiltration",value:"transferDataToCloudAccount"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.trustedDeveloperUtilitiesProxyExecutionDescription",{defaultMessage:"Trusted Developer Utilities Proxy Execution (T1127)"}),id:"T1127",name:"Trusted Developer Utilities Proxy Execution",reference:"https://attack.mitre.org/techniques/T1127",tactics:"defense-evasion",value:"trustedDeveloperUtilitiesProxyExecution"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.trustedRelationshipDescription",{defaultMessage:"Trusted Relationship (T1199)"}),id:"T1199",name:"Trusted Relationship",reference:"https://attack.mitre.org/techniques/T1199",tactics:"initial-access",value:"trustedRelationship"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.twoFactorAuthenticationInterceptionDescription",{defaultMessage:"Two-Factor Authentication Interception (T1111)"}),id:"T1111",name:"Two-Factor Authentication Interception",reference:"https://attack.mitre.org/techniques/T1111",tactics:"credential-access",value:"twoFactorAuthenticationInterception"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.unsecuredCredentialsDescription",{defaultMessage:"Unsecured Credentials (T1552)"}),id:"T1552",name:"Unsecured Credentials",reference:"https://attack.mitre.org/techniques/T1552",tactics:"credential-access",value:"unsecuredCredentials"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.unusedUnsupportedCloudRegionsDescription",{defaultMessage:"Unused/Unsupported Cloud Regions (T1535)"}),id:"T1535",name:"Unused/Unsupported Cloud Regions",reference:"https://attack.mitre.org/techniques/T1535",tactics:"defense-evasion",value:"unusedUnsupportedCloudRegions"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.useAlternateAuthenticationMaterialDescription",{defaultMessage:"Use Alternate Authentication Material (T1550)"}),id:"T1550",name:"Use Alternate Authentication Material",reference:"https://attack.mitre.org/techniques/T1550",tactics:"defense-evasion,lateral-movement",value:"useAlternateAuthenticationMaterial"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.userExecutionDescription",{defaultMessage:"User Execution (T1204)"}),id:"T1204",name:"User Execution",reference:"https://attack.mitre.org/techniques/T1204",tactics:"execution",value:"userExecution"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.validAccountsDescription",{defaultMessage:"Valid Accounts (T1078)"}),id:"T1078",name:"Valid Accounts",reference:"https://attack.mitre.org/techniques/T1078",tactics:"defense-evasion,persistence,privilege-escalation,initial-access",value:"validAccounts"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.videoCaptureDescription",{defaultMessage:"Video Capture (T1125)"}),id:"T1125",name:"Video Capture",reference:"https://attack.mitre.org/techniques/T1125",tactics:"collection",value:"videoCapture"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.virtualizationSandboxEvasionDescription",{defaultMessage:"Virtualization/Sandbox Evasion (T1497)"}),id:"T1497",name:"Virtualization/Sandbox Evasion",reference:"https://attack.mitre.org/techniques/T1497",tactics:"defense-evasion,discovery",value:"virtualizationSandboxEvasion"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.weakenEncryptionDescription",{defaultMessage:"Weaken Encryption (T1600)"}),id:"T1600",name:"Weaken Encryption",reference:"https://attack.mitre.org/techniques/T1600",tactics:"defense-evasion",value:"weakenEncryption"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.webServiceDescription",{defaultMessage:"Web Service (T1102)"}),id:"T1102",name:"Web Service",reference:"https://attack.mitre.org/techniques/T1102",tactics:"command-and-control",value:"webService"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.windowsManagementInstrumentationDescription",{defaultMessage:"Windows Management Instrumentation (T1047)"}),id:"T1047",name:"Windows Management Instrumentation",reference:"https://attack.mitre.org/techniques/T1047",tactics:"execution",value:"windowsManagementInstrumentation"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.xslScriptProcessingDescription",{defaultMessage:"XSL Script Processing (T1220)"}),id:"T1220",name:"XSL Script Processing",reference:"https://attack.mitre.org/techniques/T1220",tactics:"defense-evasion",value:"xslScriptProcessing"}],Sw=[{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.etcPasswdAndEtcShadowT1003Description",{defaultMessage:"/etc/passwd and /etc/shadow (T1003.008)"}),id:"T1003.008",name:"/etc/passwd and /etc/shadow",reference:"https://attack.mitre.org/techniques/T1003/008",tactics:"credential-access",techniqueId:"T1003",value:"etcPasswdAndEtcShadow"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.arpCachePoisoningT1557Description",{defaultMessage:"ARP Cache Poisoning (T1557.002)"}),id:"T1557.002",name:"ARP Cache Poisoning",reference:"https://attack.mitre.org/techniques/T1557/002",tactics:"credential-access,collection",techniqueId:"T1557",value:"arpCachePoisoning"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.asRepRoastingT1558Description",{defaultMessage:"AS-REP Roasting (T1558.004)"}),id:"T1558.004",name:"AS-REP Roasting",reference:"https://attack.mitre.org/techniques/T1558/004",tactics:"credential-access",techniqueId:"T1558",value:"asRepRoasting"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.accessibilityFeaturesT1546Description",{defaultMessage:"Accessibility Features (T1546.008)"}),id:"T1546.008",name:"Accessibility Features",reference:"https://attack.mitre.org/techniques/T1546/008",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"accessibilityFeatures"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.activeSetupT1547Description",{defaultMessage:"Active Setup (T1547.014)"}),id:"T1547.014",name:"Active Setup",reference:"https://attack.mitre.org/techniques/T1547/014",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"activeSetup"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.addOffice365GlobalAdministratorRoleT1098Description",{defaultMessage:"Add Office 365 Global Administrator Role (T1098.003)"}),id:"T1098.003",name:"Add Office 365 Global Administrator Role",reference:"https://attack.mitre.org/techniques/T1098/003",tactics:"persistence",techniqueId:"T1098",value:"addOffice365GlobalAdministratorRole"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.addInsT1137Description",{defaultMessage:"Add-ins (T1137.006)"}),id:"T1137.006",name:"Add-ins",reference:"https://attack.mitre.org/techniques/T1137/006",tactics:"persistence",techniqueId:"T1137",value:"addIns"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.additionalCloudCredentialsT1098Description",{defaultMessage:"Additional Cloud Credentials (T1098.001)"}),id:"T1098.001",name:"Additional Cloud Credentials",reference:"https://attack.mitre.org/techniques/T1098/001",tactics:"persistence",techniqueId:"T1098",value:"additionalCloudCredentials"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.appCertDlLsT1546Description",{defaultMessage:"AppCert DLLs (T1546.009)"}),id:"T1546.009",name:"AppCert DLLs",reference:"https://attack.mitre.org/techniques/T1546/009",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"appCertDlLs"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.appInitDlLsT1546Description",{defaultMessage:"AppInit DLLs (T1546.010)"}),id:"T1546.010",name:"AppInit DLLs",reference:"https://attack.mitre.org/techniques/T1546/010",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"appInitDlLs"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.appleScriptT1059Description",{defaultMessage:"AppleScript (T1059.002)"}),id:"T1059.002",name:"AppleScript",reference:"https://attack.mitre.org/techniques/T1059/002",tactics:"execution",techniqueId:"T1059",value:"appleScript"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.applicationAccessTokenT1550Description",{defaultMessage:"Application Access Token (T1550.001)"}),id:"T1550.001",name:"Application Access Token",reference:"https://attack.mitre.org/techniques/T1550/001",tactics:"defense-evasion,lateral-movement",techniqueId:"T1550",value:"applicationAccessToken"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.applicationExhaustionFloodT1499Description",{defaultMessage:"Application Exhaustion Flood (T1499.003)"}),id:"T1499.003",name:"Application Exhaustion Flood",reference:"https://attack.mitre.org/techniques/T1499/003",tactics:"impact",techniqueId:"T1499",value:"applicationExhaustionFlood"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.applicationShimmingT1546Description",{defaultMessage:"Application Shimming (T1546.011)"}),id:"T1546.011",name:"Application Shimming",reference:"https://attack.mitre.org/techniques/T1546/011",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"applicationShimming"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.applicationOrSystemExploitationT1499Description",{defaultMessage:"Application or System Exploitation (T1499.004)"}),id:"T1499.004",name:"Application or System Exploitation",reference:"https://attack.mitre.org/techniques/T1499/004",tactics:"impact",techniqueId:"T1499",value:"applicationOrSystemExploitation"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.archiveViaCustomMethodT1560Description",{defaultMessage:"Archive via Custom Method (T1560.003)"}),id:"T1560.003",name:"Archive via Custom Method",reference:"https://attack.mitre.org/techniques/T1560/003",tactics:"collection",techniqueId:"T1560",value:"archiveViaCustomMethod"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.archiveViaLibraryT1560Description",{defaultMessage:"Archive via Library (T1560.002)"}),id:"T1560.002",name:"Archive via Library",reference:"https://attack.mitre.org/techniques/T1560/002",tactics:"collection",techniqueId:"T1560",value:"archiveViaLibrary"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.archiveViaUtilityT1560Description",{defaultMessage:"Archive via Utility (T1560.001)"}),id:"T1560.001",name:"Archive via Utility",reference:"https://attack.mitre.org/techniques/T1560/001",tactics:"collection",techniqueId:"T1560",value:"archiveViaUtility"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.asymmetricCryptographyT1573Description",{defaultMessage:"Asymmetric Cryptography (T1573.002)"}),id:"T1573.002",name:"Asymmetric Cryptography",reference:"https://attack.mitre.org/techniques/T1573/002",tactics:"command-and-control",techniqueId:"T1573",value:"asymmetricCryptography"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.asynchronousProcedureCallT1055Description",{defaultMessage:"Asynchronous Procedure Call (T1055.004)"}),id:"T1055.004",name:"Asynchronous Procedure Call",reference:"https://attack.mitre.org/techniques/T1055/004",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"asynchronousProcedureCall"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.atLinuxT1053Description",{defaultMessage:"At (Linux) (T1053.001)"}),id:"T1053.001",name:"At (Linux)",reference:"https://attack.mitre.org/techniques/T1053/001",tactics:"execution,persistence,privilege-escalation",techniqueId:"T1053",value:"atLinux"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.atWindowsT1053Description",{defaultMessage:"At (Windows) (T1053.002)"}),id:"T1053.002",name:"At (Windows)",reference:"https://attack.mitre.org/techniques/T1053/002",tactics:"execution,persistence,privilege-escalation",techniqueId:"T1053",value:"atWindows"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.authenticationPackageT1547Description",{defaultMessage:"Authentication Package (T1547.002)"}),id:"T1547.002",name:"Authentication Package",reference:"https://attack.mitre.org/techniques/T1547/002",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"authenticationPackage"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.bashHistoryT1552Description",{defaultMessage:"Bash History (T1552.003)"}),id:"T1552.003",name:"Bash History",reference:"https://attack.mitre.org/techniques/T1552/003",tactics:"credential-access",techniqueId:"T1552",value:"bashHistory"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.bidirectionalCommunicationT1102Description",{defaultMessage:"Bidirectional Communication (T1102.002)"}),id:"T1102.002",name:"Bidirectional Communication",reference:"https://attack.mitre.org/techniques/T1102/002",tactics:"command-and-control",techniqueId:"T1102",value:"bidirectionalCommunication"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.binaryPaddingT1027Description",{defaultMessage:"Binary Padding (T1027.001)"}),id:"T1027.001",name:"Binary Padding",reference:"https://attack.mitre.org/techniques/T1027/001",tactics:"defense-evasion",techniqueId:"T1027",value:"binaryPadding"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.bootkitT1542Description",{defaultMessage:"Bootkit (T1542.003)"}),id:"T1542.003",name:"Bootkit",reference:"https://attack.mitre.org/techniques/T1542/003",tactics:"persistence,defense-evasion",techniqueId:"T1542",value:"bootkit"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.botnetT1583Description",{defaultMessage:"Botnet (T1583.005)"}),id:"T1583.005",name:"Botnet",reference:"https://attack.mitre.org/techniques/T1583/005",tactics:"resource-development",techniqueId:"T1583",value:"botnet"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.botnetT1584Description",{defaultMessage:"Botnet (T1584.005)"}),id:"T1584.005",name:"Botnet",reference:"https://attack.mitre.org/techniques/T1584/005",tactics:"resource-development",techniqueId:"T1584",value:"botnet"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.businessRelationshipsT1591Description",{defaultMessage:"Business Relationships (T1591.002)"}),id:"T1591.002",name:"Business Relationships",reference:"https://attack.mitre.org/techniques/T1591/002",tactics:"reconnaissance",techniqueId:"T1591",value:"businessRelationships"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.bypassUserAccountControlT1548Description",{defaultMessage:"Bypass User Account Control (T1548.002)"}),id:"T1548.002",name:"Bypass User Account Control",reference:"https://attack.mitre.org/techniques/T1548/002",tactics:"privilege-escalation,defense-evasion",techniqueId:"T1548",value:"bypassUserAccountControl"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.cdNsT1596Description",{defaultMessage:"CDNs (T1596.004)"}),id:"T1596.004",name:"CDNs",reference:"https://attack.mitre.org/techniques/T1596/004",tactics:"reconnaissance",techniqueId:"T1596",value:"cdNs"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.cmstpT1218Description",{defaultMessage:"CMSTP (T1218.003)"}),id:"T1218.003",name:"CMSTP",reference:"https://attack.mitre.org/techniques/T1218/003",tactics:"defense-evasion",techniqueId:"T1218",value:"cmstp"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.corProfilerT1574Description",{defaultMessage:"COR_PROFILER (T1574.012)"}),id:"T1574.012",name:"COR_PROFILER",reference:"https://attack.mitre.org/techniques/T1574/012",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"corProfiler"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.cachedDomainCredentialsT1003Description",{defaultMessage:"Cached Domain Credentials (T1003.005)"}),id:"T1003.005",name:"Cached Domain Credentials",reference:"https://attack.mitre.org/techniques/T1003/005",tactics:"credential-access",techniqueId:"T1003",value:"cachedDomainCredentials"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.changeDefaultFileAssociationT1546Description",{defaultMessage:"Change Default File Association (T1546.001)"}),id:"T1546.001",name:"Change Default File Association",reference:"https://attack.mitre.org/techniques/T1546/001",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"changeDefaultFileAssociation"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.clearCommandHistoryT1070Description",{defaultMessage:"Clear Command History (T1070.003)"}),id:"T1070.003",name:"Clear Command History",reference:"https://attack.mitre.org/techniques/T1070/003",tactics:"defense-evasion",techniqueId:"T1070",value:"clearCommandHistory"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.clearLinuxOrMacSystemLogsT1070Description",{defaultMessage:"Clear Linux or Mac System Logs (T1070.002)"}),id:"T1070.002",name:"Clear Linux or Mac System Logs",reference:"https://attack.mitre.org/techniques/T1070/002",tactics:"defense-evasion",techniqueId:"T1070",value:"clearLinuxOrMacSystemLogs"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.clearWindowsEventLogsT1070Description",{defaultMessage:"Clear Windows Event Logs (T1070.001)"}),id:"T1070.001",name:"Clear Windows Event Logs",reference:"https://attack.mitre.org/techniques/T1070/001",tactics:"defense-evasion",techniqueId:"T1070",value:"clearWindowsEventLogs"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.clientConfigurationsT1592Description",{defaultMessage:"Client Configurations (T1592.004)"}),id:"T1592.004",name:"Client Configurations",reference:"https://attack.mitre.org/techniques/T1592/004",tactics:"reconnaissance",techniqueId:"T1592",value:"clientConfigurations"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.cloudAccountT1136Description",{defaultMessage:"Cloud Account (T1136.003)"}),id:"T1136.003",name:"Cloud Account",reference:"https://attack.mitre.org/techniques/T1136/003",tactics:"persistence",techniqueId:"T1136",value:"cloudAccount"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.cloudAccountT1087Description",{defaultMessage:"Cloud Account (T1087.004)"}),id:"T1087.004",name:"Cloud Account",reference:"https://attack.mitre.org/techniques/T1087/004",tactics:"discovery",techniqueId:"T1087",value:"cloudAccount"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.cloudAccountsT1078Description",{defaultMessage:"Cloud Accounts (T1078.004)"}),id:"T1078.004",name:"Cloud Accounts",reference:"https://attack.mitre.org/techniques/T1078/004",tactics:"defense-evasion,persistence,privilege-escalation,initial-access",techniqueId:"T1078",value:"cloudAccounts"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.cloudGroupsT1069Description",{defaultMessage:"Cloud Groups (T1069.003)"}),id:"T1069.003",name:"Cloud Groups",reference:"https://attack.mitre.org/techniques/T1069/003",tactics:"discovery",techniqueId:"T1069",value:"cloudGroups"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.cloudInstanceMetadataApiT1552Description",{defaultMessage:"Cloud Instance Metadata API (T1552.005)"}),id:"T1552.005",name:"Cloud Instance Metadata API",reference:"https://attack.mitre.org/techniques/T1552/005",tactics:"credential-access",techniqueId:"T1552",value:"cloudInstanceMetadataApi"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.codeRepositoriesT1213Description",{defaultMessage:"Code Repositories (T1213.003)"}),id:"T1213.003",name:"Code Repositories",reference:"https://attack.mitre.org/techniques/T1213/003",tactics:"collection",techniqueId:"T1213",value:"codeRepositories"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.codeSigningT1553Description",{defaultMessage:"Code Signing (T1553.002)"}),id:"T1553.002",name:"Code Signing",reference:"https://attack.mitre.org/techniques/T1553/002",tactics:"defense-evasion",techniqueId:"T1553",value:"codeSigning"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.codeSigningCertificatesT1587Description",{defaultMessage:"Code Signing Certificates (T1587.002)"}),id:"T1587.002",name:"Code Signing Certificates",reference:"https://attack.mitre.org/techniques/T1587/002",tactics:"resource-development",techniqueId:"T1587",value:"codeSigningCertificates"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.codeSigningCertificatesT1588Description",{defaultMessage:"Code Signing Certificates (T1588.003)"}),id:"T1588.003",name:"Code Signing Certificates",reference:"https://attack.mitre.org/techniques/T1588/003",tactics:"resource-development",techniqueId:"T1588",value:"codeSigningCertificates"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.codeSigningPolicyModificationT1553Description",{defaultMessage:"Code Signing Policy Modification (T1553.006)"}),id:"T1553.006",name:"Code Signing Policy Modification",reference:"https://attack.mitre.org/techniques/T1553/006",tactics:"defense-evasion",techniqueId:"T1553",value:"codeSigningPolicyModification"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.compileAfterDeliveryT1027Description",{defaultMessage:"Compile After Delivery (T1027.004)"}),id:"T1027.004",name:"Compile After Delivery",reference:"https://attack.mitre.org/techniques/T1027/004",tactics:"defense-evasion",techniqueId:"T1027",value:"compileAfterDelivery"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.compiledHtmlFileT1218Description",{defaultMessage:"Compiled HTML File (T1218.001)"}),id:"T1218.001",name:"Compiled HTML File",reference:"https://attack.mitre.org/techniques/T1218/001",tactics:"defense-evasion",techniqueId:"T1218",value:"compiledHtmlFile"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.componentFirmwareT1542Description",{defaultMessage:"Component Firmware (T1542.002)"}),id:"T1542.002",name:"Component Firmware",reference:"https://attack.mitre.org/techniques/T1542/002",tactics:"persistence,defense-evasion",techniqueId:"T1542",value:"componentFirmware"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.componentObjectModelT1559Description",{defaultMessage:"Component Object Model (T1559.001)"}),id:"T1559.001",name:"Component Object Model",reference:"https://attack.mitre.org/techniques/T1559/001",tactics:"execution",techniqueId:"T1559",value:"componentObjectModel"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.componentObjectModelHijackingT1546Description",{defaultMessage:"Component Object Model Hijacking (T1546.015)"}),id:"T1546.015",name:"Component Object Model Hijacking",reference:"https://attack.mitre.org/techniques/T1546/015",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"componentObjectModelHijacking"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.compromiseHardwareSupplyChainT1195Description",{defaultMessage:"Compromise Hardware Supply Chain (T1195.003)"}),id:"T1195.003",name:"Compromise Hardware Supply Chain",reference:"https://attack.mitre.org/techniques/T1195/003",tactics:"initial-access",techniqueId:"T1195",value:"compromiseHardwareSupplyChain"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.compromiseSoftwareDependenciesAndDevelopmentToolsT1195Description",{defaultMessage:"Compromise Software Dependencies and Development Tools (T1195.001)"}),id:"T1195.001",name:"Compromise Software Dependencies and Development Tools",reference:"https://attack.mitre.org/techniques/T1195/001",tactics:"initial-access",techniqueId:"T1195",value:"compromiseSoftwareDependenciesAndDevelopmentTools"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.compromiseSoftwareSupplyChainT1195Description",{defaultMessage:"Compromise Software Supply Chain (T1195.002)"}),id:"T1195.002",name:"Compromise Software Supply Chain",reference:"https://attack.mitre.org/techniques/T1195/002",tactics:"initial-access",techniqueId:"T1195",value:"compromiseSoftwareSupplyChain"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.confluenceT1213Description",{defaultMessage:"Confluence (T1213.001)"}),id:"T1213.001",name:"Confluence",reference:"https://attack.mitre.org/techniques/T1213/001",tactics:"collection",techniqueId:"T1213",value:"confluence"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.containerApiT1552Description",{defaultMessage:"Container API (T1552.007)"}),id:"T1552.007",name:"Container API",reference:"https://attack.mitre.org/techniques/T1552/007",tactics:"credential-access",techniqueId:"T1552",value:"containerApi"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.containerOrchestrationJobT1053Description",{defaultMessage:"Container Orchestration Job (T1053.007)"}),id:"T1053.007",name:"Container Orchestration Job",reference:"https://attack.mitre.org/techniques/T1053/007",tactics:"execution,persistence,privilege-escalation",techniqueId:"T1053",value:"containerOrchestrationJob"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.controlPanelT1218Description",{defaultMessage:"Control Panel (T1218.002)"}),id:"T1218.002",name:"Control Panel",reference:"https://attack.mitre.org/techniques/T1218/002",tactics:"defense-evasion",techniqueId:"T1218",value:"controlPanel"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.createCloudInstanceT1578Description",{defaultMessage:"Create Cloud Instance (T1578.002)"}),id:"T1578.002",name:"Create Cloud Instance",reference:"https://attack.mitre.org/techniques/T1578/002",tactics:"defense-evasion",techniqueId:"T1578",value:"createCloudInstance"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.createProcessWithTokenT1134Description",{defaultMessage:"Create Process with Token (T1134.002)"}),id:"T1134.002",name:"Create Process with Token",reference:"https://attack.mitre.org/techniques/T1134/002",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1134",value:"createProcessWithToken"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.createSnapshotT1578Description",{defaultMessage:"Create Snapshot (T1578.001)"}),id:"T1578.001",name:"Create Snapshot",reference:"https://attack.mitre.org/techniques/T1578/001",tactics:"defense-evasion",techniqueId:"T1578",value:"createSnapshot"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.credentialApiHookingT1056Description",{defaultMessage:"Credential API Hooking (T1056.004)"}),id:"T1056.004",name:"Credential API Hooking",reference:"https://attack.mitre.org/techniques/T1056/004",tactics:"collection,credential-access",techniqueId:"T1056",value:"credentialApiHooking"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.credentialStuffingT1110Description",{defaultMessage:"Credential Stuffing (T1110.004)"}),id:"T1110.004",name:"Credential Stuffing",reference:"https://attack.mitre.org/techniques/T1110/004",tactics:"credential-access",techniqueId:"T1110",value:"credentialStuffing"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.credentialsT1589Description",{defaultMessage:"Credentials (T1589.001)"}),id:"T1589.001",name:"Credentials",reference:"https://attack.mitre.org/techniques/T1589/001",tactics:"reconnaissance",techniqueId:"T1589",value:"credentials"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.credentialsInFilesT1552Description",{defaultMessage:"Credentials In Files (T1552.001)"}),id:"T1552.001",name:"Credentials In Files",reference:"https://attack.mitre.org/techniques/T1552/001",tactics:"credential-access",techniqueId:"T1552",value:"credentialsInFiles"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.credentialsFromWebBrowsersT1555Description",{defaultMessage:"Credentials from Web Browsers (T1555.003)"}),id:"T1555.003",name:"Credentials from Web Browsers",reference:"https://attack.mitre.org/techniques/T1555/003",tactics:"credential-access",techniqueId:"T1555",value:"credentialsFromWebBrowsers"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.credentialsInRegistryT1552Description",{defaultMessage:"Credentials in Registry (T1552.002)"}),id:"T1552.002",name:"Credentials in Registry",reference:"https://attack.mitre.org/techniques/T1552/002",tactics:"credential-access",techniqueId:"T1552",value:"credentialsInRegistry"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.cronT1053Description",{defaultMessage:"Cron (T1053.003)"}),id:"T1053.003",name:"Cron",reference:"https://attack.mitre.org/techniques/T1053/003",tactics:"execution,persistence,privilege-escalation",techniqueId:"T1053",value:"cron"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dcSyncT1003Description",{defaultMessage:"DCSync (T1003.006)"}),id:"T1003.006",name:"DCSync",reference:"https://attack.mitre.org/techniques/T1003/006",tactics:"credential-access",techniqueId:"T1003",value:"dcSync"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dllSearchOrderHijackingT1574Description",{defaultMessage:"DLL Search Order Hijacking (T1574.001)"}),id:"T1574.001",name:"DLL Search Order Hijacking",reference:"https://attack.mitre.org/techniques/T1574/001",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"dllSearchOrderHijacking"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dllSideLoadingT1574Description",{defaultMessage:"DLL Side-Loading (T1574.002)"}),id:"T1574.002",name:"DLL Side-Loading",reference:"https://attack.mitre.org/techniques/T1574/002",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"dllSideLoading"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dnsT1071Description",{defaultMessage:"DNS (T1071.004)"}),id:"T1071.004",name:"DNS",reference:"https://attack.mitre.org/techniques/T1071/004",tactics:"command-and-control",techniqueId:"T1071",value:"dns"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dnsT1590Description",{defaultMessage:"DNS (T1590.002)"}),id:"T1590.002",name:"DNS",reference:"https://attack.mitre.org/techniques/T1590/002",tactics:"reconnaissance",techniqueId:"T1590",value:"dns"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dnsCalculationT1568Description",{defaultMessage:"DNS Calculation (T1568.003)"}),id:"T1568.003",name:"DNS Calculation",reference:"https://attack.mitre.org/techniques/T1568/003",tactics:"command-and-control",techniqueId:"T1568",value:"dnsCalculation"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dnsServerT1583Description",{defaultMessage:"DNS Server (T1583.002)"}),id:"T1583.002",name:"DNS Server",reference:"https://attack.mitre.org/techniques/T1583/002",tactics:"resource-development",techniqueId:"T1583",value:"dnsServer"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dnsServerT1584Description",{defaultMessage:"DNS Server (T1584.002)"}),id:"T1584.002",name:"DNS Server",reference:"https://attack.mitre.org/techniques/T1584/002",tactics:"resource-development",techniqueId:"T1584",value:"dnsServer"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dnsPassiveDnsT1596Description",{defaultMessage:"DNS/Passive DNS (T1596.001)"}),id:"T1596.001",name:"DNS/Passive DNS",reference:"https://attack.mitre.org/techniques/T1596/001",tactics:"reconnaissance",techniqueId:"T1596",value:"dnsPassiveDns"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.deadDropResolverT1102Description",{defaultMessage:"Dead Drop Resolver (T1102.001)"}),id:"T1102.001",name:"Dead Drop Resolver",reference:"https://attack.mitre.org/techniques/T1102/001",tactics:"command-and-control",techniqueId:"T1102",value:"deadDropResolver"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.defaultAccountsT1078Description",{defaultMessage:"Default Accounts (T1078.001)"}),id:"T1078.001",name:"Default Accounts",reference:"https://attack.mitre.org/techniques/T1078/001",tactics:"defense-evasion,persistence,privilege-escalation,initial-access",techniqueId:"T1078",value:"defaultAccounts"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.deleteCloudInstanceT1578Description",{defaultMessage:"Delete Cloud Instance (T1578.003)"}),id:"T1578.003",name:"Delete Cloud Instance",reference:"https://attack.mitre.org/techniques/T1578/003",tactics:"defense-evasion",techniqueId:"T1578",value:"deleteCloudInstance"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.determinePhysicalLocationsT1591Description",{defaultMessage:"Determine Physical Locations (T1591.001)"}),id:"T1591.001",name:"Determine Physical Locations",reference:"https://attack.mitre.org/techniques/T1591/001",tactics:"reconnaissance",techniqueId:"T1591",value:"determinePhysicalLocations"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.digitalCertificatesT1587Description",{defaultMessage:"Digital Certificates (T1587.003)"}),id:"T1587.003",name:"Digital Certificates",reference:"https://attack.mitre.org/techniques/T1587/003",tactics:"resource-development",techniqueId:"T1587",value:"digitalCertificates"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.digitalCertificatesT1588Description",{defaultMessage:"Digital Certificates (T1588.004)"}),id:"T1588.004",name:"Digital Certificates",reference:"https://attack.mitre.org/techniques/T1588/004",tactics:"resource-development",techniqueId:"T1588",value:"digitalCertificates"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.digitalCertificatesT1596Description",{defaultMessage:"Digital Certificates (T1596.003)"}),id:"T1596.003",name:"Digital Certificates",reference:"https://attack.mitre.org/techniques/T1596/003",tactics:"reconnaissance",techniqueId:"T1596",value:"digitalCertificates"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.directNetworkFloodT1498Description",{defaultMessage:"Direct Network Flood (T1498.001)"}),id:"T1498.001",name:"Direct Network Flood",reference:"https://attack.mitre.org/techniques/T1498/001",tactics:"impact",techniqueId:"T1498",value:"directNetworkFlood"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.disableCloudLogsT1562Description",{defaultMessage:"Disable Cloud Logs (T1562.008)"}),id:"T1562.008",name:"Disable Cloud Logs",reference:"https://attack.mitre.org/techniques/T1562/008",tactics:"defense-evasion",techniqueId:"T1562",value:"disableCloudLogs"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.disableCryptoHardwareT1600Description",{defaultMessage:"Disable Crypto Hardware (T1600.002)"}),id:"T1600.002",name:"Disable Crypto Hardware",reference:"https://attack.mitre.org/techniques/T1600/002",tactics:"defense-evasion",techniqueId:"T1600",value:"disableCryptoHardware"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.disableWindowsEventLoggingT1562Description",{defaultMessage:"Disable Windows Event Logging (T1562.002)"}),id:"T1562.002",name:"Disable Windows Event Logging",reference:"https://attack.mitre.org/techniques/T1562/002",tactics:"defense-evasion",techniqueId:"T1562",value:"disableWindowsEventLogging"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.disableOrModifyCloudFirewallT1562Description",{defaultMessage:"Disable or Modify Cloud Firewall (T1562.007)"}),id:"T1562.007",name:"Disable or Modify Cloud Firewall",reference:"https://attack.mitre.org/techniques/T1562/007",tactics:"defense-evasion",techniqueId:"T1562",value:"disableOrModifyCloudFirewall"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.disableOrModifySystemFirewallT1562Description",{defaultMessage:"Disable or Modify System Firewall (T1562.004)"}),id:"T1562.004",name:"Disable or Modify System Firewall",reference:"https://attack.mitre.org/techniques/T1562/004",tactics:"defense-evasion",techniqueId:"T1562",value:"disableOrModifySystemFirewall"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.disableOrModifyToolsT1562Description",{defaultMessage:"Disable or Modify Tools (T1562.001)"}),id:"T1562.001",name:"Disable or Modify Tools",reference:"https://attack.mitre.org/techniques/T1562/001",tactics:"defense-evasion",techniqueId:"T1562",value:"disableOrModifyTools"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.diskContentWipeT1561Description",{defaultMessage:"Disk Content Wipe (T1561.001)"}),id:"T1561.001",name:"Disk Content Wipe",reference:"https://attack.mitre.org/techniques/T1561/001",tactics:"impact",techniqueId:"T1561",value:"diskContentWipe"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.diskStructureWipeT1561Description",{defaultMessage:"Disk Structure Wipe (T1561.002)"}),id:"T1561.002",name:"Disk Structure Wipe",reference:"https://attack.mitre.org/techniques/T1561/002",tactics:"impact",techniqueId:"T1561",value:"diskStructureWipe"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.distributedComponentObjectModelT1021Description",{defaultMessage:"Distributed Component Object Model (T1021.003)"}),id:"T1021.003",name:"Distributed Component Object Model",reference:"https://attack.mitre.org/techniques/T1021/003",tactics:"lateral-movement",techniqueId:"T1021",value:"distributedComponentObjectModel"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainAccountT1136Description",{defaultMessage:"Domain Account (T1136.002)"}),id:"T1136.002",name:"Domain Account",reference:"https://attack.mitre.org/techniques/T1136/002",tactics:"persistence",techniqueId:"T1136",value:"domainAccount"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainAccountT1087Description",{defaultMessage:"Domain Account (T1087.002)"}),id:"T1087.002",name:"Domain Account",reference:"https://attack.mitre.org/techniques/T1087/002",tactics:"discovery",techniqueId:"T1087",value:"domainAccount"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainAccountsT1078Description",{defaultMessage:"Domain Accounts (T1078.002)"}),id:"T1078.002",name:"Domain Accounts",reference:"https://attack.mitre.org/techniques/T1078/002",tactics:"defense-evasion,persistence,privilege-escalation,initial-access",techniqueId:"T1078",value:"domainAccounts"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainControllerAuthenticationT1556Description",{defaultMessage:"Domain Controller Authentication (T1556.001)"}),id:"T1556.001",name:"Domain Controller Authentication",reference:"https://attack.mitre.org/techniques/T1556/001",tactics:"credential-access,defense-evasion,persistence",techniqueId:"T1556",value:"domainControllerAuthentication"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainFrontingT1090Description",{defaultMessage:"Domain Fronting (T1090.004)"}),id:"T1090.004",name:"Domain Fronting",reference:"https://attack.mitre.org/techniques/T1090/004",tactics:"command-and-control",techniqueId:"T1090",value:"domainFronting"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainGenerationAlgorithmsT1568Description",{defaultMessage:"Domain Generation Algorithms (T1568.002)"}),id:"T1568.002",name:"Domain Generation Algorithms",reference:"https://attack.mitre.org/techniques/T1568/002",tactics:"command-and-control",techniqueId:"T1568",value:"domainGenerationAlgorithms"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainGroupsT1069Description",{defaultMessage:"Domain Groups (T1069.002)"}),id:"T1069.002",name:"Domain Groups",reference:"https://attack.mitre.org/techniques/T1069/002",tactics:"discovery",techniqueId:"T1069",value:"domainGroups"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainPropertiesT1590Description",{defaultMessage:"Domain Properties (T1590.001)"}),id:"T1590.001",name:"Domain Properties",reference:"https://attack.mitre.org/techniques/T1590/001",tactics:"reconnaissance",techniqueId:"T1590",value:"domainProperties"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainTrustModificationT1484Description",{defaultMessage:"Domain Trust Modification (T1484.002)"}),id:"T1484.002",name:"Domain Trust Modification",reference:"https://attack.mitre.org/techniques/T1484/002",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1484",value:"domainTrustModification"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainsT1583Description",{defaultMessage:"Domains (T1583.001)"}),id:"T1583.001",name:"Domains",reference:"https://attack.mitre.org/techniques/T1583/001",tactics:"resource-development",techniqueId:"T1583",value:"domains"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainsT1584Description",{defaultMessage:"Domains (T1584.001)"}),id:"T1584.001",name:"Domains",reference:"https://attack.mitre.org/techniques/T1584/001",tactics:"resource-development",techniqueId:"T1584",value:"domains"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.doubleFileExtensionT1036Description",{defaultMessage:"Double File Extension (T1036.007)"}),id:"T1036.007",name:"Double File Extension",reference:"https://attack.mitre.org/techniques/T1036/007",tactics:"defense-evasion",techniqueId:"T1036",value:"doubleFileExtension"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.downgradeAttackT1562Description",{defaultMessage:"Downgrade Attack (T1562.010)"}),id:"T1562.010",name:"Downgrade Attack",reference:"https://attack.mitre.org/techniques/T1562/010",tactics:"defense-evasion",techniqueId:"T1562",value:"downgradeAttack"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.downgradeSystemImageT1601Description",{defaultMessage:"Downgrade System Image (T1601.002)"}),id:"T1601.002",name:"Downgrade System Image",reference:"https://attack.mitre.org/techniques/T1601/002",tactics:"defense-evasion",techniqueId:"T1601",value:"downgradeSystemImage"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.driveByTargetT1608Description",{defaultMessage:"Drive-by Target (T1608.004)"}),id:"T1608.004",name:"Drive-by Target",reference:"https://attack.mitre.org/techniques/T1608/004",tactics:"resource-development",techniqueId:"T1608",value:"driveByTarget"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dylibHijackingT1574Description",{defaultMessage:"Dylib Hijacking (T1574.004)"}),id:"T1574.004",name:"Dylib Hijacking",reference:"https://attack.mitre.org/techniques/T1574/004",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"dylibHijacking"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dynamicDataExchangeT1559Description",{defaultMessage:"Dynamic Data Exchange (T1559.002)"}),id:"T1559.002",name:"Dynamic Data Exchange",reference:"https://attack.mitre.org/techniques/T1559/002",tactics:"execution",techniqueId:"T1559",value:"dynamicDataExchange"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dynamicLinkerHijackingT1574Description",{defaultMessage:"Dynamic Linker Hijacking (T1574.006)"}),id:"T1574.006",name:"Dynamic Linker Hijacking",reference:"https://attack.mitre.org/techniques/T1574/006",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"dynamicLinkerHijacking"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dynamicLinkLibraryInjectionT1055Description",{defaultMessage:"Dynamic-link Library Injection (T1055.001)"}),id:"T1055.001",name:"Dynamic-link Library Injection",reference:"https://attack.mitre.org/techniques/T1055/001",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"dynamicLinkLibraryInjection"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.elevatedExecutionWithPromptT1548Description",{defaultMessage:"Elevated Execution with Prompt (T1548.004)"}),id:"T1548.004",name:"Elevated Execution with Prompt",reference:"https://attack.mitre.org/techniques/T1548/004",tactics:"privilege-escalation,defense-evasion",techniqueId:"T1548",value:"elevatedExecutionWithPrompt"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.emailAccountT1087Description",{defaultMessage:"Email Account (T1087.003)"}),id:"T1087.003",name:"Email Account",reference:"https://attack.mitre.org/techniques/T1087/003",tactics:"discovery",techniqueId:"T1087",value:"emailAccount"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.emailAccountsT1585Description",{defaultMessage:"Email Accounts (T1585.002)"}),id:"T1585.002",name:"Email Accounts",reference:"https://attack.mitre.org/techniques/T1585/002",tactics:"resource-development",techniqueId:"T1585",value:"emailAccounts"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.emailAccountsT1586Description",{defaultMessage:"Email Accounts (T1586.002)"}),id:"T1586.002",name:"Email Accounts",reference:"https://attack.mitre.org/techniques/T1586/002",tactics:"resource-development",techniqueId:"T1586",value:"emailAccounts"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.emailAddressesT1589Description",{defaultMessage:"Email Addresses (T1589.002)"}),id:"T1589.002",name:"Email Addresses",reference:"https://attack.mitre.org/techniques/T1589/002",tactics:"reconnaissance",techniqueId:"T1589",value:"emailAddresses"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.emailForwardingRuleT1114Description",{defaultMessage:"Email Forwarding Rule (T1114.003)"}),id:"T1114.003",name:"Email Forwarding Rule",reference:"https://attack.mitre.org/techniques/T1114/003",tactics:"collection",techniqueId:"T1114",value:"emailForwardingRule"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.emailHidingRulesT1564Description",{defaultMessage:"Email Hiding Rules (T1564.008)"}),id:"T1564.008",name:"Email Hiding Rules",reference:"https://attack.mitre.org/techniques/T1564/008",tactics:"defense-evasion",techniqueId:"T1564",value:"emailHidingRules"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.emondT1546Description",{defaultMessage:"Emond (T1546.014)"}),id:"T1546.014",name:"Emond",reference:"https://attack.mitre.org/techniques/T1546/014",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"emond"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.employeeNamesT1589Description",{defaultMessage:"Employee Names (T1589.003)"}),id:"T1589.003",name:"Employee Names",reference:"https://attack.mitre.org/techniques/T1589/003",tactics:"reconnaissance",techniqueId:"T1589",value:"employeeNames"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.environmentalKeyingT1480Description",{defaultMessage:"Environmental Keying (T1480.001)"}),id:"T1480.001",name:"Environmental Keying",reference:"https://attack.mitre.org/techniques/T1480/001",tactics:"defense-evasion",techniqueId:"T1480",value:"environmentalKeying"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exchangeEmailDelegatePermissionsT1098Description",{defaultMessage:"Exchange Email Delegate Permissions (T1098.002)"}),id:"T1098.002",name:"Exchange Email Delegate Permissions",reference:"https://attack.mitre.org/techniques/T1098/002",tactics:"persistence",techniqueId:"T1098",value:"exchangeEmailDelegatePermissions"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.executableInstallerFilePermissionsWeaknessT1574Description",{defaultMessage:"Executable Installer File Permissions Weakness (T1574.005)"}),id:"T1574.005",name:"Executable Installer File Permissions Weakness",reference:"https://attack.mitre.org/techniques/T1574/005",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"executableInstallerFilePermissionsWeakness"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exfiltrationOverAsymmetricEncryptedNonC2ProtocolT1048Description",{defaultMessage:"Exfiltration Over Asymmetric Encrypted Non-C2 Protocol (T1048.002)"}),id:"T1048.002",name:"Exfiltration Over Asymmetric Encrypted Non-C2 Protocol",reference:"https://attack.mitre.org/techniques/T1048/002",tactics:"exfiltration",techniqueId:"T1048",value:"exfiltrationOverAsymmetricEncryptedNonC2Protocol"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exfiltrationOverBluetoothT1011Description",{defaultMessage:"Exfiltration Over Bluetooth (T1011.001)"}),id:"T1011.001",name:"Exfiltration Over Bluetooth",reference:"https://attack.mitre.org/techniques/T1011/001",tactics:"exfiltration",techniqueId:"T1011",value:"exfiltrationOverBluetooth"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exfiltrationOverSymmetricEncryptedNonC2ProtocolT1048Description",{defaultMessage:"Exfiltration Over Symmetric Encrypted Non-C2 Protocol (T1048.001)"}),id:"T1048.001",name:"Exfiltration Over Symmetric Encrypted Non-C2 Protocol",reference:"https://attack.mitre.org/techniques/T1048/001",tactics:"exfiltration",techniqueId:"T1048",value:"exfiltrationOverSymmetricEncryptedNonC2Protocol"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exfiltrationOverUnencryptedObfuscatedNonC2ProtocolT1048Description",{defaultMessage:"Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol (T1048.003)"}),id:"T1048.003",name:"Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol",reference:"https://attack.mitre.org/techniques/T1048/003",tactics:"exfiltration",techniqueId:"T1048",value:"exfiltrationOverUnencryptedObfuscatedNonC2Protocol"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exfiltrationOverUsbT1052Description",{defaultMessage:"Exfiltration over USB (T1052.001)"}),id:"T1052.001",name:"Exfiltration over USB",reference:"https://attack.mitre.org/techniques/T1052/001",tactics:"exfiltration",techniqueId:"T1052",value:"exfiltrationOverUsb"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exfiltrationToCloudStorageT1567Description",{defaultMessage:"Exfiltration to Cloud Storage (T1567.002)"}),id:"T1567.002",name:"Exfiltration to Cloud Storage",reference:"https://attack.mitre.org/techniques/T1567/002",tactics:"exfiltration",techniqueId:"T1567",value:"exfiltrationToCloudStorage"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exfiltrationToCodeRepositoryT1567Description",{defaultMessage:"Exfiltration to Code Repository (T1567.001)"}),id:"T1567.001",name:"Exfiltration to Code Repository",reference:"https://attack.mitre.org/techniques/T1567/001",tactics:"exfiltration",techniqueId:"T1567",value:"exfiltrationToCodeRepository"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exploitsT1587Description",{defaultMessage:"Exploits (T1587.004)"}),id:"T1587.004",name:"Exploits",reference:"https://attack.mitre.org/techniques/T1587/004",tactics:"resource-development",techniqueId:"T1587",value:"exploits"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exploitsT1588Description",{defaultMessage:"Exploits (T1588.005)"}),id:"T1588.005",name:"Exploits",reference:"https://attack.mitre.org/techniques/T1588/005",tactics:"resource-development",techniqueId:"T1588",value:"exploits"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.externalDefacementT1491Description",{defaultMessage:"External Defacement (T1491.002)"}),id:"T1491.002",name:"External Defacement",reference:"https://attack.mitre.org/techniques/T1491/002",tactics:"impact",techniqueId:"T1491",value:"externalDefacement"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.externalProxyT1090Description",{defaultMessage:"External Proxy (T1090.002)"}),id:"T1090.002",name:"External Proxy",reference:"https://attack.mitre.org/techniques/T1090/002",tactics:"command-and-control",techniqueId:"T1090",value:"externalProxy"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.extraWindowMemoryInjectionT1055Description",{defaultMessage:"Extra Window Memory Injection (T1055.011)"}),id:"T1055.011",name:"Extra Window Memory Injection",reference:"https://attack.mitre.org/techniques/T1055/011",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"extraWindowMemoryInjection"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.fastFluxDnsT1568Description",{defaultMessage:"Fast Flux DNS (T1568.001)"}),id:"T1568.001",name:"Fast Flux DNS",reference:"https://attack.mitre.org/techniques/T1568/001",tactics:"command-and-control",techniqueId:"T1568",value:"fastFluxDns"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.fileDeletionT1070Description",{defaultMessage:"File Deletion (T1070.004)"}),id:"T1070.004",name:"File Deletion",reference:"https://attack.mitre.org/techniques/T1070/004",tactics:"defense-evasion",techniqueId:"T1070",value:"fileDeletion"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.fileTransferProtocolsT1071Description",{defaultMessage:"File Transfer Protocols (T1071.002)"}),id:"T1071.002",name:"File Transfer Protocols",reference:"https://attack.mitre.org/techniques/T1071/002",tactics:"command-and-control",techniqueId:"T1071",value:"fileTransferProtocols"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.firmwareT1592Description",{defaultMessage:"Firmware (T1592.003)"}),id:"T1592.003",name:"Firmware",reference:"https://attack.mitre.org/techniques/T1592/003",tactics:"reconnaissance",techniqueId:"T1592",value:"firmware"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.guiInputCaptureT1056Description",{defaultMessage:"GUI Input Capture (T1056.002)"}),id:"T1056.002",name:"GUI Input Capture",reference:"https://attack.mitre.org/techniques/T1056/002",tactics:"collection,credential-access",techniqueId:"T1056",value:"guiInputCapture"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.gatekeeperBypassT1553Description",{defaultMessage:"Gatekeeper Bypass (T1553.001)"}),id:"T1553.001",name:"Gatekeeper Bypass",reference:"https://attack.mitre.org/techniques/T1553/001",tactics:"defense-evasion",techniqueId:"T1553",value:"gatekeeperBypass"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.goldenTicketT1558Description",{defaultMessage:"Golden Ticket (T1558.001)"}),id:"T1558.001",name:"Golden Ticket",reference:"https://attack.mitre.org/techniques/T1558/001",tactics:"credential-access",techniqueId:"T1558",value:"goldenTicket"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.groupPolicyModificationT1484Description",{defaultMessage:"Group Policy Modification (T1484.001)"}),id:"T1484.001",name:"Group Policy Modification",reference:"https://attack.mitre.org/techniques/T1484/001",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1484",value:"groupPolicyModification"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.groupPolicyPreferencesT1552Description",{defaultMessage:"Group Policy Preferences (T1552.006)"}),id:"T1552.006",name:"Group Policy Preferences",reference:"https://attack.mitre.org/techniques/T1552/006",tactics:"credential-access",techniqueId:"T1552",value:"groupPolicyPreferences"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.htmlSmugglingT1027Description",{defaultMessage:"HTML Smuggling (T1027.006)"}),id:"T1027.006",name:"HTML Smuggling",reference:"https://attack.mitre.org/techniques/T1027/006",tactics:"defense-evasion",techniqueId:"T1027",value:"htmlSmuggling"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.hardwareT1592Description",{defaultMessage:"Hardware (T1592.001)"}),id:"T1592.001",name:"Hardware",reference:"https://attack.mitre.org/techniques/T1592/001",tactics:"reconnaissance",techniqueId:"T1592",value:"hardware"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.hiddenFileSystemT1564Description",{defaultMessage:"Hidden File System (T1564.005)"}),id:"T1564.005",name:"Hidden File System",reference:"https://attack.mitre.org/techniques/T1564/005",tactics:"defense-evasion",techniqueId:"T1564",value:"hiddenFileSystem"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.hiddenFilesAndDirectoriesT1564Description",{defaultMessage:"Hidden Files and Directories (T1564.001)"}),id:"T1564.001",name:"Hidden Files and Directories",reference:"https://attack.mitre.org/techniques/T1564/001",tactics:"defense-evasion",techniqueId:"T1564",value:"hiddenFilesAndDirectories"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.hiddenUsersT1564Description",{defaultMessage:"Hidden Users (T1564.002)"}),id:"T1564.002",name:"Hidden Users",reference:"https://attack.mitre.org/techniques/T1564/002",tactics:"defense-evasion",techniqueId:"T1564",value:"hiddenUsers"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.hiddenWindowT1564Description",{defaultMessage:"Hidden Window (T1564.003)"}),id:"T1564.003",name:"Hidden Window",reference:"https://attack.mitre.org/techniques/T1564/003",tactics:"defense-evasion",techniqueId:"T1564",value:"hiddenWindow"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.iisComponentsT1505Description",{defaultMessage:"IIS Components (T1505.004)"}),id:"T1505.004",name:"IIS Components",reference:"https://attack.mitre.org/techniques/T1505/004",tactics:"persistence",techniqueId:"T1505",value:"iisComponents"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.ipAddressesT1590Description",{defaultMessage:"IP Addresses (T1590.005)"}),id:"T1590.005",name:"IP Addresses",reference:"https://attack.mitre.org/techniques/T1590/005",tactics:"reconnaissance",techniqueId:"T1590",value:"ipAddresses"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.identifyBusinessTempoT1591Description",{defaultMessage:"Identify Business Tempo (T1591.003)"}),id:"T1591.003",name:"Identify Business Tempo",reference:"https://attack.mitre.org/techniques/T1591/003",tactics:"reconnaissance",techniqueId:"T1591",value:"identifyBusinessTempo"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.identifyRolesT1591Description",{defaultMessage:"Identify Roles (T1591.004)"}),id:"T1591.004",name:"Identify Roles",reference:"https://attack.mitre.org/techniques/T1591/004",tactics:"reconnaissance",techniqueId:"T1591",value:"identifyRoles"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.imageFileExecutionOptionsInjectionT1546Description",{defaultMessage:"Image File Execution Options Injection (T1546.012)"}),id:"T1546.012",name:"Image File Execution Options Injection",reference:"https://attack.mitre.org/techniques/T1546/012",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"imageFileExecutionOptionsInjection"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.impairCommandHistoryLoggingT1562Description",{defaultMessage:"Impair Command History Logging (T1562.003)"}),id:"T1562.003",name:"Impair Command History Logging",reference:"https://attack.mitre.org/techniques/T1562/003",tactics:"defense-evasion",techniqueId:"T1562",value:"impairCommandHistoryLogging"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.indicatorBlockingT1562Description",{defaultMessage:"Indicator Blocking (T1562.006)"}),id:"T1562.006",name:"Indicator Blocking",reference:"https://attack.mitre.org/techniques/T1562/006",tactics:"defense-evasion",techniqueId:"T1562",value:"indicatorBlocking"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.indicatorRemovalFromToolsT1027Description",{defaultMessage:"Indicator Removal from Tools (T1027.005)"}),id:"T1027.005",name:"Indicator Removal from Tools",reference:"https://attack.mitre.org/techniques/T1027/005",tactics:"defense-evasion",techniqueId:"T1027",value:"indicatorRemovalFromTools"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.installDigitalCertificateT1608Description",{defaultMessage:"Install Digital Certificate (T1608.003)"}),id:"T1608.003",name:"Install Digital Certificate",reference:"https://attack.mitre.org/techniques/T1608/003",tactics:"resource-development",techniqueId:"T1608",value:"installDigitalCertificate"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.installRootCertificateT1553Description",{defaultMessage:"Install Root Certificate (T1553.004)"}),id:"T1553.004",name:"Install Root Certificate",reference:"https://attack.mitre.org/techniques/T1553/004",tactics:"defense-evasion",techniqueId:"T1553",value:"installRootCertificate"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.installUtilT1218Description",{defaultMessage:"InstallUtil (T1218.004)"}),id:"T1218.004",name:"InstallUtil",reference:"https://attack.mitre.org/techniques/T1218/004",tactics:"defense-evasion",techniqueId:"T1218",value:"installUtil"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.internalDefacementT1491Description",{defaultMessage:"Internal Defacement (T1491.001)"}),id:"T1491.001",name:"Internal Defacement",reference:"https://attack.mitre.org/techniques/T1491/001",tactics:"impact",techniqueId:"T1491",value:"internalDefacement"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.internalProxyT1090Description",{defaultMessage:"Internal Proxy (T1090.001)"}),id:"T1090.001",name:"Internal Proxy",reference:"https://attack.mitre.org/techniques/T1090/001",tactics:"command-and-control",techniqueId:"T1090",value:"internalProxy"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.internetConnectionDiscoveryT1016Description",{defaultMessage:"Internet Connection Discovery (T1016.001)"}),id:"T1016.001",name:"Internet Connection Discovery",reference:"https://attack.mitre.org/techniques/T1016/001",tactics:"discovery",techniqueId:"T1016",value:"internetConnectionDiscovery"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.invalidCodeSignatureT1036Description",{defaultMessage:"Invalid Code Signature (T1036.001)"}),id:"T1036.001",name:"Invalid Code Signature",reference:"https://attack.mitre.org/techniques/T1036/001",tactics:"defense-evasion",techniqueId:"T1036",value:"invalidCodeSignature"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.javaScriptT1059Description",{defaultMessage:"JavaScript (T1059.007)"}),id:"T1059.007",name:"JavaScript",reference:"https://attack.mitre.org/techniques/T1059/007",tactics:"execution",techniqueId:"T1059",value:"javaScript"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.junkDataT1001Description",{defaultMessage:"Junk Data (T1001.001)"}),id:"T1001.001",name:"Junk Data",reference:"https://attack.mitre.org/techniques/T1001/001",tactics:"command-and-control",techniqueId:"T1001",value:"junkData"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.kerberoastingT1558Description",{defaultMessage:"Kerberoasting (T1558.003)"}),id:"T1558.003",name:"Kerberoasting",reference:"https://attack.mitre.org/techniques/T1558/003",tactics:"credential-access",techniqueId:"T1558",value:"kerberoasting"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.kernelModulesAndExtensionsT1547Description",{defaultMessage:"Kernel Modules and Extensions (T1547.006)"}),id:"T1547.006",name:"Kernel Modules and Extensions",reference:"https://attack.mitre.org/techniques/T1547/006",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"kernelModulesAndExtensions"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.keychainT1555Description",{defaultMessage:"Keychain (T1555.001)"}),id:"T1555.001",name:"Keychain",reference:"https://attack.mitre.org/techniques/T1555/001",tactics:"credential-access",techniqueId:"T1555",value:"keychain"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.keyloggingT1056Description",{defaultMessage:"Keylogging (T1056.001)"}),id:"T1056.001",name:"Keylogging",reference:"https://attack.mitre.org/techniques/T1056/001",tactics:"collection,credential-access",techniqueId:"T1056",value:"keylogging"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.lcLoadDylibAdditionT1546Description",{defaultMessage:"LC_LOAD_DYLIB Addition (T1546.006)"}),id:"T1546.006",name:"LC_LOAD_DYLIB Addition",reference:"https://attack.mitre.org/techniques/T1546/006",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"lcLoadDylibAddition"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.llmnrNbtNsPoisoningAndSmbRelayT1557Description",{defaultMessage:"LLMNR/NBT-NS Poisoning and SMB Relay (T1557.001)"}),id:"T1557.001",name:"LLMNR/NBT-NS Poisoning and SMB Relay",reference:"https://attack.mitre.org/techniques/T1557/001",tactics:"credential-access,collection",techniqueId:"T1557",value:"llmnrNbtNsPoisoningAndSmbRelay"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.lsaSecretsT1003Description",{defaultMessage:"LSA Secrets (T1003.004)"}),id:"T1003.004",name:"LSA Secrets",reference:"https://attack.mitre.org/techniques/T1003/004",tactics:"credential-access",techniqueId:"T1003",value:"lsaSecrets"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.lsassDriverT1547Description",{defaultMessage:"LSASS Driver (T1547.008)"}),id:"T1547.008",name:"LSASS Driver",reference:"https://attack.mitre.org/techniques/T1547/008",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"lsassDriver"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.lsassMemoryT1003Description",{defaultMessage:"LSASS Memory (T1003.001)"}),id:"T1003.001",name:"LSASS Memory",reference:"https://attack.mitre.org/techniques/T1003/001",tactics:"credential-access",techniqueId:"T1003",value:"lsassMemory"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.launchAgentT1543Description",{defaultMessage:"Launch Agent (T1543.001)"}),id:"T1543.001",name:"Launch Agent",reference:"https://attack.mitre.org/techniques/T1543/001",tactics:"persistence,privilege-escalation",techniqueId:"T1543",value:"launchAgent"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.launchDaemonT1543Description",{defaultMessage:"Launch Daemon (T1543.004)"}),id:"T1543.004",name:"Launch Daemon",reference:"https://attack.mitre.org/techniques/T1543/004",tactics:"persistence,privilege-escalation",techniqueId:"T1543",value:"launchDaemon"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.launchctlT1569Description",{defaultMessage:"Launchctl (T1569.001)"}),id:"T1569.001",name:"Launchctl",reference:"https://attack.mitre.org/techniques/T1569/001",tactics:"execution",techniqueId:"T1569",value:"launchctl"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.launchdT1053Description",{defaultMessage:"Launchd (T1053.004)"}),id:"T1053.004",name:"Launchd",reference:"https://attack.mitre.org/techniques/T1053/004",tactics:"execution,persistence,privilege-escalation",techniqueId:"T1053",value:"launchd"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.linkTargetT1608Description",{defaultMessage:"Link Target (T1608.005)"}),id:"T1608.005",name:"Link Target",reference:"https://attack.mitre.org/techniques/T1608/005",tactics:"resource-development",techniqueId:"T1608",value:"linkTarget"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.linuxAndMacFileAndDirectoryPermissionsModificationT1222Description",{defaultMessage:"Linux and Mac File and Directory Permissions Modification (T1222.002)"}),id:"T1222.002",name:"Linux and Mac File and Directory Permissions Modification",reference:"https://attack.mitre.org/techniques/T1222/002",tactics:"defense-evasion",techniqueId:"T1222",value:"linuxAndMacFileAndDirectoryPermissionsModification"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.localAccountT1136Description",{defaultMessage:"Local Account (T1136.001)"}),id:"T1136.001",name:"Local Account",reference:"https://attack.mitre.org/techniques/T1136/001",tactics:"persistence",techniqueId:"T1136",value:"localAccount"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.localAccountT1087Description",{defaultMessage:"Local Account (T1087.001)"}),id:"T1087.001",name:"Local Account",reference:"https://attack.mitre.org/techniques/T1087/001",tactics:"discovery",techniqueId:"T1087",value:"localAccount"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.localAccountsT1078Description",{defaultMessage:"Local Accounts (T1078.003)"}),id:"T1078.003",name:"Local Accounts",reference:"https://attack.mitre.org/techniques/T1078/003",tactics:"defense-evasion,persistence,privilege-escalation,initial-access",techniqueId:"T1078",value:"localAccounts"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.localDataStagingT1074Description",{defaultMessage:"Local Data Staging (T1074.001)"}),id:"T1074.001",name:"Local Data Staging",reference:"https://attack.mitre.org/techniques/T1074/001",tactics:"collection",techniqueId:"T1074",value:"localDataStaging"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.localEmailCollectionT1114Description",{defaultMessage:"Local Email Collection (T1114.001)"}),id:"T1114.001",name:"Local Email Collection",reference:"https://attack.mitre.org/techniques/T1114/001",tactics:"collection",techniqueId:"T1114",value:"localEmailCollection"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.localGroupsT1069Description",{defaultMessage:"Local Groups (T1069.001)"}),id:"T1069.001",name:"Local Groups",reference:"https://attack.mitre.org/techniques/T1069/001",tactics:"discovery",techniqueId:"T1069",value:"localGroups"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.loginItemsT1547Description",{defaultMessage:"Login Items (T1547.015)"}),id:"T1547.015",name:"Login Items",reference:"https://attack.mitre.org/techniques/T1547/015",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"loginItems"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.logonScriptMacT1037Description",{defaultMessage:"Logon Script (Mac) (T1037.002)"}),id:"T1037.002",name:"Logon Script (Mac)",reference:"https://attack.mitre.org/techniques/T1037/002",tactics:"persistence,privilege-escalation",techniqueId:"T1037",value:"logonScriptMac"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.logonScriptWindowsT1037Description",{defaultMessage:"Logon Script (Windows) (T1037.001)"}),id:"T1037.001",name:"Logon Script (Windows)",reference:"https://attack.mitre.org/techniques/T1037/001",tactics:"persistence,privilege-escalation",techniqueId:"T1037",value:"logonScriptWindows"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.mmcT1218Description",{defaultMessage:"MMC (T1218.014)"}),id:"T1218.014",name:"MMC",reference:"https://attack.mitre.org/techniques/T1218/014",tactics:"defense-evasion",techniqueId:"T1218",value:"mmc"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.msBuildT1127Description",{defaultMessage:"MSBuild (T1127.001)"}),id:"T1127.001",name:"MSBuild",reference:"https://attack.mitre.org/techniques/T1127/001",tactics:"defense-evasion",techniqueId:"T1127",value:"msBuild"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.mailProtocolsT1071Description",{defaultMessage:"Mail Protocols (T1071.003)"}),id:"T1071.003",name:"Mail Protocols",reference:"https://attack.mitre.org/techniques/T1071/003",tactics:"command-and-control",techniqueId:"T1071",value:"mailProtocols"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.makeAndImpersonateTokenT1134Description",{defaultMessage:"Make and Impersonate Token (T1134.003)"}),id:"T1134.003",name:"Make and Impersonate Token",reference:"https://attack.mitre.org/techniques/T1134/003",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1134",value:"makeAndImpersonateToken"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.maliciousFileT1204Description",{defaultMessage:"Malicious File (T1204.002)"}),id:"T1204.002",name:"Malicious File",reference:"https://attack.mitre.org/techniques/T1204/002",tactics:"execution",techniqueId:"T1204",value:"maliciousFile"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.maliciousImageT1204Description",{defaultMessage:"Malicious Image (T1204.003)"}),id:"T1204.003",name:"Malicious Image",reference:"https://attack.mitre.org/techniques/T1204/003",tactics:"execution",techniqueId:"T1204",value:"maliciousImage"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.maliciousLinkT1204Description",{defaultMessage:"Malicious Link (T1204.001)"}),id:"T1204.001",name:"Malicious Link",reference:"https://attack.mitre.org/techniques/T1204/001",tactics:"execution",techniqueId:"T1204",value:"maliciousLink"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.malwareT1587Description",{defaultMessage:"Malware (T1587.001)"}),id:"T1587.001",name:"Malware",reference:"https://attack.mitre.org/techniques/T1587/001",tactics:"resource-development",techniqueId:"T1587",value:"malware"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.malwareT1588Description",{defaultMessage:"Malware (T1588.001)"}),id:"T1588.001",name:"Malware",reference:"https://attack.mitre.org/techniques/T1588/001",tactics:"resource-development",techniqueId:"T1588",value:"malware"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.markOfTheWebBypassT1553Description",{defaultMessage:"Mark-of-the-Web Bypass (T1553.005)"}),id:"T1553.005",name:"Mark-of-the-Web Bypass",reference:"https://attack.mitre.org/techniques/T1553/005",tactics:"defense-evasion",techniqueId:"T1553",value:"markOfTheWebBypass"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.masqueradeTaskOrServiceT1036Description",{defaultMessage:"Masquerade Task or Service (T1036.004)"}),id:"T1036.004",name:"Masquerade Task or Service",reference:"https://attack.mitre.org/techniques/T1036/004",tactics:"defense-evasion",techniqueId:"T1036",value:"masqueradeTaskOrService"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.matchLegitimateNameOrLocationT1036Description",{defaultMessage:"Match Legitimate Name or Location (T1036.005)"}),id:"T1036.005",name:"Match Legitimate Name or Location",reference:"https://attack.mitre.org/techniques/T1036/005",tactics:"defense-evasion",techniqueId:"T1036",value:"matchLegitimateNameOrLocation"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.mavinjectT1218Description",{defaultMessage:"Mavinject (T1218.013)"}),id:"T1218.013",name:"Mavinject",reference:"https://attack.mitre.org/techniques/T1218/013",tactics:"defense-evasion",techniqueId:"T1218",value:"mavinject"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.mshtaT1218Description",{defaultMessage:"Mshta (T1218.005)"}),id:"T1218.005",name:"Mshta",reference:"https://attack.mitre.org/techniques/T1218/005",tactics:"defense-evasion",techniqueId:"T1218",value:"mshta"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.msiexecT1218Description",{defaultMessage:"Msiexec (T1218.007)"}),id:"T1218.007",name:"Msiexec",reference:"https://attack.mitre.org/techniques/T1218/007",tactics:"defense-evasion",techniqueId:"T1218",value:"msiexec"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.multiHopProxyT1090Description",{defaultMessage:"Multi-hop Proxy (T1090.003)"}),id:"T1090.003",name:"Multi-hop Proxy",reference:"https://attack.mitre.org/techniques/T1090/003",tactics:"command-and-control",techniqueId:"T1090",value:"multiHopProxy"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.ntdsT1003Description",{defaultMessage:"NTDS (T1003.003)"}),id:"T1003.003",name:"NTDS",reference:"https://attack.mitre.org/techniques/T1003/003",tactics:"credential-access",techniqueId:"T1003",value:"ntds"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.ntfsFileAttributesT1564Description",{defaultMessage:"NTFS File Attributes (T1564.004)"}),id:"T1564.004",name:"NTFS File Attributes",reference:"https://attack.mitre.org/techniques/T1564/004",tactics:"defense-evasion",techniqueId:"T1564",value:"ntfsFileAttributes"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.netshHelperDllT1546Description",{defaultMessage:"Netsh Helper DLL (T1546.007)"}),id:"T1546.007",name:"Netsh Helper DLL",reference:"https://attack.mitre.org/techniques/T1546/007",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"netshHelperDll"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.networkAddressTranslationTraversalT1599Description",{defaultMessage:"Network Address Translation Traversal (T1599.001)"}),id:"T1599.001",name:"Network Address Translation Traversal",reference:"https://attack.mitre.org/techniques/T1599/001",tactics:"defense-evasion",techniqueId:"T1599",value:"networkAddressTranslationTraversal"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.networkDeviceAuthenticationT1556Description",{defaultMessage:"Network Device Authentication (T1556.004)"}),id:"T1556.004",name:"Network Device Authentication",reference:"https://attack.mitre.org/techniques/T1556/004",tactics:"credential-access,defense-evasion,persistence",techniqueId:"T1556",value:"networkDeviceAuthentication"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.networkDeviceCliT1059Description",{defaultMessage:"Network Device CLI (T1059.008)"}),id:"T1059.008",name:"Network Device CLI",reference:"https://attack.mitre.org/techniques/T1059/008",tactics:"execution",techniqueId:"T1059",value:"networkDeviceCli"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.networkDeviceConfigurationDumpT1602Description",{defaultMessage:"Network Device Configuration Dump (T1602.002)"}),id:"T1602.002",name:"Network Device Configuration Dump",reference:"https://attack.mitre.org/techniques/T1602/002",tactics:"collection",techniqueId:"T1602",value:"networkDeviceConfigurationDump"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.networkLogonScriptT1037Description",{defaultMessage:"Network Logon Script (T1037.003)"}),id:"T1037.003",name:"Network Logon Script",reference:"https://attack.mitre.org/techniques/T1037/003",tactics:"persistence,privilege-escalation",techniqueId:"T1037",value:"networkLogonScript"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.networkSecurityAppliancesT1590Description",{defaultMessage:"Network Security Appliances (T1590.006)"}),id:"T1590.006",name:"Network Security Appliances",reference:"https://attack.mitre.org/techniques/T1590/006",tactics:"reconnaissance",techniqueId:"T1590",value:"networkSecurityAppliances"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.networkShareConnectionRemovalT1070Description",{defaultMessage:"Network Share Connection Removal (T1070.005)"}),id:"T1070.005",name:"Network Share Connection Removal",reference:"https://attack.mitre.org/techniques/T1070/005",tactics:"defense-evasion",techniqueId:"T1070",value:"networkShareConnectionRemoval"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.networkTopologyT1590Description",{defaultMessage:"Network Topology (T1590.004)"}),id:"T1590.004",name:"Network Topology",reference:"https://attack.mitre.org/techniques/T1590/004",tactics:"reconnaissance",techniqueId:"T1590",value:"networkTopology"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.networkTrustDependenciesT1590Description",{defaultMessage:"Network Trust Dependencies (T1590.003)"}),id:"T1590.003",name:"Network Trust Dependencies",reference:"https://attack.mitre.org/techniques/T1590/003",tactics:"reconnaissance",techniqueId:"T1590",value:"networkTrustDependencies"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.nonStandardEncodingT1132Description",{defaultMessage:"Non-Standard Encoding (T1132.002)"}),id:"T1132.002",name:"Non-Standard Encoding",reference:"https://attack.mitre.org/techniques/T1132/002",tactics:"command-and-control",techniqueId:"T1132",value:"nonStandardEncoding"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.osExhaustionFloodT1499Description",{defaultMessage:"OS Exhaustion Flood (T1499.001)"}),id:"T1499.001",name:"OS Exhaustion Flood",reference:"https://attack.mitre.org/techniques/T1499/001",tactics:"impact",techniqueId:"T1499",value:"osExhaustionFlood"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.odbcconfT1218Description",{defaultMessage:"Odbcconf (T1218.008)"}),id:"T1218.008",name:"Odbcconf",reference:"https://attack.mitre.org/techniques/T1218/008",tactics:"defense-evasion",techniqueId:"T1218",value:"odbcconf"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.officeTemplateMacrosT1137Description",{defaultMessage:"Office Template Macros (T1137.001)"}),id:"T1137.001",name:"Office Template Macros",reference:"https://attack.mitre.org/techniques/T1137/001",tactics:"persistence",techniqueId:"T1137",value:"officeTemplateMacros"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.officeTestT1137Description",{defaultMessage:"Office Test (T1137.002)"}),id:"T1137.002",name:"Office Test",reference:"https://attack.mitre.org/techniques/T1137/002",tactics:"persistence",techniqueId:"T1137",value:"officeTest"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.oneWayCommunicationT1102Description",{defaultMessage:"One-Way Communication (T1102.003)"}),id:"T1102.003",name:"One-Way Communication",reference:"https://attack.mitre.org/techniques/T1102/003",tactics:"command-and-control",techniqueId:"T1102",value:"oneWayCommunication"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.outlookFormsT1137Description",{defaultMessage:"Outlook Forms (T1137.003)"}),id:"T1137.003",name:"Outlook Forms",reference:"https://attack.mitre.org/techniques/T1137/003",tactics:"persistence",techniqueId:"T1137",value:"outlookForms"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.outlookHomePageT1137Description",{defaultMessage:"Outlook Home Page (T1137.004)"}),id:"T1137.004",name:"Outlook Home Page",reference:"https://attack.mitre.org/techniques/T1137/004",tactics:"persistence",techniqueId:"T1137",value:"outlookHomePage"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.outlookRulesT1137Description",{defaultMessage:"Outlook Rules (T1137.005)"}),id:"T1137.005",name:"Outlook Rules",reference:"https://attack.mitre.org/techniques/T1137/005",tactics:"persistence",techniqueId:"T1137",value:"outlookRules"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.parentPidSpoofingT1134Description",{defaultMessage:"Parent PID Spoofing (T1134.004)"}),id:"T1134.004",name:"Parent PID Spoofing",reference:"https://attack.mitre.org/techniques/T1134/004",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1134",value:"parentPidSpoofing"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.passTheHashT1550Description",{defaultMessage:"Pass the Hash (T1550.002)"}),id:"T1550.002",name:"Pass the Hash",reference:"https://attack.mitre.org/techniques/T1550/002",tactics:"defense-evasion,lateral-movement",techniqueId:"T1550",value:"passTheHash"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.passTheTicketT1550Description",{defaultMessage:"Pass the Ticket (T1550.003)"}),id:"T1550.003",name:"Pass the Ticket",reference:"https://attack.mitre.org/techniques/T1550/003",tactics:"defense-evasion,lateral-movement",techniqueId:"T1550",value:"passTheTicket"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.passwordCrackingT1110Description",{defaultMessage:"Password Cracking (T1110.002)"}),id:"T1110.002",name:"Password Cracking",reference:"https://attack.mitre.org/techniques/T1110/002",tactics:"credential-access",techniqueId:"T1110",value:"passwordCracking"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.passwordFilterDllT1556Description",{defaultMessage:"Password Filter DLL (T1556.002)"}),id:"T1556.002",name:"Password Filter DLL",reference:"https://attack.mitre.org/techniques/T1556/002",tactics:"credential-access,defense-evasion,persistence",techniqueId:"T1556",value:"passwordFilterDll"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.passwordGuessingT1110Description",{defaultMessage:"Password Guessing (T1110.001)"}),id:"T1110.001",name:"Password Guessing",reference:"https://attack.mitre.org/techniques/T1110/001",tactics:"credential-access",techniqueId:"T1110",value:"passwordGuessing"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.passwordManagersT1555Description",{defaultMessage:"Password Managers (T1555.005)"}),id:"T1555.005",name:"Password Managers",reference:"https://attack.mitre.org/techniques/T1555/005",tactics:"credential-access",techniqueId:"T1555",value:"passwordManagers"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.passwordSprayingT1110Description",{defaultMessage:"Password Spraying (T1110.003)"}),id:"T1110.003",name:"Password Spraying",reference:"https://attack.mitre.org/techniques/T1110/003",tactics:"credential-access",techniqueId:"T1110",value:"passwordSpraying"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.patchSystemImageT1601Description",{defaultMessage:"Patch System Image (T1601.001)"}),id:"T1601.001",name:"Patch System Image",reference:"https://attack.mitre.org/techniques/T1601/001",tactics:"defense-evasion",techniqueId:"T1601",value:"patchSystemImage"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.pathInterceptionByPathEnvironmentVariableT1574Description",{defaultMessage:"Path Interception by PATH Environment Variable (T1574.007)"}),id:"T1574.007",name:"Path Interception by PATH Environment Variable",reference:"https://attack.mitre.org/techniques/T1574/007",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"pathInterceptionByPathEnvironmentVariable"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.pathInterceptionBySearchOrderHijackingT1574Description",{defaultMessage:"Path Interception by Search Order Hijacking (T1574.008)"}),id:"T1574.008",name:"Path Interception by Search Order Hijacking",reference:"https://attack.mitre.org/techniques/T1574/008",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"pathInterceptionBySearchOrderHijacking"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.pathInterceptionByUnquotedPathT1574Description",{defaultMessage:"Path Interception by Unquoted Path (T1574.009)"}),id:"T1574.009",name:"Path Interception by Unquoted Path",reference:"https://attack.mitre.org/techniques/T1574/009",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"pathInterceptionByUnquotedPath"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.plistModificationT1547Description",{defaultMessage:"Plist Modification (T1547.011)"}),id:"T1547.011",name:"Plist Modification",reference:"https://attack.mitre.org/techniques/T1547/011",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"plistModification"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.pluggableAuthenticationModulesT1556Description",{defaultMessage:"Pluggable Authentication Modules (T1556.003)"}),id:"T1556.003",name:"Pluggable Authentication Modules",reference:"https://attack.mitre.org/techniques/T1556/003",tactics:"credential-access,defense-evasion,persistence",techniqueId:"T1556",value:"pluggableAuthenticationModules"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.portKnockingT1205Description",{defaultMessage:"Port Knocking (T1205.001)"}),id:"T1205.001",name:"Port Knocking",reference:"https://attack.mitre.org/techniques/T1205/001",tactics:"defense-evasion,persistence,command-and-control",techniqueId:"T1205",value:"portKnocking"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.portMonitorsT1547Description",{defaultMessage:"Port Monitors (T1547.010)"}),id:"T1547.010",name:"Port Monitors",reference:"https://attack.mitre.org/techniques/T1547/010",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"portMonitors"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.portableExecutableInjectionT1055Description",{defaultMessage:"Portable Executable Injection (T1055.002)"}),id:"T1055.002",name:"Portable Executable Injection",reference:"https://attack.mitre.org/techniques/T1055/002",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"portableExecutableInjection"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.powerShellT1059Description",{defaultMessage:"PowerShell (T1059.001)"}),id:"T1059.001",name:"PowerShell",reference:"https://attack.mitre.org/techniques/T1059/001",tactics:"execution",techniqueId:"T1059",value:"powerShell"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.powerShellProfileT1546Description",{defaultMessage:"PowerShell Profile (T1546.013)"}),id:"T1546.013",name:"PowerShell Profile",reference:"https://attack.mitre.org/techniques/T1546/013",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"powerShellProfile"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.printProcessorsT1547Description",{defaultMessage:"Print Processors (T1547.012)"}),id:"T1547.012",name:"Print Processors",reference:"https://attack.mitre.org/techniques/T1547/012",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"printProcessors"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.privateKeysT1552Description",{defaultMessage:"Private Keys (T1552.004)"}),id:"T1552.004",name:"Private Keys",reference:"https://attack.mitre.org/techniques/T1552/004",tactics:"credential-access",techniqueId:"T1552",value:"privateKeys"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.procFilesystemT1003Description",{defaultMessage:"Proc Filesystem (T1003.007)"}),id:"T1003.007",name:"Proc Filesystem",reference:"https://attack.mitre.org/techniques/T1003/007",tactics:"credential-access",techniqueId:"T1003",value:"procFilesystem"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.procMemoryT1055Description",{defaultMessage:"Proc Memory (T1055.009)"}),id:"T1055.009",name:"Proc Memory",reference:"https://attack.mitre.org/techniques/T1055/009",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"procMemory"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.processDoppelgangingT1055Description",{defaultMessage:"Process DoppelgÃ¤nging (T1055.013)"}),id:"T1055.013",name:"Process DoppelgÃ¤nging",reference:"https://attack.mitre.org/techniques/T1055/013",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"processDoppelganging"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.processHollowingT1055Description",{defaultMessage:"Process Hollowing (T1055.012)"}),id:"T1055.012",name:"Process Hollowing",reference:"https://attack.mitre.org/techniques/T1055/012",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"processHollowing"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.protocolImpersonationT1001Description",{defaultMessage:"Protocol Impersonation (T1001.003)"}),id:"T1001.003",name:"Protocol Impersonation",reference:"https://attack.mitre.org/techniques/T1001/003",tactics:"command-and-control",techniqueId:"T1001",value:"protocolImpersonation"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.ptraceSystemCallsT1055Description",{defaultMessage:"Ptrace System Calls (T1055.008)"}),id:"T1055.008",name:"Ptrace System Calls",reference:"https://attack.mitre.org/techniques/T1055/008",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"ptraceSystemCalls"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.pubPrnT1216Description",{defaultMessage:"PubPrn (T1216.001)"}),id:"T1216.001",name:"PubPrn",reference:"https://attack.mitre.org/techniques/T1216/001",tactics:"defense-evasion",techniqueId:"T1216",value:"pubPrn"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.purchaseTechnicalDataT1597Description",{defaultMessage:"Purchase Technical Data (T1597.002)"}),id:"T1597.002",name:"Purchase Technical Data",reference:"https://attack.mitre.org/techniques/T1597/002",tactics:"reconnaissance",techniqueId:"T1597",value:"purchaseTechnicalData"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.pythonT1059Description",{defaultMessage:"Python (T1059.006)"}),id:"T1059.006",name:"Python",reference:"https://attack.mitre.org/techniques/T1059/006",tactics:"execution",techniqueId:"T1059",value:"python"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.rcScriptsT1037Description",{defaultMessage:"RC Scripts (T1037.004)"}),id:"T1037.004",name:"RC Scripts",reference:"https://attack.mitre.org/techniques/T1037/004",tactics:"persistence,privilege-escalation",techniqueId:"T1037",value:"rcScripts"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.rdpHijackingT1563Description",{defaultMessage:"RDP Hijacking (T1563.002)"}),id:"T1563.002",name:"RDP Hijacking",reference:"https://attack.mitre.org/techniques/T1563/002",tactics:"lateral-movement",techniqueId:"T1563",value:"rdpHijacking"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.rommoNkitT1542Description",{defaultMessage:"ROMMONkit (T1542.004)"}),id:"T1542.004",name:"ROMMONkit",reference:"https://attack.mitre.org/techniques/T1542/004",tactics:"defense-evasion,persistence",techniqueId:"T1542",value:"rommoNkit"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.reOpenedApplicationsT1547Description",{defaultMessage:"Re-opened Applications (T1547.007)"}),id:"T1547.007",name:"Re-opened Applications",reference:"https://attack.mitre.org/techniques/T1547/007",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"reOpenedApplications"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.reduceKeySpaceT1600Description",{defaultMessage:"Reduce Key Space (T1600.001)"}),id:"T1600.001",name:"Reduce Key Space",reference:"https://attack.mitre.org/techniques/T1600/001",tactics:"defense-evasion",techniqueId:"T1600",value:"reduceKeySpace"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.reflectionAmplificationT1498Description",{defaultMessage:"Reflection Amplification (T1498.002)"}),id:"T1498.002",name:"Reflection Amplification",reference:"https://attack.mitre.org/techniques/T1498/002",tactics:"impact",techniqueId:"T1498",value:"reflectionAmplification"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.registryRunKeysStartupFolderT1547Description",{defaultMessage:"Registry Run Keys / Startup Folder (T1547.001)"}),id:"T1547.001",name:"Registry Run Keys / Startup Folder",reference:"https://attack.mitre.org/techniques/T1547/001",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"registryRunKeysStartupFolder"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.regsvcsRegasmT1218Description",{defaultMessage:"Regsvcs/Regasm (T1218.009)"}),id:"T1218.009",name:"Regsvcs/Regasm",reference:"https://attack.mitre.org/techniques/T1218/009",tactics:"defense-evasion",techniqueId:"T1218",value:"regsvcsRegasm"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.regsvr32T1218Description",{defaultMessage:"Regsvr32 (T1218.010)"}),id:"T1218.010",name:"Regsvr32",reference:"https://attack.mitre.org/techniques/T1218/010",tactics:"defense-evasion",techniqueId:"T1218",value:"regsvr32"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.remoteDataStagingT1074Description",{defaultMessage:"Remote Data Staging (T1074.002)"}),id:"T1074.002",name:"Remote Data Staging",reference:"https://attack.mitre.org/techniques/T1074/002",tactics:"collection",techniqueId:"T1074",value:"remoteDataStaging"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.remoteDesktopProtocolT1021Description",{defaultMessage:"Remote Desktop Protocol (T1021.001)"}),id:"T1021.001",name:"Remote Desktop Protocol",reference:"https://attack.mitre.org/techniques/T1021/001",tactics:"lateral-movement",techniqueId:"T1021",value:"remoteDesktopProtocol"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.remoteEmailCollectionT1114Description",{defaultMessage:"Remote Email Collection (T1114.002)"}),id:"T1114.002",name:"Remote Email Collection",reference:"https://attack.mitre.org/techniques/T1114/002",tactics:"collection",techniqueId:"T1114",value:"remoteEmailCollection"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.renameSystemUtilitiesT1036Description",{defaultMessage:"Rename System Utilities (T1036.003)"}),id:"T1036.003",name:"Rename System Utilities",reference:"https://attack.mitre.org/techniques/T1036/003",tactics:"defense-evasion",techniqueId:"T1036",value:"renameSystemUtilities"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.resourceForkingT1564Description",{defaultMessage:"Resource Forking (T1564.009)"}),id:"T1564.009",name:"Resource Forking",reference:"https://attack.mitre.org/techniques/T1564/009",tactics:"defense-evasion",techniqueId:"T1564",value:"resourceForking"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.revertCloudInstanceT1578Description",{defaultMessage:"Revert Cloud Instance (T1578.004)"}),id:"T1578.004",name:"Revert Cloud Instance",reference:"https://attack.mitre.org/techniques/T1578/004",tactics:"defense-evasion",techniqueId:"T1578",value:"revertCloudInstance"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.rightToLeftOverrideT1036Description",{defaultMessage:"Right-to-Left Override (T1036.002)"}),id:"T1036.002",name:"Right-to-Left Override",reference:"https://attack.mitre.org/techniques/T1036/002",tactics:"defense-evasion",techniqueId:"T1036",value:"rightToLeftOverride"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.runVirtualInstanceT1564Description",{defaultMessage:"Run Virtual Instance (T1564.006)"}),id:"T1564.006",name:"Run Virtual Instance",reference:"https://attack.mitre.org/techniques/T1564/006",tactics:"defense-evasion",techniqueId:"T1564",value:"runVirtualInstance"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.rundll32T1218Description",{defaultMessage:"Rundll32 (T1218.011)"}),id:"T1218.011",name:"Rundll32",reference:"https://attack.mitre.org/techniques/T1218/011",tactics:"defense-evasion",techniqueId:"T1218",value:"rundll32"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.runtimeDataManipulationT1565Description",{defaultMessage:"Runtime Data Manipulation (T1565.003)"}),id:"T1565.003",name:"Runtime Data Manipulation",reference:"https://attack.mitre.org/techniques/T1565/003",tactics:"impact",techniqueId:"T1565",value:"runtimeDataManipulation"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.samlTokensT1606Description",{defaultMessage:"SAML Tokens (T1606.002)"}),id:"T1606.002",name:"SAML Tokens",reference:"https://attack.mitre.org/techniques/T1606/002",tactics:"credential-access",techniqueId:"T1606",value:"samlTokens"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.sidHistoryInjectionT1134Description",{defaultMessage:"SID-History Injection (T1134.005)"}),id:"T1134.005",name:"SID-History Injection",reference:"https://attack.mitre.org/techniques/T1134/005",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1134",value:"sidHistoryInjection"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.sipAndTrustProviderHijackingT1553Description",{defaultMessage:"SIP and Trust Provider Hijacking (T1553.003)"}),id:"T1553.003",name:"SIP and Trust Provider Hijacking",reference:"https://attack.mitre.org/techniques/T1553/003",tactics:"defense-evasion",techniqueId:"T1553",value:"sipAndTrustProviderHijacking"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.smbWindowsAdminSharesT1021Description",{defaultMessage:"SMB/Windows Admin Shares (T1021.002)"}),id:"T1021.002",name:"SMB/Windows Admin Shares",reference:"https://attack.mitre.org/techniques/T1021/002",tactics:"lateral-movement",techniqueId:"T1021",value:"smbWindowsAdminShares"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.snmpMibDumpT1602Description",{defaultMessage:"SNMP (MIB Dump) (T1602.001)"}),id:"T1602.001",name:"SNMP (MIB Dump)",reference:"https://attack.mitre.org/techniques/T1602/001",tactics:"collection",techniqueId:"T1602",value:"snmpMibDump"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.sqlStoredProceduresT1505Description",{defaultMessage:"SQL Stored Procedures (T1505.001)"}),id:"T1505.001",name:"SQL Stored Procedures",reference:"https://attack.mitre.org/techniques/T1505/001",tactics:"persistence",techniqueId:"T1505",value:"sqlStoredProcedures"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.sshT1021Description",{defaultMessage:"SSH (T1021.004)"}),id:"T1021.004",name:"SSH",reference:"https://attack.mitre.org/techniques/T1021/004",tactics:"lateral-movement",techniqueId:"T1021",value:"ssh"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.sshAuthorizedKeysT1098Description",{defaultMessage:"SSH Authorized Keys (T1098.004)"}),id:"T1098.004",name:"SSH Authorized Keys",reference:"https://attack.mitre.org/techniques/T1098/004",tactics:"persistence",techniqueId:"T1098",value:"sshAuthorizedKeys"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.sshHijackingT1563Description",{defaultMessage:"SSH Hijacking (T1563.001)"}),id:"T1563.001",name:"SSH Hijacking",reference:"https://attack.mitre.org/techniques/T1563/001",tactics:"lateral-movement",techniqueId:"T1563",value:"sshHijacking"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.safeModeBootT1562Description",{defaultMessage:"Safe Mode Boot (T1562.009)"}),id:"T1562.009",name:"Safe Mode Boot",reference:"https://attack.mitre.org/techniques/T1562/009",tactics:"defense-evasion",techniqueId:"T1562",value:"safeModeBoot"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.scanDatabasesT1596Description",{defaultMessage:"Scan Databases (T1596.005)"}),id:"T1596.005",name:"Scan Databases",reference:"https://attack.mitre.org/techniques/T1596/005",tactics:"reconnaissance",techniqueId:"T1596",value:"scanDatabases"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.scanningIpBlocksT1595Description",{defaultMessage:"Scanning IP Blocks (T1595.001)"}),id:"T1595.001",name:"Scanning IP Blocks",reference:"https://attack.mitre.org/techniques/T1595/001",tactics:"reconnaissance",techniqueId:"T1595",value:"scanningIpBlocks"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.scheduledTaskT1053Description",{defaultMessage:"Scheduled Task (T1053.005)"}),id:"T1053.005",name:"Scheduled Task",reference:"https://attack.mitre.org/techniques/T1053/005",tactics:"execution,persistence,privilege-escalation",techniqueId:"T1053",value:"scheduledTask"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.screensaverT1546Description",{defaultMessage:"Screensaver (T1546.002)"}),id:"T1546.002",name:"Screensaver",reference:"https://attack.mitre.org/techniques/T1546/002",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"screensaver"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.searchEnginesT1593Description",{defaultMessage:"Search Engines (T1593.002)"}),id:"T1593.002",name:"Search Engines",reference:"https://attack.mitre.org/techniques/T1593/002",tactics:"reconnaissance",techniqueId:"T1593",value:"searchEngines"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.securityAccountManagerT1003Description",{defaultMessage:"Security Account Manager (T1003.002)"}),id:"T1003.002",name:"Security Account Manager",reference:"https://attack.mitre.org/techniques/T1003/002",tactics:"credential-access",techniqueId:"T1003",value:"securityAccountManager"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.securitySoftwareDiscoveryT1518Description",{defaultMessage:"Security Software Discovery (T1518.001)"}),id:"T1518.001",name:"Security Software Discovery",reference:"https://attack.mitre.org/techniques/T1518/001",tactics:"discovery",techniqueId:"T1518",value:"securitySoftwareDiscovery"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.securitySupportProviderT1547Description",{defaultMessage:"Security Support Provider (T1547.005)"}),id:"T1547.005",name:"Security Support Provider",reference:"https://attack.mitre.org/techniques/T1547/005",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"securitySupportProvider"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.securitydMemoryT1555Description",{defaultMessage:"Securityd Memory (T1555.002)"}),id:"T1555.002",name:"Securityd Memory",reference:"https://attack.mitre.org/techniques/T1555/002",tactics:"credential-access",techniqueId:"T1555",value:"securitydMemory"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.serverT1583Description",{defaultMessage:"Server (T1583.004)"}),id:"T1583.004",name:"Server",reference:"https://attack.mitre.org/techniques/T1583/004",tactics:"resource-development",techniqueId:"T1583",value:"server"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.serverT1584Description",{defaultMessage:"Server (T1584.004)"}),id:"T1584.004",name:"Server",reference:"https://attack.mitre.org/techniques/T1584/004",tactics:"resource-development",techniqueId:"T1584",value:"server"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.serviceExecutionT1569Description",{defaultMessage:"Service Execution (T1569.002)"}),id:"T1569.002",name:"Service Execution",reference:"https://attack.mitre.org/techniques/T1569/002",tactics:"execution",techniqueId:"T1569",value:"serviceExecution"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.serviceExhaustionFloodT1499Description",{defaultMessage:"Service Exhaustion Flood (T1499.002)"}),id:"T1499.002",name:"Service Exhaustion Flood",reference:"https://attack.mitre.org/techniques/T1499/002",tactics:"impact",techniqueId:"T1499",value:"serviceExhaustionFlood"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.servicesFilePermissionsWeaknessT1574Description",{defaultMessage:"Services File Permissions Weakness (T1574.010)"}),id:"T1574.010",name:"Services File Permissions Weakness",reference:"https://attack.mitre.org/techniques/T1574/010",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"servicesFilePermissionsWeakness"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.servicesRegistryPermissionsWeaknessT1574Description",{defaultMessage:"Services Registry Permissions Weakness (T1574.011)"}),id:"T1574.011",name:"Services Registry Permissions Weakness",reference:"https://attack.mitre.org/techniques/T1574/011",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"servicesRegistryPermissionsWeakness"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.setuidAndSetgidT1548Description",{defaultMessage:"Setuid and Setgid (T1548.001)"}),id:"T1548.001",name:"Setuid and Setgid",reference:"https://attack.mitre.org/techniques/T1548/001",tactics:"privilege-escalation,defense-evasion",techniqueId:"T1548",value:"setuidAndSetgid"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.sharepointT1213Description",{defaultMessage:"Sharepoint (T1213.002)"}),id:"T1213.002",name:"Sharepoint",reference:"https://attack.mitre.org/techniques/T1213/002",tactics:"collection",techniqueId:"T1213",value:"sharepoint"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.shortcutModificationT1547Description",{defaultMessage:"Shortcut Modification (T1547.009)"}),id:"T1547.009",name:"Shortcut Modification",reference:"https://attack.mitre.org/techniques/T1547/009",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"shortcutModification"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.silverTicketT1558Description",{defaultMessage:"Silver Ticket (T1558.002)"}),id:"T1558.002",name:"Silver Ticket",reference:"https://attack.mitre.org/techniques/T1558/002",tactics:"credential-access",techniqueId:"T1558",value:"silverTicket"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.socialMediaT1593Description",{defaultMessage:"Social Media (T1593.001)"}),id:"T1593.001",name:"Social Media",reference:"https://attack.mitre.org/techniques/T1593/001",tactics:"reconnaissance",techniqueId:"T1593",value:"socialMedia"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.socialMediaAccountsT1585Description",{defaultMessage:"Social Media Accounts (T1585.001)"}),id:"T1585.001",name:"Social Media Accounts",reference:"https://attack.mitre.org/techniques/T1585/001",tactics:"resource-development",techniqueId:"T1585",value:"socialMediaAccounts"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.socialMediaAccountsT1586Description",{defaultMessage:"Social Media Accounts (T1586.001)"}),id:"T1586.001",name:"Social Media Accounts",reference:"https://attack.mitre.org/techniques/T1586/001",tactics:"resource-development",techniqueId:"T1586",value:"socialMediaAccounts"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.softwareT1592Description",{defaultMessage:"Software (T1592.002)"}),id:"T1592.002",name:"Software",reference:"https://attack.mitre.org/techniques/T1592/002",tactics:"reconnaissance",techniqueId:"T1592",value:"software"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.softwarePackingT1027Description",{defaultMessage:"Software Packing (T1027.002)"}),id:"T1027.002",name:"Software Packing",reference:"https://attack.mitre.org/techniques/T1027/002",tactics:"defense-evasion",techniqueId:"T1027",value:"softwarePacking"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.spaceAfterFilenameT1036Description",{defaultMessage:"Space after Filename (T1036.006)"}),id:"T1036.006",name:"Space after Filename",reference:"https://attack.mitre.org/techniques/T1036/006",tactics:"defense-evasion",techniqueId:"T1036",value:"spaceAfterFilename"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.spearphishingAttachmentT1566Description",{defaultMessage:"Spearphishing Attachment (T1566.001)"}),id:"T1566.001",name:"Spearphishing Attachment",reference:"https://attack.mitre.org/techniques/T1566/001",tactics:"initial-access",techniqueId:"T1566",value:"spearphishingAttachment"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.spearphishingAttachmentT1598Description",{defaultMessage:"Spearphishing Attachment (T1598.002)"}),id:"T1598.002",name:"Spearphishing Attachment",reference:"https://attack.mitre.org/techniques/T1598/002",tactics:"reconnaissance",techniqueId:"T1598",value:"spearphishingAttachment"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.spearphishingLinkT1566Description",{defaultMessage:"Spearphishing Link (T1566.002)"}),id:"T1566.002",name:"Spearphishing Link",reference:"https://attack.mitre.org/techniques/T1566/002",tactics:"initial-access",techniqueId:"T1566",value:"spearphishingLink"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.spearphishingLinkT1598Description",{defaultMessage:"Spearphishing Link (T1598.003)"}),id:"T1598.003",name:"Spearphishing Link",reference:"https://attack.mitre.org/techniques/T1598/003",tactics:"reconnaissance",techniqueId:"T1598",value:"spearphishingLink"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.spearphishingServiceT1598Description",{defaultMessage:"Spearphishing Service (T1598.001)"}),id:"T1598.001",name:"Spearphishing Service",reference:"https://attack.mitre.org/techniques/T1598/001",tactics:"reconnaissance",techniqueId:"T1598",value:"spearphishingService"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.spearphishingViaServiceT1566Description",{defaultMessage:"Spearphishing via Service (T1566.003)"}),id:"T1566.003",name:"Spearphishing via Service",reference:"https://attack.mitre.org/techniques/T1566/003",tactics:"initial-access",techniqueId:"T1566",value:"spearphishingViaService"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.standardEncodingT1132Description",{defaultMessage:"Standard Encoding (T1132.001)"}),id:"T1132.001",name:"Standard Encoding",reference:"https://attack.mitre.org/techniques/T1132/001",tactics:"command-and-control",techniqueId:"T1132",value:"standardEncoding"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.startupItemsT1037Description",{defaultMessage:"Startup Items (T1037.005)"}),id:"T1037.005",name:"Startup Items",reference:"https://attack.mitre.org/techniques/T1037/005",tactics:"persistence,privilege-escalation",techniqueId:"T1037",value:"startupItems"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.steganographyT1027Description",{defaultMessage:"Steganography (T1027.003)"}),id:"T1027.003",name:"Steganography",reference:"https://attack.mitre.org/techniques/T1027/003",tactics:"defense-evasion",techniqueId:"T1027",value:"steganography"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.steganographyT1001Description",{defaultMessage:"Steganography (T1001.002)"}),id:"T1001.002",name:"Steganography",reference:"https://attack.mitre.org/techniques/T1001/002",tactics:"command-and-control",techniqueId:"T1001",value:"steganography"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.storedDataManipulationT1565Description",{defaultMessage:"Stored Data Manipulation (T1565.001)"}),id:"T1565.001",name:"Stored Data Manipulation",reference:"https://attack.mitre.org/techniques/T1565/001",tactics:"impact",techniqueId:"T1565",value:"storedDataManipulation"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.sudoAndSudoCachingT1548Description",{defaultMessage:"Sudo and Sudo Caching (T1548.003)"}),id:"T1548.003",name:"Sudo and Sudo Caching",reference:"https://attack.mitre.org/techniques/T1548/003",tactics:"privilege-escalation,defense-evasion",techniqueId:"T1548",value:"sudoAndSudoCaching"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.symmetricCryptographyT1573Description",{defaultMessage:"Symmetric Cryptography (T1573.001)"}),id:"T1573.001",name:"Symmetric Cryptography",reference:"https://attack.mitre.org/techniques/T1573/001",tactics:"command-and-control",techniqueId:"T1573",value:"symmetricCryptography"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.systemChecksT1497Description",{defaultMessage:"System Checks (T1497.001)"}),id:"T1497.001",name:"System Checks",reference:"https://attack.mitre.org/techniques/T1497/001",tactics:"defense-evasion,discovery",techniqueId:"T1497",value:"systemChecks"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.systemFirmwareT1542Description",{defaultMessage:"System Firmware (T1542.001)"}),id:"T1542.001",name:"System Firmware",reference:"https://attack.mitre.org/techniques/T1542/001",tactics:"persistence,defense-evasion",techniqueId:"T1542",value:"systemFirmware"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.systemLanguageDiscoveryT1614Description",{defaultMessage:"System Language Discovery (T1614.001)"}),id:"T1614.001",name:"System Language Discovery",reference:"https://attack.mitre.org/techniques/T1614/001",tactics:"discovery",techniqueId:"T1614",value:"systemLanguageDiscovery"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.systemdServiceT1543Description",{defaultMessage:"Systemd Service (T1543.002)"}),id:"T1543.002",name:"Systemd Service",reference:"https://attack.mitre.org/techniques/T1543/002",tactics:"persistence,privilege-escalation",techniqueId:"T1543",value:"systemdService"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.systemdTimersT1053Description",{defaultMessage:"Systemd Timers (T1053.006)"}),id:"T1053.006",name:"Systemd Timers",reference:"https://attack.mitre.org/techniques/T1053/006",tactics:"execution,persistence,privilege-escalation",techniqueId:"T1053",value:"systemdTimers"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.tftpBootT1542Description",{defaultMessage:"TFTP Boot (T1542.005)"}),id:"T1542.005",name:"TFTP Boot",reference:"https://attack.mitre.org/techniques/T1542/005",tactics:"defense-evasion,persistence",techniqueId:"T1542",value:"tftpBoot"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.threadExecutionHijackingT1055Description",{defaultMessage:"Thread Execution Hijacking (T1055.003)"}),id:"T1055.003",name:"Thread Execution Hijacking",reference:"https://attack.mitre.org/techniques/T1055/003",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"threadExecutionHijacking"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.threadLocalStorageT1055Description",{defaultMessage:"Thread Local Storage (T1055.005)"}),id:"T1055.005",name:"Thread Local Storage",reference:"https://attack.mitre.org/techniques/T1055/005",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"threadLocalStorage"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.threatIntelVendorsT1597Description",{defaultMessage:"Threat Intel Vendors (T1597.001)"}),id:"T1597.001",name:"Threat Intel Vendors",reference:"https://attack.mitre.org/techniques/T1597/001",tactics:"reconnaissance",techniqueId:"T1597",value:"threatIntelVendors"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.timeBasedEvasionT1497Description",{defaultMessage:"Time Based Evasion (T1497.003)"}),id:"T1497.003",name:"Time Based Evasion",reference:"https://attack.mitre.org/techniques/T1497/003",tactics:"defense-evasion,discovery",techniqueId:"T1497",value:"timeBasedEvasion"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.timeProvidersT1547Description",{defaultMessage:"Time Providers (T1547.003)"}),id:"T1547.003",name:"Time Providers",reference:"https://attack.mitre.org/techniques/T1547/003",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"timeProviders"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.timestompT1070Description",{defaultMessage:"Timestomp (T1070.006)"}),id:"T1070.006",name:"Timestomp",reference:"https://attack.mitre.org/techniques/T1070/006",tactics:"defense-evasion",techniqueId:"T1070",value:"timestomp"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.tokenImpersonationTheftT1134Description",{defaultMessage:"Token Impersonation/Theft (T1134.001)"}),id:"T1134.001",name:"Token Impersonation/Theft",reference:"https://attack.mitre.org/techniques/T1134/001",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1134",value:"tokenImpersonationTheft"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.toolT1588Description",{defaultMessage:"Tool (T1588.002)"}),id:"T1588.002",name:"Tool",reference:"https://attack.mitre.org/techniques/T1588/002",tactics:"resource-development",techniqueId:"T1588",value:"tool"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.trafficDuplicationT1020Description",{defaultMessage:"Traffic Duplication (T1020.001)"}),id:"T1020.001",name:"Traffic Duplication",reference:"https://attack.mitre.org/techniques/T1020/001",tactics:"exfiltration",techniqueId:"T1020",value:"trafficDuplication"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.transmittedDataManipulationT1565Description",{defaultMessage:"Transmitted Data Manipulation (T1565.002)"}),id:"T1565.002",name:"Transmitted Data Manipulation",reference:"https://attack.mitre.org/techniques/T1565/002",tactics:"impact",techniqueId:"T1565",value:"transmittedDataManipulation"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.transportAgentT1505Description",{defaultMessage:"Transport Agent (T1505.002)"}),id:"T1505.002",name:"Transport Agent",reference:"https://attack.mitre.org/techniques/T1505/002",tactics:"persistence",techniqueId:"T1505",value:"transportAgent"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.trapT1546Description",{defaultMessage:"Trap (T1546.005)"}),id:"T1546.005",name:"Trap",reference:"https://attack.mitre.org/techniques/T1546/005",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"trap"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.unixShellT1059Description",{defaultMessage:"Unix Shell (T1059.004)"}),id:"T1059.004",name:"Unix Shell",reference:"https://attack.mitre.org/techniques/T1059/004",tactics:"execution",techniqueId:"T1059",value:"unixShell"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.unixShellConfigurationModificationT1546Description",{defaultMessage:"Unix Shell Configuration Modification (T1546.004)"}),id:"T1546.004",name:"Unix Shell Configuration Modification",reference:"https://attack.mitre.org/techniques/T1546/004",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"unixShellConfigurationModification"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.uploadMalwareT1608Description",{defaultMessage:"Upload Malware (T1608.001)"}),id:"T1608.001",name:"Upload Malware",reference:"https://attack.mitre.org/techniques/T1608/001",tactics:"resource-development",techniqueId:"T1608",value:"uploadMalware"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.uploadToolT1608Description",{defaultMessage:"Upload Tool (T1608.002)"}),id:"T1608.002",name:"Upload Tool",reference:"https://attack.mitre.org/techniques/T1608/002",tactics:"resource-development",techniqueId:"T1608",value:"uploadTool"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.userActivityBasedChecksT1497Description",{defaultMessage:"User Activity Based Checks (T1497.002)"}),id:"T1497.002",name:"User Activity Based Checks",reference:"https://attack.mitre.org/techniques/T1497/002",tactics:"defense-evasion,discovery",techniqueId:"T1497",value:"userActivityBasedChecks"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.vbaStompingT1564Description",{defaultMessage:"VBA Stomping (T1564.007)"}),id:"T1564.007",name:"VBA Stomping",reference:"https://attack.mitre.org/techniques/T1564/007",tactics:"defense-evasion",techniqueId:"T1564",value:"vbaStomping"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.vdsoHijackingT1055Description",{defaultMessage:"VDSO Hijacking (T1055.014)"}),id:"T1055.014",name:"VDSO Hijacking",reference:"https://attack.mitre.org/techniques/T1055/014",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"vdsoHijacking"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.vncT1021Description",{defaultMessage:"VNC (T1021.005)"}),id:"T1021.005",name:"VNC",reference:"https://attack.mitre.org/techniques/T1021/005",tactics:"lateral-movement",techniqueId:"T1021",value:"vnc"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.verclsidT1218Description",{defaultMessage:"Verclsid (T1218.012)"}),id:"T1218.012",name:"Verclsid",reference:"https://attack.mitre.org/techniques/T1218/012",tactics:"defense-evasion",techniqueId:"T1218",value:"verclsid"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.virtualPrivateServerT1583Description",{defaultMessage:"Virtual Private Server (T1583.003)"}),id:"T1583.003",name:"Virtual Private Server",reference:"https://attack.mitre.org/techniques/T1583/003",tactics:"resource-development",techniqueId:"T1583",value:"virtualPrivateServer"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.virtualPrivateServerT1584Description",{defaultMessage:"Virtual Private Server (T1584.003)"}),id:"T1584.003",name:"Virtual Private Server",reference:"https://attack.mitre.org/techniques/T1584/003",tactics:"resource-development",techniqueId:"T1584",value:"virtualPrivateServer"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.visualBasicT1059Description",{defaultMessage:"Visual Basic (T1059.005)"}),id:"T1059.005",name:"Visual Basic",reference:"https://attack.mitre.org/techniques/T1059/005",tactics:"execution",techniqueId:"T1059",value:"visualBasic"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.vulnerabilitiesT1588Description",{defaultMessage:"Vulnerabilities (T1588.006)"}),id:"T1588.006",name:"Vulnerabilities",reference:"https://attack.mitre.org/techniques/T1588/006",tactics:"resource-development",techniqueId:"T1588",value:"vulnerabilities"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.vulnerabilityScanningT1595Description",{defaultMessage:"Vulnerability Scanning (T1595.002)"}),id:"T1595.002",name:"Vulnerability Scanning",reference:"https://attack.mitre.org/techniques/T1595/002",tactics:"reconnaissance",techniqueId:"T1595",value:"vulnerabilityScanning"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.whoisT1596Description",{defaultMessage:"WHOIS (T1596.002)"}),id:"T1596.002",name:"WHOIS",reference:"https://attack.mitre.org/techniques/T1596/002",tactics:"reconnaissance",techniqueId:"T1596",value:"whois"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.webCookiesT1606Description",{defaultMessage:"Web Cookies (T1606.001)"}),id:"T1606.001",name:"Web Cookies",reference:"https://attack.mitre.org/techniques/T1606/001",tactics:"credential-access",techniqueId:"T1606",value:"webCookies"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.webPortalCaptureT1056Description",{defaultMessage:"Web Portal Capture (T1056.003)"}),id:"T1056.003",name:"Web Portal Capture",reference:"https://attack.mitre.org/techniques/T1056/003",tactics:"collection,credential-access",techniqueId:"T1056",value:"webPortalCapture"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.webProtocolsT1071Description",{defaultMessage:"Web Protocols (T1071.001)"}),id:"T1071.001",name:"Web Protocols",reference:"https://attack.mitre.org/techniques/T1071/001",tactics:"command-and-control",techniqueId:"T1071",value:"webProtocols"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.webServicesT1583Description",{defaultMessage:"Web Services (T1583.006)"}),id:"T1583.006",name:"Web Services",reference:"https://attack.mitre.org/techniques/T1583/006",tactics:"resource-development",techniqueId:"T1583",value:"webServices"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.webServicesT1584Description",{defaultMessage:"Web Services (T1584.006)"}),id:"T1584.006",name:"Web Services",reference:"https://attack.mitre.org/techniques/T1584/006",tactics:"resource-development",techniqueId:"T1584",value:"webServices"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.webSessionCookieT1550Description",{defaultMessage:"Web Session Cookie (T1550.004)"}),id:"T1550.004",name:"Web Session Cookie",reference:"https://attack.mitre.org/techniques/T1550/004",tactics:"defense-evasion,lateral-movement",techniqueId:"T1550",value:"webSessionCookie"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.webShellT1505Description",{defaultMessage:"Web Shell (T1505.003)"}),id:"T1505.003",name:"Web Shell",reference:"https://attack.mitre.org/techniques/T1505/003",tactics:"persistence",techniqueId:"T1505",value:"webShell"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.windowsCommandShellT1059Description",{defaultMessage:"Windows Command Shell (T1059.003)"}),id:"T1059.003",name:"Windows Command Shell",reference:"https://attack.mitre.org/techniques/T1059/003",tactics:"execution",techniqueId:"T1059",value:"windowsCommandShell"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.windowsCredentialManagerT1555Description",{defaultMessage:"Windows Credential Manager (T1555.004)"}),id:"T1555.004",name:"Windows Credential Manager",reference:"https://attack.mitre.org/techniques/T1555/004",tactics:"credential-access",techniqueId:"T1555",value:"windowsCredentialManager"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.windowsFileAndDirectoryPermissionsModificationT1222Description",{defaultMessage:"Windows File and Directory Permissions Modification (T1222.001)"}),id:"T1222.001",name:"Windows File and Directory Permissions Modification",reference:"https://attack.mitre.org/techniques/T1222/001",tactics:"defense-evasion",techniqueId:"T1222",value:"windowsFileAndDirectoryPermissionsModification"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.windowsManagementInstrumentationEventSubscriptionT1546Description",{defaultMessage:"Windows Management Instrumentation Event Subscription (T1546.003)"}),id:"T1546.003",name:"Windows Management Instrumentation Event Subscription",reference:"https://attack.mitre.org/techniques/T1546/003",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"windowsManagementInstrumentationEventSubscription"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.windowsRemoteManagementT1021Description",{defaultMessage:"Windows Remote Management (T1021.006)"}),id:"T1021.006",name:"Windows Remote Management",reference:"https://attack.mitre.org/techniques/T1021/006",tactics:"lateral-movement",techniqueId:"T1021",value:"windowsRemoteManagement"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.windowsServiceT1543Description",{defaultMessage:"Windows Service (T1543.003)"}),id:"T1543.003",name:"Windows Service",reference:"https://attack.mitre.org/techniques/T1543/003",tactics:"persistence,privilege-escalation",techniqueId:"T1543",value:"windowsService"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.winlogonHelperDllT1547Description",{defaultMessage:"Winlogon Helper DLL (T1547.004)"}),id:"T1547.004",name:"Winlogon Helper DLL",reference:"https://attack.mitre.org/techniques/T1547/004",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"winlogonHelperDll"},{label:F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.xdgAutostartEntriesT1547Description",{defaultMessage:"XDG Autostart Entries (T1547.013)"}),id:"T1547.013",name:"XDG Autostart Entries",reference:"https://attack.mitre.org/techniques/T1547/013",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"xdgAutostartEntries"}],Ow=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.filtersLabel",{defaultMessage:"Filters"}),ww=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.QueryLabel",{defaultMessage:"Custom query"}),jw=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.threatQueryLabel",{defaultMessage:"Indicator index query"}),Cw=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.savedIdLabel",{defaultMessage:"Saved query name"}),Iw=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.mlRuleTypeDescription",{defaultMessage:"Machine Learning"}),Mw=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.eqlRuleTypeDescription",{defaultMessage:"Event Correlation"}),Aw=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.queryRuleTypeDescription",{defaultMessage:"Query"}),Dw=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.thresholdRuleTypeDescription",{defaultMessage:"Threshold"}),qw=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.threatMatchRuleTypeDescription",{defaultMessage:"Indicator Match"}),Pw=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.mlJobStartedDescription",{defaultMessage:"Started"}),Rw=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.mlJobStoppedDescription",{defaultMessage:"Stopped"}),_w=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.thresholdResultsAllDescription",{defaultMessage:"All results"}),Fw=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.thresholdResultsAggregatedByDescription",{defaultMessage:"Results aggregated by"}),Lw=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.eqlEventCategoryFieldLabel",{defaultMessage:"Event category field"}),Nw=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.eqlTiebreakerFieldLabel",{defaultMessage:"Tiebreaker field"}),Bw=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.eqlTimestampFieldLabel",{defaultMessage:"Timestamp field"});var zw=a(1060),Uw=a.n(zw);const Hw=z()(N.EuiFlexItem).withConfig({displayName:"NoteDescriptionContainer",componentId:"sc-123zi2b-0"})(["height:105px;overflow-y:hidden;"]),$w=e=>!Object(E.isEmpty)(e.join("")),Vw=z()(N.EuiBadge).withConfig({displayName:"EuiBadgeWrap",componentId:"sc-123zi2b-1"})([".euiBadge__text{white-space:pre-wrap !important;}"]),Qw=z.a.div.withConfig({displayName:"Query",componentId:"sc-123zi2b-2"})(["white-space:pre-wrap;"]),Ww=({field:e,filters:t,filterManager:a,query:n,savedId:i,indexPatterns:s,queryLabel:o})=>{let l=[];return Object(E.isEmpty)(t)||(a.setFilters(t),l=[...l,{title:r.a.createElement(r.a.Fragment,null,Ow," "),description:r.a.createElement(N.EuiFlexGroup,{wrap:!0,responsive:!1,gutterSize:"xs"},a.getFilters().map(((t,a)=>r.a.createElement(N.EuiFlexItem,{grow:!1,key:`${e}-filter-${a}`},r.a.createElement(Vw,{color:"hollow"},null!=s?r.a.createElement(ZO.FilterLabel,{filter:t,valueLabel:Object(kg.getDisplayValueFromFilter)(t,[s])}):r.a.createElement(N.EuiLoadingSpinner,{size:"m"}))))))}]),Object(E.isEmpty)(n)||(l=[...l,{title:r.a.createElement(r.a.Fragment,null,null!=o?o:ww),description:r.a.createElement(Qw,null,n)}]),Object(E.isEmpty)(i)||(l=[...l,{title:r.a.createElement(r.a.Fragment,null,Cw," "),description:r.a.createElement(r.a.Fragment,null,i," ")}]),l},Gw=z()(N.EuiFlexGroup).withConfig({displayName:"ThreatEuiFlexGroup",componentId:"sc-123zi2b-3"})([".euiFlexItem{margin-bottom:0px;}"]),Kw=z()(N.EuiFlexItem).withConfig({displayName:"SubtechniqueFlexItem",componentId:"sc-123zi2b-4"})(["margin-left:",";"],(({theme:e})=>e.eui.paddingSizes.m)),Yw=z()(N.EuiButtonEmpty).withConfig({displayName:"TechniqueLinkItem",componentId:"sc-123zi2b-5"})([".euiIcon{width:8px;height:8px;}align-self:flex-start;"]),Jw=z()(N.EuiFlexItem).withConfig({displayName:"OverrideColumn",componentId:"sc-123zi2b-6"})(["width:125px;max-width:125px;overflow:hidden;text-overflow:ellipsis;"]),Xw=z()(N.EuiLink).withConfig({displayName:"MyRefUrlLink",componentId:"sc-123zi2b-7"})(["word-break:break-word;"]),Zw=z()(N.EuiText).withConfig({displayName:"FieldTypeText",componentId:"sc-123zi2b-8"})(["font-size:",";font-family:",";display:inline;"],(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.euiCodeFontFamily));var ej,tj=a(178),aj=a(493);!function(e){e.info="info",e.warning="warning",e.error="error"}(ej||(ej={}));const nj=({message:e})=>{if(!e)return null;let t="primary",a="alert";return e.level===ej.info?a="iInCircle":e.level===ej.warning?t="warning":e.level===ej.error&&(t="danger"),r.a.createElement(N.EuiToolTip,{content:e.text},r.a.createElement(N.EuiIcon,{type:a,color:t}))},ij=r.a.memo(nj),rj=({job:e})=>{const t=Object(lu.c)(e.jobState,e.datafeedState),a=t?"success":"danger",n=t?Pw:Rw;return r.a.createElement(N.EuiBadge,{"data-test-subj":"machineLearningJobStatus",color:a},n)},sj=r.a.memo(rj),oj=z()(N.EuiLink).withConfig({displayName:"JobLink",componentId:"sc-c3w1h4-0"})(["margin-right:",";"],(({theme:e})=>e.eui.euiSizeS)),lj=z.a.div.withConfig({displayName:"Wrapper",componentId:"sc-c3w1h4-1"})(["overflow:hidden;"]),cj=({jobId:e})=>{const{jobs:t}=Object(aj.a)(!1),{services:{http:a,ml:n}}=Object(d.j)(),i=Object(tj.useMlHref)(n,a.basePath.get(),{page:tj.ML_PAGES.ANOMALY_DETECTION_JOBS_MANAGE,pageState:{jobId:[e]}}),s=t.find((({id:t})=>t===e)),o=r.a.createElement("span",{"data-test-subj":"machineLearningJobId"},e);return null!=s?r.a.createElement(lj,null,r.a.createElement("div",null,r.a.createElement(oj,{href:i,target:"_blank"},o),r.a.createElement(ij,{message:s.auditMessage})),r.a.createElement(sj,{job:s})):o},uj=r.a.memo(cj),dj=({jobIds:e})=>r.a.createElement(r.a.Fragment,null,e.map((e=>r.a.createElement(uj,{key:e,jobId:e})))),pj=({actions:e})=>e.length?r.a.createElement("ul",null,e.map(((e,t)=>r.a.createElement("li",{key:t},mj(e.actionTypeId))))):null,mj=e=>{if(!e)return"";const t=e.split(".")[1];return t?Object(E.startCase)(t):""},gj=[{value:o.Lb,text:"Perform no actions"},{value:o.Mb,text:"On each rule execution"},{value:"1h",text:"Hourly"},{value:"1d",text:"Daily"},{value:"7d",text:"Weekly"}],fj=gj[0],bj=e=>{const{setValue:t}=e.field,a=Object(i.useCallback)((e=>{const a=e.target.value;t(a)}),[t]),n={...e.euiFieldProps,onChange:a};return r.a.createElement(oS.d,rr()({},e,{euiFieldProps:n}))},hj=(e=fj.value,t)=>{const a=Object(E.find)(["value",e],gj);return{title:t,description:a?a.text:e}},yj=z()(N.EuiDescriptionList).withConfig({displayName:"DescriptionListContainer",componentId:"sc-1jqwta0-0"})(["&.euiDescriptionList--column .euiDescriptionList__title{width:30%;}&.euiDescriptionList--column .euiDescriptionList__description{width:70%;overflow-wrap:anywhere;}"]),Ej=({data:e,columns:t="multi",indexPatterns:a,schema:n})=>{const s=Object(d.j)(),[o]=Object(i.useState)(new kg.FilterManager(s.services.uiSettings)),l=Object.keys(n).reduce(((t,i)=>{return"machineLearningJobId"===i?[...t,(s=Object(E.get)(i,e),l=Object(E.get)(i,n).label,{title:l,description:r.a.createElement(dj,{jobIds:s})})]:"throttle"===i?[...t,hj(Object(E.get)(i,e),Object(E.get)([i,"label"],n))]:"actions"===i?[...t,(c=Object(E.get)(i,e),u=Object(E.get)([i,"label"],n),{title:c.length?u:"",description:r.a.createElement(pj,{actions:c})})]:[...t,...Tj(e,Object(E.pick)(i,n),o,a)];var s,l,c,u}),[]);return"multi"===t?r.a.createElement(N.EuiFlexGroup,null,Object(E.chunk)(Math.ceil(l.length/2),l).map(((e,t)=>r.a.createElement(N.EuiFlexItem,{"data-test-subj":"listItemColumnStepRuleDescription",key:`description-step-rule-${t}`},r.a.createElement(N.EuiDescriptionList,{listItems:e}))))):r.a.createElement(N.EuiFlexGroup,null,r.a.createElement(N.EuiFlexItem,{"data-test-subj":"listItemColumnStepRuleDescription"},"single"===t?r.a.createElement(N.EuiDescriptionList,{listItems:l}):r.a.createElement(yj,{"data-test-subj":"singleSplitStepRuleDescriptionList",type:"column",listItems:l})))},vj=Object(i.memo)(Ej),Tj=(e,t,a,n)=>Object.keys(t).reduce(((i,r)=>[...i,...xj(r,Object(E.get)([r,"label"],t),e,a,n)]),[]),kj=e=>e.map((e=>null==e.$state?{$state:{store:oa.b.APP_STATE},...e}:e)),xj=(e,t,a,n,i)=>{if("queryBar"===e){var s;const t=kj(null!==(s=Object(E.get)("queryBar.filters",a))&&void 0!==s?s:[]),r=Object(E.get)("queryBar.query.query",a),o=Object(E.get)("queryBar.saved_id",a);return Ww({field:e,filters:t,filterManager:n,query:r,savedId:o,indexPatterns:i})}if("eqlOptions"===e)return(e=>{let t=[];return Object(E.isEmpty)(e.eventCategoryField)||(t=[...t,{title:r.a.createElement(r.a.Fragment,null,Lw),description:r.a.createElement(r.a.Fragment,null,e.eventCategoryField)}]),Object(E.isEmpty)(e.tiebreakerField)||(t=[...t,{title:r.a.createElement(r.a.Fragment,null,Nw),description:r.a.createElement(r.a.Fragment,null,e.tiebreakerField)}]),Object(E.isEmpty)(e.timestampField)||(t=[...t,{title:r.a.createElement(r.a.Fragment,null,Bw),description:r.a.createElement(r.a.Fragment,null,e.timestampField)}]),t})(Object(E.get)(e,a));if("threat"===e){const n=Object(E.get)(e,a);return(({label:e,threat:t})=>t.length>0?[{title:e,description:r.a.createElement(Gw,{direction:"column"},t.map(((e,t)=>{const a=kw.find((t=>t.id===e.tactic.id));return r.a.createElement(N.EuiFlexItem,{key:`${e.tactic.name}-${t}`},r.a.createElement(N.EuiLink,{"data-test-subj":"threatTacticLink",href:e.tactic.reference,target:"_blank"},null!=a?a.text:`${e.tactic.name} (${e.tactic.id})`),r.a.createElement(N.EuiFlexGroup,{gutterSize:"none",alignItems:"flexStart",direction:"column"},e.technique&&e.technique.map(((e,t)=>{var a;const n=xw.find((t=>t.id===e.id));return r.a.createElement(N.EuiFlexItem,{key:null!==(a=null==n?void 0:n.id)&&void 0!==a?a:t},r.a.createElement(Yw,{"data-test-subj":"threatTechniqueLink",href:e.reference,target:"_blank",iconType:Uw.a,size:"xs"},null!=n?n.label:`${e.name} (${e.id})`),r.a.createElement(N.EuiFlexGroup,{gutterSize:"none",alignItems:"flexStart",direction:"column"},null!=e.subtechnique&&e.subtechnique.map(((e,t)=>{var a;const n=Sw.find((t=>t.id===e.id));return r.a.createElement(Kw,{key:null!==(a=null==n?void 0:n.id)&&void 0!==a?a:t},r.a.createElement(Yw,{"data-test-subj":"threatSubtechniqueLink",href:e.reference,target:"_blank",iconType:Uw.a,size:"xs"},null!=n?n.label:`${e.name} (${e.id})`))}))))}))))})),r.a.createElement(N.EuiSpacer,null))}]:[])({label:t,threat:Jj(n)})}if("threshold"===e)return((e,t)=>[{title:e,description:r.a.createElement(r.a.Fragment,null,Object(E.isEmpty)(t.field[0])?`${_w} >= ${t.value}`:`${Fw} ${Array.isArray(t.field)?t.field.join(","):t.field} >= ${t.value}`)}])(t,Object(E.get)(e,a));if("references"===e)return((e,t)=>$w(t)?[{title:e,description:r.a.createElement(N.EuiText,{size:"s"},r.a.createElement("ul",null,t.filter((e=>!Object(E.isEmpty)(e))).map(((e,t)=>r.a.createElement("li",{"data-test-subj":"urlsDescriptionReferenceLinkItem",key:`${t}-${e}`},r.a.createElement(Xw,{href:e,external:!0,target:"_blank"},e))))))}]:[])(t,Object(E.get)(e,a));if("falsePositives"===e)return((e,t,a)=>$w(a)?[{title:e,description:r.a.createElement(N.EuiText,{size:"s"},r.a.createElement("ul",null,a.map((e=>Object(E.isEmpty)(e)?null:r.a.createElement("li",{"data-test-subj":"unorderedListArrayDescriptionItem",key:`${t}-${e}`},e)))))}]:[])(t,e,Object(E.get)(e,a));if("riskScore"===e){const t=Object(E.get)(e,a);return[{title:gw,description:(c=t).value},...c.isMappingChecked?c.mapping.filter((e=>""!==e.field)).map(((e,t)=>({title:0===t?yw:"",description:r.a.createElement(N.EuiFlexGroup,{alignItems:"center"},r.a.createElement(Jw,null,r.a.createElement(N.EuiToolTip,{content:e.field,"data-test-subj":`riskScoreOverrideField${t}`},r.a.createElement(r.a.Fragment,null,e.field))),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiIcon,{type:"sortRight"})),r.a.createElement(N.EuiFlexItem,null,$O.j))}))):[]]}if("severity"===e){return l=Object(E.get)(e,a),[{title:ow,description:r.a.createElement(cp.a,{value:l.value})},...l.isMappingChecked?l.mapping.filter((e=>""!==e.field)).map(((e,t)=>({title:0===t?uw:"",description:r.a.createElement(N.EuiFlexGroup,{alignItems:"center"},r.a.createElement(Jw,null,r.a.createElement(N.EuiToolTip,{content:e.field,"data-test-subj":`severityOverrideField${t}`},r.a.createElement(r.a.Fragment,null,`${e.field}:`))),r.a.createElement(Jw,null,r.a.createElement(N.EuiToolTip,{content:e.value,"data-test-subj":`severityOverrideValue${t}`},Object(vr.a)(e.value))),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiIcon,{type:"sortRight"})),r.a.createElement(N.EuiFlexItem,null,r.a.createElement(cp.a,{"data-test-subj":`severityOverrideSeverity${t}`,value:e.severity})))}))):[]]}if("requiredFields"===e)return((e,t)=>Object(E.isEmpty)(t)?[]:[{title:e,description:r.a.createElement(N.EuiFlexGrid,{gutterSize:"s"},t.map(((e,a)=>{return r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(XO.a,{"data-test-subj":"field-type-icon",type:(n=e.type,i=JO.find((function(e){return e.esTypes.includes(n)})),i&&i.name?i.name:UO.UNKNOWN),label:e.type})),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(Zw,{grow:!1,size:"s"},` ${e.name}${a+1!==t.length?", ":""}`))));var n,i})))}])(t,Object(E.get)(e,a));if("relatedIntegrations"===e)return((e,t)=>null==t||0===t.length?[]:[{title:e,description:r.a.createElement(eu,{relatedIntegrations:t})}])(t,Object(E.get)(e,a));var o,l,c;if("timeline"===e)return[{title:t,description:null!==(o=Object(E.get)(e,a).title)&&void 0!==o?o:TS.b}];if("note"===e)return((e,t)=>""!==t.trim()?[{title:e,description:r.a.createElement(Hw,null,r.a.createElement("div",{"data-test-subj":"noteDescriptionItem",className:"eui-yScrollWithShadows"},t))}]:[])(t,Object(E.get)(e,a));if("ruleType"===e)return((e,t)=>{switch(t){case"machine_learning":return[{title:e,description:Iw}];case"query":case"saved_query":return[{title:e,description:Aw}];case"threshold":return[{title:e,description:Dw}];case"eql":return[{title:e,description:Mw}];case"threat_match":return[{title:e,description:qw}];default:return Object(gt.a)(t)}})(t,Object(E.get)(e,a));if("kibanaSiemAppUrl"===e)return[];if("threatQueryBar"===e){var u;const t=kj(null!==(u=Object(E.get)("threatQueryBar.filters",a))&&void 0!==u?u:[]),r=Object(E.get)("threatQueryBar.query.query",a),s=Object(E.get)("threatQueryBar.saved_id",a);return Ww({field:e,filters:t,filterManager:n,query:r,savedId:s,indexPatterns:i,queryLabel:jw})}if("threatMapping"===e){return[{title:t,description:Object(E.get)(e,a).reduce(((e,t,a,{length:n})=>{const i=t.entries.reduce(((e,t,a,{length:n})=>1===n?`${t.field} ${nw} ${t.value}`:0===a?`(${t.field} ${nw} ${t.value})`:`${e} ${iw} (${t.field} ${nw} ${t.value})`),"");return 1===n?`${i}`:0===a?`(${i})`:`${e} ${rw} (${i})`}),"")}]}if(Array.isArray(Object(E.get)(e,a))&&"threatMapping"!==e)return((e,t,a)=>$w(a)?[{title:e,description:r.a.createElement(N.EuiFlexGroup,{responsive:!1,gutterSize:"xs",wrap:!0},a.map((e=>Object(E.isEmpty)(e)?null:r.a.createElement(N.EuiFlexItem,{grow:!1,key:`${t}-${e}`},r.a.createElement(Vw,{"data-test-subj":"stringArrayDescriptionBadgeItem",color:"hollow"},e)))))}]:[])(t,e,Object(E.get)(e,a));const d=Object(E.get)(e,a);return Object(E.isNumber)(d)||!Object(E.isEmpty)(d)?[{title:t,description:d}]:[]},Sj=z.a.div.withConfig({displayName:"StyledDiv",componentId:"sc-1adamx3-0"})(["padding-left:",";"],(({addPadding:e})=>e&&"53px"));Sj.defaultProps={addPadding:!1};const Oj=r.a.memo(Sj);Oj.displayName="StepContentWrapper";var wj=a(1061),jj=a.n(wj),Cj=a(191);const Ij=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.ruleActionsField.ruleActionsFormErrorsTitle",{defaultMessage:"Please fix issues listed below"}),Mj=z.a.div.withConfig({displayName:"FieldErrorsContainer",componentId:"sc-1brsijn-0"})(["p{margin-bottom:0;}"]),Aj=z.a.div.attrs((({className:e="",$caseIndexes:t=[]})=>({className:e}))).withConfig({displayName:"ContainerActions",componentId:"sc-1brsijn-1"})(["",""],(({$caseIndexes:e})=>e.map((e=>`\n        div[id="${e}"].euiAccordion__childWrapper .euiAccordion__padding--l {\n          padding: 0px;\n          .euiFlexGroup {\n            display: none;\n          }\n          .euiSpacer.euiSpacer--xl {\n            height: 0px;\n          }\n        }\n      `)))),Dj=({field:e,hasErrorOnCreationCaseAction:t,messageVariables:a})=>{const[n,s]=Object(i.useState)(null),[l,c]=Object(i.useState)(),u=Object(oS.l)(),{isSubmitted:p,isSubmitting:m,isValid:g}=u,{http:f,triggersActionsUi:{actionTypeRegistry:b}}=Object(d.j)().services,h=Object(i.useMemo)((()=>Object(E.isEmpty)(e.value)?[]:e.value),[e.value]),y=Object(i.useMemo)((()=>h.reduce(((e,t,a)=>".case"===t.actionTypeId?[...e,`${a}`]:e),[])),[h]),v=Object(i.useCallback)(((t,a)=>{const n=[...h];n[a]=LO()(n[a],{id:t}),e.setValue(n)}),[e.setValue,h]),T=Object(i.useCallback)((t=>e.setValue(t)),[e]),k=Object(i.useCallback)(((t,a,n)=>{const i=[...h];i[n]={...i[n],params:{...i[n].params,[t]:a}},e.setValue(i)}),[e.setValue,h]);return Object(i.useEffect)((()=>{!async function(){const e=((e,t)=>e.filter((e=>(".case"!==e.id||!t)&&o.Kb.includes(e.id))))(Object(d.c)(await Object(Cj.loadActionTypes)({http:f})),t);c(e)}()}),[t]),Object(i.useEffect)((()=>{if(m||!e.errors.length)return s(null);if(p&&!m&&!1===g&&e.errors.length){const t=e.errors.map((({message:e})=>e)).join("\n");return s(t)}}),[p,m,e.isChangingValue,g,e.errors,s]),l?r.a.createElement(Aj,{$caseIndexes:y},n?r.a.createElement(r.a.Fragment,null,r.a.createElement(Mj,null,r.a.createElement(N.EuiCallOut,{title:Ij,color:"danger",iconType:"alert"},r.a.createElement(jj.a,{source:n}))),r.a.createElement(N.EuiSpacer,null)):null,r.a.createElement(Cj.ActionForm,{actions:h,messageVariables:a,defaultActionGroupId:"default",setActionIdByIndex:v,setActions:T,setActionParamsProperty:k,actionTypeRegistry:b,actionTypes:l,defaultActionMessage:"Rule {{context.rule.name}} generated {{state.signals_count}} alerts"})):r.a.createElement(r.a.Fragment,null)};var qj=a(1141),Pj=a.n(qj);const Rj=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.completeWithoutEnablingTitle",{defaultMessage:"Create rule without enabling it"}),_j=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.completeWithEnablingTitle",{defaultMessage:"Create & enable rule"}),Fj=(F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.noConnectorSelectedErrorMessage",{defaultMessage:"No connector selected"}),F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.noReadActionsPrivileges",{defaultMessage:'Cannot create rule actions. You do not have "Read" permissions for the "Actions" plugin.'})),Lj=e=>{if(!e)return"";const t=e.split(".")[1];return t?Object(E.startCase)(t):""},Nj=e=>{const t=[];return Object.entries(e).forEach((([e,a])=>{if(Object(E.isString)(a))try{Pj.a.render(a,{})}catch(a){t.push((e=>F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.invalidMustacheTemplateErrorMessage",{defaultMessage:"{key} is not valid mustache template",values:{key:Object(E.startCase)(e)}}))(e))}})),t},Bj=async(e,t)=>{const a=await(async(e,t)=>{var a;const n=await(null===(a=t.get(e.actionTypeId))||void 0===a?void 0:a.validateParams(e.params));if(n){const e=Object.values(n.errors);if(e.length){const t=e.filter((e=>Object(E.isString)(e)||Object(E.isArray)(e))),a=Object(E.uniq)(Object(E.flattenDeep)(t));if(a.length)return a}}return[]})(e,t);return[...a,...Nj(e.params)]},zj=e=>async(...t)=>{const[{value:a,path:n}]=t,i=[];for(const t of a){const a=await Bj(t,e);if(a.length){const e=Lj(t.actionTypeId),n=a.map((e=>`*   ${e}\n`));i.push(`\n**${e}:**\n${n.join("")}`)}}if(i.length)return{code:"ERR_FIELD_FORMAT",path:n,message:`${i.join("\n")}`}},Uj="Cases",Hj={enabled:!0,actions:[],kibanaSiemAppUrl:"",throttle:fj.value},$j=()=>r.a.createElement(r.a.Fragment,null),Vj=({addPadding:e=!1,defaultValues:t,isReadOnlyView:a,isLoading:n,isUpdateView:s=!1,onSubmit:l,setForm:c,actionMessageParams:u})=>{const[p,m]=(()=>{const e=Object(i.useRef)(!0),[t,a]=Object(i.useState)(!0),[n,r]=Object(i.useState)(!1);return Object(i.useEffect)((()=>{const t=new AbortController;return e.current&&(e.current=!1,(async()=>{try{Object(d.c)(await d.b.get().http.fetch(Object(ex.getAllConnectorsUrl)(),{method:"GET",signal:t.signal})).some((e=>".case"===e.connectorTypeId&&e.name===Uj))||await d.b.get().http.post(Object(ex.getCreateConnectorUrl)(),{method:"POST",body:JSON.stringify({connector_type_id:".case",config:{},name:Uj,secrets:{}}),signal:t.signal}),a(!1)}catch{a(!1),r(!0)}})()),()=>{t.abort()}}),[]),[t,n]})(),{services:{application:g,triggersActionsUi:{actionTypeRegistry:f}}}=Object(d.j)(),b=Object(i.useMemo)((()=>g.getUrlForApp(`${o.y}`,{absolute:!0})),[g]),h={...null!=t?t:Hj,kibanaSiemAppUrl:b},y=Object(i.useMemo)((()=>(({actionTypeRegistry:e})=>({actions:{validations:[{validator:zj(e)}]},enabled:{},kibanaSiemAppUrl:{},throttle:{label:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.fieldThrottleLabel",{defaultMessage:"Actions frequency"}),helpText:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.fieldThrottleHelpText",{defaultMessage:"Select when automated actions should be performed if a rule evaluates as true."})}}))({actionTypeRegistry:f})),[f]),{form:v}=Object(oS.k)({defaultValue:h,options:{stripEmptyFields:!1},schema:y}),{getFields:T,getFormData:k,submit:x}=v,[{throttle:S}]=Object(oS.m)({form:v,watch:["throttle"]}),O=S||h.throttle,w=Object(i.useCallback)((e=>{T().enabled.setValue(e),l&&l()}),[T,l]),j=Object(i.useCallback)((async()=>{const e=await x();return null!=e&&e.isValid?e:{isValid:!1,data:k()}}),[k,x]);Object(i.useEffect)((()=>{let e=!1;return c&&!e&&c(HO.a.ruleActions,j),()=>{e=!0}}),[j,c]);const C=Object(i.useMemo)((()=>(e=>e&&Object(E.findIndex)(["value",e],gj)<0?[...gj,{value:e,text:e}]:gj)(O)),[O]),I=Object(i.useMemo)((()=>({idAria:"detectionEngineStepRuleActionsThrottle",isDisabled:n,isLoading:p,dataTestSubj:"detectionEngineStepRuleActionsThrottle",hasNoInitialSelection:!1,euiFieldProps:{options:C}})),[n,p,C]),M=Object(i.useMemo)((()=>O!==Hj.throttle?r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiSpacer,null),r.a.createElement(oS.e,{path:"actions",component:Dj,componentProps:{messageVariables:u,hasErrorOnCreationCaseAction:m}})):r.a.createElement(oS.e,{path:"actions",component:$j})),[O,u,m]),A=Object(i.useMemo)((()=>g.capabilities.actions.show?r.a.createElement(r.a.Fragment,null,r.a.createElement(oS.e,{path:"throttle",component:bj,componentProps:I}),M,r.a.createElement(oS.e,{path:"kibanaSiemAppUrl",component:$j}),r.a.createElement(oS.e,{path:"enabled",component:$j})):r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiText,null,Fj),r.a.createElement(oS.e,{path:"throttle",componentProps:I,component:$j}),r.a.createElement(oS.e,{path:"actions",component:$j}),r.a.createElement(oS.e,{path:"kibanaSiemAppUrl",component:$j}),r.a.createElement(oS.e,{path:"enabled",component:$j}))),[g.capabilities.actions.show,M,I]);return a?r.a.createElement(Oj,{addPadding:e},r.a.createElement(vj,{schema:y,data:h,columns:"single"})):r.a.createElement(r.a.Fragment,null,r.a.createElement(Oj,{addPadding:!s},r.a.createElement(oS.c,{form:v,"data-test-subj":"stepRuleActions"},r.a.createElement(N.EuiForm,null,A))),!s&&r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiHorizontalRule,{margin:"m"}),r.a.createElement(N.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd",gutterSize:"xs",responsive:!1},r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiButton,{fill:!1,isDisabled:n,isLoading:n,onClick:()=>w(!1)},Rj)),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiButton,{fill:!0,isDisabled:n,isLoading:n,onClick:()=>w(!0),"data-test-subj":"create-enable"},_j)))))},Qj=Object(i.memo)(Vj),Wj=e=>{const t={unit:"",value:0},a=e.match(/\d+/g),n=e.match(/[a-zA-Z]+/g);return Object(E.isEmpty)(a)||null==a||isNaN(Number(a[0]))||(t.value=Number(a[0])),!Object(E.isEmpty)(n)&&null!=n&&["s","m","h"].includes(n[0])&&(t.unit=n[0]),t},Gj=e=>!(null==e||!e.isValid||!e.data),Kj=(e,t)=>{switch(t){case"machine_learning":const{index:t,queryBar:a,threshold:n,threatIndex:i,threatQueryBar:r,threatMapping:s,eqlOptions:o,...l}=e;return l;case"threshold":const{anomalyThreshold:c,machineLearningJobId:u,threatIndex:d,threatQueryBar:p,threatMapping:m,eqlOptions:g,...f}=e;return f;case"threat_match":const{anomalyThreshold:b,machineLearningJobId:h,threshold:y,eqlOptions:E,...v}=e;return v;case"query":case"saved_query":const{anomalyThreshold:T,machineLearningJobId:k,threshold:x,threatIndex:S,threatQueryBar:O,threatMapping:w,eqlOptions:j,...C}=e;return C;case"eql":const{anomalyThreshold:I,machineLearningJobId:M,threshold:A,threatIndex:D,threatQueryBar:q,threatMapping:P,...R}=e;return R}Object(gt.a)(t)};function Yj(e){return e.filter((e=>"none"!==e.name))}const Jj=e=>e.filter((e=>"none"!==e.tactic.name)).map((e=>{var t;return{...e,technique:Yj(null!==(t=e.technique)&&void 0!==t?t:[]).map((e=>({...e,subtechnique:null!=e.subtechnique?Yj(e.subtechnique):[]})))}})),Xj=e=>{var t,a,n,i,r,s,o,l,c,u,d,p,m,g,f,b,h,y,v,T,k,x,S,O,w,j,C,I,M,A,D,q,P,R,_,F,L,N,B,z,U,H,$;const V=Kj(e,e.ruleType),{ruleType:Q,timeline:W}=V;var G;return{...{type:Q,...null!=W.id&&null!=W.title&&{timeline_id:W.id,timeline_title:W.title}},...(G=V,Object(E.has)("anomalyThreshold",G)?{anomaly_threshold:V.anomalyThreshold,machine_learning_job_id:V.machineLearningJobId}:(e=>Object(E.has)("threshold",e))(V)?{index:V.index,filters:null===(t=V.queryBar)||void 0===t?void 0:t.filters,language:null===(a=V.queryBar)||void 0===a||null===(n=a.query)||void 0===n?void 0:n.language,query:null===(i=V.queryBar)||void 0===i||null===(r=i.query)||void 0===r?void 0:r.query,saved_id:null!==(s=null===(o=V.queryBar)||void 0===o?void 0:o.saved_id)&&void 0!==s?s:void 0,..."threshold"===Q&&{threshold:{field:null!==(l=null===(c=V.threshold)||void 0===c?void 0:c.field)&&void 0!==l?l:[],value:null!==(u=parseInt(null===(d=V.threshold)||void 0===d?void 0:d.value,10))&&void 0!==u?u:0,cardinality:Object(E.isEmpty)(null===(p=V.threshold.cardinality)||void 0===p?void 0:p.field)||null==(null===(m=V.threshold.cardinality)||void 0===m?void 0:m.value)?[]:[{field:V.threshold.cardinality.field[0],value:parseInt(V.threshold.cardinality.value,10)}]}}}:(e=>Object(E.has)("threatIndex",e))(V)?{index:V.index,filters:null===(g=V.queryBar)||void 0===g?void 0:g.filters,language:null===(f=V.queryBar)||void 0===f||null===(b=f.query)||void 0===b?void 0:b.language,query:null===(h=V.queryBar)||void 0===h||null===(y=h.query)||void 0===y?void 0:y.query,saved_id:null!==(v=null===(T=V.queryBar)||void 0===T?void 0:T.saved_id)&&void 0!==v?v:void 0,threat_index:V.threatIndex,threat_query:null===(k=V.threatQueryBar)||void 0===k||null===(x=k.query)||void 0===x?void 0:x.query,threat_filters:null===(S=V.threatQueryBar)||void 0===S?void 0:S.filters,threat_mapping:V.threatMapping,threat_language:null===(O=V.threatQueryBar)||void 0===O||null===(w=O.query)||void 0===w?void 0:w.language}:(e=>Object(E.has)("eqlOptions",e))(V)?{index:V.index,filters:null===(j=V.queryBar)||void 0===j?void 0:j.filters,language:null===(C=V.queryBar)||void 0===C||null===(I=C.query)||void 0===I?void 0:I.language,query:null===(M=V.queryBar)||void 0===M||null===(A=M.query)||void 0===A?void 0:A.query,saved_id:null!==(D=null===(q=V.queryBar)||void 0===q?void 0:q.saved_id)&&void 0!==D?D:void 0,timestamp_field:null===(P=V.eqlOptions)||void 0===P?void 0:P.timestampField,event_category_override:null===(R=V.eqlOptions)||void 0===R?void 0:R.eventCategoryField,tiebreaker_field:null===(_=V.eqlOptions)||void 0===_?void 0:_.tiebreakerField}:{index:V.index,filters:null===(F=V.queryBar)||void 0===F?void 0:F.filters,language:null===(L=V.queryBar)||void 0===L||null===(N=L.query)||void 0===N?void 0:N.language,query:null===(B=V.queryBar)||void 0===B||null===(z=B.query)||void 0===z?void 0:z.query,saved_id:null!==(U=null===(H=V.queryBar)||void 0===H?void 0:H.saved_id)&&void 0!==U?U:void 0,..."query"===Q&&(null===($=V.queryBar)||void 0===$?void 0:$.saved_id)&&{type:"saved_query"}})}},Zj=e=>{const{...t}=e;if(!Object(E.isEmpty)(t.interval)&&!Object(E.isEmpty)(t.from)){const{unit:e,value:a}=Wj(t.interval),{unit:n,value:i}=Wj(t.from),r=Fn.a.duration(a,e);r.add(i,n),t.from=`now-${r.asSeconds()}s`,t.to="now"}return{...t,meta:{from:e.from}}},eC=(e,t)=>{const{author:a,falsePositives:n,references:i,riskScore:r,severity:s,threat:o,isAssociatedToEndpointList:l,isBuildingBlock:c,note:u,ruleNameOverride:d,threatIndicatorPath:p,timestampOverride:m,...g}=e,f=null!=t?t.filter((e=>"endpoint"!==e.type)):[];return{author:a.filter((e=>!Object(E.isEmpty)(e))),...c?{building_block_type:"default"}:{},...l?{exceptions_list:[{id:Bn.j,list_id:Bn.j,namespace_type:"agnostic",type:"endpoint"},...f]}:null!=t?{exceptions_list:[...f]}:{},false_positives:n.filter((e=>!Object(E.isEmpty)(e))),references:i.filter((e=>!Object(E.isEmpty)(e))),risk_score:r.value,risk_score_mapping:r.isMappingChecked?r.mapping.filter((e=>null!=e.field&&""!==e.field)):[],rule_name_override:""!==d?d:void 0,severity:s.value,severity_mapping:s.isMappingChecked?s.mapping.filter((e=>null!=e.field&&""!==e.field&&null!=e.value)):[],threat:Jj(o).map((e=>({...e,framework:"MITRE ATT&CK"}))),threat_indicator_path:p,timestamp_override:""!==m?m:void 0,...Object(E.isEmpty)(u)?{}:{note:u},...g}},tC=e=>{const{actions:t=[],enabled:a,kibanaSiemAppUrl:n,throttle:i=o.Lb}=e;return{actions:t.map(Hn),enabled:a,throttle:t.length?i:o.Lb,meta:{kibana_siem_app_url:n}}},aC=(e,t,a,n,i)=>LO.a.all([Xj(e),eC(t,null==i?void 0:i.exceptions_list),Zj(a),tC(n)]);var nC=a(707),iC=a(479),rC=a(575),sC=a(480);const oC=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.importTimelineModalTitle",{defaultMessage:"Import query from saved timeline"}),lC=["duplicate","createFrom"],cC=z()(N.EuiFormRow).withConfig({displayName:"StyledEuiFormRow",componentId:"sc-8c6vgp-0"})([""]),uC=({browserFields:e,dataTestSubj:t,field:a,idAria:n,indexPattern:s,isLoading:o=!1,onCloseTimelineSearch:l,openTimelineSearch:c=!1,resizeParentContainer:u,onValidityChange:p})=>{const{value:m,setValue:g}=a,[f,b]=Object(i.useState)(-1),[h,y]=Object(i.useState)(!1),[E,v]=Object(i.useState)(void 0),{isInvalid:T,errorMessage:k}=Object(oS.i)(a),{uiSettings:x}=Object(d.j)().services,[S]=Object(i.useState)(new kg.FilterManager(x)),O=Object(sC.a)();Object(i.useEffect)((()=>{null!=p&&p(!T)}),[T,p]),Object(i.useEffect)((()=>{let e=!0;const t=new Xi.Subscription;return S.setFilters([]),t.add(S.getUpdates$().subscribe({next:()=>{if(e){const e=S.getFilters(),{filters:t}=m;Li()(t,e)||g({...m,filters:e})}}})),()=>{e=!1,t.unsubscribe()}}),[m,S,g]),Object(i.useEffect)((()=>{let e=!0;return async function(){const{filters:t,saved_id:a}=m;if(Li()(t,S.getFilters())||S.setFilters(t),null!=a&&null!=E&&a!==E.id||null!=a&&null==E)try{const t=await O.getSavedQuery(a);e&&null!=t&&v(t)}catch{v(void 0)}else null==a&&null!=E&&v(void 0)}(),()=>{e=!1}}),[m,S,E,O]);const w=Object(i.useCallback)((e=>{const{query:t}=m;Li()(t,e)||g({...m,query:e})}),[m,g]),j=Object(i.useCallback)((e=>{const{query:t}=m;Li()(t,e)||g({...m,query:e})}),[m,g]),C=Object(i.useCallback)((e=>{if(null!=e){const{saved_id:a}=m;var t;e.id!==a?(v(e),g({filters:null!==(t=e.attributes.filters)&&void 0!==t?t:[],query:e.attributes.query,saved_id:e.id})):(v(e),g({filters:[],query:{query:"",language:"kuery"},saved_id:null}))}}),[m,g]),I=Object(i.useCallback)((()=>{y(!0),l()}),[l]),M=Object(i.useCallback)((t=>{var a,n,i,r,o,l,c;y(!1);const u={query:null!==(a=null===(n=t.kqlQuery.filterQuery)||void 0===n||null===(i=n.kuery)||void 0===i?void 0:i.expression)&&void 0!==a?a:"",language:null!==(r=null===(o=t.kqlQuery.filterQuery)||void 0===o||null===(l=o.kuery)||void 0===l?void 0:l.kind)&&void 0!==r?r:"kuery"},d=null!=t.dataProviders&&t.dataProviders.length>0?Object(hs.a)(Object(oe.g)(t.dataProviders,e),s):"",p=null!==(c=t.filters)&&void 0!==c?c:[];g({filters:""!==d?[...p,Object(rC.b)(d)]:p,query:u,saved_id:null})}),[e,s,g]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(cC,{label:a.label,labelAppend:a.labelAppend,helpText:a.helpText,error:k,isInvalid:T,fullWidth:!0,"data-test-subj":t,describedByIds:n?[n]:void 0},r.a.createElement(N.EuiMutationObserver,{observerOptions:{subtree:!0,attributes:!0,childList:!0},onMutation:()=>{if(null!=u){const e=document.getElementById("kbnTypeahead__items");if(null!=e){const t=e.getBoundingClientRect(),a=document.getElementById("define-rule");if(null!=a){const e=a.getBoundingClientRect();(-1===f||e.height<f+t.height)&&u(f+t.height-100),-1===f&&b(e.height)}}else u(-1)}}},(e=>r.a.createElement("div",{ref:e},r.a.createElement(iC.a,{indexPattern:s,isLoading:o||h,isRefreshPaused:!1,filterQuery:m.query,filterManager:S,filters:S.getFilters()||[],onChangedQuery:j,onSubmitQuery:w,savedQuery:E,onSavedQuery:C,hideSavedQuery:!1,displayStyle:"inPage"}))))),c?r.a.createElement(nC.a,{hideActions:lC,modalTitle:oC,onClose:I,onOpen:M}):null)},dC=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.eqlTypeTitle",{defaultMessage:"Event Correlation"}),pC=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.eqlTypeDescription",{defaultMessage:"Use Event Query Language (EQL) to match events, generate sequences, and stack data"}),mC=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.queryTypeTitle",{defaultMessage:"Custom query"}),gC=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.queryTypeDescription",{defaultMessage:"Use KQL or Lucene to detect issues across indices."}),fC=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.mlTypeTitle",{defaultMessage:"Machine Learning"}),bC=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.mlTypeDescription",{defaultMessage:"Select ML job to detect anomalous activity."}),hC=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.thresholdTypeTitle",{defaultMessage:"Threshold"}),yC=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.thresholdTypeDescription",{defaultMessage:"Aggregate query results to detect when number of matches exceeds threshold."}),EC=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.threatMatchTitle",{defaultMessage:"Indicator Match"}),vC=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.threatMatchDescription",{defaultMessage:"Use indicators from intelligence sources to detect matching events and alerts."}),TC=z.a.span.withConfig({displayName:"SmallText",componentId:"sc-lss4m0-0"})(["font-size:",";"],(({theme:e})=>e.eui.euiFontSizeS)),kC=({subscriptionUrl:e,hasValidLicense:t=!1})=>r.a.createElement(TC,null,t?bC:r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.mlTypeDisabledDescription",defaultMessage:"Access to ML requires a {subscriptionsLink}.",values:{subscriptionsLink:r.a.createElement(N.EuiLink,{href:e,target:"_blank"},r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.components.stepDefineRule.ruleTypeField.subscriptionsLink",defaultMessage:"Platinum subscription"}))}}));kC.displayName="MlCardDescriptionComponent";const xC=r.a.memo(kC);xC.displayName="MlCardDescription";const SC=({describedByIds:e=[],field:t,isUpdateView:a,hasValidLicense:n,isMlAdmin:s})=>{const o=t.value,l=Object(i.useCallback)((e=>{t.setValue(e)}),[t]),c=Object(i.useCallback)((()=>l("eql")),[l]),u=Object(i.useCallback)((()=>l("machine_learning")),[l]),p=Object(i.useCallback)((()=>l("query")),[l]),m=Object(i.useCallback)((()=>l("threshold")),[l]),g=Object(i.useCallback)((()=>l("threat_match")),[l]),f=Object(d.j)().services.application.getUrlForApp("kibana",{path:"#/management/stack/license_management"}),b=Object(i.useMemo)((()=>({onClick:c,isSelected:Object(zn.b)(o)})),[o,c]),h=Object(i.useMemo)((()=>({onClick:p,isSelected:Object(zn.c)(o)})),[o,p]),y=Object(i.useMemo)((()=>({isDisabled:!n||!s,onClick:u,isSelected:Object(lu.d)(o)})),[o,u,n,s]),E=Object(i.useMemo)((()=>({onClick:m,isSelected:Object(zn.e)(o)})),[o,m]),v=Object(i.useMemo)((()=>({onClick:g,isSelected:Object(zn.d)(o)})),[o,g]);return r.a.createElement(N.EuiFormRow,{fullWidth:!0,"data-test-subj":"selectRuleType",describedByIds:e,label:t.label},r.a.createElement(N.EuiFlexGrid,{columns:3},(!a||h.isSelected)&&r.a.createElement(N.EuiFlexItem,null,r.a.createElement(N.EuiCard,{"data-test-subj":"customRuleType",title:mC,titleSize:"xs",description:gC,icon:r.a.createElement(N.EuiIcon,{size:"xl",type:"search"}),selectable:h,layout:"horizontal"})),(!a||y.isSelected)&&r.a.createElement(N.EuiFlexItem,null,r.a.createElement(N.EuiCard,{"data-test-subj":"machineLearningRuleType",title:fC,titleSize:"xs",description:r.a.createElement(xC,{subscriptionUrl:f,hasValidLicense:n}),icon:r.a.createElement(N.EuiIcon,{size:"l",type:"machineLearningApp"}),isDisabled:y.isDisabled&&!y.isSelected,selectable:y,layout:"horizontal"})),(!a||E.isSelected)&&r.a.createElement(N.EuiFlexItem,null,r.a.createElement(N.EuiCard,{"data-test-subj":"thresholdRuleType",title:hC,titleSize:"xs",description:yC,icon:r.a.createElement(N.EuiIcon,{size:"l",type:"indexFlush"}),selectable:E,layout:"horizontal"})),(!a||b.isSelected)&&r.a.createElement(N.EuiFlexItem,null,r.a.createElement(N.EuiCard,{"data-test-subj":"eqlRuleType",title:dC,titleSize:"xs",description:pC,icon:r.a.createElement(N.EuiIcon,{size:"l",type:"eql"}),selectable:b,layout:"horizontal"})),(!a||v.isSelected)&&r.a.createElement(N.EuiFlexItem,null,r.a.createElement(N.EuiCard,{"data-test-subj":"threatMatchRuleType",title:EC,titleSize:"xs",description:vC,icon:r.a.createElement(N.EuiIcon,{size:"l",type:"list"}),selectable:v,layout:"horizontal"}))))},OC=({describedByIds:e=[],field:t})=>{const a=t.value,n=Object(i.useCallback)((e=>{const a=Number(e.target.value);t.setValue(a)}),[t]);return r.a.createElement(N.EuiFormRow,{label:t.label,"data-test-subj":"anomalyThresholdSlider",describedByIds:e},r.a.createElement(N.EuiFlexGroup,null,r.a.createElement(N.EuiFlexItem,null,r.a.createElement(N.EuiRange,{value:a,onChange:n,fullWidth:!0,showInput:!0,showRange:!0,showTicks:!0,tickInterval:25}))))},wC=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customQueryFieldRequiredError",{defaultMessage:"A custom query is required."}),jC=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.eqlQueryFieldRequiredError",{defaultMessage:"An EQL query is required."}),CC=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customQueryFieldInvalidError",{defaultMessage:"The KQL is invalid"}),IC=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.indicesHelperDescription",{defaultMessage:"Enter the pattern of Elasticsearch indices where you would like this rule to run. By default, these will include index patterns defined in Security Solution advanced settings."}),MC=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.resetDefaultIndicesButton",{defaultMessage:"Reset to default index patterns"}),AC=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.importTimelineQueryButton",{defaultMessage:"Import query from saved timeline"}),DC=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.mlJobSelectPlaceholderText",{defaultMessage:"Select a job"}),qC=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldQuerBarLabel",{defaultMessage:"Custom query"}),PC=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.EqlQueryBarLabel",{defaultMessage:"EQL query"}),RC=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.threatMatchingIcesHelperDescription",{defaultMessage:"Select threat indices"}),_C=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customThreatQueryFieldRequiredError",{defaultMessage:"At least one indicator match is required."}),FC=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customThreatQueryFieldRequiredEmptyError",{defaultMessage:"All matches require both a field and threat index field."}),LC=z.a.div.withConfig({displayName:"HelpTextWarningContainer",componentId:"sc-v7btd6-0"})(["margin-top:10px;"]),NC=({href:e,notRunningJobIds:t})=>r.a.createElement(r.a.Fragment,null,r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.createRule.stepDefineRule.machineLearningJobIdHelpText",defaultMessage:"We've provided a few common jobs to get you started. To add your own custom jobs, assign a group of 'security' to those jobs in the {machineLearning} application to make them appear here.",values:{machineLearning:r.a.createElement(N.EuiLink,{href:e,target:"_blank"},r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.components.mlJobSelect.machineLearningLink",defaultMessage:"Machine Learning"}))}}),t.length>0&&r.a.createElement(LC,{"data-test-subj":"ml-warning-not-running-jobs"},r.a.createElement(N.EuiText,{size:"xs",color:"warning"},r.a.createElement(N.EuiIcon,{type:"alert"}),r.a.createElement("span",null,1===t.length?r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.createRule.stepDefineRule.mlEnableJobSingle",defaultMessage:"The selected ML job, {jobName}, is not currently running. Please set {jobName} to run via 'ML job settings' before enabling this rule.",values:{jobName:t[0]}}):r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.createRule.stepDefineRule.mlEnableJobMulti",defaultMessage:"The selected ML jobs, {jobNames}, are not currently running. Please set all of these jobs to run via 'ML job settings' before enabling this rule.",values:{jobNames:t.reduce(((e,t,a,n)=>e+(a<n.length-1?", ":", and ")+t))}}))))),BC=r.a.memo(NC),zC=z.a.div.withConfig({displayName:"JobDisplayContainer",componentId:"sc-1kiq2lp-0"})(["width:100%;height:100%;display:flex;flex-direction:column;"]),UC=z()(N.EuiFlexGroup).withConfig({displayName:"MlJobSelectEuiFlexGroup",componentId:"sc-1kiq2lp-1"})(["margin-bottom:5px;"]),HC=({id:e,description:t})=>r.a.createElement(zC,null,r.a.createElement("strong",null,e),r.a.createElement(N.EuiToolTip,{content:t},r.a.createElement(N.EuiText,{size:"xs",color:"subdued"},r.a.createElement("p",null,t)))),$C=e=>r.a.createElement(HC,{id:e.value.id,description:e.value.description}),VC=({describedByIds:e=[],field:t})=>{const a=t.value,{isInvalid:n,errorMessage:s}=Object(oS.i)(t),{loading:o,jobs:l}=Object(aj.a)(!1),c=Object(d.j)().services.application.getUrlForApp("ml"),u=Object(i.useCallback)((e=>{const a=e.map((e=>e.value.id));t.setValue(a)}),[t]),p=l.map((e=>({value:{id:e.id,description:e.description},label:e.id}))),m=p.filter((e=>a.includes(e.value.id))),g=Object(i.useMemo)((()=>l.filter((({id:e})=>a.includes(e))).reduce(((e,t)=>(Object(lu.c)(t.jobState,t.datafeedState)||e.push(t.id),e)),[])),[l,a]);return r.a.createElement(UC,null,r.a.createElement(N.EuiFlexItem,null,r.a.createElement(N.EuiFormRow,{label:t.label,helpText:r.a.createElement(BC,{href:c,notRunningJobIds:g}),isInvalid:n,error:s,"data-test-subj":"mlJobSelect",describedByIds:e},r.a.createElement(N.EuiFlexGroup,null,r.a.createElement(N.EuiFlexItem,null,r.a.createElement(N.EuiComboBox,{isLoading:o,onChange:u,options:p,placeholder:DC,renderOption:$C,rowHeight:50,selectedOptions:m}))))))},QC=r.a.memo((({onClick:e,isDisabled:t,dataTestSubj:a="nextStep-continue"})=>r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiHorizontalRule,{margin:"m"}),r.a.createElement(N.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd",gutterSize:"xs",responsive:!1},r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiButton,{fill:!0,onClick:e,isDisabled:t,"data-test-subj":a},nn.ib))))));QC.displayName="NextStep";var WC=a(716);const GC=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.thresholdField.thresholdFieldPlaceholderText",{defaultMessage:"All results"}),KC=z()(N.EuiFlexItem).withConfig({displayName:"OperatorWrapper",componentId:"sc-10hzoxx-0"})(["align-self:center;"]),YC=["detectionEngineStepDefineRuleThresholdField"],JC=["detectionEngineStepDefineRuleThresholdValue"],XC=["detectionEngineStepDefineRuleThresholdCardinalityField"],ZC=["detectionEngineStepDefineRuleThresholdCardinalityValue"],eI=({thresholdField:e,thresholdValue:t,browserFields:a,thresholdCardinalityField:n,thresholdCardinalityValue:s})=>{const o=Object(i.useMemo)((()=>({fullWidth:!0,noSuggestions:!1,options:Object(WC.a)(a),placeholder:GC,onCreateOption:void 0,style:{width:"410px"}})),[a]),l=Object(i.useMemo)((()=>({fullWidth:!0,noSuggestions:!1,options:Object(WC.a)(a),placeholder:GC,onCreateOption:void 0,style:{width:"410px"},singleSelection:{asPlainText:!0}})),[a]);return r.a.createElement(N.EuiFlexGroup,{direction:"column",style:{marginLeft:0}},r.a.createElement(N.EuiFlexGroup,null,r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(oS.b,{field:e,idAria:YC[0],"data-test-subj":YC[0],describedByIds:YC,type:e.type,euiFieldProps:o})),r.a.createElement(KC,{grow:!1},">="),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(oS.b,{field:t,idAria:JC[0],"data-test-subj":JC[0],describedByIds:JC,type:t.type}))),r.a.createElement(N.EuiFlexGroup,null,r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(oS.b,{field:n,idAria:XC[0],"data-test-subj":XC[0],describedByIds:XC,type:n.type,euiFieldProps:l})),r.a.createElement(KC,{grow:!1},">="),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(oS.b,{field:s,idAria:ZC[0],"data-test-subj":ZC[0],describedByIds:ZC,type:s.type}))))},tI=r.a.memo(eI);var aI=a(212);const nI=()=>Object(aI.d)({field:"",type:"mapping",value:""});var iI=a(427);const rI={index:{fieldsToValidateOnChange:["index","queryBar"],type:oS.a.COMBO_BOX,label:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fiedIndexPatternsLabel",{defaultMessage:"Index patterns"}),helpText:r.a.createElement(N.EuiText,{size:"xs"},IC),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(!Object(lu.d)(t.ruleType))return oS.h.emptyField(F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.outputIndiceNameFieldRequiredError",{defaultMessage:"A minimum of one index pattern is required."}))(...e)}}]},eqlOptions:{},queryBar:{validations:[{validator:(...e)=>{const[{value:t,path:a,formData:n}]=e,{query:i,filters:r}=t;if(!Object(lu.d)(n.ruleType)&&Object(fn.isEmpty)(i.query)&&Object(fn.isEmpty)(r))return{code:"ERR_FIELD_MISSING",path:a,message:Object(zn.b)(n.ruleType)?jC:wC}}},{validator:(...e)=>{const[{value:t,path:a,formData:n}]=e,{query:i}=t;if(!Object(lu.d)(n.ruleType)&&!Object(fn.isEmpty)(i.query)&&"kuery"===i.language)try{Object(oa.e)(i.query)}catch(e){return{code:"ERR_FIELD_FORMAT",path:a,message:CC}}}},{validator:Object(iI.a)(iI.b,300)}]},ruleType:{label:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldRuleTypeLabel",{defaultMessage:"Rule type"}),validations:[]},anomalyThreshold:{label:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldAnomalyThresholdLabel",{defaultMessage:"Anomaly score threshold"}),validations:[]},machineLearningJobId:{label:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldMachineLearningJobIdLabel",{defaultMessage:"Machine Learning job"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(lu.d)(t.ruleType))return oS.h.emptyField(F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.machineLearningJobIdRequired",{defaultMessage:"A Machine Learning job is required."}))(...e)}}]},relatedIntegrations:{label:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRelatedIntegrationsLabel",{defaultMessage:"Related integrations"}),helpText:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRelatedIntegrationsHelpText",{defaultMessage:"Integration related to this Rule."})},requiredFields:{label:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRequiredFieldsLabel",{defaultMessage:"Required fields"}),helpText:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRequiredFieldsHelpText",{defaultMessage:"Fields required for this Rule to function."})},timeline:{label:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimelineTemplateLabel",{defaultMessage:"Timeline template"}),helpText:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimelineTemplateHelpText",{defaultMessage:"Select which timeline to use when investigating generated alerts."})},threshold:{label:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThresholdLabel",{defaultMessage:"Threshold"}),field:{type:oS.a.COMBO_BOX,label:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThresholdFieldLabel",{defaultMessage:"Group by"}),helpText:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThresholdFieldHelpText",{defaultMessage:"Select fields to group by. Fields are joined together with 'AND'"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(zn.e)(t.ruleType))return oS.h.maxLengthField({length:3,message:F.i18n.translate("xpack.securitySolution.detectionEngine.validations.thresholdFieldFieldData.arrayLengthGreaterThanMaxErrorMessage",{defaultMessage:"Number of fields must be 3 or less."})})(...e)}}]},value:{type:oS.a.NUMBER,label:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThresholdValueLabel",{defaultMessage:"Threshold"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(zn.e)(t.ruleType))return oS.h.numberGreaterThanField({than:1,message:F.i18n.translate("xpack.securitySolution.detectionEngine.validations.thresholdValueFieldData.numberGreaterThanOrEqualOneErrorMessage",{defaultMessage:"Value must be greater than or equal to one."}),allowEquality:!0})(...e)}}]},cardinality:{field:{defaultValue:[],fieldsToValidateOnChange:["threshold.cardinality.field","threshold.cardinality.value"],type:oS.a.COMBO_BOX,label:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThresholdCardinalityFieldLabel",{defaultMessage:"Count"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(zn.e)(t.ruleType))return Object(fn.isEmpty)(t["threshold.cardinality.field"])&&!Object(fn.isEmpty)(t["threshold.cardinality.value"])?oS.h.emptyField(F.i18n.translate("xpack.securitySolution.detectionEngine.validations.thresholdCardinalityFieldFieldData.thresholdCardinalityFieldNotSuppliedMessage",{defaultMessage:"A Cardinality Field is required."}))(...e):void 0}}],helpText:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThresholdFieldCardinalityFieldHelpText",{defaultMessage:"Select a field to check cardinality"})},value:{fieldsToValidateOnChange:["threshold.cardinality.field","threshold.cardinality.value"],type:oS.a.NUMBER,label:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThresholdCardinalityValueFieldLabel",{defaultMessage:"Unique values"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(zn.e)(t.ruleType))return Object(fn.isEmpty)(t["threshold.cardinality.field"])?void 0:oS.h.numberGreaterThanField({than:1,message:F.i18n.translate("xpack.securitySolution.detectionEngine.validations.thresholdCardinalityValueFieldData.numberGreaterThanOrEqualOneErrorMessage",{defaultMessage:"Value must be greater than or equal to one."}),allowEquality:!0})(...e)}}]}}},threatIndex:{type:oS.a.COMBO_BOX,label:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThreatIndexPatternsLabel",{defaultMessage:"Indicator index patterns"}),helpText:r.a.createElement(N.EuiText,{size:"xs"},RC),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(zn.d)(t.ruleType))return oS.h.emptyField(F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.threatMatchoutputIndiceNameFieldRequiredError",{defaultMessage:"A minimum of one index pattern is required."}))(...e)}},{validator:(...e)=>{const[{formData:t,value:a}]=e;if(Object(zn.d)(t.ruleType))return((e,t)=>{let a;if(a="string"==typeof e?e===t:!!Array.isArray(e)&&!!e.find((e=>e===t)),a)return{code:"ERR_FIELD_FORMAT",message:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.threatMatchIndexForbiddenError",{defaultMessage:"The index pattern cannot be { forbiddenString }. Please choose a more specific index pattern.",values:{forbiddenString:t}})}})(a,"*")}}]},threatMapping:{label:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThreatMappingLabel",{defaultMessage:"Indicator mapping"}),validations:[{validator:(...e)=>{const[{path:t,formData:a}]=e;var n;if(Object(zn.d)(a.ruleType))return 1===(n=a.threatMapping).length&&1===n[0].entries.length&&""===n[0].entries[0].field&&""===n[0].entries[0].value?{code:"ERR_FIELD_MISSING",path:t,message:_C}:(e=>e.some((e=>e.entries.some((e=>""===e.field||""===e.value)))))(a.threatMapping)?{code:"ERR_FIELD_MISSING",path:t,message:FC}:void 0}}]},threatQueryBar:{label:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThreatQueryBarLabel",{defaultMessage:"Indicator index query"}),validations:[{validator:(...e)=>{const[{value:t,path:a,formData:n}]=e;if(!Object(zn.d)(n.ruleType))return;const{query:i,filters:r}=t;return Object(fn.isEmpty)(i.query)&&Object(fn.isEmpty)(r)?{code:"ERR_FIELD_MISSING",path:a,message:wC}:void 0}},{validator:(...e)=>{const[{value:t,path:a,formData:n}]=e;if(!Object(zn.d)(n.ruleType))return;const{query:i}=t;if(!Object(fn.isEmpty)(i.query)&&"kuery"===i.language)try{Object(oa.e)(i.query)}catch(e){return{code:"ERR_FIELD_FORMAT",path:a,message:CC}}}}]}};var sI=a(609),oI=F.i18n.translate("autocomplete.loadingDescription",{defaultMessage:"Loading..."}),lI=F.i18n.translate("autocomplete.selectField",{defaultMessage:"Please select a field first..."}),cI=F.i18n.translate("autocomplete.fieldRequiredError",{defaultMessage:"Value cannot be empty"}),uI=F.i18n.translate("autocomplete.invalidNumberError",{defaultMessage:"Not a valid number"}),dI=F.i18n.translate("autocomplete.invalidDateError",{defaultMessage:"Not a valid date"}),pI=a(38),mI=a.n(pI),gI=function(e){var t=e.getLabel,a=e.options,n=e.selectedOptions,i=a.map(t),r=i.map((function(e){return{label:e}})),s=n.map(t).filter((function(e){return-1!==i.indexOf(e)})).map((function(e){return r[i.indexOf(e)]}));return{comboOptions:r,labels:i,selectedComboOptions:s}},fI=a(167),bI={asPlainText:!0},hI=function(e){var t=e.fieldInputWidth,a=e.fieldTypeFilter,n=void 0===a?[]:a,r=e.indexPattern,s=e.isClearable,o=void 0!==s&&s,l=e.isDisabled,c=void 0!==l&&l,u=e.isLoading,d=void 0!==u&&u,p=e.isRequired,m=void 0!==p&&p,g=e.onChange,f=e.placeholder,b=e.selectedField,h=Object(i.useState)(!1),y=mI()(h,2),E=y[0],v=y[1],T=Object(i.useMemo)((function(){return yI(r,b,n)}),[r,b,n]),k=T.availableFields,x=T.selectedFields,S=Object(i.useMemo)((function(){return EI({availableFields:k,selectedFields:x})}),[k,x]),O=S.comboOptions,w=S.labels,j=S.selectedComboOptions,C=Object(i.useCallback)((function(e){var t=e.map((function(e){var t=e.label;return k[w.indexOf(t)]}));g(t)}),[k,w,g]),I=Object(i.useCallback)((function(){v(!0)}),[v]),M=Object(i.useMemo)((function(){return t?{width:"".concat(t,"px")}:{}}),[t]);return Object(fI.jsx)(N.EuiComboBox,{placeholder:f,options:O,selectedOptions:j,onChange:C,isLoading:d,isDisabled:c,isClearable:o,isInvalid:!!m&&E&&null==b,onFocus:I,singleSelection:bI,"data-test-subj":"fieldAutocompleteComboBox",style:M,fullWidth:!0})};hI.displayName="Field";var yI=function(e,t,a){var n=vI(e),i=TI(t);return{availableFields:kI(n,i,a),selectedFields:i}},EI=function(e){var t=e.availableFields,a=e.selectedFields;return gI({getLabel:function(e){return e.name},options:t,selectedOptions:a})},vI=function(e){return null!=e?e.fields:[]},TI=function(e){return e?[e]:[]},kI=function(e,t,a){var n=new Map;e.forEach((function(e){return n.set(e.name,e)})),t.forEach((function(e){return n.set(e.name,e)}));var i=Array.from(n.values());return a.length>0?i.filter((function(e){var t=e.type;return a.includes(t)})):i},xI=a(20),SI=a.n(xI),OI=a(11),wI=a.n(OI),jI=a(285),CI=a.n(jI),II=a(286),MI=a.n(II),AI=function(e){var t=e.selectedField,a=e.operatorType,n=e.fieldValue,r=e.query,s=e.indexPattern,o=e.autocompleteService,l=Object(i.useState)(!1),c=mI()(l,2),u=c[0],d=c[1],p=Object(i.useState)(!0),m=mI()(p,2),g=m[0],f=m[1],b=Object(i.useState)([]),h=mI()(b,2),y=h[0],E=h[1],v=Object(i.useRef)(null);return Object(i.useEffect)((function(){var e=!0,i=new AbortController,l=Object(fn.debounce)(function(){var t=CI()(MI.a.mark((function t(a){var n,r,s,l,c,u;return MI.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=a.fieldSelected,r=a.patterns,s=a.searchQuery,t.prev=1,!e){t.next=17;break}if(null!=n&&null!=r){t.next=5;break}return t.abrupt("return");case 5:if("boolean"!==n.type){t.next=8;break}return f(!1),t.abrupt("return");case 8:return d(!0),l=Object(oa.f)(n),c=l?wI()(wI()({},n),{},{name:"".concat(l.nested.path,".").concat(n.name)}):n,t.next=13,o.getValueSuggestions({field:c,indexPattern:r,query:s,signal:i.signal});case 13:0===(u=t.sent).length&&f(!1),d(!1),E(SI()(u));case 17:t.next=22;break;case 19:t.prev=19,t.t0=t.catch(1),e&&(E([]),d(!1));case 22:case"end":return t.stop()}}),t,null,[[1,19]])})));return function(e){return t.apply(this,arguments)}}(),500);return a!==Gu.c.EXISTS&&l({fieldSelected:t,patterns:s,searchQuery:r,value:n}),v.current=l,function(){e=!1,i.abort()}}),[t,a,n,s,r,o]),[u,g,y,v.current]},DI=function(e,t,a,n){if(null!=t){var i=function(e,t,a,n){return a&&n&&(null==e||""===e.trim())?cI:null==t||a&&!n||!(a||null!=e&&""!==e)?void 0:null}(e,t,a,n);if(null!==i)return i;switch(t.type){case"date":var r=Rn.a.parse(null!=e?e:"");return Boolean(r&&r.isValid())?void 0:dI;case"number":return null==e||""===e.trim()||isNaN(+e)?uI:void 0;default:return}}},qI=[{inputDisplay:"true",value:"true"},{inputDisplay:"false",value:"false"}],PI={asPlainText:!0},RI=function(e){var t=e.placeholder,a=e.rowLabel,n=e.selectedField,r=e.selectedValue,s=e.indexPattern,o=e.isLoading,l=e.isDisabled,c=void 0!==l&&l,u=e.isClearable,d=void 0!==u&&u,p=e.isRequired,m=void 0!==p&&p,g=e.fieldInputWidth,f=e.onChange,b=e.onError,h=e.autocompleteService,y=Object(i.useState)(""),E=mI()(y,2),v=E[0],T=E[1],k=Object(i.useState)(!1),x=mI()(k,2),S=x[0],O=x[1],w=Object(i.useState)(void 0),j=mI()(w,2),C=j[0],I=j[1],M=AI({autocompleteService:h,fieldValue:r,indexPattern:s,operatorType:Gu.c.MATCH,query:v,selectedField:n}),A=mI()(M,3),D=A[0],q=A[1],P=A[2],R=Object(i.useCallback)((function(e){return e}),[]),_=Object(i.useMemo)((function(){var e=String(r);return null!=r&&""!==r.trim()?Object(fn.uniq)([e].concat(SI()(P))):P}),[P,r]),F=Object(i.useMemo)((function(){var e=String(r);return r?[e]:[]}),[r]),L=Object(i.useCallback)((function(e){I((function(t){var a=null!=e;return null!=t!==a&&null!=b&&b(a),e}))}),[I,b]),B=Object(i.useMemo)((function(){return gI({getLabel:R,options:_,selectedOptions:F})}),[_,F,R]),z=B.comboOptions,U=B.labels,H=B.selectedComboOptions,$=Object(i.useCallback)((function(e){var t=e.map((function(e){var t=e.label;return _[U.indexOf(t)]})),a=mI()(t,1)[0];L(void 0),f(null!=a?a:"")}),[L,U,f,_]),V=Object(i.useCallback)((function(e){if(""!==e&&null!=n){var t=DI(e,n,m,S);L(t),T(e)}}),[L,m,n,S]),Q=Object(i.useCallback)((function(e){var t=DI(e,n,m,S);return L(t),null==t&&void f(e)}),[m,f,n,S,L]),W=Object(i.useCallback)((function(e){var t=e.target.value;f(t)}),[f]),G=Object(i.useCallback)((function(e){f(e)}),[f]),K=Object(i.useCallback)((function(){O(!0);var e=DI(r,n,m,!0);L(e)}),[O,L,r,n,m]),Y=Object(i.useMemo)((function(){return o||D?oI:null==n?lI:t}),[o,n,D,t]),J=Object(i.useMemo)((function(){return o||D}),[o,D]);Object(i.useEffect)((function(){I(void 0),null!=b&&b(!1)}),[n,b]);var X=Object(i.useMemo)((function(){return Object(fI.jsx)(N.EuiFormRow,{label:a,error:C,isInvalid:null!=n&&null!=C,"data-test-subj":"valuesAutocompleteMatchLabel",fullWidth:!0},Object(fI.jsx)(N.EuiComboBox,{placeholder:Y,isDisabled:c||!n,isLoading:J,isClearable:d,options:z,selectedOptions:H,onChange:$,singleSelection:PI,onSearchChange:V,onCreateOption:Q,isInvalid:null!=n&&null!=C,onBlur:K,sortMatchesBy:"startsWith","data-test-subj":"valuesAutocompleteMatch",style:g?{width:"".concat(g,"px")}:{},fullWidth:!0,async:!0}))}),[z,C,g,Q,V,$,Y,d,c,J,a,H,n,K]);if(q||null==n)return X;switch(n.type){case"number":return Object(fI.jsx)(N.EuiFormRow,{label:a,error:C,isInvalid:null!=n&&null!=C,"data-test-subj":"valuesAutocompleteMatchLabel",fullWidth:!0},Object(fI.jsx)(N.EuiFieldNumber,{placeholder:Y,onBlur:K,value:"string"==typeof r&&r.trim().length>0?parseFloat(r):null!=r?r:"",onChange:W,"data-test-subj":"valueAutocompleteFieldMatchNumber",style:g?{width:"".concat(g,"px")}:{},fullWidth:!0}));case"boolean":return Object(fI.jsx)(N.EuiFormRow,{label:a,error:C,isInvalid:null!=n&&null!=C,"data-test-subj":"valuesAutocompleteMatchLabel",fullWidth:!0},Object(fI.jsx)(N.EuiSuperSelect,{isLoading:J,options:qI,valueOfSelected:null!=r?r:"true",onChange:G,"data-test-subj":"valuesAutocompleteMatchBoolean",style:g?{width:"".concat(g,"px")}:{},fullWidth:!0}));default:return X}};RI.displayName="AutocompleteFieldMatch";var _I={asPlainText:!0};Object(i.memo)((function(e){var t=e.autocompleteService,a=e.placeholder,n=e.rowLabel,r=e.selectedField,s=e.selectedValue,o=e.indexPattern,l=e.isLoading,c=e.isDisabled,u=void 0!==c&&c,d=e.isClearable,p=void 0!==d&&d,m=e.isRequired,g=void 0!==m&&m,f=e.fieldInputWidth,b=e.onChange,h=e.onError,y=e.onWarning,E=e.warning,v=Object(i.useState)(""),T=mI()(v,2),k=T[0],x=T[1],S=Object(i.useState)(!1),O=mI()(S,2),w=O[0],j=O[1],C=Object(i.useState)(void 0),I=mI()(C,2),M=I[0],A=I[1],D=AI({autocompleteService:t,fieldValue:s,indexPattern:o,operatorType:Gu.c.WILDCARD,query:k,selectedField:r}),q=mI()(D,3),P=q[0],R=q[2],_=Object(i.useCallback)((function(e){return e}),[]),F=Object(i.useMemo)((function(){var e=String(s);return null!=s&&""!==s.trim()?Object(fn.uniq)([e].concat(SI()(R))):R}),[R,s]),L=Object(i.useMemo)((function(){var e=String(s);return s?[e]:[]}),[s]),B=Object(i.useCallback)((function(e){A((function(t){var a=null!=e;return null!=t!==a&&null!=h&&h(a),e}))}),[A,h]),z=Object(i.useCallback)((function(e){y(void 0!==e)}),[y]),U=Object(i.useMemo)((function(){return gI({getLabel:_,options:F,selectedOptions:L})}),[F,L,_]),H=U.comboOptions,$=U.labels,V=U.selectedComboOptions,Q=Object(i.useCallback)((function(e){var t=e.map((function(e){var t=e.label;return F[$.indexOf(t)]})),a=mI()(t,1)[0];B(void 0),z(void 0),b(null!=a?a:"")}),[B,z,$,b,F]),W=Object(i.useCallback)((function(e){if(""!==e.trim()&&null!=r){var t=DI(e,r,g,w);B(t),z(E),x(e)}}),[B,g,r,w,E,z]),G=Object(i.useCallback)((function(e){var t=DI(e,r,g,w);return B(t),z(E),null==t&&void b(e)}),[g,b,r,w,B,z,E]),K=Object(i.useCallback)((function(){j(!0);var e=DI(s,r,g,!0);B(e),z(E)}),[j,B,s,r,g,z,E]),Y=Object(i.useMemo)((function(){return l||P?oI:null==r?lI:a}),[l,r,P,a]),J=Object(i.useMemo)((function(){return l||P}),[l,P]);return Object(i.useEffect)((function(){A(void 0),null!=h&&h(!1),y(!1)}),[r,h,y]),Object(i.useMemo)((function(){return Object(fI.jsx)(N.EuiFormRow,{label:n,error:M,helpText:E,isInvalid:null!=r&&null!=M,"data-test-subj":"valuesAutocompleteWildcardLabel",fullWidth:!0},Object(fI.jsx)(N.EuiComboBox,{placeholder:Y,isDisabled:u||!r,isLoading:J,isClearable:p,options:H,selectedOptions:V,onChange:Q,singleSelection:_I,onSearchChange:W,onCreateOption:G,isInvalid:null!=r&&null!=M,onBlur:K,sortMatchesBy:"startsWith","data-test-subj":"valuesAutocompleteWildcard",style:f?{width:"".concat(f,"px")}:{},fullWidth:!0,async:!0}))}),[H,M,f,G,W,Q,Y,p,u,J,n,V,r,K,E])})).displayName="AutocompleteFieldWildcard";var FI=a(282);const LI=z()(N.EuiFlexItem).withConfig({displayName:"FlexItemWithLabel",componentId:"sc-1i1appc-0"})(["padding-top:20px;text-align:center;"]),NI=z()(N.EuiFlexItem).withConfig({displayName:"FlexItemWithoutLabel",componentId:"sc-1i1appc-1"})(["text-align:center;"]),BI=({entry:e,indexPattern:t,threatIndexPatterns:a,showLabel:n,onChange:s})=>{const o=Object(i.useCallback)((([t])=>{const{updatedEntry:a,index:n}=((e,t)=>{const{entryIndex:a}=e;return{updatedEntry:{id:e.id,field:null!=t?t.name:"",type:"mapping",value:null!=e.value?e.value.name:""},index:a}})(e,t);s(a,n)}),[s,e]),l=Object(i.useCallback)((([t])=>{const{updatedEntry:a,index:n}=((e,t)=>{const{entryIndex:a}=e;return{updatedEntry:{id:e.id,field:null!=e.field?e.field.name:"",type:"mapping",value:null!=t?t.name:""},index:a}})(e,t);s(a,n)}),[s,e]),c=Object(i.useMemo)((()=>{const a=r.a.createElement(hI,{placeholder:aw,indexPattern:t,selectedField:e.field,isClearable:!1,isLoading:!1,isDisabled:null==t,onChange:o,"data-test-subj":"entryField",fieldInputWidth:360});return n?r.a.createElement(N.EuiFormRow,{label:ew,"data-test-subj":"entryItemFieldInputFormRow"},a):r.a.createElement(N.EuiFormRow,{label:"","data-test-subj":"entryItemFieldInputFormRow"},a)}),[o,t,e,n]),u=Object(i.useMemo)((()=>{const t=r.a.createElement(hI,{placeholder:aw,indexPattern:a,selectedField:e.value,isClearable:!1,isLoading:!1,isDisabled:null==a,onChange:l,"data-test-subj":"threatEntryField",fieldInputWidth:360});return n?r.a.createElement(N.EuiFormRow,{label:tw,"data-test-subj":"threatFieldInputFormRow"},t):r.a.createElement(N.EuiFormRow,{label:"","data-test-subj":"threatFieldInputFormRow"},t)}),[l,a,e,n]);return r.a.createElement(N.EuiFlexGroup,{direction:"row",gutterSize:"s",alignItems:"center",justifyContent:"spaceAround","data-test-subj":"itemEntryContainer"},r.a.createElement(N.EuiFlexItem,{grow:!1},c),r.a.createElement(N.EuiFlexItem,{grow:!0},r.a.createElement(N.EuiFlexGroup,{justifyContent:"spaceAround",alignItems:"center"},n?r.a.createElement(LI,{grow:!0},nw):r.a.createElement(NI,{grow:!0},nw))),r.a.createElement(N.EuiFlexItem,{grow:!1},u))};BI.displayName="EntryItem";const zI=z()(N.EuiFlexItem).withConfig({displayName:"MyFirstRowContainer",componentId:"sc-136w498-0"})(["padding-top:20px;"]),UI=r.a.memo((({entries:e,isOnlyItem:t,entryIndex:a,itemIndex:n,onDelete:s})=>{const o=t&&1===e.length&&0===n&&(null==e[0].field||""===e[0].field),l=Object(i.useCallback)((()=>{s(a)}),[s,a]),c=r.a.createElement(N.EuiButtonIcon,{color:"danger",iconType:"trash",onClick:l,isDisabled:o,"aria-label":"entryDeleteButton",className:"itemEntryDeleteButton","data-test-subj":"itemEntryDeleteButton"});return 0===a&&0===n?r.a.createElement(zI,{grow:!1,"data-test-subj":"firstRowDeleteButton"},c):r.a.createElement(N.EuiFlexItem,{grow:!1,"data-test-subj":"deleteButton"},c)}));UI.displayName="EntryDeleteButton";var HI=a(325);const $I=z()(N.EuiFlexItem).withConfig({displayName:"MyInvisibleAndBadge",componentId:"sc-d6yaa8-0"})(["visibility:hidden;"]),VI=z()(N.EuiFlexItem).withConfig({displayName:"MyFirstRowContainer",componentId:"sc-d6yaa8-1"})(["padding-top:20px;"]),QI=r.a.memo((({entriesLength:e,entryItemIndex:t})=>{const a=r.a.createElement(HI.a,{includeAntennas:!0,type:"and"});return e>1&&0===t?r.a.createElement(VI,{grow:!1,"data-test-subj":"entryItemEntryFirstRowAndBadge"},a):e<=1?r.a.createElement($I,{grow:!1,"data-test-subj":"entryItemEntryInvisibleAndBadge"},a):r.a.createElement(N.EuiFlexItem,{grow:!1,"data-test-subj":"entryItemEntryAndBadge"},a)}));QI.displayName="AndBadge";const WI=z()(N.EuiFlexItem).withConfig({displayName:"MyOverflowContainer",componentId:"sc-o1uavm-0"})(["overflow:hidden;width:100%;"]),GI=r.a.memo((({listItem:e,listItemIndex:t,indexPattern:a,threatIndexPatterns:n,isOnlyItem:s,andLogicIncluded:o,onDeleteEntryItem:l,onChangeEntryItem:c})=>{const u=Object(i.useCallback)(((a,n)=>{const i=[...e.entries.slice(0,n),{...a},...e.entries.slice(n+1)],r={...e,entries:i};c(r,t)}),[c,e,t]),d=Object(i.useCallback)((a=>{const n=((e,t)=>({...e,entries:[...e.entries.slice(0,t),...e.entries.slice(t+1)]}))(e,a);l(n,t)}),[e,l,t]),p=Object(i.useMemo)((()=>null!=a&&e.entries.length>0?((e,t,a)=>a.reduce(((a,n,i)=>{const r=((e,t,a,n,i=sa.a.v4)=>{var r;const{fields:s}=e,{fields:o}=t,l=a.field,c=a.value,[u]=s.filter((({name:e})=>null!=l&&l===e)),[d]=o.filter((({name:e})=>null!=c&&c===e));return{id:null!==(r=a.id)&&void 0!==r?r:i(),field:u,type:"mapping",value:d,entryIndex:n}})(e,t,n,i);return[...a,r]}),[]))(a,n,e.entries):[]),[e.entries,a,n]);return r.a.createElement(N.EuiFlexItem,null,r.a.createElement(N.EuiFlexGroup,{gutterSize:"s","data-test-subj":"entriesContainer"},o&&r.a.createElement(QI,{entriesLength:e.entries.length,entryItemIndex:t}),r.a.createElement(WI,{grow:6},r.a.createElement(N.EuiFlexGroup,{gutterSize:"s",direction:"column"},p.map(((i,o)=>r.a.createElement(N.EuiFlexItem,{key:i.id,grow:1},r.a.createElement(N.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",direction:"row"},r.a.createElement(WI,{grow:1},r.a.createElement(BI,{entry:i,threatIndexPatterns:n,indexPattern:a,showLabel:0===t&&0===o,onChange:u})),r.a.createElement(UI,{entries:e.entries,isOnlyItem:s,entryIndex:i.entryIndex,itemIndex:t,onDelete:d})))))))))}));GI.displayName="ListItem";const KI=z()(N.EuiButton).withConfig({displayName:"MyEuiButton",componentId:"sc-1dsnlky-0"})(["min-width:95px;"]),YI=({isOrDisabled:e=!1,isAndDisabled:t=!1,onAndClicked:a,onOrClicked:n})=>r.a.createElement(N.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(KI,{fill:!0,size:"s",iconType:"plusInCircle",onClick:a,"data-test-subj":"andButton",isDisabled:t},iw)),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(KI,{fill:!0,size:"s",iconType:"plusInCircle",onClick:n,isDisabled:e,"data-test-subj":"orButton"},rw))),JI=z()(N.EuiFlexItem).withConfig({displayName:"MyInvisibleAndBadge",componentId:"sc-ph2s87-0"})(["visibility:hidden;"]),XI=z()(HI.a).withConfig({displayName:"MyAndBadge",componentId:"sc-ph2s87-1"})(["& > .euiFlexItem{margin:0;}"]),ZI=z()(N.EuiFlexItem).withConfig({displayName:"MyButtonsContainer",componentId:"sc-ph2s87-2"})(["margin:16px 0;"]),eM={andLogicIncluded:!1,entries:[],entriesToDelete:[]},tM=({listItems:e,indexPatterns:t,threatIndexPatterns:a,onChange:n})=>{const[{entries:s,entriesToDelete:o,andLogicIncluded:l},c]=Object(i.useReducer)(((e,t)=>{switch(t.type){case"setEntries":{const a=t.entries.filter((({entries:e})=>e.length>1)).length>0;return{...e,andLogicIncluded:a,entries:t.entries}}case"setDefault":return{...e,...t.initialState,entries:[{...t.lastEntry,entries:[nI()]}]};default:return e}}),{...eM}),u=Object(i.useCallback)((e=>{c({type:"setEntries",entries:e})}),[c]),d=Object(i.useCallback)((e=>{c({type:"setDefault",initialState:eM,lastEntry:e})}),[c]),p=Object(i.useCallback)(((e,t)=>{const a=[...s.slice(0,t),{...e},...s.slice(t+1)];u(a)}),[u,s]),m=Object(i.useCallback)(((e,t)=>{0===e.entries.length?0===[...s.slice(0,t),...s.slice(t+1)].length?d(e):u([...s.slice(0,t),...s.slice(t+1)]):p(e,t)}),[p,u,s,d]),g=Object(i.useCallback)((()=>{const e=s[s.length-1],{entries:t}=e,a={...e,entries:[...t,nI()]};u([...s.slice(0,s.length-1),{...a}])}),[u,s]),f=Object(i.useCallback)((()=>{const e=Object(aI.d)({entries:[Object(aI.d)({field:"",type:"mapping",value:""})]});u([...s,{...e}])}),[u,s]),b=Object(i.useCallback)((()=>{g()}),[g]);return Object(i.useEffect)((()=>{var e;n({entryItems:(e=s,e.reduce(((e,t)=>{const a={...t,entries:t.entries};return $d.is(a)?[...e,a]:e}),[])),entriesToDelete:o})}),[n,o,s]),Object(i.useEffect)((()=>{(0===s.length||1===s.length&&null!=s[0].entries&&0===s[0].entries.length)&&f()}),[s,f]),Object(i.useEffect)((()=>{e.length>0&&u(e)}),[]),r.a.createElement(N.EuiFlexGroup,{gutterSize:"s",direction:"column"},s.map(((e,n)=>{var i;const o=null!==(i=e.id)&&void 0!==i?i:`${n}`;return r.a.createElement(N.EuiFlexItem,{grow:1,key:o},r.a.createElement(N.EuiFlexGroup,{gutterSize:"s",direction:"column"},0!==n&&(l?r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiFlexGroup,{gutterSize:"none",direction:"row"},r.a.createElement(JI,{grow:!1},r.a.createElement(XI,{includeAntennas:!0,type:"and"})),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(XI,{type:"or"})))):r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(XI,{type:"or"}))),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(GI,{key:o,listItem:e,indexPattern:t,threatIndexPatterns:a,listItemIndex:n,andLogicIncluded:l,isOnlyItem:1===s.length,onDeleteEntryItem:m,onChangeEntryItem:p}))))})),r.a.createElement(ZI,{"data-test-subj":"andOrOperatorButtons"},r.a.createElement(N.EuiFlexGroup,{gutterSize:"s"},l&&r.a.createElement(JI,{grow:!1},r.a.createElement(HI.a,{includeAntennas:!0,type:"and"})),r.a.createElement(N.EuiFlexItem,{grow:1},r.a.createElement(YI,{isOrDisabled:!1,isAndDisabled:!1,onOrClicked:f,onAndClicked:b})))))};tM.displayName="ThreatMatch";const aM=Object(oS.j)({component:oS.b}),nM=({threatIndexModified:e,handleResetThreatIndices:t,threatMapping:a,indexPatterns:n,threatIndexPatterns:s,threatIndexPatternsLoading:o,threatBrowserFields:l,onValidityChange:c})=>{const{setValue:u,value:d}=a,{isInvalid:p,errorMessage:m}=Object(oS.i)(a),[g,f]=Object(i.useState)(!1);Object(i.useEffect)((()=>{c(!p&&g)}),[g,p,c]);const b=Object(i.useCallback)((({entryItems:e})=>{u(e)}),[u]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiSpacer,{size:"m"}),r.a.createElement(N.EuiFlexGroup,{direction:"column"},r.a.createElement(N.EuiFlexItem,{grow:!0},r.a.createElement(aM,{path:"threatIndex",config:{...rI.threatIndex,labelAppend:e?r.a.createElement(dA,{onClick:t,iconType:"refresh"},MC):null},componentProps:{idAria:"detectionEngineStepDefineRuleThreatMatchIndices","data-test-subj":"detectionEngineStepDefineRuleThreatMatchIndices",euiFieldProps:{fullWidth:!0,isDisabled:!1,placeholder:""}}})),r.a.createElement(N.EuiFlexItem,{grow:!0},r.a.createElement(oS.e,{path:"threatQueryBar",config:{...rI.threatQueryBar,labelAppend:null},component:uC,componentProps:{browserFields:l,idAria:"detectionEngineStepDefineThreatRuleQueryBar",indexPattern:s,isDisabled:!1,isLoading:o,dataTestSubj:"detectionEngineStepDefineThreatRuleQueryBar",openTimelineSearch:!1,onValidityChange:f}}))),r.a.createElement(N.EuiSpacer,{size:"m"}),r.a.createElement(N.EuiFormRow,{label:a.label,labelAppend:a.labelAppend,helpText:a.helpText,error:m,isInvalid:p,fullWidth:!0},r.a.createElement(tM,{listItems:d,indexPatterns:n,threatIndexPatterns:s,"data-test-subj":"threatmatch-builder","id-aria":"threatmatch-builder",onChange:b})),r.a.createElement(N.EuiSpacer,{size:"m"}))},iM=r.a.memo(nM),rM=F.i18n.translate("xpack.securitySolution.stepDefineRule.lastHour",{defaultMessage:"Last hour"}),sM=F.i18n.translate("xpack.securitySolution.stepDefineRule.lastDay",{defaultMessage:"Last day"}),oM=F.i18n.translate("xpack.securitySolution.stepDefineRule.lastWeek",{defaultMessage:"Last week"}),lM=F.i18n.translate("xpack.securitySolution.stepDefineRule.lastMonth",{defaultMessage:"Last month"}),cM=F.i18n.translate("xpack.securitySolution.stepDefineRule.previewQueryButton",{defaultMessage:"Preview results"}),uM=F.i18n.translate("xpack.securitySolution.stepDefineRule.previewTimeoutWarning",{defaultMessage:"Preview timed out after 60 seconds"}),dM=F.i18n.translate("xpack.securitySolution.stepDefineRule.previewQueryAriaLabel",{defaultMessage:"Query preview timeframe select"}),pM=F.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewLabel",{defaultMessage:"Quick query preview"}),mM=F.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewHelpText",{defaultMessage:"Select a timeframe of data to preview query results."}),gM=F.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryGraphCountLabel",{defaultMessage:"Count"}),fM=(F.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryThresholdGraphCountLabel",{defaultMessage:"Cumulative Threshold Count"}),F.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewTitle",{defaultMessage:"Rule Preview"})),bM=(F.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryGraphPreviewInspectTitle",{defaultMessage:"query preview"}),F.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryGraphPreviewNoiseWarning",{defaultMessage:"Noise warning: This rule may cause a lot of noise. Consider narrowing your query. This is based on a linear progression of 1 alert per hour."})),hM=(F.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryNoHits",{defaultMessage:"No hits were found."}),F.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryGraphPreviewError",{defaultMessage:"Error fetching preview"})),yM=F.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewDisclaimer",{defaultMessage:"Note: This preview excludes effects of rule exceptions and timestamp overrides."}),EM=F.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.histogramDisclaimer",{defaultMessage:"Note: Alerts with multiple event.category values will be counted more than once."}),vM=F.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.mlHistogramDisclaimer",{defaultMessage:"Note: Alerts with multiple host.name values will be counted more than once."}),TM=(F.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewEqlSequenceTitle",{defaultMessage:"No histogram available"}),F.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewEqlSequenceDescription",{defaultMessage:"No histogram is available at this time for EQL sequence queries. You can use the inspect in the top right corner to view query details."}),F.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewSeeAllErrors",{defaultMessage:"See all errors"})),kM=F.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewSeeAllWarnings",{defaultMessage:"See all warnings"}),xM=F.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.actions",{defaultMessage:"Actions"}),SM=F.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.viewDetailsAriaLabel",{defaultMessage:"View details"}),OM=({ariaRowindex:e,columnValues:t})=>F.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.viewDetailsForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t},defaultMessage:"View details for the alert or event in row {ariaRowindex}, with columns {columnValues}"});let wM,jM,CM;!function(e){e[e.HOUR=12]="HOUR",e[e.DAY=24]="DAY",e[e.WEEK=168]="WEEK",e[e.MONTH=30]="MONTH"}(wM||(wM={})),function(e){e.HOUR="5m",e.DAY="1h",e.WEEK="1h",e.MONTH="1d"}(jM||(jM={})),function(e){e.HOUR="now-6m",e.DAY="now-65m",e.WEEK="now-65m",e.MONTH="now-25h"}(CM||(CM={}));const IM={previewId:void 0,logs:[],isAborted:!1};var MM=a(706);a(741);const AM=e=>"eql"===e?[{value:"h",text:rM},{value:"d",text:sM}]:"threat_match"===e?[{value:"h",text:rM},{value:"d",text:sM},{value:"w",text:oM}]:"threshold"===e?[{value:"h",text:rM}]:[{value:"h",text:rM},{value:"d",text:sM},{value:"M",text:lM}],DM=({ruleType:e,isQueryBarValid:t,isThreatQueryBarValid:a,index:n,threatIndex:i,threatMapping:r,machineLearningJobId:s,queryBar:o})=>{if(!t||0===n.length)return!0;if("threat_match"===e){var l;if(!a||!i.length||!r)return!0;if(!(r.length&&null!==(l=r[0].entries)&&void 0!==l&&l.length&&r[0].entries[0].field&&r[0].entries[0].value))return!0}return"machine_learning"===e?0===s.length:("eql"===e||"query"===e||"threshold"===e)&&0===o.query.query.length};var qM=a(845),PM=a(364),RM=a(530),_M=a(766),FM=a(557),LM=a(431),NM=a(764);const BM=({columnId:e,data:t,ecsData:a,eventId:n,globalFilters:i,header:s,isDetails:o,isDraggable:l,isExpandable:c,isExpanded:u,linkValues:d,rowIndex:p,colIndex:m,rowRenderers:g,setCellProps:f,timelineId:b,truncate:h})=>r.a.createElement(zM,{columnId:e,data:t,ecsData:a,eventId:n,globalFilters:i,header:s,isDetails:o,isDraggable:l,isExpandable:c,isExpanded:u,linkValues:d,rowIndex:p,colIndex:m,rowRenderers:g,setCellProps:f,timelineId:b,truncate:h}),zM=({data:e,ecsData:t,eventId:a,header:n,isDetails:s,isDraggable:o,isTimeline:l,linkValues:c,rowRenderers:u,timelineId:d,truncate:p})=>{const m=Object(Z.a)("usersEnabled"),g=Object(i.useMemo)((()=>void 0!==Object(FM.a)(n.id,n.type,void 0,m)&&!l),[n.id,n.type,l,m]),f=Object(LM.c)({data:e,fieldName:n.id}),b=s?"eui-textBreakWord":"eui-displayInlineBlock eui-textTruncate";return r.a.createElement(r.a.Fragment,null,r.a.createElement(_M.b,{className:b,$isDetails:s},Object(NM.a)(n.id,se.a,e).renderColumn({asPlainText:g,columnName:n.id,ecsData:t,eventId:a,field:n,isDetails:s,isDraggable:o,linkValues:c,rowRenderers:u,timelineId:d,truncate:p,values:f})))},UM=z.a.div.attrs((({className:e})=>({className:`siemEventsTable__tdContent ${null!=e?e:""}`}))).withConfig({displayName:"EventsTdContent",componentId:"sc-w2s741-0"})(["font-size:",";line-height:",";min-width:0;padding:",";text-align:",";width:",";button.euiButtonIcon{margin-left:",";}"],(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.euiLineHeight),(({theme:e})=>e.eui.paddingSizes.xs),(({textAlign:e})=>e),(({width:e})=>null!=e?`${e}px`:"100%"),(({theme:e})=>`-${e.eui.paddingSizes.xs}`)),HM=z.a.div.withConfig({displayName:"ActionsContainer",componentId:"sc-w2s741-1"})(["align-items:center;display:flex;"]),$M=({ariaRowindex:e,columnValues:t,onEventDetailsPanelOpened:a})=>r.a.createElement(HM,null,r.a.createElement("div",{key:"expand-event"},r.a.createElement(UM,{textAlign:"center",width:U.DEFAULT_ACTION_BUTTON_WIDTH+10},r.a.createElement(N.EuiToolTip,{"data-test-subj":"expand-event-tool-tip",content:SM},r.a.createElement(N.EuiButtonIcon,{"aria-label":OM({ariaRowindex:e,columnValues:t}),"data-test-subj":"expand-event",iconType:"expand",onClick:a,size:"s"})))));$M.displayName="PreviewActionsComponent";const VM=r.a.memo($M),QM=z()(N.EuiLoadingChart).withConfig({displayName:"LoadingChart",componentId:"sc-1g7nn5q-0"})(["display:block;margin:0 auto;"]),WM=z.a.div.withConfig({displayName:"FullScreenContainer",componentId:"sc-1g7nn5q-1"})(["height:",";flex:1 1 auto;display:flex;width:100%;"],(({$isFullScreen:e})=>e?"100%":void 0)),GM=({timeFrame:e,previewId:t,addNoiseWarning:a,spaceId:n,ruleType:s,index:c})=>{const u=Object(l.useDispatch)(),{setQuery:f,isInitializing:b}=Object(H.a)(),{timelines:h}=Object(d.j)().services,y=Object(i.useMemo)((()=>`now-1${e}`),[e]),E=Object(i.useMemo)((()=>"now"),[]),v=Object(i.useMemo)((()=>Object(PM.c)(y)),[y]),T=Object(i.useMemo)((()=>Object(PM.c)(E)),[E]),k=Object(i.useMemo)((()=>"eql"===s),[s]),x=Object(i.useMemo)((()=>"machine_learning"===s),[s]),[S,{data:w,inspect:j,totalCount:C,refetch:I}]=(({previewId:e,startDate:t,endDate:a,spaceId:n,index:r,ruleType:s})=>{const{uiSettings:l}=Object(d.j)().services,[c,u]=Object(hs.b)({config:Object(K.getEsQueryConfig)(l),indexPattern:{fields:[],title:r.join()},queries:[{query:`kibana.alert.rule.uuid:${e}`,language:"kuery"}],filters:[]}),p=Object(i.useMemo)((()=>"machine_learning"===s?"host.name":"event.category"),[s]),m=Object(i.useMemo)((()=>({endDate:a,errorMessage:hM,filterQuery:c,histogramType:Ii.j.preview,indexNames:[`${o.W}-${n}`],stackByField:p,startDate:t,includeMissingData:!1,skip:null!=u})),[t,a,c,n,u,p]);return Object(qM.a)(m)})({previewId:t,startDate:v,endDate:T,spaceId:n,index:c,ruleType:s}),{timeline:{columns:M,dataProviders:A,defaultColumns:D,deletedEventIds:q,itemsPerPage:P,itemsPerPageOptions:R,kqlMode:_,sort:F}=we.b}=Object(l.useSelector)((e=>Object(MM.a)(e,Sm.b.rulePreview))),{browserFields:L,docValueFields:B,indexPattern:z,runtimeMappings:$,dataViewId:V,loading:Q}=Object(m.d)(g.SourcererScopeName.detections),{globalFullScreen:W}=Object(dt.a)(),G=_O()(t),Y=Object(Z.a)("tGridEventRenderedViewEnabled");Object(i.useEffect)((()=>{var n,i;G!==t&&C>0&&(n=C,("h"===(i=e)?n>1:"d"===i?n/24>1:"w"===i?n/168>1:"M"===i&&n/30>1)&&a())}),[C,a,e,G,t]),Object(i.useEffect)((()=>{S||b||f({id:`previewHistogram-${t}`,inspect:j,loading:S,refetch:I})}),[f,j,S,b,I,t]),Object(i.useEffect)((()=>{u(p.a.createTimeline({columns:M,dataViewId:V,defaultColumns:D,id:Sm.b.rulePreview,indexNames:[`${o.W}-${n}`],itemsPerPage:P,sort:F}))}),[]);const J=Object(i.useMemo)((()=>((e,t,a=!1)=>({series:{xScaleType:or.ScaleType.Time,yScaleType:or.ScaleType.Linear,stackAccessors:["g"]},axis:{xTickFormatter:Object(lr.a)([e,t]),yTickFormatter:e=>e.toLocaleString(),tickSize:8},yAxisTitle:gM,settings:{legendPosition:or.Position.Right,showLegend:a,showLegendExtra:a,theme:{scales:{barsPadding:.08},chartMargins:{left:0,right:0,top:0,bottom:0},chartPaddings:{left:0,right:0,top:0,bottom:0}}},customHeight:200}))(T,v,!k)),[T,v,k]),X=Object(i.useMemo)((()=>[{key:"hits",value:w}]),[w]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ms.a,{height:300,"data-test-subj":"preview-histogram-panel"},r.a.createElement(N.EuiFlexGroup,{gutterSize:"none",direction:"column"},r.a.createElement(N.EuiFlexItem,{grow:1},r.a.createElement(la.a,{id:`previewHistogram-${t}`,title:fM,titleSize:"xs"})),r.a.createElement(N.EuiFlexItem,{grow:1},S?r.a.createElement(QM,{size:"l","data-test-subj":"preview-histogram-loading"}):r.a.createElement(Er.a,{configs:J,barChart:X,"data-test-subj":"preview-histogram-bar-chart"})),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiSpacer,null),r.a.createElement(N.EuiText,{size:"s",color:"subdued"},r.a.createElement("p",null,x?vM:EM)))))),r.a.createElement(N.EuiSpacer,null),r.a.createElement(WM,{$isFullScreen:W},r.a.createElement(ca.c,null,h.getTGrid({additionalFilters:r.a.createElement(r.a.Fragment,null),appId:o.y,browserFields:L,columns:M,dataProviders:A,deletedEventIds:q,disabledCellActions:RM.a,docValueFields:B,end:T,entityType:"events",filters:[],globalFullScreen:W,hasAlertsCrud:!1,id:Sm.b.rulePreview,indexNames:[`${o.W}-${n}`],indexPattern:z,isLive:!1,isLoadingIndexPattern:Q,itemsPerPage:P,itemsPerPageOptions:R,kqlMode:_,query:{query:`kibana.alert.rule.uuid:${t}`,language:"kuery"},renderCellValue:BM,rowRenderers:se.b,runtimeMappings:$,setQuery:()=>{},sort:F,start:v,tGridEventRenderedViewEnabled:Y,type:"embedded",leadingControlColumns:(1.5,[{headerCellRender:()=>r.a.createElement(r.a.Fragment,null,xM),id:"default-timeline-control-column",rowCellRender:VM,width:Object(U.getActionsColumnWidth)(1.5)}])}))),r.a.createElement(O.a,{browserFields:L,entityType:"events",docValueFields:B,isFlyoutView:!0,runtimeMappings:$,timelineId:Sm.b.rulePreview,isReadOnly:!0}))},KM=({message:e})=>r.a.createElement(N.EuiCallOut,{color:"warning",iconType:"alert","data-test-subj":"preview-abort"},r.a.createElement(N.EuiText,null,r.a.createElement("p",null,e))),YM=(e,t,a,n)=>t.length?[{startedAt:e,logs:t,duration:a},...n]:n,JM=({logs:e,hasNoiseWarning:t,isAborted:a})=>{const n=Object(i.useMemo)((()=>e.reduce((({errors:e,warnings:t},a)=>({errors:YM(a.startedAt,a.errors,a.duration,e),warnings:YM(a.startedAt,a.warnings,a.duration,t)})),{errors:[],warnings:[]})),[e]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiSpacer,{size:"s"}),null!=t?t:r.a.createElement(KM,{message:bM}),r.a.createElement(XM,{logs:n.errors,isError:!0}),r.a.createElement(XM,{logs:n.warnings},a?r.a.createElement(KM,{message:uM}):null))},XM=({logs:e,isError:t,children:a})=>{const n=e[0];if(!a&&!n)return null;const i=a?e:e.slice(1),s=null!=a?a:r.a.createElement(ZM,{logs:n.logs,startedAt:n.startedAt,isError:t,duration:n.duration});return r.a.createElement(r.a.Fragment,null,s,i.length>0?r.a.createElement(N.EuiAccordion,{id:t?"previewErrorAccordion":"previewWarningAccordion",buttonContent:t?TM:kM},i.map(((e,a)=>r.a.createElement(ZM,{key:`accordion-log-${a}`,logs:e.logs,startedAt:e.startedAt,duration:e.duration,isError:t})))):null,r.a.createElement(N.EuiSpacer,{size:"m"}))},ZM=({logs:e,startedAt:t,isError:a,duration:n})=>e.length>0?r.a.createElement(r.a.Fragment,null,e.map(((e,s)=>r.a.createElement(i.Fragment,{key:s},r.a.createElement(N.EuiCallOut,{color:a?"danger":"warning",iconType:"alert","data-test-subj":a?"preview-error":"preview-warning",title:`${t?`[${t}] `:""}[${n}ms]`},r.a.createElement(N.EuiText,null,r.a.createElement("p",null,e))),r.a.createElement(N.EuiSpacer,{size:"s"}))))):null,eA=z()(N.EuiLoadingChart).withConfig({displayName:"LoadingChart",componentId:"sc-179y2u8-0"})(["display:block;margin:0 auto;"]),tA=()=>r.a.createElement(Ms.a,{height:300,"data-test-subj":"preview-histogram-panel"},r.a.createElement(N.EuiFlexGroup,{gutterSize:"none",direction:"column"},r.a.createElement(N.EuiFlexItem,{grow:1},r.a.createElement(la.a,{title:fM,titleSize:"xs",subtitle:"loading"})),r.a.createElement(N.EuiFlexItem,{grow:1},r.a.createElement(eA,{size:"l","data-test-subj":"preview-histogram-loading"})),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiSpacer,null),r.a.createElement(N.EuiText,{size:"s",color:"subdued"},r.a.createElement("p",null,yM)))))),aA=r.a.createElement(N.EuiFlexGroup,{direction:"column",gutterSize:"none"},r.a.createElement(N.EuiFlexItem,null,mM),r.a.createElement(N.EuiFlexItem,null,yM)),nA=z()(N.EuiSelect).withConfig({displayName:"Select",componentId:"sc-2o9ww4-0"})(["width:",";"],(({theme:e})=>e.eui.euiSuperDatePickerWidth)),iA=z()(N.EuiButton).withConfig({displayName:"PreviewButton",componentId:"sc-2o9ww4-1"})(["margin-left:0;"]),rA=({index:e,isDisabled:t,query:a,ruleType:n,threatIndex:s,threatQuery:o,threatMapping:l,threshold:c,machineLearningJobId:u,anomalyThreshold:p,eqlOptions:m})=>{const{spaces:g}=Object(d.j)().services,{loading:f,jobs:b}=Object(aj.a)(!1),[h,y]=Object(i.useState)("");Object(i.useEffect)((()=>{g&&g.getActiveSpace().then((e=>y(e.id)))}),[g]);const E=Object(i.useMemo)((()=>"machine_learning"!==n||(f?b.filter((({id:e})=>u.includes(e))).every((e=>Object(lu.c)(e.jobState,e.datafeedState))):void 0)),[b,u,n,f]),[v,T]=Object(i.useState)("h"),{addNoiseWarning:k,createPreview:x,isPreviewRequestInProgress:S,previewId:O,logs:w,hasNoiseWarning:j,isAborted:C}=(({index:e,isDisabled:t,query:a,threatIndex:n,threatQuery:r,timeFrame:s,ruleType:o,threatMapping:l,threshold:c,machineLearningJobId:u,anomalyThreshold:d,eqlOptions:p})=>{var m,g;const[f,b]=Object(i.useState)(!1),{isLoading:h,response:y,rule:E,setRule:v}=((e="h")=>{const[t,a]=Object(i.useState)(null),[n,r]=Object(i.useState)(IM),[s,o]=Object(i.useState)(!1),{addError:l}=Object(X.a)();let c=wM.HOUR,u=jM.HOUR,d=CM.HOUR;switch(e){case"d":c=wM.DAY,u=jM.DAY,d=CM.DAY;break;case"w":c=wM.WEEK,u=jM.WEEK,d=CM.WEEK;break;case"M":c=wM.MONTH,u=jM.MONTH,d=CM.MONTH}return Object(i.useEffect)((()=>{t||(r(IM),o(!1))}),[t]),Object(i.useEffect)((()=>{let e=!0;const a=new AbortController;return r(IM),(async()=>{if(null!=t){try{o(!0);const n=await Object(cn.l)({rule:{...Object(Wu.b)({...t,interval:u,from:d}),invocationCount:c},signal:a.signal});e&&r(n)}catch(t){e&&l(t,{title:un.g})}e&&o(!1)}})(),()=>{e=!1,a.abort()}}),[t,l,c,d,u]),{isLoading:s,response:n,rule:t,setRule:a}})(s),[T,k]=Object(i.useState)(null!==(m=y.logs)&&void 0!==m?m:[]),[x,S]=Object(i.useState)(!!y.isAborted),[O,w]=Object(i.useState)(!1);Object(i.useEffect)((()=>{var e;k(null!==(e=y.logs)&&void 0!==e?e:[]),S(!!y.isAborted)}),[y]);const j=Object(i.useCallback)((()=>{w(!0)}),[w]),C=Object(i.useCallback)((()=>{v(null),k([]),S(!1),b(!1),w(!1)}),[v]);return Object(i.useEffect)((()=>{C()}),[C,e,t,a,n,r,s,o,l,c,u,d,p]),Object(i.useEffect)((()=>{f&&null===E&&v((({index:e,query:t,threatIndex:a,threatQuery:n,ruleType:i,threatMapping:r,timeFrame:s,threshold:o,machineLearningJobId:l,anomalyThreshold:c,eqlOptions:u})=>{const d={...lA,index:e,queryBar:t,ruleType:i,threatIndex:a,threatQueryBar:n,threatMapping:r,threshold:o,machineLearningJobId:l,anomalyThreshold:c,eqlOptions:u},p={...BO,name:"Preview Rule",description:"Preview Rule"},m={from:"now-"+("M"===s?"25h":"d"===s?"65m":"6m"),interval:"M"===s?"1d":"d"===s?"1h":"5m"};return{...aC(d,p,m,Hj),...m}})({index:e,query:a,ruleType:o,threatIndex:n,threatMapping:l,threatQuery:r,timeFrame:s,threshold:c,machineLearningJobId:u,anomalyThreshold:d,eqlOptions:p}))}),[e,f,a,E,o,v,n,l,r,s,c,u,d,p]),{hasNoiseWarning:O,addNoiseWarning:j,createPreview:()=>b(!0),clearPreview:C,isPreviewRequestInProgress:h,previewId:null!==(g=y.previewId)&&void 0!==g?g:"",logs:T,isAborted:x}})({index:e,isDisabled:t,query:a,threatIndex:s,threatQuery:o,timeFrame:v,ruleType:n,threatMapping:l,threshold:c,machineLearningJobId:u,anomalyThreshold:p,eqlOptions:m});Object(i.useEffect)((()=>{T("h")}),[n]);const{startTransaction:I}=Vu(),M=Object(i.useCallback)((()=>{I({name:Au}),x()}),[x,I]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiFormRow,{label:pM,helpText:aA,error:void 0,isInvalid:!1,"data-test-subj":"rule-preview",describedByIds:["rule-preview"]},r.a.createElement(N.EuiFlexGroup,null,r.a.createElement(N.EuiFlexItem,{grow:1},r.a.createElement(nA,{id:"preview-time-frame",options:AM(n),value:v,onChange:e=>T(e.target.value),"aria-label":dM,disabled:t,"data-test-subj":"preview-time-frame"})),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(iA,{fill:!0,isLoading:S,isDisabled:t||!E,onClick:M,"data-test-subj":"queryPreviewButton"},cM)))),r.a.createElement(N.EuiSpacer,{size:"s"}),S&&r.a.createElement(tA,null),!S&&O&&h&&r.a.createElement(GM,{ruleType:n,timeFrame:v,previewId:O,addNoiseWarning:k,spaceId:h,index:e}),r.a.createElement(JM,{logs:w,hasNoiseWarning:j,isAborted:C}))},sA=r.a.memo(rA),oA=Object(oS.j)({component:oS.b}),lA={anomalyThreshold:50,index:[],machineLearningJobId:[],ruleType:"query",threatIndex:[],queryBar:{query:{query:"",language:"kuery"},filters:[],saved_id:null},threatQueryBar:{query:{query:o.bb,language:"kuery"},filters:[],saved_id:null},requiredFields:[],relatedIntegrations:[],threatMapping:[],threshold:{field:[],value:"200",cardinality:{field:[],value:""}},timeline:{id:null,title:TS.b},eqlOptions:{}},cA={...lA.queryBar,query:{...lA.queryBar.query,query:"*:*"}},uA={forNormalRules:lA.queryBar,forThreatMatchRules:cA},dA=z()(N.EuiButtonEmpty).withConfig({displayName:"MyLabelButton",componentId:"sc-f0vskm-0"})(["height:18px;font-size:12px;.euiIcon{width:14px;height:14px;}"]);dA.defaultProps={flush:"right"};const pA=z()(N.EuiFormRow).attrs((({$isVisible:e})=>({style:{display:e?"flex":"none"}}))).withConfig({displayName:"RuleTypeEuiFormRow",componentId:"sc-f0vskm-1"})([""]),mA=({addPadding:e=!1,defaultValues:t,descriptionColumns:a="singleSplit",isReadOnlyView:n,isLoading:s,isUpdateView:l=!1,onSubmit:c,setForm:u})=>{const p=Object(Pi.a)(),[m,g]=Object(i.useState)(!1),[f,b]=Object(i.useState)(!1),[h,y]=Object(i.useState)(!1),[E]=Object(d.p)(o.N),[v]=Object(d.p)(o.ab),T=null!=t?t:{...lA,index:E,threatIndex:v},{form:k}=Object(oS.k)({defaultValue:T,options:{stripEmptyFields:!1},schema:rI}),{getFields:x,getFormData:S,reset:O,submit:w}=k,[{index:j,ruleType:C,queryBar:I,threatIndex:M,threatQueryBar:A,threshold:D,threatMapping:q,machineLearningJobId:P,anomalyThreshold:R}]=Object(oS.m)({form:k,watch:["index","ruleType","queryBar","threshold","threshold.field","threshold.value","threshold.cardinality.field","threshold.cardinality.value","threatIndex","threatMapping","machineLearningJobId","anomalyThreshold"]}),[_,F]=Object(i.useState)(!1),[L,B]=Object(i.useState)(!1),z=j||T.index,U=M||T.threatIndex,H=null!=P?P:T.machineLearningJobId,$=null!=R?R:T.anomalyThreshold,V=C||T.ruleType,Q=_O()(V),[W,{browserFields:G,indexPatterns:K}]=Object(EE.b)(z),Y=function(e){const t={};for(const[a,n]of Object.entries(e)){const e={};if(n.fields)for(const[t,a]of Object.entries(n.fields))!0===a.aggregatable&&(e[t]=a);t[a]={fields:e}}return t}(G),[J,X]=Object(i.useState)((null==t?void 0:t.eqlOptions)||{}),[Z,{browserFields:ee,indexPatterns:te}]=Object(EE.b)(U);Object(i.useEffect)((()=>{O({resetValues:!1})}),[O,V]),Object(i.useEffect)((()=>{b(!Object(fn.isEqual)(z,E))}),[z,E]),Object(i.useEffect)((()=>{y(!Object(fn.isEqual)(U,v))}),[U,v]),Object(i.useEffect)((()=>{const{queryBar:e}=x();null!=e&&(Object(zn.d)(V)&&!Object(zn.d)(Q)&&Object(fn.isEqual)(e.value,uA.forNormalRules)?e.reset({defaultValue:uA.forThreatMatchRules}):!Object(zn.d)(V)&&Object(zn.d)(Q)&&Object(fn.isEqual)(e.value,uA.forThreatMatchRules)&&e.reset({defaultValue:uA.forNormalRules}))}),[V,Q,x]);const ae=Object(i.useCallback)((()=>{c&&c()}),[c]),ne=Object(i.useCallback)((async()=>{const e=await w();return e.data={...e.data,eqlOptions:J},e.isValid?e:{isValid:!1,data:{...S(),eqlOptions:J}}}),[S,J,w]);Object(i.useEffect)((()=>{let e=!1;return u&&!e&&u(HO.a.defineRule,ne),()=>{e=!0}}),[ne,u]);const ie=Object(i.useCallback)((()=>{x().index.setValue(E)}),[x,E]),re=Object(i.useCallback)((()=>{x().threatIndex.setValue(v)}),[x,v]),se=Object(i.useCallback)((()=>{g(!0)}),[]),oe=Object(i.useCallback)((()=>{g(!1)}),[]),le=Object(i.useCallback)((({thresholdField:e,thresholdValue:t,thresholdCardinalityField:a,thresholdCardinalityValue:n})=>r.a.createElement(tI,{browserFields:Y,thresholdField:e,thresholdValue:t,thresholdCardinalityField:a,thresholdCardinalityValue:n})),[Y]),ce=Object(i.useCallback)((({threatMapping:e})=>r.a.createElement(iM,{handleResetThreatIndices:re,indexPatterns:K,threatBrowserFields:ee,threatIndexModified:h,threatIndexPatterns:te,threatIndexPatternsLoading:Z,threatMapping:e,onValidityChange:B})),[re,K,ee,h,te,Z]),ue=Object(i.useCallback)(((e,t)=>{X((a=>({...a,[e]:t})))}),[]),de=Object(i.useMemo)((()=>Object(fn.isEmpty)(K.fields)?{keywordFields:[],dateFields:[],nonDateFields:[]}:{keywordFields:K.fields.filter((e=>{var t;return null===(t=e.esTypes)||void 0===t?void 0:t.includes("keyword")})).map((e=>({label:e.name}))),dateFields:K.fields.filter((e=>"date"===e.type)).map((e=>({label:e.name}))),nonDateFields:K.fields.filter((e=>"date"!==e.type)).map((e=>({label:e.name})))}),[K]);return n?r.a.createElement(Oj,{"data-test-subj":"definitionRule",addPadding:e},r.a.createElement(vj,{columns:a,indexPatterns:K,schema:Kj(rI,V),data:Kj(T,V)})):r.a.createElement(r.a.Fragment,null,r.a.createElement(Oj,{addPadding:!l},r.a.createElement(oS.c,{form:k,"data-test-subj":"stepDefineRule"},r.a.createElement(oS.e,{path:"ruleType",component:SC,componentProps:{describedByIds:["detectionEngineStepDefineRuleType"],isUpdateView:l,hasValidLicense:Object(bp.a)(p),isMlAdmin:Object(fp.a)(p)}}),r.a.createElement(pA,{$isVisible:!Object(lu.d)(V),fullWidth:!0},r.a.createElement(r.a.Fragment,null,r.a.createElement(oA,{path:"index",config:{...rI.index,labelAppend:f?r.a.createElement(dA,{onClick:ie,iconType:"refresh"},MC):null},componentProps:{idAria:"detectionEngineStepDefineRuleIndices","data-test-subj":"detectionEngineStepDefineRuleIndices",euiFieldProps:{fullWidth:!0,placeholder:""}}}),Object(zn.b)(V)?r.a.createElement(oS.e,{key:"EqlQueryBar",path:"queryBar",component:sI.a,componentProps:{optionsData:de,optionsSelected:J,isSizeOptionDisabled:!0,onOptionsChange:ue,onValidityChange:F,idAria:"detectionEngineStepDefineRuleEqlQueryBar",isDisabled:s,isLoading:W,dataTestSubj:"detectionEngineStepDefineRuleEqlQueryBar"},config:{...rI.queryBar,label:PC}}):r.a.createElement(oS.e,{key:"QueryBarDefineRule",path:"queryBar",config:{...rI.queryBar,label:qC,labelAppend:r.a.createElement(dA,{"data-test-subj":"importQueryFromSavedTimeline",onClick:se},AC)},component:uC,componentProps:{browserFields:G,idAria:"detectionEngineStepDefineRuleQueryBar",indexPattern:K,isDisabled:s,isLoading:W,dataTestSubj:"detectionEngineStepDefineRuleQueryBar",openTimelineSearch:m,onValidityChange:F,onCloseTimelineSearch:oe}}))),r.a.createElement(pA,{$isVisible:Object(lu.d)(V),fullWidth:!0},r.a.createElement(r.a.Fragment,null,r.a.createElement(oS.e,{path:"machineLearningJobId",component:VC,componentProps:{describedByIds:["detectionEngineStepDefineRulemachineLearningJobId"]}}),r.a.createElement(oS.e,{path:"anomalyThreshold",component:OC,componentProps:{describedByIds:["detectionEngineStepDefineRuleAnomalyThreshold"]}}))),r.a.createElement(pA,{$isVisible:Object(zn.e)(V),"data-test-subj":"thresholdInput",fullWidth:!0},r.a.createElement(r.a.Fragment,null,r.a.createElement(oS.f,{fields:{thresholdField:{path:"threshold.field"},thresholdValue:{path:"threshold.value"},thresholdCardinalityField:{path:"threshold.cardinality.field"},thresholdCardinalityValue:{path:"threshold.cardinality.value"}}},le))),r.a.createElement(pA,{$isVisible:Object(zn.d)(V),"data-test-subj":"threatMatchInput",fullWidth:!0},r.a.createElement(r.a.Fragment,null,r.a.createElement(oS.f,{fields:{threatMapping:{path:"threatMapping"}}},ce))),r.a.createElement(oS.e,{path:"timeline",component:wS,componentProps:{idAria:"detectionEngineStepDefineRuleTimeline",isDisabled:s,dataTestSubj:"detectionEngineStepDefineRuleTimeline"}})),r.a.createElement(N.EuiSpacer,{size:"s"}),r.a.createElement(sA,{index:z,isDisabled:DM({ruleType:V,isQueryBarValid:_,isThreatQueryBarValid:L,index:z,threatIndex:U,threatMapping:q,machineLearningJobId:H,queryBar:null!=I?I:T.queryBar}),query:I,ruleType:V,threatIndex:U,threatQuery:A,threatMapping:q,threshold:D,machineLearningJobId:H,anomalyThreshold:$,eqlOptions:J})),!l&&r.a.createElement(QC,{dataTestSubj:"define-continue",onClick:ae,isDisabled:s}))},gA=Object(i.memo)(mA),fA=z()(N.EuiFormRow).withConfig({displayName:"MyEuiFormRow",componentId:"sc-1urlknr-0"})([".euiFormRow__labelWrapper{.euiText{padding-right:32px;}}"]),bA=z()(N.EuiButtonEmpty).withConfig({displayName:"MyAddItemButton",componentId:"sc-1urlknr-1"})(["margin:4px 0px;&.euiButtonEmpty--small{font-size:12px;}.euiIcon{width:12px;height:12px;}"]);bA.defaultProps={flush:"left",iconType:"plusInCircle",size:"s"};const hA=({addText:e,dataTestSubj:t,field:a,idAria:n,isDisabled:s,validate:o})=>{const[l,c]=Object(i.useState)(!1),{isInvalid:u,errorMessage:d}=Object(oS.i)(a),[p,m]=Object(i.useState)(-1),g=Object(i.useRef)([]),f=Object(i.useCallback)((e=>{const t=a.value,n=[...t.slice(0,e),...t.slice(e+1)];a.setValue(0===n.length?[""]:n),g.current=[...g.current.slice(0,e),...g.current.slice(e+1)],g.current=g.current.map(((t,a)=>(a>=e&&null!=g.current[e]&&(t.value="re-render"),t)))}),[a]),b=Object(i.useCallback)((()=>{const e=a.value;a.setValue([...e,""])}),[a]),h=Object(i.useCallback)(((e,t)=>{e.persist();const n=a.value,i=e.target.value;a.setValue([...n.slice(0,t),i,...n.slice(t+1)])}),[a]),y=Object(i.useCallback)(((e,t)=>{null!=t&&(g.current=[...g.current.slice(0,e),t,...g.current.slice(e+1)])}),[g]);Object(i.useEffect)((()=>{-1===p||Object(E.isEmpty)(g.current)||null==g.current[p]||(g.current[p].focus(),m(-1))}),[p,g.current]);const v=a.value;return r.a.createElement(fA,{label:a.label,labelAppend:a.labelAppend,error:l?d:null,isInvalid:l&&u,fullWidth:!0,"data-test-subj":t,describedByIds:n?[n]:void 0},r.a.createElement(r.a.Fragment,null,v.map(((e,t)=>{const a={disabled:s,...t===v.length-1?{inputRef:y.bind(null,t)}:{},value:e,isInvalid:null!=o&&l&&o(e)};return r.a.createElement("div",{key:t},r.a.createElement(N.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},r.a.createElement(N.EuiFlexItem,{grow:!0},r.a.createElement(N.EuiFieldText,rr()({onBlur:()=>c(!0),onChange:e=>h(e,t),fullWidth:!0},a))),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiButtonIcon,{color:"danger",iconType:"trash",isDisabled:s||Object(E.isEmpty)(e)&&1===v.length,onClick:()=>f(t),"aria-label":nn.mb}))),v.length-1!==t&&r.a.createElement(N.EuiSpacer,{size:"s"}))})),r.a.createElement(bA,{onClick:b,isDisabled:s},e)))},yA=F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.threatsDescription",{defaultMessage:"threats"}),EA=F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.tacticsDescription",{defaultMessage:"tactic"}),vA=F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.techniquesDescription",{defaultMessage:"technique"}),TA=F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.subtechniquesDescription",{defaultMessage:"subtechnique"}),kA=F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.addTacticTitle",{defaultMessage:"Add tactic"}),xA=F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.addTechniqueTitle",{defaultMessage:"Add technique"}),SA=F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.addSubtechniqueTitle",{defaultMessage:"Add subtechnique"}),OA=F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.tacticPlaceHolderDescription",{defaultMessage:"Select a tactic ..."}),wA=F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.techniquePlaceHolderDescription",{defaultMessage:"Select a technique ..."}),jA=F.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.subtechniquePlaceHolderDescription",{defaultMessage:"Select a subtechnique ..."}),CA=e=>Sw.some((t=>t.techniqueId===e.id)),IA=z.a.div.withConfig({displayName:"SubtechniqueContainer",componentId:"sc-1cb5h5o-0"})(["margin-left:48px;"]),MA=({field:e,idAria:t,isDisabled:a,threatIndex:n,techniqueIndex:s,onFieldChange:o})=>{const l=e.value,c=Object(i.useMemo)((()=>{var e;return[...null!==(e=l[n].technique)&&void 0!==e?e:[]]}),[l,n]),u=Object(i.useCallback)((t=>{var a;const i=[...e.value],r=null!==(a=c[s].subtechnique)&&void 0!==a?a:[];null!=r&&(r.splice(t,1),c[s]={...c[s],subtechnique:r},i[n].technique=c,o(i))}),[e,o,s,c,n]),d=Object(i.useCallback)((()=>{const t=[...e.value],a=c[s].subtechnique;c[s]=null!=a?{...c[s],subtechnique:[...a,{id:"none",name:"none",reference:"none"}]}:{...c[s],subtechnique:[{id:"none",name:"none",reference:"none"}]},t[n].technique=c,o(t)}),[e,o,s,c,n]),p=Object(i.useCallback)(((t,a)=>{const i=[...e.value],{id:r,reference:l,name:u}=Sw.find((e=>e.value===a))||{id:"",name:"",reference:""},d=c[s].subtechnique;null!=d&&o([...i.slice(0,n),{...i[n],technique:[...c.slice(0,s),{...c[s],subtechnique:[...d.slice(0,t),{id:r,reference:l,name:u},...d.slice(t+1)]},...c.slice(s+1)]},...i.slice(n+1)])}),[n,s,o,e,c]),m=Object(i.useCallback)(((t,a,n)=>{const i=Sw.filter((e=>e.techniqueId===c[s].id));return r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiSuperSelect,{id:"mitreAttackSubtechnique",options:[..."none"===n.name?[{inputDisplay:r.a.createElement(r.a.Fragment,null,jA),value:"none",disabled:a}]:[],...i.map((e=>({inputDisplay:r.a.createElement(r.a.Fragment,null,e.label),value:e.value,disabled:a})))],prepend:`${e.label} ${TA}`,"aria-label":"",onChange:p.bind(null,t),fullWidth:!0,valueOfSelected:Object(E.camelCase)(n.name),"data-test-subj":"mitreAttackSubtechnique",disabled:a,placeholder:jA}))}),[e,p,c,s]),g=Object(i.useMemo)((()=>c[s].subtechnique),[c,s]);return r.a.createElement(IA,null,null!=g&&g.map(((e,n)=>r.a.createElement("div",{key:n},r.a.createElement(N.EuiSpacer,{size:"s"}),r.a.createElement(N.EuiFormRow,{fullWidth:!0,describedByIds:t?[`${t} ${TA}`]:void 0},r.a.createElement(N.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},r.a.createElement(N.EuiFlexItem,{grow:!0},m(n,a,e)),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiButtonIcon,{color:"danger",iconType:"trash",isDisabled:a,onClick:()=>u(n),"aria-label":nn.mb}))))))),r.a.createElement(bA,{"data-test-subj":"addMitreAttackSubtechnique",onClick:d,isDisabled:a},SA))},AA=z.a.div.withConfig({displayName:"TechniqueContainer",componentId:"sc-1fugnao-0"})(["",""],(({theme:e})=>Object(B.css)(["margin-left:24px;padding-left:24px;border-left:2px solid ",";"],e.eui.euiColorLightestShade))),DA=({field:e,idAria:t,isDisabled:a,threatIndex:n,onFieldChange:s})=>{var o;const l=e.value,c=Object(i.useCallback)((t=>{var a;const i=[...e.value],r=null!==(a=i[n].technique)&&void 0!==a?a:[];r.splice(t,1),i[n]={...i[n],technique:r},s(i)}),[e,n,s]),u=Object(i.useCallback)((()=>{var t;const a=[...e.value];a[n]={...a[n],technique:[...null!==(t=a[n].technique)&&void 0!==t?t:[],{id:"none",name:"none",reference:"none",subtechnique:[]}]},s(a)}),[e,n,s]),d=Object(i.useCallback)(((t,a)=>{var i;const r=[...e.value],{id:o,reference:l,name:c}=xw.find((e=>e.value===a))||{id:"",name:"",reference:""},u=null!==(i=r[n].technique)&&void 0!==i?i:[];s([...r.slice(0,n),{...r[n],technique:[...u.slice(0,t),{id:o,reference:l,name:c,subtechnique:[]},...u.slice(t+1)]},...r.slice(n+1)])}),[n,s,e]),p=Object(i.useCallback)(((t,a,n,i)=>{const s=xw.filter((e=>e.tactics.includes(Object(E.kebabCase)(t))));return r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiSuperSelect,{id:"mitreAttackTechnique",options:[..."none"===i.name?[{inputDisplay:r.a.createElement(r.a.Fragment,null,wA),value:"none",disabled:n}]:[],...s.map((e=>({inputDisplay:r.a.createElement(r.a.Fragment,null,e.label),value:e.value,disabled:n})))],prepend:`${e.label} ${vA}`,"aria-label":"",onChange:d.bind(null,a),fullWidth:!0,valueOfSelected:Object(E.camelCase)(i.name),"data-test-subj":"mitreAttackTechnique",disabled:n,placeholder:wA}))}),[e,d]),m=null!==(o=l[n].technique)&&void 0!==o?o:[];return r.a.createElement(AA,null,m.map(((i,o)=>r.a.createElement("div",{key:o},r.a.createElement(N.EuiSpacer,{size:"s"}),r.a.createElement(N.EuiFormRow,{fullWidth:!0,describedByIds:t?[`${t} ${vA}`]:void 0},r.a.createElement(N.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},r.a.createElement(N.EuiFlexItem,{grow:!0},p(l[n].tactic.name,o,a,i)),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiButtonIcon,{color:"danger",iconType:"trash",isDisabled:a,onClick:()=>c(o),"aria-label":nn.mb})))),r.a.createElement(MA,{field:e,idAria:t,isDisabled:a||"none"===i.name||!1===CA(i),threatIndex:n,techniqueIndex:o,onFieldChange:s})))),r.a.createElement(bA,{"data-test-subj":"addMitreAttackTechnique",onClick:u,isDisabled:a},xA))},qA=z.a.div.withConfig({displayName:"MitreAttackContainer",componentId:"sc-bsl0gv-0"})(["margin-top:16px;"]),PA=z()(N.EuiFormRow).withConfig({displayName:"InitialMitreAttackFormRow",componentId:"sc-bsl0gv-1"})([".euiFormRow__labelWrapper{.euiText{padding-right:32px;}}"]),RA=Object(i.memo)((({field:e,idAria:t,isDisabled:a})=>{const n=Object(i.useCallback)((t=>{const a=[...e.value];a.splice(t,1),Object(E.isEmpty)(a)?e.setValue(NO):e.setValue(a)}),[e]),s=Object(i.useCallback)((()=>{const t=[...e.value];Object(E.isEmpty)(t[t.length-1])?e.setValue([{tactic:{id:"none",name:"none",reference:"none"},technique:[]}]):e.setValue([...t,{tactic:{id:"none",name:"none",reference:"none"},technique:[]}])}),[e]),o=Object(i.useCallback)(((t,a)=>{const n=[...e.value],{id:i,reference:r,name:s}=kw.find((e=>e.value===a))||{id:"",name:"",reference:""};n.splice(t,1,{...n[t],tactic:{id:i,reference:r,name:s},technique:[]}),e.setValue([...n])}),[e]),l=Object(i.useMemo)((()=>[...e.value]),[e]),c=Object(i.useCallback)(((t,i,s)=>{const c=t.tactic.name;return r.a.createElement(N.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},r.a.createElement(N.EuiFlexItem,{grow:!0},r.a.createElement(N.EuiSuperSelect,{id:"mitreAttackTactic",options:[..."none"===c?[{inputDisplay:r.a.createElement(r.a.Fragment,null,OA),value:"none",disabled:s}]:[],...kw.map((e=>({inputDisplay:r.a.createElement(r.a.Fragment,null,e.text),value:e.value,disabled:s})))],prepend:`${e.label} ${EA}`,"aria-label":"",onChange:o.bind(null,i),fullWidth:!0,valueOfSelected:Object(E.camelCase)(c),"data-test-subj":"mitreAttackTactic",placeholder:OA})),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiButtonIcon,{color:"danger",iconType:"trash",isDisabled:a||Object(fn.isEqual)(l,NO),onClick:()=>n(i),"aria-label":nn.mb})))}),[e,a,n,o,l]),u=Object(i.useCallback)((t=>{e.setValue(t)}),[e]);return r.a.createElement(qA,null,l.map(((n,i)=>r.a.createElement("div",{key:i},0===i?r.a.createElement(PA,{fullWidth:!0,label:`${e.label} ${yA}`,labelAppend:e.labelAppend,describedByIds:t?[`${t} ${EA}`]:void 0},r.a.createElement(r.a.Fragment,null,c(n,i,a))):r.a.createElement(N.EuiFormRow,{fullWidth:!0,describedByIds:t?[`${t} ${EA}`]:void 0},c(n,i,a)),r.a.createElement(DA,{field:e,threatIndex:i,isDisabled:a||"none"===n.tactic.name,idAria:t,onFieldChange:u})))),r.a.createElement(bA,{"data-test-subj":"addMitreAttackTactic",onClick:s,isDisabled:a},kA))})),_A=r.a.createElement(N.EuiText,{color:"subdued",size:"xs"},nn.Lb),{emptyField:FA}=oS.h,LA={author:{type:oS.a.COMBO_BOX,label:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldAuthorLabel",{defaultMessage:"Author"}),helpText:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldAuthorHelpText",{defaultMessage:"Type one or more authors for this rule. Press enter after each author to add a new one."}),labelAppend:_A,validations:[{validator:FA(F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.authorFieldEmptyError",{defaultMessage:"An author must not be empty"})),type:oS.g.ARRAY_ITEM,isBlocking:!1}]},name:{type:oS.a.TEXT,label:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldNameLabel",{defaultMessage:"Name"}),validations:[{validator:FA(F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.nameFieldRequiredError",{defaultMessage:"A name is required."}))}]},description:{type:oS.a.TEXTAREA,label:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldDescriptionLabel",{defaultMessage:"Description"}),validations:[{validator:FA(F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.descriptionFieldRequiredError",{defaultMessage:"A description is required."}))}]},isBuildingBlock:{type:oS.a.CHECKBOX,label:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldBuildingBlockLabel",{defaultMessage:'Mark all generated alerts as "building block" alerts'}),labelAppend:_A},isAssociatedToEndpointList:{type:oS.a.CHECKBOX,label:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldAssociatedToEndpointListLabel",{defaultMessage:"Add existing Endpoint exceptions to the rule"}),labelAppend:_A},severity:{value:{},mapping:{},isMappingChecked:{}},riskScore:{value:{},mapping:{},isMappingChecked:{}},references:{label:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldReferenceUrlsLabel",{defaultMessage:"Reference URLs"}),labelAppend:_A,validations:[{validator:(...e)=>{const[{value:t,path:a}]=e;let n=!1;return t.forEach((e=>{Object(wk.c)(e)&&(n=!0)})),n?{code:"ERR_FIELD_FORMAT",path:a,message:ei}:void 0}}]},falsePositives:{label:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldFalsePositiveLabel",{defaultMessage:"False positive examples"}),labelAppend:_A},license:{type:oS.a.TEXT,label:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldLicenseLabel",{defaultMessage:"License"}),helpText:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldLicenseHelpText",{defaultMessage:"Add a license name"}),labelAppend:_A},ruleNameOverride:{type:oS.a.TEXT,label:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRuleNameOverrideLabel",{defaultMessage:"Rule name override"}),helpText:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRuleNameOverrideHelpText",{defaultMessage:"Choose a field from the source event to populate the rule name in the alert list."}),labelAppend:_A},threat:{label:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldMitreThreatLabel",{defaultMessage:"MITRE ATT&CK\\u2122"}),labelAppend:_A},threatIndicatorPath:{type:oS.a.TEXT,label:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThreatIndicatorPathLabel",{defaultMessage:"Indicator prefix override"}),helpText:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThreatIndicatorPathHelpText",{defaultMessage:"Specify the document prefix containing your indicator fields. Used for enrichment of indicator match alerts."}),labelAppend:_A},timestampOverride:{type:oS.a.TEXT,label:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimestampOverrideLabel",{defaultMessage:"Timestamp override"}),helpText:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimestampOverrideHelpText",{defaultMessage:"Choose timestamp field used when executing rule. Pick field with timestamp closest to ingest time (e.g. event.ingested)."}),labelAppend:_A},tags:{type:oS.a.COMBO_BOX,label:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTagsLabel",{defaultMessage:"Tags"}),helpText:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTagsHelpText",{defaultMessage:"Type one or more custom identifying tags for this rule. Press enter after each tag to begin a new one."}),labelAppend:_A,validations:[{validator:FA(F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.tagFieldEmptyError",{defaultMessage:"A tag must not be empty"})),type:oS.g.ARRAY_ITEM,isBlocking:!1}]},note:{type:oS.a.TEXTAREA,label:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.guideLabel",{defaultMessage:"Investigation guide"}),helpText:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.guideHelpText",{defaultMessage:"Provide helpful information for analysts that are investigating detection alerts. This guide will appear on the rule details page and in timelines (as notes) created from detection alerts generated by this rule."}),labelAppend:_A}},NA={type:oS.a.TEXT,label:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThreatIndicatorPathLabel",{defaultMessage:"Indicator prefix override"}),helpText:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThreatIndicatorPathHelpText",{defaultMessage:"Specify the document prefix containing your indicator fields. Used for enrichment of indicator match alerts."}),validations:[{validator:FA(F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.threatIndicatorPathFieldEmptyError",{defaultMessage:"Indicator prefix override must not be empty"})),type:oS.g.FIELD}]};var BA=a(532);const zA=z.a.div.withConfig({displayName:"NestedContent",componentId:"sc-1o9f6e3-0"})(["margin-left:24px;"]),UA=z()(N.EuiFlexItem).withConfig({displayName:"EuiFlexItemComboBoxColumn",componentId:"sc-1o9f6e3-1"})(["max-width:376px;"]),HA=z()(N.EuiFlexItem).withConfig({displayName:"EuiFlexItemIconColumn",componentId:"sc-1o9f6e3-2"})(["width:20px;"]),$A=z()(N.EuiFlexItem).withConfig({displayName:"EuiFlexItemSeverityColumn",componentId:"sc-1o9f6e3-3"})(["width:80px;"]),VA=({dataTestSubj:e,field:t,idAria:a,indices:n,isDisabled:s,options:o})=>{const{services:l}=Object(d.j)(),{value:c,isMappingChecked:u,mapping:p}=t.value,{setValue:m}=t,g=Object(i.useCallback)(((e,t)=>{m({value:c,isMappingChecked:u,mapping:[...p.slice(0,t),...e,...p.slice(t+1)]})}),[c,u,p,m]),f=Object(i.useCallback)(((e,t,[a])=>{var n;const i=[{...p[e],field:null!==(n=null==a?void 0:a.name)&&void 0!==n?n:"",value:null!=a?p[e].value:"",operator:"equals",severity:t}];g(i,e)}),[p,g]),b=Object(i.useCallback)((e=>{m({value:e,isMappingChecked:u,mapping:p})}),[u,p,m]),h=Object(i.useCallback)(((e,t,a)=>{const n=[{...p[e],field:p[e].field,value:null!=p[e].field&&""!==p[e].field?a:"",operator:"equals",severity:t}];g(n,e)}),[p,g]),y=Object(i.useCallback)((()=>{m({value:c,mapping:[...p],isMappingChecked:!u})}),[u,p,c,m]),v=Object(i.useMemo)((()=>r.a.createElement("div",null,r.a.createElement(N.EuiFlexGroup,{gutterSize:"s"},r.a.createElement(N.EuiFlexItem,null,sw)),r.a.createElement(N.EuiSpacer,{size:"xs"}),r.a.createElement(N.EuiText,{size:"xs"},dw))),[]),T=Object(i.useMemo)((()=>r.a.createElement("div",null,r.a.createElement(N.EuiFlexGroup,{alignItems:"center",gutterSize:"s",onClick:s?E.noop:y},r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiCheckbox,{id:"severity-mapping-override",checked:u,disabled:s,onChange:y})),r.a.createElement(N.EuiFlexItem,null,uw)),r.a.createElement(N.EuiSpacer,{size:"xs"}),r.a.createElement(zA,null,r.a.createElement(N.EuiText,{size:"xs"},pw)))),[y,s,u]);return r.a.createElement(N.EuiFlexGroup,{direction:"column"},r.a.createElement(N.EuiFlexItem,null,r.a.createElement(N.EuiFormRow,{label:v,labelAppend:t.labelAppend,helpText:t.helpText,error:"errorMessage",isInvalid:!1,fullWidth:!0,"data-test-subj":"detectionEngineStepAboutRuleSeverity",describedByIds:["detectionEngineStepAboutRuleSeverity"]},r.a.createElement(N.EuiSuperSelect,{fullWidth:!1,disabled:!1,valueOfSelected:c,onChange:b,options:o,"data-test-subj":"select"}))),r.a.createElement(N.EuiFlexItem,null,r.a.createElement(N.EuiFormRow,{label:T,labelAppend:t.labelAppend,helpText:u?r.a.createElement(zA,null,mw):"",error:"errorMessage",isInvalid:!1,fullWidth:!0,"data-test-subj":`${e}-severityOverride`,describedByIds:a?[a]:void 0},r.a.createElement(zA,null,r.a.createElement(N.EuiSpacer,{size:"s"}),u&&r.a.createElement(N.EuiFlexGroup,{direction:"column",gutterSize:"s"},r.a.createElement(N.EuiFlexItem,null,r.a.createElement(N.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},r.a.createElement(UA,null,r.a.createElement(N.EuiFormLabel,null,lw)),r.a.createElement(UA,null,r.a.createElement(N.EuiFormLabel,null,cw)),r.a.createElement(HA,{grow:!1}),r.a.createElement($A,{grow:!1},r.a.createElement(N.EuiFormLabel,null,ow)))),p.map(((e,t)=>{var a;return r.a.createElement(N.EuiFlexItem,{key:`${e.severity}-${t}`},r.a.createElement(N.EuiFlexGroup,{"data-test-subj":"severityOverrideRow",alignItems:"center",gutterSize:"s"},r.a.createElement(UA,null,r.a.createElement(hI,{placeholder:"",selectedField:QA(e,n),isLoading:!1,isDisabled:s,isClearable:!1,indexPattern:n,onChange:f.bind(null,t,e.severity),"data-test-subj":`detectionEngineStepAboutRuleSeverityMappingField-${e.severity}-${t}`,"aria-label":`detectionEngineStepAboutRuleSeverityMappingField-${e.severity}-${t}`})),r.a.createElement(UA,null,r.a.createElement(RI,{autocompleteService:l.unifiedSearch.autocomplete,placeholder:"",selectedField:QA(e,n),selectedValue:e.value,isClearable:!1,isDisabled:s,isLoading:!1,indexPattern:n,onChange:h.bind(null,t,e.severity),"data-test-subj":`detectionEngineStepAboutRuleSeverityMappingValue-${e.severity}-${t}`,"aria-label":`detectionEngineStepAboutRuleSeverityMappingValue-${e.severity}-${t}`})),r.a.createElement(HA,{grow:!1},r.a.createElement(N.EuiIcon,{type:"sortRight"})),r.a.createElement($A,{grow:!1},null===(a=o.find((t=>t.value===e.severity)))||void 0===a?void 0:a.inputDisplay)))})))))))},QA=(e,t)=>{const{field:a}=e,[n]=t.fields.filter((({name:e})=>a===e));return null!=n?n:{name:a,type:"string"}},WA=z.a.div.withConfig({displayName:"NestedContent",componentId:"sc-1k1nimg-0"})(["margin-left:24px;"]),GA=z()(N.EuiFlexItem).withConfig({displayName:"EuiFlexItemComboBoxColumn",componentId:"sc-1k1nimg-1"})(["max-width:376px;"]),KA=z()(N.EuiFlexItem).withConfig({displayName:"EuiFlexItemIconColumn",componentId:"sc-1k1nimg-2"})(["width:20px;"]),YA=z()(N.EuiFlexItem).withConfig({displayName:"EuiFlexItemRiskScoreColumn",componentId:"sc-1k1nimg-3"})(["width:160px;"]),JA=({dataTestSubj:e,field:t,idAria:a,indices:n,isDisabled:s,placeholder:o})=>{const{value:l,isMappingChecked:c,mapping:u}=t.value,{setValue:d}=t,p=Object(i.useMemo)((()=>["number"]),[]),m=Object(i.useMemo)((()=>XA(u,n)),[u,n]),g=Object(i.useCallback)((e=>{const t=e.target.value;d({value:Number(t.trim()),isMappingChecked:c,mapping:u})}),[d,c,u]),f=Object(i.useCallback)((([e])=>{var t;d({value:l,isMappingChecked:c,mapping:[{field:null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"",operator:"equals",value:"",risk_score:void 0}]})}),[d,l,c]),b=Object(i.useCallback)((()=>{d({value:l,isMappingChecked:!c,mapping:[...u]})}),[d,l,c,u]),h=Object(i.useMemo)((()=>r.a.createElement("div",null,r.a.createElement(N.EuiFlexGroup,{gutterSize:"s"},r.a.createElement(N.EuiFlexItem,null,fw)),r.a.createElement(N.EuiSpacer,{size:"xs"}),r.a.createElement(N.EuiText,{size:"xs"},Ew))),[]),y=Object(i.useMemo)((()=>r.a.createElement("div",null,r.a.createElement(N.EuiFlexGroup,{alignItems:"center",gutterSize:"s",onClick:s?E.noop:b},r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiCheckbox,{id:"risk_score-mapping-override",checked:c,disabled:s,onChange:b})),r.a.createElement(N.EuiFlexItem,null,yw)),r.a.createElement(N.EuiSpacer,{size:"xs"}),r.a.createElement(WA,null,r.a.createElement(N.EuiText,{size:"xs"},vw)))),[c,b,s]);return r.a.createElement(N.EuiFlexGroup,{direction:"column"},r.a.createElement(N.EuiFlexItem,null,r.a.createElement(N.EuiFormRow,{label:h,labelAppend:t.labelAppend,helpText:t.helpText,error:"errorMessage",isInvalid:!1,fullWidth:!0,"data-test-subj":`${e}-defaultRisk`,describedByIds:a?[a]:void 0},r.a.createElement(N.EuiRange,{value:l,onChange:g,max:100,min:0,showRange:!0,showInput:!0,fullWidth:!1,showTicks:!0,tickInterval:25,"data-test-subj":`${e}-defaultRiskRange`}))),r.a.createElement(N.EuiFlexItem,null,r.a.createElement(N.EuiFormRow,{label:y,labelAppend:t.labelAppend,helpText:c?r.a.createElement(WA,null,Tw):"",error:"errorMessage",isInvalid:!1,fullWidth:!0,"data-test-subj":`${e}-riskOverride`,describedByIds:a?[a]:void 0},r.a.createElement(WA,null,r.a.createElement(N.EuiSpacer,{size:"s"}),c&&r.a.createElement(N.EuiFlexGroup,{direction:"column",gutterSize:"s"},r.a.createElement(N.EuiFlexItem,null,r.a.createElement(N.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},r.a.createElement(GA,null,r.a.createElement(N.EuiFormLabel,null,hw)),r.a.createElement(KA,{grow:!1}),r.a.createElement(YA,{grow:!1},r.a.createElement(N.EuiFormLabel,null,fw)))),r.a.createElement(N.EuiFlexItem,null,r.a.createElement(N.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},r.a.createElement(GA,null,r.a.createElement(hI,{placeholder:null!=o?o:"",indexPattern:n,selectedField:m,fieldTypeFilter:p,isLoading:!1,isClearable:!1,isDisabled:s,onChange:f,"data-test-subj":e,"aria-label":a})),r.a.createElement(KA,{grow:!1},r.a.createElement(N.EuiIcon,{type:"sortRight"})),r.a.createElement(YA,{grow:!1},r.a.createElement(N.EuiText,{size:"s"},bw)))))))))},XA=(e,t)=>{var a,n;const i=null!==(a=null==e||null===(n=e[0])||void 0===n?void 0:n.field)&&void 0!==a?a:"",[r]=t.fields.filter((({name:e})=>null!=i&&i===e));return null!=r?r:{name:i,type:"number"}},ZA=({dataTestSubj:e,field:t,idAria:a,indices:n,isDisabled:s,fieldType:o,placeholder:l})=>{const c=Object(i.useCallback)((([e])=>{var a;t.setValue(null!==(a=null==e?void 0:e.name)&&void 0!==a?a:"")}),[t]),u=Object(i.useMemo)((()=>{var e;const a=null!==(e=t.value)&&void 0!==e?e:"",[i]=n.fields.filter((({name:e})=>null!=a&&a===e));return i}),[t.value,n]),d=Object(i.useMemo)((()=>[o]),[o]);return r.a.createElement(N.EuiFormRow,{"data-test-subj":e,describedByIds:a?[a]:void 0,fullWidth:!0,helpText:t.helpText,label:t.label,labelAppend:t.labelAppend},r.a.createElement(hI,{placeholder:null!=l?l:"",indexPattern:n,selectedField:u,fieldTypeFilter:d,isLoading:!1,isDisabled:s,isClearable:!1,onChange:c,"data-test-subj":e,"aria-label":a,fieldInputWidth:500}))},eD=Object(oS.j)({component:oS.b});z.a.div.withConfig({displayName:"ThreeQuartersContainer",componentId:"sc-1nsr0kk-0"})(["max-width:740px;"]).displayName="ThreeQuartersContainer";const tD=z.a.div.withConfig({displayName:"TagContainer",componentId:"sc-1nsr0kk-1"})(["margin-top:16px;"]);tD.displayName="TagContainer";const aD=({addPadding:e=!1,defaultValues:t,defineRuleData:a,descriptionColumns:n="singleSplit",isReadOnlyView:s,isUpdateView:l=!1,isLoading:c,onSubmit:u,setForm:d})=>{var p;const m=Object(i.useMemo)((()=>Object(zn.d)(null==a?void 0:a.ruleType)),[null==a?void 0:a.ruleType]),g=Object(i.useMemo)((()=>null!=t?t:m?{...BO,threatIndicatorPath:o.P}:BO),[t,m]),f=Object(i.useMemo)((()=>m?{...LA,threatIndicatorPath:NA}:LA),[m]),[b,h]=Object(i.useState)(g.severity.value),[y,{indexPatterns:E}]=Object(EE.b)(null!==(p=null==a?void 0:a.index)&&void 0!==p?p:[]),{form:v}=Object(oS.k)({defaultValue:g,options:{stripEmptyFields:!1},schema:f}),{getFields:T,getFormData:k,submit:x}=v,[{severity:S}]=Object(oS.m)({form:v,watch:["severity"]});Object(i.useEffect)((()=>{const e=null==S?void 0:S.value;if(null!=e&&e!==b){h(e);const t=ii[e];if(null!=t){const e=T().riskScore;e.setValue({...e.value,value:t})}}}),[null==S?void 0:S.value,T,b]);const O=Object(i.useCallback)((async()=>{const e=await x();return null!=e&&e.isValid?e:{isValid:!1,data:k()}}),[k,x]),w=Object(i.useCallback)((()=>{u&&u()}),[u]);return Object(i.useEffect)((()=>{let e=!1;return d&&!e&&d(HO.a.aboutRule,O),()=>{e=!0}}),[O,d]),s?r.a.createElement(Oj,{"data-test-subj":"aboutStep",addPadding:e},r.a.createElement(vj,{columns:n,schema:f,data:g})):r.a.createElement(r.a.Fragment,null,r.a.createElement(Oj,{addPadding:!l},r.a.createElement(oS.c,{form:v},r.a.createElement(eD,{path:"name",componentProps:{idAria:"detectionEngineStepAboutRuleName","data-test-subj":"detectionEngineStepAboutRuleName",euiFieldProps:{fullWidth:!0,disabled:c}}}),r.a.createElement(N.EuiSpacer,{size:"l"}),r.a.createElement(eD,{path:"description",componentProps:{idAria:"detectionEngineStepAboutRuleDescription","data-test-subj":"detectionEngineStepAboutRuleDescription",euiFieldProps:{disabled:c,compressed:!0,fullWidth:!0}}}),r.a.createElement(N.EuiSpacer,{size:"l"}),r.a.createElement(N.EuiFlexItem,null,r.a.createElement(oS.e,{path:"severity",component:VA,componentProps:{dataTestSubj:"detectionEngineStepAboutRuleSeverityField",idAria:"detectionEngineStepAboutRuleSeverityField",isDisabled:c||y,options:ni,indices:E}})),r.a.createElement(N.EuiSpacer,{size:"l"}),r.a.createElement(N.EuiFlexItem,null,r.a.createElement(eD,{path:"riskScore",component:JA,componentProps:{dataTestSubj:"detectionEngineStepAboutRuleRiskScore",idAria:"detectionEngineStepAboutRuleRiskScore",isDisabled:c||y,indices:E}})),r.a.createElement(tD,null,r.a.createElement(eD,{path:"tags",componentProps:{idAria:"detectionEngineStepAboutRuleTags","data-test-subj":"detectionEngineStepAboutRuleTags",euiFieldProps:{fullWidth:!0,isDisabled:c||y,placeholder:""}}})),r.a.createElement(N.EuiSpacer,{size:"l"}),r.a.createElement(N.EuiAccordion,{"data-test-subj":"advancedSettings",id:"advancedSettingsAccordion",buttonContent:Vn},r.a.createElement(N.EuiSpacer,{size:"l"}),r.a.createElement(oS.e,{path:"references",component:hA,componentProps:{addText:Qn,idAria:"detectionEngineStepAboutRuleReferenceUrls",isDisabled:c,dataTestSubj:"detectionEngineStepAboutRuleReferenceUrls",validate:wk.c}}),r.a.createElement(oS.e,{path:"falsePositives",component:hA,componentProps:{addText:Wn,idAria:"detectionEngineStepAboutRuleFalsePositives",isDisabled:c,dataTestSubj:"detectionEngineStepAboutRuleFalsePositives"}}),r.a.createElement(oS.e,{path:"threat",component:RA,componentProps:{idAria:"detectionEngineStepAboutRuleMitreThreat",isDisabled:c,dataTestSubj:"detectionEngineStepAboutRuleMitreThreat"}}),r.a.createElement(N.EuiSpacer,{size:"l"}),r.a.createElement(oS.e,{path:"note",component:BA.a,componentProps:{idAria:"detectionEngineStepAboutRuleNote",isDisabled:c,dataTestSubj:"detectionEngineStepAboutRuleNote",placeholder:ti}}),r.a.createElement(N.EuiSpacer,{size:"l"}),r.a.createElement(eD,{path:"author",componentProps:{idAria:"detectionEngineStepAboutRuleAuthor","data-test-subj":"detectionEngineStepAboutRuleAuthor",euiFieldProps:{fullWidth:!0,isDisabled:c,placeholder:""}}}),r.a.createElement(N.EuiSpacer,{size:"l"}),r.a.createElement(eD,{path:"license",componentProps:{idAria:"detectionEngineStepAboutRuleLicense","data-test-subj":"detectionEngineStepAboutRuleLicense",euiFieldProps:{fullWidth:!0,disabled:c,placeholder:""}}}),r.a.createElement(N.EuiSpacer,{size:"l"}),r.a.createElement(N.EuiFormRow,{label:Gn,fullWidth:!0},r.a.createElement(eD,{path:"isAssociatedToEndpointList",componentProps:{idAria:"detectionEngineStepAboutRuleAssociatedToEndpointList","data-test-subj":"detectionEngineStepAboutRuleAssociatedToEndpointList",euiFieldProps:{disabled:c}}})),r.a.createElement(N.EuiFormRow,{label:Kn,fullWidth:!0},r.a.createElement(eD,{path:"isBuildingBlock",componentProps:{idAria:"detectionEngineStepAboutRuleBuildingBlock","data-test-subj":"detectionEngineStepAboutRuleBuildingBlock",euiFieldProps:{disabled:c}}})),r.a.createElement(N.EuiSpacer,{size:"l"}),m&&r.a.createElement(r.a.Fragment,null,r.a.createElement(eD,{path:"threatIndicatorPath",componentProps:{idAria:"detectionEngineStepAboutThreatIndicatorPath","data-test-subj":"detectionEngineStepAboutThreatIndicatorPath",euiFieldProps:{fullWidth:!0,disabled:c,placeholder:o.P}}})),r.a.createElement(N.EuiSpacer,{size:"l"}),r.a.createElement(oS.e,{path:"ruleNameOverride",component:ZA,componentProps:{dataTestSubj:"detectionEngineStepAboutRuleRuleNameOverride",fieldType:"string",idAria:"detectionEngineStepAboutRuleRuleNameOverride",indices:E,isDisabled:c||y,placeholder:""}}),r.a.createElement(N.EuiSpacer,{size:"l"}),r.a.createElement(oS.e,{path:"timestampOverride",component:ZA,componentProps:{dataTestSubj:"detectionEngineStepAboutRuleTimestampOverride",fieldType:"date",idAria:"detectionEngineStepAboutRuleTimestampOverride",indices:E,isDisabled:c||y,placeholder:""}})))),!l&&r.a.createElement(QC,{dataTestSubj:"about-continue",onClick:w,isDisabled:c}))},nD=Object(i.memo)(aD),iD=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRuleForm.secondsOptionDescription",{defaultMessage:"Seconds"}),rD=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRuleForm.minutesOptionDescription",{defaultMessage:"Minutes"}),sD=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRuleForm.hoursOptionDescription",{defaultMessage:"Hours"}),oD=(F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRuleForm.invalidTimeMessageDescription",{defaultMessage:"A time is required."}),[{value:"s",text:iD},{value:"m",text:rD},{value:"h",text:sD}]),lD=z()(N.EuiFlexItem).withConfig({displayName:"StyledLabelAppend",componentId:"sc-d3i8n6-0"})(["&.euiFlexItem.euiFlexItem--flexGrowZero{margin-left:31px;}"]),cD=z()(N.EuiFormRow).withConfig({displayName:"StyledEuiFormRow",componentId:"sc-d3i8n6-1"})(["max-width:none;.euiFormControlLayout{max-width:200px !important;}.euiFormControlLayout__childrenWrapper > *:first-child{box-shadow:none;height:38px;}.euiFormControlLayout:not(:first-child){border-left:1px solid ",";}"],(({theme:e})=>e.eui.euiColorLightShade)),uD=z()(N.EuiSelect).withConfig({displayName:"MyEuiSelect",componentId:"sc-d3i8n6-2"})(["width:auto;"]),dD=({dataTestSubj:e,field:t,idAria:a,isDisabled:n,minimumValue:s=0})=>{const[o,l]=Object(i.useState)("s"),[c,u]=Object(i.useState)(0),{isInvalid:d,errorMessage:p}=Object(oS.i)(t),{value:m,setValue:g}=t,f=Object(i.useCallback)((e=>{l(e.target.value),g(`${c}${e.target.value}`)}),[g,c]),b=Object(i.useCallback)((e=>{const t=((e,t=0)=>{const a=parseInt(e,10);return Number.isNaN(a)?t:Math.min(a,Number.MAX_SAFE_INTEGER)})(e.target.value,s);u(t),g(`${t}${o}`)}),[s,g,o]);Object(i.useEffect)((()=>{if(m!==`${c}${o}`){const e=m.match(/\d+/g),t=m.match(/[a-zA-Z]+/g);Object(E.isEmpty)(e)||null==e||isNaN(Number(e[0]))||Number(e[0])===Number(c)||u(Number(e[0])),!Object(E.isEmpty)(t)&&null!=t&&["s","m","h"].includes(t[0])&&t[0]!==o&&l(t[0])}}),[o,c,m]);const h={disabled:n},y=Object(i.useMemo)((()=>r.a.createElement(N.EuiFlexGroup,{gutterSize:"s",justifyContent:"flexStart",alignItems:"center"},r.a.createElement(N.EuiFlexItem,{grow:!1,component:"span"},t.label),r.a.createElement(lD,{grow:!1,component:"span"},t.labelAppend))),[t.label,t.labelAppend]);return r.a.createElement(cD,{label:y,helpText:t.helpText,error:p,isInvalid:d,fullWidth:!1,"data-test-subj":e,describedByIds:a?[a]:void 0},r.a.createElement(N.EuiFormControlLayout,{append:r.a.createElement(uD,rr()({fullWidth:!1,options:oD,onChange:f,value:o,"data-test-subj":"timeType"},h))},r.a.createElement(N.EuiFieldNumber,rr()({fullWidth:!0,min:s,max:Number.MAX_SAFE_INTEGER,onChange:b,value:c,"data-test-subj":"interval"},h))))},pD={interval:{label:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldIntervalLabel",{defaultMessage:"Runs every"}),helpText:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldIntervalHelpText",{defaultMessage:"Rules run periodically and detect alerts within the specified time frame."})},from:{label:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldAdditionalLookBackLabel",{defaultMessage:"Additional look-back time"}),labelAppend:_A,helpText:F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldAdditionalLookBackHelpText",{defaultMessage:"Adds time to the look-back period to prevent missed alerts."})}},mD=({addPadding:e=!1,defaultValues:t,descriptionColumns:a="singleSplit",isReadOnlyView:n,isLoading:s,isUpdateView:o=!1,onSubmit:l,setForm:c,ruleType:u})=>{const d=null!=t?t:(e=>({interval:Object(zn.d)(e)?"1h":"5m",from:Object(zn.d)(e)?"5m":"1m"}))(u),{form:p}=Object(oS.k)({defaultValue:d,options:{stripEmptyFields:!1},schema:pD}),{getFormData:m,submit:g}=p,f=Object(i.useCallback)((()=>{l&&l()}),[l]),b=Object(i.useCallback)((async()=>{const e=await g();return null!=e&&e.isValid?e:{isValid:!1,data:m()}}),[m,g]);return Object(i.useEffect)((()=>{let e=!1;return c&&!e&&c(HO.a.scheduleRule,b),()=>{e=!0}}),[b,c]),n?r.a.createElement(Oj,{addPadding:e},r.a.createElement(vj,{columns:a,schema:pD,data:d})):r.a.createElement(r.a.Fragment,null,r.a.createElement(Oj,{addPadding:!o},r.a.createElement(oS.c,{form:p,"data-test-subj":"stepScheduleRule"},r.a.createElement(oS.e,{path:"interval",component:dD,componentProps:{idAria:"detectionEngineStepScheduleRuleInterval",isDisabled:s,dataTestSubj:"detectionEngineStepScheduleRuleInterval"}}),r.a.createElement(oS.e,{path:"from",component:dD,componentProps:{idAria:"detectionEngineStepScheduleRuleFrom",isDisabled:s,dataTestSubj:"detectionEngineStepScheduleRuleFrom",minimumValue:1}}))),!o&&r.a.createElement(QC,{dataTestSubj:"schedule-continue",onClick:f,isDisabled:s}))},gD=Object(i.memo)(mD),fD=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.pageTitle",{defaultMessage:"Create new rule"}),bD=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.backToRulesButton",{defaultMessage:"Rules"}),hD=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.editRuleButton",{defaultMessage:"Edit"});var yD=a(562);const ED=async()=>{},vD=z()(N.EuiPanel).withConfig({displayName:"MyEuiPanel",componentId:"sc-wzrzmg-0"})(["position:relative;z-index:",";> .euiAccordion > .euiAccordion__triggerWrapper{.euiAccordion__button{cursor:default !important;&:hover{text-decoration:none !important;}}.euiAccordion__iconWrapper{display:none;}}.euiAccordion__childWrapper{transform:none;}"],(e=>e.zindex));vD.displayName="MyEuiPanel";const TD=(e,t)=>t!==e?"0":"1",kD=()=>{var e,t;const[{loading:a,isSignalIndexExists:n,isAuthenticated:s,hasEncryptionKey:l,canUserCRUD:c}]=Object(_e.b)(),{loading:u,needsConfiguration:p}=lt(),{navigateToApp:m}=Object(d.j)().services.application,g=a||u,[,f]=Object(J.g)(),[h,E]=Object(i.useState)(HO.a.defineRule),v=Object(i.useRef)(null),k=Object(i.useRef)(null),x=Object(i.useRef)(null),S=Object(i.useRef)(null),O=Object(i.useRef)({[HO.a.defineRule]:ED,[HO.a.aboutRule]:ED,[HO.a.scheduleRule]:ED,[HO.a.ruleActions]:ED}),w=Object(i.useCallback)(((e,t)=>{O.current[e]=t}),[]),j=Object(i.useRef)({[HO.a.defineRule]:{isValid:!1,data:void 0},[HO.a.aboutRule]:{isValid:!1,data:void 0},[HO.a.scheduleRule]:{isValid:!1,data:void 0},[HO.a.ruleActions]:{isValid:!1,data:void 0}}),C=(e,t)=>{j.current[e]=t},[I,M]=Object(i.useState)({[HO.a.defineRule]:!1,[HO.a.aboutRule]:!1,[HO.a.scheduleRule]:!1,[HO.a.ruleActions]:!1}),[{isLoading:A,ruleId:D},q]=(()=>{const[e,t]=Object(i.useState)(null),[a,n]=Object(i.useState)(null),[r,s]=Object(i.useState)(!1),{addError:o}=Object(X.a)(),l=mn();return Object(i.useEffect)((()=>{let t=!0;const a=new AbortController;return n(null),(async()=>{if(null!=e){try{s(!0);const i=await Object(cn.b)({rule:Object(Wu.b)(e),signal:a.signal});l(),t&&n(i.id)}catch(e){t&&o(e,{title:un.g})}t&&s(!1)}})(),()=>{t=!1,a.abort()}}),[e,o,l]),[{isLoading:r,ruleId:a},t]})(),P=null===(e=j.current[HO.a.defineRule].data)||void 0===e?void 0:e.ruleType,R=null===(t=j.current[HO.a.aboutRule].data)||void 0===t?void 0:t.name,_=Object(i.useMemo)((()=>Ei(P)),[P]),L=Object(i.useCallback)(((e,t)=>M((a=>({...a,[e]:t})))),[]),B=Object(i.useCallback)((e=>{yD.b.indexOf(e)>yD.b.indexOf(h)&&!I[e]&&z(e),E(e)}),[h,I]),z=e=>{var t;if(e===HO.a.defineRule)null===(t=v.current)||void 0===t||t.onToggle();else if(e===HO.a.aboutRule){var a;null===(a=k.current)||void 0===a||a.onToggle()}else if(e===HO.a.scheduleRule){var n;null===(n=x.current)||void 0===n||n.onToggle()}else if(e===HO.a.ruleActions){var i;null===(i=S.current)||void 0===i||i.onToggle()}},U=Object(i.useCallback)((async e=>{const t=await O.current[h]();null!=t&&t.isValid&&(C(h,t),B(e))}),[h,B]),H=Object(i.useCallback)((async e=>{const t=await O.current[e]();if(null!=t&&t.isValid){C(e,t);const a=(e=>yD.b[yD.b.indexOf(e)+1])(e);if(null!=a)B(a);else{const e=j.current[HO.a.defineRule],t=j.current[HO.a.aboutRule],a=j.current[HO.a.scheduleRule],n=j.current[HO.a.ruleActions];Gj(e)&&Gj(t)&&Gj(a)&&Gj(n)&&q(aC(e.data,t.data,a.data,n.data))}}}),[B,q]),$=Object(i.useCallback)((e=>e===h?"active":j.current[e].isValid?"valid":"passive"),[h]),Q=Object(i.useCallback)((()=>{H(HO.a.defineRule)}),[H]),W=r.a.createElement(PO,{name:"1",title:nn.kb,type:$(HO.a.defineRule)}),G=r.a.createElement(PO,{name:"2",title:nn.b,type:$(HO.a.aboutRule)}),K=r.a.createElement(PO,{name:"3",title:nn.tc,type:$(HO.a.scheduleRule)}),Y=r.a.createElement(PO,{name:"4",title:nn.rc,type:$(HO.a.ruleActions)});return R&&D?(Object(J.e)((e=>F.i18n.translate("xpack.securitySolution.detectionEngine.rules.create.successfullyCreatedRuleTitle",{values:{ruleName:e},defaultMessage:"{ruleName} was created"}))(R),f),m(o.y,{deepLinkId:T.a.rules,path:Object(V.c)(D)}),null):hi(n,s,l,p)?(m(o.y,{deepLinkId:T.a.alerts,path:Object(V.a)()}),null):vi(c)?r.a.createElement(r.a.Fragment,null,r.a.createElement(b.a,null,r.a.createElement(N.EuiFlexGroup,{direction:"row",justifyContent:"spaceAround"},r.a.createElement(Ti,null,r.a.createElement(Ta.a,{backOptions:{path:Object(V.d)(),text:bD,pageId:T.a.rules},isLoading:A||g,title:fD}),r.a.createElement(vD,{zindex:4,hasBorder:!0},r.a.createElement(N.EuiAccordion,{initialIsOpen:!0,id:HO.a.defineRule,buttonContent:W,paddingSize:"xs",ref:v,onToggle:L.bind(null,HO.a.defineRule),extraAction:j.current[HO.a.defineRule].isValid&&r.a.createElement(N.EuiButtonEmpty,{"data-test-subj":"edit-define-rule",iconType:"pencil",size:"xs",onClick:()=>U(HO.a.defineRule)},hD)},r.a.createElement(N.EuiHorizontalRule,{margin:"m"}),r.a.createElement(gA,{addPadding:!0,defaultValues:j.current[HO.a.defineRule].data,isReadOnlyView:h!==HO.a.defineRule,isLoading:A||g,setForm:w,onSubmit:Q,descriptionColumns:"singleSplit",key:TD(HO.a.defineRule,h)}))),r.a.createElement(N.EuiSpacer,{size:"l"}),r.a.createElement(vD,{hasBorder:!0,zindex:3},r.a.createElement(N.EuiAccordion,{initialIsOpen:!1,id:HO.a.aboutRule,buttonContent:G,paddingSize:"xs",ref:k,onToggle:L.bind(null,HO.a.aboutRule),extraAction:j.current[HO.a.aboutRule].isValid&&r.a.createElement(N.EuiButtonEmpty,{"data-test-subj":"edit-about-rule",iconType:"pencil",size:"xs",onClick:()=>U(HO.a.aboutRule)},hD)},r.a.createElement(N.EuiHorizontalRule,{margin:"m"}),r.a.createElement(nD,{addPadding:!0,defaultValues:j.current[HO.a.aboutRule].data,defineRuleData:j.current[HO.a.defineRule].data,descriptionColumns:"singleSplit",isReadOnlyView:h!==HO.a.aboutRule,isLoading:A||g,setForm:w,onSubmit:()=>H(HO.a.aboutRule),key:TD(HO.a.aboutRule,h)}))),r.a.createElement(N.EuiSpacer,{size:"l"}),r.a.createElement(vD,{hasBorder:!0,zindex:2},r.a.createElement(N.EuiAccordion,{initialIsOpen:!1,id:HO.a.scheduleRule,buttonContent:K,paddingSize:"xs",ref:x,onToggle:L.bind(null,HO.a.scheduleRule),extraAction:j.current[HO.a.scheduleRule].isValid&&r.a.createElement(N.EuiButtonEmpty,{iconType:"pencil",size:"xs",onClick:()=>U(HO.a.scheduleRule)},hD)},r.a.createElement(N.EuiHorizontalRule,{margin:"m"}),r.a.createElement(gD,{ruleType:P,addPadding:!0,defaultValues:j.current[HO.a.scheduleRule].data,descriptionColumns:"singleSplit",isReadOnlyView:h!==HO.a.scheduleRule,isLoading:A||g,setForm:w,onSubmit:()=>H(HO.a.scheduleRule),key:TD(HO.a.scheduleRule,h)}))),r.a.createElement(N.EuiSpacer,{size:"l"}),r.a.createElement(vD,{hasBorder:!0,zindex:1},r.a.createElement(N.EuiAccordion,{initialIsOpen:!1,id:HO.a.ruleActions,buttonContent:Y,paddingSize:"xs",ref:S,onToggle:L.bind(null,HO.a.ruleActions),extraAction:j.current[HO.a.ruleActions].isValid&&r.a.createElement(N.EuiButtonEmpty,{iconType:"pencil",size:"xs",onClick:()=>U(HO.a.ruleActions)},hD)},r.a.createElement(N.EuiHorizontalRule,{margin:"m"}),r.a.createElement(Qj,{addPadding:!0,defaultValues:j.current[HO.a.ruleActions].data,isReadOnlyView:h!==HO.a.ruleActions,isLoading:A||g,setForm:w,onSubmit:()=>H(HO.a.ruleActions),actionMessageParams:_,key:TD(HO.a.ruleActions,h)})))))),r.a.createElement(y.a,{pageName:T.a.rulesCreate})):(m(o.y,{deepLinkId:T.a.rules,path:Object(V.d)()}),null)},xD=r.a.memo(kD);var SD=a(429);const OD=F.i18n.translate("xpack.securitySolution.detectionEngine.details.stepAboutRule.detailsLabel",{defaultMessage:"Details"}),wD=F.i18n.translate("xpack.securitySolution.detectionEngine.details.stepAboutRule.aboutText",{defaultMessage:"About"}),jD=F.i18n.translate("xpack.securitySolution.detectionEngine.details.stepAboutRule.investigationGuideLabel",{defaultMessage:"Investigation guide"}),CD=F.i18n.translate("xpack.securitySolution.detectionEngine.details.stepAboutRule.setupGuideLabel",{defaultMessage:"Setup guide"}),ID=F.i18n.translate("xpack.securitySolution.detectionEngine.details.stepAboutRule.controlLegend",{defaultMessage:"Viewing"}),MD=z()(N.EuiPanel).withConfig({displayName:"MyPanel",componentId:"sc-wtwaaw-0"})(["position:relative;"]),AD=z()(N.EuiFlexGroup).withConfig({displayName:"FlexGroupFullHeight",componentId:"sc-wtwaaw-1"})(["height:100%;"]),DD=z.a.div.withConfig({displayName:"VerticalOverflowContainer",componentId:"sc-wtwaaw-2"})((e=>({"max-height":`${e.maxHeight}px`,"overflow-y":"hidden","word-break":"break-word"}))),qD=z.a.div.withConfig({displayName:"VerticalOverflowContent",componentId:"sc-wtwaaw-3"})((e=>({"max-height":`${e.maxHeight}px`}))),PD=z.a.div.withConfig({displayName:"AboutContent",componentId:"sc-wtwaaw-4"})(["height:100%;"]),RD={id:"details",label:OD,"data-test-subj":"stepAboutDetailsToggle-details"},_D={id:"notes",label:jD,"data-test-subj":"stepAboutDetailsToggle-notes"},FD={id:"setup",label:CD,"data-test-subj":"stepAboutDetailsToggle-setup"},LD=({stepData:e,stepDataDetails:t,loading:a})=>{const[n,s]=Object(i.useState)("details"),[o,l]=Object(i.useState)(0),c=Object(i.useCallback)((e=>{l(e.height)}),[l]),u=Object(i.useMemo)((()=>{const e=!Object(fn.isEmpty)(null==t?void 0:t.note)&&""!==(null==t?void 0:t.note.trim()),a=!Object(fn.isEmpty)(null==t?void 0:t.setup)&&""!==(null==t?void 0:t.setup.trim());return[...e||a?[RD]:[],...e?[_D]:[],...a?[FD]:[]]}),[t]);return r.a.createElement(MD,{hasBorder:!0},a&&r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiProgress,{size:"xs",color:"accent",position:"absolute"}),r.a.createElement(la.a,{title:wD})),null!=e&&null!=t&&r.a.createElement(AD,{gutterSize:"xs",direction:"column"},r.a.createElement(N.EuiFlexItem,{grow:!1,key:"header"},r.a.createElement(la.a,{title:wD},u.length>0&&r.a.createElement(N.EuiButtonGroup,{options:u,idSelected:n,onChange:e=>{s(e)},"data-test-subj":"stepAboutDetailsToggle",legend:ID}))),r.a.createElement(N.EuiFlexItem,{key:"details"},"details"===n&&r.a.createElement(N.EuiResizeObserver,{"data-test-subj":"stepAboutDetailsContent",onResize:c},(a=>r.a.createElement(PD,{ref:a},r.a.createElement(DD,{maxHeight:120},r.a.createElement(qD,{maxHeight:120,className:"eui-yScrollWithShadows"},r.a.createElement(N.EuiText,{size:"s","data-test-subj":"stepAboutRuleDetailsToggleDescriptionText"},t.description))),r.a.createElement(N.EuiSpacer,{size:"m"}),r.a.createElement(nD,{descriptionColumns:"singleSplit",isReadOnlyView:!0,isLoading:!1,defaultValues:e})))),"notes"===n&&r.a.createElement(DD,{"data-test-subj":"stepAboutDetailsNoteContent",maxHeight:o},r.a.createElement(qD,{maxHeight:o,className:"eui-yScrollWithShadows"},r.a.createElement(SD.b,null,t.note))),"setup"===n&&r.a.createElement(DD,{"data-test-subj":"stepAboutDetailsSetupContent",maxHeight:o},r.a.createElement(qD,{maxHeight:o,className:"eui-yScrollWithShadows"},r.a.createElement(SD.b,null,t.setup))))))},ND=Object(i.memo)(LD),BD=z()(N.EuiPanel).withConfig({displayName:"MyPanel",componentId:"sc-177nzsv-0"})(["position:relative;"]);BD.displayName="MyPanel";const zD=({children:e,loading:t,title:a})=>r.a.createElement(BD,{hasBorder:!0},t&&r.a.createElement(N.EuiProgress,{size:"xs",color:"accent",position:"absolute"}),r.a.createElement(la.a,{title:a}),e),UD=Object(i.memo)(zD),HD=F.i18n.translate("xpack.securitySolution.detectionEngine.rules.components.ruleActionsOverflow.allActionsTitle",{defaultMessage:"All actions"}),$D=z()(N.EuiButtonIcon).withConfig({displayName:"MyEuiButtonIcon",componentId:"sc-wltxb1-0"})(["&.euiButtonIcon{svg{transform:rotate(90deg);}border:1px solid ",";width:40px;height:40px;}"],(({theme:e})=>e.euiColorPrimary)),VD=({rule:e,userHasPermissions:t,canDuplicateRuleWithActions:a})=>{const[n,,s,l]=qx(),{navigateToApp:c}=Object(d.j)().services.application,u=Object(X.a)(),{startTransaction:p}=Vu(),m=Object(i.useCallback)((()=>{c(o.y,{deepLinkId:o.cc.rules,path:Object(V.d)()})}),[c]),g=Object(i.useMemo)((()=>null!=e?[r.a.createElement(N.EuiContextMenuItem,{key:nn.sb,icon:"copy",disabled:!a||!t,"data-test-subj":"rules-details-duplicate-rule",onClick:async()=>{p({name:Cu}),s();const t=await np({action:Ou.a.duplicate,onSuccess:fn.noop,search:{ids:[e.id]},toasts:u}),a=null==t?void 0:t.attributes.results.created;null!=a&&a.length&&ap(a[0].id,c)}},r.a.createElement(N.EuiToolTip,{position:"left",content:du(e,!0,a)},r.a.createElement(r.a.Fragment,null,nn.sb))),r.a.createElement(N.EuiContextMenuItem,{key:nn.Bb,icon:"exportAction",disabled:!t||e.immutable,"data-test-subj":"rules-details-export-rule",onClick:async()=>{p({name:Iu}),s(),await np({action:Ou.a.export,onSuccess:fn.noop,search:{ids:[e.id]},toasts:u})}},nn.Bb),r.a.createElement(N.EuiContextMenuItem,{key:nn.rb,icon:"trash",disabled:!t,"data-test-subj":"rules-details-delete-rule",onClick:async()=>{p({name:Mu}),s(),await np({action:Ou.a.delete,onSuccess:m,search:{ids:[e.id]},toasts:u})}},nn.rb)]:[]),[a,s,c,m,e,p,u,t]),f=Object(i.useMemo)((()=>r.a.createElement(N.EuiToolTip,{position:"top",content:HD},r.a.createElement($D,{iconType:"boxesHorizontal","aria-label":HD,isDisabled:!t,"data-test-subj":"rules-details-popover-button-icon",onClick:l}))),[l,t]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiPopover,{anchorPosition:"leftCenter",button:f,closePopover:s,id:"ruleActionsOverflow",isOpen:n,"data-test-subj":"rules-details-popover",ownFocus:!0,panelPaddingSize:"none",repositionOnScroll:!0},r.a.createElement(N.EuiContextMenuPanel,{"data-test-subj":"rules-details-menu-panel",items:g})))},QD=r.a.memo(VD);QD.displayName="RuleActionsOverflow";var WD=a(252);const GD=({isInitLoading:e,supportedListTypes:t,detectionsListItems:a,endpointListItems:n,onFilterChange:s,onAddExceptionClick:o})=>{const[l,c]=Object(i.useState)(""),[u,d]=Object(i.useState)([]),[p,m]=Object(i.useState)(!1),[g,f]=Object(i.useState)(!1),[b,h]=Object(i.useState)(!1);Object(i.useEffect)((()=>{s({filter:{filter:l,tags:u},pagination:{pageIndex:0},showDetectionsListsOnly:p,showEndpointListsOnly:g})}),[l,u,p,g,s]);const y=Object(i.useCallback)((()=>h(!b)),[h,b]),E=Object(i.useCallback)((()=>{m(!p),f(!1)}),[p,m,f]),v=Object(i.useCallback)((()=>{f(!g),m(!1)}),[g,f,m]),T=Object(i.useCallback)((e=>{const t=/(tags:[^\s]*)/i,a=e.match(t),n=null!=a?a[0].split(":")[1]:"",i=null!=a?e.replace(t,""):e;n.length>0&&d(n.split(",")),c(i.trim())}),[d,c]),k=Object(i.useCallback)((e=>{o(e),h(!1)}),[o,h]),x=Object(i.useMemo)((()=>[{id:0,items:[{name:WD.g,onClick:()=>k(Gu.a.ENDPOINT),"data-test-subj":"addEndpointExceptionBtn"},{name:WD.f,onClick:()=>k(Gu.a.DETECTION),"data-test-subj":"addDetectionsExceptionBtn"}]}]),[k]);return r.a.createElement(N.EuiFlexGroup,{alignItems:"center"},r.a.createElement(N.EuiFlexItem,{grow:!0},r.a.createElement(N.EuiFieldSearch,{"data-test-subj":"exceptionsHeaderSearch","aria-label":WD.O,placeholder:WD.O,onSearch:T,disabled:e,incremental:!1,fullWidth:!0})),1===t.length&&r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiButton,{"data-test-subj":"exceptionsHeaderAddExceptionBtn",onClick:()=>k(t[0]),isDisabled:e,fill:!0},WD.d)),t.length>1&&r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween"},r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiFilterGroup,{"data-test-subj":"exceptionsFilterGroupBtns"},r.a.createElement(N.EuiFilterButton,{"data-test-subj":"exceptionsDetectionFilterBtn",hasActiveFilters:p,onClick:E,isDisabled:e},WD.r,null!=a?` (${a})`:""),r.a.createElement(N.EuiFilterButton,{"data-test-subj":"exceptionsEndpointFilterBtn",hasActiveFilters:g,onClick:v,isDisabled:e},WD.v,null!=n?` (${n})`:""))),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiPopover,{button:r.a.createElement(N.EuiButton,{"data-test-subj":"exceptionsHeaderAddExceptionPopoverBtn",onClick:y,isDisabled:e,iconType:"arrowDown",iconSide:"right",fill:!0},WD.d),isOpen:b,closePopover:y,anchorPosition:"downCenter",panelPaddingSize:"none",repositionOnScroll:!0},r.a.createElement(N.EuiContextMenu,{initialPanelId:0,panels:x}))))))};GD.displayName="ExceptionsViewerHeaderComponent";const KD=r.a.memo(GD);KD.displayName="ExceptionsViewerHeader";const YD=({pagination:e,onPaginationChange:t})=>{const[a,n]=Object(i.useState)(!1),s=Object(i.useCallback)((()=>n(!1)),[n]),o=Object(i.useCallback)((()=>n((e=>!e))),[n]),l=Object(i.useCallback)((a=>{t({pagination:{pageIndex:a,pageSize:e.pageSize,totalItemCount:e.totalItemCount}})}),[e,t]),c=Object(i.useMemo)((()=>e.pageSizeOptions.map((a=>r.a.createElement(N.EuiContextMenuItem,{icon:a===e.pageSize?"check":"empty",key:a,onClick:()=>{t({pagination:{pageIndex:0,pageSize:a,totalItemCount:e.totalItemCount}}),s()},"data-test-subj":"exceptionsPerPageItem"},WD.F(a))))),[e,t,s]),u=Object(i.useMemo)((()=>e.totalItemCount>0?Math.ceil(e.totalItemCount/e.pageSize):1),[e]);return r.a.createElement(N.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiPopover,{button:r.a.createElement(N.EuiButtonEmpty,{size:"s",color:"text",iconType:"arrowDown",iconSide:"right",onClick:o,"data-test-subj":"exceptionsPerPageBtn"},WD.B(e.pageSize)),isOpen:a,closePopover:s,panelPaddingSize:"none",repositionOnScroll:!0},r.a.createElement(N.EuiContextMenuPanel,{items:c}))),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiPagination,{pageCount:u,activePage:e.pageIndex,onPageClick:l,"data-test-subj":"exceptionsPagination"})))};YD.displayName="ExceptionsViewerPaginationComponent";const JD=r.a.memo(YD);JD.displayName="ExceptionsViewerPagination";const XD=z()(N.EuiText).withConfig({displayName:"StyledText",componentId:"sc-oztuyc-0"})(["font-style:italic;"]),ZD=z()(N.EuiFlexGroup).withConfig({displayName:"MyUtilities",componentId:"sc-oztuyc-1"})(["height:50px;"]),eq=({pagination:e,showEndpointListsOnly:t,showDetectionsListsOnly:a,ruleSettingsUrl:n,onRefreshClick:i})=>{var s;return r.a.createElement(ZD,{alignItems:"center",justifyContent:"spaceBetween"},r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(ge.a,null,r.a.createElement(ge.d,null,r.a.createElement(ge.c,null,r.a.createElement(ge.f,{dataTestSubj:"exceptionsShowing"},WD.P(null!==(s=e.totalItemCount)&&void 0!==s?s:0))),r.a.createElement(ge.c,null,r.a.createElement(ge.b,{dataTestSubj:"exceptionsRefresh",iconSide:"left",iconType:"refresh",onClick:i},WD.M))))),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(XD,{size:"s"},t&&r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.exceptions.viewer.exceptionEndpointDetailsDescription",defaultMessage:"All exceptions to this rule are applied to the endpoint and the detection rule. View {ruleSettings} for more details.","data-test-subj":"exceptionsEndpointMessage",values:{ruleSettings:r.a.createElement(N.EuiLink,{href:n,target:"_blank"},r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.exceptions.viewer.exceptionEndpointDetailsDescription.ruleSettingsLink",defaultMessage:"rule settings"}))}}),a&&r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.exceptions.viewer.exceptionDetectionDetailsDescription",defaultMessage:"All exceptions to this rule are applied to the detection rule, not the endpoint. View {ruleSettings} for more details.","data-test-subj":"exceptionsDetectionsMessage",values:{ruleSettings:r.a.createElement(N.EuiLink,{href:n,target:"_blank"},r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.exceptions.viewer.exceptionDetectionDetailsDescription.ruleSettingsLink",defaultMessage:"rule settings"}))}}))))};eq.displayName="ExceptionsViewerUtilityComponent";const tq=r.a.memo(eq);tq.displayName="ExceptionsViewerUtility";var aq=a(324);const nq=({isNested:e,item:t})=>{var a;const n=Object(FI.h)(t),i=Object(FI.g)(t);return{fieldName:null!==(a=t.field)&&void 0!==a?a:"",operator:n.message,value:i,isNested:e}},iq=z()(N.EuiFlexItem).withConfig({displayName:"MyExceptionDetails",componentId:"sc-z36hrg-0"})(["",""],(({theme:e})=>Object(B.css)(["background-color:",";padding:",";.eventFiltersDescriptionList{margin:"," "," 0 ",";}.eventFiltersDescriptionListTitle{width:40%;margin-top:0;margin-bottom:",";}.eventFiltersDescriptionListDescription{width:60%;margin-top:0;margin-bottom:",";}"],e.eui.euiColorLightestShade,e.eui.euiSize,e.eui.euiSize,e.eui.euiSize,e.eui.euiSize,e.eui.euiSizeS,e.eui.euiSizeS))),rq=z()(N.EuiFlexItem).withConfig({displayName:"StyledCommentsSection",componentId:"sc-z36hrg-1"})(["",""],(({theme:e})=>Object(B.css)(["&&&{margin:"," "," "," ",";}"],e.eui.euiSizeXS,e.eui.euiSize,e.eui.euiSizeL,e.eui.euiSize))),sq=({showComments:e,showModified:t=!1,showName:a=!1,onCommentsClick:n,exceptionItem:s})=>{const o=Object(i.useMemo)((()=>((e,t=!1,a=!1)=>[...a?[{title:WD.E,value:e.name}]:[],{title:WD.G,value:Object(aq.j)(e.os_types)},{title:WD.n,value:Fn()(e.created_at).format("MMMM Do YYYY @ HH:mm:ss")},{title:WD.m,value:e.created_by},...t?[{title:WD.o,value:Fn()(e.updated_at).format("MMMM Do YYYY @ HH:mm:ss")},{title:WD.D,value:e.updated_by}]:[],{title:WD.q,value:e.description}].reduce(((e,{value:t,title:a})=>{if(null!=t&&""!==t.trim()){const n=r.a.createElement(N.EuiToolTip,{content:t,anchorClassName:"eventFiltersDescriptionListDescription"},r.a.createElement(N.EuiDescriptionListDescription,{className:"eui-fullWidth"},t));return a===WD.q?[...e,{title:a,description:t.length>75?r.a.createElement(N.EuiDescriptionListDescription,{style:{height:150,overflowY:"hidden"}},r.a.createElement(N.EuiText,{tabIndex:0,role:"region","aria-label":"",className:"eui-yScrollWithShadows",size:"s"},t)):n}]:[...e,{title:a,description:n}]}return e}),[]))(s,t,a)),[s,t,a]),l=Object(i.useMemo)((()=>{const{comments:t}=s;return t.length>0?r.a.createElement(N.EuiButtonEmpty,{onClick:n,flush:"left",size:"xs","data-test-subj":"exceptionsViewerItemCommentsBtn"},e?WD.j(t.length):WD.k(t.length)):r.a.createElement(r.a.Fragment,null)}),[e,n,s]);return r.a.createElement(iq,{grow:2},r.a.createElement(N.EuiFlexGroup,{direction:"column",alignItems:"flexStart"},r.a.createElement(N.EuiFlexItem,{grow:1,className:"eventFiltersDescriptionList"},r.a.createElement(N.EuiDescriptionList,{compressed:!0,type:"responsiveColumn","data-test-subj":"exceptionsViewerItemDetails"},o.map((e=>r.a.createElement(i.Fragment,{key:`${e.title}`},r.a.createElement(N.EuiToolTip,{content:e.title,anchorClassName:"eventFiltersDescriptionListTitle"},r.a.createElement(N.EuiDescriptionListTitle,{className:"eui-textTruncate eui-fullWidth"},e.title)),e.description))))),r.a.createElement(rq,{grow:!1},l)))};sq.displayName="ExceptionDetailsComponent";const oq=r.a.memo(sq);oq.displayName="ExceptionDetails";const lq=z()(N.EuiFlexItem).withConfig({displayName:"MyEntriesDetails",componentId:"sc-1tpcxfd-0"})(["",""],(({theme:e})=>Object(B.css)(["padding:"," "," "," ",";&&&{margin-left:0;}"],e.eui.euiSize,e.eui.euiSizeL,e.eui.euiSizeL,e.eui.euiSizeXS))),cq=z()(N.EuiButton).withConfig({displayName:"MyEditButton",componentId:"sc-1tpcxfd-1"})(["",""],(({theme:e})=>Object(B.css)(["background-color:",";border:none;font-weight:",";"],Object(jn.transparentize)(.9,e.eui.euiColorPrimary),e.eui.euiFontWeightSemiBold))),uq=z()(N.EuiButton).withConfig({displayName:"MyRemoveButton",componentId:"sc-1tpcxfd-2"})(["",""],(({theme:e})=>Object(B.css)(["background-color:",";border:none;font-weight:",";"],Object(jn.transparentize)(.9,e.eui.euiColorDanger),e.eui.euiFontWeightSemiBold))),dq=z()(N.EuiFlexItem).withConfig({displayName:"MyAndOrBadgeContainer",componentId:"sc-1tpcxfd-3"})(["",""],(({theme:e})=>Object(B.css)(["padding:"," "," "," 0;"],e.eui.euiSizeXL,e.eui.euiSize,e.eui.euiSizeS))),pq=z()(N.EuiFlexItem).withConfig({displayName:"MyActionButton",componentId:"sc-1tpcxfd-4"})(["align-self:flex-end;"]),mq=z.a.div.withConfig({displayName:"MyNestedValueContainer",componentId:"sc-1tpcxfd-5"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeL)),gq=z.a.span.withConfig({displayName:"MyNestedValue",componentId:"sc-1tpcxfd-6"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeS)),fq=z()(N.EuiBadgeGroup).withConfig({displayName:"ValueBadgeGroup",componentId:"sc-1tpcxfd-7"})(["width:100%;"]),bq=({entries:e,disableActions:t,onDelete:a,onEdit:n})=>{const s=Object(i.useMemo)((()=>[{field:"fieldName",name:"Field",sortable:!1,truncateText:!0,textOnly:!0,"data-test-subj":"exceptionFieldNameCell",width:"30%",render:(e,t)=>null!=e&&t.isNested?r.a.createElement(mq,null,r.a.createElement(N.EuiIconTip,{type:"nested",size:"s"}),r.a.createElement(gq,null,e)):null!=e?e:Object(vr.e)()},{field:"operator",name:"Operator",sortable:!1,truncateText:!0,"data-test-subj":"exceptionFieldOperatorCell",width:"20%",render:e=>null!=e?e:Object(vr.e)()},{field:"value",name:"Value",sortable:!1,truncateText:!0,"data-test-subj":"exceptionFieldValueCell",width:"60%",render:e=>Array.isArray(e)?r.a.createElement(fq,{gutterSize:"xs"},e.map((e=>r.a.createElement(N.EuiBadge,{color:"#DDD",key:e},e)))):e?r.a.createElement(N.EuiToolTip,{content:e,anchorClassName:"eui-textTruncate"},r.a.createElement("span",null,e)):Object(vr.e)()}]),[]);return r.a.createElement(lq,{grow:5},r.a.createElement(N.EuiFlexGroup,{direction:"column",gutterSize:"m"},r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiFlexGroup,{direction:"row",gutterSize:"none"},e.length>1&&r.a.createElement(N.EuiHideFor,{sizes:["xs","s"]},r.a.createElement(dq,{grow:!1},r.a.createElement(HI.a,{type:"and",includeAntennas:!0,"data-test-subj":"exceptionsViewerAndBadge"}))),r.a.createElement(N.EuiFlexItem,{grow:1},r.a.createElement(N.EuiBasicTable,{isSelectable:!1,itemId:"id",columns:s,items:e,responsive:!0})))),!t&&r.a.createElement(N.EuiFlexItem,{grow:1},r.a.createElement(N.EuiFlexGroup,{gutterSize:"s",justifyContent:"flexEnd"},r.a.createElement(pq,{grow:!1},r.a.createElement(cq,{size:"s",color:"primary",onClick:n,"data-test-subj":"exceptionsViewerEditBtn"},WD.u)),r.a.createElement(pq,{grow:!1},r.a.createElement(uq,{size:"s",color:"danger",onClick:a,"data-test-subj":"exceptionsViewerDeleteBtn"},WD.N))))))};bq.displayName="ExceptionEntriesComponent";const hq=r.a.memo(bq);hq.displayName="ExceptionEntries";const yq=z()(N.EuiFlexItem).withConfig({displayName:"MyFlexItem",componentId:"sc-l5qlm8-0"})(["&.comments--show{padding:",";border-top:",";}"],(({theme:e})=>e.eui.euiSize),(({theme:e})=>`${e.eui.euiBorderThin}`)),Eq=({disableActions:e,loadingItemIds:t,exceptionItem:a,commentsAccordionId:n,onDeleteException:s,onEditException:o,showModified:l=!1,showName:c=!1,"data-test-subj":u})=>{const[d,p]=Object(i.useState)([]),[m,g]=Object(i.useState)(!1);Object(i.useEffect)((()=>{const e=a.entries.map((e=>{if(Gu.m.is(e)){const t={fieldName:e.field,operator:void 0,value:void 0,isNested:!1};return e.entries.reduce(((e,t)=>[...e,{...nq({isNested:!0,item:t})}]),[t])}return nq({isNested:!1,item:e})})).flat();p(e)}),[a.entries]);const f=Object(i.useCallback)((()=>{s({id:a.id,namespaceType:a.namespace_type})}),[s,a.id,a.namespace_type]),b=Object(i.useCallback)((()=>{o(a)}),[o,a]),h=Object(i.useCallback)((()=>{g(!m)}),[g,m]),y=Object(i.useMemo)((()=>Object(aq.k)(a.comments)),[a.comments]),E=Object(i.useMemo)((()=>t.filter((({id:e})=>e===a.id)).length>0),[t,a.id]);return r.a.createElement(N.EuiPanel,{paddingSize:"none","data-test-subj":u,hasBorder:!0,hasShadow:!1},r.a.createElement(N.EuiFlexGroup,{direction:"column",gutterSize:"none"},r.a.createElement(N.EuiFlexItem,null,r.a.createElement(N.EuiFlexGroup,{direction:"row"},r.a.createElement(oq,{showComments:m,exceptionItem:a,onCommentsClick:h,showModified:l,showName:c}),r.a.createElement(hq,{disableActions:E||e,entries:d,onDelete:f,onEdit:b}))),r.a.createElement(yq,{className:m?"comments--show":""},r.a.createElement(N.EuiAccordion,{id:n,arrowDisplay:"none",forceState:m?"open":"closed","data-test-subj":"exceptionsViewerCommentAccordion"},r.a.createElement(N.EuiCommentList,{comments:y})))))};Eq.displayName="ExceptionItemComponent";const vq=r.a.memo(Eq);vq.displayName="ExceptionItem";const Tq=z()(N.EuiFlexItem).withConfig({displayName:"MyFlexItem",componentId:"sc-z8zhds-0"})(["margin:",";&:first-child{margin:",";}"],(({theme:e})=>`${e.eui.euiSize} 0`),(({theme:e})=>`${e.eui.euiSizeXS} 0 ${e.eui.euiSize}`)),kq=z()(N.EuiFlexGroup).withConfig({displayName:"MyExceptionItemContainer",componentId:"sc-z8zhds-1"})(["margin:",";"],(({theme:e})=>`0 ${e.eui.euiSize} ${e.eui.euiSize} 0`)),xq=({showEmpty:e,showNoResults:t,isInitLoading:a,exceptions:n,loadingItemIds:i,commentsAccordionId:s,onDeleteException:o,onEditExceptionItem:l,disableActions:c})=>r.a.createElement(N.EuiFlexGroup,{direction:"column",className:"eui-yScrollWithShadows"},e||t||a?r.a.createElement(N.EuiFlexItem,{grow:1},r.a.createElement(N.EuiEmptyPrompt,{iconType:t?"searchProfilerApp":"list",title:r.a.createElement("h2",{"data-test-subj":"exceptionsEmptyPromptTitle"},t?"":WD.y),body:r.a.createElement("p",{"data-test-subj":"exceptionsEmptyPromptBody"},t?WD.z:WD.x),"data-test-subj":"exceptionsEmptyPrompt"})):r.a.createElement(N.EuiFlexItem,{grow:!1,className:"eui-yScrollWithShadows"},r.a.createElement(kq,{"data-test-subj":"exceptionsContainer",gutterSize:"none",direction:"column"},!a&&n.length>0&&n.map(((e,t)=>r.a.createElement(Tq,{"data-test-subj":"exceptionItemContainer",grow:!1,key:e.id},0!==t?r.a.createElement(r.a.Fragment,null,r.a.createElement(HI.a,{"data-test-subj":"exceptionItemOrBadge",type:"or"}),r.a.createElement(N.EuiSpacer,null)):r.a.createElement(N.EuiSpacer,{size:"s"}),r.a.createElement(vq,{disableActions:c,loadingItemIds:i,commentsAccordionId:s,exceptionItem:e,onDeleteException:o,onEditException:l})))))));xq.displayName="ExceptionsViewerItemsComponent";const Sq=r.a.memo(xq);Sq.displayName="ExceptionsViewerItems";var Oq=a(183),wq=a(742);const jq=F.i18n.translate("xpack.securitySolution.exceptions.editException.cancel",{defaultMessage:"Cancel"}),Cq=F.i18n.translate("xpack.securitySolution.exceptions.editException.editExceptionSaveButton",{defaultMessage:"Save"}),Iq=F.i18n.translate("xpack.securitySolution.exceptions.editException.editExceptionTitle",{defaultMessage:"Edit Rule Exception"}),Mq=F.i18n.translate("xpack.securitySolution.exceptions.editException.editEndpointExceptionTitle",{defaultMessage:"Edit Endpoint Exception"}),Aq=(F.i18n.translate("xpack.securitySolution.exceptions.editException.error",{defaultMessage:"Failed to update exception"}),F.i18n.translate("xpack.securitySolution.exceptions.editException.success",{defaultMessage:"Successfully updated exception"})),Dq=F.i18n.translate("xpack.securitySolution.exceptions.editException.bulkCloseLabel",{defaultMessage:"Close all alerts that match this exception and were generated by this rule"}),qq=F.i18n.translate("xpack.securitySolution.exceptions.editException.bulkCloseLabel.disabled",{defaultMessage:"Close all alerts that match this exception and were generated by this rule (Lists and non-ECS fields are not supported)"}),Pq=F.i18n.translate("xpack.securitySolution.exceptions.editException.endpointQuarantineText",{defaultMessage:"On all Endpoint hosts, quarantined files that match the exception are automatically restored to their original locations. This exception applies to all rules using Endpoint exceptions."}),Rq=F.i18n.translate("xpack.securitySolution.exceptions.editException.infoLabel",{defaultMessage:"Alerts are generated when the rule's conditions are met, except when:"}),_q=F.i18n.translate("xpack.securitySolution.exceptions.editException.versionConflictTitle",{defaultMessage:"Sorry, there was an error"}),Fq=F.i18n.translate("xpack.securitySolution.exceptions.editException.versionConflictDescription",{defaultMessage:"It appears this exception was updated since you first selected to edit it. Try clicking 'Cancel' and editing the exception again."}),Lq=F.i18n.translate("xpack.securitySolution.exceptions.editException.sequenceWarning",{defaultMessage:"This rule's query contains an EQL sequence statement. The exception modified will apply to all events in the sequence."});var Nq=a(740),Bq=a(546),zq=a(838),Uq=a(839);const Hq=z()(N.EuiFlyoutHeader).withConfig({displayName:"FlyoutHeader",componentId:"sc-dsyaws-0"})(["",""],(({theme:e})=>Object(B.css)(["border-bottom:1px solid ",";"],e.eui.euiColorLightShade))),$q=z.a.div.withConfig({displayName:"FlyoutSubtitle",componentId:"sc-dsyaws-1"})(["",""],(({theme:e})=>Object(B.css)(["color:",";"],e.eui.euiColorMediumShade))),Vq=z.a.section.withConfig({displayName:"FlyoutBodySection",componentId:"sc-dsyaws-2"})(["",""],(({theme:e})=>Object(B.css)(["padding:"," ",";"],e.eui.euiSizeS,e.eui.euiSizeL))),Qq=z()(N.EuiFlyoutBody).withConfig({displayName:"FlyoutCheckboxesSection",componentId:"sc-dsyaws-3"})(["overflow-y:inherit;height:auto;.euiFlyoutBody__overflowContent{padding-top:0;}"]),Wq=z()(N.EuiFlexGroup).withConfig({displayName:"FlyoutFooterGroup",componentId:"sc-dsyaws-4"})(["",""],(({theme:e})=>Object(B.css)(["padding:",";"],e.eui.euiSizeS))),Gq=Object(i.memo)((function({ruleName:e,ruleId:t,ruleIndices:a,exceptionItem:n,exceptionListType:s,onCancel:o,onConfirm:l,onRuleChange:c}){const{http:u,unifiedSearch:p}=Object(d.j)().services,[m,g]=Object(i.useState)(""),[f,b]=Object(i.useState)(!1),{rule:h,loading:y}=Object(wq.a)(t),[E,v]=Object(i.useState)(null),[T,k]=Object(i.useState)(!1),[x,S]=Object(i.useState)(!1),[O,w]=Object(i.useState)(!1),[j,C]=Object(i.useState)([]),{addError:I,addSuccess:M}=Object(X.a)(),{loading:A,signalIndexName:D}=Object(OT.a)(),q=Object(i.useMemo)((()=>null!==D?[D]:[]),[D]),[P,{indexPatterns:R}]=Object(EE.b)(q),_=Object(i.useMemo)((()=>{var e;return null!==(e=null==h?void 0:h.machine_learning_job_id)&&void 0!==e?e:[]}),[h]),{loading:F,jobs:L}=Object(Uq.a)(_),B=Object(i.useMemo)((()=>L.length>0?L[0].results_index_name?[`.ml-anomalies-${L[0].results_index_name}`]:[]:a),[L,a]),[z,{indexPatterns:U}]=Object(EE.b)(B),H=Object(i.useCallback)(((e,t,a)=>{e.message.includes("Conflict")?k(!0):v({reason:e.message,code:t,details:a,listListId:n.list_id})}),[v,k,n.list_id]),$=Object(i.useCallback)((e=>{M(WD.t(e)),c&&c(),o()}),[M,o,c]),V=Object(i.useCallback)((e=>{I(e,{title:WD.s}),o()}),[I,o]),Q=Object(i.useCallback)((()=>{M(Aq),l()}),[M,l]),[{isLoading:W},G]=Object(Nq.a)({http:u,onSuccess:Q,onError:H});Object(i.useEffect)((()=>{!1===P&&!1===A&&w(Object(aq.f)(j)||Object(aq.g)(j,R)||j.every((e=>0===e.entries.length)))}),[w,j,P,A,R]),Object(i.useEffect)((()=>{!0===O&&S(!1)}),[O]);const K=Object(i.useMemo)((()=>j.every((e=>0===e.entries.length))||T||f),[j,T,f]),Y=Object(i.useCallback)((({exceptionItems:e,errorExists:t})=>{C(e),b(t)}),[C]),J=Object(i.useCallback)((e=>{g(e)}),[g]),Z=Object(i.useCallback)((e=>{S(e.currentTarget.checked)}),[S]),ee=Object(i.useCallback)((()=>{const[e]=j;let t=[{...Object(aq.d)(e,[...n.comments,...""!==m.trim()?[{comment:m}]:[]])}];return"endpoint"===s&&(t=Object(aq.l)(Object(aq.c)(t,n.os_types))),t}),[j,n,m,s]),te=Object(i.useCallback)((()=>{if(null!==G){var e;const t=x&&null!==D?[D]:void 0;G(null!==(e=null==h?void 0:h.rule_id)&&void 0!==e?e:"",ee(),void 0,t)}}),[G,h,ee,x,D]),ae=Object(i.useMemo)((()=>null!=h&&Object(zn.b)(h.type)&&Object(zn.a)(h.query)),[h]);return r.a.createElement(N.EuiFlyout,{size:"l",onClose:o,"data-test-subj":"edit-exception-flyout"},r.a.createElement(Hq,null,r.a.createElement(N.EuiTitle,null,r.a.createElement("h2",{"data-test-subj":"exception-flyout-title"},"endpoint"===s?Mq:Iq)),r.a.createElement(N.EuiSpacer,{size:"xs"}),r.a.createElement($q,{className:"eui-textTruncate",title:e}),r.a.createElement(N.EuiSpacer,{size:"m"})),(W||z||A)&&r.a.createElement(Fa.a,{"data-test-subj":"loadingEditExceptionFlyout",size:"xl"}),!A&&!W&&!z&&!y&&!F&&r.a.createElement(r.a.Fragment,null,r.a.createElement(Vq,{className:"builder-section"},ae&&r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiCallOut,{"data-test-subj":"eql-sequence-callout",title:Lq}),r.a.createElement(N.EuiSpacer,null)),r.a.createElement(N.EuiText,null,Rq),r.a.createElement(N.EuiSpacer,null),"endpoint"===s&&r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiText,{size:"xs"},r.a.createElement("dl",null,r.a.createElement("dt",null,WD.H),r.a.createElement("dd",null,n.os_types.reduce(((e,t)=>`${(e=>"linux"===e?WD.I:"macos"===e?WD.J:WD.K)(t)}, ${e}`),"").slice(0,-2)))),r.a.createElement(N.EuiSpacer,null)),Object(Oq.getExceptionBuilderComponentLazy)({allowLargeValueLists:!Object(zn.b)(null==h?void 0:h.type)&&!Object(zn.e)(null==h?void 0:h.type),httpService:u,autocompleteService:p.autocomplete,exceptionListItems:[n],listType:s,listId:n.list_id,listNamespaceType:n.namespace_type,listTypeSpecificIndexPatternFilter:aq.h,ruleName:e,isOrDisabled:!0,isAndDisabled:!1,osTypes:n.os_types,isNestedDisabled:!1,dataTestSubj:"edit-exception-builder",idAria:"edit-exception-builder",onChange:Y,indexPatterns:U}),r.a.createElement(N.EuiSpacer,null),r.a.createElement(Bq.a,{exceptionItemComments:n.comments,newCommentValue:m,newCommentOnChange:J})),r.a.createElement(N.EuiHorizontalRule,null),r.a.createElement(Qq,null,r.a.createElement(N.EuiFormRow,{fullWidth:!0},r.a.createElement(N.EuiCheckbox,{"data-test-subj":"close-alert-on-add-edit-exception-checkbox",id:"close-alert-on-add-edit-exception-checkbox",label:O?qq:Dq,checked:x,onChange:Z,disabled:O})),"endpoint"===s&&r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiSpacer,{size:"s"}),r.a.createElement(N.EuiText,{"data-test-subj":"edit-exception-endpoint-text",color:"subdued",size:"s"},Pq)))),r.a.createElement(N.EuiFlyoutFooter,null,T&&r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiCallOut,{title:_q,color:"danger",iconType:"alert","data-test-subj":"exceptionsFlyoutVersionConflict"},r.a.createElement("p",null,Fq)),r.a.createElement(N.EuiSpacer,{size:"m"})),null!=E&&r.a.createElement(r.a.Fragment,null,r.a.createElement(zq.a,{http:u,errorInfo:E,rule:h,onCancel:o,onSuccess:$,onError:V}),r.a.createElement(N.EuiSpacer,{size:"m"})),null===E&&r.a.createElement(Wq,{justifyContent:"spaceBetween"},r.a.createElement(N.EuiButtonEmpty,{"data-test-subj":"cancelExceptionAddButton",onClick:o},jq),r.a.createElement(N.EuiButton,{"data-test-subj":"edit-exception-confirm-button",onClick:te,isLoading:W,isDisabled:K,fill:!0},Cq))))}));var Kq=a(821);const Yq={filterOptions:{filter:"",tags:[]},pagination:{pageIndex:0,pageSize:20,totalItemCount:0,pageSizeOptions:[5,10,20,50,100,200,300]},exceptions:[],exceptionToEdit:null,loadingItemIds:[],isInitLoading:!0,currentModal:null,exceptionListTypeToEdit:null,totalEndpointItems:0,totalDetectionsItems:0,showEndpointListsOnly:!1,showDetectionsListsOnly:!1},Jq=({ruleId:e,ruleName:t,ruleIndices:a,exceptionListsMeta:n,availableListTypes:s,commentsAccordionId:o,onRuleChange:l})=>{const{services:c}=Object(d.j)(),[,u]=Object(J.g)(),p=Object(i.useCallback)((({title:e,color:t,iconType:a})=>()=>{u({type:"addToaster",toast:{id:sa.a.v4(),title:e,color:t,iconType:a}})}),[u]),[{exceptions:m,filterOptions:g,pagination:f,loadingItemIds:b,isInitLoading:h,currentModal:y,exceptionToEdit:E,exceptionListTypeToEdit:v,totalEndpointItems:T,totalDetectionsItems:k,showDetectionsListsOnly:x,showEndpointListsOnly:S},O]=Object(i.useReducer)(((e,t)=>{switch(t.type){case"setExceptions":{var a;const{exceptions:n,pagination:i}=t;return{...e,pagination:{...e.pagination,pageIndex:i.page-1,pageSize:i.perPage,totalItemCount:null!==(a=i.total)&&void 0!==a?a:0},exceptions:n}}case"updateFilterOptions":{const{filter:a,pagination:n,showEndpointListsOnly:i,showDetectionsListsOnly:r}=t.filters;return{...e,filterOptions:{...e.filterOptions,...a},pagination:{...e.pagination,...n},showEndpointListsOnly:null!=i?i:e.showEndpointListsOnly,showDetectionsListsOnly:null!=r?r:e.showDetectionsListsOnly}}case"setExceptionItemTotals":return{...e,totalEndpointItems:null==t.totalEndpointItems?e.totalEndpointItems:t.totalEndpointItems,totalDetectionsItems:null==t.totalDetectionsItems?e.totalDetectionsItems:t.totalDetectionsItems};case"updateIsInitLoading":return{...e,isInitLoading:t.loading};case"updateLoadingItemIds":return{...e,loadingItemIds:[...e.loadingItemIds,...t.items]};case"updateExceptionToEdit":{const{exception:a,lists:n}=t,i=n.find((e=>null!==e&&a.list_id===e.listId));return{...e,exceptionToEdit:a,exceptionListTypeToEdit:i?i.type:null}}case"updateModalOpen":return{...e,currentModal:t.modalName};case"updateExceptionListTypeToEdit":return{...e,exceptionListTypeToEdit:t.exceptionListType};default:return e}}),{...Yq}),{deleteExceptionItem:w,getExceptionListsItems:j}=Object(et.a)(c.http),[C,I]=Object(i.useState)([]),[{canUserCRUD:M,hasIndexWrite:A}]=Object(_e.b)();Object(i.useEffect)((()=>{I(M&&A?s:[])}),[s,M,A]);const D=Object(i.useCallback)((({exceptions:e,pagination:t})=>{O({type:"setExceptions",lists:n,exceptions:e,pagination:t})}),[O,n]),[q,,,P]=Object(et.e)({http:c.http,lists:n,filterOptions:""!==g.filter||g.tags.length>0?[g]:[],pagination:{page:f.pageIndex+1,perPage:f.pageSize,total:f.totalItemCount},showDetectionsListsOnly:x,showEndpointListsOnly:S,matchFilters:!0,onSuccess:D,onError:p({color:"danger",title:WD.A,iconType:"alert"})}),R=Object(i.useCallback)((e=>{O({type:"updateModalOpen",modalName:e})}),[O]),_=Object(i.useCallback)(((e,t)=>{O({type:"setExceptionItemTotals",totalEndpointItems:e,totalDetectionsItems:t})}),[O]),F=Object(i.useCallback)((async()=>{await j({lists:n,filterOptions:[],pagination:{page:0,perPage:1,total:0},showDetectionsListsOnly:!0,showEndpointListsOnly:!1,onSuccess:({pagination:e})=>{var t;_(null,null!==(t=e.total)&&void 0!==t?t:0)},onError:()=>{p({color:"danger",title:WD.Q,iconType:"alert"})()}}),await j({lists:n,filterOptions:[],pagination:{page:0,perPage:1,total:0},showDetectionsListsOnly:!1,showEndpointListsOnly:!0,onSuccess:({pagination:e})=>{var t;_(null!==(t=e.total)&&void 0!==t?t:0,null)},onError:()=>{p({color:"danger",title:WD.Q,iconType:"alert"})()}})}),[_,n,j,p]),L=Object(i.useCallback)((()=>{null!=P&&(P(),F())}),[P,F]),B=Object(i.useCallback)((e=>{O({type:"updateFilterOptions",filters:e})}),[O]),z=Object(i.useCallback)((e=>{O({type:"updateExceptionListTypeToEdit",exceptionListType:e}),R("addException")}),[R]),U=Object(i.useCallback)((e=>{O({type:"updateExceptionToEdit",lists:n,exception:e}),R("editException")}),[R,n]),H=Object(i.useCallback)((()=>{R(null),L()}),[R,L]),$=Object(i.useCallback)((()=>{R(null),L()}),[R,L]),V=Object(i.useCallback)((e=>{O({type:"updateLoadingItemIds",items:e})}),[O]),Q=Object(i.useCallback)((({id:e,namespaceType:t})=>{V([{id:e,namespaceType:t}]),w({id:e,namespaceType:t,onSuccess:()=>{V(b.filter((({id:t})=>t!==e))),L()},onError:()=>{p({color:"danger",title:WD.p,iconType:"alert"})(),V(b.filter((({id:t})=>t!==e)))}})}),[V,w,b,L,p]);Object(i.useEffect)((()=>{!h||q||0!==m.length&&null==m||(F(),O({type:"updateIsInitLoading",loading:!1}))}),[F,h,m,q,O]);const W=c.application.getUrlForApp(`security/detections/rules/id/${encodeURI(e)}/edit`),G=!h&&!q&&0===T&&0===k,K=0===m.length&&(T>0||k>0);return r.a.createElement(r.a.Fragment,null,"editException"===y&&null!=E&&null!=v&&r.a.createElement(Gq,{ruleName:t,ruleId:e,ruleIndices:a,exceptionListType:v,exceptionItem:E,onCancel:H,onConfirm:$,onRuleChange:l}),"addException"===y&&null!=v&&r.a.createElement(Kq.a,{ruleName:t,ruleIndices:a,ruleId:e,exceptionListType:v,onCancel:H,onConfirm:$,onRuleChange:l}),r.a.createElement(Ms.a,{loading:h||q},(h||q)&&r.a.createElement(Fa.a,{"data-test-subj":"loadingPanelAllRulesTable",overlay:!0,size:"xl"}),r.a.createElement(KD,{isInitLoading:h,supportedListTypes:C,detectionsListItems:k,endpointListItems:T,onFilterChange:B,onAddExceptionClick:z}),r.a.createElement(N.EuiSpacer,{size:"l"}),r.a.createElement(tq,{pagination:f,showEndpointListsOnly:S,showDetectionsListsOnly:x,onRefreshClick:L,ruleSettingsUrl:W}),r.a.createElement(Sq,{disableActions:!M||!A,showEmpty:G,showNoResults:K,isInitLoading:h,exceptions:m,loadingItemIds:b,commentsAccordionId:o,onDeleteException:Q,onEditExceptionItem:U}),r.a.createElement(JD,{onPaginationChange:B,pagination:f})))};Jq.displayName="ExceptionsViewerComponent";const Xq=r.a.memo(Jq);Xq.displayName="ExceptionsViewer";var Zq=1e3,eP="siem",tP=("".concat(eP,".eqlRule"),"".concat(eP,".indicatorRule"),"".concat(eP,".mlRule"),"".concat(eP,".queryRule"),"".concat(eP,".savedQueryRule"),"".concat(eP,".thresholdRule"),a(111));const aP=Object(i.createContext)(null),nP=({children:e})=>{var t;const{storage:a}=Object(d.j)().services,[n,s]=Object(i.useState)([]),[l,c]=Object(i.useState)(1e3),[u,p]=Object(i.useState)(!0),[m,g]=Object(i.useState)("now-24h"),[f,b]=Object(i.useState)("now"),[h,y]=Object(i.useState)(""),[E,v]=Object(i.useState)([]),[T,k]=Object(i.useState)(null!==(t=a.get(o.Wb))&&void 0!==t&&t),[x,S]=Object(i.useState)(1),[O,w]=Object(i.useState)(5),[j,C]=Object(i.useState)("timestamp"),[I,M]=Object(i.useState)("desc"),A=Object(i.useMemo)((()=>({[ZP.executionLogs]:{state:{superDatePicker:{recentlyUsedRanges:n,refreshInterval:l,isPaused:u,start:m,end:f},queryText:h,statusFilters:E,showMetricColumns:T,pagination:{pageIndex:x,pageSize:O},sort:{sortField:j,sortDirection:I}},actions:{setEnd:b,setIsPaused:p,setPageIndex:S,setPageSize:w,setQueryText:y,setRecentlyUsedRanges:s,setRefreshInterval:c,setShowMetricColumns:k,setSortDirection:M,setSortField:C,setStart:g,setStatusFilters:v}}})),[f,u,x,O,h,n,l,T,I,j,m,E]);return r.a.createElement(aP.Provider,{value:A},e)},iP=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.searchPlaceholder",{defaultMessage:"duration > 100 and gapDuration > 10"}),rP=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.showMetricColumnsSwitchTitle",{defaultMessage:"Show metrics columns"}),sP=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.statusColumn",{defaultMessage:"Status"}),oP=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.statusColumnTooltip",{defaultMessage:"Overall status of execution."}),lP=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.timestampColumn",{defaultMessage:"Timestamp"}),cP=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.timestampColumnTooltip",{defaultMessage:"Datetime rule execution initiated."}),uP=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.durationColumn",{defaultMessage:"Duration"}),dP=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.durationColumnTooltip",{defaultMessage:"The length of time it took for the rule to run (hh:mm:ss:SSS)."}),pP=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.messageColumn",{defaultMessage:"Message"}),mP=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.messageColumnTooltip",{defaultMessage:"Relevant message from execution outcome."}),gP=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.gapDurationColumn",{defaultMessage:"Gap Duration"}),fP=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.gapTooltipSeeDocsDescription",{defaultMessage:"see documentation"}),bP=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.indexDurationColumn",{defaultMessage:"Index Duration"}),hP=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.indexDurationColumnTooltip",{defaultMessage:"The length of time it took to index detected alerts (hh:mm:ss:SSS)."}),yP=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.searchDurationColumn",{defaultMessage:"Search Duration"}),EP=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.searchDurationColumnTooltip",{defaultMessage:"The length of time it took to search for alerts (hh:mm:ss:SSS)."}),vP=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.schedulingDelayColumn",{defaultMessage:"Scheduling Delay"}),TP=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.schedulingDelayColumnTooltip",{defaultMessage:"The length of time from rule scheduled till rule executed (hh:mm:ss:SSS)."}),kP=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.actionsColumn",{defaultMessage:"Actions"}),xP=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.actionsColumnTooltip",{defaultMessage:"Filter alerts by rule execution ID."}),SP=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.actionSearchFiltersUpdatedTitle",{defaultMessage:"Global search filters have been updated"}),OP=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.actionSearchFiltersUpdatedDescription",{defaultMessage:"Search filters have been updated to show alerts from selected rule execution"}),wP=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.actionSearchFiltersUpdatedRestoreButtonTitle",{defaultMessage:"Restore previous filters"}),jP=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.actionFieldNotFoundErrorTitle",{defaultMessage:"Unable to filter alerts"}),CP=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.actionFieldNotFoundErrorDescription",{defaultMessage:"Cannot find field 'kibana.alert.rule.execution.uuid' in alerts index."}),IP=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.durationNotAvailableDescription",{defaultMessage:"N/A"}),MP=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.durationGreaterThanYearDescription",{defaultMessage:"> 1 Year"}),AP=e=>{const{duration:t,isSeconds:a=!1,allowZero:n=!0}=e,s=Object(i.useMemo)((()=>n&&t>=0?(e=>{if(!e)return"00:00:00:000";const t=Fn.a.duration(e),a=Math.floor(t.asDays()).toString().padStart(3,"0"),n=Math.floor(t.asHours()%24).toString().padStart(2,"0"),i=Math.floor(t.asMinutes()%60).toString().padStart(2,"0"),r=t.seconds().toString().padStart(2,"0"),s=t.milliseconds().toString().padStart(3,"0");return Math.floor(t.asDays())>0?Math.floor(t.asDays())>=365?MP:`${a}:${n}:${i}:${r}:${s}`:`${n}:${i}:${r}:${s}`})(a?1e3*t:t):IP),[n,t,a]);return r.a.createElement("span",{"data-test-subj":"rule-duration-format-value"},s)},DP=r.a.memo(AP);DP.displayName="RuleDurationFormat";const qP=[{name:r.a.createElement(mp,{title:sP,tooltipContent:oP}),field:"security_status",render:e=>e?r.a.createElement(N.EuiHealth,{color:vp(e)},Object(fn.capitalize)(e)):Object(vr.d)(),sortable:!1,truncateText:!1,width:"10%"},{field:"timestamp",name:r.a.createElement(mp,{title:lP,tooltipContent:cP}),render:e=>r.a.createElement(wn.a,{value:e,fieldName:"date"}),sortable:!0,truncateText:!1,width:"15%"},{field:"duration_ms",name:r.a.createElement(mp,{title:uP,tooltipContent:dP}),render:e=>r.a.createElement(r.a.Fragment,null,e?r.a.createElement(DP,{duration:e}):Object(vr.e)()),sortable:!0,truncateText:!1,width:"10%"},{field:"security_message",name:r.a.createElement(mp,{title:pP,tooltipContent:mP}),render:e=>r.a.createElement(r.a.Fragment,null,e),sortable:!1,truncateText:!1,width:"35%"}],PP=e=>[{field:"gap_duration_s",name:r.a.createElement(mp,{title:gP,customTooltip:r.a.createElement("div",{style:{maxWidth:"20px"}},r.a.createElement(dp,{columnName:gP},r.a.createElement(N.EuiText,{size:"s",style:{width:350}},r.a.createElement("p",null,r.a.createElement(It.FormattedMessage,{defaultMessage:"Duration of gap in Rule execution (hh:mm:ss:SSS). Adjust Rule look-back or {seeDocs} for mitigating gaps.",id:"xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.gapDurationColumnTooltip",values:{seeDocs:r.a.createElement(N.EuiLink,{href:`${e.links.siem.troubleshootGaps}`,target:"_blank"},fP)}})))))}),render:e=>r.a.createElement(r.a.Fragment,null,e?r.a.createElement(DP,{duration:e,isSeconds:!0}):Object(vr.e)()),sortable:!0,truncateText:!1,width:"10%"},{field:"indexing_duration_ms",name:r.a.createElement(mp,{title:bP,tooltipContent:hP}),render:e=>r.a.createElement(r.a.Fragment,null,e?r.a.createElement(DP,{duration:e}):Object(vr.e)()),sortable:!0,truncateText:!1,width:"10%"},{field:"search_duration_ms",name:r.a.createElement(mp,{title:yP,tooltipContent:EP}),render:e=>r.a.createElement(r.a.Fragment,null,e?r.a.createElement(DP,{duration:e}):Object(vr.e)()),sortable:!0,truncateText:!1,width:"10%"},{field:"schedule_delay_ms",name:r.a.createElement(mp,{title:vP,tooltipContent:TP}),render:e=>r.a.createElement(r.a.Fragment,null,e?r.a.createElement(DP,{duration:e}):Object(vr.e)()),sortable:!0,truncateText:!1,width:"10%"}],RP={status:"kibana.alert.rule.execution.status",timestamp:"@timestamp",duration:"event.duration",message:"message",gapDuration:"kibana.alert.rule.execution.metrics.execution_gap_duration_s",indexDuration:"kibana.alert.rule.execution.metrics.total_indexing_duration_ms",searchDuration:"kibana.alert.rule.execution.metrics.total_search_duration_ms",totalActions:"kibana.alert.rule.execution.metrics.number_of_triggered_actions",schedulingDelay:"kibana.task.schedule_delay"},_P=[gu.succeeded,gu.failed,gu["partial failure"]],FP=_P.map((e=>({label:r.a.createElement(N.EuiHealth,{color:vp(e)},Object(fn.capitalize)(e)),selected:!1}))),LP=r.a.memo((({onlyShowFilters:e,onSearch:t,onStatusFilterChange:a,defaultSelectedStatusFilters:n=[]})=>{const[s,o]=Object(i.useState)(!1),[l,c]=Object(i.useState)(n),u=Object(i.useCallback)((e=>{t((e=>Object.entries(RP).reduce(((e,[t,a])=>Object(fn.replace)(e,t,a)),e))(e))}),[t]),d=Object(i.useCallback)((e=>{c(l.includes(e)?l.filter((t=>t!==e)):[...l,e])}),[l]),p=Object(i.useMemo)((()=>_P.map(((e,t)=>r.a.createElement(N.EuiFilterSelectItem,{checked:l.includes(e)?"on":void 0,key:`${t}-${e}`,onClick:()=>d(e),title:e},r.a.createElement(N.EuiHealth,{color:vp(e)},Object(fn.capitalize)(e)))))),[d,l]);return Object(i.useEffect)((()=>{a(l)}),[a,l]),r.a.createElement(N.EuiFlexGroup,{gutterSize:"s"},r.a.createElement(N.EuiFlexItem,{grow:!0},!e&&r.a.createElement(N.EuiFieldSearch,{"data-test-subj":"executionLogSearch","aria-label":iP,placeholder:iP,onSearch:u,isClearable:!0,fullWidth:!0})),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiFilterGroup,null,r.a.createElement(N.EuiPopover,{button:r.a.createElement(N.EuiFilterButton,{grow:!1,"data-test-subj":"status-filter-popover-button",iconType:"arrowDown",onClick:()=>o(!s),numFilters:FP.length,isSelected:s,hasActiveFilters:l.length>0,numActiveFilters:l.length},sP),isOpen:s,closePopover:()=>o(!1),panelPaddingSize:"none",repositionOnScroll:!0},p))))}));LP.displayName="ExecutionLogSearchBar";const NP="kibana.alert.rule.execution.uuid",BP=z()(N.EuiSwitch).withConfig({displayName:"UtilitySwitch",componentId:"sc-4svvej-0"})(["margin-left:17px;"]),zP=z()(N.EuiFlexItem).withConfig({displayName:"DatePickerEuiFlexItem",componentId:"sc-4svvej-1"})(["max-width:582px;"]),UP=({ruleId:e,selectAlertsTab:t})=>{var a,n;const{docLinks:s,data:{query:{filterManager:c}},storage:u,timelines:p}=Object(d.j)().services,{[ZP.executionLogs]:{state:{superDatePicker:{recentlyUsedRanges:f,refreshInterval:b,isPaused:h,start:y,end:E},queryText:T,statusFilters:k,showMetricColumns:x,pagination:{pageIndex:S,pageSize:O},sort:{sortField:w,sortDirection:j}},actions:{setEnd:C,setIsPaused:I,setPageIndex:M,setPageSize:A,setQueryText:D,setRecentlyUsedRanges:q,setRefreshInterval:P,setShowMetricColumns:R,setSortDirection:_,setSortField:L,setStart:B,setStatusFilters:z}}}=(()=>{const e=Object(i.useContext)(aP);return on(e,"useRuleDetailsContext should be used inside RuleDetailsContextProvider"),e})(),{indexPattern:U}=Object(m.d)(g.SourcererScopeName.detections),{addError:H,addSuccess:$,remove:V}=Object(X.a)(),Q=Object(l.useDispatch)(),W=Object(i.useMemo)((()=>ae.e.globalFiltersQuerySelector()),[]),K=Object(i.useMemo)((()=>ae.e.globalQuerySelector()),[]),Y=Object(v.a)(ae.e.globalTimeRangeSelector),J=Object(v.a)(K),Z=Object(v.a)(W),ee=Object(i.useRef)({filters:Z,query:J,timerange:Y}),te=Object(i.useRef)(""),ne=Object(i.useCallback)((()=>{Object(tP.a)(ee.current.timerange)?Q(Object(G.setAbsoluteRangeDatePicker)({id:"global",from:ee.current.timerange.from,to:ee.current.timerange.to})):Object(tP.b)(ee.current.timerange)&&Q(Object(G.setRelativeRangeDatePicker)({id:"global",from:ee.current.timerange.from,fromStr:ee.current.timerange.fromStr,to:ee.current.timerange.to,toStr:ee.current.timerange.toStr})),Q(Object(G.setFilterQuery)({id:"global",query:ee.current.query.query,language:ee.current.query.language})),c.removeAll(),c.addFilters(ee.current.filters),V(te.current)}),[Q,c,V]),{data:ie,dataUpdatedAt:re,isFetching:se,isLoading:oe,refetch:le}=(({ruleId:e,start:t,end:a,queryText:n,statusFilters:i,page:r,perPage:s,sortField:o,sortOrder:l})=>{const{addError:c}=Object(X.a)();return Object(ln.useQuery)(["ruleExecutionEvents",{ruleId:e,start:t,end:a,queryText:n,statusFilters:i,page:r,perPage:s,sortField:o,sortOrder:l}],(async({signal:c})=>Object(cn.e)({ruleId:e,start:t,end:a,queryText:n,statusFilters:i,page:r,perPage:s,sortField:o,sortOrder:l,signal:c})),{keepPreviousData:!0,onError:e=>{c(e,{title:un.k})}})})({ruleId:e,start:y,end:E,queryText:T,statusFilters:k,page:S,perPage:O,sortField:w,sortOrder:j}),ce=null!==(a=null==ie?void 0:ie.events)&&void 0!==a?a:[],ue=null!==(n=null==ie?void 0:ie.total)&&void 0!==n?n:0,de=Object(i.useMemo)((()=>U.fields.find((e=>e.name===NP))),[U]),pe=Object(i.useCallback)((({page:e={},sort:t={}})=>{const{index:a,size:n}=e,{field:i,direction:r}=t;M(a+1),A(n),L(i),_(r)}),[M,A,_,L]),me=Object(i.useCallback)((e=>{const t=f.filter((t=>!(t.start===e.start&&t.end===e.end)));t.unshift({start:e.start,end:e.end}),B(e.start),C(e.end),q(t.length>10?t.slice(0,9):t)}),[f,C,q,B]),fe=Object(i.useCallback)((e=>{I(e.isPaused),P(e.refreshInterval>6e4?e.refreshInterval:6e4)}),[I,P]),be=Object(i.useCallback)((e=>{le()}),[le]),he=Object(i.useCallback)((e=>{D(e)}),[D]),ye=Object(i.useCallback)((e=>{z(e)}),[z]),Ee=Object(i.useCallback)(((e,a)=>{if(null!=de){ee.current={filters:Z,query:J,timerange:Y};const n=Object(oa.d)(U,de,oa.a.PHRASE,!1,!1,e,null);Q(Object(G.setAbsoluteRangeDatePicker)({id:"global",from:Fn()(a).subtract(1,"days").toISOString(),to:Fn()(a).add(1,"days").toISOString()})),c.removeAll(),c.addFilters(n),Q(Object(G.setFilterQuery)({id:"global",query:"",language:"kuery"})),t(),te.current=$({title:SP,text:Object(PS.mountReactNode)(r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,OP),r.a.createElement(N.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiButton,{size:"s",onClick:ne},wP)))))},{toastLifeTimeMs:6e5}).id}else H(CP,{title:jP})}),[H,$,Q,c,Z,U,J,ne,t,Y,de]),ve=Object(i.useCallback)((e=>{u.set(o.Wb,e),R(e)}),[R,u]),Te=Object(i.useMemo)((()=>({pageIndex:S-1,pageSize:O,totalItemCount:ue>Zq?Zq:ue,pageSizeOptions:[5,10,25,50]})),[ue,S,O]),ke=Object(i.useMemo)((()=>({sort:{field:w,direction:j}})),[j,w]),xe=Object(i.useMemo)((()=>[{field:NP,name:kP,width:"5%",actions:[{name:"Edit",isPrimary:!0,field:"",description:xP,icon:"filter",type:"icon",onClick:e=>{null!=e&&e.execution_uuid&&Ee(e.execution_uuid,e.timestamp)},"data-test-subj":"action-filter-by-execution-id"}]}]),[Ee]),Se=Object(i.useMemo)((()=>x?[...qP,...PP(s),...xe]:[...qP,...xe]),[xe,s,x]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiFlexGroup,{gutterSize:"s"},r.a.createElement(N.EuiFlexItem,{grow:!0},r.a.createElement(LP,{onSearch:he,onStatusFilterChange:ye,onlyShowFilters:!0,defaultSelectedStatusFilters:k})),r.a.createElement(zP,null,r.a.createElement(N.EuiSuperDatePicker,{start:y,end:E,onTimeChange:me,onRefresh:be,isPaused:h,isLoading:se,refreshInterval:b,onRefreshChange:fe,recentlyUsedRanges:f,width:"full"}))),r.a.createElement(N.EuiSpacer,{size:"s"}),r.a.createElement(ge.a,null,r.a.createElement(ge.d,null,r.a.createElement(ge.c,null,r.a.createElement(ge.f,{dataTestSubj:"executionsShowing"},(Oe=ue>Zq?Zq:ue,F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.totalExecutionsLabel",{values:{totalItems:Oe},defaultMessage:"Showing {totalItems} {totalItems, plural, =1 {rule execution} other {rule executions}}"})))),ue>Zq&&r.a.createElement(ge.c,{grow:!0},r.a.createElement(ge.f,{dataTestSubj:"exceptionsShowing",shouldWrap:!0},r.a.createElement(N.EuiTextColor,{color:"danger"},((e,t)=>F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.searchLimitExceededLabel",{values:{totalItems:e,maxItems:1e3},defaultMessage:"More than {totalItems} rule executions match filters provided. Showing first {maxItems} by most recent '@timestamp'. Constrain filters further to view additional execution events."}))(ue))))),r.a.createElement(ge.d,null,r.a.createElement(ge.c,null,r.a.createElement(ge.f,{dataTestSubj:"lastUpdated"},p.getLastUpdated({showUpdating:oe||se,updatedAt:re})),r.a.createElement(BP,{label:rP,checked:x,compressed:!0,onChange:e=>ve(e.target.checked)})))),r.a.createElement(N.EuiBasicTable,{columns:Se,items:ce,loading:se,pagination:Te,sorting:ke,onChange:pe}));var Oe},HP=r.a.memo(UP);HP.displayName="ExecutionLogTable",F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.pageTitle",{defaultMessage:"Rule details"});const $P=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.backToRulesButton",{defaultMessage:"Rules"}),VP=(F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.experimentalDescription",{defaultMessage:"Technical preview"}),F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.enableRuleLabel",{defaultMessage:"Enable"})),QP=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.unknownDescription",{defaultMessage:"Unknown"}),WP=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLogsTab",{defaultMessage:"Rule execution logs "}),GP=(F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.statusFailedDescription",{defaultMessage:"Failed"}),F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.exceptionsTab",{defaultMessage:"Exceptions"})),KP=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.deletedRule",{defaultMessage:"Deleted rule"});var YP=a(836);const JP=z.a.div.withConfig({displayName:"StyledFullHeightContainer",componentId:"sc-ycgey0-0"})(["display:flex;flex-direction:column;flex:1 1 auto;"]),XP=z.a.div.withConfig({displayName:"StyledMinHeightTabContainer",componentId:"sc-ycgey0-1"})(["min-height:800px;"]);let ZP;!function(e){e.alerts="alerts",e.executionLogs="executionLogs",e.exceptions="exceptions"}(ZP||(ZP={}));const eR=[{id:ZP.alerts,name:Ne,disabled:!1,dataTestSubj:"alertsTab"},{id:ZP.exceptions,name:GP,disabled:!1,dataTestSubj:"exceptionsTab"},{id:ZP.executionLogs,name:WP,disabled:!1,dataTestSubj:"executionLogsTab"}],tR=({clearEventsDeleted:e,clearEventsLoading:t,clearSelected:a})=>{var s,f,h,k,x,S;const{navigateToApp:O}=Object(d.j)().services.application,w=Object(l.useDispatch)(),j=Object(i.useRef)(null),C=Object(i.useMemo)((()=>p.b.getTimelineByIdSelector()),[]),I=Object(v.b)((e=>{var t;return(null!==(t=C(e,c.i.detectionsRulesDetailsPage))&&void 0!==t?t:le.a).graphEventId})),M=Object(v.b)((e=>{var t;return(null!==(t=C(e,c.i.detectionsRulesDetailsPage))&&void 0!==t?t:le.a).updated})),A=Object(v.b)((e=>{var t;return(null!==(t=C(e,c.i.detectionsPage))&&void 0!==t?t:le.a).isLoading})),D=Object(i.useMemo)((()=>W.d.globalFiltersQuerySelector()),[]),q=Object(i.useMemo)((()=>W.d.globalQuerySelector()),[]),R=Object(v.a)(q),_=Object(v.a)(D),{to:L,from:B}=Object(H.a)(),[{loading:z,isSignalIndexExists:K,isAuthenticated:Y,hasEncryptionKey:J,canUserCRUD:X,hasIndexWrite:Z,hasIndexRead:ee,hasIndexMaintenance:te,signalIndexName:ae}]=Object(_e.b)(),{loading:ne,needsConfiguration:ie}=lt(),{indexPattern:re,runtimeMappings:se,loading:ce}=Object(m.d)(g.SourcererScopeName.detections),ue=z||ne,{detailName:de}=Object(P.useParams)(),{rule:pe,refresh:me,loading:ge,isExistingRule:fe}=Object(YP.a)(de),{pollForSignalIndex:be}=Object(mt.a)(),[ye,ve]=Object(i.useState)(null),Te=ge&&null==ye,[ke,xe]=Object(i.useState)(ZP.alerts),[Se,Oe]=Object(i.useState)(eR),{aboutRuleData:je,modifiedAboutRuleDetailsData:Ce,defineRuleData:Me,scheduleRuleData:Ae}=null!=ye?ri({rule:ye,detailsView:!0}):{aboutRuleData:null,modifiedAboutRuleDetailsData:null,defineRuleData:null,scheduleRuleData:null},[De,qe]=Object(i.useState)(!1),[Pe,Fe]=Object(i.useState)(!1),Le=Object(Pi.a)(),{formatUrl:Ne}=Object(u.k)(T.a.rules),{globalFullScreen:Be}=Object(dt.a)(),[ze,Ue]=Object(i.useState)(he),He=Object(bp.a)(Le)&&Object(fp.a)(Le),{services:{application:{capabilities:{actions:$e}},timelines:Ve,spaces:Qe}}=Object(d.j)(),We=Object(i.useMemo)((()=>!(null!=(null==ye?void 0:ye.actions)&&(null==ye?void 0:ye.actions.length)>0&&cu($e.show))||$e.show),[$e,null==ye?void 0:ye.actions]);Object(i.useEffect)((()=>{null!=pe&&ve(pe)}),[pe]),Object(i.useEffect)((()=>{if(ye){const e=ye.outcome;if(Qe&&"aliasMatch"===e){const e=`rules/id/${ye.id}${window.location.search}${window.location.hash}`;Qe.ui.redirectLegacyUrl({path:e,aliasPurpose:ye.alias_purpose,objectNoun:F.i18n.translate("xpack.triggersActionsUI.sections.ruleDetails.redirectObjectNoun",{defaultMessage:"rule"})})}}}),[ye,Qe]);const Ge=Object(i.useMemo)((()=>{if(null!=(null==ye?void 0:ye.alias_target_id)&&Qe&&"conflict"===ye.outcome){const e=ye.alias_target_id,t=`rules/id/${e}${window.location.search}${window.location.hash}`;return r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiSpacer,null),Qe.ui.components.getLegacyUrlConflict({objectNoun:F.i18n.translate("xpack.triggersActionsUI.sections.ruleDetails.redirectObjectNoun",{defaultMessage:"rule"}),currentObjectId:ye.id,otherObjectId:e,otherObjectPath:t}))}return null}),[ye,Qe]);Object(i.useEffect)((()=>{ee?(Oe(eR),xe(ZP.alerts)):(Oe(eR.filter((({id:e})=>e!==ZP.alerts))),xe(ZP.exceptions))}),[ee]);const Ke=Object(i.useMemo)((()=>ce||A||ue),[ce,A,ue]),Ye=Object(i.useMemo)((()=>r.a.createElement(r.a.Fragment,null,null==ye?void 0:ye.name," ",ge&&r.a.createElement(N.EuiLoadingSpinner,{size:"m"}))),[ye,ge]),Je=Object(i.useMemo)((()=>ge||fe?void 0:{text:KP,color:"default"}),[fe,ge]),Xe=Object(i.useMemo)((()=>{var e,t,a,n;return ye?[r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.ruleDetails.ruleCreationDescription",defaultMessage:"Created by: {by} on {date}",values:{by:null!==(e=null==ye?void 0:ye.created_by)&&void 0!==e?e:QP,date:r.a.createElement(wn.a,{value:null!==(t=null==ye?void 0:ye.created_at)&&void 0!==t?t:(new Date).toISOString(),fieldName:"createdAt"})}}),null!=(null==ye?void 0:ye.updated_by)?r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.ruleDetails.ruleUpdateDescription",defaultMessage:"Updated by: {by} on {date}",values:{by:null!==(a=null==ye?void 0:ye.updated_by)&&void 0!==a?a:QP,date:r.a.createElement(wn.a,{value:null!==(n=null==ye?void 0:ye.updated_at)&&void 0!==n?n:(new Date).toISOString(),fieldName:"updatedAt"})}}):""]:ge?r.a.createElement(N.EuiLoadingSpinner,{size:"m"}):null}),[ye,ge]),Ze=Object(i.useCallback)((n=>{const i=c.i.detectionsRulesDetailsPage;t({id:i}),e({id:i}),a({id:i}),Ue(n)}),[t,e,a,Ue]);Object(i.useEffect)((()=>{qe(null!=(null==ye?void 0:ye.building_block_type))}),[ye]);const et=Object(i.useMemo)((()=>{var e;return[...Object(we.e)(null!==(e=null==ye?void 0:ye.rule_id)&&void 0!==e?e:""),...Object(we.f)(De),...Object(we.c)(ze),...Object(we.g)(Pe)]}),[ye,De,Pe,ze]),tt=Object(i.useMemo)((()=>{var e;return[...Object(we.e)(null!==(e=null==ye?void 0:ye.rule_id)&&void 0!==e?e:""),...Object(we.f)(De),...Object(we.g)(Pe)]}),[ye,De,Pe]),at=Object(i.useMemo)((()=>[...et,..._]),[et,_]),nt=Object(i.useMemo)((()=>r.a.createElement(N.EuiTabs,null,Se.map((e=>r.a.createElement(N.EuiTab,{onClick:()=>xe(e.id),isSelected:e.id===ke,disabled:e.disabled||e.id===ZP.executionLogs&&!fe,key:e.id,"data-test-subj":e.dataTestSubj},e.name))))),[fe,ke,xe,Se]),it=Object(i.useMemo)((()=>{var e;return null!==(e=null==ye?void 0:ye.index)&&void 0!==e?e:o.O}),[null==ye?void 0:ye.index]),rt=null==ye||null===(s=ye.execution_summary)||void 0===s?void 0:s.last_execution,st=null==rt?void 0:rt.status,ot=null!==(f=null==rt?void 0:rt.date)&&void 0!==f?f:"",ct=null!==(h=null==rt?void 0:rt.message)&&void 0!==h?h:"",gt=Object(i.useMemo)((()=>ge?r.a.createElement(N.EuiFlexItem,null,r.a.createElement(N.EuiLoadingSpinner,{size:"m","data-test-subj":"rule-status-loader"})):r.a.createElement(Cp,{status:st,date:ot},r.a.createElement(N.EuiButtonIcon,{"data-test-subj":"refreshButton",color:"primary",onClick:me,iconType:"refresh","aria-label":nn.Pb,isDisabled:!fe}))),[st,ot,ge,fe,me]),ft=Object(i.useMemo)((()=>ge?r.a.createElement(N.EuiFlexItem,null,r.a.createElement(N.EuiLoadingSpinner,{size:"m","data-test-subj":"rule-status-loader"})):r.a.createElement(qp,{status:st,date:ot,message:ct})),[st,ot,ct,ge]),bt=Object(i.useCallback)((({x:e})=>{if(!e)return;const[t,a]=e;w(Object(G.setAbsoluteRangeDatePicker)({id:"global",from:new Date(t).toISOString(),to:new Date(a).toISOString()}))}),[w]),ht=Object(i.useCallback)((e=>{ve((t=>t?{...t,enabled:e}:t))}),[]),yt=Object(i.useCallback)((e=>{e.preventDefault(),O(o.y,{deepLinkId:T.a.rules,path:Object(V.b)(null!=de?de:"")})}),[O,de]),Et=Object(i.useMemo)((()=>We?r.a.createElement(ut.g,{onClick:yt,iconType:"controlsHorizontal",isDisabled:!fe||!vi(X),href:Ne(Object(V.b)(null!=de?de:""))},nn.ub):r.a.createElement(N.EuiToolTip,{position:"top",content:nn.vb},r.a.createElement(ut.g,{onClick:yt,iconType:"controlsHorizontal",isDisabled:!0,href:Ne(Object(V.b)(null!=de?de:""))},nn.ub))),[fe,X,Ne,yt,We,de]),vt=Object(i.useCallback)((e=>{qe(e)}),[qe]),Tt=Object(i.useCallback)((e=>{Fe(e)}),[Fe]),kt=Object(i.useMemo)((()=>null!=ye&&null!=ye.exceptions_list?ye.exceptions_list.reduce(((e,{id:t,list_id:a,namespace_type:n,type:i})=>{const{allowedExceptionListTypes:r,lists:s}=e;return{lists:[...s,{id:t,listId:a,namespaceType:n,type:i}],allowedExceptionListTypes:i!==Gu.a.ENDPOINT||r.includes(Gu.a.ENDPOINT)?r:[...r,Gu.a.ENDPOINT]}}),{lists:[],allowedExceptionListTypes:[Gu.a.DETECTION]}):{lists:[],allowedExceptionListTypes:[Gu.a.DETECTION]}),[ye]),xt=Object(i.useCallback)((()=>{Object(oe.k)(j.current)}),[j]),St=Object(i.useCallback)((()=>{Object(oe.m)()}),[]),Ot=Object(i.useCallback)((e=>{Object(U.isTab)(e)&&Object(oe.l)({containerElement:j.current,keyboardEvent:e,onSkipFocusBeforeEventsTable:xt,onSkipFocusAfterEventsTable:St})}),[j,xt,St]),wt=Object(i.useCallback)((()=>{xe(ZP.alerts)}),[]);return hi(K,Y,J,ie)?(O(o.y,{deepLinkId:T.a.alerts,path:Object(V.a)()}),null):r.a.createElement(r.a.Fragment,null,r.a.createElement(Ut,null),r.a.createElement(ia,null),r.a.createElement(JP,{onKeyDown:Ot,ref:j},r.a.createElement(N.EuiWindowEvent,{event:"resize",handler:E.noop}),r.a.createElement($.a,{show:Object(oe.n)({globalFullScreen:Be,graphEventId:I})},r.a.createElement(Q.a,{id:"global",pollForSignalIndex:be,indexPattern:re})),r.a.createElement(nP,null,r.a.createElement(b.a,{noPadding:Be},r.a.createElement(pt,{show:!Be},r.a.createElement(Ta.a,{backOptions:{path:Object(V.d)(),text:$P,pageId:T.a.rules,dataTestSubj:"ruleDetailsBackToAllRules"},border:!0,subtitle:Xe,subtitle2:r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",justifyContent:"flexStart"},r.a.createElement(N.EuiFlexItem,{grow:!1},n.STATUS,":"),gt)),title:Ye,badgeOptions:Je},r.a.createElement(N.EuiFlexGroup,{alignItems:"center"},r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiToolTip,{position:"top",content:du(ye,He,We)},r.a.createElement(N.EuiFlexGroup,null,r.a.createElement(lp,{id:null!==(k=null==ye?void 0:ye.id)&&void 0!==k?k:"-1",isDisabled:!(fe&&uu(ye,We)&&vi(X)&&(He||null!=ye&&ye.enabled)),enabled:fe&&null!==(x=null==ye?void 0:ye.enabled)&&void 0!==x&&x,onChange:ht}),r.a.createElement(N.EuiFlexItem,null,VP)))),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1},r.a.createElement(N.EuiFlexItem,{grow:!1},Et),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(QD,{rule:ye,userHasPermissions:fe&&vi(X),canDuplicateRuleWithActions:uu(ye,We)})))))),ft,Ge,r.a.createElement(N.EuiSpacer,null),r.a.createElement(N.EuiFlexGroup,null,r.a.createElement(N.EuiFlexItem,{"data-test-subj":"aboutRule",component:"section",grow:1},r.a.createElement(ND,{loading:Te,stepData:je,stepDataDetails:Ce})),r.a.createElement(N.EuiFlexItem,{grow:1},r.a.createElement(N.EuiFlexGroup,{direction:"column"},r.a.createElement(N.EuiFlexItem,{component:"section",grow:1},r.a.createElement(UD,{loading:Te,title:nn.lb},null!=Me&&r.a.createElement(gA,{descriptionColumns:"singleSplit",isReadOnlyView:!0,isLoading:!1,defaultValues:Me}))),r.a.createElement(N.EuiSpacer,null),r.a.createElement(N.EuiFlexItem,{"data-test-subj":"schedule",component:"section",grow:1},r.a.createElement(UD,{loading:Te,title:nn.sc},null!=Ae&&r.a.createElement(gD,{descriptionColumns:"singleSplit",isReadOnlyView:!0,isLoading:!1,defaultValues:Ae})))))),r.a.createElement(N.EuiSpacer,null),nt,r.a.createElement(N.EuiSpacer,null)),r.a.createElement(XP,null,ke===ZP.alerts&&ee&&r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween"},r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(Ee,{status:ze,onFilterGroupChanged:Ze})),r.a.createElement(N.EuiFlexItem,{grow:!1},M&&Ve.getLastUpdated({updatedAt:M||Date.now(),showUpdating:Ke}))),r.a.createElement(N.EuiSpacer,{size:"l"}),r.a.createElement(pt,{show:!Be},r.a.createElement(Re.a,{filters:at,query:R,signalIndexName:ae,defaultStackByOption:"event.category",updateDateRange:bt,runtimeMappings:se}),r.a.createElement(N.EuiSpacer,null)),null!=de&&r.a.createElement(Ie,{filterGroup:ze,timelineId:c.i.detectionsRulesDetailsPage,defaultFilters:tt,hasIndexWrite:null!=Z&&Z,hasIndexMaintenance:null!=te&&te,from:B,loading:ue,showBuildingBlockAlerts:De,showOnlyThreatIndicatorAlerts:Pe,onShowBuildingBlockAlertsChanged:vt,onShowOnlyThreatIndicatorAlertsChanged:Tt,onRuleChange:me,to:L})),ke===ZP.exceptions&&r.a.createElement(Xq,{ruleId:null!=de?de:"",ruleName:null!==(S=null==ye?void 0:ye.name)&&void 0!==S?S:"",ruleIndices:it,availableListTypes:kt.allowedExceptionListTypes,commentsAccordionId:"ruleDetailsTabExceptions",exceptionListsMeta:kt.lists,onRuleChange:me}),ke===ZP.executionLogs&&r.a.createElement(HP,{ruleId:de,selectAlertsTab:wt}))))),r.a.createElement(y.a,{pageName:T.a.rules,state:{ruleName:null==ye?void 0:ye.name}}))},aR=Object(l.connect)(null,(e=>({clearSelected:({id:t})=>e(p.a.clearSelected({id:t})),clearEventsLoading:({id:t})=>e(p.a.clearEventsLoading({id:t})),clearEventsDeleted:({id:t})=>e(p.a.clearEventsDeleted({id:t}))})));tR.displayName="RuleDetailsPageComponent";const nR=aR(r.a.memo(tR));nR.displayName="RuleDetailsPage";const iR=F.i18n.translate("xpack.securitySolution.detectionEngine.editRule.pageTitle",{defaultMessage:"Edit rule settings"}),rR=F.i18n.translate("xpack.securitySolution.detectionEngine.editRule.cancelTitle",{defaultMessage:"Cancel"}),sR=F.i18n.translate("xpack.securitySolution.detectionEngine.editRule.saveChangeTitle",{defaultMessage:"Save changes"}),oR=F.i18n.translate("xpack.securitySolution.detectionEngine.editRule.errorMsgDescription",{defaultMessage:"Sorry"}),lR=F.i18n.translate("xpack.securitySolution.detectionEngine.editRule.backToDescription",{defaultMessage:"Back to"}),cR=async()=>{},uR=()=>{var e;const[,t]=Object(J.g)(),[{loading:a,isSignalIndexExists:n,isAuthenticated:s,hasEncryptionKey:l,canUserCRUD:c}]=Object(_e.b)(),{loading:u,needsConfiguration:p}=lt(),{navigateToApp:m}=Object(d.j)().services.application,{detailName:g}=Object(P.useParams)(),[f,h]=ep(g),v=f||a||u,k=Object(i.useRef)({[HO.a.defineRule]:cR,[HO.a.aboutRule]:cR,[HO.a.scheduleRule]:cR,[HO.a.ruleActions]:cR}),x=Object(i.useRef)({[HO.a.defineRule]:{isValid:!1,data:void 0},[HO.a.aboutRule]:{isValid:!1,data:void 0},[HO.a.scheduleRule]:{isValid:!1,data:void 0},[HO.a.ruleActions]:{isValid:!1,data:void 0}}),S=x.current[HO.a.defineRule],O=x.current[HO.a.aboutRule],w=x.current[HO.a.scheduleRule],j=x.current[HO.a.ruleActions],[C,I]=Object(i.useState)(HO.a.defineRule),M=yD.b.filter((e=>{const t=x.current[e];return null!=t.data&&!Gj(t)})),[{isLoading:A,isSaved:D},q]=(()=>{const[e,t]=Object(i.useState)(null),[a,n]=Object(i.useState)(!1),[r,s]=Object(i.useState)(!1),{addError:o}=Object(X.a)(),l=mn();return Object(i.useEffect)((()=>{let t=!0;const a=new AbortController;return n(!1),(async()=>{if(null!=e){try{s(!0),await Object(cn.n)({rule:Object(Wu.b)(e),signal:a.signal}),l(),t&&n(!0)}catch(e){t&&o(e,{title:un.g})}t&&s(!1)}})(),()=>{t=!1,a.abort()}}),[e,o,l]),[{isLoading:r,isSaved:a},t]})(),R=Object(i.useMemo)((()=>Ei(null==h?void 0:h.type)),[null==h?void 0:h.type]),_=Object(i.useCallback)(((e,t)=>{k.current[e]=t,e===C&&t()}),[C]),L=Object(i.useCallback)(((e,t,a)=>{x.current[e]={...x.current[e],data:t,isValid:a}}),[]),B=Object(i.useMemo)((()=>[{"data-test-subj":"edit-rule-define-tab",id:HO.a.defineRule,name:nn.lb,disabled:null==h?void 0:h.immutable,content:r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiSpacer,null),r.a.createElement(UD,{loading:v,title:nn.lb},null!=S.data&&r.a.createElement(gA,{isReadOnlyView:!1,isLoading:A,isUpdateView:!0,defaultValues:S.data,setForm:_}),r.a.createElement(N.EuiSpacer,null)))},{"data-test-subj":"edit-rule-about-tab",id:HO.a.aboutRule,name:nn.a,disabled:null==h?void 0:h.immutable,content:r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiSpacer,null),r.a.createElement(UD,{loading:v,title:nn.a},null!=O.data&&null!=S.data&&r.a.createElement(nD,{isReadOnlyView:!1,isLoading:A,isUpdateView:!0,defaultValues:O.data,defineRuleData:S.data,setForm:_}),r.a.createElement(N.EuiSpacer,null)))},{"data-test-subj":"edit-rule-schedule-tab",id:HO.a.scheduleRule,name:nn.sc,disabled:null==h?void 0:h.immutable,content:r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiSpacer,null),r.a.createElement(UD,{loading:v,title:nn.sc},null!=w.data&&r.a.createElement(gD,{isReadOnlyView:!1,isLoading:A,isUpdateView:!0,defaultValues:w.data,setForm:_}),r.a.createElement(N.EuiSpacer,null)))},{"data-test-subj":"edit-rule-actions-tab",id:HO.a.ruleActions,name:nn.c,content:r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiSpacer,null),r.a.createElement(UD,{loading:v,title:nn.c},null!=j.data&&r.a.createElement(Qj,{isReadOnlyView:!1,isLoading:A,isUpdateView:!0,defaultValues:j.data,setForm:_,actionMessageParams:R}),r.a.createElement(N.EuiSpacer,null)))}]),[null==h?void 0:h.immutable,v,S.data,A,_,O.data,w.data,j.data,R]),{startTransaction:z}=Vu(),U=Object(i.useCallback)((async()=>{const e=await k.current[C]();null!=(null==e?void 0:e.data)&&L(C,e.data,e.isValid);const t=(a=e,Object(E.has)("data.ruleType",a)?e:S);var a;const n=(e=>Object(E.has)("data.name",e))(e)?e:O,i=(e=>Object(E.has)("data.interval",e))(e)?e:w,r=(e=>Object(E.has)("data.actions",e))(e)?e:j;Gj(t)&&Gj(n)&&Gj(i)&&Gj(r)&&(z({name:Du}),q({...aC(t.data,n.data,i.data,r.data,h),...g?{id:g}:{},...null!=h?{max_signals:h.max_signals}:{}}))}),[O,j,C,S,h,g,w,q,L,z]);Object(i.useEffect)((()=>{if(null!=h){const{aboutRuleData:e,defineRuleData:t,scheduleRuleData:a,ruleActionsData:n}=ri({rule:h});L(HO.a.defineRule,t,!0),L(HO.a.aboutRule,e,!0),L(HO.a.scheduleRule,a,!0),L(HO.a.ruleActions,n,!0)}}),[h,L]);const H=Object(i.useCallback)((async e=>{I(e),await k.current[e]()}),[]),$=Object(i.useCallback)((async e=>{const t=e.id,a=await k.current[C]();null!=(null==a?void 0:a.data)&&(L(C,a.data,a.isValid),H(t))}),[C,H,L]),Q=Object(i.useCallback)((e=>{e.preventDefault(),m(o.y,{deepLinkId:T.a.rules,path:Object(V.c)(null!=g?g:"")})}),[m,g]);var W,G;return Object(i.useEffect)((()=>{null!=h&&h.immutable?I(HO.a.ruleActions):I(HO.a.defineRule)}),[h]),D?(Object(J.e)((G=null!==(W=null==h?void 0:h.name)&&void 0!==W?W:"",F.i18n.translate("xpack.securitySolution.detectionEngine.rules.update.successfullySavedRuleTitle",{values:{ruleName:G},defaultMessage:"{ruleName} was saved"})),t),m(o.y,{deepLinkId:T.a.rules,path:Object(V.c)(null!=g?g:"")}),null):hi(n,s,l,p)?(m(o.y,{deepLinkId:T.a.alerts,path:Object(V.a)()}),null):vi(c)?r.a.createElement(r.a.Fragment,null,r.a.createElement(b.a,null,r.a.createElement(N.EuiFlexGroup,{direction:"row",justifyContent:"spaceAround"},r.a.createElement(Ti,null,r.a.createElement(Ta.a,{backOptions:{path:Object(V.c)(null!=g?g:""),text:`${lR} ${null!==(e=null==h?void 0:h.name)&&void 0!==e?e:""}`,pageId:T.a.rules,dataTestSubj:"ruleEditBackToRuleDetails"},isLoading:A,title:iR}),M.length>0&&r.a.createElement(N.EuiCallOut,{title:oR,color:"danger",iconType:"alert"},r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rule.editRule.errorMsgDescription",defaultMessage:"You have an invalid input in {countError, plural, one {this tab} other {these tabs}}: {tabHasError}",values:{countError:M.length,tabHasError:M.map((e=>e===HO.a.aboutRule?nn.a:e===HO.a.defineRule?nn.lb:e===HO.a.scheduleRule?nn.sc:e===HO.a.ruleActions?nn.rc:e)).join(", ")}})),r.a.createElement(N.EuiTabbedContent,{initialSelectedTab:B[0],selectedTab:B.find((e=>e.id===C)),onTabClick:$,tabs:B}),r.a.createElement(N.EuiSpacer,null),r.a.createElement(N.EuiFlexGroup,{alignItems:"center",gutterSize:"s",justifyContent:"flexEnd",responsive:!1},r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiButton,{iconType:"cross",onClick:Q},rR)),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiButton,{"data-test-subj":"ruleEditSubmitButton",fill:!0,onClick:U,iconType:"save",isLoading:A,isDisabled:v},sR)))))),r.a.createElement(y.a,{pageName:T.a.rules,state:{ruleName:null==h?void 0:h.name}})):(m(o.y,{deepLinkId:T.a.rules,path:Object(V.c)(null!=g?g:"")}),null)},dR=[{path:"/rules/id/:detailName/edit",main:Object(i.memo)(uR),exact:!0},{path:"/rules/id/:detailName",main:nR,exact:!0},{path:"/rules/create",main:xD,exact:!0},{path:"/rules",main:CO,exact:!0}],pR=()=>(Ca(yx),r.a.createElement(s.TrackApplicationView,{viewId:o.cc.rules},r.a.createElement(P.Switch,null,dR.map(((e,t)=>{var a;return r.a.createElement(R.Route,{key:`rules-route-${e.path}`,path:e.path,exact:null!==(a=null==e?void 0:e.exact)&&void 0!==a&&a},r.a.createElement(e.main,null))})),r.a.createElement(R.Route,{component:_.a})))),mR=r.a.memo(pR),gR=[{path:o.Ub,render:()=>r.a.createElement(mR,null)}];var fR=a(797),bR=a(345),hR=a(713),yR=a(407),ER=a(61);const vR=z.a.div.withConfig({displayName:"TimelinesContainer",componentId:"sc-13wjqgh-0"})(["width:100%;"]),TR=()=>{const{tabName:e}=Object(P.useParams)(),[t,a]=Object(i.useState)(!1),n=Object(i.useCallback)((()=>{a(!0)}),[a]),{indicesExist:s}=Object(m.d)(),o=!!Object(d.j)().services.application.capabilities.siem.crud;return r.a.createElement(r.a.Fragment,null,s?r.a.createElement(r.a.Fragment,null,r.a.createElement(b.a,null,r.a.createElement(Ta.a,{title:ER.d},r.a.createElement(N.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},r.a.createElement(N.EuiFlexItem,null,o&&r.a.createElement(N.EuiButton,{iconType:"indexOpen",onClick:n,"data-test-subj":"open-import-data-modal-btn"},ER.a)),e===c.m.default?r.a.createElement(N.EuiFlexItem,null,r.a.createElement(yR.c,{timelineId:c.i.active,outline:!0,"data-test-subj":"create-default-btn"})):r.a.createElement(N.EuiFlexItem,null,r.a.createElement(hR.a,{outline:!0,title:bR.g,"data-test-subj":"create-template-btn"})))),r.a.createElement(vR,{"data-test-subj":"timelines-container"},r.a.createElement(fR.a,{defaultPageSize:10,isModal:!1,importDataModalToggle:t&&o,setImportDataModalToggle:a,title:ER.b,"data-test-subj":"stateful-open-timeline"})))):r.a.createElement(ka.a,null),r.a.createElement(y.a,{pageName:T.a.timelines}))},kR=r.a.memo(TR),xR=`${o.dc}/:tabName(${c.m.default}|${c.m.template})`,SR=`${o.dc}/${c.m.default}`,OR=r.a.memo((()=>r.a.createElement(P.Switch,null,r.a.createElement(R.Route,{exact:!0,path:xR},r.a.createElement(kR,null)),r.a.createElement(R.Route,{path:o.dc,render:({location:{search:e=""}})=>r.a.createElement(P.Redirect,{to:`${SR}${Object(ox.a)(e)}`})}))));OR.displayName="Timelines";const wR=[{path:o.dc,render:()=>r.a.createElement(s.TrackApplicationView,{viewId:T.a.timelines},r.a.createElement(OR,null))}];var jR=a(47),CR=a(54);const IR={timelineById:{},autoSavedWarningMsg:{timelineId:null,newTimelineModel:null},showCallOutUnauthorizedMsg:!1,insertTimeline:null},MR=Object(jR.reducerWithInitialState)(IR).case(k.addTimeline,((e,{id:t,timeline:a,resolveTimelineConfig:n})=>({...e,timelineById:Object(CR.f)({id:t,timeline:a,resolveTimelineConfig:n,timelineById:e.timelineById})}))).case(k.createTimeline,((e,{id:t,timelineType:a=c.m.default,...n})=>({...e,timelineById:Object(CR.a)({id:t,timelineById:e.timelineById,timelineType:a,...n})}))).case(k.addHistory,((e,{id:t,historyId:a})=>({...e,timelineById:Object(CR.b)({id:t,historyId:a,timelineById:e.timelineById})}))).case(k.addNote,((e,{id:t,noteId:a})=>({...e,timelineById:Object(CR.c)({id:t,noteId:a,timelineById:e.timelineById})}))).case(k.addNoteToEvent,((e,{id:t,noteId:a,eventId:n})=>({...e,timelineById:Object(CR.d)({id:t,noteId:a,eventId:n,timelineById:e.timelineById})}))).case(k.addProvider,((e,{id:t,provider:a})=>({...e,timelineById:Object(CR.e)({id:t,provider:a,timelineById:e.timelineById})}))).case(k.applyKqlFilterQuery,((e,{id:t,filterQuery:a})=>({...e,timelineById:Object(CR.g)({id:t,filterQuery:a,timelineById:e.timelineById})}))).case(k.showTimeline,((e,{id:t,show:a})=>({...e,timelineById:Object(CR.C)({id:t,show:a,timelineById:e.timelineById})}))).case(k.updateTimelineGraphEventId,((e,{id:t,graphEventId:a})=>({...e,timelineById:Object(CR.n)({id:t,graphEventId:a,timelineById:e.timelineById})}))).case(k.updateTimelineSessionViewConfig,((e,{id:t,sessionViewConfig:a})=>({...e,timelineById:Object(CR.p)({id:t,sessionViewConfig:a,timelineById:e.timelineById})}))).case(k.pinEvent,((e,{id:t,eventId:a})=>({...e,timelineById:Object(CR.i)({id:t,eventId:a,timelineById:e.timelineById})}))).case(k.removeProvider,((e,{id:t,providerId:a,andProviderId:n})=>({...e,timelineById:Object(CR.j)({id:t,providerId:a,timelineById:e.timelineById,andProviderId:n})}))).case(k.startTimelineSaving,((e,{id:t})=>({...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],isSaving:!0}}}))).case(k.endTimelineSaving,((e,{id:t})=>({...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],isSaving:!1}}}))).case(k.setExcludedRowRendererIds,((e,{id:t,excludedRowRendererIds:a})=>({...e,timelineById:Object(CR.l)({id:t,excludedRowRendererIds:a,timelineById:e.timelineById})}))).case(k.updateTimeline,((e,{id:t,timeline:a})=>({...e,timelineById:{...e.timelineById,[t]:a}}))).case(k.unPinEvent,((e,{id:t,eventId:a})=>({...e,timelineById:Object(CR.k)({id:t,eventId:a,timelineById:e.timelineById})}))).case(k.updateEventType,((e,{id:t,eventType:a})=>({...e,timelineById:Object(CR.q)({id:t,eventType:a,timelineById:e.timelineById})}))).case(k.updateIsFavorite,((e,{id:t,isFavorite:a})=>({...e,timelineById:Object(CR.r)({id:t,isFavorite:a,timelineById:e.timelineById})}))).case(k.updateIsLive,((e,{id:t,isLive:a})=>({...e,timelineById:Object(CR.s)({id:t,isLive:a,timelineById:e.timelineById})}))).case(k.updateKqlMode,((e,{id:t,kqlMode:a})=>({...e,timelineById:Object(CR.t)({id:t,kqlMode:a,timelineById:e.timelineById})}))).case(k.updateTitleAndDescription,((e,{id:t,title:a,description:n})=>({...e,timelineById:Object(CR.D)({id:t,title:a,description:n,timelineById:e.timelineById})}))).case(k.updateProviders,((e,{id:t,providers:a})=>({...e,timelineById:Object(CR.A)({id:t,providers:a,timelineById:e.timelineById})}))).case(k.updateRange,((e,{id:t,start:a,end:n})=>({...e,timelineById:Object(CR.B)({id:t,start:a,end:n,timelineById:e.timelineById})}))).case(k.updateDataProviderEnabled,((e,{id:t,enabled:a,providerId:n,andProviderId:i})=>({...e,timelineById:Object(CR.v)({id:t,enabled:a,providerId:n,timelineById:e.timelineById,andProviderId:i})}))).case(k.updateDataProviderExcluded,((e,{id:t,excluded:a,providerId:n,andProviderId:i})=>({...e,timelineById:Object(CR.w)({id:t,excluded:a,providerId:n,timelineById:e.timelineById,andProviderId:i})}))).case(k.dataProviderEdited,((e,{andProviderId:t,excluded:a,field:n,id:i,operator:r,providerId:s,value:o})=>({...e,timelineById:Object(CR.y)({andProviderId:t,excluded:a,field:n,id:i,operator:r,providerId:s,timelineById:e.timelineById,value:o})}))).case(k.updateDataProviderType,((e,{id:t,type:a,providerId:n,andProviderId:i})=>({...e,timelineById:Object(CR.z)({id:t,type:a,providerId:n,timelineById:e.timelineById,andProviderId:i})}))).case(k.updateDataProviderKqlQuery,((e,{id:t,kqlQuery:a,providerId:n})=>({...e,timelineById:Object(CR.x)({id:t,kqlQuery:a,providerId:n,timelineById:e.timelineById})}))).case(k.updatePageIndex,((e,{id:t,activePage:a})=>({...e,timelineById:Object(CR.u)({id:t,activePage:a,timelineById:e.timelineById})}))).case(k.updateAutoSaveMsg,((e,{timelineId:t,newTimelineModel:a})=>({...e,autoSavedWarningMsg:{timelineId:t,newTimelineModel:a}}))).case(k.showCallOutUnauthorizedMsg,(e=>({...e,showCallOutUnauthorizedMsg:!0}))).case(k.setSavedQueryId,((e,{id:t,savedQueryId:a})=>({...e,timelineById:Object(CR.o)({id:t,savedQueryId:a,timelineById:e.timelineById})}))).case(k.setFilters,((e,{id:t,filters:a})=>({...e,timelineById:Object(CR.m)({id:t,filters:a,timelineById:e.timelineById})}))).case(k.setInsertTimeline,((e,t)=>({...e,insertTimeline:t}))).case(k.updateDataView,((e,{id:t,dataViewId:a,indexNames:n})=>({...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],dataViewId:a,indexNames:n}}}))).case(k.setActiveTabTimeline,((e,{id:t,activeTab:a,scrollToTop:n})=>({...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],activeTab:a,prevActiveTab:e.timelineById[t].activeTab,scrollToTop:n?{timestamp:Math.floor(Date.now()/1e3)}:void 0}}}))).case(k.toggleModalSaveTimeline,((e,{id:t,showModalSaveTimeline:a})=>({...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],showSaveModal:a}}}))).case(k.updateEqlOptions,((e,{id:t,field:a,value:n})=>{var i;return{...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],eqlOptions:{...null!==(i=e.timelineById[t].eqlOptions)&&void 0!==i?i:{},[a]:n}}}}})).case(k.setInsertTimeline,((e,t)=>({...e,insertTimeline:t}))).case(k.showTimeline,((e,{id:t,show:a})=>({...e,timelineById:Object(CR.C)({id:t,show:a,timelineById:e.timelineById})}))).case(k.setTimelineUpdatedAt,((e,{id:t,updated:a})=>({...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],updated:a}}}))).build();var AR=a(199),DR=a(12),qR=a(176),PR=a(240),RR=a(226);const _R=F.i18n.translate("xpack.securitySolution.endpointDetails.overview",{defaultMessage:"Overview"}),FR={tabTitle:F.i18n.translate("xpack.securitySolution.endpointDetails.activityLog",{defaultMessage:"Activity Log"}),LogEntry:{endOfLog:F.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.action.endOfLog",{defaultMessage:"Nothing more to show"}),dateRangeMessage:F.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.dateRangeMessage.title",{defaultMessage:"Nothing to show for selected date range, please select another and try again."}),emptyState:{title:F.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.emptyState.title",{defaultMessage:"No logged actions"}),body:F.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.emptyState.body",{defaultMessage:"No actions have been logged for this endpoint."})},action:{isolatedAction:F.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.action.isolated",{defaultMessage:"submitted request: Isolate host"}),unisolatedAction:F.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.action.unisolated",{defaultMessage:"submitted request: Release host"}),failedEndpointReleaseAction:F.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.action.failedEndpointReleaseAction",{defaultMessage:"failed to submit request: Release host"}),failedEndpointIsolateAction:F.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.action.failedEndpointIsolateAction",{defaultMessage:"failed to submit request: Isolate host"})},response:{isolationCompletedAndSuccessful:F.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.response.isolationCompletedAndSuccessful",{defaultMessage:"Host isolation request completed by Endpoint"}),isolationCompletedAndUnsuccessful:F.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.response.isolationCompletedAndUnsuccessful",{defaultMessage:"Host isolation request completed by Endpoint with errors"}),unisolationCompletedAndSuccessful:F.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.response.unisolationCompletedAndSuccessful",{defaultMessage:"Release request completed by Endpoint"}),unisolationCompletedAndUnsuccessful:F.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.response.unisolationCompletedAndUnsuccessful",{defaultMessage:"Release request completed by Endpoint with errors"}),isolationSuccessful:F.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.response.isolationSuccessful",{defaultMessage:"Host isolation request received by Endpoint"}),isolationFailed:F.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.response.isolationFailed",{defaultMessage:"Host isolation request received by Endpoint with errors"}),unisolationSuccessful:F.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.response.unisolationSuccessful",{defaultMessage:"Release host request received by Endpoint"}),unisolationFailed:F.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.response.unisolationFailed",{defaultMessage:"Release host request received by Endpoint with errors"})}}};F.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.search",{defaultMessage:"Search activity log"});var LR=a(414);const NR=r.a.memo((()=>{const e=Object(PR.b)(RR.detailsData),t=Object(PR.a)(e),[a,n]=Object(i.useState)(!1),s=Object(i.useCallback)((()=>{n(!1)}),[]),o=Object(i.useMemo)((()=>t.map((e=>r.a.createElement(LR.a,rr()({},e,{onClick:t=>{s(),e.onClick&&e.onClick(t)}}))))),[s,t]),l=Object(i.useMemo)((()=>r.a.createElement(N.EuiButton,{iconSide:"right",fill:!0,iconType:"arrowDown","data-test-subj":"endpointDetailsActionsButton",onClick:()=>{n(!a)}},r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.endpoint.detailsActions.buttonLabel",defaultMessage:"Take action"}))),[a]);return r.a.createElement(N.EuiPopover,{id:"endpointDetailsActionsPanel",button:l,isOpen:a,closePopover:s,panelPaddingSize:"none",anchorPosition:"downLeft"},r.a.createElement(N.EuiContextMenuPanel,{size:"s",items:o}))}));NR.displayName="ActionMenu";var BR=a(481),zR=a(321);const UR=Object(i.memo)((({hostMeta:e})=>{const t=Object(P.useHistory)(),a=Object(l.useDispatch)(),{show:n,...s}=Object(PR.b)(RR.uiQueryParams),o=Object(PR.b)(RR.getIsEndpointHostIsolated),c=Object(PR.b)(RR.getIsIsolationRequestPending),u=Object(PR.b)(RR.getWasIsolationRequestSuccessful),d=Object(PR.b)(RR.getIsolationRequestError),[p,m]=Object(i.useState)({comment:""}),g=o?zR.e:zR.c,f=Object(i.useCallback)((()=>{t.push(Object(h.d)({name:"endpointDetails",...s,selected_endpoint:e.agent.id}))}),[t,e.agent.id,s]),b=Object(i.useCallback)((()=>{a({type:"endpointIsolationRequest",payload:{type:o?"unisolate":"isolate",data:{endpoint_ids:[e.agent.id],comment:p.comment}}})}),[a,p.comment,e.agent.id,o]),y=Object(i.useCallback)((e=>{m((t=>({...t,...e})))}),[]);return r.a.createElement(r.a.Fragment,null,u&&r.a.createElement(zR.d,{hostName:e.host.name,isolateAction:o?"unisolateHost":"isolateHost"}),r.a.createElement(N.EuiFlyoutBody,null,u?r.a.createElement(zR.a,{onClick:f,buttonText:F.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.successProceedButton",{defaultMessage:"Return to endpoint details"})}):r.a.createElement(N.EuiForm,{isInvalid:!!d,error:null==d?void 0:d.message,"data-test-subj":"endpointIsolationForm"},r.a.createElement(g,{comment:p.comment,isLoading:c,hostName:e.host.name,onCancel:f,onConfirm:b,onChange:y}))))}));UR.displayName="EndpointIsolateFlyoutPanel";var HR=a(498),$R=a(222);const VR=Object(i.memo)((({avatarColor:e,avatarIconColor:t,avatarSize:a,iconType:n,isResponseEvent:i})=>r.a.createElement(N.EuiAvatar,{name:"Timeline Icon",size:null!=a?a:"s",color:e,iconColor:null!=t?t:"default",iconType:null!=n?n:"dot"})));VR.displayName="LogEntryTimelineIcon";const QR=z()(N.EuiComment).withConfig({displayName:"StyledEuiComment",componentId:"sc-2nb170-0"})([".euiCommentEvent__headerTimestamp{display:flex;:before{content:'';background-color:",";display:block;width:",";height:",";margin:0 "," 0 ",";border-radius:50%;content:'';margin:0 8px 0 4px;border-radius:50%;position:relative;top:10px;}}"],(e=>e.theme.eui.euiColorInk),(e=>e.theme.eui.euiBorderWidthThick),(e=>e.theme.eui.euiBorderWidthThick),(e=>e.theme.eui.euiSizeXS),(e=>e.theme.eui.euiSizeS)),WR=Object(i.memo)((({logEntry:e})=>{const t=IO(),{actionEventTitle:a,avatarColor:n,avatarIconColor:s,avatarSize:o,commentText:l,commentType:c,displayComment:u,displayResponseEvent:d,failedActionEventTitle:p,iconType:m,isResponseEvent:g,responseEventTitle:f,username:b}=((e,t)=>Object(i.useMemo)((()=>{let a,n="dot",i="update",r="",s=t.euiColorLightestShade,o="s",l="",c=!1,u=!1,d=!1,p=!1,m=!1,g=!0,f="";var b,h,y,E;return e.type===$R.a.FLEET_ACTION&&(o="m",i="regular",r=null!==(b=null===(h=e.item.data.data.comment)||void 0===h?void 0:h.trim())&&void 0!==b?b:"",g=!1,n="lockOpen",f=e.item.data.user_id,e.item.data.data)&&("isolate"===e.item.data.data.command&&(n="lock",c=!0),r&&(m=!0)),e.type===$R.a.ACTION?(o="m",i="regular",r=null!==(y=null===(E=e.item.data.EndpointActions.data.comment)||void 0===E?void 0:E.trim())&&void 0!==y?y:"",g=!1,n="lockOpen",f=e.item.data.user.id,a=t.euiColorVis9_behindText,l=FR.LogEntry.action.failedEndpointReleaseAction,e.item.data.EndpointActions.data&&("isolate"===e.item.data.EndpointActions.data.command&&(n="lock",l=FR.LogEntry.action.failedEndpointIsolateAction),r&&(m=!0))):e.type===$R.a.FLEET_RESPONSE?(u=!0,"isolate"===e.item.data.action_data.command&&(c=!0),e.item.data.completed_at&&!e.item.data.error?d=!0:s=t.euiColorVis9_behindText):e.type===$R.a.RESPONSE&&(n="check",u=!0,"isolate"===e.item.data.EndpointActions.data.command&&(c=!0),e.item.data.EndpointActions.completed_at&&(p=!0,e.item.data.error?(d=!1,s=t.euiColorVis9_behindText):(d=!0,s=t.euiColorVis0_behindText))),{actionEventTitle:c?FR.LogEntry.action.isolatedAction:FR.LogEntry.action.unisolatedAction,avatarColor:s,avatarIconColor:a,avatarSize:o,commentText:r,commentType:i,displayComment:m,displayResponseEvent:g,failedActionEventTitle:l,iconType:n,isResponseEvent:u,isSuccessful:d,isCompleted:p,responseEventTitle:c?p?d?FR.LogEntry.response.isolationCompletedAndSuccessful:FR.LogEntry.response.isolationCompletedAndUnsuccessful:d?FR.LogEntry.response.isolationSuccessful:FR.LogEntry.response.isolationFailed:p?d?FR.LogEntry.response.unisolationCompletedAndSuccessful:FR.LogEntry.response.unisolationCompletedAndUnsuccessful:d?FR.LogEntry.response.unisolationSuccessful:FR.LogEntry.response.unisolationFailed,username:f}}),[e,t]))(e,t);return r.a.createElement(QR,{type:null!=c?c:"regular",username:b,timestamp:r.a.createElement(wn.b,{value:e.item.data["@timestamp"]}),event:r.a.createElement("b",null,d?f:p||a),timelineIcon:r.a.createElement(VR,{avatarSize:o,iconType:m,isResponseEvent:g,avatarColor:n,avatarIconColor:s}),"data-test-subj":"timelineEntry"},u?r.a.createElement(N.EuiText,{size:"s","data-test-subj":"activityLogCommentText"},r.a.createElement("p",null,l)):void 0)}));WR.displayName="LogEntry";const GR=z.a.div.withConfig({displayName:"DatePickerWrapper",componentId:"sc-1c7nzmv-0"})(["width:",";"],(e=>e.theme.eui.fractions.single.percentage)),KR=z()(N.EuiFlexItem).withConfig({displayName:"StickyFlexItem",componentId:"sc-1c7nzmv-1"})(["background:",";position:sticky;top:0;z-index:1;padding:",";"],(e=>`${e.theme.eui.euiHeaderBackgroundColor}`),(e=>`${e.theme.eui.paddingSizes.m}`)),YR=Object(i.memo)((()=>{var e,t;const a=Object(l.useDispatch)(),{page:n,pageSize:s,startDate:c,endDate:u,autoRefreshOptions:p,recentlyUsedDateRanges:m}=Object(PR.b)(RR.getActivityLogDataPaging),g=Object(PR.b)(RR.getActivityLogRequestLoading),f=Object(i.useCallback)((async({start:e,end:t})=>{var i,r;a({type:"endpointDetailsActivityLogUpdatePaging",payload:{disabled:!1,page:n,pageSize:s,startDate:null===(i=Rn.a.parse(e))||void 0===i?void 0:i.toISOString(),endDate:null===(r=Rn.a.parse(t))||void 0===r?void 0:r.toISOString()}})}),[a,n,s]),b=Object(i.useCallback)((e=>{a({type:"userUpdatedActivityLogRefreshOptions",payload:{autoRefreshOptions:{enabled:!e.isPaused,duration:e.refreshInterval}}})}),[a]),h=Object(i.useCallback)((()=>{a({type:"endpointDetailsActivityLogUpdatePaging",payload:{disabled:!1,page:n,pageSize:s,startDate:c,endDate:u}})}),[a,n,s,c,u]),y=Object(i.useCallback)((({start:e,end:t})=>{const n=[{start:e,end:t},...m.filter((a=>!(a.start===e&&a.end===t))).slice(0,9)];a({type:"userUpdatedActivityLogRecentlyUsedDateRanges",payload:n}),f({start:e,end:t})}),[a,m,f]),[E]=Object(d.p)(o.cb),v=E.length?E.map((({from:e,to:t,display:a})=>({start:e,end:t,label:a}))):[];return r.a.createElement(KR,{grow:!1},r.a.createElement(N.EuiFlexGroup,{justifyContent:"flexStart",responsive:!0},r.a.createElement(GR,{"data-test-subj":"activityLogSuperDatePicker"},r.a.createElement(N.EuiFlexItem,null,r.a.createElement(N.EuiSuperDatePicker,{isLoading:g,commonlyUsedRanges:v,end:null===(e=Rn.a.parse(u))||void 0===e?void 0:e.toISOString(),isPaused:!p.enabled,onTimeChange:y,onRefreshChange:b,refreshInterval:p.duration,onRefresh:h,recentlyUsedRanges:m,start:null===(t=Rn.a.parse(c))||void 0===t?void 0:t.toISOString()})))))}));YR.displayName="DateRangePicker";const JR=z()(N.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-14gz10s-0"})(["height:",";"],(({isShorter:e})=>e?"25vh":"85vh")),XR=z.a.div.withConfig({displayName:"LoadMoreTrigger",componentId:"sc-14gz10s-1"})(["height:",";width:",";"],(e=>e.theme.eui.euiSizeXS),(e=>e.theme.eui.fractions.single.percentage)),ZR=Object(i.memo)((({activityLog:e})=>{const t=Object(PR.b)(RR.getActivityLogUninitialized),a=Object(PR.b)(RR.getActivityLogRequestLoading),n=Object(PR.b)(RR.getActivityLogRequestLoaded),s=Object(PR.b)(RR.getLastLoadedActivityLogData),o=Object(PR.b)(RR.getActivityLogIterableData),c=o.length,u=Object(PR.b)(RR.getActivityLogError),d=Object(l.useDispatch)(),{page:p,pageSize:m,startDate:g,endDate:f,disabled:b}=Object(PR.b)(RR.getActivityLogDataPaging),h=Object(i.useMemo)((()=>!!g||!!f),[g,f]),y=Object(i.useMemo)((()=>n&&!c&&!h||u),[n,c,h,u]),E=Object(i.useMemo)((()=>!(!h||!b||a||c)),[h,b,a,c]),v=Object(i.useMemo)((()=>!(null!=s&&s.data.length||o.length)),[s,o]),T=Object(i.useMemo)((()=>!b&&n&&!o.length||v),[b,n,o,v]),k=Object(i.useRef)(null),x=Object(i.useCallback)((e=>{e.some((e=>e.isIntersecting))&&n&&!b&&d({type:"endpointDetailsActivityLogUpdatePaging",payload:{page:p+1,pageSize:m,startDate:g,endDate:f}})}),[n,d,b,p,m,g,f]);return Object(i.useEffect)((()=>{const e=new IntersectionObserver(x),t=k.current;return t&&e.observe(t),()=>{e.disconnect()}}),[x]),r.a.createElement(r.a.Fragment,null,r.a.createElement(JR,{direction:"column",responsive:!1,isShorter:E},a&&(null==s||!s.data.length)||t?r.a.createElement(N.EuiLoadingContent,{lines:3}):y?r.a.createElement(N.EuiFlexItem,null,r.a.createElement(N.EuiEmptyPrompt,{iconType:"editorUnorderedList",titleSize:"s",title:r.a.createElement("h2",null,FR.LogEntry.emptyState.title),body:r.a.createElement("p",null,FR.LogEntry.emptyState.body),"data-test-subj":"activityLogEmpty"})):r.a.createElement(r.a.Fragment,null,r.a.createElement(YR,null),r.a.createElement(N.EuiFlexItem,{grow:!0},T&&r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiSpacer,{size:"m"}),r.a.createElement(N.EuiCallOut,{"data-test-subj":"activityLogNoDataCallout",size:"s",title:FR.LogEntry.dateRangeMessage,iconType:"alert"})),n&&o.map((e=>r.a.createElement(WR,{key:`${e.item.id}`,logEntry:e}))),a&&(null==s?void 0:s.data.map((e=>r.a.createElement(WR,{key:`${e.item.id}`,logEntry:e}))))),r.a.createElement(N.EuiFlexItem,{grow:!1},a&&r.a.createElement(N.EuiLoadingContent,{lines:3}),(!a||!b)&&!T&&r.a.createElement(XR,{"data-test-subj":"activityLogLoadMoreTrigger",ref:k}),b&&!a&&!T&&r.a.createElement(N.EuiText,{color:"subdued",textAlign:"center"},r.a.createElement("p",null,FR.LogEntry.endOfLog))))))}));ZR.displayName="EndpointActivityLog";var e_=a(420),t_=a(409),a_=a(302);const n_=Object(i.memo)((({policyId:e,backLink:t,children:a,missingPolicies:n={},...s})=>{const{getAppUrl:o}=Object(ol.b)(),{toRoutePath:l,toRouteUrl:c}=Object(i.useMemo)((()=>{const a=Object(h.j)(e);return{toRoutePath:t?{pathname:a,state:{backLink:t}}:a,toRouteUrl:o({path:a})}}),[e,o,t]),u=Object(a_.a)(l);return n[e]?r.a.createElement("span",{className:s.className,"data-test-subj":s["data-test-subj"]},a):r.a.createElement(N.EuiLink,rr()({href:c,onClick:u},s),a)}));n_.displayName="EndpointPolicyLink";const i_=r.a.memo((({style:e,...t})=>r.a.createElement(N.EuiText,rr()({color:"subdued",size:"xs",className:"eui-textNoWrap eui-displayInlineBlock",style:e},t),r.a.createElement(N.EuiIcon,{className:"eui-alignTop",size:"m",type:"alert",color:"warning"}),r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.outOfDateLabel",defaultMessage:"Out-of-date"}))));i_.displayName="OutOfDate";var r_=a(454);const s_=z()(N.EuiFlexGroup).withConfig({displayName:"EuiFlexGroupStyled",componentId:"sc-4x4obe-0"})([".isolation-status{margin-left:",";}"],(({theme:e})=>e.eui.paddingSizes.s)),o_=Object(i.memo)((({endpointMetadata:e,hostStatus:t})=>{const a=Object(PR.b)(RR.getEndpointHostIsolationStatusPropsCallback);return r.a.createElement(s_,{gutterSize:"none",responsive:!1,className:"eui-textTruncate"},r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(r_.a,{hostStatus:t})),r.a.createElement(N.EuiFlexItem,{grow:!1,className:"eui-textTruncate isolation-status"},r.a.createElement(zR.b,rr()({"data-test-subj":"rowIsolationStatus"},a(e)))))}));o_.displayName="EndpointAgentStatus";const l_=z.a.div.withConfig({displayName:"EndpointDetailsContentStyled",componentId:"sc-2wf17-0"})(["dl dt{max-width:27%;}dl dd{max-width:73%;}.policyLineText{padding-right:5px;}"]),c_=({children:e})=>r.a.createElement(N.EuiText,{size:"s"},r.a.createElement("h5",null,e)),u_=Object(i.memo)((({details:e,policyInfo:t,hostStatus:a})=>{const n=Object(PR.b)(RR.uiQueryParams),s=Object(PR.b)(RR.policyResponseStatus),o=Object(PR.b)(RR.nonExistingPolicies),l=Object(i.useMemo)((()=>{const{selected_endpoint:t,show:a,...i}=n;return Object(h.d)({name:"endpointPolicyResponse",...i,selected_endpoint:e.agent.id})}),[e.agent.id,n]),c=Object(a_.a)(l),u=Object(i.useMemo)((()=>[{title:r.a.createElement(c_,null,r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.endpoint.details.os",defaultMessage:"OS"})),description:r.a.createElement(N.EuiText,{size:"xs"},e.host.os.full)},{title:r.a.createElement(c_,null,r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.endpoint.details.agentStatus",defaultMessage:"Agent Status"})),description:r.a.createElement(o_,{hostStatus:a,endpointMetadata:e})},{title:r.a.createElement(c_,null,r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.endpoint.details.lastSeen",defaultMessage:"Last Seen"})),description:r.a.createElement(N.EuiText,{size:"xs"},r.a.createElement(wn.a,{value:e["@timestamp"],fieldName:""}))},{title:r.a.createElement(c_,null,r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.endpoint.details.policy",defaultMessage:"Policy"})),description:r.a.createElement(N.EuiText,{size:"xs",className:"eui-textBreakWord"},r.a.createElement(n_,{policyId:e.Endpoint.policy.applied.id,"data-test-subj":"policyDetailsValue",className:"policyLineText",missingPolicies:o},e.Endpoint.policy.applied.name),e.Endpoint.policy.applied.endpoint_policy_version&&r.a.createElement(N.EuiText,{color:"subdued",size:"xs",className:"eui-displayInlineBlock eui-textNoWrap policyLineText","data-test-subj":"policyDetailsRevNo"},r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.endpoint.details.policy.revisionNumber",defaultMessage:"rev. {revNumber}",values:{revNumber:e.Endpoint.policy.applied.endpoint_policy_version}})),Object(e_.b)(e.Endpoint.policy.applied,t)&&r.a.createElement(i_,null))},{title:r.a.createElement(c_,null,r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.endpoint.details.policyStatus",defaultMessage:"Policy Status"})),description:r.a.createElement(N.EuiHealth,{"data-test-subj":`policyStatusValue-${s}`,color:t_.b[s]||"default"},r.a.createElement(N.EuiLink,{onClick:c,"data-test-subj":"policyStatusValue"},r.a.createElement(N.EuiText,{size:"xs"},r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.endpoint.details.policyStatusValue",defaultMessage:"{policyStatus, select, success {Success} warning {Warning} failure {Failed} other {Unknown}}",values:{policyStatus:s}}))))},{title:r.a.createElement(c_,null,r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.endpoint.details.endpointVersion",defaultMessage:"Endpoint Version"})),description:r.a.createElement(N.EuiText,{size:"xs"},e.agent.version)},{title:r.a.createElement(c_,null,r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.endpoint.details.ipAddress",defaultMessage:"IP Address"})),description:r.a.createElement(N.EuiFlexGroup,{direction:"column",gutterSize:"s"},e.host.ip.map(((e,t)=>r.a.createElement(N.EuiFlexItem,{key:t},r.a.createElement(N.EuiText,{size:"xs"},e)))))}]),[e,a,s,c,t,o]);return r.a.createElement(l_,null,r.a.createElement(N.EuiSpacer,{size:"s"}),r.a.createElement(N.EuiDescriptionList,{compressed:!0,type:"column",listItems:u,"data-test-subj":"endpointDetailsList"}))}));u_.displayName="EndpointDetailsContent";const d_=[["configure_dns_events",F.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_dns_events",{defaultMessage:"Configure DNS Events"})],["configure_elasticsearch_connection",F.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_elasticsearch_connection",{defaultMessage:"Configure Elasticsearch Connection"})],["configure_file_events",F.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_file_events",{defaultMessage:"Configure File Events"})],["configure_imageload_events",F.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_imageload_events",{defaultMessage:"Configure Image Load Events"})],["configure_kernel",F.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_kernel",{defaultMessage:"Configure Kernel"})],["configure_logging",F.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_logging",{defaultMessage:"Configure Logging"})],["configure_malware",F.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_malware",{defaultMessage:"Configure Malware"})],["configure_network_events",F.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_network_events",{defaultMessage:"Configure Network Events"})],["configure_process_events",F.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_process_events",{defaultMessage:"Configure Process Events"})],["configure_registry_events",F.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_registry_events",{defaultMessage:"Configure Registry Events"})],["configure_security_events",F.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_security_events",{defaultMessage:"Configure Security Events"})],["connect_kernel",F.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.connect_kernel",{defaultMessage:"Connect Kernel"})],["detect_async_image_load_events",F.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.detect_async_image_load_events",{defaultMessage:"Detect Async Image Load Events"})],["detect_file_open_events",F.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.detect_file_open_events",{defaultMessage:"Detect File Open Events"})],["detect_file_write_events",F.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.detect_file_write_events",{defaultMessage:"Detect File Write Events"})],["detect_network_events",F.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.detect_network_events",{defaultMessage:"Detect Network Events"})],["detect_process_events",F.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.detect_process_events",{defaultMessage:"Detect Process Events"})],["detect_registry_events",F.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.detect_registry_events",{defaultMessage:"Detect Registry Events"})],["detect_sync_image_load_events",F.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.detect_sync_image_load_events",{defaultMessage:"Detect Sync Image Load Events"})],["download_global_artifacts",F.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.download_global_artifacts",{defaultMessage:"Download Global Artifacts"})],["download_user_artifacts",F.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.download_user_artifacts",{defaultMessage:"Download User Artifacts"})],["load_config",F.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.load_config",{defaultMessage:"Load Config"})],["load_malware_model",F.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.load_malware_model",{defaultMessage:"Load Malware Model"})],["read_elasticsearch_config",F.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.read_elasticsearch_config",{defaultMessage:"Read Elasticsearch Config"})],["read_events_config",F.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.read_events_config",{defaultMessage:"Read Events Config"})],["read_kernel_config",F.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.read_kernel_config",{defaultMessage:"Read Kernel Config"})],["read_logging_config",F.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.read_logging_config",{defaultMessage:"Read Logging Config"})],["read_malware_config",F.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.read_malware_config",{defaultMessage:"Read Malware Config"})],["workflow",F.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.workflow",{defaultMessage:"Workflow"})]],p_=new Map(d_);function m_(e){return p_.has(e)||p_.set(e,e.replace(/_/g," ").replace(/\b(\w)/g,(e=>e.toUpperCase()))),p_.get(e)}p_.set("success",F.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.success",{defaultMessage:"Success"})),p_.set("warning",F.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.warning",{defaultMessage:"Warning"})),p_.set("failure",F.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.failed",{defaultMessage:"Failed"})),p_.set("logging",F.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.logging",{defaultMessage:"Logging"})),p_.set("streaming",F.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.streaming",{defaultMessage:"Streaming"})),p_.set("malware",F.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.malware",{defaultMessage:"Malware"})),p_.set("events",F.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.events",{defaultMessage:"Events"})),p_.set("memory_protection",F.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.memory_protection",{defaultMessage:"Memory Threat"})),p_.set("behavior_protection",F.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.behavior_protection",{defaultMessage:"Malicious Behavior"}));const g_=z()(N.EuiAccordion).withConfig({displayName:"PolicyResponseConfigAccordion",componentId:"sc-5lan6u-0"})([".euiAccordion__triggerWrapper{padding:",";}&.euiAccordion-isOpen{background-color:",";}.euiAccordion__childWrapper{background-color:",";}.policyResponseAttentionBadge{background-color:",";color:",";}.euiAccordion__button{:hover,:focus{text-decoration:none;}}:hover:not(.euiAccordion-isOpen){background-color:",";}.policyResponseActionsAccordion{.euiAccordion__iconWrapper,svg{height:",";width:",";}}.policyResponseStatusHealth{width:100px;}.policyResponseMessage{padding-left:",";}"],(e=>e.theme.eui.paddingSizes.xs),(e=>e.theme.eui.euiFocusBackgroundColor),(e=>e.theme.eui.euiColorLightestShade),(e=>e.theme.eui.euiColorDanger),(e=>e.theme.eui.euiColorEmptyShade),(e=>e.theme.eui.euiColorLightestShade),(e=>e.theme.eui.euiIconSizes.small),(e=>e.theme.eui.euiIconSizes.small),(e=>e.theme.eui.paddingSizes.l)),f_=Object(i.memo)((({actions:e,responseActions:t})=>r.a.createElement(r.a.Fragment,null,e.map(((e,a)=>{const n=t.find((t=>t.name===e));if(void 0!==n)return r.a.createElement(N.EuiAccordion,{id:e+a,key:e+a,"data-test-subj":"endpointDetailsPolicyResponseActionsAccordion",className:"policyResponseActionsAccordion",buttonContent:r.a.createElement(N.EuiText,{size:"xs",className:"eui-textTruncate","data-test-subj":"policyResponseAction"},r.a.createElement("h4",null,m_(e))),paddingSize:"s",extraAction:r.a.createElement(N.EuiHealth,{color:t_.c[n.status],"data-test-subj":"policyResponseStatusHealth",className:"policyResponseStatusHealth"},r.a.createElement(N.EuiText,{size:"xs"},r.a.createElement("p",null,m_(n.status))))},r.a.createElement(N.EuiText,{size:"xs","data-test-subj":"policyResponseMessage"},r.a.createElement("p",{className:"policyResponseMessage"},n.message)))})))));f_.displayName="ResponseActions";const b_=Object(i.memo)((({responseConfig:e,responseActions:t,responseAttentionCount:a})=>{const n=Object(i.useMemo)((()=>Object(N.htmlIdGenerator)()),[]);return r.a.createElement(r.a.Fragment,null,Object.entries(e).map((([e,i])=>{const s=a.get(e);return r.a.createElement(g_,{id:n(`id_${e}`),key:n(`key_${e}`),"data-test-subj":"endpointDetailsPolicyResponseConfigAccordion",buttonContent:r.a.createElement(N.EuiText,{size:"s"},r.a.createElement("p",null,m_(e))),paddingSize:"m",extraAction:s&&s>0&&r.a.createElement(N.EuiNotificationBadge,{className:"policyResponseAttentionBadge","data-test-subj":"endpointDetailsPolicyResponseAttentionBadge"},s)},r.a.createElement(f_,{actions:i.concerned_actions,responseActions:t}))})))}));b_.displayName="PolicyResponse";const h_=Object(i.memo)((()=>{var e;const t=Object(d.n)(),a=Object(PR.b)(RR.uiQueryParams),n=Object(PR.b)(RR.getActivityLogData),s=Object(PR.b)(RR.detailsData),o=Object(PR.b)(RR.detailsError),l=Object(PR.b)(RR.policyVersionInfo),c=Object(PR.b)(RR.hostStatusInfo),u=Object(PR.b)(RR.showView),p=Object(i.useMemo)((()=>r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiLoadingContent,{lines:3}),r.a.createElement(N.EuiSpacer,{size:"l"}),r.a.createElement(N.EuiLoadingContent,{lines:3}))),[]),m=Object(i.useCallback)((e=>[{id:BR.b.overview,name:_R,route:Object(h.d)({...a,name:"endpointDetails",selected_endpoint:e}),content:void 0===s?p:r.a.createElement(u_,{details:s,policyInfo:l,hostStatus:c})},{id:BR.b.activityLog,name:FR.tabTitle,route:Object(h.d)({...a,name:"endpointActivityLog",selected_endpoint:e}),content:r.a.createElement(ZR,{activityLog:n})}]),[p,s,l,c,n,a]),g="details"===u||"policy_response"===u||"activity_log"===u;return Object(i.useEffect)((()=>{void 0!==o&&t.addDanger({title:F.i18n.translate("xpack.securitySolution.endpoint.details.errorTitle",{defaultMessage:"Could not find host"}),text:F.i18n.translate("xpack.securitySolution.endpoint.details.errorBody",{defaultMessage:"Please exit the flyout and select an available host."})})}),[o,u,t]),r.a.createElement(r.a.Fragment,null,("policy_response"===u||"isolate"===u||"unisolate"===u)&&r.a.createElement(HR.a,{hasBorder:!0,endpointId:null==s?void 0:s.agent.id,hostname:null==s||null===(e=s.host)||void 0===e?void 0:e.hostname}),void 0===s?r.a.createElement(N.EuiFlyoutBody,null,r.a.createElement(N.EuiLoadingContent,{lines:3})," ",r.a.createElement(N.EuiSpacer,{size:"l"})," ",r.a.createElement(N.EuiLoadingContent,{lines:3})):r.a.createElement(r.a.Fragment,null,("details"===u||"activity_log"===u)&&r.a.createElement(BR.a,{hostname:s.host.hostname,show:u,tabs:m(s.agent.id)}),"policy_response"===u&&r.a.createElement(y_,{hostMeta:s}),("isolate"===u||"unisolate"===u)&&r.a.createElement(UR,{hostMeta:s}),g&&r.a.createElement(N.EuiFlyoutFooter,{className:"eui-textRight","data-test-subj":"endpointDetailsFlyoutFooter"},r.a.createElement(NR,null))))}));h_.displayName="EndpointDetails";const y_=Object(i.memo)((({hostMeta:e})=>{const t=Object(PR.b)(RR.policyResponseConfigurations),a=Object(PR.b)(RR.policyResponseActions),n=Object(PR.b)(RR.policyResponseFailedOrWarningActionCount),i=Object(PR.b)(RR.policyResponseLoading),s=Object(PR.b)(RR.policyResponseError),o=Object(PR.b)(RR.policyResponseTimestamp),l=Object(PR.b)(RR.policyResponseAppliedRevision);return r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiFlyoutBody,{"data-test-subj":"endpointDetailsPolicyResponseFlyoutBody",className:"endpointDetailsPolicyResponseFlyoutBody"},r.a.createElement(N.EuiText,{"data-test-subj":"endpointDetailsPolicyResponseFlyoutTitle"},r.a.createElement("h4",null,r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyResponse.title",defaultMessage:"Policy Response"}))),r.a.createElement(N.EuiSpacer,{size:"s"}),r.a.createElement(N.EuiText,{size:"xs",color:"subdued","data-test-subj":"endpointDetailsPolicyResponseTimestamp"},r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyResponse.appliedOn",defaultMessage:"Revision {rev} applied on {date}",values:{rev:l,date:r.a.createElement(wn.d,{value:o})}})),r.a.createElement(N.EuiSpacer,{size:"s"}),s&&r.a.createElement(N.EuiEmptyPrompt,{title:r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.endpoint.details.noPolicyResponse",defaultMessage:"No policy response available"})}),i&&r.a.createElement(N.EuiLoadingContent,{lines:3}),void 0!==t&&void 0!==a&&r.a.createElement(b_,{responseConfig:t,responseActions:a,responseAttentionCount:n})))}));y_.displayName="PolicyResponseFlyoutPanel";const E_=Object(i.memo)((()=>{const e=Object(P.useHistory)(),t=Object(PR.b)(RR.uiQueryParams),{selected_endpoint:a,...n}=t,s=Object(i.useCallback)((()=>{const{show:t,...a}=n;e.push(Object(h.e)({name:"endpointList",...a}))}),[e,n]);return r.a.createElement(N.EuiFlyout,{onClose:s,style:{zIndex:4001},"data-test-subj":"endpointDetailsFlyout",size:"m",paddingSize:"l",ownFocus:!1},r.a.createElement(h_,null))}));E_.displayName="EndpointDetailsFlyout";var v_=a(1142),T_=a.n(v_);const k_=Object.freeze({textAlign:"center"}),x_=Object.freeze({maxWidth:550,maxHeight:420}),S_=r.a.memo((({loading:e,onActionClick:t,actionDisabled:a,policyEntryPoint:n=!1})=>{const i=Object(d.j)().services.docLinks;return r.a.createElement("div",{"data-test-subj":"emptyPolicyTable"},e?r.a.createElement(N.EuiFlexGroup,{alignItems:"center",justifyContent:"center"},r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiLoadingSpinner,{size:"xl",className:"essentialAnimation"}))):r.a.createElement(N.EuiFlexGroup,{"data-test-subj":"policyOnboardingInstructions",alignItems:"center"},r.a.createElement(N.EuiFlexItem,{grow:1},r.a.createElement(N.EuiText,null,r.a.createElement("h1",null,r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyList.onboardingTitle",defaultMessage:"Get started with Endpoint and Cloud Security"}))),r.a.createElement(N.EuiSpacer,{size:"m"}),r.a.createElement(N.EuiText,{size:"s",color:"subdued"},r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyList.onboardingSectionOne",defaultMessage:"Protect your hosts with threat prevention, detection, and deep security data visibility."})),r.a.createElement(N.EuiSpacer,{size:"m"}),r.a.createElement(N.EuiText,{size:"s",color:"subdued"},n?r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyList.onboardingSectionTwo.fromPolicyPage",defaultMessage:"From this page, youâll be able to view and manage the Endpoint and Cloud Security Integration policies in your environment running Endpoint and Cloud Security."}):r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyList.onboardingSectionTwo.fromEndpointPage",defaultMessage:"From this page, youâll be able to view and manage the hosts in your environment running Endpoint and Cloud Security."})),r.a.createElement(N.EuiSpacer,{size:"m"}),r.a.createElement(N.EuiText,{size:"s",color:"subdued"},r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyList.onboardingSectionThree",defaultMessage:"To get started, add the Endpoint and Cloud Security integration to your Agents. For more information, "}),r.a.createElement(N.EuiLink,{external:!0,href:`${i.links.siem.guide}`},r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyList.onboardingDocsLink",defaultMessage:"view the Elastic Security documentation"}))),r.a.createElement(N.EuiSpacer,{size:"l"}),r.a.createElement(N.EuiFlexGroup,null,r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiButton,{fill:!0,iconType:"plusInCircle",onClick:t,isDisabled:a,"data-test-subj":"onboardingStartButton"},r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyList.actionButtonText",defaultMessage:"Add Endpoint and Cloud Security"}))))),r.a.createElement(N.EuiFlexItem,{grow:2},r.a.createElement(N.EuiIcon,{type:T_.a,size:"original",style:x_}))))})),O_=r.a.memo((({loading:e,onActionClick:t,actionDisabled:a,handleSelectableOnChange:n,selectionOptions:s})=>{const o=Object(i.useMemo)((()=>[{title:F.i18n.translate("xpack.securitySolution.endpoint.list.stepOneTitle",{defaultMessage:"Select the integration you want to use"}),children:r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiText,{color:"subdued",size:"m",grow:!1},r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.stepOne",defaultMessage:"Select from existing integrations. This can be changed later."})),r.a.createElement(N.EuiSpacer,{size:"xxl"}),r.a.createElement(N.EuiSelectable,{options:s,singleSelection:"always",isLoading:e,height:100,listProps:{bordered:!0,singleSelection:!0},onChange:n,"data-test-subj":"onboardingPolicySelect"},(t=>e?r.a.createElement(N.EuiSelectableMessage,null,r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.loadingPolicies",defaultMessage:"Loading integrations"})):s.length?t:r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.noPolicies",defaultMessage:"There are no integrations."}))))},{title:F.i18n.translate("xpack.securitySolution.endpoint.list.stepTwoTitle",{defaultMessage:"Enroll your agents enabled with Endpoint and Cloud Security through Fleet"}),status:a?"disabled":"",children:r.a.createElement(N.EuiFlexGroup,{alignItems:"center"},r.a.createElement(N.EuiFlexItem,null,r.a.createElement(N.EuiText,{color:"subdued",size:"m",grow:!1},r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.stepTwo",defaultMessage:"Youâll be provided with the necessary commands to get started."}))),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiButton,{fill:!0,onClick:t,isDisabled:a,"data-test-subj":"onboardingStartButton"},r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyList.emptyCreateNewButton",defaultMessage:"Enroll Agent"}))))}]),[s,n,e,a,t]);return r.a.createElement(w_,{loading:e,dataTestSubj:"emptyHostsTable",steps:o,headerComponent:r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.noEndpointsPrompt",defaultMessage:"Next step: Enroll an Agent with Endpoint and Cloud Security"}),bodyComponent:r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.noEndpointsInstructions",defaultMessage:"Youâve added the Endpoint and Cloud Security integration. Now enroll your agents using the steps below."})})})),w_=r.a.memo((({loading:e,dataTestSubj:t,steps:a,headerComponent:n,bodyComponent:i})=>r.a.createElement("div",{"data-test-subj":t},e?r.a.createElement(N.EuiFlexGroup,{alignItems:"center",justifyContent:"center"},r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiLoadingSpinner,{size:"xl",className:"essentialAnimation"}))):r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiSpacer,{size:"xxl"}),r.a.createElement(N.EuiTitle,{size:"m"},r.a.createElement("h2",{style:k_},n)),r.a.createElement(N.EuiSpacer,{size:"xxl"}),r.a.createElement(N.EuiText,{textAlign:"center",color:"subdued",size:"m"},i),r.a.createElement(N.EuiSpacer,{size:"xxl"}),a&&r.a.createElement(N.EuiFlexGroup,{alignItems:"center",justifyContent:"center"},r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiSteps,{steps:a,"data-test-subj":"onboardingSteps"})))))));S_.displayName="PolicyEmptyState",O_.displayName="HostsEmptyState",w_.displayName="ManagementEmptyState";var j_=a(337),C_=a.n(j_);const I_=Object(i.memo)((()=>{const e=Object(P.useHistory)(),{admin_query:t,...a}=Object(PR.b)(RR.uiQueryParams),n=Object(PR.b)(RR.patterns),s=Object(PR.b)(RR.searchBarQuery),o=Object(i.useMemo)((()=>n.map((e=>{return t=e,Object(FO.all)([t]);var t}))),[n]),l=Object(i.useCallback)((t=>{var n,i;e.push(function(e){return{search:C_.a.stringify(e)}}({...a,page_index:(null===(n=t.query)||void 0===n?void 0:n.query)===s.query?a.page_index:"0",...null!==(i=t.query)&&void 0!==i&&i.query.trim()?{admin_query:Object(Pm.encode)(t.query)}:{}}))}),[e,a,s.query]),c=Object(i.useMemo)((()=>new kg.TimeHistory(new qm.Storage(localStorage))),[]);return r.a.createElement("div",null,n&&n.length>0&&r.a.createElement("div",null,r.a.createElement(ZO.SearchBar,{dataTestSubj:"adminSearchBar",query:s,indexPatterns:o,timeHistory:c,onQuerySubmit:l,fillSubmitButton:!0,isLoading:!1,iconType:"search",showFilterBar:!1,showDatePicker:!1,showQueryBar:!0,showQueryInput:!0})))}));I_.displayName="AdminSearchBar";var M_=a(461),A_=a(316);const D_=Object(i.memo)((({endpointMetadata:e})=>{const[t,a]=Object(i.useState)(!1),n=Object(PR.a)(e),s=Object(i.useCallback)((()=>a(!1)),[a]),o=Object(i.useCallback)((()=>a(!t)),[t]),l=Object(i.useMemo)((()=>n.map((e=>r.a.createElement(LR.a,rr()({},e,{onClick:t=>{s(),e.onClick&&e.onClick(t)}}))))),[s,n]),c=Object(i.useMemo)((()=>({"data-test-subj":"tableRowActionsMenuPanel"})),[]);return r.a.createElement(N.EuiPopover,{anchorPosition:"downRight",panelPaddingSize:"none",panelProps:c,button:r.a.createElement(N.EuiButtonIcon,{"data-test-subj":"endpointTableRowActions",iconType:"boxesHorizontal",onClick:o,"aria-label":F.i18n.translate("xpack.securitySolution.endpoint.list.actionmenu",{defaultMessage:"Open"})}),isOpen:t,closePopover:s},r.a.createElement(N.EuiContextMenuPanel,{items:l}))}));D_.displayName="EndpointTableRowActions";var q_=a(256),P_=a(464),R_=a(463);const __=z.a.div.withConfig({displayName:"StyledDatePicker",componentId:"sc-1m5xywg-0"})([".euiFormControlLayout--group{background-color:rgba(0,119,204,0.2);}.euiDatePickerRange--readOnly{background-color:",";}"],(e=>e.theme.eui.euiFormBackgroundColor)),F_=Object(i.memo)((({name:e,href:t,route:a,dataTestSubj:n})=>{const i=Object(a_.a)(a);return r.a.createElement(N.EuiLink,{"data-test-subj":n,className:"eui-displayInline eui-textTruncate",href:t,onClick:i},e)}));F_.displayName="EndpointListNavLink";const L_=Object(DR.createStructuredSelector)(RR),N_=()=>{var e,t;const a=Object(P.useHistory)(),{services:n}=Object(R.useKibana)(),{listData:s,pageIndex:c,pageSize:d,totalHits:p,listLoading:m,listError:g,uiQueryParams:f,hasSelectedEndpoint:b,policyItems:y,selectedPolicyId:E,policyItemsLoading:v,endpointPackageVersion:k,endpointsExist:x,autoRefreshInterval:S,isAutoRefreshEnabled:O,patternsError:w,areEndpointsEnrolling:j,agentsWithEndpointsTotalError:C,endpointsTotalError:I,metadataTransformStats:M}=Object(PR.b)(L_),{search:A}=Object(u.k)(T.a.administration),{search:D}=Object(P.useLocation)(),{getAppUrl:q}=Object(ol.b)(),_=Object(l.useDispatch)(),L=p>9999?9999:p,[B,z]=Object(i.useState)(!1),[U,H]=Object(i.useState)(!0),{state:$={}}=Object(P.useLocation)(),V=Object(i.useMemo)((()=>{if(null!=$&&$.backLink)return{onBackButtonNavigateTo:$.backLink.navigateTo,backButtonLabel:$.backLink.label,backButtonUrl:$.backLink.href};const e=Object(h.h)();return{backButtonLabel:F.i18n.translate("xpack.securitySolution.endpoint.list.backToPolicyButton",{defaultMessage:"Back to policy list"}),backButtonUrl:q({path:e}),onBackButtonNavigateTo:[o.y,{path:e}]}}),[q,null==$?void 0:$.backLink]),Q=r.a.createElement(P_.a,rr()({},V,{"data-test-subj":"endpointListBackLink"}));Object(i.useEffect)((()=>{U&&y&&y.length&&(_({type:"loadMetadataTransformStats"}),H(!1))}),[y,U,_]),Object(i.useEffect)((()=>{const e=M.some((e=>o.pc.has(null==e?void 0:e.state)));z(e)}),[M]);const W=Object(i.useCallback)((()=>{z(!1)}),[]),G=Object(i.useMemo)((()=>({pageIndex:c,pageSize:d,totalItemCount:L,pageSizeOptions:[...AR.f],showPerPageOptions:!0})),[c,d,L]),K=Object(i.useCallback)((({page:e})=>{const{index:t,size:n}=e;a.push(Object(h.e)({name:"endpointList",...f,page_index:JSON.stringify(t),page_size:JSON.stringify(n)}))}),[a,f]),Y=Object(Xv.a)("fleet",{path:`/integrations/${k?`/endpoint-${k}`:""}/add-integration`,state:{onCancelNavigateTo:[o.y,{path:Object(h.e)({name:"endpointList"})}],onCancelUrl:q({path:Object(h.e)({name:"endpointList"})}),onSaveNavigateTo:[o.y,{path:Object(h.e)({name:"endpointList"})}]}}),J=Object(i.useMemo)((()=>{const e=Object(h.e)({name:"endpointList"},D);return{navigateTo:[o.y,{path:e}],label:F.i18n.translate("xpack.securitySolution.endpoint.policy.details.backToListTitle",{defaultMessage:"View all endpoints"}),href:q({path:e})}}),[q,D]),X=Object(i.useCallback)((()=>{_({type:"appRequestedEndpointList"})}),[_]),Z=Object(i.useCallback)((e=>{_({type:"userUpdatedEndpointListRefreshOptions",payload:{isAutoRefreshEnabled:!e.isPaused,autoRefreshInterval:e.refreshInterval}})}),[_]),ee=Object(i.useCallback)((()=>{}),[]),te=Object(i.useMemo)((()=>({paddingLeft:"6px"})),[]),ae=Object(Xv.a)("fleet",{path:`/policies/${E}?openEnrollmentFlyout=true`,state:{onDoneNavigateTo:[o.y,{path:Object(h.e)({name:"endpointList"})}]}}),ne=Object(i.useMemo)((()=>y.map((e=>({key:e.policy_id,label:e.name,checked:E===e.policy_id?"on":void 0})))),[y,E]),ie=Object(i.useCallback)((e=>e.some((e=>"checked"in e&&"on"===e.checked&&(_({type:"userSelectedEndpointPolicy",payload:{selectedPolicyId:e.key}}),!0)))),[_]),re=Object(i.useMemo)((()=>{const e=F.i18n.translate("xpack.securitySolution.endpoint.list.lastActive",{defaultMessage:"Last active"});return[{field:"metadata",width:"15%",name:F.i18n.translate("xpack.securitySolution.endpoint.list.hostname",{defaultMessage:"Endpoint"}),render:({host:{hostname:e},agent:{id:t}})=>{const a=Object(h.d)({...f,name:"endpointDetails",selected_endpoint:t},A),n=q({path:a});return r.a.createElement(N.EuiToolTip,{content:e,anchorClassName:"eui-textTruncate"},r.a.createElement(F_,{name:e,href:n,route:a,dataTestSubj:"hostnameCellLink"}))}},{field:"host_status",width:"14%",name:F.i18n.translate("xpack.securitySolution.endpoint.list.hostStatus",{defaultMessage:"Agent status"}),render:(e,t)=>r.a.createElement(o_,{hostStatus:e,endpointMetadata:t.metadata})},{field:"metadata.Endpoint.policy.applied",width:"15%",name:F.i18n.translate("xpack.securitySolution.endpoint.list.policy",{defaultMessage:"Policy"}),truncateText:!0,render:(e,t)=>r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiToolTip,{content:e.name,anchorClassName:"eui-textTruncate"},r.a.createElement(n_,{policyId:e.id,className:"eui-textTruncate","data-test-subj":"policyNameCellLink",backLink:J},e.name)),e.endpoint_policy_version&&r.a.createElement(N.EuiText,{color:"subdued",size:"xs",style:{whiteSpace:"nowrap",...te},className:"eui-textTruncate","data-test-subj":"policyListRevNo"},r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.policy.revisionNumber",defaultMessage:"rev. {revNumber}",values:{revNumber:e.endpoint_policy_version}})),Object(e_.b)(e,t.policy_info)&&r.a.createElement(i_,{style:te,"data-test-subj":"rowPolicyOutOfDate"}))},{field:"metadata.Endpoint.policy.applied",width:"9%",name:F.i18n.translate("xpack.securitySolution.endpoint.list.policyStatus",{defaultMessage:"Policy status"}),render:(e,t)=>{const a=Object(h.d)({name:"endpointPolicyResponse",...f,selected_endpoint:t.metadata.agent.id}),n=q({path:a});return r.a.createElement(N.EuiToolTip,{content:t_.d[e.status],anchorClassName:"eui-textTruncate"},r.a.createElement(N.EuiHealth,{color:t_.c[e.status],className:"eui-textTruncate eui-fullWidth","data-test-subj":"rowPolicyStatus"},r.a.createElement(F_,{name:t_.d[e.status],href:n,route:a,dataTestSubj:"policyStatusCellLink"})))}},{field:"metadata.host.os.name",width:"9%",name:F.i18n.translate("xpack.securitySolution.endpoint.list.os",{defaultMessage:"OS"}),render:e=>r.a.createElement(N.EuiToolTip,{content:e,anchorClassName:"eui-textTruncate"},r.a.createElement(N.EuiText,{size:"s",className:"eui-textTruncate eui-fullWidth"},r.a.createElement("p",{className:"eui-displayInline eui-TextTruncate"},e)))},{field:"metadata.host.ip",width:"12%",name:F.i18n.translate("xpack.securitySolution.endpoint.list.ip",{defaultMessage:"IP address"}),render:e=>r.a.createElement(N.EuiToolTip,{content:e.toString().replace(",",", "),anchorClassName:"eui-textTruncate"},r.a.createElement(N.EuiText,{size:"s",className:"eui-textTruncate eui-fullWidth"},r.a.createElement("p",{className:"eui-displayInline eui-textTruncate"},e.toString().replace(",",", "))))},{field:"metadata.agent.version",width:"9%",name:F.i18n.translate("xpack.securitySolution.endpoint.list.endpointVersion",{defaultMessage:"Version"}),render:e=>r.a.createElement(N.EuiToolTip,{content:e,anchorClassName:"eui-textTruncate"},r.a.createElement(N.EuiText,{size:"s",className:"eui-textTruncate eui-fullWidth"},r.a.createElement("p",{className:"eui-displayInline eui-TextTruncate"},e)))},{field:"metadata.@timestamp",name:e,width:"9%",render:t=>r.a.createElement(wn.a,{fieldName:e,value:t,className:"eui-textTruncate"})},{field:"",width:"8%",name:F.i18n.translate("xpack.securitySolution.endpoint.list.actions",{defaultMessage:"Actions"}),actions:[{render:e=>r.a.createElement(D_,{endpointMetadata:e.metadata})}]}]}),[f,A,q,J,te]),se=Object(i.useMemo)((()=>x||j?r.a.createElement(N.EuiBasicTable,{"data-test-subj":"endpointListTable",items:[...s],columns:re,error:null==g?void 0:g.message,pagination:G,onChange:K,loading:m}):!v&&y&&y.length>0?r.a.createElement(O_,{loading:m,onActionClick:ae,actionDisabled:void 0===E,handleSelectableOnChange:ie,selectionOptions:ne}):r.a.createElement(R_.a,null,r.a.createElement(S_,{loading:v,onActionClick:Y}))),[m,x,v,y,s,re,null==g?void 0:g.message,G,K,ae,E,ie,ne,Y,j]),oe=s&&s.length>0,le=Object(i.useMemo)((()=>({display:x?"flex":"none",maxWidth:200})),[x]),ce=Object(i.useMemo)((()=>!(!x||!b&&O)),[x,b,O]),ue=Object(i.useMemo)((()=>x?S:AR.a),[x,S]),de=Object(i.useMemo)((()=>!(!I&&!C)),[I,C]),pe=Object(i.useMemo)((()=>x&&!w),[x,w]),me=Object(i.useMemo)((()=>{var e;const t=M.filter((e=>o.pc.has(e.state))).map((e=>e.id)).join(", ");return r.a.createElement(r.a.Fragment,null,r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.transformFailed.message",defaultMessage:"A required transform, {transformId}, is currently failing. Most of the time this can be fixed by {transformsPage}. For additional help, please visit the {docsPage}",values:{transformId:t||q_.l,transformsPage:r.a.createElement(A_.a,{"data-test-subj":"failed-transform-restart-link",appId:"management",appPath:"/data/transform"},r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.transformFailed.restartLink",defaultMessage:"restarting the transform"})),docsPage:r.a.createElement(N.EuiLink,{"data-test-subj":"failed-transform-docs-link",href:null==n||null===(e=n.docLinks)||void 0===e?void 0:e.links.endpoints.troubleshooting,target:"_blank"},r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.transformFailed.docsLink",defaultMessage:"troubleshooting documentation"}))}}),r.a.createElement(N.EuiSpacer,{size:"s"}))}),[M,null==n||null===(e=n.docLinks)||void 0===e?void 0:e.links.endpoints.troubleshooting]),ge=Object(i.useMemo)((()=>{if(B)return r.a.createElement(r.a.Fragment,null,r.a.createElement(Et,{message:{id:"endpoints-list-transform-failed",type:"warning",title:F.i18n.translate("xpack.securitySolution.endpoint.list.transformFailed.title",{defaultMessage:"Required transform failed"}),description:me},dismissButtonText:F.i18n.translate("xpack.securitySolution.endpoint.list.transformFailed.dismiss",{defaultMessage:"Dismiss"}),onDismiss:W,showDismissButton:!0}),r.a.createElement(N.EuiSpacer,{size:"m"}))}),[B,W,me]);return r.a.createElement(M_.a,{"data-test-subj":"endpointPage",hideHeader:!(x||j),title:r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.pageTitle",defaultMessage:"Endpoints"}),subtitle:r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.pageSubTitle",defaultMessage:"Hosts running endpoint security"}),headerBackComponent:$.backLink&&Q},b&&r.a.createElement(E_,null),r.a.createElement(r.a.Fragment,null,j&&!de&&r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiCallOut,{size:"s","data-test-subj":"endpointsEnrollingNotification"},r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.endpointsEnrolling",defaultMessage:"Endpoints are enrolling. {agentsLink} to track progress.",values:{agentsLink:r.a.createElement(A_.a,{appId:"fleet",appPath:`#${qR.pagePathGetters.agent_list({kuery:'packages : "endpoint"'})}`,href:`${null==n||null===(t=n.application)||void 0===t?void 0:t.getUrlForApp("fleet")}#${qR.pagePathGetters.agent_list({kuery:'packages : "endpoint"'})}`},r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.endpointsEnrolling.viewAgentsLink",defaultMessage:"View agents"}))}})),r.a.createElement(N.EuiSpacer,{size:"m"})),ge,r.a.createElement(N.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},pe&&r.a.createElement(N.EuiFlexItem,null,r.a.createElement(I_,null)),r.a.createElement(N.EuiFlexItem,{grow:!1,style:le},r.a.createElement(__,null,r.a.createElement(N.EuiSuperDatePicker,{className:"endpointListDatePicker",onTimeChange:ee,isDisabled:b,onRefresh:X,isPaused:ce,refreshInterval:ue,onRefreshChange:Z,isAutoRefreshOnly:!0})))),r.a.createElement(N.EuiSpacer,{size:"m"})),oe&&r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiText,{color:"subdued",size:"xs","data-test-subj":"endpointListTableTotal"},p>1e4?r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.totalCount.limited",defaultMessage:"Showing {limit} of {totalItemCount, plural, one {# endpoint} other {# endpoints}}",values:{totalItemCount:p,limit:1e4}}):r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.totalCount",defaultMessage:"Showing {totalItemCount, plural, one {# endpoint} other {# endpoints}}",values:{totalItemCount:p}})),r.a.createElement(N.EuiHorizontalRule,{margin:"xs"})),se)};var B_=a(1143);class ApiRouteNotMocked extends Error{}const z_=["delete","fetch","get","post","put","head","patch"],U_=e=>(t,a)=>{let n=0;const{ignoreUnMockedApiRouteErrors:i=!1}=null!=a?a:{},r=[],s=new Error("HTTP MOCK APPLIED FROM:").stack,o=e.reduce(((e,t)=>{const a=jest.fn(t.handler);return a.mockDelay=jest.fn(t.delay||(async()=>{})),e[t.id]=a,e}),{}),l={async waitForApi(){await Object(B_.act)((async()=>{await new Promise((e=>{n>0?r.push(e):e()}))}))},responseProvider:o};return z_.forEach((a=>{const l=t[a].getMockImplementation(),c=e.filter((e=>e.method===a));t[a].mockImplementation((async(...e)=>{const t=$_(e[0])?e[0].path:e[0],u=c.find((e=>H_(e.path,t)));if(u){const t=o[u.id],a=$_(e[0])?e[0]:{...e[1]||{},path:e[0]};n++,t.mockDelay&&await t.mockDelay(a);try{return t(a)}catch(d){return d.stack+=`\n${s}`,Promise.reject(d)}finally{(async()=>{await new Promise((e=>setTimeout(e,1))),n--,0===n&&r.length>0&&r.splice(0).forEach((e=>e()))})()}}else if(l)return l(...e);if(i)return;const d=new ApiRouteNotMocked(`API [${a.toUpperCase()} ${t}] is not MOCKED!`);throw d.stack+=`\n${s}`,console.error(d),d}))})),l},H_=(e,t)=>{if(e===t)return!0;if(/{.*?}/.test(e)){const a=t.split(/\//),n=e.split(/\//);return a.length===n.length&&a.every(((e,t)=>e===n[t]||/{.*?}/.test(n[t])))}return!1},$_=e=>"object"==typeof e&&"path"in e,V_=e=>t=>{const a=[],n={async waitForApi(){await Object(B_.act)((async()=>Promise.all(a.map((e=>e()))).then((()=>{}))))},responseProvider:{}};return e.forEach((e=>{const{waitForApi:a,...i}=e(t);Object(fn.merge)(n,i)})),n};var Q_=a(411),W_=a.n(Q_),G_=a(182),K_=a(173),Y_=a(311),J_=a(269),X_=a(438),Z_=a(1323),eF=a.n(Z_);const tF=["windows","macos","linux"],aF=Array.from({length:14},((e,t)=>864e5*(t+1))),nF=["elastic","shay","Damian","Sarai","Deirdre","Shawana","Treena","Ellamae","Myriam","Roberto","Cordell","Demetrice","Audrea","Shanel","Gail","Hermila","Mara","Elden","Malisa","Derick","Teddy","Dovie","Betty","Kay","Sharice","Evalyn","Teressa","Teisha","Marianne","Cherelle","Tabitha","Deneen","Leo","Tess","Clair","Marty","Dexter","Candis","Dina","Bennett","Vesta","Trinity","Drusilla","Bree","Bryon","Johnson","Justa","Jada","Armand","Raeann","Yolande","Genevieve"];class base_data_generator_BaseDataGenerator{constructor(e=Math.random().toString()){sn()(this,"random",void 0),this.random="string"==typeof e?eF()(e):e}generate(){throw new Error("method not implemented!")}randomUser(){return this.randomChoice(nF)}randomFutureDate(e){const t=e?e.getTime():Date.now();return new Date(t+this.randomChoice(aF)).toISOString()}randomPastDate(e){const t=e?e.getTime():Date.now();return new Date(t-this.randomChoice(aF)).toISOString()}randomBoolean(e=.5){return this.random()<e}randomOSFamily(){return this.randomChoice(tF)}randomUUID(){return sa.a.v4()}seededUUIDv4(){return sa.a.v4({random:[...this.randomNGenerator(255,16)]})}randomN(e){return Math.floor(this.random()*e)}*randomNGenerator(e,t){let a=t;for(;a>0;)yield this.randomN(e),a-=1}randomArray(e,t){const a=this.randomN(e)+1;return[...Array(a).keys()].map(t)}randomMac(){return[...this.randomNGenerator(255,6)].map((e=>e.toString(16))).join("-")}randomIP(){return[10,...this.randomNGenerator(255,3)].map((e=>e.toString())).join(".")}randomVersion(){return[7,...this.randomNGenerator(20,2)].map((e=>e.toString())).join(".")}randomChoice(e){return e[this.randomN(e.length)]}randomString(e){return[...this.randomNGenerator(36,e)].map((e=>e.toString(36))).join("")}randomHostname(){return`Host-${this.randomString(10)}`}toEsSearchHit(e){return{_index:"some-index",_id:this.seededUUIDv4(),_score:1,_source:e}}toEsSearchResponse(e){return{took:3,timed_out:!1,_shards:{total:2,successful:2,skipped:0,failed:0},hits:{total:{value:e.length,relation:"eq"},max_score:0,hits:e}}}}const iF=[{name:"Windows",full:"Windows 10",version:"10.0",platform:"Windows",family:"windows",Ext:{variant:"Windows Pro"}},{name:"Windows",full:"Windows Server 2016",version:"10.0",platform:"Windows",family:"windows",Ext:{variant:"Windows Server"}},{name:"Windows",full:"Windows Server 2012",version:"6.2",platform:"Windows",family:"windows",Ext:{variant:"Windows Server"}},{name:"Windows",full:"Windows Server 2012R2",version:"6.3",platform:"Windows",family:"windows",Ext:{variant:"Windows Server Release 2"}}],rF=[$R.c.success,$R.c.failure,$R.c.warning,$R.c.unsupported],sF=[{name:"Default",id:"00000000-0000-0000-0000-000000000000",status:$R.c.success,endpoint_policy_version:1,version:3},{name:"With Eventing",id:"C2A9093E-E289-4C0A-AA44-8C32A414FA7A",status:$R.c.success,endpoint_policy_version:3,version:5},{name:"Detect Malware Only",id:"47d7965d-6869-478b-bd9c-fb0d2bb3959f",status:$R.c.success,endpoint_policy_version:4,version:9}],oF=["creation","open","rename","execution","deletion"];let lF,cF;!function(e){e.Driver="driver",e.File="file",e.Network="network",e.Registry="registry",e.Authentication="authentication",e.Session="session"}(lF||(lF={})),function(e){e.Random="random",e.Driver="driver",e.File="file",e.Network="network",e.Registry="registry",e.Security="security"}(cF||(cF={}));const uF={[cF.Security]:[lF.Authentication,lF.Session],[cF.Driver]:lF.Driver,[cF.File]:lF.File,[cF.Network]:lF.Network,[cF.Registry]:lF.Registry,[cF.Random]:""},dF={[cF.Security]:{category:uF[cF.Security],creationType:"start"},[cF.Driver]:{category:uF[cF.Driver],creationType:"start"},[cF.File]:{category:uF[cF.File],creationType:"creation"},[cF.Network]:{category:uF[cF.Network],creationType:"start"},[cF.Registry]:{category:uF[cF.Registry],creationType:"creation"}};function pF(e){var t,a,n,i,r,s,o,l,c,u,d,p,m;return{ancestors:null!==(t=null==e?void 0:e.ancestors)&&void 0!==t?t:3,generations:null!==(a=null==e?void 0:e.generations)&&void 0!==a?a:2,children:null!==(n=null==e?void 0:e.children)&&void 0!==n?n:2,relatedEvents:null!==(i=null==e?void 0:e.relatedEvents)&&void 0!==i?i:5,relatedEventsOrdered:null!==(r=null==e?void 0:e.relatedEventsOrdered)&&void 0!==r&&r,relatedAlerts:null!==(s=null==e?void 0:e.relatedAlerts)&&void 0!==s?s:3,sessionEntryLeader:null!==(o=null==e?void 0:e.sessionEntryLeader)&&void 0!==o?o:"",percentWithRelated:null!==(l=null==e?void 0:e.percentWithRelated)&&void 0!==l?l:30,percentTerminated:null!==(c=null==e?void 0:e.percentTerminated)&&void 0!==c?c:100,alwaysGenMaxChildrenPerNode:null!==(u=null==e?void 0:e.alwaysGenMaxChildrenPerNode)&&void 0!==u&&u,ancestryArraySize:null!==(d=null==e?void 0:e.ancestryArraySize)&&void 0!==d?d:2,eventsDataStream:null!==(p=null==e?void 0:e.eventsDataStream)&&void 0!==p?p:fF,alertsDataStream:null!==(m=null==e?void 0:e.alertsDataStream)&&void 0!==m?m:hF}}const mF={type:"metrics",dataset:"endpoint.metadata",namespace:"default"},gF={type:"metrics",dataset:"endpoint.policy",namespace:"default"},fF={type:"logs",dataset:"endpoint.events.process",namespace:"default"};var bF;!function(e){e.MALWARE="MALWARE",e.MEMORY_SIGNATURE="MEMORY_SIGNATURE",e.MEMORY_SHELLCODE="MEMORY_SHELLCODE",e.BEHAVIOR="BEHAVIOR"}(bF||(bF={}));const hF={type:"logs",dataset:"endpoint.alerts",namespace:"default"};class generate_data_EndpointDocGenerator extends base_data_generator_BaseDataGenerator{constructor(e=Math.random().toString()){super(e),sn()(this,"commonInfo",void 0),sn()(this,"sequence",0),this.commonInfo=this.createHostData()}updateHostData(){this.commonInfo.host.ip=this.randomArray(3,(()=>this.randomIP()))}updateHostPolicyData(){this.commonInfo.Endpoint.policy.applied=this.randomChoice(sF),this.commonInfo.Endpoint.policy.applied.status=this.randomChoice(rF)}updateCommonInfo(){this.commonInfo=this.createHostData()}static createDataStreamFromIndex(e){const t=e.split("-");return{type:t[0],dataset:t[1],namespace:t[2]}}createHostData(){const e=this.randomHostname(),t=this.randomBoolean(.3),a=this.randomVersion(),n=this.seededUUIDv4();return{agent:{version:a,id:n,type:"endpoint"},elastic:{agent:{id:n}},host:{id:this.seededUUIDv4(),hostname:e,name:e,architecture:this.randomString(10),ip:this.randomArray(3,(()=>this.randomIP())),mac:this.randomArray(3,(()=>this.randomMac())),os:this.randomChoice(iF)},Endpoint:{status:$R.b.enrolled,policy:{applied:this.randomChoice(sF)},configuration:{isolation:t},state:{isolation:t},capabilities:W_()("7.15.0",a)?["isolation"]:[]}}}generateHostMetadata(e=(new Date).getTime(),t=mF){return{"@timestamp":e,event:{created:e,id:this.seededUUIDv4(),kind:"metric",category:["host"],type:["info"],module:"endpoint",action:"endpoint_metadata",dataset:"endpoint.metadata"},...this.commonInfo,data_stream:t}}generateMalwareAlert({ts:e=(new Date).getTime(),sessionEntryLeader:t=this.randomString(10),entityID:a=this.randomString(10),parentEntityID:n,ancestry:i=[],alertsDataStream:r=hF}={}){return{...this.commonInfo,data_stream:r,"@timestamp":e,ecs:{version:"1.4.0"},event:{action:this.randomChoice(oF),kind:"alert",category:"malware",code:"malicious_file",id:this.seededUUIDv4(),dataset:"endpoint",module:"endpoint",type:"creation",sequence:this.sequence++},file:{owner:"SYSTEM",name:"fake_malware.exe",path:"C:/fake_malware.exe",accessed:e,mtime:e,created:e,size:3456,hash:{md5:"fake file md5",sha1:"fake file sha1",sha256:"fake file sha256"},Ext:{code_signature:[{trusted:!1,subject_name:"bad signer"}],malware_classification:{identifier:"endpointpe",score:1,threshold:.66,version:"3.0.33"},temp_file_path:"C:/temp/fake_malware.exe",quarantine_result:!0,quarantine_message:"fake quarantine message"}},process:{pid:2,name:"malware writer",start:e,uptime:0,entity_id:a,executable:"C:/malware.exe",parent:n?{entity_id:n,pid:1}:void 0,hash:{md5:"fake md5",sha1:"fake sha1",sha256:"fake sha256"},entry_leader:{entity_id:t,name:"fake entry",pid:Math.floor(1e3*Math.random())},session_leader:{entity_id:t,name:"fake session",pid:Math.floor(1e3*Math.random())},group_leader:{entity_id:t,name:"fake leader",pid:Math.floor(1e3*Math.random())},Ext:{ancestry:i,code_signature:[{trusted:!1,subject_name:"bad signer"}],user:"SYSTEM",token:{domain:"NT AUTHORITY",integrity_level:16384,integrity_level_name:"system",privileges:[{description:"Replace a process level token",enabled:!1,name:"SeAssignPrimaryTokenPrivilege"}],sid:"S-1-5-18",type:"tokenPrimary",user:"SYSTEM"}}},dll:this.getAlertsDefaultDll()}}generateMemoryAlert({ts:e=(new Date).getTime(),sessionEntryLeader:t=this.randomString(10),entityID:a=this.randomString(10),parentEntityID:n,ancestry:i=[],alertsDataStream:r=hF,alertType:s}={}){const o=this.randomProcessName(),l=s===bF.MEMORY_SHELLCODE,c={...this.commonInfo,data_stream:r,"@timestamp":e,ecs:{version:"1.6.0"},Memory_protection:{feature:l?"shellcode_thread":"signature",self_injection:!0},event:{action:"start",kind:"alert",category:"malware",code:l?"shellcode_thread":"memory_signature",id:this.seededUUIDv4(),dataset:"endpoint",module:"endpoint",type:"info",sequence:this.sequence++},file:{},process:{pid:2,name:o,start:e,uptime:0,entity_id:a,executable:`C:/fake/${o}`,parent:n?{entity_id:n,pid:1}:void 0,hash:{md5:"fake md5",sha1:"fake sha1",sha256:"fake sha256"},entry_leader:{entity_id:t,name:"fake entry",pid:Math.floor(1e3*Math.random())},session_leader:{entity_id:t,name:"fake session",pid:Math.floor(1e3*Math.random())},group_leader:{entity_id:t,name:"fake leader",pid:Math.floor(1e3*Math.random())},Ext:{ancestry:i,code_signature:[{trusted:!1,subject_name:"bad signer"}],user:"SYSTEM",token:{integrity_level_name:"high"},malware_signature:{all_names:"Windows.Trojan.FakeAgent",identifier:"diagnostic-malware-signature-v1-fake"}}},dll:this.getAlertsDefaultDll()};return l&&(c.Target={process:{thread:{Ext:{start_address_allocation_offset:0,start_address_bytes_disasm_hash:"a disam hash",start_address_details:{allocation_type:"PRIVATE",allocation_size:4e3,region_size:4e3,region_protection:"RWX",memory_pe:{imphash:"a hash"}}}}}}),c}generateAlert({ts:e=(new Date).getTime(),entityID:t=this.randomString(10),sessionEntryLeader:a,parentEntityID:n,ancestry:i=[],alertsDataStream:r=hF}={}){const s=this.randomChoice(Object.values(bF));switch(s){case bF.MALWARE:return this.generateMalwareAlert({ts:e,sessionEntryLeader:a,entityID:t,parentEntityID:n,ancestry:i,alertsDataStream:r});case bF.MEMORY_SIGNATURE:case bF.MEMORY_SHELLCODE:return this.generateMemoryAlert({ts:e,entityID:t,sessionEntryLeader:a,parentEntityID:n,ancestry:i,alertsDataStream:r,alertType:s});case bF.BEHAVIOR:return this.generateBehaviorAlert({ts:e,sessionEntryLeader:a,entityID:t,parentEntityID:n,ancestry:i,alertsDataStream:r});default:return Object(G_.assertNever)(s)}}generateBehaviorAlert({ts:e=(new Date).getTime(),sessionEntryLeader:t=this.randomString(10),entityID:a=this.randomString(10),parentEntityID:n,ancestry:i=[],alertsDataStream:r=hF}={}){const s=this.randomProcessName();return{...this.commonInfo,data_stream:r,"@timestamp":e,ecs:{version:"1.6.0"},rule:{id:this.randomUUID(),description:"Behavior rule description"},event:{action:"rule_detection",kind:"alert",category:"behavior",code:"behavior",id:this.seededUUIDv4(),dataset:"endpoint.diagnostic.collection",module:"endpoint",type:"info",sequence:this.sequence++},file:{name:"fake_behavior.exe",path:"C:/fake_behavior.exe"},destination:{port:443,ip:this.randomIP()},source:{port:59406,ip:this.randomIP()},network:{transport:"tcp",type:"ipv4",direction:"outgoing"},registry:{path:"HKEY_USERS\\S-1-5-21-2460036010-3910878774-3458087990-1001\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\chrome",value:s,data:{strings:`C:/fake_behavior/${s}`}},process:{pid:2,name:s,entity_id:a,executable:`C:/fake_behavior/${s}`,code_signature:{status:"trusted",subject_name:"Microsoft Windows"},entry_leader:{entity_id:t,name:"fake entry",pid:Math.floor(1e3*Math.random())},session_leader:{entity_id:t,name:"fake session",pid:Math.floor(1e3*Math.random())},group_leader:{entity_id:t,name:"fake leader",pid:Math.floor(1e3*Math.random())},parent:n?{entity_id:n,pid:1}:void 0,Ext:{ancestry:i,code_signature:[{trusted:!1,subject_name:"bad signer"}],user:"SYSTEM",token:{integrity_level_name:"high",elevation_level:"full"}}},dll:this.getAlertsDefaultDll()}}getAlertsDefaultDll(){return[{pe:{architecture:"x64"},code_signature:{subject_name:"Cybereason Inc",trusted:!0},hash:{md5:"1f2d082566b0fc5f2c238a5180db7451",sha1:"ca85243c0af6a6471bdaa560685c51eefd6dbc0d",sha256:"8ad40c90a611d36eb8f9eb24fa04f7dbca713db383ff55a03aa0f382e92061a2"},path:"C:\\Program Files\\Cybereason ActiveProbe\\AmSvc.exe",Ext:{compile_time:1534424710,mapped_address:5362483200,mapped_size:0,malware_classification:{identifier:"Whitelisted",score:0,threshold:0,version:"3.0.0"}}}]}generateEvent(e={}){var t,a,n,i;const r=null!==(t=null===(a=e.ancestry)||void 0===a?void 0:a.slice(0,null!==(n=null==e?void 0:e.ancestryArrayLimit)&&void 0!==n?n:2))&&void 0!==t?t:[],s=e.processName?e.processName:this.randomProcessName(),o=e.sessionEntryLeader?e.sessionEntryLeader:this.randomString(10),l=this.randomString(10),c=e.extensions||(e=>"registry"===e?{registry:{key:`HKLM/Windows/Software/${this.randomString(5)}`}}:"network"===e?{network:{direction:this.randomChoice(["inbound","outbound"]),forwarded_ip:`${this.randomIP()}`}}:"file"===e?{file:{path:"C:\\My Documents\\business\\January\\processName"}}:"dns"===e?{dns:{question:{name:`${this.randomIP()}`}}}:{})(e.eventCategory);return{data_stream:null!==(i=null==e?void 0:e.eventsDataStream)&&void 0!==i?i:fF,"@timestamp":e.timestamp?e.timestamp:(new Date).getTime(),agent:{...this.commonInfo.agent,type:"endpoint"},ecs:{version:"1.4.0"},...c,event:{category:e.eventCategory?e.eventCategory:["process"],kind:"event",type:e.eventType?e.eventType:["start"],id:this.seededUUIDv4(),sequence:this.sequence++},host:this.commonInfo.host,process:{pid:"pid"in e&&void 0!==e.pid?e.pid:this.randomN(5e3),executable:`C:\\${s}`,args:[`"C:\\${s}"`,`--${this.randomString(3)}`],working_directory:`/home/${l}/`,code_signature:{status:"trusted",subject_name:"Microsoft"},hash:{md5:this.seededUUIDv4()},entity_id:e.entityID?e.entityID:this.randomString(10),entry_leader:{entity_id:o,name:"fake entry",pid:Math.floor(1e3*Math.random())},session_leader:{entity_id:o,name:"fake session",pid:Math.floor(1e3*Math.random())},group_leader:{entity_id:o,name:"fake leader",pid:Math.floor(1e3*Math.random())},parent:e.parentEntityID?{entity_id:e.parentEntityID,pid:"parentPid"in e&&void 0!==e.parentPid?e.parentPid:this.randomN(5e3)}:void 0,name:s,Ext:{ancestry:r}},user:{domain:this.randomString(10),name:l}}}static getStartEndTimes(e){let t,a;var n;e.length>0?(t=null!==(n=Object(J_.o)(e[0]))&&void 0!==n?n:(new Date).getTime(),a=t):(t=(new Date).getTime(),a=t);for(const n of e){const e=Object(J_.o)(n);void 0!==e&&(e<t&&(t=e),e>a&&(a=e))}return{startTime:new Date(t),endTime:new Date(a)}}generateTree(e={}){const t=pF(e),a=(e,t)=>{var a,n;const i=Object(J_.c)(t);if(!i)return e;let r=e.get(i);var s;return r||(r={id:i,lifecycle:[],relatedEvents:[],relatedAlerts:[]}),"event"===Object(X_.a)(null===(a=t.event)||void 0===a?void 0:a.kind)?"process"===Object(X_.a)(null===(s=t.event)||void 0===s?void 0:s.category)?r.lifecycle.push(t):r.relatedEvents.push(t):"alert"===Object(X_.a)(null===(n=t.event)||void 0===n?void 0:n.kind)&&r.relatedAlerts.push(t),e.set(i,r)},n=(e,t,a)=>{if(!a||0===a.size)return t;t.push(a);const i=new Map;for(const t of a.values()){const a=e.get(t.id);if(a)for(const e of a.values())i.set(e.id,e)}return n(e,t,i)},i=this.createAlertEventAncestry(t),r=i.reduce(a,new Map),s=i[i.length-1],o=Object(J_.c)(s);if(!o)throw Error("could not find the originating alert's entity id");const l=r.get(o);if(!l)throw Error(`could not find origin while building tree: ${o}`);const c=Array.from(this.descendantsTreeGenerator(s,t)),u=c.reduce(a,new Map),d=(e=>{const t=new Map;for(const a of e.values()){const e=Object(J_.l)(a.lifecycle[0]);if(e){let n=t.get(e);n||(n=new Map,t.set(e,n)),n.set(a.id,a)}}return t})(u),p=n(d,[],d.get(l.id)),m=[...i,...c],{startTime:g,endTime:f}=generate_data_EndpointDocGenerator.getStartEndTimes(m);return{childrenByParent:d,children:u,ancestry:r,allEvents:m,origin:l,childrenLevels:p,startTime:g,endTime:f}}*alertsGenerator(e,t={}){const a=pF(t);for(let t=0;t<e;t++){const e=this.randomString(10);yield*this.fullResolverTreeGenerator({...a,sessionEntryLeader:e})}}*fullResolverTreeGenerator(e={}){const t=pF(e),a=this.createAlertEventAncestry(t);for(let e=0;e<a.length;e++)yield a[e];yield*this.descendantsTreeGenerator(a[a.length-1],t)}createAlertEventAncestry(e={}){var t;const a=pF(e),n=[],i=(new Date).getTime(),r=this.generateEvent({timestamp:i+1e3,entityID:a.sessionEntryLeader,sessionEntryLeader:a.sessionEntryLeader,eventsDataStream:a.eventsDataStream});n.push(r);let s=r,o=(null!==(t=Object(J_.o)(r))&&void 0!==t?t:0)+1e3;const l=(e,t,n,i)=>{for(const r of this.relatedAlertsGenerator({node:e,relatedAlerts:t,alertCreationTime:n,sessionEntryLeader:a.sessionEntryLeader,alertsDataStream:a.alertsDataStream}))i.push(r)},c=(e,t,n)=>{for(const i of this.relatedEventsGenerator({node:e,relatedEvents:a.relatedEvents,processDuration:t,ordered:a.relatedEventsOrdered,sessionEntryLeader:a.sessionEntryLeader,eventsDataStream:a.eventsDataStream}))n.push(i)},u=21600;if(this.randomN(100)<a.percentWithRelated&&(c(s,u,n),l(s,a.relatedAlerts,u,n)),this.randomN(100)<a.percentTerminated){const e=this.randomN(1e6);n.push(this.generateEvent({timestamp:o+1e3*e,entityID:Object(J_.c)(r),parentEntityID:Object(J_.l)(r),sessionEntryLeader:a.sessionEntryLeader,eventCategory:["process"],eventType:["end"],eventsDataStream:a.eventsDataStream,processName:Object(J_.n)(r)}))}for(let e=0;e<a.ancestors;e++){var d,p;const t=Object(J_.c)(s),i=[];if(t&&i.push(t),i.push(...null!==(d=Object(J_.a)(s))&&void 0!==d?d:[]),s=this.generateEvent({timestamp:o,parentEntityID:Object(J_.c)(s),sessionEntryLeader:a.sessionEntryLeader,ancestry:i,ancestryArrayLimit:a.ancestryArraySize,parentPid:Object(X_.a)(null===(p=s.process)||void 0===p?void 0:p.pid),pid:this.randomN(5e3),eventsDataStream:a.eventsDataStream}),n.push(s),o+=1e3,this.randomN(100)<a.percentTerminated){const e=this.randomN(1e6);n.push(this.generateEvent({timestamp:o+1e3*e,entityID:Object(J_.c)(s),parentEntityID:Object(J_.l)(s),sessionEntryLeader:a.sessionEntryLeader,eventCategory:["process"],eventType:["end"],ancestry:Object(J_.a)(s),ancestryArrayLimit:a.ancestryArraySize,eventsDataStream:a.eventsDataStream,processName:Object(J_.n)(s)}))}if(this.randomN(100)<a.percentWithRelated){c(s,u,n);let t=a.relatedAlerts;e===a.ancestors-1&&(t-=1),l(s,t,u,n)}}return o+=1e3,n.push(this.generateAlert({ts:o,entityID:Object(J_.c)(s),parentEntityID:Object(J_.l)(s),sessionEntryLeader:a.sessionEntryLeader,ancestry:Object(J_.a)(s),alertsDataStream:a.alertsDataStream})),n}*descendantsTreeGenerator(e,t={}){var a;const n=pF(t);let i=this.randomN(n.children+1);n.alwaysGenMaxChildrenPerNode&&(i=n.children);const r=[{event:e,childrenCreated:0,maxChildren:i}];let s=null!==(a=Object(J_.o)(e))&&void 0!==a?a:0;for(;r.length>0;){var o;const e=r[r.length-1];if(e.childrenCreated===e.maxChildren||r.length===n.generations+1){r.pop();continue}e.childrenCreated++,s+=1e3;const t=Object(J_.c)(e.event),a=[];t&&a.push(t),a.push(...null!==(o=Object(J_.a)(e.event))&&void 0!==o?o:[]);const l=this.generateEvent({timestamp:s,parentEntityID:t,sessionEntryLeader:n.sessionEntryLeader,ancestry:a,ancestryArrayLimit:n.ancestryArraySize,eventsDataStream:n.eventsDataStream});i=this.randomN(n.children+1),n.alwaysGenMaxChildrenPerNode&&(i=n.children),r.push({event:l,childrenCreated:0,maxChildren:i}),yield l;let c=21600;this.randomN(100)<n.percentTerminated&&(c=this.randomN(1e6),yield this.generateEvent({timestamp:s+1e3*c,entityID:Object(J_.c)(l),sessionEntryLeader:n.sessionEntryLeader,parentEntityID:Object(J_.l)(l),eventCategory:["process"],eventType:["end"],ancestry:a,ancestryArrayLimit:n.ancestryArraySize,eventsDataStream:n.eventsDataStream})),this.randomN(100)<n.percentWithRelated&&(yield*this.relatedEventsGenerator({node:l,relatedEvents:n.relatedEvents,sessionEntryLeader:n.sessionEntryLeader,processDuration:c,ordered:n.relatedEventsOrdered,eventsDataStream:n.eventsDataStream}),yield*this.relatedAlertsGenerator({node:l,relatedAlerts:n.relatedAlerts,sessionEntryLeader:n.sessionEntryLeader,alertCreationTime:c,alertsDataStream:n.alertsDataStream}))}}*relatedEventsGenerator({node:e,relatedEvents:t=10,processDuration:a=21600,ordered:n=!1,sessionEntryLeader:i,eventsDataStream:r=fF}){var s;let o;const l=null!==(s=Object(J_.o)(e))&&void 0!==s?s:0;let c=l+1;o="number"==typeof t?[{category:cF.Random,count:t}]:t;for(const t of o){let s;for(let o=0;o<t.count;o++)s=t.category===cF.Random?this.randomChoice(Object.values(dF)):dF[t.category],n?c+=1e3*this.randomN(a):c=l+1e3*this.randomN(a),yield this.generateEvent({timestamp:c,entityID:Object(J_.c)(e),sessionEntryLeader:i,parentEntityID:Object(J_.l)(e),eventCategory:s.category,eventType:s.creationType,ancestry:Object(J_.a)(e),eventsDataStream:r})}}*relatedAlertsGenerator({node:e,relatedAlerts:t=3,alertCreationTime:a=21600,alertsDataStream:n=hF,sessionEntryLeader:i}){for(let s=0;s<t;s++){var r;const t=(null!==(r=Object(J_.o)(e))&&void 0!==r?r:0)+1e3*this.randomN(a);yield this.generateAlert({ts:t,entityID:Object(J_.c)(e),sessionEntryLeader:i,parentEntityID:Object(J_.l)(e),ancestry:Object(J_.a)(e),alertsDataStream:n})}}generatePolicyPackagePolicy(){const e=new Date(Date.now()-864e5).toISOString();return{id:this.seededUUIDv4(),name:"Endpoint Policy",description:"Policy to protect the worlds data",created_at:e,created_by:"elastic",updated_at:(new Date).toISOString(),updated_by:"elastic",policy_id:this.seededUUIDv4(),enabled:!0,output_id:"",inputs:[{type:"endpoint",enabled:!0,streams:[],config:{artifact_manifest:{value:{manifest_version:"1.0.0",schema_version:"v1",artifacts:{}}},policy:{value:Object(Y_.c)()}}}],namespace:"default",package:{name:"endpoint",title:"Elastic Endpoint",version:"1.0.0"},revision:1}}generateAgentPolicy(){return{id:this.seededUUIDv4(),name:"Agent Policy",status:K_.agentPolicyStatuses.Active,description:"Some description",namespace:"default",is_managed:!1,monitoring_enabled:["logs","metrics"],revision:2,updated_at:"2020-07-22T16:36:49.196Z",updated_by:"elastic",package_policies:["852491f0-cc39-11ea-bac2-cdbf95b4b41a"],agents:0}}generateEpmPackage(){return{id:this.seededUUIDv4(),name:"endpoint",title:"Elastic Endpoint",version:"0.5.0",description:"This is the Elastic Endpoint package.",type:"integration",download:"/epr/endpoint/endpoint-0.5.0.tar.gz",path:"/package/endpoint/0.5.0",icons:[{path:"/package/endpoint/0.5.0/img/logo-endpoint-64-color.svg",src:"/img/logo-endpoint-64-color.svg",size:"16x16",type:"image/svg+xml"}],status:"installed",release:"ga",savedObject:{type:"epm-packages",id:"endpoint",attributes:{installed_kibana:[{id:"826759f0-7074-11ea-9bc8-6b38f4d29a16",type:"dashboard"},{id:"1cfceda0-728b-11ea-9bc8-6b38f4d29a16",type:"visualization"},{id:"1e525190-7074-11ea-9bc8-6b38f4d29a16",type:"visualization"},{id:"55387750-729c-11ea-9bc8-6b38f4d29a16",type:"visualization"},{id:"92b1edc0-706a-11ea-9bc8-6b38f4d29a16",type:"visualization"},{id:"a3a3bd10-706b-11ea-9bc8-6b38f4d29a16",type:"map"}],installed_es:[{id:"logs-endpoint.alerts",type:"index_template"},{id:"events-endpoint",type:"index_template"},{id:"logs-endpoint.events.file",type:"index_template"},{id:"logs-endpoint.events.library",type:"index_template"},{id:"metrics-endpoint.metadata",type:"index_template"},{id:"metrics-endpoint.metadata_mirror",type:"index_template"},{id:"logs-endpoint.events.network",type:"index_template"},{id:"metrics-endpoint.policy",type:"index_template"},{id:"logs-endpoint.events.process",type:"index_template"},{id:"logs-endpoint.events.registry",type:"index_template"},{id:"logs-endpoint.events.security",type:"index_template"},{id:"metrics-endpoint.telemetry",type:"index_template"}],package_assets:[],es_index_patterns:{alerts:"logs-endpoint.alerts-*",events:"events-endpoint-*",file:"logs-endpoint.events.file-*",library:"logs-endpoint.events.library-*",metadata:"metrics-endpoint.metadata-*",metadata_mirror:"metrics-endpoint.metadata_mirror-*",network:"logs-endpoint.events.network-*",policy:"metrics-endpoint.policy-*",process:"logs-endpoint.events.process-*",registry:"logs-endpoint.events.registry-*",security:"logs-endpoint.events.security-*",telemetry:"metrics-endpoint.telemetry-*"},name:"endpoint",version:"0.5.0",internal:!1,install_version:"0.5.0",install_status:"installed",install_started_at:"2020-06-24T14:41:23.098Z",install_source:"registry",keep_policies_up_to_date:!1},references:[],updated_at:"2020-06-24T14:41:23.098Z",version:"Wzc0LDFd"}}}generatePolicyResponse({ts:e=(new Date).getTime(),allStatus:t,policyDataStream:a=gF}={}){const n=this.randomN(10),i=()=>t||this.randomHostPolicyResponseActionStatus();return{data_stream:a,"@timestamp":e,agent:{id:this.commonInfo.agent.id,version:"1.0.0-local.20200416.0"},elastic:{agent:{id:this.commonInfo.elastic.agent.id}},ecs:{version:"1.4.0"},host:this.commonInfo.host,Endpoint:{policy:{applied:{actions:[{name:"configure_elasticsearch_connection",message:"elasticsearch comes configured successfully",status:$R.c.success},{name:"configure_kernel",message:"Failed to configure kernel",status:$R.c.failure},{name:"configure_logging",message:"Successfully configured logging",status:$R.c.success},{name:"configure_malware",message:"Unexpected error configuring malware",status:$R.c.failure},{name:"connect_kernel",message:"Successfully initialized minifilter",status:$R.c.success},{name:"detect_file_open_events",message:"Successfully stopped file open event reporting",status:$R.c.success},{name:"detect_file_write_events",message:"Failed to stop file write event reporting",status:$R.c.success},{name:"detect_image_load_events",message:"Successfully started image load event reporting",status:$R.c.success},{name:"detect_process_events",message:"Successfully started process event reporting",status:$R.c.success},{name:"download_global_artifacts",message:"Failed to download EXE model",status:$R.c.success},{name:"load_config",message:"Successfully parsed configuration",status:$R.c.success},{name:"load_malware_model",message:"Error deserializing EXE model; no valid malware model installed",status:$R.c.success},{name:"read_elasticsearch_config",message:"Successfully read Elasticsearch configuration",status:$R.c.success},{name:"read_events_config",message:"Successfully read events configuration",status:$R.c.success},{name:"read_kernel_config",message:"Succesfully read kernel configuration",status:$R.c.success},{name:"read_logging_config",message:"Field (logging.debugview) not found in config",status:$R.c.success},{name:"read_malware_config",message:"Successfully read malware detect configuration",status:$R.c.success},{name:"workflow",message:"Failed to apply a portion of the configuration (kernel)",status:$R.c.unsupported},{name:"download_model",message:"Failed to apply a portion of the configuration (kernel)",status:$R.c.success},{name:"ingest_events_config",message:"Failed to apply a portion of the configuration (kernel)",status:$R.c.success}],id:this.commonInfo.Endpoint.policy.applied.id,response:{configurations:{events:{concerned_actions:["download_model"],status:i()},logging:{concerned_actions:this.randomHostPolicyResponseActionNames(),status:i()},malware:{concerned_actions:this.randomHostPolicyResponseActionNames(),status:i()},streaming:{concerned_actions:this.randomHostPolicyResponseActionNames(),status:i()}}},artifacts:{global:{version:"1.4.0",identifiers:[{name:"endpointpe-model",sha256:"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"}]},user:{version:"1.4.0",identifiers:[{name:"user-model",sha256:"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"}]}},status:this.commonInfo.Endpoint.policy.applied.status,version:n,name:this.commonInfo.Endpoint.policy.applied.name,endpoint_policy_version:this.commonInfo.Endpoint.policy.applied.endpoint_policy_version}}},event:{created:e,id:this.seededUUIDv4(),kind:"state",category:["host"],type:["change"],module:"endpoint",action:"endpoint_policy_response",dataset:"endpoint.policy"}}}randomHostPolicyResponseActionNames(){return this.randomArray(this.randomN(8),(()=>this.randomChoice(["load_config","workflow","download_global_artifacts","configure_malware","read_malware_config","load_malware_model","read_kernel_config","configure_kernel","detect_process_events","detect_file_write_events","detect_file_open_events","detect_image_load_events","connect_kernel"])))}randomHostPolicyResponseActionStatus(){return this.randomChoice([$R.c.failure,$R.c.success,$R.c.warning,$R.c.unsupported])}randomProcessName(){return this.randomChoice(yF)}randomIP(){return super.randomIP()}}const yF=["lsass.exe","notepad.exe","mimikatz.exe","powershell.exe","iexlorer.exe","explorer.exe"],EF=["isolate","unisolate"];class fleet_action_generator_FleetActionGenerator extends base_data_generator_BaseDataGenerator{generate(e={}){const t=e["@timestamp"]?new Date(e["@timestamp"]):new Date(this.randomPastDate());return Object(fn.merge)({action_id:this.seededUUIDv4(),"@timestamp":t.toISOString(),expiration:this.randomFutureDate(t),type:"INPUT_ACTION",input_type:"endpoint",agents:[this.seededUUIDv4()],user_id:"elastic",data:{command:this.randomIsolateCommand(),comment:this.randomString(15)}},e)}generateActionEsHit(e={}){return Object.assign(this.toEsSearchHit(this.generate(e)),{_index:K_.AGENT_ACTIONS_INDEX})}generateIsolateAction(e={}){return Object(fn.merge)(this.generate({data:{command:"isolate"}}),e)}generateUnIsolateAction(e={}){return Object(fn.merge)(this.generate({data:{command:"unisolate"}}),e)}generateResponse(e={}){const t=e["@timestamp"]?new Date(e["@timestamp"]):new Date;return Object(fn.merge)({action_data:{command:this.randomIsolateCommand(),comment:""},action_id:this.seededUUIDv4(),agent_id:this.seededUUIDv4(),started_at:this.randomPastDate(),completed_at:t.toISOString(),error:"some error happened","@timestamp":t.toISOString()},e)}generateResponseEsHit(e={}){return Object.assign(this.toEsSearchHit(this.generateResponse(e)),{_index:K_.AGENT_ACTIONS_RESULTS_INDEX})}generateActivityLogActionResponse(e={}){return Object(fn.merge)({type:$R.a.FLEET_RESPONSE,item:{id:this.seededUUIDv4(),data:this.generateResponse()}},e)}randomFloat(){return this.random()}randomN(e){return super.randomN(e)}randomIsolateCommand(){return this.randomChoice(EF)}}const vF=U_([{id:"pendingActions",method:"get",path:q_.b,handler:e=>{const t=e.query.agent_ids;return t.length?{data:t.map(((e,t)=>({agent_id:e,pending_actions:t%2?{isolate:1}:{}})))}:{data:[{agent_id:"111-111",pending_actions:{}},{agent_id:"222-222",pending_actions:{isolate:1}}]}}}]);class fleet_agent_policy_generator_FleetAgentPolicyGenerator extends base_data_generator_BaseDataGenerator{generate(e={}){return{id:this.seededUUIDv4(),name:`Agent Policy ${this.randomString(4)}`,status:K_.agentPolicyStatuses.Active,description:"Created by FleetAgentPolicyGenerator",namespace:"default",is_managed:!1,monitoring_enabled:["logs","metrics"],revision:2,updated_at:"2020-07-22T16:36:49.196Z",updated_by:this.randomUser(),package_policies:["852491f0-cc39-11ea-bac2-cdbf95b4b41a"],agents:0,...e}}}const TF=e=>{if(!e)return[];const t=Object(oa.e)(e);if(t.arguments){const e=[],a=[...t.arguments];for(;a.length>0;){const t=a.shift();if(t&&(t.arguments&&a.push(...t.arguments),"literal"===t.type&&t.value===`${K_.AGENT_POLICY_SAVED_OBJECT_TYPE}.package_policies`)){const t=a[0];t&&"literal"===t.type&&"string"==typeof t.value&&(e.push(t.value),a.shift())}}return e}return[]},kF=U_([{id:"packageList",method:"get",path:K_.EPM_API_ROUTES.LIST_PATTERN,handler:()=>({items:[new generate_data_EndpointDocGenerator("seed").generateEpmPackage()]})}]),xF=(U_([{id:"endpointPackagePolicy",path:K_.PACKAGE_POLICY_API_ROUTES.INFO_PATTERN,method:"get",handler:()=>({item:new generate_data_EndpointDocGenerator("seed").generatePolicyPackagePolicy()})}]),U_([{id:"endpointPackagePolicyList",path:K_.PACKAGE_POLICY_API_ROUTES.LIST_PATTERN,method:"get",handler:()=>{const e=new generate_data_EndpointDocGenerator("seed");return{items:Array.from({length:5},((t,a)=>{const n=e.generatePolicyPackagePolicy();return n.name+=` ${a}`,n})),total:1,page:1,perPage:10}}}])),SF=U_([{id:"agentPolicy",path:K_.AGENT_POLICY_API_ROUTES.LIST_PATTERN,method:"get",handler:({query:e})=>{var t;const a=new generate_data_EndpointDocGenerator("seed"),n=new fleet_agent_policy_generator_FleetAgentPolicyGenerator("seed"),i=[a.generateHostMetadata().Endpoint.policy.applied.id,"ddf6570b-9175-4a6d-b288-61a09771c647","b8e616ae-44fc-4be7-846c-ce8fa5c082dd",...TF(null!==(t=e.kuery)&&void 0!==t?t:"")];return{items:i.map((e=>n.generate({package_policies:[e]}))),perPage:Math.max(i.length,10),total:i.length,page:1}}}]),OF=U_([{id:"checkPermissions",path:K_.appRoutesService.getCheckPermissionsPath(),method:"get",handler:()=>({error:void 0,success:!0})}]),wF=(U_([{id:"agentStatus",path:K_.AGENT_API_ROUTES.STATUS_PATTERN,method:"get",handler:()=>({results:{total:50,inactive:5,online:40,error:0,offline:5,updating:0,other:0,events:0}})}]),"2020-04-20T15:25:31.830Z"),jF={},CF=(Fn.a.duration(5,"minutes"),()=>({_version:"WzI5NywxXQ==",created_at:wF,created_by:"some user",description:"some description",id:"1",immutable:false,list_id:Bn.j,meta:jF,name:"Sample Endpoint Exception List",namespace_type:"agnostic",os_types:["linux"],tags:["user added string for a tag","malware"],tie_breaker_id:"6a76b69d-80df-4ab2-8c3e-85f466b06a0e",type:"endpoint",updated_at:wF,updated_by:"user_name",version:1})),IF=e=>{const{description:t,entries:a,list_id:n,name:i,type:r,comments:s,item_id:o,meta:l,namespace_type:c,os_types:u,tags:d}=e;return{description:t,entries:a,list_id:n,name:i,type:r,comments:s,item_id:o,meta:l,namespace_type:c,os_types:u,tags:d}},MF=e=>{const{id:t,item_id:a,_version:n}=e,{list_id:i,...r}=IF(e);return{...r,id:t,item_id:a,_version:null!=n?n:"some value"}},AF=[`${ki.b}123-456`,ki.d];class exceptions_list_item_generator_ExceptionsListItemGenerator extends base_data_generator_BaseDataGenerator{generate(e={}){const t={_version:this.randomString(5),comments:[],created_at:this.randomPastDate(),created_by:this.randomUser(),description:"created by ExceptionListItemGenerator",entries:[{field:"process.hash.md5",operator:"included",type:"match",value:"741462ab431a22233C787BAAB9B653C7"}],id:this.seededUUIDv4(),item_id:this.seededUUIDv4(),list_id:"endpoint_list_id",meta:void 0,name:`Generated Exception (${this.randomString(5)})`,namespace_type:"agnostic",os_types:[this.randomOSFamily()],tags:[this.randomChoice(AF)],tie_breaker_id:this.seededUUIDv4(),type:"simple",updated_at:"2020-04-20T15:25:31.830Z",updated_by:this.randomUser(),...e||{}};return e.entries||t.entries.push({field:aI.a.PATH,operator:"included",type:"match",value:"windows"===t.os_types[0]?"c:\\fol\\bin.exe":"/one/two/three"}),t}generateForCreate(e={}){return Object.assign(IF(this.generate()),e)}generateTrustedApp(e={}){return this.generate({name:`Trusted app (${this.randomString(5)})`,list_id:Bn.m,...e})}generateTrustedAppForCreate(e={}){return{...IF(this.generateTrustedApp()),...e}}generateTrustedAppForUpdate(e={}){return{...MF(this.generateTrustedApp()),...e}}generateEventFilter(e={}){return this.generate({name:`Event filter (${this.randomString(5)})`,list_id:Bn.e,entries:[{field:"process.pe.company",operator:"excluded",type:"match",value:"elastic"},{entries:[{field:"status",operator:"included",type:"match",value:"dfdfd"}],field:"process.Ext.code_signature",type:"nested"}],...e})}generateEventFilterForCreate(e={}){return{...IF(this.generateEventFilter()),...e}}generateEventFilterForUpdate(e={}){return{...MF(this.generateEventFilter()),...e}}generateHostIsolationException(e={}){return this.generate({name:`Host Isolation (${this.randomString(5)})`,list_id:Bn.h,os_types:["macos","linux","windows"],entries:[{field:"destination.ip",operator:"included",type:"match",value:"0.0.0.0/24"}],...e})}generateHostIsolationExceptionForCreate(e={}){return{...IF(this.generateHostIsolationException()),...e}}generateHostIsolationExceptionForUpdate(e={}){return{...MF(this.generateHostIsolationException()),...e}}generateBlocklist(e={}){const t=this.randomOSFamily(),a=[{field:"file.path",value:"windows"===t?["C:\\some\\path","C:\\some\\other\\path","C:\\yet\\another\\path"]:["/some/path","some/other/path","yet/another/path"],type:"match_any",operator:"included"},{field:"file.hash.sha256",value:["a665a45920422f9d417e4867efdc4fb8a04a1f3fff1fa07e998e86f7f7a27ae3","2C26B46B68FFC68FF99B453C1D30413413422D706483BFA0F98A5E886266E7AE","FCDE2B2EDBA56BF408601FB721FE9B5C338D10EE429EA04FAE5511B68FBF8FB9"],type:"match_any",operator:"included"},{field:"file.hash.md5",value:["741462ab431a22233C787BAAB9B653C7"],type:"match_any",operator:"included"},{field:"file.hash.sha1",value:["aedb279e378BED6C2DB3C9DC9e12ba635e0b391c"],type:"match_any",operator:"included"}];return"windows"===t&&a.push({field:"file.Ext.code_signature",entries:[{field:"subject_name",value:["notsus.exe","verynotsus.exe","superlegit.exe"],type:"match_any",operator:"included"}],type:"nested"}),this.generate({name:`Blocklist ${this.randomString(5)}`,list_id:Bn.b,item_id:`generator_endpoint_blocklist_${this.seededUUIDv4()}`,tags:[this.randomChoice([ki.b,ki.d])],os_types:[t],entries:[a[this.randomN(a.length)]],...e})}generateBlocklistForCreate(e={}){return{...IF(this.generateBlocklist()),...e}}generateBlocklistForUpdate(e={}){return{...MF(this.generateBlocklist()),...e}}}const DF=U_([{id:"trustedAppsList",path:`${Bn.o}/_find`,method:"get",handler:({query:e})=>{var t,a;const n=e,i=new exceptions_list_item_generator_ExceptionsListItemGenerator("seed"),r=null!==(t=n.per_page)&&void 0!==t?t:10,s=Array.from({length:Math.min(r,50)},(()=>i.generate({list_id:Bn.m,os_types:["windows"],tags:[ki.d]})));return s.length>2&&(s[2].tags=[`${ki.b}ddf6570b-9175-4a6d-b288-61a09771c647`,`${ki.b}b8e616ae-44fc-4be7-846c-ce8fa5c082dd`]),{page:null!==(a=n.page)&&void 0!==a?a:1,per_page:r,total:20,data:s}}}]),qF=U_([{id:"trustedAppUpdate",path:Bn.o,method:"put",handler:({body:e,path:t})=>{var a;return{...JSON.parse(e),id:null!==(a=t.split("/").pop())&&void 0!==a?a:"unknown-id",comments:[],created_at:"2021-10-12T16:02:55.856Z",created_by:"elastic",updated_at:"2021-10-13T16:02:55.856Z",updated_by:"elastic",list_id:Bn.m,_version:"abc",tie_breaker_id:"1111"}}}]),PF=U_([{id:"trustedApp",path:Bn.o,method:"get",handler:({query:e})=>{var t,a;const n=e,i=new exceptions_list_item_generator_ExceptionsListItemGenerator("seed").generate({os_types:["windows"],tags:[ki.d]});return i.item_id=null!==(t=n.item_id)&&void 0!==t?t:i.item_id,i.namespace_type=null!==(a=n.namespace_type)&&void 0!==a?a:i.namespace_type,i}}]),RF=U_([{id:"trustedAppDelete",path:Bn.o,method:"delete",handler:({query:e})=>{var t,a,n;const i=e,r=new exceptions_list_item_generator_ExceptionsListItemGenerator("seed").generate({os_types:["windows"],tags:[ki.d]});return r.item_id=null!==(t=i.item_id)&&void 0!==t?t:r.item_id,r.id=null!==(a=i.id)&&void 0!==a?a:r.id,r.namespace_type=null!==(n=i.namespace_type)&&void 0!==n?n:r.namespace_type,r}}]);V_([DF,PF,qF,U_([{id:"trustedAppCreate",path:Bn.o,method:"post",handler:({body:e,path:t})=>{var a;const{comments:n,...i}=JSON.parse(e),r={...new exceptions_list_item_generator_ExceptionsListItemGenerator("seed").generate({os_types:["windows"],tags:[ki.d]}),...i};return r.id=null!==(a=t.split("/").pop())&&void 0!==a?a:r.id,r}}]),U_([{id:"trustedAppCreateList",path:Bn.r,method:"post",handler:()=>({...CF(),description:Bn.l,list_id:Bn.m,name:Bn.n})}]),RF,xF,SF]);var _F=a(348);const FF=U_([{id:"exceptionsFind",path:`${Bn.o}/_find`,method:"get",handler:({query:e})=>{var t,a;const n=e,i=new exceptions_list_item_generator_ExceptionsListItemGenerator("seed"),r=null!==(t=n.per_page)&&void 0!==t?t:10,s=Array.from({length:Math.min(r,50)},(()=>i.generate({tags:[_F.b]})));return s.length>2&&(s[2].tags=[`${_F.a}ddf6570b-9175-4a6d-b288-61a09771c647`,`${_F.a}b8e616ae-44fc-4be7-846c-ce8fa5c082dd`]),{page:null!==(a=n.page)&&void 0!==a?a:1,per_page:r,total:20,data:s}}}]),LF=U_([{id:"exceptionUpdate",path:Bn.o,method:"put",handler:({body:e,path:t})=>{var a;return{...JSON.parse(e),id:null!==(a=t.split("/").pop())&&void 0!==a?a:"unknown-id",list_id:"endpoint_list_id",comments:[],created_at:"2021-10-12T16:02:55.856Z",created_by:"elastic",updated_at:"2021-10-13T16:02:55.856Z",updated_by:"elastic",_version:"abc",tie_breaker_id:"1111"}}}]),NF=U_([{id:"exceptionGetOne",path:Bn.o,method:"get",handler:({query:e})=>{var t,a;const n=e,i=new exceptions_list_item_generator_ExceptionsListItemGenerator("seed").generate({os_types:["windows"],tags:[_F.b]});return i.item_id=null!==(t=n.item_id)&&void 0!==t?t:i.item_id,i.namespace_type=null!==(a=n.namespace_type)&&void 0!==a?a:i.namespace_type,i}}]),BF=U_([{id:"exceptionDelete",path:Bn.o,method:"delete",handler:({query:e})=>{var t,a,n;const i=e,r=new exceptions_list_item_generator_ExceptionsListItemGenerator("seed").generate({os_types:["windows"],tags:[_F.b]});return r.item_id=null!==(t=i.item_id)&&void 0!==t?t:r.item_id,r.id=null!==(a=i.id)&&void 0!==a?a:r.id,r.namespace_type=null!==(n=i.namespace_type)&&void 0!==n?n:r.namespace_type,r}}]),zF=(V_([FF,NF,LF,U_([{id:"exceptionCreate",path:Bn.o,method:"post",handler:({body:e,path:t})=>{var a;const{comments:n,...i}=JSON.parse(e),r={...new exceptions_list_item_generator_ExceptionsListItemGenerator("seed").generate({os_types:["windows"],tags:[_F.b]}),...i};return r.id=null!==(a=t.split("/").pop())&&void 0!==a?a:r.id,r}}]),U_([{id:"exceptionCreateList",path:Bn.r,method:"post",handler:()=>CF()}]),BF,U_([{id:"exceptionsSummary",path:`${Bn.r}/summary`,method:"get",handler:()=>({total:10,linux:2,macos:3,windows:5})}])]),U_([{id:"metadataList",path:q_.f,method:"get",handler:()=>{const e=new generate_data_EndpointDocGenerator("seed");return{data:Array.from({length:10},(()=>{const t={metadata:e.generateHostMetadata(),host_status:$R.d.UNHEALTHY};return e.updateCommonInfo(),t})),total:10,page:0,pageSize:10}}},{id:"metadataDetails",path:q_.e,method:"get",handler:()=>({metadata:new generate_data_EndpointDocGenerator("seed").generateHostMetadata(),host_status:$R.d.UNHEALTHY})}])),UF=U_([{id:"policyResponse",path:q_.c,method:"get",handler:()=>new generate_data_EndpointDocGenerator("seed").generatePolicyResponse()}]),HF=U_([{id:"activityLogResponse",path:q_.d,method:"get",handler:()=>{const e=new generate_data_EndpointDocGenerator("seed").generateHostMetadata(),t=new fleet_action_generator_FleetActionGenerator("seed"),a=t.generate({agents:[e.agent.id]});return{page:1,pageSize:50,startDate:"now-1d",endDate:"now",data:[{type:"response",item:{id:"",data:t.generateResponse({agent_id:e.agent.id})}},{type:"action",item:{id:"",data:a}}]}}}]),$F={count:1,transforms:[{state:o.mc.FAILED}]},VF=U_([{id:"metadataTransformStats",path:q_.h,method:"get",handler:()=>$F}]),QF=V_([kF,SF,OF]),WF=(V_([zF,UF,HF,QF,vF,VF]),Object(i.memo)((()=>r.a.createElement(P.Switch,null,r.a.createElement(R.Route,{path:AR.h,exact:!0,component:N_}),r.a.createElement(R.Route,{path:"*",component:_.a})))));WF.displayName="EndpointsContainer";var GF=a(450),KF=a(415);const YF=Object(i.memo)((({policyId:e,nonLinkCondition:t,"data-test-subj":a,children:n,...s})=>{const l=`(language:kuery,query:'united.endpoint.Endpoint.policy.applied.id : "${e}"')`,{search:c}=Object(P.useLocation)(),{getAppUrl:u}=Object(d.d)(),{toRoutePathWithBackOptions:p,toRouteUrl:m}=Object(i.useMemo)((()=>{const e=Object(h.e)({name:"endpointList",admin_query:l}),t=Object(h.h)(c),a={navigateTo:[o.y,{path:t}],label:F.i18n.translate("xpack.securitySolution.policy.backToPolicyList",{defaultMessage:"Back to policy list"}),href:u({path:t})};return{toRoutePathWithBackOptions:{pathname:Object(h.e)({name:"endpointList"}),search:`?admin_query=${l}`,state:{backLink:a}},toRouteUrl:u({path:e})}}),[u,l,c]),g=Object(a_.a)(p);return t?r.a.createElement(N.EuiText,{size:"s","data-test-subj":`${a}_nonLink`},n):r.a.createElement(N.EuiLink,rr()({href:m,"data-test-subj":a,onClick:g},s),n)}));YF.displayName="PolicyEndpointCount";const JF=Object(i.memo)((()=>{const{pagination:e,pageSizeOptions:t,setPagination:a}=Object(GF.b)(),{search:n}=Object(P.useLocation)(),{getAppUrl:s}=Object(d.d)(),l=Object(d.n)(),{data:c,isFetching:u,error:p}=Object(KF.c)({page:e.page,perPage:e.pageSize}),m=Object(i.useMemo)((()=>{var e;return null!==(e=null==c?void 0:c.items.map((e=>e.id)))&&void 0!==e?e:[]}),[c]),{data:g={items:[]}}=Object(KF.a)({policyIds:m,customQueryOptions:{enabled:m.length>0,onError:e=>{l.addDanger(F.i18n.translate("xpack.securitySolution.policyList.endpointCountError",{defaultMessage:"Error retrieving endpoint counts"}))}}}),{data:f,isFetching:b}=Object(KF.b)({customQueryOptions:{enabled:0===m.length,onError:e=>{l.addDanger(F.i18n.translate("xpack.securitySolution.policyList.packageVersionError",{defaultMessage:"Error retrieving the endpoint package version"}))}}}),y=Object(i.useMemo)((()=>{const e=new Map;for(const a of null==g?void 0:g.items)for(const n of a.package_policies){var t;m.includes(n)&&e.set(n,null!==(t=a.agents)&&void 0!==t?t:0)}if(m.length>0&&0===e.size)for(const t of m)e.set(t,0);return e}),[g,m]),E=Object(i.useMemo)((()=>{var e;return null!==(e=null==c?void 0:c.total)&&void 0!==e?e:0}),[c]),v=Object(i.useMemo)((()=>Object(h.h)(n)),[n]),T=Object(i.useMemo)((()=>({navigateTo:[o.y,{path:v}],label:F.i18n.translate("xpack.securitySolution.policy.backToPolicyList",{defaultMessage:"Back to policy list"}),href:s({path:v})})),[s,v]),k=Object(Xv.a)("fleet",{path:qR.pagePathGetters.add_integration_to_policy({pkgkey:f?`/endpoint-${null==f?void 0:f.version}`:""})[1],state:{onCancelNavigateTo:[o.y,{path:v}],onCancelUrl:s({path:Object(h.h)()}),onSaveNavigateTo:[o.y,{path:v}]}}),x=Object(i.useMemo)((()=>{const e=F.i18n.translate("xpack.securitySolution.policy.list.updatedAt",{defaultMessage:"Last Updated"}),t=F.i18n.translate("xpack.securitySolution.policy.list.createdAt",{defaultMessage:"Date Created"});return[{field:"",name:F.i18n.translate("xpack.securitySolution.policy.list.name",{defaultMessage:"Name"}),truncateText:!0,render:e=>r.a.createElement(N.EuiToolTip,{content:e.name,anchorClassName:"eui-textTruncate"},r.a.createElement(n_,{policyId:e.id,className:"eui-textTruncate","data-test-subj":"policyNameCellLink",backLink:T},e.name))},{field:"created_by",name:F.i18n.translate("xpack.securitySolution.policy.list.createdBy",{defaultMessage:"Created by"}),truncateText:!0,render:e=>r.a.createElement(N.EuiFlexGroup,{responsive:!1,gutterSize:"xs",alignItems:"center"},r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiAvatar,{name:e,"data-test-subj":"created-by-avatar",size:"s"})),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiText,{size:"s","data-test-subj":"created-by-name"},e)))},{field:"created_at",name:t,truncateText:!0,render:e=>r.a.createElement(wn.a,{fieldName:t,value:e,className:"eui-textTruncate"})},{field:"updated_by",name:F.i18n.translate("xpack.securitySolution.policy.list.lastUpdatedBy",{defaultMessage:"Last updated by"}),truncateText:!0,render:e=>r.a.createElement(N.EuiFlexGroup,{responsive:!1,gutterSize:"xs",alignItems:"center"},r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiAvatar,{name:e,"data-test-subj":"updated-by-avatar",size:"s"})),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiText,{size:"s","data-test-subj":"updated-by-name"},e)))},{field:"updated_at",name:e,truncateText:!0,render:t=>r.a.createElement(wn.a,{fieldName:e,value:t,className:"eui-textTruncate"})},{field:"",name:F.i18n.translate("xpack.securitySolution.policy.list.endpoints",{defaultMessage:"Endpoints"}),width:"8%",render:e=>{const t=y.get(e.id);return r.a.createElement(YF,{className:"eui-textTruncate","data-test-subj":"policyEndpointCountLink",policyId:e.id,nonLinkCondition:0===t},t)}}]}),[y,T]),S=Object(i.useCallback)((({page:e})=>{a({page:e.index+1,pageSize:e.size})}),[a]),O=Object(i.useMemo)((()=>({pageIndex:e.page-1,pageSize:e.pageSize,totalItemCount:E,pageSizeOptions:t})),[E,t,e.page,e.pageSize]),w=F.i18n.translate("xpack.securitySolution.policy.list.errorMessage",{defaultMessage:"Error while retrieving list of policies"});return r.a.createElement(M_.a,{"data-test-subj":"policyListPage",hideHeader:0===E,title:F.i18n.translate("xpack.securitySolution.policy.list.title",{defaultMessage:"Policies"}),subtitle:F.i18n.translate("xpack.securitySolution.policy.list.subtitle",{defaultMessage:"Use policies to customize endpoint and cloud workload protections and other configurations"})},E>0?r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiText,{color:"subdued",size:"xs","data-test-subj":"endpointListTableTotal"},r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.policy.list.totalCount",defaultMessage:"Showing {totalItemCount, plural, one {# policy} other {# policies}}",values:{totalItemCount:E}})),r.a.createElement(N.EuiHorizontalRule,{margin:"xs"}),r.a.createElement(N.EuiBasicTable,{"data-test-subj":"policyListTable",items:(null==c?void 0:c.items)||[],columns:x,pagination:O,onChange:S,loading:u,error:null!==p?w:""})):r.a.createElement(R_.a,null,r.a.createElement(S_,{loading:b,onActionClick:k,policyEntryPoint:!0})))}));JF.displayName="PolicyList";var XF=a(230),ZF=a(247);const eL=Object(i.memo)((e=>{const t=Object(i.useMemo)((()=>[{key:"total",title:F.i18n.translate("xpack.securitySolution.endpoint.policyDetails.agentsSummary.totalTitle",{defaultMessage:"Total agents"}),health:""},{key:"online",title:F.i18n.translate("xpack.securitySolution.endpoint.policyDetails.agentsSummary.onlineTitle",{defaultMessage:"Healthy"}),health:"success"},{key:"error",title:F.i18n.translate("xpack.securitySolution.endpoint.policyDetails.agentsSummary.errorTitle",{defaultMessage:"Unhealthy"}),health:"warning"},{key:"offline",title:F.i18n.translate("xpack.securitySolution.endpoint.policyDetails.agentsSummary.offlineTitle",{defaultMessage:"Offline"}),health:"subdued"}]),[]),a=Object(i.useContext)(B.ThemeContext);return r.a.createElement(N.EuiFlexGroup,{gutterSize:"l",responsive:!1,"data-test-subj":"policyAgentsSummary"},t.map((({key:t,title:n,health:i})=>r.a.createElement(N.EuiFlexItem,{grow:!1,key:t,style:{marginRight:"total"===t?a.eui.gutterTypes.gutterExtraLarge:void 0}},r.a.createElement(N.EuiDescriptionList,{textStyle:"reverse",style:{textAlign:"right"},listItems:[{title:n,description:r.a.createElement(r.a.Fragment,null,i&&r.a.createElement(N.EuiHealth,{color:"warning"===i?a.eui.euiColorWarning:i,className:"eui-alignMiddle"}),r.a.createElement(N.EuiI18nNumber,{value:e[t]}))}]})))))}));eL.displayName="AgentsSummary";var tL=a(462),aL=a(298),nL=a(260);const iL=(e,t,a,n,r)=>{const{getAppUrl:s}=Object(ol.b)(),{toRoutePath:l,toRouteUrl:c}=Object(i.useMemo)((()=>{const e=n(r);return{toRoutePath:e,toRouteUrl:s({path:e})}}),[s,n,r]),u=a(e),d=Object(i.useMemo)((()=>({backButtonLabel:F.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.empty.unassigned.backButtonLabel",{defaultMessage:"Back to {policyName} policy",values:{policyName:t}}),onBackButtonNavigateTo:[o.y,{path:u}],backButtonUrl:s({appId:o.y,path:u})})),[s,t,u]);return{onClickHandler:Object(Xv.a)(o.y,{state:d,path:l}),toRouteUrl:c,state:d}},rL=Object(i.memo)((({policyId:e,policyName:t,listId:a,labels:n,getPolicyArtifactsPath:s,getArtifactPath:o})=>{const{canCreateArtifactsByPolicy:l}=Object(nt.a)().endpointPrivileges,{onClickHandler:c,toRouteUrl:u}=iL(e,t,s,o),d=Object(XF.b)(a),p=Object(i.useCallback)((()=>d({show:"list"})),[d]);return r.a.createElement(N.EuiPageTemplate,{template:"centeredContent"},r.a.createElement(N.EuiEmptyPrompt,{iconType:"plusInCircle","data-test-subj":"policy-artifacts-empty-unassigned",title:r.a.createElement("h2",null,n.emptyUnassignedTitle),body:n.emptyUnassignedMessage(t),actions:[...l?[r.a.createElement(N.EuiButton,{color:"primary",fill:!0,onClick:p,"data-test-subj":"assign-artifacts-button"},n.emptyUnassignedPrimaryActionButtonTitle)]:[],r.a.createElement(N.EuiLink,{onClick:c,href:u},n.emptyUnassignedSecondaryActionButtonTitle)]}))}));rL.displayName="PolicyArtifactsEmptyUnassigned";const sL=Object(i.memo)((({policyId:e,policyName:t,labels:a,getPolicyArtifactsPath:n,getArtifactPath:i})=>{const{onClickHandler:s,toRouteUrl:o}=iL(e,t,n,i,{show:"create"});return r.a.createElement(N.EuiPageTemplate,{template:"centeredContent"},r.a.createElement(N.EuiEmptyPrompt,{iconType:"plusInCircle","data-test-subj":"policy-artifacts-empty-unexisting",title:r.a.createElement("h2",null,a.emptyUnexistingTitle),body:a.emptyUnexistingMessage,actions:r.a.createElement(N.EuiButton,{color:"primary",fill:!0,onClick:s,href:o},a.emptyUnexistingPrimaryActionButtonTitle)}))}));sL.displayName="PolicyArtifactsEmptyUnexisting";const oL=Object.freeze({emptyUnassignedTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.empty.unassigned.title",{defaultMessage:"No assigned artifacts"}),emptyUnassignedMessage:e=>F.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.empty.unassigned.content",{defaultMessage:"There are currently no artifacts assigned to {policyName}. Assign artifacts now or add and manage them on the artifacts page.",values:{policyName:e}}),emptyUnassignedPrimaryActionButtonTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.empty.unassigned.primaryAction",{defaultMessage:"Assign artifacts"}),emptyUnassignedSecondaryActionButtonTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.empty.unassigned.secondaryAction",{defaultMessage:"Manage artifacts"})}),lL=Object.freeze({emptyUnexistingTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.empty.unexisting.title",{defaultMessage:"No artifacts exist"}),emptyUnexistingMessage:F.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.empty.unexisting.content",{defaultMessage:"There are currently no artifacts applied to your endpoints."}),emptyUnexistingPrimaryActionButtonTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.empty.unexisting.action",{defaultMessage:"Add artifacts"})});var cL=a(611),uL=a(547),dL=a(423),pL=a(856),mL=a(198);const gL=z()(dL.e).withConfig({displayName:"GridHeaderContainer",componentId:"sc-1qje9ej-0"})(["padding-top:0;padding-bottom:",";"],(({theme:e})=>e.eui.paddingSizes.s)),fL=Object(i.memo)((({"data-test-subj":e,expandAllIconType:t,onExpandCollapseAll:a})=>{const n=Object(mL.a)(e),s=Object(i.useMemo)((()=>r.a.createElement(N.EuiButtonIcon,{"data-test-subj":n("expandCollapseAllButton"),"aria-label":F.i18n.translate("xpack.securitySolution.artifactCardGrid.expandCollapseLabel",{defaultMessage:"{action} all cards",values:{action:"Expand"}}),iconType:t,onClick:()=>a(),style:{marginLeft:"-5px"}})),[n,t,a]);return r.a.createElement(gL,{"data-test-subj":e},r.a.createElement(dL.d,{expanded:!1,expandToggle:s,"data-test-subj":n("layout"),flushTop:!0,name:r.a.createElement(N.EuiText,{size:"xs","data-test-subj":n("name")},r.a.createElement("strong",null,r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.artifactCardGrid.nameColumn",defaultMessage:"Name"}))),description:r.a.createElement(N.EuiText,{size:"xs","data-test-subj":n("description")},r.a.createElement("strong",null,r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.artifactCardGrid.DescriptionColumn",defaultMessage:"Description"}))),effectScope:r.a.createElement(N.EuiText,{size:"xs","data-test-subj":n("assignment")},r.a.createElement("strong",null,r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.artifactCardGrid.assignmentColumn",defaultMessage:"Assignment"}))),actionMenu:!0}))}));fL.displayName="GridHeader";const bL=pL.a,hL=Object(i.memo)((({items:e,cardComponentProps:t,onPageChange:a,onExpandCollapse:n,"data-test-subj":s,...o})=>{const l=Object(mL.a)(s),c=e,u=Object(i.useMemo)((()=>{const e=new Map;for(const a of c)e.set(a,t?t(a):{});return e}),[t,c]),d=Object(i.useCallback)((e=>{const t=[],a=[];for(const[n,i]of u){const r=Boolean(i.expanded);(n===e?!r:r)?t.push(n):a.push(n)}n({expanded:t,collapsed:a})}),[u,n]),p=Object(i.useMemo)((()=>{for(const[e,t]of u)if(!Boolean(t.expanded))return!1;return!0}),[u]),m=Object(i.useCallback)((()=>{let e=[],t=[];p?t=Array.from(u.keys()):e=Array.from(u.keys()),n({expanded:e,collapsed:t})}),[u,n,p]),g=Object(i.useMemo)((()=>{const e=new Map;for(const[a,n]of u){var t;e.set(a,{...n,item:a,onExpandCollapse:()=>d(a),"data-test-subj":null!==(t=n["data-test-subj"])&&void 0!==t?t:l("card")})}return e}),[u,l,d]),f=Object(i.useCallback)((e=>g.get(e)),[g]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(fL,{expandAllIconType:p?"fold":"unfold",onExpandCollapseAll:m,"data-test-subj":l("header")}),r.a.createElement(bL,rr()({},o,{"data-test-subj":s,items:c,ItemComponent:dL.c,itemComponentProps:f,onChange:a})))}));hL.displayName="ArtifactCardGrid";var yL=a(417);const EL=r.a.memo((({policy:e,apiClient:t,searchableFields:a,getArtifactPath:n,getPolicyArtifactsPath:s,labels:l,onDeleteActionCallback:c,externalPrivileges:u=!0})=>{var p;(()=>{const e=Object(P.useHistory)(),{urlParams:t}=Object(aL.a)();Object(i.useEffect)((()=>{(t.page_index&&!t.page||t.page_size&&!t.pageSize)&&e.replace(`${e.location.pathname}${e.location.search.replaceAll("page_size","pageSize").replaceAll(`page_index=${t.page_index}`,`page=${Number(t.page_index)+1}`)}`)}),[e,t.page,t.pageSize,t.page_index,t.page_size])})();const{getAppUrl:m}=Object(d.d)(),{canCreateArtifactsByPolicy:g}=Object(nt.a)().endpointPrivileges,f=Object(KF.c)({perPage:1e3}),b=Object(XF.b)(t.listId),{urlParams:h}=Object(aL.a)(),[y,E]=Object(i.useState)(new Map),{state:v}=iL(e.id,e.name,s,n),{pageSizeOptions:T,pagination:k,setPagination:x}=Object(GF.b)(),{data:S,isLoading:O,isRefetching:w}=Object(nL.e)(t,{page:k.page,perPage:k.pageSize,filter:h.filter,policies:[e.id,"all"]},a),j=Object(i.useMemo)((()=>({pageSize:k.pageSize,pageIndex:k.page-1,pageSizeOptions:T,totalItemCount:(null==S?void 0:S.total)||0})),[null==S?void 0:S.total,T,k.page,k.pageSize]),C=Object(i.useCallback)((e=>{b({filter:e})}),[b]),I=Object(i.useCallback)((({expanded:e,collapsed:t})=>{const a=new Map(y);for(const t of e)a.set(t.id,!0);for(const e of t)a.set(e.id,!1);E(a)}),[y]),M=Object(i.useCallback)((({pageIndex:e,pageSize:t})=>{null!=S&&S.total&&x({page:e+1,pageSize:t})}),[null==S?void 0:S.total,x]),A=Object(i.useMemo)((()=>l.listTotalItemCountMessage((null==S?void 0:S.data.length)||0)),[null==S?void 0:S.data.length,l]),D=Object(uL.a)(null===(p=f.data)||void 0===p?void 0:p.items),q=Object(i.useCallback)((e=>{const t=n({filter:e.item_id}),a={icon:"controlsHorizontal",children:l.listFullDetailsActionTitle,href:m({appId:o.y,path:t}),navigateAppId:o.y,navigateOptions:{path:t,state:v},"data-test-subj":"view-full-details-action"},i=e,r=Object(yL.d)(i.tags),s={icon:"trash",children:l.listRemoveActionTitle,onClick:()=>{c(i)},disabled:r,toolTipContent:r?l.listRemoveActionNotAllowedMessage:void 0,toolTipPosition:"top","data-test-subj":"remove-from-policy-action"};return{expanded:y.get(i.id)||!1,actions:g&&u?[a,s]:[a],policies:D}}),[D,g,y,u,m,n,l.listFullDetailsActionTitle,l.listRemoveActionNotAllowedMessage,l.listRemoveActionTitle,c,v]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(cL.a,{placeholder:l.listSearchPlaceholderMessage,defaultValue:h.filter,hideRefreshButton:!0,onSearch:C}),r.a.createElement(N.EuiSpacer,{size:"s"}),r.a.createElement(N.EuiText,{color:"subdued",size:"xs","data-test-subj":"policyDetailsArtifactsSearchCount"},A),r.a.createElement(N.EuiSpacer,{size:"m"}),r.a.createElement(hL,{items:(null==S?void 0:S.data)||[],onPageChange:M,onExpandCollapse:I,cardComponentProps:q,pagination:S?j:void 0,loading:O||w,"data-test-subj":"artifacts-collapsed-list"}))}));EL.displayName="PolicyArtifactsList";const vL=Object.freeze({listTotalItemCountMessage:e=>F.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.totalItemCount",{defaultMessage:"Showing {totalItemsCount, plural, one {# artifact} other {# artifacts}}",values:{totalItemsCount:e}}),listFullDetailsActionTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.fullDetailsAction",{defaultMessage:"View full details"}),listRemoveActionTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.removeAction",{defaultMessage:"Remove from policy"}),listRemoveActionNotAllowedMessage:F.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.removeActionNotAllowed",{defaultMessage:"Globally applied artifact cannot be removed from policy."}),listSearchPlaceholderMessage:F.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.search.placeholder",{defaultMessage:"Search on the fields below: name, description, value"})}),TL=r.a.memo((({artifacts:e,isListLoading:t,selectedArtifactIds:a,selectedArtifactsUpdated:n})=>{const s=Object(i.useMemo)((()=>a.reduce(((e,t)=>({...e,[t]:!0})),{})),[a]),o=Object(i.useMemo)((()=>{if(!e||!e.data.length)return null;const t=e.data;return r.a.createElement("div",{"data-test-subj":"artifactsList"},t.map((e=>r.a.createElement(dL.b,{key:e.id,item:e,isSelected:s[e.id]||!1,onToggleSelectedArtifact:t=>n(e.id,t)}))))}),[e,s,n]);return r.a.createElement(r.a.Fragment,null,t&&r.a.createElement(N.EuiProgress,{size:"xs",color:"primary","data-test-subj":"artifactsAssignableListLoader"}),r.a.createElement("div",null,o))}));TL.displayName="PolicyArtifactsAssignableList";const kL=r.a.memo((({policyItem:e,apiClient:t,searchableFields:a,onClose:n,labels:s})=>{const o=Object(d.n)(),l=Object(ln.useQueryClient)(),[c,u]=Object(i.useState)([]),[p,m]=Object(i.useState)(""),g=Object(nL.a)(t,{onSuccess:e=>{o.addSuccess({title:s.flyoutSuccessMessageTitle,text:s.flyoutSuccessMessageText(e)}),l.invalidateQueries(["list",t]),n()},onError:()=>{o.addDanger(s.flyoutErrorMessage)}}),{data:f,isLoading:b,isRefetching:h}=Object(nL.e)(t,{perPage:100,filter:p,excludedPolicies:[e.id,"all"]},a),{data:y,isLoading:v}=Object(nL.e)(t,{excludedPolicies:[e.id,"all"]},a),T=Object(i.useCallback)((e=>{u([]),m(e)}),[]),k=Object(i.useCallback)((()=>{if(!f)return;const t=[];c.forEach((a=>{const n=f.data.find((e=>e.id===a));n&&(n.tags=[...n.tags,`policy:${e.id}`],t.push(n))})),g.mutate(t)}),[g,f,e.id,c]),x=Object(i.useMemo)((()=>r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiCallOut,{"data-test-subj":"artifacts-too-many-results",color:"warning",size:"s",heading:"h4",title:s.flyoutWarningCalloutTitle},s.flyoutWarningCalloutMessage(100)),r.a.createElement(N.EuiSpacer,{size:"m"}))),[s]),S=Object(i.useMemo)((()=>0!==(null==y?void 0:y.total)&&(0!==(null==f?void 0:f.total)||""!==p)),[null==y?void 0:y.total,null==f?void 0:f.total,p]),O=Object(i.useMemo)((()=>b||h||v),[v,b,h]),w=Object(i.useMemo)((()=>O?null:S?0===(null==f?void 0:f.total)?r.a.createElement(N.EuiEmptyPrompt,{titleSize:"xs","data-test-subj":"artifacts-no-items-found",body:r.a.createElement("p",null,s.flyoutNoSearchResultsMessage)}):void 0:r.a.createElement(N.EuiEmptyPrompt,{titleSize:"xs","data-test-subj":"artifacts-no-assignable-items",body:r.a.createElement("p",null,s.flyoutNoArtifactsToBeAssignedMessage)})),[O,S,null==f?void 0:f.total,s.flyoutNoArtifactsToBeAssignedMessage,s.flyoutNoSearchResultsMessage]);return r.a.createElement(N.EuiFlyout,{onClose:n,"data-test-subj":"artifacts-assign-flyout"},r.a.createElement(N.EuiFlyoutHeader,{hasBorder:!0},r.a.createElement(N.EuiTitle,{size:"m"},r.a.createElement("h2",null,s.flyoutTitle)),r.a.createElement(N.EuiSpacer,{size:"m"}),s.flyoutSubtitle(e.name)),r.a.createElement(N.EuiFlyoutBody,null,((null==f?void 0:f.total)||0)>100?x:null,!v&&S&&r.a.createElement(cL.a,{onSearch:T,placeholder:s.flyoutSearchPlaceholder,hideRefreshButton:!0}),r.a.createElement(N.EuiSpacer,{size:"m"}),r.a.createElement(TL,{"data-test-subj":"artifacts-assignable-list",artifacts:f,selectedArtifactIds:c,isListLoading:b||h,selectedArtifactsUpdated:(e,t)=>{u((a=>t?[...a,e]:Object(E.without)([e],a)))}}),w),r.a.createElement(N.EuiFlyoutFooter,null,r.a.createElement(N.EuiFlexGroup,{justifyContent:"spaceBetween"},r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiButtonEmpty,{"data-test-subj":"artifacts-assign-cancel-button",onClick:n},s.flyoutCancelButtonTitle)),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiButton,{className:"eui-textTruncate",style:{maxWidth:"300px"},"data-test-subj":"artifacts-assign-confirm-button",fill:!0,onClick:k,isLoading:g.isLoading||b||h,disabled:Object(E.isEmpty)(c),title:e.name},s.flyoutSubmitButtonTitle(e.name))))))}));kL.displayName="PolicyArtifactsFlyout";const xL=Object.freeze({flyoutWarningCalloutTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.searchWarning.title",{defaultMessage:"Limited search results"}),flyoutWarningCalloutMessage:e=>F.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.searchWarning.text",{defaultMessage:"Only the first {maxNumber} artifacts are displayed. Please use the search bar to refine the results.",values:{maxNumber:e}}),flyoutNoArtifactsToBeAssignedMessage:F.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.noAssignable",{defaultMessage:"There are no artifacts that can be assigned to this policy."}),flyoutNoSearchResultsMessage:F.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.noResults",{defaultMessage:"No items found"}),flyoutTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.title",{defaultMessage:"Assign artifacts"}),flyoutSubtitle:e=>F.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.subtitle",{defaultMessage:"Select artifacts to add to {policyName}",values:{policyName:e}}),flyoutSearchPlaceholder:F.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.search.label",{defaultMessage:"Search artifacts"}),flyoutCancelButtonTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.cancel",{defaultMessage:"Cancel"}),flyoutSubmitButtonTitle:e=>F.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.confirm",{defaultMessage:"Assign to {policyName}",values:{policyName:e}}),flyoutErrorMessage:F.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.toastError.text",{defaultMessage:"An error occurred updating artifacts"}),flyoutSuccessMessageTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.toastSuccess.title",{defaultMessage:"Success"}),flyoutSuccessMessageText:e=>e.length>1?F.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.toastSuccess.textMultiples",{defaultMessage:"{count} artifacts have been added to your list.",values:{count:e.length}}):F.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.toastSuccess.textSingle",{defaultMessage:'"{name}" has been added to your artifacts list.',values:{name:e[0].name}})}),SL=r.a.memo((({policyId:e,policyName:t,apiClient:a,exception:n,onClose:s,labels:o})=>{const l=Object(d.n)(),c=Object(ln.useQueryClient)(),{mutate:u,isLoading:p}=Object(nL.a)(a,{onSuccess:()=>{l.addSuccess({title:o.deleteModalSuccessMessageTitle,text:o.deleteModalSuccessMessageText(n,t)}),c.invalidateQueries(["list",a]),s()},onError:e=>{l.addError(e,{title:o.deleteModalErrorMessage})}}),m=Object(i.useCallback)((()=>{const t={...n,tags:n.tags.filter((t=>t!==`${_F.a}${e}`))};u([t])}),[n,e,u]),g=Object(i.useCallback)((()=>{p||s()}),[p,s]);return r.a.createElement(N.EuiConfirmModal,{onCancel:g,onConfirm:m,title:o.deleteModalTitle,cancelButtonText:o.deleteModalCancelButtonTitle,confirmButtonText:o.deleteModalSubmitButtonTitle,isLoading:p,"data-test-subj":"remove-from-policy-dialog"},r.a.createElement(N.EuiCallOut,{color:"warning",iconType:"help"},r.a.createElement("p",null,o.deleteModalImpactInfo)),r.a.createElement(N.EuiSpacer,null),r.a.createElement(N.EuiText,{size:"s"},r.a.createElement("p",null,o.deleteModalConfirmInfo)))})),OL=Object.freeze({deleteModalTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.removeDialog.title",{defaultMessage:"Remove artifact from policy"}),deleteModalImpactInfo:F.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.removeDialog.messageCallout",{defaultMessage:"This artifact will be removed only from this policy and can still be found and managed from the artifact page."}),deleteModalConfirmInfo:F.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.removeDialog.message",{defaultMessage:"Are you sure you wish to continue?"}),deleteModalSubmitButtonTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.removeDialog.confirmLabel",{defaultMessage:"Remove from policy"}),deleteModalCancelButtonTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.removeDialog.cancelLabel",{defaultMessage:"Cancel"}),deleteModalSuccessMessageTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.removeDialog.successToastTitle",{defaultMessage:"Successfully removed"}),deleteModalSuccessMessageText:(e,t)=>F.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.removeDialog.successToastText",{defaultMessage:'"{artifactName}" has been removed from {policyName} policy',values:{artifactName:e.name,policyName:t}}),deleteModalErrorMessage:F.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.removeDialog.errorToastTitle",{defaultMessage:"Error while attempting to remove artifact"})}),wL=Object.freeze({layoutTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.title",{defaultMessage:"Assigned artifacts"}),layoutAssignButtonTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.assignToPolicy",{defaultMessage:"Assign artifact to policy"}),layoutViewAllLinkMessage:F.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.about.viewAllLinkLabel",{defaultMessage:"view all artifacts"}),layoutAboutMessage:(e,t)=>F.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.about",{defaultMessage:"There {count, plural, one {is} other {are}} {count} {count, plural, =1 {artifact} other {artifacts}} associated with this policy. Click here to view all artifacts",values:{count:e}})}),jL=Object.freeze({...wL,...OL,...xL,...oL,...lL,...vL}),CL=r.a.memo((({policyItem:e,labels:t={},getExceptionsListApiClient:a,searchableFields:n,getArtifactPath:s,getPolicyArtifactsPath:l,externalPrivileges:c=!0})=>{const u=Object(i.useMemo)((()=>a()),[a]),{getAppUrl:p}=Object(d.d)(),m=Object(XF.b)(u.listId),{canCreateArtifactsByPolicy:g}=Object(nt.a)().endpointPrivileges,{urlParams:f}=Object(aL.a)(),[b,h]=Object(i.useState)(),y=Object(i.useMemo)((()=>({...jL,...t})),[t]),{data:E,isLoading:v}=Object(nL.e)(u,{policies:e?[e.id,"all"]:[]},n),{data:T,isLoading:k,isRefetching:x}=Object(nL.e)(u,{},n,{},["allExisting"]),S=Object(i.useCallback)((()=>{m({show:"list"})}),[m]),O=Object(i.useCallback)((()=>{m({show:void 0})}),[m]),w=Object(i.useCallback)((()=>{h(void 0)}),[h]),j=Object(i.useCallback)((e=>{h(e)}),[h]),C=Object(i.useMemo)((()=>r.a.createElement(N.EuiButton,{fill:!0,iconType:"plusInCircle","data-test-subj":"artifacts-assign-button",onClick:S},y.layoutAssignButtonTitle)),[S,y.layoutAssignButtonTitle]),I=Object(i.useMemo)((()=>{const e=r.a.createElement(N.EuiLink,{href:p({appId:o.y,path:s()}),target:"_blank"},y.layoutViewAllLinkMessage);return y.layoutAboutMessage((null==E?void 0:E.total)||0,e)}),[p,s,y,null==E?void 0:E.total]),M=Object(i.useMemo)((()=>v||k||x),[v,k,x]),A=Object(i.useMemo)((()=>E&&0===E.total),[E]);return!e||M?r.a.createElement(tL.a,{"data-test-subj":"policy-artifacts-loading-spinner"}):A?r.a.createElement(r.a.Fragment,null,g&&"list"===f.show&&r.a.createElement(kL,{policyItem:e,apiClient:u,searchableFields:[...n],onClose:O,labels:y}),T&&0!==T.total?r.a.createElement(rL,{policyId:e.id,policyName:e.name,listId:u.listId,labels:y,getPolicyArtifactsPath:l,getArtifactPath:s}):r.a.createElement(sL,{policyId:e.id,policyName:e.name,labels:y,getPolicyArtifactsPath:l,getArtifactPath:s})):r.a.createElement("div",null,r.a.createElement(N.EuiPageHeader,{alignItems:"center"},r.a.createElement(N.EuiPageHeaderSection,{"data-test-subj":"policy-artifacts-header-section"},r.a.createElement(N.EuiTitle,{size:"m"},r.a.createElement("h2",null,y.layoutTitle)),r.a.createElement(N.EuiSpacer,{size:"s"}),r.a.createElement(N.EuiText,{size:"xs","data-test-subj":"policy-artifacts-layout-about"},r.a.createElement("p",null,I))),r.a.createElement(N.EuiPageHeaderSection,null,g&&c&&C)),g&&c&&"list"===f.show&&r.a.createElement(kL,{policyItem:e,apiClient:u,searchableFields:[...n],onClose:O,labels:y}),b&&r.a.createElement(SL,{policyId:e.id,policyName:e.name,apiClient:u,exception:b,onClose:w,labels:y}),r.a.createElement(N.EuiSpacer,{size:"l"}),r.a.createElement(N.EuiPageContent,{hasBorder:!1,hasShadow:!1,paddingSize:"none",color:"transparent",borderRadius:"none"},r.a.createElement(EL,{policy:e,apiClient:u,searchableFields:[...n],labels:y,onDeleteActionCallback:j,externalPrivileges:c,getPolicyArtifactsPath:l,getArtifactPath:s})))}));CL.displayName="PolicyArtifactsLayout";var IL=a(796);const ML=r.a.memo((({endpointCount:e,onCancel:t,onConfirm:a})=>r.a.createElement(N.EuiConfirmModal,{"data-test-subj":"policyDetailsConfirmModal",title:F.i18n.translate("xpack.securitySolution.endpoint.policy.details.updateConfirm.title",{defaultMessage:"Save and deploy changes"}),onCancel:t,onConfirm:a,confirmButtonText:F.i18n.translate("xpack.securitySolution.endpoint.policy.details.updateConfirm.confirmButtonTitle",{defaultMessage:"Save and deploy changes"}),cancelButtonText:F.i18n.translate("xpack.securitySolution.endpoint.policy.details.updateConfirm.cancelButtonTitle",{defaultMessage:"Cancel"})},e>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiCallOut,{"data-test-subj":"policyDetailsWarningCallout",title:F.i18n.translate("xpack.securitySolution.endpoint.policy.details.updateConfirm.warningTitle",{defaultMessage:"This action will update {endpointCount, plural, one {# endpoint} other {# endpoints}}",values:{endpointCount:e}})},r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.updateConfirm.warningMessage",defaultMessage:"Saving these changes will apply updates to all endpoints assigned to this agent policy."})),r.a.createElement(N.EuiSpacer,{size:"xl"})),r.a.createElement("p",null,r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.updateConfirm.message",defaultMessage:"This action cannot be undone. Are you sure you wish to continue?"})))));ML.displayName="ConfirmUpdate";const AL=r.a.memo((()=>{var e,t;const a=Object(l.useDispatch)(),{services:{theme:n,application:{navigateToApp:s}}}=Object(d.j)(),c=Object(d.n)(),{state:u}=Object(P.useLocation)(),p=Object(XF.c)(ZF.l),m=Object(XF.c)(ZF.a),g=Object(XF.c)(ZF.o),f=Object(XF.c)(ZF.e),[E,v]=Object(i.useState)(!1),[k,x]=Object(i.useState)(),S=null!==(e=null==p?void 0:p.name)&&void 0!==e?e:"",O=Object(h.e)({name:"endpointList"}),w=null==k?void 0:k.onCancelNavigateTo,j=Object(i.useMemo)((()=>null!=w?w:[o.y,{path:O}]),[O,w]);Object(i.useEffect)((()=>{g&&(g.success?(c.addSuccess({title:F.i18n.translate("xpack.securitySolution.endpoint.policy.details.updateSuccessTitle",{defaultMessage:"Success!"}),text:Object(R.toMountPoint)(r.a.createElement("span",{"data-test-subj":"policyDetailsSuccessMessage"},r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.updateSuccessMessage",defaultMessage:"Integration {name} has been updated.",values:{name:S}})),{theme$:n.theme$})}),k&&k.onSaveNavigateTo&&s(...k.onSaveNavigateTo)):c.addDanger({title:F.i18n.translate("xpack.securitySolution.endpoint.policy.details.updateErrorTitle",{defaultMessage:"Failed!"}),text:g.error.message}))}),[s,c,S,g,k,n.theme$]);const C=Object(Xv.a)(...j),I=Object(i.useCallback)((()=>{v(!0)}),[]),M=Object(i.useCallback)((()=>{a({type:"userClickedPolicyDetailsSaveButton"}),v(!1)}),[a]),A=Object(i.useCallback)((()=>{v(!1)}),[]);return Object(i.useEffect)((()=>{!k&&u&&x(u)}),[u,k]),p?r.a.createElement(r.a.Fragment,null,E&&r.a.createElement(ML,{endpointCount:null!==(t=null==m?void 0:m.total)&&void 0!==t?t:0,onCancel:A,onConfirm:M}),r.a.createElement(IL.a,null),r.a.createElement(N.EuiSpacer,{size:"xxl"}),r.a.createElement(N.EuiBottomBar,{paddingSize:"s"},r.a.createElement(N.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiButtonEmpty,{color:"ghost",onClick:C,"data-test-subj":"policyDetailsCancelButton"},r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.cancel",defaultMessage:"Cancel"}))),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(N.EuiButton,{fill:!0,iconType:"save","data-test-subj":"policyDetailsSaveButton",onClick:I,isLoading:f},r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.save",defaultMessage:"Save"})))))):r.a.createElement(b.a,{noTimeline:!0},f?r.a.createElement(N.EuiLoadingSpinner,{size:"xl"}):null,r.a.createElement(y.a,{pageName:T.a.administration}))}));AL.displayName="PolicyFormLayout";const DL=Object.freeze({deleteModalTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.list.removeDialog.title",{defaultMessage:"Remove event filter from policy"}),deleteModalImpactInfo:F.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.list.removeDialog.messageCallout",{defaultMessage:"This event filter will be removed only from this policy and can still be found and managed from the artifact page."}),deleteModalErrorMessage:F.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.list.removeDialog.errorToastTitle",{defaultMessage:"Error while attempting to remove event filter"}),flyoutWarningCalloutMessage:e=>F.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.layout.flyout.searchWarning.text",{defaultMessage:"Only the first {maxNumber} event filters are displayed. Please use the search bar to refine the results.",values:{maxNumber:e}}),flyoutNoArtifactsToBeAssignedMessage:F.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.layout.flyout.noAssignable",{defaultMessage:"There are no event filters that can be assigned to this policy."}),flyoutTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.layout.flyout.title",{defaultMessage:"Assign event filters"}),flyoutSubtitle:e=>F.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.layout.flyout.subtitle",{defaultMessage:"Select event filters to add to {policyName}",values:{policyName:e}}),flyoutSearchPlaceholder:F.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.layout.search.label",{defaultMessage:"Search event filters"}),flyoutErrorMessage:F.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.layout.flyout.toastError.text",{defaultMessage:"An error occurred updating event filters"}),flyoutSuccessMessageText:e=>e.length>1?F.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.layout.flyout.toastSuccess.textMultiples",{defaultMessage:"{count} event filters have been added to your list.",values:{count:e.length}}):F.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.layout.flyout.toastSuccess.textSingle",{defaultMessage:'"{name}" has been added to your event filter list.',values:{name:e[0].name}}),emptyUnassignedTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.empty.unassigned.title",{defaultMessage:"No assigned event filters"}),emptyUnassignedMessage:e=>F.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.empty.unassigned.content",{defaultMessage:"There are currently no event filters assigned to {policyName}. Assign event filters now or add and manage them on the event filters page.",values:{policyName:e}}),emptyUnassignedPrimaryActionButtonTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.empty.unassigned.primaryAction",{defaultMessage:"Assign event filters"}),emptyUnassignedSecondaryActionButtonTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.empty.unassigned.secondaryAction",{defaultMessage:"Manage event filters"}),emptyUnexistingTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.empty.unexisting.title",{defaultMessage:"No event filters exist"}),emptyUnexistingMessage:F.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.empty.unexisting.content",{defaultMessage:"There are currently no event filters applied to your endpoints."}),emptyUnexistingPrimaryActionButtonTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.empty.unexisting.action",{defaultMessage:"Add event filters"}),listTotalItemCountMessage:e=>F.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.list.totalItemCount",{defaultMessage:"Showing {totalItemsCount, plural, one {# event filter} other {# event filters}}",values:{totalItemsCount:e}}),listRemoveActionNotAllowedMessage:F.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.list.removeActionNotAllowed",{defaultMessage:"Globally applied event filter cannot be removed from policy."}),listSearchPlaceholderMessage:F.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.list.search.placeholder",{defaultMessage:"Search on the fields below: name, description, comments, value"}),layoutTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.layout.title",{defaultMessage:"Assigned event filters"}),layoutAssignButtonTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.layout.assignToPolicy",{defaultMessage:"Assign event filters to policy"}),layoutViewAllLinkMessage:F.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.layout.about.viewAllLinkLabel",{defaultMessage:"view all event filters"})}),qL=Object.freeze({deleteModalTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.list.removeDialog.title",{defaultMessage:"Remove trusted application from policy"}),deleteModalImpactInfo:F.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.list.removeDialog.messageCallout",{defaultMessage:"This trusted application will be removed only from this policy and can still be found and managed from the artifact page."}),deleteModalErrorMessage:F.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.list.removeDialog.errorToastTitle",{defaultMessage:"Error while attempting to remove trusted app"}),flyoutWarningCalloutMessage:e=>F.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.flyout.searchWarning.text",{defaultMessage:"Only the first {maxNumber} trusted applications are displayed. Please use the search bar to refine the results.",values:{maxNumber:e}}),flyoutNoArtifactsToBeAssignedMessage:F.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.flyout.noAssignable",{defaultMessage:"There are no trusted applications that can be assigned to this policy."}),flyoutTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.flyout.title",{defaultMessage:"Assign trusted applications"}),flyoutSubtitle:e=>F.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.flyout.subtitle",{defaultMessage:"Select trusted applications to add to {policyName}",values:{policyName:e}}),flyoutSearchPlaceholder:F.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.search.label",{defaultMessage:"Search trusted applications"}),flyoutErrorMessage:F.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.flyout.toastError.text",{defaultMessage:"An error occurred updating trusted applications"}),flyoutSuccessMessageText:e=>e.length>1?F.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.flyout.toastSuccess.textMultiples",{defaultMessage:"{count} trusted applications have been added to your list.",values:{count:e.length}}):F.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.flyout.toastSuccess.textSingle",{defaultMessage:'"{name}" has been added to your trusted application list.',values:{name:e[0].name}}),emptyUnassignedTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.empty.unassigned.title",{defaultMessage:"No assigned trusted applications"}),emptyUnassignedMessage:e=>F.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.empty.unassigned.content",{defaultMessage:"There are currently no trusted applications assigned to {policyName}. Assign trusted applications now or add and manage them on the trusted applications page.",values:{policyName:e}}),emptyUnassignedPrimaryActionButtonTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.empty.unassigned.primaryAction",{defaultMessage:"Assign trusted applications"}),emptyUnassignedSecondaryActionButtonTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.empty.unassigned.secondaryAction",{defaultMessage:"Manage trusted applications"}),emptyUnexistingTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.empty.unexisting.title",{defaultMessage:"No trusted applications exist"}),emptyUnexistingMessage:F.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.empty.unexisting.content",{defaultMessage:"There are currently no trusted applications applied to your endpoints."}),emptyUnexistingPrimaryActionButtonTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.empty.unexisting.action",{defaultMessage:"Add trusted applications"}),listTotalItemCountMessage:e=>F.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.list.totalItemCount",{defaultMessage:"Showing {totalItemsCount, plural, one {# trusted app} other {# trusted applications}}",values:{totalItemsCount:e}}),listRemoveActionNotAllowedMessage:F.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.list.removeActionNotAllowed",{defaultMessage:"Globally applied trusted application cannot be removed from policy."}),listSearchPlaceholderMessage:F.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.list.search.placeholder",{defaultMessage:"Search on the fields below: name, description, value"}),layoutTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.title",{defaultMessage:"Assigned trusted applications"}),layoutAssignButtonTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.assignToPolicy",{defaultMessage:"Assign trusted applications to policy"}),layoutViewAllLinkMessage:F.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.about.viewAllLinkLabel",{defaultMessage:"view all trusted applications"})}),PL=Object.freeze({deleteModalTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.list.removeDialog.title",{defaultMessage:"Remove host isolation exception from policy"}),deleteModalImpactInfo:F.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.list.removeDialog.messageCallout",{defaultMessage:"This host isolation exception will be removed only from this policy and can still be found and managed from the artifact page."}),deleteModalErrorMessage:F.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.list.removeDialog.errorToastTitle",{defaultMessage:"Error while attempting to remove host isolation exception"}),flyoutWarningCalloutMessage:e=>F.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.layout.flyout.searchWarning.text",{defaultMessage:"Only the first {maxNumber} host isolation exceptions are displayed. Please use the search bar to refine the results.",values:{maxNumber:e}}),flyoutNoArtifactsToBeAssignedMessage:F.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.layout.flyout.noAssignable",{defaultMessage:"There are no host isolation exceptions that can be assigned to this policy."}),flyoutTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.layout.flyout.title",{defaultMessage:"Assign host isolation exceptions"}),flyoutSubtitle:e=>F.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.layout.flyout.subtitle",{defaultMessage:"Select host isolation exceptions to add to {policyName}",values:{policyName:e}}),flyoutSearchPlaceholder:F.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.layout.search.label",{defaultMessage:"Search host isolation exceptions"}),flyoutErrorMessage:F.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.layout.flyout.toastError.text",{defaultMessage:"An error occurred updating host isolation exceptions"}),flyoutSuccessMessageText:e=>e.length>1?F.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.layout.flyout.toastSuccess.textMultiples",{defaultMessage:"{count} host isolation exceptions have been added to your list.",values:{count:e.length}}):F.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.layout.flyout.toastSuccess.textSingle",{defaultMessage:'"{name}" has been added to your host isolation exception list.',values:{name:e[0].name}}),emptyUnassignedTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.empty.unassigned.title",{defaultMessage:"No assigned host isolation exceptions"}),emptyUnassignedMessage:e=>F.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.empty.unassigned.content",{defaultMessage:"There are currently no host isolation exceptions assigned to {policyName}. Assign host isolation exceptions now or add and manage them on the host isolation exceptions page.",values:{policyName:e}}),emptyUnassignedPrimaryActionButtonTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.empty.unassigned.primaryAction",{defaultMessage:"Assign host isolation exceptions"}),emptyUnassignedSecondaryActionButtonTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.empty.unassigned.secondaryAction",{defaultMessage:"Manage host isolation exceptions"}),emptyUnexistingTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.empty.unexisting.title",{defaultMessage:"No host isolation exceptions exist"}),emptyUnexistingMessage:F.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.empty.unexisting.content",{defaultMessage:"There are currently no host isolation exceptions applied to your endpoints."}),emptyUnexistingPrimaryActionButtonTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.empty.unexisting.action",{defaultMessage:"Add host isolation exceptions"}),listTotalItemCountMessage:e=>F.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.list.totalItemCount",{defaultMessage:"Showing {totalItemsCount, plural, one {# host isolation exception} other {# host isolation exceptions}}",values:{totalItemsCount:e}}),listRemoveActionNotAllowedMessage:F.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.list.removeActionNotAllowed",{defaultMessage:"Globally applied host isolation exception cannot be removed from policy."}),listSearchPlaceholderMessage:F.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.list.search.placeholder",{defaultMessage:"Search on the fields below: name, description, IP"}),layoutTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.layout.title",{defaultMessage:"Assigned host isolation exceptions"}),layoutAssignButtonTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.layout.assignToPolicy",{defaultMessage:"Assign host isolation exceptions to policy"}),layoutViewAllLinkMessage:F.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.layout.about.viewAllLinkLabel",{defaultMessage:"view all host isolation exceptions"})}),RL=Object.freeze({deleteModalTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.list.removeDialog.title",{defaultMessage:"Remove blocklist entry from policy"}),deleteModalImpactInfo:F.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.list.removeDialog.messageCallout",{defaultMessage:"This blocklist entry will be removed only from this policy and can still be found and managed from the artifact page."}),deleteModalErrorMessage:F.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.list.removeDialog.errorToastTitle",{defaultMessage:"Error while attempting to remove blocklist entry"}),flyoutWarningCalloutMessage:e=>F.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.layout.flyout.searchWarning.text",{defaultMessage:"Only the first {maxNumber} blocklist entries are displayed. Please use the search bar to refine the results.",values:{maxNumber:e}}),flyoutNoArtifactsToBeAssignedMessage:F.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.layout.flyout.noAssignable",{defaultMessage:"There are no blocklist entries that can be assigned to this policy."}),flyoutTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.layout.flyout.title",{defaultMessage:"Assign blocklist entries"}),flyoutSubtitle:e=>F.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.layout.flyout.subtitle",{defaultMessage:"Select blocklist entries to add to {policyName}",values:{policyName:e}}),flyoutSearchPlaceholder:F.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.layout.search.label",{defaultMessage:"Search blocklist entries"}),flyoutErrorMessage:F.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.layout.flyout.toastError.text",{defaultMessage:"An error occurred updating blocklist entry"}),flyoutSuccessMessageText:e=>e.length>1?F.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.layout.flyout.toastSuccess.textMultiples",{defaultMessage:"{count} blocklist entries have been added to your list.",values:{count:e.length}}):F.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.layout.flyout.toastSuccess.textSingle",{defaultMessage:'"{name}" blocklist has been added to your list.',values:{name:e[0].name}}),emptyUnassignedTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.empty.unassigned.title",{defaultMessage:"No assigned blocklist entries"}),emptyUnassignedMessage:e=>F.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.empty.unassigned.content",{defaultMessage:"There are currently no blocklist entries assigned to {policyName}. Assign blocklist entries now or add and manage them on the blocklist page.",values:{policyName:e}}),emptyUnassignedPrimaryActionButtonTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.empty.unassigned.primaryAction",{defaultMessage:"Assign blocklist entry"}),emptyUnassignedSecondaryActionButtonTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.empty.unassigned.secondaryAction",{defaultMessage:"Manage blocklist entries"}),emptyUnexistingTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.empty.unexisting.title",{defaultMessage:"No blocklists entries exist"}),emptyUnexistingMessage:F.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.empty.unexisting.content",{defaultMessage:"There are currently no blocklist entries applied to your endpoints."}),emptyUnexistingPrimaryActionButtonTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.empty.unexisting.action",{defaultMessage:"Add blocklist entry"}),listTotalItemCountMessage:e=>F.i18n.translate("xpack.securitySolution.endpoint.policy.blocklists.list.totalItemCount",{defaultMessage:"Showing {totalItemsCount, plural, one {# blocklist entry} other {# blocklist entries}}",values:{totalItemsCount:e}}),listRemoveActionNotAllowedMessage:F.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.list.removeActionNotAllowed",{defaultMessage:"Globally applied blocklist cannot be removed from policy."}),listSearchPlaceholderMessage:F.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.list.search.placeholder",{defaultMessage:"Search on the fields below: name, description, value"}),layoutTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.layout.title",{defaultMessage:"Assigned blocklist entries"}),layoutAssignButtonTitle:F.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.layout.assignToPolicy",{defaultMessage:"Assign blocklist entry to policy"}),layoutViewAllLinkMessage:F.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.layout.about.viewAllLinkLabel",{defaultMessage:"view all blocklist entries"})});var _L,FL=a(388),LL=a(416),NL=a(390),BL=a(334),zL=a(389),UL=a(379),HL=a(367),$L=a(421);!function(e){e.SETTINGS="settings",e.TRUSTED_APPS="trustedApps",e.EVENT_FILTERS="eventFilters",e.HOST_ISOLATION_EXCEPTIONS="hostIsolationExceptions",e.BLOCKLISTS="blocklists"}(_L||(_L={}));const VL=r.a.memo((()=>{var e;const t=Object(P.useHistory)(),a=Object(d.i)(),n=Object(XF.c)(ZF.i),s=Object(XF.c)(ZF.j),o=Object(XF.c)(ZF.h),l=Object(XF.c)(ZF.g),c=Object(XF.c)(ZF.f),u=Object(XF.c)(ZF.n),p=Object(XF.c)(ZF.l),m=Object(nt.a)().endpointPrivileges,{state:g={}}=Object(P.useLocation)(),f=Object(nL.e)(BL.a.getInstance(a),{page:1,perPage:100,policies:[u,"all"]},HL.b,{enabled:!m.loading&&!m.canIsolateHost}),b=m.canIsolateHost||f.isFetched&&0!==(null===(e=f.data)||void 0===e?void 0:e.total);Object(i.useEffect)((()=>{l&&!b&&t.replace(Object(h.j)(u))}),[b,t,l,u]);const y=Object(i.useCallback)((()=>FL.a.getInstance(a)),[a]),E=Object(i.useCallback)((()=>LL.a.getInstance(a)),[a]),v=Object(i.useCallback)((()=>BL.a.getInstance(a)),[a]),T=Object(i.useCallback)((()=>NL.a.getInstance(a)),[a]),k=Object(i.useMemo)((()=>{const e={...qL,layoutAboutMessage:(e,t)=>r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.trustedApps.list.about",defaultMessage:"There {count, plural, one {is} other {are}} {count} trusted {count, plural, =1 {application} other {applications}} associated with this policy. Click here to {link}",values:{count:e,link:t}})},t={...DL,layoutAboutMessage:(e,t)=>r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.eventFilters.list.about",defaultMessage:"There {count, plural, one {is} other {are}} {count} event {count, plural, =1 {filter} other {filters}} associated with this policy. Click here to {link}",values:{count:e,link:t}})},a={...PL,layoutAboutMessage:(e,t)=>r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.hostIsolationExceptions.list.about",defaultMessage:"There {count, plural, one {is} other {are}} {count} host isolation {count, plural, =1 {exception} other {exceptions}} associated with this policy. Click here to {link}",values:{count:e,link:t}})},n={...RL,layoutAboutMessage:(e,t)=>r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.blocklist.list.about",defaultMessage:"There {count, plural, one {is} other {are}} {count} {count, plural, =1 {blocklist} other {blocklist entries}} associated with this policy. Click here to {link}",values:{count:e,link:t}})};return{[_L.SETTINGS]:{id:_L.SETTINGS,name:F.i18n.translate("xpack.securitySolution.endpoint.policy.details.tabs.policyForm",{defaultMessage:"Policy settings"}),content:r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiSpacer,null),r.a.createElement(AL,null))},[_L.TRUSTED_APPS]:{id:_L.TRUSTED_APPS,name:F.i18n.translate("xpack.securitySolution.endpoint.policy.details.tabs.trustedApps",{defaultMessage:"Trusted applications"}),content:r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiSpacer,null),r.a.createElement(CL,{policyItem:p,labels:e,getExceptionsListApiClient:y,searchableFields:zL.a,getArtifactPath:h.o,getPolicyArtifactsPath:h.k}))},[_L.EVENT_FILTERS]:{id:_L.EVENT_FILTERS,name:F.i18n.translate("xpack.securitySolution.endpoint.policy.details.tabs.eventFilters",{defaultMessage:"Event filters"}),content:r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiSpacer,null),r.a.createElement(CL,{policyItem:p,labels:t,getExceptionsListApiClient:E,searchableFields:UL.d,getArtifactPath:h.f,getPolicyArtifactsPath:h.l}))},[_L.HOST_ISOLATION_EXCEPTIONS]:b?{id:_L.HOST_ISOLATION_EXCEPTIONS,name:F.i18n.translate("xpack.securitySolution.endpoint.policy.details.tabs.isInHostIsolationExceptions",{defaultMessage:"Host isolation exceptions"}),content:r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiSpacer,null),r.a.createElement(CL,{policyItem:p,labels:a,getExceptionsListApiClient:v,searchableFields:HL.b,getArtifactPath:h.g,getPolicyArtifactsPath:h.m,externalPrivileges:m.canIsolateHost}))}:void 0,[_L.BLOCKLISTS]:{id:_L.BLOCKLISTS,name:F.i18n.translate("xpack.securitySolution.endpoint.policy.details.tabs.blocklists",{defaultMessage:"Blocklist"}),content:r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiSpacer,null),r.a.createElement(CL,{policyItem:p,labels:n,getExceptionsListApiClient:T,searchableFields:$L.b,getArtifactPath:h.c,getPolicyArtifactsPath:h.i}))}}}),[b,E,v,T,y,p,m.canIsolateHost]),x=Object(i.useMemo)((()=>Object.values(k).filter((e=>void 0!==e))),[k]),S=Object(i.useMemo)((()=>{const e=k[_L.SETTINGS];let t;return n?t=k[_L.SETTINGS]:s?t=k[_L.TRUSTED_APPS]:o?t=k[_L.EVENT_FILTERS]:l?t=k[_L.HOST_ISOLATION_EXCEPTIONS]:c&&(t=k[_L.BLOCKLISTS]),t||e}),[k,n,s,o,l,c]),O=Object(i.useCallback)((e=>{let a="";switch(e.id){case _L.SETTINGS:a=Object(h.j)(u);break;case _L.TRUSTED_APPS:a=Object(h.n)(u);break;case _L.EVENT_FILTERS:a=Object(h.l)(u);break;case _L.HOST_ISOLATION_EXCEPTIONS:a=Object(h.m)(u);break;case _L.BLOCKLISTS:a=Object(h.i)(u)}t.push(a,null!=g&&g.backLink?{backLink:g.backLink}:null)}),[t,u,g]);return l&&(m.loading||f.isLoading)?r.a.createElement(tL.a,{"data-test-subj":"policyHostIsolationExceptionsTabLoading"}):r.a.createElement(N.EuiTabbedContent,{tabs:x,selectedTab:S,size:"l",onTabClick:O})}));VL.displayName="PolicyTabs";const QL=r.a.memo((()=>{var e,t,a,n,s,l;const c=Object(Z.a)("policyListEnabled"),{state:u={}}=Object(P.useLocation)(),{getAppUrl:p}=Object(d.d)(),m=Object(XF.c)(ZF.b),g=Object(XF.c)(ZF.l),f=Object(XF.c)(ZF.a),b=null!==(e=null==g?void 0:g.name)&&void 0!==e?e:"",y=null!==(t=null==g?void 0:g.description)&&void 0!==t?t:void 0,E=Object(i.useMemo)((()=>{if(null!=u&&u.backLink)return{onBackButtonNavigateTo:u.backLink.navigateTo,backButtonLabel:u.backLink.label,backButtonUrl:u.backLink.href};if(c){const e=Object(h.h)();return{backButtonLabel:F.i18n.translate("xpack.securitySolution.policyDetails.backToPolicyButton",{defaultMessage:"Back to policy list"}),backButtonUrl:p({path:e}),onBackButtonNavigateTo:[o.y,{path:e}]}}{const e=Object(h.e)({name:"endpointList"});return{backButtonLabel:F.i18n.translate("xpack.securitySolution.policyDetails.backToEndpointList",{defaultMessage:"View all endpoints"}),backButtonUrl:p({path:e}),onBackButtonNavigateTo:[o.y,{path:e}]}}}),[p,null==u?void 0:u.backLink,c]),v=r.a.createElement(eL,{total:null!==(a=null==f?void 0:f.total)&&void 0!==a?a:0,online:null!==(n=null==f?void 0:f.online)&&void 0!==n?n:0,offline:null!==(s=null==f?void 0:f.offline)&&void 0!==s?s:0,error:null!==(l=null==f?void 0:f.error)&&void 0!==l?l:0}),T=r.a.createElement(P_.a,rr()({},E,{"data-test-subj":"policyDetailsBackLink"})),k=Object(i.useMemo)((()=>m?r.a.createElement(N.EuiPageTemplate,{template:"centeredContent"},r.a.createElement(N.EuiCallOut,{color:"danger",title:null==m?void 0:m.error},r.a.createElement("span",{"data-test-subj":"policyDetailsIdNotFoundMessage"},null==m?void 0:m.message))):g?r.a.createElement(VL,null):r.a.createElement(N.EuiPageTemplate,{template:"centeredContent"},r.a.createElement(N.EuiLoadingSpinner,{className:"essentialAnimation",size:"xl","data-test-subj":"policyDetailsLoading"}))),[m,g]);return r.a.createElement(M_.a,{"data-test-subj":"policyDetailsPage",title:b,subtitle:y,headerBackComponent:T,actions:m?void 0:v,restrictWidth:!0,hasBottomBorder:!1},k)}));QL.displayName="PolicyDetails",a(617);const WL=Object(i.memo)((()=>{const e=Object(Z.a)("policyListEnabled");return r.a.createElement(P.Switch,null,r.a.createElement(R.Route,{path:[AR.n,AR.q,AR.m,AR.o,AR.l],exact:!0,component:QL}),r.a.createElement(R.Route,{path:AR.p,exact:!0,render:e=>r.a.createElement(P.Redirect,{to:Object(h.j)(e.match.params.policyId)})}),e&&r.a.createElement(R.Route,{path:AR.k,exact:!0,component:JF}),r.a.createElement(R.Route,{path:"*",component:_.a}))}));WL.displayName="PolicyContainer";var GL=a(488);const KL=[32,40,64],YL=/[^0-9a-f]/i,JL=e=>KL.includes(e.length)&&!YL.test(e),XL=e=>e.field!==aI.a.SIGNER,ZL=(F.i18n.translate("xpack.securitySolution.trustedapps.aboutInfo",{defaultMessage:"Add a trusted application to improve performance or alleviate conflicts with other applications running on your hosts."}),F.i18n.translate("xpack.securitySolution.trustedApps.name.label",{defaultMessage:"Name"})),eN=F.i18n.translate("xpack.securitySolution.trustedApps.details.header",{defaultMessage:"Details"}),tN=F.i18n.translate("xpack.securitySolution.trustedApps.details.header.description",{defaultMessage:"Trusted applications improve performance or alleviate conflicts with other applications running on your hosts."}),aN=F.i18n.translate("xpack.securitySolution.trustedapps.create.description",{defaultMessage:"Description"}),nN=F.i18n.translate("xpack.securitySolution.trustedApps.conditions.header",{defaultMessage:"Conditions"}),iN=F.i18n.translate("xpack.securitySolution.trustedApps.conditions.header.description",{defaultMessage:"Select an operating system and add conditions. Availability of conditions may depend on your chosen OS."}),rN=F.i18n.translate("xpack.securitySolution.trustedApps.os.label",{defaultMessage:"Select operating system"}),sN={[aI.a.HASH]:F.i18n.translate("xpack.securitySolution.trustedapps.logicalConditionBuilder.entry.field.hash",{defaultMessage:"Hash"}),[aI.a.PATH]:F.i18n.translate("xpack.securitySolution.trustedapps.logicalConditionBuilder.entry.field.path",{defaultMessage:"Path"}),[aI.a.SIGNER]:F.i18n.translate("xpack.securitySolution.trustedapps.logicalConditionBuilder.entry.field.signature",{defaultMessage:"Signature"})},oN={[aI.a.HASH]:F.i18n.translate("xpack.securitySolution.trustedapps.logicalConditionBuilder.entry.field.description.hash",{defaultMessage:"md5, sha1, or sha256"}),[aI.a.PATH]:F.i18n.translate("xpack.securitySolution.trustedapps.logicalConditionBuilder.entry.field.description.path",{defaultMessage:"The full path of the application"}),[aI.a.SIGNER]:F.i18n.translate("xpack.securitySolution.trustedapps.logicalConditionBuilder.entry.field.description.signature",{defaultMessage:"The signer of the application"})},lN={is:F.i18n.translate("xpack.securitySolution.trustedapps.card.operator.is",{defaultMessage:"is"}),matches:F.i18n.translate("xpack.securitySolution.trustedapps.card.operator.matches",{defaultMessage:"matches"})},cN={field:F.i18n.translate("xpack.securitySolution.trustedapps.trustedapp.entry.field",{defaultMessage:"Field"}),operator:F.i18n.translate("xpack.securitySolution.trustedapps.trustedapp.entry.operator",{defaultMessage:"Operator"}),value:F.i18n.translate("xpack.securitySolution.trustedapps.trustedapp.entry.value",{defaultMessage:"Value"})},uN=F.i18n.translate("xpack.securitySolution.trustedApps.assignmentSectionDescription",{defaultMessage:"Assign this trusted application globally across all policies, or assign it to specific policies."}),dN={name:F.i18n.translate("xpack.securitySolution.trustedapps.create.nameRequiredMsg",{defaultMessage:"Name is required"}),os:F.i18n.translate("xpack.securitySolution.trustedapps.create.osRequiredMsg",{defaultMessage:"Operating System is required"}),field:F.i18n.translate("xpack.securitySolution.trustedapps.create.conditionRequiredMsg",{defaultMessage:"At least one Field definition is required"}),noDuplicateField:e=>F.i18n.translate("xpack.securitySolution.trustedapps.create.conditionFieldDuplicatedMsg",{defaultMessage:"{field} cannot be added more than once",values:{field:sN[e]}}),mustHaveValue:e=>F.i18n.translate("xpack.securitySolution.trustedapps.create.conditionFieldValueRequiredMsg",{defaultMessage:"[{row}] Field entry must have a value",values:{row:e+1}}),invalidHash:e=>F.i18n.translate("xpack.securitySolution.trustedapps.create.conditionFieldInvalidHashMsg",{defaultMessage:"[{row}] Invalid hash value",values:{row:e+1}}),pathWarning:e=>F.i18n.translate("xpack.securitySolution.trustedapps.create.conditionFieldInvalidPathMsg",{defaultMessage:"[{row}] Path may be formed incorrectly; verify value",values:{row:e+1}}),wildcardPathWarning:e=>F.i18n.translate("xpack.securitySolution.trustedapps.create.conditionFieldDegradedPerformanceMsg",{defaultMessage:"[{row}] A wildcard in the filename will affect the endpoint's performance",values:{row:e+1}})};var pN=a(315);const mN=({os:e,field:t,type:a})=>{if(t===aI.a.PATH)return e===aI.c.WINDOWS?"wildcard"===a?"C:\\sample\\*\\path.exe":"C:\\sample\\path.exe":"wildcard"===a?"/opt/*/app":"/opt/bin"},gN=Object(i.memo)((({showLabel:e,label:t="",children:a})=>e?r.a.createElement(N.EuiFormRow,{label:t,fullWidth:!0},a):r.a.createElement(r.a.Fragment,null,a)));gN.displayName="ConditionEntryCell";const fN=z.a.div.withConfig({displayName:"InputGroup",componentId:"sc-1yk4mi3-0"})(["display:grid;grid-template-columns:25% 25% 45% 5%;grid-template-areas:'field operator value remove';"]),bN=z.a.div.withConfig({displayName:"InputItem",componentId:"sc-1yk4mi3-1"})(["grid-area:",";align-self:center;margin:4px;vertical-align:baseline;"],(({gridArea:e})=>e)),hN=Object.keys($R.e).map((e=>({dropdownDisplay:lN[e],inputDisplay:lN[e],value:"matches"===e?"wildcard":"match"}))),yN=Object(i.memo)((({os:e,entry:t,showLabels:a=!1,onRemove:n,onChange:s,isRemoveDisabled:o=!1,onVisited:l,"data-test-subj":c})=>{const u=Object(mL.a)(c),[d,p]=Object(i.useState)(!1),m=Object(i.useMemo)((()=>{const t=e=>r.a.createElement(r.a.Fragment,null,sN[e],r.a.createElement(N.EuiText,{size:"xs",color:"subdued"},oN[e]));return[{dropdownDisplay:t(aI.a.HASH),inputDisplay:sN[aI.a.HASH],value:aI.a.HASH},{dropdownDisplay:t(aI.a.PATH),inputDisplay:sN[aI.a.PATH],value:aI.a.PATH},...e===aI.c.WINDOWS?[{dropdownDisplay:t(aI.a.SIGNER),inputDisplay:sN[aI.a.SIGNER],value:aI.a.SIGNER}]:[]]}),[e]),g=Object(i.useCallback)((e=>s({...t,value:e.target.value},t)),[t,s]),f=Object(i.useCallback)((e=>s({...t,field:e},t)),[t,s]),b=Object(i.useCallback)((e=>s({...t,type:e},t)),[t,s]),h=Object(i.useCallback)((()=>n(t)),[t,n]),y=Object(i.useCallback)((()=>{l&&l(t),d||p(!0)}),[t,l,d]);return r.a.createElement(fN,{"data-test-subj":c},r.a.createElement(bN,{gridArea:"field"},r.a.createElement(gN,{showLabel:a,label:cN.field},r.a.createElement(N.EuiSuperSelect,{options:m,valueOfSelected:t.field,onChange:f,"data-test-subj":u("field")}))),r.a.createElement(bN,{gridArea:"operator"},r.a.createElement(gN,{showLabel:a,label:cN.operator},t.field===aI.a.PATH?r.a.createElement(N.EuiSuperSelect,{options:hN,onChange:b,valueOfSelected:t.type,"data-test-subj":u("operator")}):r.a.createElement(N.EuiFieldText,{name:"operator",value:lN.is,"data-test-subj":u("operator"),readOnly:!0}))),r.a.createElement(bN,{gridArea:"value"},r.a.createElement(gN,{showLabel:a,label:cN.value},r.a.createElement(N.EuiFieldText,{name:"value",value:t.value,placeholder:mN({os:e,field:t.field,type:t.type}),fullWidth:!0,required:d,onChange:g,onBlur:y,"data-test-subj":u("value")}))),r.a.createElement(bN,{gridArea:"remove"},r.a.createElement(gN,{showLabel:a,label:"Â "},r.a.createElement(N.EuiButtonIcon,{color:"danger",iconType:"trash",onClick:h,isDisabled:o,"aria-label":F.i18n.translate("xpack.securitySolution.trustedapps.logicalConditionBuilder.entry.removeLabel",{defaultMessage:"Remove Entry"}),"data-test-subj":u("remove")}))))}));yN.displayName="ConditionEntryInput";const EN=z()(N.EuiFlexGroup).withConfig({displayName:"ConditionGroupFlexGroup",componentId:"sc-7xprc5-0"})([".and-badge{padding-top:20px;padding-bottom:",";}.group-entries{margin-bottom:",";& > *{margin-bottom:",";&:last-child{margin-bottom:0;}}}.and-button{min-width:95px;}"],(({theme:e})=>`calc(${e.eui.euiButtonHeightSmall} + (${e.eui.paddingSizes.s} * 2) + 3px);`),(({theme:e})=>e.eui.paddingSizes.s),(({theme:e})=>e.eui.paddingSizes.s)),vN=Object(i.memo)((({os:e,entries:t,onEntryRemove:a,onEntryChange:n,onAndClicked:i,isAndDisabled:s,onVisited:o,"data-test-subj":l})=>{const c=Object(mL.a)(l);return r.a.createElement(EN,{gutterSize:"xs","data-test-subj":l},t.length>1&&r.a.createElement(N.EuiHideFor,{sizes:["xs","s"]},r.a.createElement(N.EuiFlexItem,{grow:!1,"data-test-subj":c("andConnector"),className:"and-badge"},r.a.createElement(HI.a,{type:"and",includeAntennas:!0}))),r.a.createElement(N.EuiFlexItem,{grow:1},r.a.createElement("div",{"data-test-subj":c("entries"),className:"group-entries"},t.map(((i,s)=>r.a.createElement(yN,{key:s,os:e,entry:i,showLabels:0===s,isRemoveDisabled:0===s&&t.length<=1,onRemove:a,onChange:n,onVisited:o,"data-test-subj":c(`entry${s}`)})))),r.a.createElement("div",null,r.a.createElement(N.EuiSpacer,{size:"s"}),r.a.createElement(N.EuiButton,{size:"s",iconType:"plusInCircle",onClick:i,"data-test-subj":c("AndButton"),isDisabled:s,className:"and-button"},r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.trustedapps.logicalConditionBuilder.group.andOperator",defaultMessage:"AND"})))))}));vN.displayName="ConditionGroup";const TN=Object(i.memo)((({entries:e,os:t,className:a,isAndDisabled:n=!1,onAndClicked:i,onEntryRemove:s,onEntryChange:o,onVisited:l,"data-test-subj":c})=>{const u=Object(mL.a)(c);return r.a.createElement("div",{"data-test-subj":c,className:a},r.a.createElement("div",null,0===e.length?r.a.createElement(kN,null):r.a.createElement(vN,{os:t,entries:e,onEntryRemove:s,onEntryChange:o,onAndClicked:i,isAndDisabled:n,onVisited:l,"data-test-subj":u("group1")})))}));TN.displayName="LogicalConditionBuilder";const kN=Object(i.memo)((()=>r.a.createElement(N.EuiPanel,{paddingSize:"l"},r.a.createElement(N.EuiText,{textAlign:"center",size:"s",color:"subdued"},r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.trustedapps.logicalConditionBuilder.noEntries",defaultMessage:"No conditions defined"})))));kN.displayName="NoEntries";var xN=a(76),SN=a(497);const ON=(e,t,a,n)=>{e.result[t]||(e.result[t]={isInvalid:!1,errors:[],warnings:[]});const i="warnings"===a?r.a.createElement("div",null,n):n;e.result[t][a].push(i),e.result[t].isInvalid=!0},wN=e=>{var t,a;let n=!0;const i={isValid:n,result:{}};e.name.trim()||(n=!1,ON(i,"name","errors",dN.name)),e.os_types||(n=!1,ON(i,"os","errors",dN.os));const r=null!==(t=(null!==(a=e.os_types)&&void 0!==a?a:[])[0])&&void 0!==t?t:aI.c.WINDOWS;if(e.entries.length){const t=(e=>{const t=new Map;return e.forEach((e=>{const a=e.field.startsWith("process.hash")?aI.a.HASH:e.field;t.set(a,[...t.get(a)||[],e])})),[...t.entries()].filter((e=>e[1].length>1)).map((e=>e[0]))})(e.entries);t.length&&(n=!1,t.forEach((e=>{ON(i,"entries","errors",dN.noDuplicateField(e))}))),e.entries.forEach(((e,t)=>{const a=Object(aI.f)({os:r,field:e.field,type:e.type,value:e.value});e.field&&e.value.trim()?e.field!==aI.a.HASH||JL(e.value)?a?a&&!Object(aI.e)({os:r,value:e.value,type:e.type})&&ON(i,"entries","warnings",dN.wildcardPathWarning(t)):ON(i,"entries","warnings",dN.pathWarning(t)):(n=!1,ON(i,"entries","errors",dN.invalidHash(t))):(n=!1,ON(i,"entries","errors",dN.mustHaveValue(t)))}))}else n=!1,ON(i,"entries","errors",dN.field);return i.isValid=n,i},jN=()=>({field:aI.a.HASH,operator:"included",type:"match",value:""}),CN=Object(i.memo)((({item:e,policies:t,policiesIsLoading:a,onChange:n,mode:s})=>{var o,l,c,u,d,p,m;const g=Object(mL.a)("trustedApps-form"),[f,b]=Object(i.useState)({}),[h,y]=Object(i.useState)([]),E=Object(xN.b)().isPlatinumPlus(),v=Object(i.useMemo)((()=>Object(_F.e)(e)),[e]),[T,k]=Object(i.useState)(!Object(yL.d)(e.tags)),[x,S]=Object(i.useState)(!1);Object(i.useEffect)((()=>{!x&&e.tags&&k(!Object(yL.d)(e.tags))}),[e.tags,x]),Object(i.useEffect)((()=>{if(x)return;const a=e.tags?Object(_F.c)({tags:e.tags}):[];if(!a.length)return;const n=t.filter((e=>a.includes(e.id)));y(n)}),[x,e,t]);const O=Object(i.useMemo)((()=>E||"edit"===s&&(!v||T&&v&&x)),[s,v,x,E,T]),[w,j]=Object(i.useState)((()=>wN(e))),C=Object(i.useCallback)((e=>{const t=wN(e);j(t),n({item:e,isValid:t.isValid})}),[n]),I=Object(i.useCallback)((t=>{const a=t.isGlobal?[ki.d]:t.selected.map((e=>`${ki.b}${e.id}`)),n={...e,tags:a};t.isGlobal||y(t.selected),C(n),S(!0)}),[e,C]),M=Object(i.useCallback)((t=>{const a={...e,[t.target.name]:t.target.value};C(a),S(!0)}),[e,C]),A=Object(i.useCallback)((({target:{name:t}})=>{C(e),b((e=>({...e,[t]:!0})))}),[e,C]),D=Object(i.useMemo)((()=>[aI.c.LINUX,aI.c.MAC,aI.c.WINDOWS].map((e=>({value:e,inputDisplay:pN.c[e]})))),[]),q=Object(i.useCallback)((t=>{b((e=>({...e,os:!0})));const a={...e,os_types:[t],entries:[]};if(t!==aI.c.WINDOWS){const t=e.entries.filter((e=>XL(e)));a.entries.push(...t),0===e.entries.length&&a.entries.push(jN())}else a.entries.push(...e.entries);C(a),S(!0)}),[e,C]),P=Object(i.useCallback)((()=>{b((e=>({...e,entries:!0})))}),[]),R=Object(i.useCallback)(((t,a)=>{const n={...e,entries:e.entries.map((e=>e===a?t:e))};C(n),S(!0)}),[e,C]),_=Object(i.useCallback)((t=>{const a={...e,entries:e.entries.filter((e=>e!==t))};C(a),S(!0)}),[e,C]),F=Object(i.useCallback)((()=>{var t,a;const n={...e,entries:[]};(null!==(t=(null!==(a=e.os_types)&&void 0!==a?a:[])[0])&&void 0!==t?t:aI.c.WINDOWS)===aI.c.WINDOWS?n.entries=[...e.entries,jN()].filter((e=>e.field===aI.a.SIGNER||!0)):n.entries=[...e.entries.filter((e=>XL(e))),jN()],C(n),S(!0)}),[e,C]),L=Object(i.useMemo)((()=>{var t;return null!=e&&null!==(t=e.os_types)&&void 0!==t&&t.length?e.os_types[0]:aI.c.WINDOWS}),[null==e?void 0:e.os_types]),B=Object(i.useMemo)((()=>{const t=e;return t.entries=e.entries.length?e.entries:[jN()],t}),[e]);return r.a.createElement(N.EuiForm,{component:"div","data-test-subj":g("")},r.a.createElement(N.EuiTitle,{size:"xs"},r.a.createElement("h3",null,eN)),r.a.createElement(N.EuiSpacer,{size:"xs"}),"create"===s&&r.a.createElement(N.EuiText,{size:"s","data-test-subj":g("about")},r.a.createElement("p",null,tN)),r.a.createElement(N.EuiSpacer,{size:"m"}),r.a.createElement(N.EuiFormRow,{label:ZL,fullWidth:!0,"data-test-subj":g("nameRow"),isInvalid:f.name&&(null===(o=w.result.name)||void 0===o?void 0:o.isInvalid),error:null===(l=w.result.name)||void 0===l?void 0:l.errors},r.a.createElement(N.EuiFieldText,{name:"name",value:e.name,onChange:M,onBlur:A,fullWidth:!0,required:f.name,maxLength:256,"data-test-subj":g("nameTextField")})),r.a.createElement(N.EuiFormRow,{label:aN,fullWidth:!0,"data-test-subj":g("descriptionRow")},r.a.createElement(N.EuiTextArea,{name:"description",value:e.description,onChange:M,fullWidth:!0,compressed:!0,maxLength:256,"data-test-subj":g("descriptionField")})),r.a.createElement(N.EuiHorizontalRule,null),r.a.createElement(N.EuiText,{size:"xs"},r.a.createElement("h3",null,nN)),r.a.createElement(N.EuiSpacer,{size:"xs"}),r.a.createElement(N.EuiText,{size:"s"},iN),r.a.createElement(N.EuiSpacer,{size:"m"}),r.a.createElement(N.EuiFormRow,{label:rN,fullWidth:!0,"data-test-subj":g("OsRow"),isInvalid:(null==f?void 0:f.os)&&(null===(c=w.result.os)||void 0===c?void 0:c.isInvalid),error:null===(u=w.result.os)||void 0===u?void 0:u.errors},r.a.createElement(N.EuiSuperSelect,{name:"os",options:D,valueOfSelected:L,onChange:q,fullWidth:!0,"data-test-subj":g("osSelectField")})),r.a.createElement(N.EuiFormRow,{fullWidth:!0,"data-test-subj":g("conditionsRow"),isInvalid:f.entries&&(null===(d=w.result.entries)||void 0===d?void 0:d.isInvalid),error:null===(p=w.result.entries)||void 0===p?void 0:p.errors,helpText:null===(m=w.result.entries)||void 0===m?void 0:m.warnings},r.a.createElement(TN,{entries:B.entries,os:L,onAndClicked:F,onEntryRemove:_,onEntryChange:R,onVisited:P,"data-test-subj":g("conditionsBuilder")})),O?r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiHorizontalRule,null),r.a.createElement(N.EuiFormRow,{fullWidth:!0,"data-test-subj":g("policySelection")},r.a.createElement(SN.a,{isGlobal:v,isPlatinumPlus:E,selected:h,options:t,onChange:I,isLoading:a,description:uN,"data-test-subj":g("effectedPolicies")}))):null)}));CN.displayName="TrustedAppsForm";const IN={pageTitle:F.i18n.translate("xpack.securitySolution.trustedApps.pageTitle",{defaultMessage:"Trusted applications"}),pageAboutInfo:F.i18n.translate("xpack.securitySolution.trustedApps.pageAboutInfo",{defaultMessage:"Trusted applications improve performance or alleviate conflicts with other applications running on your hosts."}),pageAddButtonTitle:F.i18n.translate("xpack.securitySolution.trustedApps.pageAddButtonTitle",{defaultMessage:"Add trusted application"}),getShowingCountLabel:e=>F.i18n.translate("xpack.securitySolution.trustedApps.showingTotal",{defaultMessage:"Showing {total} {total, plural, one {trusted application} other {trusted applications}}",values:{total:e}}),cardActionEditLabel:F.i18n.translate("xpack.securitySolution.trustedApps.cardActionEditLabel",{defaultMessage:"Edit trusted application"}),cardActionDeleteLabel:F.i18n.translate("xpack.securitySolution.trustedApps.cardActionDeleteLabel",{defaultMessage:"Delete trusted application"}),flyoutCreateTitle:F.i18n.translate("xpack.securitySolution.trustedApps.flyoutCreateTitle",{defaultMessage:"Add trusted application"}),flyoutEditTitle:F.i18n.translate("xpack.securitySolution.trustedApps.flyoutEditTitle",{defaultMessage:"Edit trusted application"}),flyoutCreateSubmitButtonLabel:F.i18n.translate("xpack.securitySolution.trustedApps.flyoutCreateSubmitButtonLabel",{defaultMessage:"Add trusted application"}),flyoutCreateSubmitSuccess:({name:e})=>F.i18n.translate("xpack.securitySolution.trustedApps.flyoutCreateSubmitSuccess",{defaultMessage:'"{name}" has been added to your trusted applications.',values:{name:e}}),flyoutEditSubmitSuccess:({name:e})=>F.i18n.translate("xpack.securitySolution.trustedApps.flyoutEditSubmitSuccess",{defaultMessage:'"{name}" has been updated.',values:{name:e}}),flyoutDowngradedLicenseDocsInfo:e=>r.a.createElement(r.a.Fragment,null,r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.trustedApps.flyoutDowngradedLicenseDocsInfo",defaultMessage:"For more information, see our "}),r.a.createElement(N.EuiLink,{target:"_blank",href:`${e.trustedApps}`},r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.trustedApps.flyoutDowngradedLicenseDocsLink",defaultMessage:"Trusted applications documentation"}))),deleteActionSuccess:e=>F.i18n.translate("xpack.securitySolution.trustedApps.deleteSuccess",{defaultMessage:'"{itemName}" has been removed from trusted applications.',values:{itemName:e}}),emptyStateTitle:F.i18n.translate("xpack.securitySolution.trustedApps.emptyStateTitle",{defaultMessage:"Add your first trusted application"}),emptyStateInfo:F.i18n.translate("xpack.securitySolution.trustedApps.emptyStateInfo",{defaultMessage:"Add a trusted application to improve performance or alleviate conflicts with other applications running on your hosts."}),emptyStatePrimaryButtonLabel:F.i18n.translate("xpack.securitySolution.trustedApps.emptyStatePrimaryButtonLabel",{defaultMessage:"Add trusted application"}),searchPlaceholderInfo:F.i18n.translate("xpack.securitySolution.trustedApps.searchPlaceholderInfo",{defaultMessage:"Search on the fields below: name, description, value"})},MN=Object(i.memo)((()=>{const e=Object(d.i)(),t=FL.a.getInstance(e);return r.a.createElement(GL.a,{apiClient:t,ArtifactFormComponent:CN,labels:IN,"data-test-subj":"trustedAppsListPage",searchableFields:zL.a})}));MN.displayName="TrustedAppsList";const AN=Object(i.memo)((()=>r.a.createElement(P.Switch,null,r.a.createElement(R.Route,{path:AR.r,exact:!0,component:MN}),r.a.createElement(R.Route,{path:"*",component:_.a}))));AN.displayName="TrustedAppsContainer";var DN=a(745);const qN=()=>r.a.createElement(P.Switch,null,r.a.createElement(R.Route,{path:AR.i,exact:!0,component:DN.c}),r.a.createElement(R.Route,{path:"*",component:_.a}));var PN=a(1332),RN=a.n(PN);const _N=F.i18n.translate("xpack.securitySolution.hostIsolationExceptions.form.name.placeholder",{defaultMessage:"Host isolation exception name"}),FN=F.i18n.translate("xpack.securitySolution.hostIsolationExceptions.form.name.label",{defaultMessage:"Name your host isolation exceptions"}),LN=F.i18n.translate("xpack.securitySolution.hostIsolationExceptions.form.name.error",{defaultMessage:"The name can't be empty"}),NN=F.i18n.translate("xpack.securitySolution.hostIsolationExceptions.form.description.placeholder",{defaultMessage:"Describe your host isolation exception"}),BN=F.i18n.translate("xpack.securitySolution.hostIsolationExceptions.form.description.label",{defaultMessage:"Description"}),zN=F.i18n.translate("xpack.securitySolution.hostIsolationExceptions.form.ip.placeholder",{defaultMessage:"Ex 0.0.0.0/24"}),UN=F.i18n.translate("xpack.securitySolution.hostIsolationExceptions.form.ip.label",{defaultMessage:"Enter IP Address"}),HN=F.i18n.translate("xpack.securitySolution.hostIsolationExceptions.form.ip.error",{defaultMessage:"The IP is invalid. Only IPv4 with optional CIDR is supported"});F.i18n.translate("xpack.securitySolution.hostIsolationExceptions.list.action.delete",{defaultMessage:"Delete Exception"}),F.i18n.translate("xpack.securitySolution.hostIsolationExceptions.list.action.edit",{defaultMessage:"Edit Exception"});var $N=a(855);const VN=Object(i.memo)((({item:e,onChange:t,policies:a,disabled:n,mode:s,error:o})=>{var l;const c=Object(i.useMemo)((()=>e.entries[0]||{field:"destination.ip",operator:"included",type:"match",value:""}),[e.entries]),[u,d]=Object(i.useState)(!1),[p,m]=Object(i.useState)(!1),[g,f]=Object(i.useState)(!e.name),[b,h]=Object(i.useState)(!c.value),[y,E]=Object(i.useState)({isGlobal:Object(yL.d)(e.tags),selected:[]}),v=Object(i.useMemo)((()=>!g&&!b),[b,g]),T=Object(i.useCallback)((a=>{t({item:a?{...e,...a}:e,isValid:v})}),[e,v,t]),k=Object(i.useCallback)((e=>{const t=e.target.value;t.trim()?f(!1):f(!0),T({name:t})}),[T]),x=Object(i.useCallback)((e=>{const t=e.target.value;!function(e){if(/^([0-9]{1,3}\.){3}[0-9]{1,3}(\/([0-9]|[1-2][0-9]|3[0-2]))?$/.test(e))try{return RN.a.IPv4.parseCIDR(e),!0}catch(t){return RN.a.IPv4.isValid(e)}return!1}(t)?h(!0):h(!1),T({entries:[{...c,value:t}]})}),[c,T]),S=Object(i.useCallback)((t=>{t.isGlobal?E({isGlobal:!0,selected:t.selected}):E(t),T({tags:Object(yL.a)(t,Object(yL.b)(e.tags))})}),[e.tags,T]),O=Object(i.useCallback)((e=>{T({description:e.target.value})}),[T]),w=Object(i.useMemo)((()=>{var t;return r.a.createElement(N.EuiFormRow,{label:FN,fullWidth:!0,isInvalid:g&&u,error:LN,isDisabled:n,"data-test-subj":"hostIsolationExceptions-form-name-input-formRow"},r.a.createElement(N.EuiFieldText,{id:"eventFiltersFormInputName",placeholder:_N,defaultValue:null!==(t=e.name)&&void 0!==t?t:"",onChange:k,fullWidth:!0,"aria-label":_N,required:u,maxLength:256,"data-test-subj":"hostIsolationExceptions-form-name-input",onBlur:()=>!u&&d(!0),disabled:n}))}),[n,e.name,k,u,g]),j=Object(i.useMemo)((()=>{var t,a,i;return r.a.createElement(N.EuiFormRow,{label:UN,fullWidth:!0,isInvalid:b&&p,error:HN,isDisabled:n,"data-test-subj":"hostIsolationExceptions-form-ip-input-formRow"},r.a.createElement(N.EuiFieldText,{id:"eventFiltersFormInputName",placeholder:zN,defaultValue:null!==(t=null===(a=e.entries)||void 0===a||null===(i=a[0])||void 0===i?void 0:i.value)&&void 0!==t?t:"",onChange:x,fullWidth:!0,"aria-label":zN,required:p,maxLength:256,"data-test-subj":"hostIsolationExceptions-form-ip-input",onBlur:()=>!p&&m(!0),disabled:n}))}),[n,e.entries,x,p,b]),C=Object(i.useMemo)((()=>{var t;return r.a.createElement(N.EuiFormRow,{label:BN,fullWidth:!0,isDisabled:n,"data-test-subj":"hostIsolationExceptions-form-description-input-formRow"},r.a.createElement(N.EuiTextArea,{id:"eventFiltersFormInputName",placeholder:NN,defaultValue:null!==(t=e.description)&&void 0!==t?t:"",onChange:O,fullWidth:!0,"data-test-subj":"hostIsolationExceptions-form-description-input","aria-label":NN,maxLength:256,disabled:n}))}),[n,e.description,O]);return Object(i.useEffect)((()=>{0===y.selected.length&&e.tags&&E(Object(yL.c)(e.tags,a))}),[e.tags,a,y.selected.length]),Object(i.useEffect)((()=>{T()}),[T]),Object(i.useEffect)((()=>{var t,a;"create"===s&&3!==(null!==(t=null===(a=e.os_types)||void 0===a?void 0:a.length)&&void 0!==t?t:0)&&T({os_types:["windows","linux","macos"]})}),[null===(l=e.os_types)||void 0===l?void 0:l.length,s,T]),r.a.createElement(N.EuiForm,{component:"div",error:o&&r.a.createElement($N.a,{error:o}),isInvalid:!!o,"data-test-subj":"hostIsolationExceptions-form"},r.a.createElement(N.EuiTitle,{size:"xs"},r.a.createElement("h2",null,r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.hostIsolationExceptions.form.title",defaultMessage:"Details"}))),r.a.createElement(N.EuiText,{size:"s"},r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.hostIsolationExceptions.form.description",defaultMessage:"Allows isolated hosts to connect to these IP addresses. Only accepts IPv4 with optional CIDR."})),r.a.createElement(N.EuiSpacer,{size:"m"}),w,C,r.a.createElement(N.EuiSpacer,{size:"m"}),r.a.createElement(N.EuiHorizontalRule,null),r.a.createElement(N.EuiTitle,{size:"xs"},r.a.createElement("h2",null,r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.hostIsolationExceptions.form.conditions.title",defaultMessage:"Conditions"}))),r.a.createElement(N.EuiText,{size:"s"},r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.hostIsolationExceptions.form.conditions.subtitle",defaultMessage:"Host Isolation exceptions will apply to all operating systems."})),r.a.createElement(N.EuiSpacer,{size:"m"}),j,r.a.createElement(N.EuiHorizontalRule,null),r.a.createElement(N.EuiFormRow,{fullWidth:!0,"data-test-subj":"effectedPolicies-container",isDisabled:n},r.a.createElement(SN.a,{isGlobal:y.isGlobal,isPlatinumPlus:!0,selected:y.selected,options:a,onChange:S,"data-test-subj":"effectedPolicies-select",disabled:n})))}));VN.displayName="HostIsolationExceptionsForm";const QN=Object.freeze({pageTitle:F.i18n.translate("xpack.securitySolution.hostIsolationExceptions.pageTitle",{defaultMessage:"Host isolation exceptions"}),pageAboutInfo:F.i18n.translate("xpack.securitySolution.hostIsolationExceptions.pageAboutInfo",{defaultMessage:"Add a host isolation exception to allow isolated hosts to communicate with specific IPs."}),pageAddButtonTitle:F.i18n.translate("xpack.securitySolution.hostIsolationExceptions.pageAddButtonTitle",{defaultMessage:"Add host isolation exception"}),getShowingCountLabel:e=>F.i18n.translate("xpack.securitySolution.hostIsolationExceptions.showingTotal",{defaultMessage:"Showing {total} {total, plural, one {host isolation exception} other {host isolation exceptions}}",values:{total:e}}),cardActionEditLabel:F.i18n.translate("xpack.securitySolution.hostIsolationExceptions.cardActionEditLabel",{defaultMessage:"Edit exception"}),cardActionDeleteLabel:F.i18n.translate("xpack.securitySolution.hostIsolationExceptions.cardActionDeleteLabel",{defaultMessage:"Delete exception"}),flyoutCreateTitle:F.i18n.translate("xpack.securitySolution.hostIsolationExceptions.flyoutCreateTitle",{defaultMessage:"Add host isolation exception"}),flyoutEditTitle:F.i18n.translate("xpack.securitySolution.hostIsolationExceptions.flyoutEditTitle",{defaultMessage:"Edit host isolation exception"}),flyoutCreateSubmitButtonLabel:F.i18n.translate("xpack.securitySolution.hostIsolationExceptions.flyoutCreateSubmitButtonLabel",{defaultMessage:"Add host isolation exception"}),flyoutCreateSubmitSuccess:({name:e})=>F.i18n.translate("xpack.securitySolution.hostIsolationExceptions.flyoutCreateSubmitSuccess",{defaultMessage:'"{name}" has been added to your host isolation exception list.',values:{name:e}}),flyoutEditSubmitSuccess:({name:e})=>F.i18n.translate("xpack.securitySolution.hostIsolationExceptions.flyoutEditSubmitSuccess",{defaultMessage:'"{name}" has been updated.',values:{name:e}}),flyoutDowngradedLicenseDocsInfo:()=>null,deleteModalTitle:()=>F.i18n.translate("xpack.securitySolution.hostIsolationExceptions.deleteModtalTitle",{defaultMessage:"Delete host isolation exception"}),deleteActionSuccess:e=>F.i18n.translate("xpack.securitySolution.hostIsolationExceptions.deleteSuccess",{defaultMessage:'"{itemName}" has been removed from host isolation exception list.',values:{itemName:e}}),emptyStateTitle:F.i18n.translate("xpack.securitySolution.hostIsolationExceptions.emptyStateTitle",{defaultMessage:"Add your first host isolation exception"}),emptyStateInfo:F.i18n.translate("xpack.securitySolution.hostIsolationExceptions.emptyStateInfo",{defaultMessage:"Add a host isolation exception to allow isolated hosts to communicate with specific IPs."}),emptyStatePrimaryButtonLabel:F.i18n.translate("xpack.securitySolution.hostIsolationExceptions.emptyStatePrimaryButtonLabel",{defaultMessage:"Add host isolation exception"}),searchPlaceholderInfo:F.i18n.translate("xpack.securitySolution.hostIsolationExceptions.searchPlaceholderInfo",{defaultMessage:"Search on the fields below: name, description, IP"})}),WN=Object(i.memo)((()=>{const e=Object(d.i)(),t=BL.a.getInstance(e),a=Object(nt.a)().endpointPrivileges.canIsolateHost;return r.a.createElement(GL.a,{apiClient:t,ArtifactFormComponent:VN,labels:QN,"data-test-subj":"hostIsolationExceptionsListPage",searchableFields:HL.b,allowCardCreateAction:a,allowCardEditAction:a})}));WN.displayName="HostIsolationExceptionsList";const GN=Object(i.memo)((()=>r.a.createElement(P.Switch,null,r.a.createElement(R.Route,{path:AR.j,exact:!0,component:WN}),r.a.createElement(R.Route,{path:"*",component:_.a}))));GN.displayName="HostIsolationExceptionsContainer";var KN=a(485);const YN=F.i18n.translate("xpack.securitySolution.blocklist.details.header",{defaultMessage:"Details"}),JN=F.i18n.translate("xpack.securitySolution.blocklist.details.header.description",{defaultMessage:"The blocklist prevents selected applications from running on your hosts by extending the list of processes the Endpoint considers malicious."}),XN=F.i18n.translate("xpack.securitySolution.blocklist.name.label",{defaultMessage:"Name"}),ZN=F.i18n.translate("xpack.securitySolution.blocklist.description.label",{defaultMessage:"Description"}),eB=F.i18n.translate("xpack.securitySolution.blocklist.conditions.header",{defaultMessage:"Conditions"}),tB=F.i18n.translate("xpack.securitySolution.blocklist.conditions.header.description",{defaultMessage:"Select an operating system and add conditions. Availability of conditions may depend on your chosen OS."}),aB=F.i18n.translate("xpack.securitySolution.blocklist.os.label",{defaultMessage:"Select operating system"}),nB=F.i18n.translate("xpack.securitySolution.blocklist.field.label",{defaultMessage:"Field"}),iB=F.i18n.translate("xpack.securitySolution.blocklist.operator.label",{defaultMessage:"Operator"}),rB=F.i18n.translate("xpack.securitySolution.blocklist.value.label",{defaultMessage:"Value"}),sB=F.i18n.translate("xpack.securitySolution.blocklist.value.label.helper",{defaultMessage:"Type or copy & paste one or multiple comma delimited values"}),oB={"file.hash.*":F.i18n.translate("xpack.securitySolution.blocklist.entry.field.hash",{defaultMessage:"Hash"}),"file.path":F.i18n.translate("xpack.securitySolution.blocklist.entry.field.path",{defaultMessage:"Path"}),"file.Ext.code_signature":F.i18n.translate("xpack.securitySolution.blocklist.entry.field.signature",{defaultMessage:"Signature"})},lB={"file.hash.*":F.i18n.translate("xpack.securitySolution.blocklist.entry.field.description.hash",{defaultMessage:"md5, sha1, or sha256"}),"file.path":F.i18n.translate("xpack.securitySolution.blocklist.entry.field.description.path",{defaultMessage:"The full path of the application"}),"file.Ext.code_signature":F.i18n.translate("xpack.securitySolution.blocklist.entry.field.description.signature",{defaultMessage:"The signer of the application"})},cB=F.i18n.translate("xpack.securitySolution.blocklist.policyAssignmentSectionDescription",{defaultMessage:"Assign this blocklist globally across all policies, or assign it to specific policies."}),uB={NAME_REQUIRED:F.i18n.translate("xpack.securitySolution.blocklist.errors.name.required",{defaultMessage:"Name is required"}),VALUE_REQUIRED:F.i18n.translate("xpack.securitySolution.blocklist.errors.values.required",{defaultMessage:"Field entry must have a value"}),INVALID_HASH:F.i18n.translate("xpack.securitySolution.blocklist.errors.values.invalidHash",{defaultMessage:"Invalid hash value"}),INVALID_PATH:F.i18n.translate("xpack.securitySolution.blocklist.warnings.values.invalidPath",{defaultMessage:"Path may be formed incorrectly; verify value"}),WILDCARD_PRESENT:F.i18n.translate("xpack.securitySolution.blocklist.warnings.values.wildcardPresent",{defaultMessage:"A wildcard in the filename will affect the endpoint's performance"}),DUPLICATE_VALUE:F.i18n.translate("xpack.securitySolution.blocklist.warnings.values.duplicateValue",{defaultMessage:"This value already exists"}),DUPLICATE_VALUES:F.i18n.translate("xpack.securitySolution.blocklist.warnings.values.duplicateValues",{defaultMessage:"One or more duplicate values removed"})};function dB(e){return r.a.createElement("div",null,e)}function pB(e){return r.a.createElement(r.a.Fragment,null,oB[e],r.a.createElement(N.EuiText,{size:"xs",color:"subdued"},lB[e]))}function mB(e){return!Object.values(e).some((e=>Object.keys(e).length))}const gB=Object(i.memo)((({item:e,policies:t,policiesIsLoading:a,onChange:n,mode:s})=>{const[o,l]=Object(i.useState)({name:!1,value:!1}),c=Object(i.useRef)({name:{},value:{}}),u=Object(i.useRef)({name:{},value:{}}),[d,p]=Object(i.useState)([]),m=Object(xN.b)().isPlatinumPlus(),g=Object(i.useMemo)((()=>Object(_F.e)(e)),[e]),[f,b]=Object(i.useState)(!Object(yL.d)(e.tags)),[h,y]=Object(i.useState)(!1),E=Object(i.useMemo)((()=>m||"edit"===s&&(!g||f&&g&&h)),[s,g,h,m,f]);Object(i.useEffect)((()=>{!h&&e.tags&&b(!Object(yL.d)(e.tags))}),[e.tags,h]),Object(i.useEffect)((()=>{var a,n;if(h)return;const i=null!==(a=null===(n=e.tags)||void 0===n?void 0:n.map((e=>e.split(":")[1])))&&void 0!==a?a:[];if(!i.length)return;const r=t.filter((e=>i.includes(e.id)));p(r)}),[h,e.tags,t]);const v=Object(mL.a)("blocklist-form"),T=Object(i.useMemo)((()=>e.entries.length?e.entries[0]:{field:"file.hash.*",operator:"included",type:"match_any",value:[]}),[e.entries]),k=Object(i.useMemo)((()=>{var t;return null!=e&&null!==(t=e.os_types)&&void 0!==t&&t.length?e.os_types[0]:aI.c.WINDOWS}),[null==e?void 0:e.os_types]),x=Object(i.useMemo)((()=>T.value.map((e=>({label:e,"data-test-subj":v(`values-input-${e}`)})))),[T.value,v]),S=Object(i.useMemo)((()=>[aI.c.LINUX,aI.c.MAC,aI.c.WINDOWS].map((e=>({value:e,inputDisplay:pN.c[e]})))),[]),O=Object(i.useMemo)((()=>{const e=["file.hash.*","file.path"].map((e=>({value:e,inputDisplay:oB[e],dropdownDisplay:pB(e),"data-test-subj":v(e)})));return k===aI.c.WINDOWS&&e.push({value:"file.Ext.code_signature",inputDisplay:oB["file.Ext.code_signature"],dropdownDisplay:pB("file.Ext.code_signature"),"data-test-subj":v("file.Ext.code_signature")}),e}),[k,v]),w=Object(i.useMemo)((()=>r.a.createElement("div",null,r.a.createElement(N.EuiToolTip,{content:sB},r.a.createElement(r.a.Fragment,null,rB," ",r.a.createElement(N.EuiIcon,{color:"subdued",type:"iInCircle",className:"eui-alignTop"}))))),[]),j=Object(i.useCallback)((e=>{var t,a,n;const i=null!==(t=(null!==(a=e.os_types)&&void 0!==a?a:[])[0])&&void 0!==t?t:aI.c.WINDOWS,{field:r="file.hash.*",type:s="match_any",value:o=[]}=null!==(n=e.entries[0])&&void 0!==n?n:{},l={},d={},p={};e.name.trim()||(d.NAME_REQUIRED=dB(uB.NAME_REQUIRED)),o.length||(p.VALUE_REQUIRED=dB(uB.VALUE_REQUIRED)),"file.hash.*"===r&&o.some((e=>!JL(e)))&&(p.INVALID_HASH=dB(uB.INVALID_HASH));const m=o.some((e=>!Object(aI.f)({os:i,field:r,type:s,value:e})));"file.hash.*"!==r&&m&&(l.INVALID_PATH=dB(uB.INVALID_PATH)),o.length!==Object(fn.uniq)(o).length&&(l.DUPLICATE_VALUES=dB(uB.DUPLICATE_VALUES)),c.current={...c.current,value:l},u.current={name:d,value:p}}),[]),C=Object(i.useCallback)((()=>{j(e),l((e=>({...e,name:!0})))}),[e,j]),I=Object(i.useCallback)((()=>{j(e),l((e=>({...e,value:!0})))}),[e,j]),M=Object(i.useCallback)((t=>{const a={...e,name:t.target.value};j(a),n({isValid:mB(u.current),item:a}),y(!0)}),[j,n,e]),A=Object(i.useCallback)((t=>{const a={...e,description:t.target.value};j(a),n({isValid:mB(u.current),item:a}),y(!0)}),[n,e,j]),D=Object(i.useCallback)((t=>{const a={...e,os_types:[t],entries:[{...T,field:t!==aI.c.WINDOWS&&"file.Ext.code_signature"===T.field?"file.hash.*":T.field}]};j(a),n({isValid:mB(u.current),item:a}),y(!0)}),[j,T,n,e]),q=Object(i.useCallback)((t=>{const a={...e,entries:[{...T,field:t}]};j(a),n({isValid:mB(u.current),item:a}),y(!0)}),[j,n,e,T]),P=Object(i.useCallback)((e=>{const t={...c.current.value};T.value.includes(e)?t.DUPLICATE_VALUE=dB(uB.DUPLICATE_VALUE):delete t.DUPLICATE_VALUE,c.current={...c.current,value:t},l((e=>({...e})))}),[T]),R=Object(i.useCallback)((t=>{const a=t.map((e=>e.label)),i={...e,entries:[{...T,value:a}]};j(i),n({isValid:mB(u.current),item:i}),y(!0)}),[j,n,e,T]),_=Object(i.useCallback)((t=>{const a=t.split(",").filter((e=>e.trim())),i=[...T.value,...a],r={...e,entries:[{...T,value:i}]};j(r),r.entries[0].value=Object(fn.uniq)(r.entries[0].value),l((e=>({...e,value:!0}))),n({isValid:mB(u.current),item:r}),y(!0)}),[j,n,e,T]),F=Object(i.useCallback)((t=>{const a=t.isGlobal?[ki.d]:t.selected.map((e=>`${ki.b}${e.id}`)),i={...e,tags:a};t.isGlobal||p(t.selected),j(i),n({isValid:mB(u.current),item:i}),y(!0)}),[j,n,e]);return r.a.createElement(N.EuiForm,{component:"div"},r.a.createElement(N.EuiTitle,{size:"xs"},r.a.createElement("h3",null,YN)),r.a.createElement(N.EuiSpacer,{size:"xs"}),"create"===s&&r.a.createElement(N.EuiText,{size:"s","data-test-subj":v("header-description")},r.a.createElement("p",null,JN)),r.a.createElement(N.EuiSpacer,{size:"m"}),r.a.createElement(N.EuiFormRow,{label:XN,isInvalid:o.name&&!!Object.keys(u.current.name).length,error:Object.values(u.current.name),fullWidth:!0},r.a.createElement(N.EuiFieldText,{name:"name",value:e.name,onChange:M,onBlur:C,required:o.name,maxLength:256,"data-test-subj":v("name-input"),fullWidth:!0})),r.a.createElement(N.EuiFormRow,{label:ZN,fullWidth:!0},r.a.createElement(N.EuiTextArea,{name:"description",value:e.description,onChange:A,"data-test-subj":v("description-input"),fullWidth:!0,compressed:!0,maxLength:256})),r.a.createElement(N.EuiHorizontalRule,null),r.a.createElement(N.EuiTitle,{size:"xs"},r.a.createElement("h3",null,eB)),r.a.createElement(N.EuiSpacer,{size:"xs"}),r.a.createElement(N.EuiText,{size:"s"},r.a.createElement("p",null,tB)),r.a.createElement(N.EuiSpacer,{size:"m"}),r.a.createElement(N.EuiFormRow,{label:aB,fullWidth:!0},r.a.createElement(N.EuiSuperSelect,{name:"os",options:S,valueOfSelected:k,onChange:D,"data-test-subj":v("os-select"),fullWidth:!0})),r.a.createElement(N.EuiSpacer,{size:"m"}),r.a.createElement(N.EuiFormRow,{fullWidth:!0},r.a.createElement(N.EuiFlexGroup,{gutterSize:"s"},r.a.createElement(N.EuiFlexItem,{grow:1},r.a.createElement(N.EuiFormRow,{label:nB,fullWidth:!0},r.a.createElement(N.EuiSuperSelect,{name:"field",options:O,valueOfSelected:T.field,onChange:q,"data-test-subj":v("field-select"),fullWidth:!0}))),r.a.createElement(N.EuiFlexItem,{grow:1},r.a.createElement(N.EuiFormRow,{label:iB,fullWidth:!0},r.a.createElement(N.EuiFieldText,{name:"operator",value:FI.o.message,readOnly:!0}))),r.a.createElement(N.EuiFlexItem,{grow:2}))),r.a.createElement(N.EuiFormRow,{label:w,isInvalid:o.value&&!!Object.keys(u.current.value).length,helpText:Object.values(c.current.value),error:Object.values(u.current.value),fullWidth:!0},r.a.createElement(N.EuiComboBox,{selectedOptions:x,onBlur:I,onSearchChange:P,onChange:R,onCreateOption:_,"data-test-subj":v("values-input"),fullWidth:!0,noSuggestions:!0})),E&&r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiHorizontalRule,null),r.a.createElement(N.EuiFormRow,{fullWidth:!0},r.a.createElement(SN.a,{isGlobal:g,isPlatinumPlus:m,selected:d,options:t,onChange:F,isLoading:a,description:cB}))))})),fB={pageTitle:F.i18n.translate("xpack.securitySolution.blocklist.pageTitle",{defaultMessage:"Blocklist"}),pageAboutInfo:F.i18n.translate("xpack.securitySolution.blocklist.pageAboutInfo",{defaultMessage:"The blocklist prevents selected applications from running on your hosts by extending the list of processes the Endpoint considers malicious."}),pageAddButtonTitle:F.i18n.translate("xpack.securitySolution.blocklist.pageAddButtonTitle",{defaultMessage:"Add blocklist entry"}),getShowingCountLabel:e=>F.i18n.translate("xpack.securitySolution.blocklist.showingTotal",{defaultMessage:"Showing {total} {total, plural, one {blocklist entry} other {blocklist entries}}",values:{total:e}}),cardActionEditLabel:F.i18n.translate("xpack.securitySolution.blocklist.cardActionEditLabel",{defaultMessage:"Edit blocklist"}),cardActionDeleteLabel:F.i18n.translate("xpack.securitySolution.blocklist.cardActionDeleteLabel",{defaultMessage:"Delete blocklist"}),flyoutCreateTitle:F.i18n.translate("xpack.securitySolution.blocklist.flyoutCreateTitle",{defaultMessage:"Add blocklist"}),flyoutEditTitle:F.i18n.translate("xpack.securitySolution.blocklist.flyoutEditTitle",{defaultMessage:"Edit blocklist"}),flyoutCreateSubmitButtonLabel:F.i18n.translate("xpack.securitySolution.blocklist.flyoutCreateSubmitButtonLabel",{defaultMessage:"Add blocklist"}),flyoutCreateSubmitSuccess:({name:e})=>F.i18n.translate("xpack.securitySolution.blocklist.flyoutCreateSubmitSuccess",{defaultMessage:'"{name}" has been added to your blocklist.',values:{name:e}}),flyoutEditSubmitSuccess:({name:e})=>F.i18n.translate("xpack.securitySolution.blocklist.flyoutEditSubmitSuccess",{defaultMessage:'"{name}" has been updated.',values:{name:e}}),flyoutDowngradedLicenseDocsInfo:e=>r.a.createElement(r.a.Fragment,null,r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.blocklist.flyoutDowngradedLicenseDocsInfo",defaultMessage:"For more information, see our "}),r.a.createElement(N.EuiLink,{target:"_blank",href:`${e.blocklist}`},r.a.createElement(It.FormattedMessage,{id:"xpack.securitySolution.blocklist.flyoutDowngradedLicenseDocsLink",defaultMessage:"blocklist documentation."}))),deleteActionSuccess:e=>F.i18n.translate("xpack.securitySolution.blocklist.deleteSuccess",{defaultMessage:'"{itemName}" has been removed from blocklist.',values:{itemName:e}}),emptyStateTitle:F.i18n.translate("xpack.securitySolution.blocklist.emptyStateTitle",{defaultMessage:"Add your first blocklist entry"}),emptyStateInfo:F.i18n.translate("xpack.securitySolution.blocklist.emptyStateInfo",{defaultMessage:"The blocklist prevents specified applications from running on your hosts, extending the list of processes that Endpoint Security considers malicious."}),emptyStatePrimaryButtonLabel:F.i18n.translate("xpack.securitySolution.blocklist.emptyStatePrimaryButtonLabel",{defaultMessage:"Add blocklist entry"}),searchPlaceholderInfo:F.i18n.translate("xpack.securitySolution.blocklist.searchPlaceholderInfo",{defaultMessage:"Search on the fields below: name, description, value"})},bB=Object(i.memo)((()=>{const e=Object(d.i)(),t=KN.a.getInstance(e);return r.a.createElement(GL.a,{apiClient:t,ArtifactFormComponent:gB,labels:fB,"data-test-subj":"blocklistPage",flyoutSize:"l"})}));bB.displayName="Blocklist";const hB=Object(i.memo)((()=>r.a.createElement(P.Switch,null,r.a.createElement(R.Route,{path:AR.g,exact:!0,component:bB}),r.a.createElement(R.Route,{path:"*",component:_.a}))));hB.displayName="BlocklistContainer";var yB=a(618);const EB=()=>r.a.createElement(s.TrackApplicationView,{viewId:o.cc.endpoints},r.a.createElement(WF,null)),vB=()=>r.a.createElement(s.TrackApplicationView,{viewId:o.cc.policies},r.a.createElement(WL,null)),TB=()=>r.a.createElement(s.TrackApplicationView,{viewId:o.cc.trustedApps},r.a.createElement(AN,null)),kB=()=>r.a.createElement(s.TrackApplicationView,{viewId:o.cc.eventFilters},r.a.createElement(qN,null)),xB=()=>r.a.createElement(s.TrackApplicationView,{viewId:o.cc.hostIsolationExceptions},r.a.createElement(y.a,{pageName:o.cc.administration}),r.a.createElement(GN,null)),SB=Object(i.memo)((()=>{const{loading:e,canAccessEndpointManagement:t}=Object(nt.a)().endpointPrivileges;return e?r.a.createElement(N.EuiLoadingSpinner,null):t?r.a.createElement(P.Switch,null,r.a.createElement(R.Route,{path:AR.h,component:EB}),r.a.createElement(R.Route,{path:AR.k,component:vB}),r.a.createElement(R.Route,{path:AR.r,component:TB}),r.a.createElement(R.Route,{path:AR.i,component:kB}),r.a.createElement(R.Route,{path:AR.j,component:xB}),r.a.createElement(R.Route,{path:AR.g,component:hB}),r.a.createElement(R.Route,{path:o.Eb,exact:!0},r.a.createElement(P.Redirect,{to:Object(h.e)({name:"endpointList"})})),r.a.createElement(R.Route,{path:"*",component:_.a})):r.a.createElement(r.a.Fragment,null,r.a.createElement(R.Route,{path:"*",component:yB.a}),r.a.createElement(y.a,{pageName:o.cc.administration}))}));SB.displayName="ManagementContainer";var OB=a(585);const wB=[{path:o.Eb,render:()=>r.a.createElement(OB.a,null,r.a.createElement(SB,null))}];var jB=a(612),CB=a(616),IB=a(449);const MB=z()(N.EuiTitle).withConfig({displayName:"PrimaryEuiTitle",componentId:"sc-dlsynk-0"})(["color:",";"],(e=>e.theme.eui.euiColorPrimary)),AB=z()(N.EuiText).withConfig({displayName:"LandingLinksDescripton",componentId:"sc-dlsynk-1"})(["padding-top:",";max-width:550px;"],(({theme:e})=>e.eui.paddingSizes.xs)),DB=z.a.a.withConfig({displayName:"Link",componentId:"sc-dlsynk-2"})(["color:inherit;"]),qB=z()(N.EuiFlexItem).withConfig({displayName:"StyledFlexItem",componentId:"sc-dlsynk-3"})(["align-items:center;"]),PB=Object(ut.p)(DB),RB=z()(N.EuiFlexItem).withConfig({displayName:"Content",componentId:"sc-dlsynk-4"})(["padding-left:",";"],(({theme:e})=>e.eui.paddingSizes.s)),_B=({items:e})=>r.a.createElement(N.EuiFlexGroup,{direction:"column"},e.map((({title:e,description:t,image:a,id:n})=>r.a.createElement(N.EuiFlexItem,{key:n,"data-test-subj":"LandingItem"},r.a.createElement(PB,{deepLinkId:n,tabIndex:-1},r.a.createElement(N.EuiPanel,{hasBorder:!0,hasShadow:!1,paddingSize:"m",onClick:()=>{}},r.a.createElement(N.EuiFlexGroup,null,r.a.createElement(qB,{grow:!1},a&&r.a.createElement(N.EuiImage,{"data-test-subj":"LandingLinksImage",size:"l",role:"presentation",alt:"",src:a})),r.a.createElement(RB,null,r.a.createElement(MB,{size:"s"},r.a.createElement("h2",null,e)),r.a.createElement(AB,{size:"s",color:"text"},t))))))))),FB=F.i18n.translate("xpack.securitySolution.landing.threatHunting.pageTitle",{defaultMessage:"Explore"}),LB=F.i18n.translate("xpack.securitySolution.landing.dashboards.pageTitle",{defaultMessage:"Dashboards"}),NB=F.i18n.translate("xpack.securitySolution.landing.manage.pageTitle",{defaultMessage:"Manage"}),BB=()=>{var e,t;const a=null!==(e=null===(t=Object(IB.b)(T.a.exploreLanding))||void 0===t?void 0:t.links)&&void 0!==e?e:[];return r.a.createElement(b.a,null,r.a.createElement(Ta.a,{title:FB}),r.a.createElement(_B,{items:a}),r.a.createElement(y.a,{pageName:T.a.exploreLanding}))},zB=()=>{var e,t;const a=null!==(e=null===(t=Object(IB.b)(T.a.dashboardsLanding))||void 0===t?void 0:t.links)&&void 0!==e?e:[];return r.a.createElement(b.a,null,r.a.createElement(Ta.a,{title:LB}),r.a.createElement(_B,{items:a}),r.a.createElement(y.a,{pageName:T.a.dashboardsLanding}))};var UB=a(399);const HB=z.a.a.withConfig({displayName:"Link",componentId:"sc-r94plg-0"})(["color:inherit;"]),$B=Object(ut.p)(HB),VB=z()(N.EuiFlexItem).withConfig({displayName:"Description",componentId:"sc-r94plg-1"})(["max-width:22em;"]),QB=z()(N.EuiTitle).withConfig({displayName:"StyledEuiTitle",componentId:"sc-r94plg-2"})(["margin-top:",";margin-bottom:",";"],(({theme:e})=>e.eui.paddingSizes.m),(({theme:e})=>e.eui.paddingSizes.xs)),WB=({items:e})=>r.a.createElement(N.EuiFlexGrid,{columns:3,gutterSize:"xl"},e.map((({title:e,description:t,id:a,icon:n})=>r.a.createElement(N.EuiFlexItem,{key:a,"data-test-subj":"LandingItem"},r.a.createElement(N.EuiFlexGroup,{direction:"column",alignItems:"flexStart",gutterSize:"none",responsive:!1},r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement($B,{tabIndex:-1,deepLinkId:a},r.a.createElement(N.EuiIcon,{"aria-hidden":"true",size:"xl",type:null!=n?n:"",role:"presentation"}))),r.a.createElement(N.EuiFlexItem,{grow:!1},r.a.createElement(QB,{size:"xxs"},r.a.createElement(ut.k,{deepLinkId:a},r.a.createElement("h2",null,e)))),r.a.createElement(VB,null,r.a.createElement(N.EuiText,{size:"s",color:"text"},t))))))),GB=()=>r.a.createElement(b.a,null,r.a.createElement(Ta.a,{title:NB}),r.a.createElement(YB,null),r.a.createElement(y.a,{pageName:T.a.administration})),KB=z()(N.EuiHorizontalRule).withConfig({displayName:"StyledEuiHorizontalRule",componentId:"sc-1negbtf-0"})(["margin-top:",";margin-bottom:",";"],(({theme:e})=>e.eui.paddingSizes.m),(({theme:e})=>e.eui.paddingSizes.l)),YB=()=>{const e=(()=>{var e;const t=!Object(UB.a)(),{links:a=[],categories:n=[]}=null!==(e=Object(IB.b)(T.a.administration))&&void 0!==e?e:{},i=Object.fromEntries(a.map((e=>[e.id,e])));return n.reduce(((e,{label:a,linkIds:n})=>{const r=n.reduce(((e,a)=>(!i[a]||a===T.a.hostIsolationExceptions&&t||e.push(i[a]),e)),[]);return r.length>0&&e.push({label:a,links:r}),e}),[])})();return r.a.createElement(r.a.Fragment,null,e.map((({label:e,links:t},a)=>r.a.createElement("div",{key:e},a>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement(N.EuiSpacer,{key:"first",size:"xl"}),r.a.createElement(N.EuiSpacer,{key:"second",size:"xl"})),r.a.createElement(N.EuiTitle,{size:"xxxs"},r.a.createElement("h2",null,e)),r.a.createElement(KB,null),r.a.createElement(WB,{items:t})))))};YB.displayName="ManagementCategories";const JB=[{path:o.yb,render:()=>r.a.createElement(s.TrackApplicationView,{viewId:T.a.exploreLanding},r.a.createElement(BB,null))},{path:o.D,render:()=>r.a.createElement(s.TrackApplicationView,{viewId:T.a.dashboardsLanding},r.a.createElement(zB,null))},{path:o.Fb,render:()=>r.a.createElement(s.TrackApplicationView,{viewId:T.a.administration},r.a.createElement(GB,null))}],XB={Detections:class detections_Detections{setup(){}start(e){return{storageTimelines:{timelineById:Object(q.b)(e,qa)},routes:Da}}},Cases:class cases_Cases{setup(){}start(){return{routes:D}}},Exceptions:class exceptions_Exceptions{setup(){}start(e){return{storageTimelines:{timelineById:Object(q.b)(e,qa)},routes:Ci}}},Hosts:class public_hosts_Hosts{setup(){}start(e){return{routes:rg,storageTimelines:{timelineById:Object(q.b)(e,sg)},store:{initialState:{hosts:wo.e},reducer:{hosts:wo.c}}}}},Users:class public_users_Users{setup(){}start(e){return{routes:eb,store:{initialState:{users:fg.a},reducer:{users:fg.d}}}}},Network:class public_network_Network{setup(){}start(e){return{routes:dE,storageTimelines:{timelineById:Object(q.b)(e,[c.i.networkPageExternalAlerts])},store:{initialState:{network:ay.a},reducer:{network:ay.d}}}}},Overview:class overview_Overview{setup(){}start(){return{routes:hx}}},Rules:class rules_Rules{setup(){}start(e){return{storageTimelines:{timelineById:Object(q.b)(e,qa)},routes:gR}}},Timelines:class timelines_Timelines{setup(){}start(){return{routes:wR,store:{initialState:{timeline:IR},reducer:{timeline:MR}}}}},Management:class management_Management{setup(){}start(e,t){return{routes:wB,store:{initialState:{management:{}},reducer:{management:jB.a},middleware:Object(CB.a)(e,t)}}}},LandingPages:class landing_pages_LandingPages{setup(){}start(){return{routes:JB}}}}}])]);