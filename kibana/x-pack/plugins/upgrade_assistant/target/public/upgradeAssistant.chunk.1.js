/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.upgradeAssistant_bundle_jsonpfunction=window.upgradeAssistant_bundle_jsonpfunction||[]).push([[1],Array(33).concat([function(e,t,s){e.exports=s(7)(2567)},function(e,t,s){"use strict";var a,n=function(){var e={};return function(t){if(void 0===e[t]){var s=document.querySelector(t);if(window.HTMLIFrameElement&&s instanceof window.HTMLIFrameElement)try{s=s.contentDocument.head}catch(e){s=null}e[t]=s}return e[t]}}(),i=[];function r(e){for(var t=-1,s=0;s<i.length;s++)if(i[s].identifier===e){t=s;break}return t}function o(e,t){for(var s={},a=[],n=0;n<e.length;n++){var o=e[n],l=t.base?o[0]+t.base:o[0],u=s[l]||0,c="".concat(l," ").concat(u);s[l]=u+1;var d=r(c),p={css:o[1],media:o[2],sourceMap:o[3]};-1!==d?(i[d].references++,i[d].updater(p)):i.push({identifier:c,updater:x(p,t),references:1}),a.push(c)}return a}function l(e){var t=document.createElement("style"),a=e.attributes||{};if(void 0===a.nonce){var i=s.nc;i&&(a.nonce=i)}if(Object.keys(a).forEach((function(e){t.setAttribute(e,a[e])})),"function"==typeof e.insert)e.insert(t);else{var r=n(e.insert||"head");if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(t)}return t}var u,c=(u=[],function(e,t){return u[e]=t,u.filter(Boolean).join("\n")});function d(e,t,s,a){var n=s?"":a.media?"@media ".concat(a.media," {").concat(a.css,"}"):a.css;if(e.styleSheet)e.styleSheet.cssText=c(t,n);else{var i=document.createTextNode(n),r=e.childNodes;r[t]&&e.removeChild(r[t]),r.length?e.insertBefore(i,r[t]):e.appendChild(i)}}function p(e,t,s){var a=s.css,n=s.media,i=s.sourceMap;if(n?e.setAttribute("media",n):e.removeAttribute("media"),i&&"undefined"!=typeof btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleSheet)e.styleSheet.cssText=a;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(a))}}var g=null,j=0;function x(e,t){var s,a,n;if(t.singleton){var i=j++;s=g||(g=l(t)),a=d.bind(null,s,i,!1),n=d.bind(null,s,i,!0)}else s=l(t),a=p.bind(null,s,t),n=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(s)};return a(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;a(e=t)}else n()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===a&&(a=Boolean(window&&document&&document.all&&!window.atob)),a));var s=o(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var a=0;a<s.length;a++){var n=r(s[a]);i[n].references--}for(var l=o(e,t),u=0;u<s.length;u++){var c=r(s[u]);0===i[c].references&&(i[c].updater(),i.splice(c,1))}s=l}}}},function(e,t,s){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var s=function(e,t){var s,a,n,i=e[1]||"",r=e[3];if(!r)return i;if(t&&"function"==typeof btoa){var o=(s=r,a=btoa(unescape(encodeURIComponent(JSON.stringify(s)))),n="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),"/*# ".concat(n," */")),l=r.sources.map((function(e){return"/*# sourceURL=".concat(r.sourceRoot||"").concat(e," */")}));return[i].concat(l).concat([o]).join("\n")}return[i].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(s,"}"):s})).join("")},t.i=function(e,s,a){"string"==typeof e&&(e=[[null,e,""]]);var n={};if(a)for(var i=0;i<this.length;i++){var r=this[i][0];null!=r&&(n[r]=!0)}for(var o=0;o<e.length;o++){var l=[].concat(e[o]);a&&n[l[0]]||(s&&(l[2]?l[2]="".concat(s," and ").concat(l[2]):l[2]=s),t.push(l))}},t}},function(e,t,s){e.exports=s(7)(9)},function(e,t,s){e.exports=s(7)(23)},function(e,t){var s="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(s){var a=new Uint8Array(16);e.exports=function(){return s(a),a}}else{var n=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),n[t]=e>>>((3&t)<<3)&255;return n}}},function(e,t){for(var s=[],a=0;a<256;++a)s[a]=(a+256).toString(16).substr(1);e.exports=function(e,t){var a=t||0,n=s;return[n[e[a++]],n[e[a++]],n[e[a++]],n[e[a++]],"-",n[e[a++]],n[e[a++]],"-",n[e[a++]],n[e[a++]],"-",n[e[a++]],n[e[a++]],"-",n[e[a++]],n[e[a++]],n[e[a++]],n[e[a++]],n[e[a++]],n[e[a++]]].join("")}},function(e,t,s){"use strict";function a(e){return e}function n(e){throw new Error("Called `absurd` function which should be uncallable")}Object.defineProperty(t,"__esModule",{value:!0}),t.bindTo_=t.bind_=t.hole=t.pipe=t.untupled=t.tupled=t.absurd=t.decrement=t.increment=t.tuple=t.flow=t.flip=t.constVoid=t.constUndefined=t.constNull=t.constFalse=t.constTrue=t.constant=t.not=t.unsafeCoerce=t.identity=void 0,t.identity=a,t.unsafeCoerce=a,t.not=function(e){return function(t){return!e(t)}},t.constant=function(e){return function(){return e}},t.constTrue=function(){return!0},t.constFalse=function(){return!1},t.constNull=function(){return null},t.constUndefined=function(){},t.constVoid=function(){},t.flip=function(e){return function(t,s){return e(s,t)}},t.flow=function(e,t,s,a,n,i,r,o,l){switch(arguments.length){case 1:return e;case 2:return function(){return t(e.apply(this,arguments))};case 3:return function(){return s(t(e.apply(this,arguments)))};case 4:return function(){return a(s(t(e.apply(this,arguments))))};case 5:return function(){return n(a(s(t(e.apply(this,arguments)))))};case 6:return function(){return i(n(a(s(t(e.apply(this,arguments))))))};case 7:return function(){return r(i(n(a(s(t(e.apply(this,arguments)))))))};case 8:return function(){return o(r(i(n(a(s(t(e.apply(this,arguments))))))))};case 9:return function(){return l(o(r(i(n(a(s(t(e.apply(this,arguments)))))))))}}},t.tuple=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e},t.increment=function(e){return e+1},t.decrement=function(e){return e-1},t.absurd=n,t.tupled=function(e){return function(t){return e.apply(void 0,t)}},t.untupled=function(e){return function(){for(var t=[],s=0;s<arguments.length;s++)t[s]=arguments[s];return e(t)}},t.pipe=function(e,t,s,a,n,i,r,o,l,u,c,d,p,g,j,x,b,f,m,h){switch(arguments.length){case 1:return e;case 2:return t(e);case 3:return s(t(e));case 4:return a(s(t(e)));case 5:return n(a(s(t(e))));case 6:return i(n(a(s(t(e)))));case 7:return r(i(n(a(s(t(e))))));case 8:return o(r(i(n(a(s(t(e)))))));case 9:return l(o(r(i(n(a(s(t(e))))))));case 10:return u(l(o(r(i(n(a(s(t(e)))))))));case 11:return c(u(l(o(r(i(n(a(s(t(e))))))))));case 12:return d(c(u(l(o(r(i(n(a(s(t(e)))))))))));case 13:return p(d(c(u(l(o(r(i(n(a(s(t(e))))))))))));case 14:return g(p(d(c(u(l(o(r(i(n(a(s(t(e)))))))))))));case 15:return j(g(p(d(c(u(l(o(r(i(n(a(s(t(e))))))))))))));case 16:return x(j(g(p(d(c(u(l(o(r(i(n(a(s(t(e)))))))))))))));case 17:return b(x(j(g(p(d(c(u(l(o(r(i(n(a(s(t(e))))))))))))))));case 18:return f(b(x(j(g(p(d(c(u(l(o(r(i(n(a(s(t(e)))))))))))))))));case 19:return m(f(b(x(j(g(p(d(c(u(l(o(r(i(n(a(s(t(e))))))))))))))))));case 20:return h(m(f(b(x(j(g(p(d(c(u(l(o(r(i(n(a(s(t(e)))))))))))))))))))}},t.hole=n,t.bind_=function(e,t,s){var a;return Object.assign({},e,((a={})[t]=s,a))},t.bindTo_=function(e){return function(t){var s;return(s={})[e]=t,s}}},function(e,t,s){e.exports=s(7)(3)},function(e,t,s){e.exports=s(7)(45)},function(e,t,s){"use strict";function a(e,t,s,n){var i=Error.call(this,e);return Object.setPrototypeOf&&Object.setPrototypeOf(i,a.prototype),i.expected=t,i.found=s,i.location=n,i.name="SyntaxError",i}function n(e,t,s){return s=s||" ",e.length>t?e:(t-=e.length,e+(s+=s.repeat(t)).slice(0,t))}!function(e,t){function s(){this.constructor=e}s.prototype=t.prototype,e.prototype=new s}(a,Error),a.prototype.format=function(e){var t="Error: "+this.message;if(this.location){var s,a=null;for(s=0;s<e.length;s++)if(e[s].source===this.location.source){a=e[s].text.split(/\r\n|\n|\r/g);break}var i=this.location.start,r=this.location.source+":"+i.line+":"+i.column;if(a){var o=this.location.end,l=n("",i.line.toString().length),u=a[i.line-1],c=i.line===o.line?o.column:u.length+1;t+="\n --\x3e "+r+"\n"+l+" |\n"+i.line+" | "+u+"\n"+l+" | "+n("",i.column-1)+n("",c-i.column,"^")}else t+="\n at "+r}return t},a.buildMessage=function(e,t){var s={literal:function(e){return'"'+n(e.text)+'"'},class:function(e){var t=e.parts.map((function(e){return Array.isArray(e)?i(e[0])+"-"+i(e[1]):i(e)}));return"["+(e.inverted?"^":"")+t+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(e){return e.description}};function a(e){return e.charCodeAt(0).toString(16).toUpperCase()}function n(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+a(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+a(e)}))}function i(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+a(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+a(e)}))}function r(e){return s[e.type](e)}return"Expected "+function(e){var t,s,a=e.map(r);if(a.sort(),a.length>0){for(t=1,s=1;t<a.length;t++)a[t-1]!==a[t]&&(a[s]=a[t],s++);a.length=s}switch(a.length){case 1:return a[0];case 2:return a[0]+" or "+a[1];default:return a.slice(0,-1).join(", ")+", or "+a[a.length-1]}}(e)+" but "+function(e){return e?'"'+n(e)+'"':"end of input"}(t)+" found."},e.exports={SyntaxError:a,parse:function(e,t){var s,n={},i=(t=void 0!==t?t:{}).grammarSource,r={start:de,Literal:ke},o=de,l='"',u="\\",c="@kuery-cursor@",d=/^[\\"]/,p=/^[^"]/,g=/^[\\():<>"*{}]/,j=/^[0-9a-f]/i,x=/^[ \t\r\n\xA0]/,b=ie("(",!1),f=ie(")",!1),m=ie(":",!1),h=ie("{",!1),O=ie("}",!1),v=oe("fieldName"),y=oe("value"),E=oe("OR"),k=ie("or",!0),C=oe("AND"),S=ie("and",!0),T=oe("NOT"),L=ie("not",!0),M=oe("literal"),w=ie('"',!1),F=ie("\\",!1),I=re(["\\",'"'],!1,!1),A=re(['"'],!0,!1),D={type:"any"},R=ie("*",!1),P=ie("\\t",!1),_=ie("\\r",!1),B=ie("\\n",!1),N=re(["\\","(",")",":","<",">",'"',"*","{","}"],!1,!1),z=ie("u",!1),U=re([["0","9"],["a","f"]],!1,!0),W=ie("<=",!1),q=ie(">=",!1),G=ie("<",!1),$=ie(">",!1),K=oe("whitespace"),Y=re([" ","\t","\r","\n"," "],!1,!1),Q=ie("@kuery-cursor@",!1),V=function(e,t){return t},H=function(e,t){return t},J=function(){return Pe},Z=function(t,s,a){const{start:n,end:i}=ue(ee,X);return{type:"cursor",start:n.offset,end:i.offset-s.length,prefix:t.join(""),suffix:a.join(""),text:e.substring(ee,X).replace(s,"")}},X=0,ee=0,te=[{line:1,column:1}],se=0,ae=[],ne=0;if("startRule"in t){if(!(t.startRule in r))throw new Error("Can't start parsing from rule \""+t.startRule+'".');o=r[t.startRule]}function ie(e,t){return{type:"literal",text:e,ignoreCase:t}}function re(e,t,s){return{type:"class",parts:e,inverted:t,ignoreCase:s}}function oe(e){return{type:"other",description:e}}function le(t){var s,a=te[t];if(a)return a;for(s=t-1;!te[s];)s--;for(a={line:(a=te[s]).line,column:a.column};s<t;)10===e.charCodeAt(s)?(a.line++,a.column=1):a.column++,s++;return te[t]=a,a}function ue(e,t){var s=le(e),a=le(t);return{source:i,start:{offset:e,line:s.line,column:s.column},end:{offset:t,line:a.line,column:a.column}}}function ce(e){X<se||(X>se&&(se=X,ae=[]),ae.push(e))}function de(){var e,t,s,a,i,r;for(e=X,t=[],s=De();s!==n;)t.push(s),s=De();return(s=pe())===n&&(s=null),(a=Me())!==n?(ee=e,i=s,e="cursor"===(r=a).type?{...r,suggestionTypes:["conjunction"]}:null!==i?i:Ne.function.buildNode("is","*","*")):(X=e,e=n),e}function pe(){var e,t,s,a,i;if(e=X,(t=ge())!==n){if(s=[],a=X,ve()!==n&&(i=ge())!==n?(ee=a,a=V(0,i)):(X=a,a=n),a!==n)for(;a!==n;)s.push(a),a=X,ve()!==n&&(i=ge())!==n?(ee=a,a=V(0,i)):(X=a,a=n);else s=n;s!==n?(ee=e,e=function(e,t){const s=[e,...t];return Pe&&s.find((e=>"cursor"===e.type))||ze("or",s)}(t,s)):(X=e,e=n)}else X=e,e=n;return e===n&&(e=ge()),e}function ge(){var e,t,s,a,i;if(e=X,(t=je())!==n){if(s=[],a=X,ye()!==n&&(i=je())!==n?(ee=a,a=V(0,i)):(X=a,a=n),a!==n)for(;a!==n;)s.push(a),a=X,ye()!==n&&(i=je())!==n?(ee=a,a=V(0,i)):(X=a,a=n);else s=n;s!==n?(ee=e,e=function(e,t){const s=[e,...t];return Pe&&s.find((e=>"cursor"===e.type))||ze("and",s)}(t,s)):(X=e,e=n)}else X=e,e=n;return e===n&&(e=je()),e}function je(){var e,t,s;return e=X,Ee()!==n&&(t=xe())!==n?(ee=e,e="cursor"===(s=t).type?s:ze("not",[s])):(X=e,e=n),e===n&&(e=xe()),e}function xe(){var t,s,a,i,r,o,l,u;if(t=X,40===e.charCodeAt(X)?(s="(",X++):(s=n,0===ne&&ce(b)),s!==n){for(a=[],i=De();i!==n;)a.push(i),i=De();(i=pe())!==n&&(r=Me())!==n?(41===e.charCodeAt(X)?(o=")",X++):(o=n,0===ne&&ce(f)),o!==n?(ee=t,l=i,t="cursor"===(u=r).type?{...u,suggestionTypes:["conjunction"]}:l):(X=t,t=n)):(X=t,t=n)}else X=t,t=n;return t===n&&(t=function(){var t,s,a,i,r,o,l,u,c,d;if(t=X,(s=be())!==n){for(a=[],i=De();i!==n;)a.push(i),i=De();if(58===e.charCodeAt(X)?(i=":",X++):(i=n,0===ne&&ce(m)),i!==n){for(r=[],o=De();o!==n;)r.push(o),o=De();if(123===e.charCodeAt(X)?(o="{",X++):(o=n,0===ne&&ce(h)),o!==n){for(l=[],u=De();u!==n;)l.push(u),u=De();(u=pe())!==n&&(c=Me())!==n?(125===e.charCodeAt(X)?(d="}",X++):(d=n,0===ne&&ce(O)),d!==n?(ee=t,t=function(e,t,s){return"cursor"===t.type?{...t,nestedPath:t.nestedPath?`${e.value}.${t.nestedPath}`:e.value}:"cursor"===s.type?{...s,suggestionTypes:["conjunction"]}:ze("nested",[e,t])}(s,u,c)):(X=t,t=n)):(X=t,t=n)}else X=t,t=n}else X=t,t=n}else X=t,t=n;return t===n&&(t=function(){var t;return t=function(){var t,s,a,i,r,o,l,u,c;if(t=X,(s=be())!==n){for(a=[],i=De();i!==n;)a.push(i),i=De();if(i=function(){var t,s;return t=X,"<="===e.substr(X,2)?(s="<=",X+=2):(s=n,0===ne&&ce(W)),s!==n&&(ee=t,s="lte"),(t=s)===n&&(t=X,">="===e.substr(X,2)?(s=">=",X+=2):(s=n,0===ne&&ce(q)),s!==n&&(ee=t,s="gte"),(t=s)===n&&(t=X,60===e.charCodeAt(X)?(s="<",X++):(s=n,0===ne&&ce(G)),s!==n&&(ee=t,s="lt"),(t=s)===n&&(t=X,62===e.charCodeAt(X)?(s=">",X++):(s=n,0===ne&&ce($)),s!==n&&(ee=t,s="gt"),t=s))),t}(),i!==n){for(r=[],o=De();o!==n;)r.push(o),o=De();(o=ke())!==n?(ee=t,l=s,u=i,t="cursor"===(c=o).type?{...c,suggestionTypes:["conjunction"]}:ze("range",[l,u,c])):(X=t,t=n)}else X=t,t=n}else X=t,t=n;return t}(),t===n&&(t=function(){var t,s,a,i,r,o,l,u;if(t=X,(s=be())!==n){for(a=[],i=De();i!==n;)a.push(i),i=De();if(58===e.charCodeAt(X)?(i=":",X++):(i=n,0===ne&&ce(m)),i!==n){for(r=[],o=De();o!==n;)r.push(o),o=De();(o=fe())!==n?(ee=t,l=s,t="cursor"===(u=o).type?{...u,fieldName:l.value,suggestionTypes:["value","conjunction"]}:u(l)):(X=t,t=n)}else X=t,t=n}else X=t,t=n;return t}(),t===n&&(t=function(){var e,t;return e=X,(t=Oe())!==n&&(ee=e,t=function(e){if("cursor"===e.type){const t=`${e.prefix}${e.suffix}`.trim();return{...e,fieldName:t,suggestionTypes:["field","operator","conjunction"]}}return e(Ue(null))}(t)),t}())),t}()),t}()),t}function be(){var e;return ne++,e=ke(),ne--,e===n&&0===ne&&ce(v),e}function fe(){var t,s,a,i,r,o,l,u;if(t=X,40===e.charCodeAt(X)?(s="(",X++):(s=n,0===ne&&ce(b)),s!==n){for(a=[],i=De();i!==n;)a.push(i),i=De();i=function(){var e,t,s,a,i;if(e=X,(t=me())!==n){if(s=[],a=X,ve()!==n&&(i=me())!==n?(ee=a,a=H(0,i)):(X=a,a=n),a!==n)for(;a!==n;)s.push(a),a=X,ve()!==n&&(i=me())!==n?(ee=a,a=H(0,i)):(X=a,a=n);else s=n;s!==n?(ee=e,e=function(e,t){const s=[e,...t],a=Pe&&s.find((e=>"cursor"===e.type));return a?{...a,suggestionTypes:["value"]}:e=>ze("or",s.map((t=>t(e))))}(t,s)):(X=e,e=n)}else X=e,e=n;return e===n&&(e=me()),e}(),i!==n&&(r=Me())!==n?(41===e.charCodeAt(X)?(o=")",X++):(o=n,0===ne&&ce(f)),o!==n?(ee=t,l=i,t="cursor"===(u=r).type?{...u,suggestionTypes:["conjunction"]}:l):(X=t,t=n)):(X=t,t=n)}else X=t,t=n;return t===n&&(t=Oe()),t}function me(){var e,t,s,a,i;if(e=X,(t=he())!==n){if(s=[],a=X,ye()!==n&&(i=he())!==n?(ee=a,a=H(0,i)):(X=a,a=n),a!==n)for(;a!==n;)s.push(a),a=X,ye()!==n&&(i=he())!==n?(ee=a,a=H(0,i)):(X=a,a=n);else s=n;s!==n?(ee=e,e=function(e,t){const s=[e,...t],a=Pe&&s.find((e=>"cursor"===e.type));return a?{...a,suggestionTypes:["value"]}:e=>ze("and",s.map((t=>t(e))))}(t,s)):(X=e,e=n)}else X=e,e=n;return e===n&&(e=he()),e}function he(){var e,t,s;return e=X,Ee()!==n&&(t=fe())!==n?(ee=e,e="cursor"===(s=t).type?{...list,suggestionTypes:["value"]}:e=>ze("not",[s(e)])):(X=e,e=n),e===n&&(e=fe()),e}function Oe(){var e,t;return ne++,e=X,(t=Ce())!==n&&(ee=e,t=function(e){if("cursor"===e.type)return e;const t=Ue(!0);return s=>ze("is",[s,e,t])}(t)),(e=t)===n&&(e=X,(t=Te())!==n&&(ee=e,t=function(e){if("cursor"===e.type)return e;!Be&&"wildcard"===e.type&&Ne.wildcard.hasLeadingWildcard(e)&&function(e,t){throw function(e,t){return new a("Leading wildcards are disabled. See query:allowLeadingWildcards in Advanced Settings.",null,null,t)}(0,t=void 0!==t?t:ue(ee,X))}();const t=Ue(!1);return s=>ze("is",[s,e,t])}(t)),e=t),ne--,e===n&&(t=n,0===ne&&ce(y)),e}function ve(){var t,s,a,i,r;if(ne++,t=X,s=[],(a=De())!==n)for(;a!==n;)s.push(a),a=De();else s=n;if(s!==n)if("or"===e.substr(X,2).toLowerCase()?(a=e.substr(X,2),X+=2):(a=n,0===ne&&ce(k)),a!==n){if(i=[],(r=De())!==n)for(;r!==n;)i.push(r),r=De();else i=n;i!==n?t=s=[s,a,i]:(X=t,t=n)}else X=t,t=n;else X=t,t=n;return ne--,t===n&&(s=n,0===ne&&ce(E)),t}function ye(){var t,s,a,i,r;if(ne++,t=X,s=[],(a=De())!==n)for(;a!==n;)s.push(a),a=De();else s=n;if(s!==n)if("and"===e.substr(X,3).toLowerCase()?(a=e.substr(X,3),X+=3):(a=n,0===ne&&ce(S)),a!==n){if(i=[],(r=De())!==n)for(;r!==n;)i.push(r),r=De();else i=n;i!==n?t=s=[s,a,i]:(X=t,t=n)}else X=t,t=n;else X=t,t=n;return ne--,t===n&&(s=n,0===ne&&ce(C)),t}function Ee(){var t,s,a,i;if(ne++,t=X,"not"===e.substr(X,3).toLowerCase()?(s=e.substr(X,3),X+=3):(s=n,0===ne&&ce(L)),s!==n){if(a=[],(i=De())!==n)for(;i!==n;)a.push(i),i=De();else a=n;a!==n?t=s=[s,a]:(X=t,t=n)}else X=t,t=n;return ne--,t===n&&(s=n,0===ne&&ce(T)),t}function ke(){var e;return ne++,(e=Ce())===n&&(e=Te()),ne--,e===n&&0===ne&&ce(M),e}function Ce(){var t,s,a,i,r,o,u;if(t=X,ee=X,(s=(s=J())?void 0:n)!==n)if(34===e.charCodeAt(X)?(a=l,X++):(a=n,0===ne&&ce(w)),a!==n){for(i=[],r=Se();r!==n;)i.push(r),r=Se();if((r=Re())!==n){for(o=[],u=Se();u!==n;)o.push(u),u=Se();34===e.charCodeAt(X)?(u=l,X++):(u=n,0===ne&&ce(w)),u!==n?(ee=t,t=Z(i,r,o)):(X=t,t=n)}else X=t,t=n}else X=t,t=n;else X=t,t=n;if(t===n)if(t=X,34===e.charCodeAt(X)?(s=l,X++):(s=n,0===ne&&ce(w)),s!==n){for(a=[],i=Se();i!==n;)a.push(i),i=Se();34===e.charCodeAt(X)?(i=l,X++):(i=n,0===ne&&ce(w)),i!==n?(ee=t,t=Ue(a.join(""))):(X=t,t=n)}else X=t,t=n;return t}function Se(){var t,s,a;return(t=we())===n&&(t=Ie())===n&&(t=X,92===e.charCodeAt(X)?(s=u,X++):(s=n,0===ne&&ce(F)),s!==n?(d.test(e.charAt(X))?(a=e.charAt(X),X++):(a=n,0===ne&&ce(I)),a!==n?(ee=t,t=a):(X=t,t=n)):(X=t,t=n),t===n&&(t=X,s=X,ne++,a=Re(),ne--,a===n?s=void 0:(X=s,s=n),s!==n?(p.test(e.charAt(X))?(a=e.charAt(X),X++):(a=n,0===ne&&ce(A)),a!==n?(ee=t,t=a):(X=t,t=n)):(X=t,t=n))),t}function Te(){var e,t,s,a,i,r;if(e=X,ee=X,(t=(t=J())?void 0:n)!==n){for(s=[],a=Le();a!==n;)s.push(a),a=Le();if((a=Re())!==n){for(i=[],r=Le();r!==n;)i.push(r),r=Le();ee=e,e=Z(s,a,i)}else X=e,e=n}else X=e,e=n;if(e===n){if(e=X,t=[],(s=Le())!==n)for(;s!==n;)t.push(s),s=Le();else t=n;t!==n&&(ee=e,t=function(e){const t=e.join("").trim();return"null"===t?Ue(null):"true"===t?Ue(!0):"false"===t?Ue(!1):e.includes(qe)?We(t):Ue(t)}(t)),e=t}return e}function Le(){var t,s,a,i,r;return(t=we())===n&&(t=function(){var t,s,a;return t=X,92===e.charCodeAt(X)?(s=u,X++):(s=n,0===ne&&ce(F)),s!==n&&(a=Fe())!==n?(ee=t,t=a):(X=t,t=n),t}(),t===n&&(t=Ie())===n&&(t=function(){var t,s,a;return t=X,92===e.charCodeAt(X)?(s=u,X++):(s=n,0===ne&&ce(F)),s!==n?("or"===e.substr(X,2).toLowerCase()?(a=e.substr(X,2),X+=2):(a=n,0===ne&&ce(k)),a===n&&("and"===e.substr(X,3).toLowerCase()?(a=e.substr(X,3),X+=3):(a=n,0===ne&&ce(S)),a===n&&("not"===e.substr(X,3).toLowerCase()?(a=e.substr(X,3),X+=3):(a=n,0===ne&&ce(L)))),a!==n?(ee=t,t=a):(X=t,t=n)):(X=t,t=n),t}(),t===n&&(t=function(){var t,s;return t=X,42===e.charCodeAt(X)?(s="*",X++):(s=n,0===ne&&ce(R)),s!==n&&(ee=t,s=qe),s}(),t===n&&(t=X,s=X,ne++,a=Fe(),ne--,a===n?s=void 0:(X=s,s=n),s!==n?(a=X,ne++,i=function(){var e;return(e=ve())===n&&(e=ye())===n&&(e=Ee()),e}(),ne--,i===n?a=void 0:(X=a,a=n),a!==n?(i=X,ne++,r=Re(),ne--,r===n?i=void 0:(X=i,i=n),i!==n?(e.length>X?(r=e.charAt(X),X++):(r=n,0===ne&&ce(D)),r!==n?(ee=t,t=r):(X=t,t=n)):(X=t,t=n)):(X=t,t=n)):(X=t,t=n))))),t}function Me(){var e,t,s,a,i,r;if(e=X,ee=X,(t=(t=J())?void 0:n)!==n){for(s=[],a=De();a!==n;)s.push(a),a=De();if((a=Re())!==n){for(i=[],r=De();r!==n;)i.push(r),r=De();ee=e,e=Z(s,a,i)}else X=e,e=n}else X=e,e=n;if(e===n)for(e=[],t=De();t!==n;)e.push(t),t=De();return e}function we(){var t,s;return t=X,"\\t"===e.substr(X,2)?(s="\\t",X+=2):(s=n,0===ne&&ce(P)),s!==n&&(ee=t,s="\t"),(t=s)===n&&(t=X,"\\r"===e.substr(X,2)?(s="\\r",X+=2):(s=n,0===ne&&ce(_)),s!==n&&(ee=t,s="\r"),(t=s)===n&&(t=X,"\\n"===e.substr(X,2)?(s="\\n",X+=2):(s=n,0===ne&&ce(B)),s!==n&&(ee=t,s="\n"),t=s)),t}function Fe(){var t;return g.test(e.charAt(X))?(t=e.charAt(X),X++):(t=n,0===ne&&ce(N)),t}function Ie(){var t,s,a;return t=X,92===e.charCodeAt(X)?(s=u,X++):(s=n,0===ne&&ce(F)),s!==n?(a=function(){var t,s,a,i,r,o,l,u,c;return t=X,117===e.charCodeAt(X)?(s="u",X++):(s=n,0===ne&&ce(z)),s!==n?(a=X,i=X,(r=Ae())!==n&&(o=Ae())!==n&&(l=Ae())!==n&&(u=Ae())!==n?i=r=[r,o,l,u]:(X=i,i=n),(a=i!==n?e.substring(a,X):i)!==n?(ee=t,c=a,t=String.fromCharCode(parseInt(c,16))):(X=t,t=n)):(X=t,t=n),t}(),a!==n?(ee=t,t=a):(X=t,t=n)):(X=t,t=n),t}function Ae(){var t;return j.test(e.charAt(X))?(t=e.charAt(X),X++):(t=n,0===ne&&ce(U)),t}function De(){var t;return ne++,x.test(e.charAt(X))?(t=e.charAt(X),X++):(t=n,0===ne&&ce(Y)),ne--,t===n&&0===ne&&ce(K),t}function Re(){var t,s;return t=X,ee=X,(J()?void 0:n)!==n?(e.substr(X,14)===c?(s=c,X+=14):(s=n,0===ne&&ce(Q)),s!==n?(ee=t,t=_e):(X=t,t=n)):(X=t,t=n),t}const{parseCursor:Pe,cursorSymbol:_e,allowLeadingWildcards:Be=!0,helpers:{nodeTypes:Ne}}=t,ze=Ne.function.buildNodeWithArgumentNodes,Ue=Ne.literal.buildNode,We=Ne.wildcard.buildNode,{wildcardSymbol:qe}=Ne.wildcard;if((s=o())!==n&&X===e.length)return s;throw s!==n&&X<e.length&&ce({type:"end"}),Ge=ae,$e=se<e.length?e.charAt(se):null,Ke=se<e.length?ue(se,se+1):ue(se,se),new a(a.buildMessage(Ge,$e),Ge,$e,Ke);var Ge,$e,Ke}}},function(e,t,s){var a=s(45),n=s(46),i=n;i.v1=a,i.v4=n,e.exports=i},function(e,t,s){var a,n,i=s(38),r=s(39),o=0,l=0;e.exports=function(e,t,s){var u=t&&s||0,c=t||[],d=(e=e||{}).node||a,p=void 0!==e.clockseq?e.clockseq:n;if(null==d||null==p){var g=i();null==d&&(d=a=[1|g[0],g[1],g[2],g[3],g[4],g[5]]),null==p&&(p=n=16383&(g[6]<<8|g[7]))}var j=void 0!==e.msecs?e.msecs:(new Date).getTime(),x=void 0!==e.nsecs?e.nsecs:l+1,b=j-o+(x-l)/1e4;if(b<0&&void 0===e.clockseq&&(p=p+1&16383),(b<0||j>o)&&void 0===e.nsecs&&(x=0),x>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");o=j,l=x,n=p;var f=(1e4*(268435455&(j+=122192928e5))+x)%4294967296;c[u++]=f>>>24&255,c[u++]=f>>>16&255,c[u++]=f>>>8&255,c[u++]=255&f;var m=j/4294967296*1e4&268435455;c[u++]=m>>>8&255,c[u++]=255&m,c[u++]=m>>>24&15|16,c[u++]=m>>>16&255,c[u++]=p>>>8|128,c[u++]=255&p;for(var h=0;h<6;++h)c[u+h]=d[h];return t||r(c)}},function(e,t,s){var a=s(38),n=s(39);e.exports=function(e,t,s){var i=t&&s||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var r=(e=e||{}).random||(e.rng||a)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t)for(var o=0;o<16;++o)t[i+o]=r[o];return t||n(r)}},function(e,t,s){switch(window.__kbnThemeTag__){case"v8dark":return s(48);case"v8light":return s(50)}},function(e,t,s){var a=s(34),n=s(49);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);a(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}},function(e,t,s){(t=s(35)(!1)).push([e.i,".upgResolveStep{margin-bottom:24px}\n",""]),e.exports=t},function(e,t,s){var a=s(34),n=s(51);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);a(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}},function(e,t,s){(t=s(35)(!1)).push([e.i,".upgResolveStep{margin-bottom:24px}\n",""]),e.exports=t},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pipeable=t.pipe=void 0;var a=s(40);t.pipe=a.pipe,t.pipeable=function(e){var t={};return function(e){return"function"==typeof e.map}(e)&&(t.map=function(t){return function(s){return e.map(s,t)}}),function(e){return"function"==typeof e.contramap}(e)&&(t.contramap=function(t){return function(s){return e.contramap(s,t)}}),function(e){return"function"==typeof e.mapWithIndex}(e)&&(t.mapWithIndex=function(t){return function(s){return e.mapWithIndex(s,t)}}),function(e){return"function"==typeof e.ap}(e)&&(t.ap=function(t){return function(s){return e.ap(s,t)}},t.apFirst=function(t){return function(s){return e.ap(e.map(s,(function(e){return function(){return e}})),t)}},t.apSecond=function(t){return function(s){return e.ap(e.map(s,(function(){return function(e){return e}})),t)}}),function(e){return"function"==typeof e.chain}(e)&&(t.chain=function(t){return function(s){return e.chain(s,t)}},t.chainFirst=function(t){return function(s){return e.chain(s,(function(s){return e.map(t(s),(function(){return s}))}))}},t.flatten=function(t){return e.chain(t,a.identity)}),function(e){return"function"==typeof e.bimap}(e)&&(t.bimap=function(t,s){return function(a){return e.bimap(a,t,s)}},t.mapLeft=function(t){return function(s){return e.mapLeft(s,t)}}),function(e){return"function"==typeof e.extend}(e)&&(t.extend=function(t){return function(s){return e.extend(s,t)}},t.duplicate=function(t){return e.extend(t,a.identity)}),function(e){return"function"==typeof e.reduce}(e)&&(t.reduce=function(t,s){return function(a){return e.reduce(a,t,s)}},t.foldMap=function(t){var s=e.foldMap(t);return function(e){return function(t){return s(t,e)}}},t.reduceRight=function(t,s){return function(a){return e.reduceRight(a,t,s)}}),function(e){return"function"==typeof e.reduceWithIndex}(e)&&(t.reduceWithIndex=function(t,s){return function(a){return e.reduceWithIndex(a,t,s)}},t.foldMapWithIndex=function(t){var s=e.foldMapWithIndex(t);return function(e){return function(t){return s(t,e)}}},t.reduceRightWithIndex=function(t,s){return function(a){return e.reduceRightWithIndex(a,t,s)}}),function(e){return"function"==typeof e.alt}(e)&&(t.alt=function(t){return function(s){return e.alt(s,t)}}),function(e){return"function"==typeof e.compact}(e)&&(t.compact=e.compact,t.separate=e.separate),function(e){return"function"==typeof e.filter}(e)&&(t.filter=function(t){return function(s){return e.filter(s,t)}},t.filterMap=function(t){return function(s){return e.filterMap(s,t)}},t.partition=function(t){return function(s){return e.partition(s,t)}},t.partitionMap=function(t){return function(s){return e.partitionMap(s,t)}}),function(e){return"function"==typeof e.filterWithIndex}(e)&&(t.filterWithIndex=function(t){return function(s){return e.filterWithIndex(s,t)}},t.filterMapWithIndex=function(t){return function(s){return e.filterMapWithIndex(s,t)}},t.partitionWithIndex=function(t){return function(s){return e.partitionWithIndex(s,t)}},t.partitionMapWithIndex=function(t){return function(s){return e.partitionMapWithIndex(s,t)}}),function(e){return"function"==typeof e.promap}(e)&&(t.promap=function(t,s){return function(a){return e.promap(a,t,s)}}),function(e){return"function"==typeof e.compose}(e)&&(t.compose=function(t){return function(s){return e.compose(s,t)}}),function(e){return"function"==typeof e.throwError}(e)&&(t.fromOption=function(t){return function(s){return"None"===s._tag?e.throwError(t()):e.of(s.value)}},t.fromEither=function(t){return"Left"===t._tag?e.throwError(t.left):e.of(t.right)},t.fromPredicate=function(t,s){return function(a){return t(a)?e.of(a):e.throwError(s(a))}},t.filterOrElse=function(t,s){return function(a){return e.chain(a,(function(a){return t(a)?e.of(a):e.throwError(s(a))}))}}),t}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.apS=t.apSW=t.bind=t.bindW=t.bindTo=t.exists=t.elem=t.toError=t.either=t.getValidationMonoid=t.MonadThrow=t.ChainRec=t.Extend=t.Alt=t.Bifunctor=t.Traversable=t.Foldable=t.Monad=t.Applicative=t.Functor=t.getValidationSemigroup=t.getValidation=t.getAltValidation=t.getApplicativeValidation=t.getWitherable=t.getFilterable=t.getApplyMonoid=t.getApplySemigroup=t.getSemigroup=t.getEq=t.getShow=t.URI=t.throwError=t.sequence=t.traverse=t.reduceRight=t.foldMap=t.reduce=t.duplicate=t.extend=t.alt=t.flatten=t.chainFirst=t.chainFirstW=t.chain=t.chainW=t.of=t.apSecond=t.apFirst=t.ap=t.apW=t.mapLeft=t.bimap=t.map=t.filterOrElse=t.orElse=t.swap=t.getOrElse=t.getOrElseW=t.fold=t.fromPredicate=t.fromOption=t.stringifyJSON=t.parseJSON=t.tryCatch=t.fromNullable=t.right=t.left=t.isRight=t.isLeft=void 0;var a=s(54),n=s(40);function i(e,s){try{return t.right(e())}catch(e){return t.left(s(e))}}t.isLeft=function(e){return"Left"===e._tag},t.isRight=function(e){return"Right"===e._tag},t.left=function(e){return{_tag:"Left",left:e}},t.right=function(e){return{_tag:"Right",right:e}},t.fromNullable=function(e){return function(s){return null==s?t.left(e):t.right(s)}},t.tryCatch=i,t.parseJSON=function(e,t){return i((function(){return JSON.parse(e)}),t)},t.stringifyJSON=function(e,t){return i((function(){return JSON.stringify(e)}),t)},t.fromOption=function(e){return function(s){return"None"===s._tag?t.left(e()):t.right(s.value)}},t.fromPredicate=function(e,s){return function(a){return e(a)?t.right(a):t.left(s(a))}},t.fold=function(e,s){return function(a){return t.isLeft(a)?e(a.left):s(a.right)}},t.getOrElseW=function(e){return function(s){return t.isLeft(s)?e(s.left):s.right}},t.getOrElse=t.getOrElseW,t.swap=function(e){return t.isLeft(e)?t.right(e.left):t.left(e.right)},t.orElse=function(e){return function(s){return t.isLeft(s)?e(s.left):s}},t.filterOrElse=function(e,s){return t.chain((function(a){return e(a)?t.right(a):t.left(s(a))}))};var r=function(e,s){return n.pipe(e,t.map(s))},o=function(e,s){return n.pipe(e,t.ap(s))},l=function(e,s){return n.pipe(e,t.chain(s))},u=function(e,s,a){return n.pipe(e,t.reduce(s,a))},c=function(e){return function(s,a){var i=t.foldMap(e);return n.pipe(s,i(a))}},d=function(e,s,a){return n.pipe(e,t.reduceRight(s,a))},p=function(e){var s=t.traverse(e);return function(e,t){return n.pipe(e,s(t))}},g=function(e,s,a){return n.pipe(e,t.bimap(s,a))},j=function(e,s){return n.pipe(e,t.mapLeft(s))},x=function(e,s){return n.pipe(e,t.alt(s))},b=function(e,s){return n.pipe(e,t.extend(s))},f=function(e,s){return a.tailRec(s(e),(function(e){return t.isLeft(e)?t.right(t.left(e.left)):t.isLeft(e.right)?t.left(s(e.right.left)):t.right(t.right(e.right.right))}))};function m(e){return{concat:function(s,a){return t.isLeft(s)?s:t.isLeft(a)?a:t.right(e.concat(s.right,a.right))}}}function h(e){var s=t.left(e.empty);return{URI:t.URI,_E:void 0,map:r,compact:function(e){return t.isLeft(e)?e:"None"===e.right._tag?s:t.right(e.right.value)},separate:function(e){return t.isLeft(e)?{left:e,right:e}:t.isLeft(e.right)?{left:t.right(e.right.left),right:s}:{left:s,right:t.right(e.right.right)}},filter:function(e,a){return t.isLeft(e)||a(e.right)?e:s},filterMap:function(e,a){if(t.isLeft(e))return e;var n=a(e.right);return"None"===n._tag?s:t.right(n.value)},partition:function(e,a){return t.isLeft(e)?{left:e,right:e}:a(e.right)?{left:s,right:t.right(e.right)}:{left:t.right(e.right),right:s}},partitionMap:function(e,a){if(t.isLeft(e))return{left:e,right:e};var n=a(e.right);return t.isLeft(n)?{left:t.right(n.left),right:s}:{left:s,right:t.right(n.right)}}}}function O(e){return{URI:t.URI,_E:void 0,map:r,ap:function(s,a){return t.isLeft(s)?t.isLeft(a)?t.left(e.concat(s.left,a.left)):s:t.isLeft(a)?a:t.right(s.right(a.right))},of:t.of}}function v(e){return{URI:t.URI,_E:void 0,map:r,alt:function(s,a){if(t.isRight(s))return s;var n=a();return t.isLeft(n)?t.left(e.concat(s.left,n.left)):n}}}function y(e,s){return{concat:function(a,n){return t.isLeft(a)?t.isLeft(n)?t.left(e.concat(a.left,n.left)):a:t.isLeft(n)?n:t.right(s.concat(a.right,n.right))}}}t.map=function(e){return function(s){return t.isLeft(s)?s:t.right(e(s.right))}},t.bimap=function(e,s){return function(a){return t.isLeft(a)?t.left(e(a.left)):t.right(s(a.right))}},t.mapLeft=function(e){return function(s){return t.isLeft(s)?t.left(e(s.left)):s}},t.apW=function(e){return function(s){return t.isLeft(s)?s:t.isLeft(e)?e:t.right(s.right(e.right))}},t.ap=t.apW,t.apFirst=function(e){return n.flow(t.map((function(e){return function(){return e}})),t.ap(e))},t.apSecond=function(e){return n.flow(t.map((function(){return function(e){return e}})),t.ap(e))},t.of=t.right,t.chainW=function(e){return function(s){return t.isLeft(s)?s:e(s.right)}},t.chain=t.chainW,t.chainFirstW=function(e){return function(s){return n.pipe(s,t.chainW((function(s){return n.pipe(e(s),t.map((function(){return s})))})))}},t.chainFirst=t.chainFirstW,t.flatten=t.chain(n.identity),t.alt=function(e){return function(s){return t.isLeft(s)?e():s}},t.extend=function(e){return function(s){return t.isLeft(s)?s:t.right(e(s))}},t.duplicate=t.extend(n.identity),t.reduce=function(e,s){return function(a){return t.isLeft(a)?e:s(e,a.right)}},t.foldMap=function(e){return function(s){return function(a){return t.isLeft(a)?e.empty:s(a.right)}}},t.reduceRight=function(e,s){return function(a){return t.isLeft(a)?e:s(a.right,e)}},t.traverse=function(e){return function(s){return function(a){return t.isLeft(a)?e.of(t.left(a.left)):e.map(s(a.right),t.right)}}},t.sequence=function(e){return function(s){return t.isLeft(s)?e.of(t.left(s.left)):e.map(s.right,t.right)}},t.throwError=t.left,t.URI="Either",t.getShow=function(e,s){return{show:function(a){return t.isLeft(a)?"left("+e.show(a.left)+")":"right("+s.show(a.right)+")"}}},t.getEq=function(e,s){return{equals:function(a,n){return a===n||(t.isLeft(a)?t.isLeft(n)&&e.equals(a.left,n.left):t.isRight(n)&&s.equals(a.right,n.right))}}},t.getSemigroup=function(e){return{concat:function(s,a){return t.isLeft(a)?s:t.isLeft(s)?a:t.right(e.concat(s.right,a.right))}}},t.getApplySemigroup=m,t.getApplyMonoid=function(e){return{concat:m(e).concat,empty:t.right(e.empty)}},t.getFilterable=h,t.getWitherable=function(e){var s=h(e);return{URI:t.URI,_E:void 0,map:r,compact:s.compact,separate:s.separate,filter:s.filter,filterMap:s.filterMap,partition:s.partition,partitionMap:s.partitionMap,traverse:p,sequence:t.sequence,reduce:u,foldMap:c,reduceRight:d,wither:function(e){var t=p(e);return function(a,n){return e.map(t(a,n),s.compact)}},wilt:function(e){var t=p(e);return function(a,n){return e.map(t(a,n),s.separate)}}}},t.getApplicativeValidation=O,t.getAltValidation=v,t.getValidation=function(e){var s=O(e),a=v(e);return{URI:t.URI,_E:void 0,map:r,of:t.of,chain:l,bimap:g,mapLeft:j,reduce:u,foldMap:c,reduceRight:d,extend:b,traverse:p,sequence:t.sequence,chainRec:f,throwError:t.throwError,ap:s.ap,alt:a.alt}},t.getValidationSemigroup=y,t.Functor={URI:t.URI,map:r},t.Applicative={URI:t.URI,map:r,ap:o,of:t.of},t.Monad={URI:t.URI,map:r,ap:o,of:t.of,chain:l},t.Foldable={URI:t.URI,reduce:u,foldMap:c,reduceRight:d},t.Traversable={URI:t.URI,map:r,reduce:u,foldMap:c,reduceRight:d,traverse:p,sequence:t.sequence},t.Bifunctor={URI:t.URI,bimap:g,mapLeft:j},t.Alt={URI:t.URI,map:r,alt:x},t.Extend={URI:t.URI,map:r,extend:b},t.ChainRec={URI:t.URI,map:r,ap:o,chain:l,chainRec:f},t.MonadThrow={URI:t.URI,map:r,ap:o,of:t.of,chain:l,throwError:t.throwError},t.getValidationMonoid=function(e,s){return{concat:y(e,s).concat,empty:t.right(s.empty)}},t.either={URI:t.URI,map:r,of:t.of,ap:o,chain:l,reduce:u,foldMap:c,reduceRight:d,traverse:p,sequence:t.sequence,bimap:g,mapLeft:j,alt:x,extend:b,chainRec:f,throwError:t.throwError},t.toError=function(e){return e instanceof Error?e:new Error(String(e))},t.elem=function(e){return function(s,a){return!t.isLeft(a)&&e.equals(s,a.right)}},t.exists=function(e){return function(s){return!t.isLeft(s)&&e(s.right)}},t.bindTo=function(e){return t.map(n.bindTo_(e))},t.bindW=function(e,s){return t.chainW((function(a){return n.pipe(s(a),t.map((function(t){return n.bind_(a,e,t)})))}))},t.bind=t.bindW,t.apSW=function(e,s){return n.flow(t.map((function(t){return function(s){return n.bind_(t,e,s)}})),t.apW(s))},t.apS=t.apSW},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tailRec=void 0,t.tailRec=function(e,t){for(var s=t(e);"Left"===s._tag;)s=t(s.left);return s.right}},function(e,t,s){switch(window.__kbnThemeTag__){case"v8dark":return s(56);case"v8light":return s(58)}},function(e,t,s){var a=s(34),n=s(57);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);a(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}},function(e,t,s){(t=s(35)(!1)).push([e.i,".upgStepProgress__step{display:flex;align-items:center;margin-top:16px;margin-bottom:8px;line-height:16px}.upgStepProgress__status{width:16px;height:16px;margin-right:12px}.upgStepProgress__status--circle{text-align:center;border-radius:12px;line-height:14px}.upgStepProgress__status--circle-failed{color:#f98982;background-color:#4a201e}.upgStepProgress__status--circle-complete{color:#97e5e0;background-color:#264341}.upgStepProgress__status--circle-paused{color:#f5dc8d;background-color:#493f22}.upgStepProgress__status--circle-cancelled{color:#f5dc8d;background-color:#493f22}.upgStepProgress__title--currentStep{font-weight:700}.upgStepProgress__content{display:block;margin-left:28px}\n",""]),e.exports=t},function(e,t,s){var a=s(34),n=s(59);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);a(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}},function(e,t,s){(t=s(35)(!1)).push([e.i,".upgStepProgress__step{display:flex;align-items:center;margin-top:16px;margin-bottom:8px;line-height:16px}.upgStepProgress__status{width:16px;height:16px;margin-right:12px}.upgStepProgress__status--circle{text-align:center;border-radius:12px;line-height:14px}.upgStepProgress__status--circle-failed{color:#bd271e;background-color:#f8e9e9}.upgStepProgress__status--circle-complete{color:#007e77;background-color:#e6f9f7}.upgStepProgress__status--circle-paused{color:#8a6a0a;background-color:#fff9e8}.upgStepProgress__status--circle-cancelled{color:#8a6a0a;background-color:#fff9e8}.upgStepProgress__title--currentStep{font-weight:700}.upgStepProgress__content{display:block;margin-left:28px}\n",""]),e.exports=t},function(e,t,s){e.exports=s(7)(15)},function(e,t,s){e.exports=s(7)(13)},function(e,t,s){e.exports=s(7)(4)},function(e,t,s){e.exports=s(7)(18)},function(e,t,s){e.exports=s(7)(2564)},function(e,t,s){e.exports=s(7)(2572)},function(e,t,s){switch(window.__kbnThemeTag__){case"v8dark":return s(67);case"v8light":return s(69)}},function(e,t,s){var a=s(34),n=s(68);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);a(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}},function(e,t,s){(t=s(35)(!1)).push([e.i,".upgToggleLoading>.upgLoadingItem{margin:6px}\n",""]),e.exports=t},function(e,t,s){var a=s(34),n=s(70);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);a(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}},function(e,t,s){(t=s(35)(!1)).push([e.i,".upgToggleLoading>.upgLoadingItem{margin:6px}\n",""]),e.exports=t},function(e,t,s){switch(window.__kbnThemeTag__){case"v8dark":return s(72);case"v8light":return s(74)}},function(e,t,s){var a=s(34),n=s(73);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);a(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}},function(e,t,s){(t=s(35)(!1)).push([e.i,".upgDeprecationIssuesPanel .euiCard__content{display:flex;flex-direction:column;justify-content:space-between}.upgDeprecationIssuesPanel__stat{height:60px;justify-content:space-between;flex-grow:1;flex-direction:column;display:flex}\n",""]),e.exports=t},function(e,t,s){var a=s(34),n=s(75);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);a(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}},function(e,t,s){(t=s(35)(!1)).push([e.i,".upgDeprecationIssuesPanel .euiCard__content{display:flex;flex-direction:column;justify-content:space-between}.upgDeprecationIssuesPanel__stat{height:60px;justify-content:space-between;flex-grow:1;flex-direction:column;display:flex}\n",""]),e.exports=t},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s(22);t.default=function(e,t){var s=a.useRef((function(){}));a.useEffect((function(){s.current=e})),a.useEffect((function(){if(null!==t){var e=setInterval((function(){return s.current()}),t||0);return function(){return clearInterval(e)}}}),[t])}},function(e,t,s){"use strict";s.r(t),s.d(t,"mountManagementSection",(function(){return Ca}));var a={};s.r(a),s.d(a,"buildNode",(function(){return _t})),s.d(a,"toElasticsearchQuery",(function(){return Bt}));var n={};s.r(n),s.d(n,"wildcardSymbol",(function(){return Nt})),s.d(n,"buildNode",(function(){return Wt})),s.d(n,"test",(function(){return qt})),s.d(n,"toElasticsearchQuery",(function(){return Gt})),s.d(n,"toQueryStringQuery",(function(){return $t})),s.d(n,"hasLeadingWildcard",(function(){return Kt}));var i={};s.r(i),s.d(i,"buildNodeParams",(function(){return Xt})),s.d(i,"toElasticsearchQuery",(function(){return es}));var r={};s.r(r),s.d(r,"buildNodeParams",(function(){return ts})),s.d(r,"toElasticsearchQuery",(function(){return ss}));var o={};s.r(o),s.d(o,"buildNodeParams",(function(){return as})),s.d(o,"toElasticsearchQuery",(function(){return ns}));var l={};s.r(l),s.d(l,"buildNodeParams",(function(){return is})),s.d(l,"toElasticsearchQuery",(function(){return rs}));var u={};s.r(u),s.d(u,"buildNodeParams",(function(){return os})),s.d(u,"toElasticsearchQuery",(function(){return ls}));var c={};s.r(c),s.d(c,"buildNodeParams",(function(){return us})),s.d(c,"toElasticsearchQuery",(function(){return cs}));var d={};s.r(d),s.d(d,"buildNodeParams",(function(){return ds})),s.d(d,"toElasticsearchQuery",(function(){return ps}));var p={};s.r(p),s.d(p,"buildNode",(function(){return js})),s.d(p,"buildNodeWithArgumentNodes",(function(){return xs})),s.d(p,"toElasticsearchQuery",(function(){return bs}));var g=s(22),j=s.n(g),x=s(30),b=s(28),f=s(26),m=s(24),h=s(0),O=s(5),v=s(23);const y=Object(g.createContext)(void 0),E=({children:e,value:t})=>Object(v.jsx)(y.Provider,{value:t},e),k=()=>{const e=Object(g.useContext)(y);if(!e)throw new Error("useAppContext must be called from inside AppContext");return e};var C=s(44),S=s.n(C),T=s(3),L=s(27),M=s(6);const w=e=>T.i18n.translate("xpack.upgradeAssistant.noDeprecationsPrompt.description",{defaultMessage:"Your {deprecationType} configuration is up to date",values:{deprecationType:e}}),F=e=>Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.noDeprecationsPrompt.nextStepsDescription",defaultMessage:"Check the {overviewButton} for other Stack deprecations.",values:{overviewButton:Object(v.jsx)(m.EuiLink,{onClick:e},T.i18n.translate("xpack.upgradeAssistant.noDeprecationsPrompt.overviewLinkText",{defaultMessage:"Overview page"}))}}),I=({deprecationType:e,navigateToOverviewPage:t})=>Object(v.jsx)(m.EuiEmptyPrompt,{iconType:"check","data-test-subj":"noDeprecationsPrompt",title:Object(v.jsx)("h2",null,w(e)),body:Object(v.jsx)(j.a.Fragment,null,Object(v.jsx)("p",{"data-test-subj":"upgradeAssistantIssueSummary"},F(t)))}),A={critical:T.i18n.translate("xpack.upgradeAssistant.levelInfoTip.criticalLabel",{defaultMessage:"Critical issues must be resolved before you upgrade"}),warning:T.i18n.translate("xpack.upgradeAssistant.levelInfoTip.warningLabel",{defaultMessage:"Warning issues can be ignored at your discretion"})},D=({level:e})=>Object(v.jsx)(m.EuiIconTip,{content:A[e],position:"top",type:"iInCircle"}),R=({totalCriticalDeprecations:e,totalWarningDeprecations:t})=>{return Object(v.jsx)(m.EuiFlexGroup,null,Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiHealth,{color:"danger","data-test-subj":"criticalDeprecationsCount"},(s=e,T.i18n.translate("xpack.upgradeAssistant.deprecationCount.criticalStatusLabel",{defaultMessage:"Critical: {count}",values:{count:s}})))),Object(v.jsx)(m.EuiFlexItem,null,Object(v.jsx)(D,{level:"critical"})))),Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiHealth,{color:"subdued","data-test-subj":"warningDeprecationsCount"},(e=>T.i18n.translate("xpack.upgradeAssistant.deprecationCount.warningStatusLabel",{defaultMessage:"Warning: {count}",values:{count:e}}))(t))),Object(v.jsx)(m.EuiFlexItem,null,Object(v.jsx)(D,{level:"warning"})))));var s},P={criticalBadgeLabel:T.i18n.translate("xpack.upgradeAssistant.deprecationBadge.criticalBadgeLabel",{defaultMessage:"Critical"}),resolvedBadgeLabel:T.i18n.translate("xpack.upgradeAssistant.deprecationBadge.resolvedBadgeLabel",{defaultMessage:"Resolved"}),warningBadgeLabel:T.i18n.translate("xpack.upgradeAssistant.deprecationBadge.warningBadgeLabel",{defaultMessage:"Warning"})},_=({isCritical:e,isResolved:t})=>t?Object(v.jsx)(m.EuiBadge,{color:"success","data-test-subj":"resolvedDeprecationBadge"},P.resolvedBadgeLabel):e?Object(v.jsx)(m.EuiBadge,{color:"danger","data-test-subj":"criticalDeprecationBadge"},P.criticalBadgeLabel):Object(v.jsx)(m.EuiBadge,{color:"default","data-test-subj":"warningDeprecationBadge"},P.warningBadgeLabel),B=({deprecationSource:e,message:t})=>Object(v.jsx)(m.EuiPageContent,{verticalPosition:"center",horizontalPosition:"center",color:"danger","data-test-subj":"deprecationsPageLoadingError"},Object(v.jsx)(m.EuiEmptyPrompt,{iconType:"alert",title:Object(v.jsx)("h2",null,T.i18n.translate("xpack.upgradeAssistant.deprecationsPageLoadingError.title",{defaultMessage:"Could not retrieve {deprecationSource} deprecation issues",values:{deprecationSource:e}})),body:t})),N=({documentationUrl:e})=>Object(v.jsx)(m.EuiLink,{target:"_blank","data-test-subj":"documentationLink",href:e},T.i18n.translate("xpack.upgradeAssistant.deprecationFlyout.learnMoreLinkLabel",{defaultMessage:"Learn more"})),z={cluster_settings:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.clusterDeprecationTypeLabel",{defaultMessage:"Cluster"}),index_settings:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.indexDeprecationTypeLabel",{defaultMessage:"Index"}),node_settings:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.nodeDeprecationTypeLabel",{defaultMessage:"Node"}),ml_settings:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.mlDeprecationTypeLabel",{defaultMessage:"Machine Learning"})},U={initialPageSize:50,pageSizeOptions:[50,100,200]},W={manualCellLabel:T.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.table.manualCellLabel",{defaultMessage:"Manual"}),manualCellTooltipLabel:T.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.table.manualCellTooltipLabel",{defaultMessage:"This issue needs to be resolved manually."}),automatedCellLabel:T.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.table.automatedCellLabel",{defaultMessage:"Automated"}),automationInProgressCellLabel:T.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.table.automationInProgressCellLabel",{defaultMessage:"Resolution in progress…"}),automationCompleteCellLabel:T.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.table.automationCompleteCellLabel",{defaultMessage:"Resolved"}),automationFailedCellLabel:T.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.table.automationFailedCellLabel",{defaultMessage:"Resolution failed"}),automatedCellTooltipLabel:T.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.table.automatedCellTooltipLabel",{defaultMessage:"This issue can be resolved automatically."})},q=({deprecationId:e,isAutomated:t,deprecationResolutionState:s})=>{if(t){if((null==s?void 0:s.id)===e){const{resolveDeprecationStatus:e}=s;switch(e){case"in_progress":return Object(v.jsx)(m.EuiFlexGroup,{gutterSize:"s",alignItems:"center","data-test-subj":"resolutionStatusCell"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiLoadingSpinner,{size:"m"})),Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiText,{size:"s"},W.automationInProgressCellLabel)));case"fail":return Object(v.jsx)(m.EuiFlexGroup,{gutterSize:"s",alignItems:"center","data-test-subj":"resolutionStatusCell"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiIcon,{type:"alert",color:"danger"})),Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiText,{size:"s"},W.automationFailedCellLabel)));default:return Object(v.jsx)(m.EuiFlexGroup,{gutterSize:"s",alignItems:"center","data-test-subj":"resolutionStatusCell"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiIcon,{type:"check",color:"success"})),Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiText,{size:"s"},W.automationCompleteCellLabel)))}}return Object(v.jsx)(m.EuiToolTip,{position:"top",content:W.automatedCellTooltipLabel},Object(v.jsx)(m.EuiFlexGroup,{gutterSize:"s",alignItems:"center","data-test-subj":"resolutionStatusCell"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiIcon,{type:"indexSettings"})),Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiText,{size:"s"},W.automatedCellLabel))))}return Object(v.jsx)(m.EuiToolTip,{position:"top",content:W.manualCellTooltipLabel,"data-test-subj":"resolutionStatusCell"},Object(v.jsx)(m.EuiText,{size:"s",color:"subdued"},W.manualCellLabel))},G={refreshButtonLabel:T.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.table.refreshButtonLabel",{defaultMessage:"Refresh"}),statusColumnTitle:T.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.table.statusColumnTitle",{defaultMessage:"Status"}),issueColumnTitle:T.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.table.issueColumnTitle",{defaultMessage:"Issue"}),typeColumnTitle:T.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.table.typeColumnTitle",{defaultMessage:"Type"}),resolutionColumnTitle:T.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.table.resolutionColumnTitle",{defaultMessage:"Resolution"}),configDeprecationTypeCellLabel:T.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.table.configDeprecationTypeCellLabel",{defaultMessage:"Config"}),featureDeprecationTypeCellLabel:T.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.table.featureDeprecationTypeCellLabel",{defaultMessage:"Feature"}),unknownDeprecationTypeCellLabel:T.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.table.unknownDeprecationTypeCellLabel",{defaultMessage:"Uncategorized"}),typeFilterLabel:T.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.table.typeFilterLabel",{defaultMessage:"Type"}),criticalFilterLabel:T.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.table.criticalFilterLabel",{defaultMessage:"Critical"}),searchPlaceholderLabel:T.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.table.searchPlaceholderLabel",{defaultMessage:"Filter"})},$=({deprecations:e,reload:t,toggleFlyout:s,deprecationResolutionState:a})=>{const n=[{field:"level",name:G.statusColumnTitle,width:"5%",truncateText:!0,sortable:!0,render:e=>Object(v.jsx)(_,{isCritical:"critical"===e})},{field:"title",width:"40%",name:G.issueColumnTitle,truncateText:!0,sortable:!0,render:(e,t)=>Object(v.jsx)(m.EuiLink,{onClick:()=>s(t),"data-test-subj":"deprecationDetailsLink"},e)},{field:"filterType",name:G.typeColumnTitle,width:"20%",truncateText:!0,sortable:!0,render:e=>{switch(e){case"config":return G.configDeprecationTypeCellLabel;case"feature":return G.featureDeprecationTypeCellLabel;default:return G.unknownDeprecationTypeCellLabel}}},{field:"correctiveActions",name:G.resolutionColumnTitle,width:"30%",truncateText:!0,sortable:!0,render:(e,t)=>Object(v.jsx)(q,{deprecationId:t.id,isAutomated:Boolean(null==e?void 0:e.api),deprecationResolutionState:a})}],i={filters:[{type:"field_value_toggle",name:G.criticalFilterLabel,field:"level",value:"critical"},{type:"field_value_selection",field:"filterType",name:G.typeFilterLabel,multiSelect:!1,options:[{value:"config",name:G.configDeprecationTypeCellLabel},{value:"feature",name:G.featureDeprecationTypeCellLabel},{value:"uncategorized",name:G.unknownDeprecationTypeCellLabel}]}],box:{incremental:!0,placeholder:G.searchPlaceholderLabel},toolsRight:[Object(v.jsx)(m.EuiButton,{iconType:"refresh",onClick:t,"data-test-subj":"refreshButton",key:"refreshButton"},G.refreshButtonLabel)]};return Object(v.jsx)(m.EuiInMemoryTable,{items:e||[],itemId:"name",columns:n,search:i,sorting:{sort:{field:"level",direction:"asc"}},pagination:U,rowProps:()=>({"data-test-subj":"row"}),cellProps:(e,t)=>({"data-test-subj":`${((null==t?void 0:t.name)||"table").toLowerCase()}Cell`}),"data-test-subj":"kibanaDeprecationsTable",tableLayout:"auto"})};s(47);const K={closeButtonLabel:T.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.flyout.closeButtonLabel",{defaultMessage:"Close"}),quickResolveButtonLabel:T.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.flyout.quickResolveButtonLabel",{defaultMessage:"Quick resolve"}),retryQuickResolveButtonLabel:T.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.flyout.retryQuickResolveButtonLabel",{defaultMessage:"Try again"}),resolvedButtonLabel:T.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.flyout.resolvedButtonLabel",{defaultMessage:"Resolved"}),quickResolveInProgressButtonLabel:T.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.flyout.quickResolveInProgressButtonLabel",{defaultMessage:"Resolution in progress…"}),quickResolveCalloutTitle:Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.kibanaDeprecations.flyout.quickResolveCalloutTitle",defaultMessage:"Click {quickResolve} to fix this issue automatically.",values:{quickResolve:Object(v.jsx)("strong",null,T.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.flyout.quickResolveText",{defaultMessage:"Quick resolve"}))}}),quickResolveErrorTitle:T.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.flyout.quickResolveErrorTitle",{defaultMessage:"Error resolving issue"}),manualFixTitle:T.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.flyout.manualFixTitle",{defaultMessage:"How to fix"})},Y=({deprecation:e,closeFlyout:t,resolveDeprecation:s,deprecationResolutionState:a})=>{const{documentationUrl:n,message:i,correctiveActions:r,title:o}=e,l=(null==a?void 0:a.id)===e.id&&"ok"===(null==a?void 0:a.resolveDeprecationStatus),u=Object(g.useCallback)((()=>{M.s.trackUiMetric(L.METRIC_TYPE.CLICK,M.i),s(e)}),[e,s]);return Object(v.jsx)(j.a.Fragment,null,Object(v.jsx)(m.EuiFlyoutHeader,{hasBorder:!0},Object(v.jsx)(_,{isCritical:"critical"===e.level,isResolved:l}),Object(v.jsx)(m.EuiSpacer,{size:"s"}),Object(v.jsx)(m.EuiTitle,{size:"s","data-test-subj":"flyoutTitle"},Object(v.jsx)("h2",{id:"kibanaDeprecationDetailsFlyoutTitle",className:"eui-textBreakWord"},o))),Object(v.jsx)(m.EuiFlyoutBody,null,"fail"===(null==a?void 0:a.resolveDeprecationStatus)&&Object(v.jsx)(j.a.Fragment,null,Object(v.jsx)(m.EuiCallOut,{title:K.quickResolveErrorTitle,color:"danger",iconType:"alert","data-test-subj":"quickResolveError"},a.resolveDeprecationError),Object(v.jsx)(m.EuiSpacer,null)),Object(v.jsx)(m.EuiText,null,Object(v.jsx)("p",{className:"eui-textBreakWord"},i),n&&Object(v.jsx)("p",null,Object(v.jsx)(N,{documentationUrl:n}))),Object(v.jsx)(m.EuiSpacer,null),!l&&Object(v.jsx)("div",{"data-test-subj":"resolveSection"},r.api&&Object(v.jsx)(j.a.Fragment,null,Object(v.jsx)(m.EuiCallOut,{title:K.quickResolveCalloutTitle,color:"primary",iconType:"iInCircle","data-test-subj":"quickResolveCallout"}),Object(v.jsx)(m.EuiSpacer,null)),r.manualSteps.length>0&&Object(v.jsx)(j.a.Fragment,null,Object(v.jsx)(m.EuiTitle,{size:"s","data-test-subj":"manualStepsTitle"},Object(v.jsx)("h3",null,K.manualFixTitle)),Object(v.jsx)(m.EuiSpacer,{size:"s"}),Object(v.jsx)(m.EuiText,null,1===r.manualSteps.length?Object(v.jsx)("p",{"data-test-subj":"manualStep",className:"eui-textBreakWord"},r.manualSteps[0]):Object(v.jsx)("ol",{"data-test-subj":"manualStepsList"},r.manualSteps.map(((e,t)=>Object(v.jsx)("li",{"data-test-subj":"manualStepsListItem",key:`step-${t}`,className:"upgResolveStep eui-textBreakWord"},e)))))))),Object(v.jsx)(m.EuiFlyoutFooter,null,Object(v.jsx)(m.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiButtonEmpty,{onClick:t,flush:"left"},K.closeButtonLabel)),r.api&&!l&&Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiButton,{fill:!0,"data-test-subj":"resolveButton",onClick:u,isLoading:Boolean("in_progress"===(null==a?void 0:a.resolveDeprecationStatus))},(e=>"in_progress"===(null==e?void 0:e.resolveDeprecationStatus)?K.quickResolveInProgressButtonLabel:"ok"===(null==e?void 0:e.resolveDeprecationStatus)?K.resolvedButtonLabel:null!=e&&e.resolveDeprecationError?K.retryQuickResolveButtonLabel:K.quickResolveButtonLabel)(a))))))},{useGlobalFlyout:Q}=O.c,V={pageTitle:T.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.pageTitle",{defaultMessage:"Kibana deprecation issues"}),pageDescription:T.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.pageDescription",{defaultMessage:"Resolve all critical issues before upgrading."}),docLinkText:T.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.docLinkText",{defaultMessage:"Documentation"}),deprecationLabel:T.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.deprecationLabel",{defaultMessage:"Kibana"}),isLoading:T.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.loadingText",{defaultMessage:"Loading deprecation issues…"}),kibanaDeprecationErrorTitle:T.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.kibanaDeprecationErrorTitle",{defaultMessage:"List of deprecation issues might be incomplete"}),getKibanaDeprecationErrorDescription:e=>T.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.kibanaDeprecationErrorDescription",{defaultMessage:"Failed to get deprecation issues for {pluginCount, plural, one {this plugin} other {these plugins}}: {pluginIds}. Check the Kibana server logs for more information.",values:{pluginCount:e.length,pluginIds:e.join(", ")}})},H=Object(b.withRouter)((({history:e})=>{const[t,s]=Object(g.useState)(void 0),[a,n]=Object(g.useState)([]),[i,r]=Object(g.useState)(!1),[o,l]=Object(g.useState)(void 0),[u,c]=Object(g.useState)(void 0),[d,p]=Object(g.useState)(void 0),{services:{core:{deprecations:x},breadcrumbs:b}}=k(),{addContent:f,removeContent:h}=Q(),y=Object(g.useCallback)((async()=>{r(!0);try{const e=await x.getAllDeprecations(),t=[],a=[];e.forEach((e=>{var s;"fetch_error"!==e.level?t.push({...e,id:S.a.v4(),filterType:null!==(s=e.deprecationType)&&void 0!==s?s:"uncategorized"}):!1===a.includes(e.domainId)&&a.push(e.domainId)})),s(t),n(a)}catch(e){l(e)}r(!1)}),[x]),E=Object(g.useMemo)((()=>(e=>{const t=[],s=[];return e.forEach((e=>{"critical"!==e.level?s.push(e):t.push(e)})),{criticalDeprecations:t.length,warningDeprecations:s.length}})(t||[])),[t]),C=e=>{c(e)},T=Object(g.useCallback)((()=>{C(),h("deprecationDetails")}),[h]),w=Object(g.useCallback)((async e=>{p({id:e.id,resolveDeprecationStatus:"in_progress"});const t=await x.resolveDeprecation(e);p({id:e.id,resolveDeprecationStatus:t.status,resolveDeprecationError:"fail"===t.status?t.reason:void 0}),T()}),[T,x]);return Object(g.useEffect)((()=>{u&&f({id:"deprecationDetails",Component:Y,props:{deprecation:u,closeFlyout:T,resolveDeprecation:w,deprecationResolutionState:d&&u.id===d.id?d:void 0},flyoutProps:{onClose:T,"data-test-subj":"kibanaDeprecationDetails","aria-labelledby":"kibanaDeprecationDetailsFlyoutTitle"}})}),[f,T,d,u,w]),Object(g.useEffect)((()=>{M.s.trackUiMetric(L.METRIC_TYPE.LOADED,M.h)}),[]),Object(g.useEffect)((()=>{b.setBreadcrumbs("kibanaDeprecations")}),[b]),Object(g.useEffect)((()=>{y()}),[x,y]),o?Object(v.jsx)(B,{deprecationSource:"Kibana"}):i?Object(v.jsx)(m.EuiPageContent,{verticalPosition:"center",horizontalPosition:"center",color:"subdued"},Object(v.jsx)(O.g,null,V.isLoading)):0===(null==t?void 0:t.length)?Object(v.jsx)(m.EuiPageContent,{verticalPosition:"center",horizontalPosition:"center",color:"subdued"},Object(v.jsx)(I,{deprecationType:V.deprecationLabel,navigateToOverviewPage:()=>e.push("/overview")})):Object(v.jsx)("div",{"data-test-subj":"kibanaDeprecations"},Object(v.jsx)(m.EuiPageHeader,{bottomBorder:!0,pageTitle:V.pageTitle,description:V.pageDescription},Object(v.jsx)(R,{totalCriticalDeprecations:E.criticalDeprecations,totalWarningDeprecations:E.warningDeprecations})),Object(v.jsx)(m.EuiSpacer,{size:"l"}),a.length>0&&Object(v.jsx)(j.a.Fragment,null,Object(v.jsx)(m.EuiCallOut,{title:V.kibanaDeprecationErrorTitle,color:"warning",iconType:"alert","data-test-subj":"kibanaDeprecationErrors"},Object(v.jsx)("p",null,V.getKibanaDeprecationErrorDescription(a))),Object(v.jsx)(m.EuiSpacer,null)),Object(v.jsx)($,{deprecations:t,reload:y,toggleFlyout:C,deprecationResolutionState:d}))})),J={permissionsError:T.i18n.translate("xpack.upgradeAssistant.esDeprecationErrors.permissionsErrorMessage",{defaultMessage:"You are not authorized to view Elasticsearch deprecation issues."}),partiallyUpgradedWarning:T.i18n.translate("xpack.upgradeAssistant.esDeprecationErrors.partiallyUpgradedWarningMessage",{defaultMessage:"Upgrade Kibana to the same version as your Elasticsearch cluster. One or more nodes in the cluster is running a different version than Kibana."}),upgradedMessage:T.i18n.translate("xpack.upgradeAssistant.esDeprecationErrors.upgradedWarningMessage",{defaultMessage:"All Elasticsearch nodes have been upgraded."}),loadingError:T.i18n.translate("xpack.upgradeAssistant.esDeprecationErrors.loadingErrorMessage",{defaultMessage:"Could not retrieve Elasticsearch deprecation issues."})},Z=e=>{var t,s;return 403===e.statusCode?{code:"unauthorized_error",message:J.permissionsError}:426===(null==e?void 0:e.statusCode)&&!1===(null===(t=e.attributes)||void 0===t?void 0:t.allNodesUpgraded)?{code:"partially_upgraded_error",message:J.partiallyUpgradedWarning}:426===(null==e?void 0:e.statusCode)&&!0===(null===(s=e.attributes)||void 0===s?void 0:s.allNodesUpgraded)?{code:"upgraded_error",message:J.upgradedMessage}:{code:"request_error",message:J.loadingError}};var X=s(25),ee=s.n(X);const te={manualCellLabel:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.defaultDeprecation.manualCellLabel",{defaultMessage:"Manual"}),manualCellTooltipLabel:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.reindex.manualCellTooltipLabel",{defaultMessage:"This issue needs to be resolved manually."})},se=({resolutionTableCell:e,fieldName:t,deprecation:s,openFlyout:a})=>{var n,i,r;return"isCritical"===t?Object(v.jsx)(_,{isCritical:s.isCritical}):"message"===t?Object(v.jsx)(m.EuiLink,{"data-test-subj":`deprecation-${null!==(i=null===(r=s.correctiveAction)||void 0===r?void 0:r.type)&&void 0!==i?i:"default"}`,onClick:a},s.message):"type"===t?Object(v.jsx)(j.a.Fragment,null,z[s.type]):"correctiveAction"===t?e?Object(v.jsx)(j.a.Fragment,null,e):Object(v.jsx)(m.EuiToolTip,{position:"top",content:te.manualCellTooltipLabel},Object(v.jsx)(m.EuiText,{size:"s",color:"subdued"},te.manualCellLabel)):Object(v.jsx)(j.a.Fragment,null,null!==(n=s[t])&&void 0!==n?n:"")},ae=Object(g.createContext)(void 0),ne=()=>{const e=Object(g.useContext)(ae);if(void 0===e)throw new Error("useMlSnapshotContext must be used within a <MlSnapshotsStatusProvider />");return e},ie=({api:e,snapshotId:t,jobId:s,mlUpgradeModeEnabled:a,children:n})=>{const{updateSnapshotStatus:i,snapshotState:r,upgradeSnapshot:o,deleteSnapshot:l}=(({jobId:e,snapshotId:t,api:s})=>{const[a,n]=Object(g.useState)(void 0),[i,r]=Object(g.useState)({status:"idle",jobId:e,snapshotId:t}),o=Object(g.useRef)(null),l=Object(g.useRef)(!1),u=Object(g.useCallback)((()=>{o.current&&(clearTimeout(o.current),o.current=null)}),[]),c=Object(g.useCallback)((async()=>{u();const{data:a,error:i}=await s.getMlSnapshotUpgradeStatus({jobId:e,snapshotId:t});if(i)return r({snapshotId:t,jobId:e,action:"upgrade",status:"error"}),void n(i);r({...a,action:"upgrade"}),"in_progress"===(null==a?void 0:a.status)&&(o.current=setTimeout(c,1e3))}),[s,u,e,t]),d=Object(g.useCallback)((async()=>{r({snapshotId:t,jobId:e,action:"upgrade",status:"in_progress"});const{data:a,error:i}=await s.upgradeMlSnapshot({jobId:e,snapshotId:t});if(i)return n(i),void r({snapshotId:t,jobId:e,action:"upgrade",status:"error"});r({...a,action:"upgrade"}),c()}),[s,e,t,c]),p=Object(g.useCallback)((async()=>{r({snapshotId:t,jobId:e,action:"delete",status:"in_progress"});const{error:a}=await s.deleteMlSnapshot({snapshotId:t,jobId:e});if(a)return n(a),void r({snapshotId:t,jobId:e,action:"delete",status:"error"});r({snapshotId:t,jobId:e,action:"delete",status:"complete"})}),[s,e,t]);return Object(g.useEffect)((()=>(l.current=!0,()=>{l.current=!1,u()})),[u]),{snapshotState:{...i,error:a},upgradeSnapshot:d,updateSnapshotStatus:c,deleteSnapshot:p}})({jobId:s,snapshotId:t,api:e});return Object(g.useEffect)((()=>{i()}),[i]),Object(v.jsx)(ae.Provider,{value:{snapshotState:r,upgradeSnapshot:o,deleteSnapshot:l,mlUpgradeModeEnabled:a}},n)},re={upgradeInProgressText:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.mlSnapshots.upgradeInProgressText",{defaultMessage:"Upgrade in progress…"}),deleteInProgressText:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.mlSnapshots.deletingButtonLabel",{defaultMessage:"Deletion in progress…"}),upgradeCompleteText:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.mlSnapshots.upgradeCompleteText",{defaultMessage:"Upgrade complete"}),deleteCompleteText:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.mlSnapshots.deleteCompleteText",{defaultMessage:"Deletion complete"}),upgradeFailedText:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.mlSnapshots.upgradeFailedText",{defaultMessage:"Upgrade failed"}),deleteFailedText:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.mlSnapshots.deleteFailedText",{defaultMessage:"Deletion failed"}),resolutionText:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.mlSnapshots.resolutionText",{defaultMessage:"Upgrade or delete snapshots"}),resolutionTooltipLabel:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.mlSnapshots.resolutionTooltipLabel",{defaultMessage:"Resolve this issue by upgrading or deleting a job model snapshot. This issue can be resolved automatically."})},oe=()=>{const{snapshotState:e}=ne();return"in_progress"===e.status?Object(v.jsx)(m.EuiFlexGroup,{gutterSize:"s",alignItems:"center","data-test-subj":"mlActionResolutionCell"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiLoadingSpinner,{size:"m"})),Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiText,{size:"s"},"delete"===e.action?re.deleteInProgressText:re.upgradeInProgressText))):"complete"===e.status?Object(v.jsx)(m.EuiFlexGroup,{gutterSize:"s",alignItems:"center","data-test-subj":"mlActionResolutionCell"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiIcon,{type:"check",color:"success"})),Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiText,{size:"s"},"delete"===e.action?re.deleteCompleteText:re.upgradeCompleteText))):"error"===e.status?Object(v.jsx)(m.EuiFlexGroup,{gutterSize:"s",alignItems:"center","data-test-subj":"mlActionResolutionCell"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiIcon,{type:"alert",color:"danger"})),Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiText,{size:"s"},"delete"===e.action?re.deleteFailedText:re.upgradeFailedText))):Object(v.jsx)(m.EuiToolTip,{position:"top",content:re.resolutionTooltipLabel},Object(v.jsx)(m.EuiFlexGroup,{gutterSize:"s",alignItems:"center","data-test-subj":"mlActionResolutionCell"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiIcon,{type:"indexSettings"})),Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiText,{size:"s"},re.resolutionText))))},le={upgradeButtonLabel:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.mlSnapshots.flyout.upgradeButtonLabel",{defaultMessage:"Upgrade"}),upgradingButtonLabel:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.mlSnapshots.flyout.upgradingButtonLabel",{defaultMessage:"Upgrading…"}),retryUpgradeButtonLabel:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.mlSnapshots.flyout.retryUpgradeButtonLabel",{defaultMessage:"Retry upgrade"}),closeButtonLabel:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.mlSnapshots.flyout.closeButtonLabel",{defaultMessage:"Close"}),deleteButtonLabel:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.mlSnapshots.flyout.deleteButtonLabel",{defaultMessage:"Delete"}),deletingButtonLabel:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.mlSnapshots.flyout.deletingButtonLabel",{defaultMessage:"Deleting…"}),retryDeleteButtonLabel:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.mlSnapshots.flyout.retryDeleteButtonLabel",{defaultMessage:"Retry delete"}),flyoutTitle:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.mlSnapshots.flyout.title",{defaultMessage:"Upgrade or delete model snapshot"}),deleteSnapshotErrorTitle:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.mlSnapshots.flyout.deleteSnapshotErrorTitle",{defaultMessage:"Error deleting snapshot"}),upgradeSnapshotErrorTitle:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.mlSnapshots.flyout.upgradeSnapshotErrorTitle",{defaultMessage:"Error upgrading snapshot"}),upgradeModeEnabledErrorTitle:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.mlSnapshots.upgradeModeEnabledErrorTitle",{defaultMessage:"Machine Learning upgrade mode is enabled"}),upgradeModeEnabledErrorDescription:e=>Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.esDeprecations.mlSnapshots.upgradeModeEnabledErrorDescription",defaultMessage:"No actions can be taken on Machine Learning snapshots while upgrade mode is enabled. {docsLink}.",values:{docsLink:Object(v.jsx)(m.EuiLink,{href:e,target:"_blank","data-test-subj":"setUpgradeModeDocsLink"},Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.esDeprecations.mlSnapshots.upgradeModeEnabledDocsLink",defaultMessage:"Learn more"}))}})},ue=({deprecation:e,closeFlyout:t,snapshotState:s,upgradeSnapshot:a,deleteSnapshot:n,mlUpgradeModeEnabled:i})=>{const{services:{core:{docLinks:r}}}=k(),o="complete"===s.status;return Object(v.jsx)(j.a.Fragment,null,Object(v.jsx)(m.EuiFlyoutHeader,{hasBorder:!0},Object(v.jsx)(_,{isCritical:e.isCritical,isResolved:o}),Object(v.jsx)(m.EuiSpacer,{size:"s"}),Object(v.jsx)(m.EuiTitle,{size:"s","data-test-subj":"flyoutTitle"},Object(v.jsx)("h2",{id:"mlSnapshotDetailsFlyoutTitle"},le.flyoutTitle))),Object(v.jsx)(m.EuiFlyoutBody,null,s.error&&!o&&Object(v.jsx)(j.a.Fragment,null,Object(v.jsx)(m.EuiCallOut,{title:"delete"===s.action?le.deleteSnapshotErrorTitle:le.upgradeSnapshotErrorTitle,color:"danger",iconType:"alert","data-test-subj":"resolveSnapshotError"},s.error.message),Object(v.jsx)(m.EuiSpacer,null)),i&&Object(v.jsx)(j.a.Fragment,null,Object(v.jsx)(m.EuiCallOut,{title:le.upgradeModeEnabledErrorTitle,color:"warning",iconType:"alert","data-test-subj":"mlUpgradeModeEnabledError"},Object(v.jsx)("p",null,le.upgradeModeEnabledErrorDescription(r.links.ml.setUpgradeMode))),Object(v.jsx)(m.EuiSpacer,null)),Object(v.jsx)(m.EuiText,null,Object(v.jsx)("p",null,e.details),Object(v.jsx)("p",null,Object(v.jsx)(N,{documentationUrl:e.url})))),Object(v.jsx)(m.EuiFlyoutFooter,null,Object(v.jsx)(m.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiButtonEmpty,{onClick:t,flush:"left"},le.closeButtonLabel)),!o&&!i&&Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiFlexGroup,null,Object(v.jsx)(m.EuiFlexItem,null,Object(v.jsx)(m.EuiButtonEmpty,{"data-test-subj":"deleteSnapshotButton",color:"danger",onClick:()=>{M.s.trackUiMetric(L.METRIC_TYPE.CLICK,M.j),n(),t()},isLoading:"delete"===s.action&&"in_progress"===s.status,isDisabled:"in_progress"===s.status},(e=>"delete"===e.action?e.error?le.retryDeleteButtonLabel:"in_progress"===e.status?le.deletingButtonLabel:le.deleteButtonLabel:le.deleteButtonLabel)(s))),Object(v.jsx)(m.EuiFlexItem,null,Object(v.jsx)(m.EuiButton,{fill:!0,onClick:()=>{M.s.trackUiMetric(L.METRIC_TYPE.CLICK,M.k),a(),t()},isLoading:"upgrade"===s.action&&"in_progress"===s.status,isDisabled:"in_progress"===s.status,"data-test-subj":"upgradeSnapshotButton"},(e=>"upgrade"===e.action?e.error?le.retryUpgradeButtonLabel:"in_progress"===e.status?le.upgradingButtonLabel:le.upgradeButtonLabel:le.upgradeButtonLabel)(s))))))))},{useGlobalFlyout:ce}=O.c,de=({rowFieldNames:e,deprecation:t})=>{const[s,a]=Object(g.useState)(!1),n=ne(),{addContent:i,removeContent:r}=ce(),o=Object(g.useCallback)((()=>{a(!1),r("mlFlyout")}),[r]);return Object(g.useEffect)((()=>{s&&i({id:"mlFlyout",Component:ue,props:{deprecation:t,closeFlyout:o,...n},flyoutProps:{onClose:o,className:"eui-textBreakWord","data-test-subj":"mlSnapshotDetails","aria-labelledby":"mlSnapshotDetailsFlyoutTitle"}})}),[n,i,s,t,o]),Object(v.jsx)(j.a.Fragment,null,e.map((e=>Object(v.jsx)(m.EuiTableRowCell,{key:e,truncateText:!1,"data-test-subj":`mlTableCell-${e}`},Object(v.jsx)(se,{fieldName:e,openFlyout:()=>a(!0),deprecation:t,resolutionTableCell:Object(v.jsx)(oe,null)})))))},pe=e=>{const{services:{api:t}}=k();return Object(v.jsx)(ie,{snapshotId:e.deprecation.correctiveAction.snapshotId,jobId:e.deprecation.correctiveAction.jobId,mlUpgradeModeEnabled:e.mlUpgradeModeEnabled,api:t},Object(v.jsx)(de,e))},ge={deleteInProgressText:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.indexSettings.deletingButtonLabel",{defaultMessage:"Settings removal in progress…"}),deleteCompleteText:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.indexSettings.deleteCompleteText",{defaultMessage:"Deprecated settings removed"}),deleteFailedText:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.indexSettings.deleteFailedText",{defaultMessage:"Settings removal failed"}),resolutionText:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.indexSettings.resolutionText",{defaultMessage:"Remove settings"}),resolutionTooltipLabel:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.indexSettings.resolutionTooltipLabel",{defaultMessage:"Resolve this issue by removing settings from this index. This issue can be resolved automatically."})},je=({status:e})=>{const{statusType:t}=e;return"in_progress"===t?Object(v.jsx)(m.EuiFlexGroup,{gutterSize:"s",alignItems:"center","data-test-subj":"indexSettingsResolutionStatusCell"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiLoadingSpinner,{size:"m"})),Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiText,{size:"s"},ge.deleteInProgressText))):"complete"===t?Object(v.jsx)(m.EuiFlexGroup,{gutterSize:"s",alignItems:"center","data-test-subj":"indexSettingsResolutionStatusCell"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiIcon,{type:"check",color:"success"})),Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiText,{size:"s"},ge.deleteCompleteText))):"error"===t?Object(v.jsx)(m.EuiFlexGroup,{gutterSize:"s",alignItems:"center","data-test-subj":"indexSettingsResolutionStatusCell"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiIcon,{type:"alert",color:"danger"})),Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiText,{size:"s"},ge.deleteFailedText))):Object(v.jsx)(m.EuiToolTip,{position:"top",content:ge.resolutionTooltipLabel},Object(v.jsx)(m.EuiFlexGroup,{gutterSize:"s",alignItems:"center","data-test-subj":"indexSettingsResolutionStatusCell"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiIcon,{type:"indexSettings"})),Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiText,{size:"s"},ge.resolutionText))))},xe={getFlyoutDescription:e=>T.i18n.translate("xpack.upgradeAssistant.esDeprecations.removeSettingsFlyout.secondaryDescription",{defaultMessage:"Index: {indexName}",values:{indexName:e}}),removeButtonLabel:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.removeSettingsFlyout.removeButtonLabel",{defaultMessage:"Remove deprecated settings"}),retryRemoveButtonLabel:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.removeSettingsFlyout.retryRemoveButtonLabel",{defaultMessage:"Retry removing deprecated settings"}),resolvedButtonLabel:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.removeSettingsFlyout.resolvedButtonLabel",{defaultMessage:"Resolved"}),closeButtonLabel:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.removeSettingsFlyout.closeButtonLabel",{defaultMessage:"Close"}),getConfirmationText:e=>T.i18n.translate("xpack.upgradeAssistant.esDeprecations.removeSettingsFlyout.description",{defaultMessage:"Remove the following deprecated index {indexSettingsCount, plural, one {setting} other {settings}}?",values:{indexSettingsCount:e}}),errorTitle:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.removeSettingsFlyout.deleteErrorTitle",{defaultMessage:"Error deleting index settings"})},be=({deprecation:e,closeFlyout:t,removeIndexSettings:s,status:a})=>{const{index:n,message:i,details:r,url:o,correctiveAction:l}=e,{statusType:u,details:c}=a,d=["idle","error"].includes(u),p=Object(g.useCallback)((()=>{M.s.trackUiMetric(L.METRIC_TYPE.CLICK,M.g),s(n,l.deprecatedSettings)}),[l,n,s]);return Object(v.jsx)(j.a.Fragment,null,Object(v.jsx)(m.EuiFlyoutHeader,{hasBorder:!0},Object(v.jsx)(_,{isCritical:e.isCritical,isResolved:"complete"===u}),Object(v.jsx)(m.EuiSpacer,{size:"s"}),Object(v.jsx)(m.EuiTitle,{size:"s","data-test-subj":"flyoutTitle"},Object(v.jsx)("h2",{id:"indexSettingsDetailsFlyoutTitle"},i)),Object(v.jsx)(m.EuiText,null,Object(v.jsx)("p",null,Object(v.jsx)(m.EuiTextColor,{color:"subdued"},xe.getFlyoutDescription(n))))),Object(v.jsx)(m.EuiFlyoutBody,null,"error"===u&&Object(v.jsx)(j.a.Fragment,null,Object(v.jsx)(m.EuiCallOut,{title:xe.errorTitle,color:"danger",iconType:"alert","data-test-subj":"deleteSettingsError"},c.message),Object(v.jsx)(m.EuiSpacer,null)),Object(v.jsx)(m.EuiText,null,Object(v.jsx)("p",null,r),Object(v.jsx)("p",null,Object(v.jsx)(N,{documentationUrl:o}))),d&&Object(v.jsx)("div",{"data-test-subj":"removeSettingsPrompt"},Object(v.jsx)(m.EuiSpacer,null),Object(v.jsx)(m.EuiTitle,{size:"xs"},Object(v.jsx)("h3",null,xe.getConfirmationText(l.deprecatedSettings.length))),Object(v.jsx)(m.EuiSpacer,null),Object(v.jsx)(m.EuiText,null,Object(v.jsx)("ul",null,l.deprecatedSettings.map(((e,t)=>Object(v.jsx)("li",{key:`${e}-${t}`},Object(v.jsx)(m.EuiCode,null,e)))))))),Object(v.jsx)(m.EuiFlyoutFooter,null,Object(v.jsx)(m.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiButtonEmpty,{onClick:t,flush:"left"},xe.closeButtonLabel)),d&&Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiButton,{fill:!0,"data-test-subj":"deleteSettingsButton",color:"danger",onClick:p},"error"===u?xe.retryRemoveButtonLabel:xe.removeButtonLabel)))))},{useGlobalFlyout:fe}=O.c,me=({rowFieldNames:e,deprecation:t})=>{const[s,a]=Object(g.useState)(!1),[n,i]=Object(g.useState)({statusType:"idle"}),{services:{api:r}}=k(),{addContent:o,removeContent:l}=fe(),u=Object(g.useCallback)((()=>{a(!1),l("indexSettingsFlyout")}),[l]),c=Object(g.useCallback)((async(e,t)=>{i({statusType:"in_progress"});const{error:s}=await r.updateIndexSettings(e,t);i({statusType:s?"error":"complete",details:null!=s?s:void 0}),u()}),[r,u]);return Object(g.useEffect)((()=>{s&&o({id:"indexSettingsFlyout",Component:be,props:{closeFlyout:u,deprecation:t,removeIndexSettings:c,status:n},flyoutProps:{onClose:u,className:"eui-textBreakWord","data-test-subj":"indexSettingsDetails","aria-labelledby":"indexSettingsDetailsFlyoutTitle"}})}),[o,t,c,s,u,n]),Object(v.jsx)(j.a.Fragment,null,e.map((e=>Object(v.jsx)(m.EuiTableRowCell,{key:e,truncateText:!1,"data-test-subj":`indexSettingsTableCell-${e}`},Object(v.jsx)(se,{fieldName:e,openFlyout:()=>a(!0),deprecation:t,resolutionTableCell:Object(v.jsx)(je,{status:n})})))))},he={getFlyoutDescription:e=>T.i18n.translate("xpack.upgradeAssistant.esDeprecations.deprecationDetailsFlyout.secondaryDescription",{defaultMessage:"Index: {indexName}",values:{indexName:e}}),closeButtonLabel:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.deprecationDetailsFlyout.closeButtonLabel",{defaultMessage:"Close"})},Oe=({deprecation:e,closeFlyout:t})=>{const{message:s,url:a,details:n,index:i}=e;return Object(v.jsx)(j.a.Fragment,null,Object(v.jsx)(m.EuiFlyoutHeader,{hasBorder:!0},Object(v.jsx)(_,{isCritical:e.isCritical,isResolved:!1}),Object(v.jsx)(m.EuiSpacer,{size:"s"}),Object(v.jsx)(m.EuiTitle,{size:"s","data-test-subj":"flyoutTitle"},Object(v.jsx)("h2",{id:"defaultDeprecationDetailsFlyoutTitle"},s)),i&&Object(v.jsx)(m.EuiText,{"data-test-subj":"flyoutDescription"},Object(v.jsx)("p",null,Object(v.jsx)(m.EuiTextColor,{color:"subdued"},he.getFlyoutDescription(i))))),Object(v.jsx)(m.EuiFlyoutBody,null,Object(v.jsx)(m.EuiText,null,Object(v.jsx)("p",{className:"eui-textBreakWord"},n),Object(v.jsx)("p",null,Object(v.jsx)(N,{documentationUrl:a})))),Object(v.jsx)(m.EuiFlyoutFooter,null,Object(v.jsx)(m.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiButtonEmpty,{onClick:t,flush:"left"},he.closeButtonLabel)))))},{useGlobalFlyout:ve}=O.c,ye=({rowFieldNames:e,deprecation:t})=>{const[s,a]=Object(g.useState)(!1),{addContent:n,removeContent:i}=ve(),r=Object(g.useCallback)((()=>{a(!1),i("deprecationDetails")}),[i]);return Object(g.useEffect)((()=>{s&&n({id:"deprecationDetails",Component:Oe,props:{deprecation:t,closeFlyout:r},flyoutProps:{onClose:r,className:"eui-textBreakWord","data-test-subj":"defaultDeprecationDetails","aria-labelledby":"defaultDeprecationDetailsFlyoutTitle"}})}),[n,r,t,s]),Object(v.jsx)(j.a.Fragment,null,e.map((e=>Object(v.jsx)(m.EuiTableRowCell,{key:e,truncateText:!1,"data-test-subj":`defaultTableCell-${e}`},Object(v.jsx)(se,{fieldName:e,deprecation:t,openFlyout:()=>a(!0)})))))};let Ee,ke;!function(e){e[e.created=0]="created",e[e.readonly=20]="readonly",e[e.newIndexCreated=30]="newIndexCreated",e[e.reindexStarted=40]="reindexStarted",e[e.reindexCompleted=50]="reindexCompleted",e[e.aliasCreated=60]="aliasCreated",e[e.originalIndexDeleted=70]="originalIndexDeleted",e[e.existingAliasesUpdated=80]="existingAliasesUpdated"}(Ee||(Ee={})),function(e){e[e.inProgress=0]="inProgress",e[e.completed=1]="completed",e[e.failed=2]="failed",e[e.paused=3]="paused",e[e.cancelled=4]="cancelled",e[e.fetchFailed=5]="fetchFailed"}(ke||(ke={})),s(52),s(53);const Ce=e=>e>h.k?`${h.k}+`:e.toString(),Se=(e,t,s=!1)=>{let a=0;switch(t){case Ee.created:a=0;break;case Ee.readonly:a=5;break;case Ee.newIndexCreated:a=10;break;case Ee.reindexStarted:a=null!==e?10+Math.round(e*(s?75:80)):10;break;case Ee.reindexCompleted:a=s?85:90;break;case Ee.aliasCreated:a=s?90:95;break;case Ee.originalIndexDeleted:a=s?95:100;break;case Ee.existingAliasesUpdated:a=100}return`${a}%`};let Te,Le;!function(e){e[e.Loading=0]="Loading",e[e.Success=1]="Success",e[e.Error=2]="Error"}(Te||(Te={})),function(e){e[e.Requested=0]="Requested",e[e.Loading=1]="Loading",e[e.Success=2]="Success",e[e.Error=3]="Error"}(Le||(Le={}));const Me=(e,{reindexOp:t,warnings:s,hasRequiredPrivileges:a,meta:n})=>{const i={...null!=n?n:e.meta},r=e.meta.aliases.length>0?e.meta.aliases:n.aliases,o={...e,meta:{...i,aliases:r},loadingState:Te.Success};if(s&&(o.reindexWarnings=s),void 0!==a&&(o.hasRequiredPrivileges=a),t){let s=!0;t.lastCompletedStep===Ee.aliasCreated&&t.status!==ke.completed&&(s=!1),s&&(o.lastCompletedStep=t.lastCompletedStep),o.status=t.status,o.reindexTaskPercComplete=t.reindexTaskPercComplete,o.errorMessage=t.errorMessage,e.cancelLoadingState!==Le.Requested&&e.cancelLoadingState!==Le.Loading||t.status!==ke.cancelled?e.cancelLoadingState===Le.Requested&&t.status===ke.inProgress?o.cancelLoadingState=Le.Loading:o.status===ke.completed&&(o.status=ke.inProgress):o.cancelLoadingState=Le.Success}return o},we=Object(g.createContext)(void 0),Fe=()=>{const e=Object(g.useContext)(we);if(void 0===e)throw new Error("useReindexContext must be used within a <ReindexStatusProvider />");return e},Ie=({api:e,indexName:t,children:s})=>{const{reindexState:a,startReindex:n,cancelReindex:i}=(({indexName:e,api:t})=>{const[s,a]=Object(g.useState)({loadingState:Te.Loading,errorMessage:null,reindexTaskPercComplete:null,meta:{indexName:e,reindexName:"",aliases:[]}}),n=Object(g.useRef)(null),i=Object(g.useRef)(!1),r=Object(g.useCallback)((()=>{n.current&&(clearTimeout(n.current),n.current=null)}),[]),o=Object(g.useCallback)((()=>{const e=s.meta.aliases.length>0,t=()=>{i.current&&a((e=>({...e,status:ke.completed,lastCompletedStep:Ee.existingAliasesUpdated})))};setTimeout((()=>{i.current&&(a((t=>({...t,status:e?ke.inProgress:ke.completed,lastCompletedStep:Ee.originalIndexDeleted}))),e&&setTimeout(t,1e3))}),1e3)}),[s.meta.aliases.length]),l=Object(g.useCallback)((async()=>{r();const{data:s,error:i}=await t.getReindexStatus(e);i?a((e=>({...e,loadingState:Te.Error,errorMessage:i.message.toString(),status:ke.fetchFailed}))):null!==s&&(a((e=>Me(e,s))),s.reindexOp&&s.reindexOp.status===ke.inProgress?n.current=setTimeout(l,1e3):s.reindexOp&&s.reindexOp.status===ke.completed&&o())}),[r,t,e,o]),u=Object(g.useCallback)((async()=>{a((e=>({...e,lastCompletedStep:e.status===ke.paused?e.lastCompletedStep:void 0,status:ke.inProgress,reindexTaskPercComplete:null,errorMessage:null,cancelLoadingState:void 0})));const{data:s,error:n}=await t.startReindexTask(e);n?a((e=>({...e,loadingState:Te.Error,errorMessage:n.message.toString(),status:ke.failed}))):(a((e=>Me(e,{reindexOp:s,meta:e.meta}))),l())}),[t,e,l]),c=Object(g.useCallback)((async()=>{a((e=>({...e,cancelLoadingState:Le.Requested})));const{error:s}=await t.cancelReindexTask(e);s&&a((e=>({...e,cancelLoadingState:Le.Error})))}),[t,e]);return Object(g.useEffect)((()=>{l()}),[l]),Object(g.useEffect)((()=>(i.current=!0,()=>{i.current=!1,r()})),[r]),{reindexState:s,startReindex:u,cancelReindex:c,updateStatus:l}})({indexName:t,api:e});return Object(v.jsx)(we.Provider,{value:{reindexState:a,startReindex:n,cancelReindex:i}},s)},Ae={reindexLoadingStatusText:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.reindex.reindexLoadingStatusText",{defaultMessage:"Loading status…"}),reindexInProgressText:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.reindex.reindexInProgressText",{defaultMessage:"Reindexing in progress…"}),reindexCompleteText:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.reindex.reindexCompleteText",{defaultMessage:"Reindex complete"}),reindexFailedText:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.reindex.reindexFailedText",{defaultMessage:"Reindex failed"}),reindexFetchFailedText:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.reindex.reindexFetchFailedText",{defaultMessage:"Reindex status not available"}),reindexCanceledText:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.reindex.reindexCanceledText",{defaultMessage:"Reindex cancelled"}),reindexPausedText:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.reindex.reindexPausedText",{defaultMessage:"Reindex paused"}),resolutionText:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.reindex.resolutionLabel",{defaultMessage:"Reindex"}),resolutionTooltipLabel:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.reindex.resolutionTooltipLabel",{defaultMessage:"Resolve this issue by reindexing this index. This issue can be resolved automatically."})},De=()=>{const{reindexState:e}=Fe(),t=e.meta.aliases.length>0;if(e.loadingState===Te.Loading)return Object(v.jsx)(m.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiLoadingSpinner,{size:"m"})),Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiText,{size:"s"},Ae.reindexLoadingStatusText)));switch(e.status){case ke.inProgress:return Object(v.jsx)(m.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiLoadingSpinner,{size:"m"})),Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiText,{size:"s"},Ae.reindexInProgressText," ",Se(e.reindexTaskPercComplete,e.lastCompletedStep,t))));case ke.completed:return Object(v.jsx)(m.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiIcon,{type:"check",color:"success"})),Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiText,{size:"s"},Ae.reindexCompleteText)));case ke.failed:return Object(v.jsx)(m.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiIcon,{type:"alert",color:"danger"})),Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiText,{size:"s"},Ae.reindexFailedText)));case ke.fetchFailed:return Object(v.jsx)(m.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiIcon,{type:"alert",color:"danger"})),Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiText,{size:"s"},Ae.reindexFetchFailedText)));case ke.paused:return Object(v.jsx)(m.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiIcon,{type:"alert",color:"danger"})),Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiText,{size:"s"},Ae.reindexPausedText)))}return Object(v.jsx)(m.EuiToolTip,{position:"top",content:Ae.resolutionTooltipLabel},Object(v.jsx)(m.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiIcon,{type:"indexSettings"})),Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiText,{size:"s"},Ae.resolutionText))))};var Re=s(41),Pe=s.n(Re),_e=s(31),Be=s.n(_e);s(55);const Ne=({status:e,idx:t})=>{if("incomplete"===e)return Object(v.jsx)("span",{className:"upgStepProgress__status"},t+1,".");if("inProgress"===e)return Object(v.jsx)(m.EuiLoadingSpinner,{size:"m",className:"upgStepProgress__status"});if("complete"===e)return Object(v.jsx)("span",{className:"upgStepProgress__status upgStepProgress__status--circle upgStepProgress__status--circle-complete"},Object(v.jsx)(m.EuiIcon,{type:"check",size:"s"}));if("paused"===e)return Object(v.jsx)("span",{className:"upgStepProgress__status upgStepProgress__status--circle upgStepProgress__status--circle-paused"},Object(v.jsx)(m.EuiIcon,{type:"pause",size:"s"}));if("cancelled"===e)return Object(v.jsx)("span",{className:"upgStepProgress__status upgStepProgress__status--circle upgStepProgress__status--circle-cancelled"},Object(v.jsx)(m.EuiIcon,{type:"cross",size:"s"}));if("failed"===e)return Object(v.jsx)("span",{className:"upgStepProgress__status upgStepProgress__status--circle upgStepProgress__status--circle-failed"},Object(v.jsx)(m.EuiIcon,{type:"cross",size:"s"}));throw new Error(`Unsupported status: ${e}`)},ze=({title:e,status:t,children:s,idx:a})=>{const n=Be()("upgStepProgress__title",{"upgStepProgress__title--currentStep":"inProgress"===t});return Object(v.jsx)(g.Fragment,null,Object(v.jsx)("div",{className:"upgStepProgress__step"},Object(v.jsx)(Ne,{status:t,idx:a}),Object(v.jsx)("div",{className:n},e)),s&&Object(v.jsx)("div",{className:"upgStepProgress__content"},s))},Ue=({steps:e})=>Object(v.jsx)("div",{className:"upgStepProgress__container"},e.map(((e,t)=>Object(v.jsx)(ze,Pe()({key:t},e,{idx:t}))))),We=({errorMessage:e})=>Object(v.jsx)(m.EuiCallOut,{color:"danger",title:"There was an error"},Object(v.jsx)(m.EuiText,null,Object(v.jsx)("p",null,e))),qe=()=>Object(v.jsx)(m.EuiCallOut,{color:"warning",title:"This step was paused due to a Kibana restart. Click 'Resume' below to continue."}),Ge=({reindexState:{lastCompletedStep:e,status:t,cancelLoadingState:s},cancelReindex:a})=>{if(t===ke.cancelled)return Object(v.jsx)(j.a.Fragment,null,Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexingChecklist.cancelledTitle",defaultMessage:"Reindexing cancelled."}));const n=t===ke.inProgress&&(e===Ee.newIndexCreated||e===Ee.reindexStarted),i=t===ke.inProgress&&e===Ee.reindexStarted;let r;switch(s){case Le.Requested:case Le.Loading:r=Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexingChecklist.cancelButton.cancellingLabel",defaultMessage:"Cancelling…"});break;case Le.Success:r=Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexingChecklist.cancelButton.cancelledLabel",defaultMessage:"Cancelled"});break;case Le.Error:r=Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexingChecklist.cancelButton.errorLabel",defaultMessage:"Could not cancel"});break;default:r=Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexingChecklist.cancelButton.cancelLabel",defaultMessage:"Cancel"})}return Object(v.jsx)(m.EuiFlexGroup,{component:"span"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},n?Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexingChecklist.inProgress.reindexingDocumentsStepTitle",defaultMessage:"Reindexing documents."}):Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexingChecklist.reindexingDocumentsStepTitle",defaultMessage:"Reindex documents."})),i&&Object(v.jsx)(m.EuiFlexItem,null,Object(v.jsx)(m.EuiLink,{"data-test-subj":"cancelReindexingDocumentsButton",onClick:a,disabled:void 0!==s},r)))},$e=Object.values(Ee).sort(),Ke=(e,t,s)=>e===Ee.readonly?s?Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexingChecklist.inProgress.readonlyStepTitle",defaultMessage:"Setting {indexName} index to read-only.",values:{indexName:Object(v.jsx)(m.EuiCode,null,t.indexName)}}):Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexingChecklist.readonlyStepTitle",defaultMessage:"Set {indexName} index to read-only.",values:{indexName:Object(v.jsx)(m.EuiCode,null,t.indexName)}}):e===Ee.newIndexCreated?s?Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexingChecklist.inProgress.createIndexStepTitle",defaultMessage:"Creating {reindexName} index.",values:{reindexName:Object(v.jsx)(m.EuiCode,null,t.reindexName)}}):Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexingChecklist.createIndexStepTitle",defaultMessage:"Create {reindexName} index.",values:{reindexName:Object(v.jsx)(m.EuiCode,null,t.reindexName)}}):e===Ee.aliasCreated?s?Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexingChecklist.inProgress.aliasCreatedStepTitle",defaultMessage:"Creating {indexName} alias for {reindexName} index.",values:{indexName:Object(v.jsx)(m.EuiCode,null,t.indexName),reindexName:Object(v.jsx)(m.EuiCode,null,t.reindexName)}}):Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexingChecklist.aliasCreatedStepTitle",defaultMessage:"Create {indexName} alias for {reindexName} index.",values:{indexName:Object(v.jsx)(m.EuiCode,null,t.indexName),reindexName:Object(v.jsx)(m.EuiCode,null,t.reindexName)}}):e===Ee.originalIndexDeleted?s?Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexingChecklist.inProgress.originalIndexDeletedStepTitle",defaultMessage:"Deleting original {indexName} index.",values:{indexName:Object(v.jsx)(m.EuiCode,null,t.indexName)}}):Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexingChecklist.originalIndexDeletedStepTitle",defaultMessage:"Delete original {indexName} index.",values:{indexName:Object(v.jsx)(m.EuiCode,null,t.indexName)}}):e===Ee.existingAliasesUpdated?s?Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexingChecklist.inProgress.aliasesUpdatedStepTitle",defaultMessage:"Updating {existingAliases} aliases to point to {reindexName} index.",values:{existingAliases:Object(v.jsx)(m.EuiCode,null,`[${t.aliases.join(",")}]`),reindexName:Object(v.jsx)(m.EuiCode,null,t.reindexName)}}):Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexingChecklist.aliasesUpdatedStepTitle",defaultMessage:"Update {existingAliases} aliases to point to {reindexName} index.",values:{existingAliases:Object(v.jsx)(m.EuiCode,null,`[${t.aliases.join(",")}]`),reindexName:Object(v.jsx)(m.EuiCode,null,t.reindexName)}}):void 0,Ye=e=>{const{errorMessage:t,lastCompletedStep:s=-1,status:a,reindexTaskPercComplete:n,meta:i}=e.reindexState,r=e=>{const n=$e[$e.indexOf(e)-1];return a===ke.failed&&s===n?{title:Ke(e,i),status:"failed",children:Object(v.jsx)(We,{errorMessage:t})}:a===ke.paused&&s===n?{title:Ke(e,i),status:"paused",children:Object(v.jsx)(qe,null)}:a===ke.cancelled&&s===n?{title:Ke(e,i),status:"cancelled"}:void 0===a||s<n?{title:Ke(e,i),status:"incomplete"}:s===n?{title:Ke(e,i,!0),status:"inProgress"}:{title:Ke(e,i),status:"complete"}},o={title:Object(v.jsx)(Ge,e)};a!==ke.failed||s!==Ee.newIndexCreated&&s!==Ee.reindexStarted?a!==ke.paused||s!==Ee.newIndexCreated&&s!==Ee.reindexStarted?a!==ke.cancelled||s!==Ee.newIndexCreated&&s!==Ee.reindexStarted?void 0===a||s<Ee.newIndexCreated?o.status="incomplete":s===Ee.newIndexCreated||s===Ee.reindexStarted?o.status="inProgress":o.status="complete":o.status="cancelled":(o.status="paused",o.children=Object(v.jsx)(qe,null)):(o.status="failed",o.children=Object(v.jsx)(We,{errorMessage:t}));const l=[r(Ee.readonly),r(Ee.newIndexCreated),o,r(Ee.aliasCreated),r(Ee.originalIndexDeleted)],u=i.aliases.length>0;return u&&l.push(r(Ee.existingAliasesUpdated)),Object(v.jsx)(j.a.Fragment,null,Object(v.jsx)(m.EuiTitle,{size:"xs","data-test-subj":"reindexChecklistTitle"},Object(v.jsx)("h3",null,a===ke.inProgress?Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexingInProgressTitle",defaultMessage:"Reindexing in progress… {percents}",values:{percents:Se(n,s,u)}}):Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexingChecklistTitle",defaultMessage:"Reindexing process"}))),Object(v.jsx)(Ue,{steps:l}))},Qe=({closeFlyout:e,reindexState:t,startReindex:s,cancelReindex:a})=>{const{services:{api:n,core:{docLinks:i}}}=k(),{loadingState:r,status:o,hasRequiredPrivileges:l}=t,u=r===Te.Loading||o===ke.inProgress,c=o===ke.completed,d=o===ke.fetchFailed,p=o===ke.failed,{data:x}=n.useLoadNodeDiskSpace();return Object(v.jsx)(g.Fragment,null,Object(v.jsx)(m.EuiFlyoutBody,null,!1===l&&Object(v.jsx)(g.Fragment,null,Object(v.jsx)(m.EuiSpacer,null),Object(v.jsx)(m.EuiCallOut,{title:Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.insufficientPrivilegeCallout.calloutTitle",defaultMessage:"You do not have sufficient privileges to reindex this index"}),color:"danger",iconType:"alert"})),x&&x.length>0&&Object(v.jsx)(j.a.Fragment,null,Object(v.jsx)(m.EuiCallOut,{color:"warning",iconType:"alert","data-test-subj":"lowDiskSpaceCallout",title:Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.lowDiskSpaceCalloutTitle",defaultMessage:"Nodes with low disk space"})},Object(v.jsx)(j.a.Fragment,null,Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.lowDiskSpaceCalloutDescription",defaultMessage:"Disk usage has exceeded the low watermark, which may prevent reindexing. The following nodes are impacted:"}),Object(v.jsx)(m.EuiSpacer,{size:"s"}),Object(v.jsx)("ul",null,x.map((({nodeName:e,available:t,nodeId:s})=>Object(v.jsx)("li",{key:s,"data-test-subj":"impactedNodeListItem"},Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.lowDiskSpaceUsedText",defaultMessage:"{nodeName} ({available} available)",values:{nodeName:e,available:t}}))))))),Object(v.jsx)(m.EuiSpacer,null)),(d||p)&&Object(v.jsx)(j.a.Fragment,null,Object(v.jsx)(m.EuiCallOut,{color:"danger",iconType:"alert","data-test-subj":d?"fetchFailedCallout":"reindexingFailedCallout",title:d?Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.fetchFailedCalloutTitle",defaultMessage:"Reindex status not available"}):Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexingFailedCalloutTitle",defaultMessage:"Reindexing error"})},t.errorMessage),Object(v.jsx)(m.EuiSpacer,null)),Object(v.jsx)(m.EuiText,null,Object(v.jsx)("p",null,Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexDescription",defaultMessage:"The index will be read-only during reindexing. You won't be able to add, update, or delete documents until reindexing is complete. If you need to reindex to a new cluster, use the reindex API. {docsLink}",values:{docsLink:Object(v.jsx)(m.EuiLink,{target:"_blank",href:i.links.upgradeAssistant.remoteReindex},T.i18n.translate("xpack.upgradeAssistant.checkupTab.reindexing.flyout.learnMoreLinkLabel",{defaultMessage:"Learn more"}))}})),Object(v.jsx)("p",null,Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.readonlyCallout.backgroundResumeDetail",defaultMessage:"Reindexing is performed in the background. You can return to the Upgrade Assistant to view progress or resume reindexing after a Kibana restart."}))),Object(v.jsx)(m.EuiSpacer,null),Object(v.jsx)(Ye,{reindexState:t,cancelReindex:a})),Object(v.jsx)(m.EuiFlyoutFooter,null,Object(v.jsx)(m.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiButtonEmpty,{iconType:"cross",onClick:e,flush:"left"},Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.closeButtonLabel",defaultMessage:"Close"}))),!d&&!c&&l&&Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiButton,{fill:!0,color:o===ke.paused?"warning":"primary",iconType:o===ke.paused?"play":void 0,onClick:s,isLoading:u,disabled:u||!l,"data-test-subj":"startReindexingButton"},(e=>{switch(e){case ke.failed:return Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexButton.tryAgainLabel",defaultMessage:"Try again"});case ke.inProgress:return Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexButton.reindexingLabel",defaultMessage:"Reindexing…"});case ke.paused:return Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexButton.resumeLabel",defaultMessage:"Resume reindexing"});case ke.cancelled:return Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexButton.restartLabel",defaultMessage:"Restart reindexing"});default:return Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexButton.runReindexLabel",defaultMessage:"Start reindexing"})}})(o))))))},Ve=({isChecked:e,warningId:t,label:s,onChange:a,description:n,documentationUrl:i})=>Object(v.jsx)(j.a.Fragment,null,Object(v.jsx)(m.EuiText,null,Object(v.jsx)(m.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiCheckbox,{id:t,label:Object(v.jsx)("strong",null,s),checked:e,onChange:a})),void 0!==i&&Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiLink,{href:i,target:"_blank",external:!1},Object(v.jsx)(m.EuiIconTip,{content:Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.warningsStep.documentationLinkLabel",defaultMessage:"Documentation"}),position:"right",type:"help"})))),Object(v.jsx)(m.EuiSpacer,{size:"xs"}),n),Object(v.jsx)(m.EuiSpacer,null)),He={customTypeName:({isChecked:e,onChange:t,docLinks:s,id:a,meta:n})=>Object(v.jsx)(Ve,{isChecked:e,onChange:t,warningId:a,label:Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.warningsStep.customTypeNameWarningTitle",defaultMessage:"Replace mapping type {mappingType} with {defaultType}",values:{mappingType:Object(v.jsx)(m.EuiCode,null,n.typeName),defaultType:Object(v.jsx)(m.EuiCode,null,"_doc")}}),description:Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.warningsStep.customTypeNameWarningDetail",defaultMessage:"Mapping types are no longer supported in Elastic 8.x. Ensure no application code or scripts rely on {mappingType}.",values:{mappingType:Object(v.jsx)(m.EuiCode,null,n.typeName)}}),documentationUrl:s.elasticsearch.typesRemoval}),indexSetting:({isChecked:e,onChange:t,docLinks:s,id:a,meta:n})=>Object(v.jsx)(Ve,{isChecked:e,onChange:t,warningId:a,label:Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.warningsStep.deprecatedIndexSettingsWarningTitle",defaultMessage:"Remove deprecated index settings"}),description:Object(v.jsx)(j.a.Fragment,null,Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.warningsStep.deprecatedIndexSettingsWarningDetail",defaultMessage:"The following deprecated index settings were detected:"}),Object(v.jsx)(m.EuiSpacer,{size:"xs"}),Object(v.jsx)("ul",null,n.deprecatedSettings.map(((e,t)=>Object(v.jsx)("li",{key:`${e}-${t}`},Object(v.jsx)(m.EuiCode,null,e)))))),documentationUrl:s.elasticsearch.indexModules}),replaceIndexWithAlias:({isChecked:e,onChange:t,docLinks:s,id:a,meta:n})=>Object(v.jsx)(Ve,{isChecked:e,onChange:t,warningId:a,label:Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.warningsStep.replaceIndexWithAliasWarningTitle",defaultMessage:"Replace {indexName} index with {reindexName} index and create {indexName} index alias",values:{indexName:Object(v.jsx)(m.EuiCode,null,null==n?void 0:n.indexName),reindexName:Object(v.jsx)(m.EuiCode,null,null==n?void 0:n.reindexName)}}),description:Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.warningsStep.replaceIndexWithAliasWarningDetail",defaultMessage:"You can search {indexName} as before. To delete the data you'll have to delete {reindexName}",values:{indexName:Object(v.jsx)(m.EuiCode,null,null==n?void 0:n.indexName),reindexName:Object(v.jsx)(m.EuiCode,null,null==n?void 0:n.reindexName)}})})},Je=e=>`reindexWarning-${e}`,Ze=({warnings:e,hideWarningsStep:t,continueReindex:s,meta:a})=>{const{services:{core:{docLinks:n}}}=k(),{links:i}=n,[r,o]=Object(g.useState)(e.reduce(((e,t,s)=>(e[Je(s)]=!1,e)),{})),l=Object.values(r).filter((e=>e)).length<e.length,u=e=>{const t=e.target.id;o((e=>({...e,[t]:!r[t]})))};return Object(v.jsx)(j.a.Fragment,null,Object(v.jsx)(m.EuiFlyoutBody,null,e.length>0&&Object(v.jsx)(j.a.Fragment,null,Object(v.jsx)(m.EuiCallOut,{title:Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.warningsStep.destructiveCallout.calloutTitle",defaultMessage:"This index requires destructive changes that cannot be reversed"}),color:"warning",iconType:"alert"},Object(v.jsx)("p",null,Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.warningsStep.destructiveCallout.calloutDetail",defaultMessage:"Back up the index before continuing. To proceed with the reindex, accept each change."}))),Object(v.jsx)(m.EuiSpacer,null),Object(v.jsx)(m.EuiTitle,{size:"s"},Object(v.jsx)("h3",null,Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.warningsStep.acceptChangesTitle",defaultMessage:"Accept changes"}))),Object(v.jsx)(m.EuiSpacer,null),e.map(((e,t)=>{const s=He[e.warningType];return Object(v.jsx)(s,{key:Je(t),isChecked:r[Je(t)],onChange:u,docLinks:i,id:Je(t),meta:{...a,...e.meta}})})))),Object(v.jsx)(m.EuiFlyoutFooter,null,Object(v.jsx)(m.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiButtonEmpty,{iconType:"arrowLeft",onClick:t,flush:"left"},Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.cancelButtonLabel",defaultMessage:"Back"}))),Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiButton,{fill:!0,color:"primary",onClick:s,disabled:l},Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.continueButtonLabel",defaultMessage:"Continue reindexing"}))))))},Xe=({reindexState:e,startReindex:t,cancelReindex:s,closeFlyout:a,deprecation:n})=>{var i;const{status:r,reindexWarnings:o}=e,{index:l}=n,[u,c]=Object(g.useState)(!1),d=Object(g.useCallback)((()=>{M.s.trackUiMetric(L.METRIC_TYPE.CLICK,M.p),t()}),[t]),p=Object(g.useCallback)((()=>{M.s.trackUiMetric(L.METRIC_TYPE.CLICK,M.q),s()}),[s]),x=u?Object(v.jsx)(Ze,{warnings:null!==(i=e.reindexWarnings)&&void 0!==i?i:[],meta:e.meta,hideWarningsStep:()=>c(!1),continueReindex:()=>{c(!1),d()}}):Object(v.jsx)(Qe,{closeFlyout:a,startReindex:()=>{o&&o.length>0&&r!==ke.inProgress&&r!==ke.completed?c(!0):d()},reindexState:e,cancelReindex:p});return Object(v.jsx)(j.a.Fragment,null,Object(v.jsx)(m.EuiFlyoutHeader,{hasBorder:!0},Object(v.jsx)(_,{isCritical:n.isCritical,isResolved:r===ke.completed}),Object(v.jsx)(m.EuiSpacer,{size:"s"}),Object(v.jsx)(m.EuiTitle,{size:"s","data-test-subj":"flyoutTitle"},Object(v.jsx)("h2",{id:"reindexDetailsFlyoutTitle"},Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.flyoutHeader",defaultMessage:"Reindex {index}",values:{index:l}})))),x)},{useGlobalFlyout:et}=O.c,tt=({rowFieldNames:e,deprecation:t})=>{const[s,a]=Object(g.useState)(!1),n=Fe(),{addContent:i,removeContent:r}=et(),o=Object(g.useCallback)((async()=>{r("reindexFlyout"),a(!1),M.s.trackUiMetric(L.METRIC_TYPE.CLICK,M.n)}),[r]);return Object(g.useEffect)((()=>{s&&i({id:"reindexFlyout",Component:Xe,props:{deprecation:t,closeFlyout:o,...n},flyoutProps:{onClose:o,className:"eui-textBreakWord","data-test-subj":"reindexDetails","aria-labelledby":"reindexDetailsFlyoutTitle"}})}),[i,t,s,n,o]),Object(g.useEffect)((()=>{s&&M.s.trackUiMetric(L.METRIC_TYPE.CLICK,M.o)}),[s]),Object(v.jsx)(j.a.Fragment,null,e.map((e=>Object(v.jsx)(m.EuiTableRowCell,{key:e,truncateText:!1,"data-test-subj":`reindexTableCell-${e}`},Object(v.jsx)(se,{fieldName:e,openFlyout:()=>a(!0),deprecation:t,resolutionTableCell:Object(v.jsx)(De,null)})))))},st=e=>{const{services:{api:t}}=k();return Object(v.jsx)(Ie,{indexName:e.deprecation.index,api:t},Object(v.jsx)(tt,e))},at={deleteInProgressText:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.clusterSettings.deletingButtonLabel",{defaultMessage:"Settings removal in progress…"}),deleteCompleteText:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.clusterSettings.deleteCompleteText",{defaultMessage:"Deprecated settings removed"}),deleteFailedText:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.clusterSettings.deleteFailedText",{defaultMessage:"Settings removal failed"}),resolutionText:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.clusterSettings.resolutionText",{defaultMessage:"Remove settings"}),resolutionTooltipLabel:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.clusterSettings.resolutionTooltipLabel",{defaultMessage:"Resolve this issue by removing settings from this cluster. This issue can be resolved automatically."})},nt=({status:e})=>{const{statusType:t}=e;return"in_progress"===t?Object(v.jsx)(m.EuiFlexGroup,{gutterSize:"s",alignItems:"center","data-test-subj":"clusterSettingsResolutionStatusCell"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiLoadingSpinner,{size:"m"})),Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiText,{size:"s"},at.deleteInProgressText))):"complete"===t?Object(v.jsx)(m.EuiFlexGroup,{gutterSize:"s",alignItems:"center","data-test-subj":"clusterSettingsResolutionStatusCell"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiIcon,{type:"check",color:"success"})),Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiText,{size:"s"},at.deleteCompleteText))):"error"===t?Object(v.jsx)(m.EuiFlexGroup,{gutterSize:"s",alignItems:"center","data-test-subj":"clusterSettingsResolutionStatusCell"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiIcon,{type:"alert",color:"danger"})),Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiText,{size:"s"},at.deleteFailedText))):Object(v.jsx)(m.EuiToolTip,{position:"top",content:at.resolutionTooltipLabel},Object(v.jsx)(m.EuiFlexGroup,{gutterSize:"s",alignItems:"center","data-test-subj":"clusterSettingsResolutionStatusCell"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiIcon,{type:"indexSettings"})),Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiText,{size:"s"},at.resolutionText))))},it={removeButtonLabel:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.removeClusterSettingsFlyout.removeButtonLabel",{defaultMessage:"Remove deprecated settings"}),retryRemoveButtonLabel:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.removeClusterSettingsFlyout.retryRemoveButtonLabel",{defaultMessage:"Retry removing deprecated settings"}),resolvedButtonLabel:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.removeClusterSettingsFlyout.resolvedButtonLabel",{defaultMessage:"Resolved"}),closeButtonLabel:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.removeClusterSettingsFlyout.closeButtonLabel",{defaultMessage:"Close"}),getConfirmationText:e=>T.i18n.translate("xpack.upgradeAssistant.esDeprecations.removeClusterSettingsFlyout.description",{defaultMessage:"Remove the following deprecated cluster {clusterSettingsCount, plural, one {setting} other {settings}}?",values:{clusterSettingsCount:e}}),errorTitle:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.removeClusterSettingsFlyout.deleteErrorTitle",{defaultMessage:"Error deleting cluster settings"})},rt=({deprecation:e,closeFlyout:t,removeClusterSettings:s,status:a})=>{const{message:n,details:i,url:r,correctiveAction:o}=e,{statusType:l,details:u}=a,c=["idle","error"].includes(l),d=Object(g.useCallback)((()=>{M.s.trackUiMetric(L.METRIC_TYPE.CLICK,M.c),s(o.deprecatedSettings)}),[o,s]);return Object(v.jsx)(j.a.Fragment,null,Object(v.jsx)(m.EuiFlyoutHeader,{hasBorder:!0},Object(v.jsx)(_,{isCritical:e.isCritical,isResolved:"complete"===l}),Object(v.jsx)(m.EuiSpacer,{size:"s"}),Object(v.jsx)(m.EuiTitle,{size:"s","data-test-subj":"flyoutTitle"},Object(v.jsx)("h2",{id:"removeClusterSettingsDetailsFlyoutTitle"},n))),Object(v.jsx)(m.EuiFlyoutBody,null,"error"===l&&Object(v.jsx)(j.a.Fragment,null,Object(v.jsx)(m.EuiCallOut,{title:it.errorTitle,color:"danger",iconType:"alert","data-test-subj":"deleteClusterSettingsError"},u.message),Object(v.jsx)(m.EuiSpacer,null)),Object(v.jsx)(m.EuiText,null,Object(v.jsx)("p",null,i),Object(v.jsx)("p",null,Object(v.jsx)(N,{documentationUrl:r}))),c&&Object(v.jsx)("div",{"data-test-subj":"removeClusterSettingsPrompt"},Object(v.jsx)(m.EuiSpacer,null),Object(v.jsx)(m.EuiTitle,{size:"xs"},Object(v.jsx)("h3",null,it.getConfirmationText(o.deprecatedSettings.length))),Object(v.jsx)(m.EuiSpacer,null),Object(v.jsx)(m.EuiText,null,Object(v.jsx)("ul",null,o.deprecatedSettings.map((e=>Object(v.jsx)("li",{key:e},Object(v.jsx)(m.EuiCode,null,e)))))))),Object(v.jsx)(m.EuiFlyoutFooter,null,Object(v.jsx)(m.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiButtonEmpty,{onClick:t,flush:"left"},it.closeButtonLabel)),c&&Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiButton,{fill:!0,"data-test-subj":"deleteClusterSettingsButton",color:"danger",onClick:d},"error"===l?it.retryRemoveButtonLabel:it.removeButtonLabel)))))},{useGlobalFlyout:ot}=O.c,lt=({rowFieldNames:e,deprecation:t})=>{const[s,a]=Object(g.useState)(!1),[n,i]=Object(g.useState)({statusType:"idle"}),{services:{api:r}}=k(),{addContent:o,removeContent:l}=ot(),u=Object(g.useCallback)((()=>{a(!1),l("clusterSettingsFlyout")}),[l]),c=Object(g.useCallback)((async e=>{i({statusType:"in_progress"});const{error:t}=await r.updateClusterSettings(e);i({statusType:t?"error":"complete",details:null!=t?t:void 0}),u()}),[r,u]);return Object(g.useEffect)((()=>{s&&o({id:"clusterSettingsFlyout",Component:rt,props:{closeFlyout:u,deprecation:t,removeClusterSettings:c,status:n},flyoutProps:{onClose:u,className:"eui-textBreakWord","data-test-subj":"clusterSettingsDetails","aria-labelledby":"removeClusterSettingsDetailsFlyoutTitle"}})}),[o,t,c,s,u,n]),Object(v.jsx)(j.a.Fragment,null,e.map((e=>Object(v.jsx)(m.EuiTableRowCell,{key:e,truncateText:!1,"data-test-subj":`clusterSettingsTableCell-${e}`},Object(v.jsx)(se,{fieldName:e,openFlyout:()=>a(!0),deprecation:t,resolutionTableCell:Object(v.jsx)(nt,{status:n})})))))},ut={refreshButtonLabel:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.table.refreshButtonLabel",{defaultMessage:"Refresh"}),noDeprecationsMessage:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.table.noDeprecationsMessage",{defaultMessage:"No Elasticsearch deprecation issues found"}),typeFilterLabel:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.table.typeFilterLabel",{defaultMessage:"Type"}),criticalFilterLabel:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.table.criticalFilterLabel",{defaultMessage:"Critical"}),searchPlaceholderLabel:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.table.searchPlaceholderLabel",{defaultMessage:"Filter"})},ct={isCritical:{label:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.table.statusColumnTitle",{defaultMessage:"Status"}),width:"8px"},message:{label:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.table.issueColumnTitle",{defaultMessage:"Issue"}),width:"36px"},type:{label:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.table.typeColumnTitle",{defaultMessage:"Type"}),width:"10px"},index:{label:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.table.nameColumnTitle",{defaultMessage:"Name"}),width:"24px"},correctiveAction:{label:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.table.resolutionColumnTitle",{defaultMessage:"Resolution"}),width:"24px"}},dt=Object.keys(ct),pt=U.pageSizeOptions,gt=(e,t)=>{const{isSortAscending:s,sortField:a}=t,n=Object(X.sortBy)(e,[e=>"isCritical"===a?!0!==e.isCritical:e[a]]);return s?n:n.reverse()},jt=({deprecations:e=[],reload:t})=>{const{services:{api:s}}=k(),{data:a}=s.useLoadMlUpgradeMode(),n=!(null==a||!a.mlUpgradeModeEnabled),[i,r]=Object(g.useState)({isSortAscending:!0,sortField:"isCritical"}),[o,l]=Object(g.useState)(U.initialPageSize),[u,c]=Object(g.useState)(0),[d,p]=Object(g.useState)(m.EuiSearchBar.Query.MATCH_ALL),[x,b]=Object(g.useState)(void 0),[f,h]=Object(g.useState)(gt(e,i)),O=Object(g.useMemo)((()=>new m.Pager(e.length,o,u)),[u,e,o]),y=Object(g.useMemo)((()=>f.slice(O.firstItemIndex,O.lastItemIndex+1)),[f,O]),E=Object(g.useCallback)((e=>{const t={isSortAscending:i.sortField!==e||!i.isSortAscending,sortField:e};r(t)}),[i]),C=Object(g.useCallback)((({query:e,error:t})=>{t?b(t):(b(void 0),p(e))}),[]);return Object(g.useEffect)((()=>{const{setTotalItems:t,goToPageIndex:s}=O,a=m.EuiSearchBar.Query.execute(d,e),n=gt(a,i);t(n.length),h(n),n.length!==f.length&&s(0)}),[e,i,O,d,f.length]),Object(v.jsx)(j.a.Fragment,null,Object(v.jsx)(m.EuiFlexGroup,{gutterSize:"m"},Object(v.jsx)(m.EuiFlexItem,{"data-test-subj":"searchBarContainer"},Object(v.jsx)(m.EuiSearchBar,{box:{placeholder:ut.searchPlaceholderLabel,incremental:!0},filters:[{type:"is",field:"isCritical",name:ut.criticalFilterLabel},{type:"field_value_selection",field:"type",name:ut.typeFilterLabel,multiSelect:!1,options:Object.keys(z).map((e=>({value:e,name:z[e]})))}],onChange:C})),Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiButton,{iconType:"refresh",onClick:t,"data-test-subj":"refreshButton",key:"refreshButton"},ut.refreshButtonLabel))),x&&Object(v.jsx)("div",{"data-test-subj":"invalidSearchQueryMessage"},Object(v.jsx)(m.EuiSpacer,{size:"l"}),Object(v.jsx)(m.EuiCallOut,{iconType:"alert",color:"danger",title:`Invalid search: ${x.message}`})),Object(v.jsx)(m.EuiSpacer,{size:"m"}),Object(v.jsx)(m.EuiTable,{"data-test-subj":"esDeprecationsTable"},Object(v.jsx)(m.EuiTableHeader,null,Object.entries(ct).map((([e,t])=>Object(v.jsx)(m.EuiTableHeaderCell,{width:t.width,key:t.label,onSort:()=>E(e),isSorted:i.sortField===e,isSortAscending:i.isSortAscending},t.label)))),0===f.length?Object(v.jsx)(m.EuiTableBody,null,Object(v.jsx)(m.EuiTableRow,{"data-test-subj":"noDeprecationsRow"},Object(v.jsx)(m.EuiTableRowCell,{align:"center",colSpan:dt.length,mobileOptions:{width:"100%"}},ut.noDeprecationsMessage))):Object(v.jsx)(m.EuiTableBody,null,y.map(((e,t)=>Object(v.jsx)(m.EuiTableRow,{"data-test-subj":"deprecationTableRow",key:`deprecation-row-${t}`},((e,t)=>{var s;switch(null===(s=e.correctiveAction)||void 0===s?void 0:s.type){case"mlSnapshot":return Object(v.jsx)(pe,{deprecation:e,rowFieldNames:dt,mlUpgradeModeEnabled:t});case"indexSetting":return Object(v.jsx)(me,{deprecation:e,rowFieldNames:dt});case"clusterSetting":return Object(v.jsx)(lt,{deprecation:e,rowFieldNames:dt});case"reindex":return Object(v.jsx)(st,{deprecation:e,rowFieldNames:dt});default:return Object(v.jsx)(ye,{deprecation:e,rowFieldNames:dt})}})(e,n)))))),Object(v.jsx)(m.EuiSpacer,{size:"m"}),Object(v.jsx)(m.EuiTablePagination,{"data-test-subj":"esDeprecationsPagination",activePage:O.getCurrentPageIndex(),itemsPerPage:O.itemsPerPage,itemsPerPageOptions:pt,pageCount:O.getTotalPages(),onChangeItemsPerPage:l,onChangePage:c}))},xt={pageTitle:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.pageTitle",{defaultMessage:"Elasticsearch deprecation issues"}),pageDescription:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.pageDescription",{defaultMessage:"Resolve all critical issues before upgrading. Before making changes, ensure you have a current snapshot of your cluster. Indices created before 7.0 must be reindexed or removed, including hidden indices such as those used to store Machine Learning data."}),isLoading:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.loadingText",{defaultMessage:"Loading deprecation issues…"}),remoteClustersDetectedTitle:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.remoteClustersDetectedTitle",{defaultMessage:"Remote cluster compatibility"}),getRemoteClustersDetectedDescription:e=>T.i18n.translate("xpack.upgradeAssistant.esDeprecations.remoteClustersDetectedDescription",{defaultMessage:"You have {remoteClustersCount} {remoteClustersCount, plural, one {remote cluster} other {remote clusters}} configured. If you use cross-cluster search, note that 8.x can only search remote clusters running the previous minor version or later. If you use cross-cluster replication, a cluster that contains follower indices must run the same or newer version as the remote cluster.",values:{remoteClustersCount:e}}),remoteClustersLinkText:T.i18n.translate("xpack.upgradeAssistant.esDeprecations.remoteClustersLinkText",{defaultMessage:"View remote clusters."})},bt=e=>Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.esDeprecations.batchReindexingDocsDescription",defaultMessage:"To start multiple reindexing tasks in a single request, use the Kibana {docsLink}.",values:{docsLink:Object(v.jsx)(m.EuiLink,{href:e.links.upgradeAssistant.batchReindex,target:"_blank",external:!0},T.i18n.translate("xpack.upgradeAssistant.esDeprecations.batchReindexingDocsLink",{defaultMessage:"batch reindexing API"}))}}),ft=()=>{var e;const{plugins:{share:t}}=k(),s=null===(e=t.url.locators.get("REMOTE_CLUSTERS_LOCATOR"))||void 0===e?void 0:e.useUrl({page:"remoteClusters"});return Object(v.jsx)(m.EuiLink,{href:s,"data-test-subj":"remoteClustersLink"},xt.remoteClustersLinkText)},mt=Object(b.withRouter)((({history:e})=>{var t;const{services:{api:s,breadcrumbs:a,core:{docLinks:n}}}=k(),{data:i,isLoading:r,error:o,resendRequest:l}=s.useLoadEsDeprecations(),{data:u}=s.useLoadRemoteClusters(),c=Object(g.useMemo)((()=>(e=>{const t=[],s=[];return e.forEach((e=>{e.isCritical?t.push(e):s.push(e)})),{criticalDeprecations:t.length,warningDeprecations:s.length}})((null==i?void 0:i.deprecations)||[])),[null==i?void 0:i.deprecations]);return Object(g.useEffect)((()=>{a.setBreadcrumbs("esDeprecations")}),[a]),Object(g.useEffect)((()=>{M.s.trackUiMetric(L.METRIC_TYPE.LOADED,M.e)}),[]),o?Object(v.jsx)(B,{deprecationSource:"Elasticsearch",message:Z(o).message}):r?Object(v.jsx)(m.EuiPageContent,{verticalPosition:"center",horizontalPosition:"center",color:"subdued"},Object(v.jsx)(O.g,null,xt.isLoading)):0===(null==i||null===(t=i.deprecations)||void 0===t?void 0:t.length)?Object(v.jsx)(m.EuiPageContent,{verticalPosition:"center",horizontalPosition:"center",color:"subdued"},Object(v.jsx)(I,{deprecationType:"Elasticsearch",navigateToOverviewPage:()=>e.push("/overview")})):Object(v.jsx)("div",{"data-test-subj":"esDeprecationsContent"},Object(v.jsx)(m.EuiPageHeader,{pageTitle:xt.pageTitle,description:Object(v.jsx)(j.a.Fragment,null,xt.pageDescription," ",bt(n))},Object(v.jsx)(j.a.Fragment,null,u&&u.length>0&&Object(v.jsx)(j.a.Fragment,null,Object(v.jsx)(m.EuiCallOut,{title:xt.remoteClustersDetectedTitle,color:"warning",iconType:"help","data-test-subj":"remoteClustersWarningCallout"},Object(v.jsx)("p",null,xt.getRemoteClustersDetectedDescription(u.length)," ",Object(v.jsx)(ft,null))),Object(v.jsx)(m.EuiSpacer,null)),Object(v.jsx)(R,{totalCriticalDeprecations:c.criticalDeprecations,totalWarningDeprecations:c.warningDeprecations}))),Object(v.jsx)(m.EuiSpacer,{size:"l"}),Object(v.jsx)(jt,{deprecations:null==i?void 0:i.deprecations,reload:l}))}));var ht,Ot,vt=s(32),yt=s(2),Et=s.n(yt),kt=s(33),Ct=s.n(kt),St=(s(42),function(e,t){if("boolean"!=typeof t&&"boolean"===e.type){if([1,"true"].includes(t))return!0;if([0,"false"].includes(t))return!1;throw new Error("".concat(t," is not a valid boolean value for boolean field ").concat(e.name))}return"number"!=typeof t&&"number"===e.type?Number(t):t}),Tt=function(e,t){var s=St(e,t);return{script:{source:Lt(e),lang:e.lang,params:{value:s}}}},Lt=function(e){return"painless"===e.lang?"boolean compare(Supplier s, def v) {return s.get() == v;}"+"compare(() -> { ".concat(e.script," }, params.value);"):"(".concat(e.script,") == value")};!function(e){e.CUSTOM="custom",e.PHRASES="phrases",e.PHRASE="phrase",e.EXISTS="exists",e.MATCH_ALL="match_all",e.QUERY_STRING="query_string",e.RANGE="range",e.RANGE_FROM_VALUE="range_from_value",e.SPATIAL_FILTER="spatial_filter"}(ht||(ht={})),function(e){e.APP_STATE="appState",e.GLOBAL_STATE="globalState"}(Ot||(Ot={}));var Mt={gt:">",gte:">=",lte:"<=",lt:"<"},wt={gt:"boolean gt(Supplier s, def v) {return s.get() > v}",gte:"boolean gte(Supplier s, def v) {return s.get() >= v}",lte:"boolean lte(Supplier s, def v) {return s.get() <= v}",lt:"boolean lt(Supplier s, def v) {return s.get() < v}"},Ft={gt:"boolean gt(Supplier s, def v) {return s.get().toInstant().isAfter(Instant.parse(v))}",gte:"boolean gte(Supplier s, def v) {return !s.get().toInstant().isBefore(Instant.parse(v))}",lte:"boolean lte(Supplier s, def v) {return !s.get().toInstant().isAfter(Instant.parse(v))}",lt:"boolean lt(Supplier s, def v) {return s.get().toInstant().isBefore(Instant.parse(v))}"},It=function(e,t){var s=Object(X.mapValues)(Object(X.pickBy)(t,(function(e,t){return t in Mt})),(function(t){return"number"===e.type&&"string"==typeof t?parseFloat(t):t})),a=Object(X.map)(s,(function(t,s){return"("+e.script+")"+Object(X.get)(Mt,s)+s})).join(" && ");if("painless"===e.lang){var n="date"===e.type?Ft:wt,i=Object(X.reduce)(s,(function(e,t,s){return e.concat(Object(X.get)(n,s))}),[]).join(" "),r=Object(X.map)(s,(function(t,s){return"".concat(s,"(() -> { ").concat(e.script," }, params.").concat(s,")")})).join(" && ");a="".concat(i).concat(r)}return{script:{source:a,params:s,lang:e.lang}}},At=s(37),Dt=s.n(At),Rt=s(36),Pt=s.n(Rt);function _t(e){return{type:"literal",value:e}}function Bt(e){return e.value}var Nt="@kuery-wildcard@";function zt(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Ut(e){return e.replace(/[+-=&|><!(){}[\]^"~*?:\\/]/g,"\\$&")}function Wt(e){return e.includes(Nt)?{type:"wildcard",value:e}:Os(e)}function qt(e,t){var s=e.value.split(Nt).map(zt).join("[\\s\\S]*");return new RegExp("^".concat(s,"$")).test(t)}function Gt(e){return e.value.split(Nt).join("*")}function $t(e){return e.value.split(Nt).map(Ut).join("*")}function Kt(e){var t=e.value;return t.startsWith(Nt)&&t.replace(Nt,"").length>0}function Yt(e,t){if(!t)return[];if("literal"===e.type){var s=Bt(e),a=t.fields.find((function(e){return e.name===s}));return a?[a]:[]}return"wildcard"===e.type?t.fields.filter((function(t){return qt(e,t.name)})):void 0}var Qt=s(29),Vt=s.n(Qt);function Ht(e){var t=Vt.a.tz.guess();return"Browser"===e?t:e}function Jt(e){return function(e){var t,s=null==e?void 0:e.subType;return!(null==s||null===(t=s.nested)||void 0===t||!t.path)}(e)?e.subType:void 0}function Zt(e,t,s){var a=Ct()(Ct()({},e),{},{value:s?"".concat(s,".").concat(e.value):e.value});if(!t||"wildcard"===a.type&&!s)return a;var n=Yt(a,t).reduce((function(e,t){var a=Jt(t),n=null==a?void 0:a.nested.path;return s&&!n?[].concat(Dt()(e),["".concat(t.name,' is not a nested field but is in nested group "').concat(s,'" in the KQL expression.')]):n&&!s?[].concat(Dt()(e),["".concat(t.name," is a nested field, but is not in a nested group in the KQL expression.")]):n!==s?[].concat(Dt()(e),["Nested field ".concat(t.name," is being queried with the incorrect nested path. The correct path is ").concat(null==a?void 0:a.nested.path,".")]):e}),[]);if(n.length>0)throw new Error(n.join("\n"));return a}function Xt(e,t){var s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Object(X.isUndefined)(e))throw new Error("fieldName is a required argument");if(Object(X.isUndefined)(t))throw new Error("value is a required argument");var a="string"==typeof e?Os(e):_t(e),n="string"==typeof t?Os(t):_t(t),i=_t(s);return{arguments:[a,n,i]}}function es(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},n=Pt()(e.arguments,3),i=n[0],r=n[1],o=n[2],l="wildcard"===r.type&&r.value===Nt,u="wildcard"===i.type&&i.value===Nt,c=l&&u;if(c)return{match_all:{}};var d=Zt(i,t,null!=a&&a.nested?a.nested.path:void 0),p=Object(X.isUndefined)(r)?r:vs(r),g=o.value?"phrase":"best_fields";if(null===d.value)return"wildcard"===r.type?{query_string:{query:$t(r)}}:{multi_match:{type:g,query:p,lenient:!0}};var j=t?Yt(d,t):[];if(j&&0===j.length&&j.push({name:vs(d),scripted:!1,type:""}),l&&(null==j||!j.length||(null==j?void 0:j.length)===(null==t?void 0:t.fields.length)))return{match_all:{}};var x=j.reduce((function(e,t){var n=function(e){var s=Jt(t);return"wildcard"!==d.type||null==s||!s.nested||null!=a&&a.nested?e:{nested:{path:s.nested.path,query:e,score_mode:"none"}}};if(!t.scripted){if(l)return[].concat(Dt()(e),[n({exists:{field:t.name}})]);if("wildcard"===r.type)return[].concat(Dt()(e),[n({query_string:{fields:[t.name],query:$t(r)}})]);if("date"===t.type){var i=s.dateFormatTZ?{time_zone:Ht(s.dateFormatTZ)}:{};return[].concat(Dt()(e),[n({range:Et()({},t.name,Ct()({gte:p,lte:p},i))})])}var o="phrase"===g?"match_phrase":"match";return[].concat(Dt()(e),[n(Et()({},o,Et()({},t.name,p)))])}if(!l)return[].concat(Dt()(e),[{script:Ct()({},Tt(t,p))}])}),[]);return{bool:{should:x||[],minimum_should_match:1}}}function ts(e){return{arguments:e}}function ss(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},n=s.filtersInMustClause,i=e.arguments||[],r=n?"must":"filter";return{bool:Et()({},r,i.map((function(e){return vs(e,t,s,a)})))}}function as(e){return{arguments:e}}function ns(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},n=e.arguments||[];return{bool:{should:n.map((function(e){return vs(e,t,s,a)})),minimum_should_match:1}}}function is(e){return{arguments:[e]}}function rs(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},n=Pt()(e.arguments,1),i=n[0];return{bool:{must_not:vs(i,t,s,a)}}}function os(e,t,s){return{arguments:[Os(e),t,fs.literal.buildNode(s)]}}function ls(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},n=Pt()(e.arguments,3),i=n[0],r=n[1],o=n[2],l=Zt(i,t,null!=a&&a.nested?a.nested.path:void 0),u=t?Yt(l,t):[];u&&0===u.length&&u.push({name:vs(l),scripted:!1,type:""});var c=u.map((function(e){var t=function(t){var s=Jt(e);return"wildcard"!==l.type||null==s||!s.nested||a.nested?t:{nested:{path:s.nested.path,query:t,score_mode:"none"}}},n=Et()({},r,vs(o));if(e.scripted)return{script:It(e,n)};if("date"===e.type){var i=s.dateFormatTZ?{time_zone:Ht(s.dateFormatTZ)}:{};return t({range:Et()({},e.name,Ct()(Ct()({},n),i))})}return t({range:Et()({},e.name,n)})}));return{bool:{should:c,minimum_should_match:1}}}function us(e){return{arguments:[_t(e)]}}function cs(e,t){var s,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},n=Pt()(e.arguments,1),i=n[0],r=Ct()(Ct()({},i),{},{value:null!=a&&a.nested?"".concat(a.nested.path,".").concat(i.value):i.value}),o=Bt(r),l=null==t||null===(s=t.fields)||void 0===s?void 0:s.find((function(e){return e.name===o}));if(null!=l&&l.scripted)throw new Error("Exists query does not support scripted fields");return{exists:{field:o}}}function ds(e,t){return{arguments:["string"==typeof e?Os(e):_t(e),t]}}function ps(e,t){var s,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=Pt()(e.arguments,2),r=i[0],o=i[1],l=vs(r),u=null!=n&&null!==(s=n.nested)&&void 0!==s&&s.path?"".concat(n.nested.path,".").concat(l):l;return{nested:{path:u,query:vs(o,t,a,Ct()(Ct()({},n),{},{nested:{path:u}})),score_mode:"none"}}}var gs={is:i,and:r,or:o,not:l,range:u,exists:c,nested:d};function js(e){var t=gs[e];if(ee.a.isUndefined(t))throw new Error('Unknown function "'.concat(e,'"'));for(var s=arguments.length,a=new Array(s>1?s-1:0),n=1;n<s;n++)a[n-1]=arguments[n];return Ct()({type:"function",function:e},t.buildNodeParams.apply(t,a))}function xs(e,t){if(ee.a.isUndefined(gs[e]))throw new Error('Unknown function "'.concat(e,'"'));return{type:"function",function:e,arguments:t}}function bs(e,t,s,a){return gs[e.function].toElasticsearchQuery(e,t,s,a)}var fs={function:p,literal:a,wildcard:n},ms=(s(60),s(61),s(62),s(63),s(64),s(65),T.i18n.translate("esQuery.kql.errors.endOfInputText",{defaultMessage:"end of input"}),T.i18n.translate("esQuery.kql.errors.fieldNameText",{defaultMessage:"field name"}),T.i18n.translate("esQuery.kql.errors.valueText",{defaultMessage:"value"}),T.i18n.translate("esQuery.kql.errors.literalText",{defaultMessage:"literal"}),T.i18n.translate("esQuery.kql.errors.whitespaceText",{defaultMessage:"whitespace"}),Error,s(43)),hs=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ms.parse;if(void 0===e)throw new Error("expression must be a string, got undefined instead");return s(e,Ct()(Ct()({},t),{},{helpers:{nodeTypes:fs}}))},Os=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return hs(e,Ct()(Ct()({},t),{},{startRule:"Literal"}),ms.parse)},vs=function e(t,s){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3?arguments[3]:void 0;if(!t||!t.type||!fs[t.type])return e(fs.function.buildNode("and",[]),s);var i=fs[t.type];return i.toElasticsearchQuery(t,s,a,n)};Object(X.flow)((function(e){return e.replace(/[\\():<>"*]/g,"\\$&")}),(function(e){return e.replace(/(\s+)(and|or)(\s+)/gi,"$1\\$2$3")}),(function(e){return e.replace(/not(\s+)/gi,"\\$&")}),(function(e){return e.replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/\n/g,"\\n")}));const ys=({checkpoint:e})=>{const{services:{data:t},plugins:{share:s}}=k(),[a,n]=Object(g.useState)();return Object(g.useEffect)((()=>{(async()=>{const a=s.url.locators.get("DISCOVER_APP_LOCATOR");if(!a)return;const i=await(async e=>{const t=(await e.dataViews.find(h.h)).find((e=>e.title===h.h));if(t)return t;{const t=!1,s=!0;return await e.dataViews.createAndSave({title:h.h,allowNoIndex:!0},t,s)}})(t),r=i.getFieldByName(h.i);let o=[];if(void 0!==r){const e=function(e,t,s){var a,n=s.id,i=ht.PHRASES,r=e.name;return a=e.scripted?t.map((function(t){return{script:Tt(e,t)}})):t.map((function(t){return{match_phrase:Et()({},e.name,t)}})),{meta:{index:n,type:i,key:r,params:t},query:{bool:{should:a,minimum_should_match:1}}}}(r,[...h.b],i);e.meta.negate=!0,o=[e]}const l=await(null==a?void 0:a.getUrl({indexPatternId:i.id,query:{language:"kuery",query:`@timestamp > "${e}"`},filters:o}));n(l)})()}),[t,e,s.url.locators]),void 0===a?null:Object(v.jsx)(m.EuiLink,{href:a,onClick:()=>{M.s.trackUiMetric(L.METRIC_TYPE.CLICK,M.d)},"data-test-subj":"viewDiscoverLogs"},Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.overview.viewDiscoverResultsAction",defaultMessage:"Analyze logs in Discover"}))},Es=({checkpoint:e})=>{var t;const{services:{core:{http:s}}}=k(),a=`sourceId=${h.j}&logPosition=(end:now,start:${Object(vt.encode)(e)})&logFilter=${encodeURI(`(language:kuery,query:'not ${h.i} : (${h.b.join(" or ")})')`)}`,n=null==s||null===(t=s.basePath)||void 0===t?void 0:t.prepend(`/app/logs/stream?${a}`);return Object(v.jsx)(m.EuiLink,{href:n,onClick:()=>{M.s.trackUiMetric(L.METRIC_TYPE.CLICK,M.l)},"data-test-subj":"viewObserveLogs"},Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.overview.viewObservabilityResultsAction",defaultMessage:"View deprecation logs in Observability"}))},ks=({checkpoint:e})=>{const{infra:t}=k().plugins;return Object(v.jsx)(m.EuiFlexGroup,null,t&&Object(v.jsx)(m.EuiFlexItem,null,Object(v.jsx)(m.EuiPanel,null,Object(v.jsx)(m.EuiText,{size:"s"},Object(v.jsx)("p",null,Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.overview.observe.observabilityDescription",defaultMessage:"Get insight into which deprecated APIs are being used and what applications you need to update."}))),Object(v.jsx)(m.EuiSpacer,{size:"m"}),Object(v.jsx)(Es,{checkpoint:e}))),Object(v.jsx)(m.EuiFlexItem,null,Object(v.jsx)(m.EuiPanel,null,Object(v.jsx)(m.EuiText,{size:"s"},Object(v.jsx)("p",null,Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.overview.observe.discoveryDescription",defaultMessage:"Search and filter the deprecation logs to understand the types of changes you need to make."}))),Object(v.jsx)(m.EuiSpacer,{size:"m"}),Object(v.jsx)(ys,{checkpoint:e}))))},Cs={calloutTitle:(e,t)=>Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.overview.verifyChanges.calloutTitle",defaultMessage:"{warningsCount, plural, =0 {No} other {{warningsCount}}} deprecation {warningsCount, plural, one {issue} other {issues}} since {previousCheck}",values:{warningsCount:e,previousCheck:Object(v.jsx)(j.a.Fragment,null,Object(v.jsx)(f.FormattedDate,{value:t,year:"numeric",month:"long",day:"2-digit"})," ",Object(v.jsx)(f.FormattedTime,{value:t,timeZoneName:"short",hour12:!1}))}}),calloutBody:T.i18n.translate("xpack.upgradeAssistant.overview.verifyChanges.calloutBody",{defaultMessage:"After making changes, reset the counter and continue monitoring to verify you're no longer using deprecated features."}),loadingError:T.i18n.translate("xpack.upgradeAssistant.overview.verifyChanges.loadingError",{defaultMessage:"An error occurred while retrieving the count of deprecation logs"}),retryButton:T.i18n.translate("xpack.upgradeAssistant.overview.verifyChanges.retryButton",{defaultMessage:"Try again"}),resetCounterButton:T.i18n.translate("xpack.upgradeAssistant.overview.verifyChanges.resetCounterButton",{defaultMessage:"Reset counter"}),errorToastTitle:T.i18n.translate("xpack.upgradeAssistant.overview.verifyChanges.errorToastTitle",{defaultMessage:"Could not delete deprecation logs cache"})},Ss=({checkpoint:e,setCheckpoint:t})=>{const[s,a]=Object(g.useState)(!1),{services:{api:n,core:{notifications:i}}}=k(),{data:r,error:o,isLoading:l,resendRequest:u,isInitialRequest:c}=n.getDeprecationLogsCount(e),d=(null==r?void 0:r.count)||0,p=d>0,j=p?"warning":"success",x=p?"alert":"check",b=p?"hasWarningsCallout":"noWarningsCallout";return c&&l?Object(v.jsx)(m.EuiLoadingContent,{lines:6}):o?Object(v.jsx)(m.EuiCallOut,{title:Cs.loadingError,color:"danger",iconType:"alert","data-test-subj":"errorCallout"},Object(v.jsx)("p",null,o.statusCode," - ",o.message),Object(v.jsx)(m.EuiButton,{color:"danger",onClick:u,"data-test-subj":"retryButton"},Cs.retryButton)):Object(v.jsx)(m.EuiCallOut,{title:Cs.calloutTitle(d,e),color:j,iconType:x,"data-test-subj":b},Object(v.jsx)("p",null,Cs.calloutBody),Object(v.jsx)(m.EuiButton,{color:j,onClick:async()=>{a(!0);const{error:e}=await n.deleteDeprecationLogsCache();if(a(!1),e)return void i.toasts.addDanger({title:Cs.errorToastTitle,text:e.message.toString()});const s=Vt()().toISOString();M.s.trackUiMetric(L.METRIC_TYPE.CLICK,M.r),t(s)},isLoading:s||l,"data-test-subj":"resetLastStoredDate"},Cs.resetCounterButton))},Ts={enabledMessage:T.i18n.translate("xpack.upgradeAssistant.overview.deprecationLogs.enabledToastMessage",{defaultMessage:"Deprecated API requests will be logged and indexed."}),disabledMessage:T.i18n.translate("xpack.upgradeAssistant.overview.deprecationLogs.disabledToastMessage",{defaultMessage:"Deprecated API requests will not be logged."})},Ls=()=>{const{services:{api:e,core:{notifications:t}}}=k(),{data:s,error:a,isLoading:n,resendRequest:i}=e.useLoadDeprecationLogging(),[r,o]=Object(g.useState)(!1),[l,u]=Object(g.useState)(!1),[c,d]=Object(g.useState)(!1),[p,j]=Object(g.useState)();return Object(g.useEffect)((()=>{if(!n&&s){const{isDeprecationLogIndexingEnabled:e,isDeprecationLoggingEnabled:t}=s;o(e),!e&&t&&d(!0)}}),[s,n]),{isDeprecationLogIndexingEnabled:r,isLoading:n,isUpdating:l,toggleLogging:async()=>{u(!0);const{data:s,error:a}=await e.updateDeprecationLogging({isEnabled:!r});u(!1),d(!1),a?j(a):s&&(o(s.isDeprecationLogIndexingEnabled),t.toasts.addSuccess(s.isDeprecationLogIndexingEnabled?Ts.enabledMessage:Ts.disabledMessage))},fetchError:a,updateError:p,resendRequest:i,onlyDeprecationLogWritingEnabled:c}};s(66);const Ms={fetchErrorMessage:T.i18n.translate("xpack.upgradeAssistant.overview.deprecationLogs.fetchErrorMessage",{defaultMessage:"Could not retrieve logging information."}),reloadButtonLabel:T.i18n.translate("xpack.upgradeAssistant.overview.deprecationLogs.reloadButtonLabel",{defaultMessage:"Try again"}),updateErrorMessage:T.i18n.translate("xpack.upgradeAssistant.overview.deprecationLogs.updateErrorMessage",{defaultMessage:"Could not update logging state."}),errorLabel:T.i18n.translate("xpack.upgradeAssistant.overview.deprecationLogs.errorLabel",{defaultMessage:"Error"}),buttonLabel:T.i18n.translate("xpack.upgradeAssistant.overview.deprecationLogs.buttonLabel",{defaultMessage:"Enable deprecation log collection"}),loadingLogsLabel:T.i18n.translate("xpack.upgradeAssistant.overview.loadingLogsLabel",{defaultMessage:"Loading deprecation log collection state…"})},ws=({error:e})=>{const[t,s]=Object(g.useState)(!1);if(!e.statusCode||!e.message)return null;const a=Object(v.jsx)(m.EuiLink,{color:"danger",onClick:()=>s(!t)},Ms.errorLabel," ",e.statusCode);return Object(v.jsx)(m.EuiPopover,{button:a,isOpen:t,closePopover:()=>s(!1)},Object(v.jsx)(m.EuiText,{style:{width:300}},Object(v.jsx)("p",null,e.message)))},Fs=({isDeprecationLogIndexingEnabled:e,isLoading:t,isUpdating:s,fetchError:a,updateError:n,resendRequest:i,toggleLogging:r})=>t?Object(v.jsx)(m.EuiFlexGroup,{gutterSize:"s",alignItems:"center",className:"upgToggleLoading"},Object(v.jsx)(m.EuiFlexItem,{grow:!1,className:"upgLoadingItem"},Object(v.jsx)(m.EuiLoadingSpinner,{size:"m"})),Object(v.jsx)(m.EuiFlexItem,{grow:!1},Ms.loadingLogsLabel)):a?Object(v.jsx)(m.EuiFlexGroup,{gutterSize:"none",alignItems:"center"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiFlexGroup,{gutterSize:"xs",alignItems:"flexEnd","data-test-subj":"fetchLoggingError"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiTextColor,{color:"danger"},Ms.fetchErrorMessage)),Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(ws,{error:a})))),Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiButtonEmpty,{iconType:"refresh",onClick:i},Ms.reloadButtonLabel))):Object(v.jsx)(m.EuiFlexGroup,{gutterSize:"m",alignItems:"center"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiSwitch,{"data-test-subj":"deprecationLoggingToggle",label:Ms.buttonLabel,checked:!!e,onChange:r,disabled:Boolean(a)||s})),n&&Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiFlexGroup,{gutterSize:"xs",alignItems:"flexEnd","data-test-subj":"updateLoggingError"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiTextColor,{color:"danger"},Ms.updateErrorMessage)),Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(ws,{error:n})))),s&&Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiLoadingSpinner,{size:"m"}))),Is="kibana.upgradeAssistant.lastCheckpoint",As=new O.h(window.localStorage),Ds=()=>{const e=Vt()(As.get(Is));if(e.isValid())return e.toISOString();const t=Vt()().toISOString();return As.set(Is,t),t},Rs={analyzeTitle:T.i18n.translate("xpack.upgradeAssistant.overview.analyzeTitle",{defaultMessage:"Analyze deprecation logs"}),deprecationsCountCheckpointTitle:T.i18n.translate("xpack.upgradeAssistant.overview.deprecationsCountCheckpointTitle",{defaultMessage:"Resolve deprecation issues and verify your changes"}),apiCompatibilityNoteTitle:T.i18n.translate("xpack.upgradeAssistant.overview.apiCompatibilityNoteTitle",{defaultMessage:"Apply API compatibility headers (optional)"}),apiCompatibilityNoteBody:e=>Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.overview.apiCompatibilityNoteBody",defaultMessage:"We recommend you resolve all deprecation issues before upgrading. If needed, you can apply API compatibility headers to requests that use deprecated features. {learnMoreLink}.",values:{learnMoreLink:Object(v.jsx)(m.EuiLink,{href:e,target:"_blank"},Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.overview.apiCompatibilityNoteLink",defaultMessage:"Learn more"}))}}),onlyLogWritingEnabledTitle:T.i18n.translate("xpack.upgradeAssistant.overview.deprecationLogs.deprecationWarningTitle",{defaultMessage:"Your logs are being written to the logs directory"}),onlyLogWritingEnabledBody:T.i18n.translate("xpack.upgradeAssistant.overview.deprecationLogs.deprecationWarningBody",{defaultMessage:"Go to your logs directory to view the deprecation logs or enable deprecation log collection to see them in Kibana."}),deniedPrivilegeTitle:T.i18n.translate("xpack.upgradeAssistant.overview.deprecationLogs.deniedPrivilegeTitle",{defaultMessage:"You require index privileges to analyze the deprecation logs"}),deniedPrivilegeDescription:e=>{var t,s;return Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.overview.deprecationLogs.deniedPrivilegeDescription",defaultMessage:"The deprecation logs will continue to be indexed, but you won't be able to analyze them until you have the read index {privilegesCount, plural, one {privilege} other {privileges}} for: {missingPrivileges}",values:{missingPrivileges:Object(v.jsx)(m.EuiCode,{transparentBackground:!0},null==e||null===(t=e.index)||void 0===t?void 0:t.join(", ")),privilegesCount:null==e||null===(s=e.index)||void 0===s?void 0:s.length}})}},Ps=({hasPrivileges:e,privilegesMissing:t})=>{const{services:{core:{docLinks:s}}}=k(),{isDeprecationLogIndexingEnabled:a,onlyDeprecationLogWritingEnabled:n,isLoading:i,isUpdating:r,fetchError:o,updateError:l,resendRequest:u,toggleLogging:c}=Ls(),[d,p]=Object(g.useState)(Ds());return Object(g.useEffect)((()=>{var e;e=d,As.set(Is,e)}),[d]),Object(v.jsx)(j.a.Fragment,null,Object(v.jsx)(Fs,{isDeprecationLogIndexingEnabled:a,isLoading:i,isUpdating:r,fetchError:o,updateError:l,resendRequest:u,toggleLogging:c}),n&&Object(v.jsx)(j.a.Fragment,null,Object(v.jsx)(m.EuiSpacer,{size:"m"}),Object(v.jsx)(m.EuiCallOut,{title:Rs.onlyLogWritingEnabledTitle,color:"warning",iconType:"help","data-test-subj":"deprecationWarningCallout"},Object(v.jsx)("p",null,Rs.onlyLogWritingEnabledBody))),!e&&a&&Object(v.jsx)(j.a.Fragment,null,Object(v.jsx)(m.EuiSpacer,{size:"m"}),Object(v.jsx)(m.EuiCallOut,{iconType:"help",color:"warning",title:Rs.deniedPrivilegeTitle,"data-test-subj":"noIndexPermissionsCallout"},Object(v.jsx)("p",null,Rs.deniedPrivilegeDescription(t)))),e&&a&&Object(v.jsx)(j.a.Fragment,null,Object(v.jsx)(m.EuiSpacer,{size:"xl"}),Object(v.jsx)(m.EuiText,{"data-test-subj":"externalLinksTitle"},Object(v.jsx)("h4",null,Rs.analyzeTitle)),Object(v.jsx)(m.EuiSpacer,{size:"m"}),Object(v.jsx)(ks,{checkpoint:d}),Object(v.jsx)(m.EuiSpacer,{size:"xl"}),Object(v.jsx)(m.EuiText,{"data-test-subj":"deprecationsCountTitle"},Object(v.jsx)("h4",null,Rs.deprecationsCountCheckpointTitle)),Object(v.jsx)(m.EuiSpacer,{size:"m"}),Object(v.jsx)(Ss,{checkpoint:d,setCheckpoint:p}),Object(v.jsx)(m.EuiSpacer,{size:"xl"}),Object(v.jsx)(m.EuiText,{"data-test-subj":"apiCompatibilityNoteTitle"},Object(v.jsx)("h4",null,Rs.apiCompatibilityNoteTitle)),Object(v.jsx)(m.EuiSpacer,{size:"m"}),Object(v.jsx)(m.EuiText,null,Object(v.jsx)("p",null,Rs.apiCompatibilityNoteBody(s.links.elasticsearch.apiCompatibilityHeader)))))},_s=()=>Object(v.jsx)(O.i,{privileges:`index.${h.g}`},(({hasPrivileges:e,privilegesMissing:t,isLoading:s})=>Object(v.jsx)(Ps,{hasPrivileges:!s&&e,privilegesMissing:t}))),Bs=()=>{const{services:{breadcrumbs:e,core:{docLinks:t}}}=k();return Object(g.useEffect)((()=>{M.s.trackUiMetric(L.METRIC_TYPE.LOADED,M.f)}),[]),Object(g.useEffect)((()=>{e.setBreadcrumbs("esDeprecationLogs")}),[e]),Object(v.jsx)(m.EuiPageBody,{restrictWidth:!0,"data-test-subj":"esDeprecationLogs"},Object(v.jsx)(m.EuiPageContentBody,{color:"transparent",paddingSize:"none"},Object(v.jsx)(m.EuiPageHeader,{bottomBorder:!0,pageTitle:T.i18n.translate("xpack.upgradeAssistant.esDeprecationLogs.pageTitle",{defaultMessage:"Elasticsearch deprecation logs"}),description:T.i18n.translate("xpack.upgradeAssistant.esDeprecationLogs.pageDescription",{defaultMessage:"Review the deprecation logs to determine if your applications are using any deprecated APIs. Update your applications to prevent errors or changes in behavior after you upgrade."}),rightSideItems:[Object(v.jsx)(m.EuiButtonEmpty,{href:t.links.elasticsearch.migrationApiDeprecation,target:"_blank",iconType:"help","data-test-subj":"documentationLink"},Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.esDeprecationLogs.documentationLinkText",defaultMessage:"Documentation"}))]}),Object(v.jsx)(m.EuiSpacer,{size:"l"}),Object(v.jsx)(_s,null)))},Ns=()=>{const{kibanaVersionInfo:e,services:{core:{docLinks:t}}}=k(),{nextMajor:s,currentMajor:a}=e,{ELASTIC_WEBSITE_URL:n}=t;return Object(v.jsx)(m.EuiPageContent,{verticalPosition:"center",horizontalPosition:"center",color:"subdued"},Object(v.jsx)(m.EuiEmptyPrompt,{iconType:"wrench","data-test-subj":"comingSoonPrompt",title:Object(v.jsx)("h2",null,Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.emptyPrompt.title",defaultMessage:"{uaVersion} Upgrade Assistant",values:{uaVersion:`${s}.0`}})),body:Object(v.jsx)(j.a.Fragment,null,Object(v.jsx)("p",null,Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.emptyPrompt.upgradeAssistantDescription",defaultMessage:"The Upgrade Assistant identifies deprecated settings in your cluster and helps you resolve issues before you upgrade. Check back here when it's time to upgrade to Elastic {nextMajor}.",values:{nextMajor:`${s}.0`}})),7===a&&Object(v.jsx)("p",null,Object(v.jsx)(m.EuiLink,{external:!0,target:"_blank",href:`${n}guide/en/elasticsearch/reference/master/migrating-8.0.html`},Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.emptyPrompt.learnMoreDescription",defaultMessage:"Learn more about migrating to {nextMajor}.",values:{nextMajor:`${s}.0`}}))))}))},zs=()=>{var e;const{plugins:{share:t}}=k(),s=null===(e=t.url.locators.get("SNAPSHOT_RESTORE_LOCATOR"))||void 0===e?void 0:e.useUrl({page:"snapshots"});return Object(v.jsx)(m.EuiButton,{href:s,onClick:()=>{M.s.trackUiMetric(L.METRIC_TYPE.CLICK,M.b)},"data-test-subj":"snapshotRestoreLink"},Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.overview.snapshotRestoreLink",defaultMessage:"Create snapshot"}))},Us=()=>Object(v.jsx)(j.a.Fragment,null,Object(v.jsx)(m.EuiText,null,Object(v.jsx)("p",null,T.i18n.translate("xpack.upgradeAssistant.overview.backupStepDescription",{defaultMessage:"Make sure you have a current snapshot before making any changes."}))),Object(v.jsx)(m.EuiSpacer,{size:"s"}),Object(v.jsx)(zs,null)),Ws=({cloudSnapshotsUrl:e,setIsComplete:t,setForceOnPremStep:s})=>{const{services:{api:a}}=k(),{isInitialRequest:n,isLoading:i,error:r,data:o,resendRequest:l}=a.useLoadCloudBackupStatus();if(Object(g.useEffect)((()=>{var e;i||(t(null!==(e=!r&&(null==o?void 0:o.isBackedUp))&&void 0!==e&&e),r&&(e=>404===e.statusCode&&e.message.toString().includes(h.d))(r)&&s(!0))}),[r,i,o,s]),n&&i)return Object(v.jsx)(m.EuiLoadingContent,{"data-test-subj":"cloudBackupLoading",lines:3});if(r)return Object(v.jsx)(m.EuiCallOut,{title:T.i18n.translate("xpack.upgradeAssistant.overview.cloudBackup.loadingError",{defaultMessage:"An error occurred while retrieving the latest snapshot status"}),color:"danger",iconType:"alert","data-test-subj":"cloudBackupErrorCallout"},Object(v.jsx)("p",null,r.statusCode," - ",r.message),Object(v.jsx)(m.EuiButton,{color:"danger",onClick:l,"data-test-subj":"cloudBackupRetryButton"},T.i18n.translate("xpack.upgradeAssistant.overview.cloudBackup.retryButton",{defaultMessage:"Try again"})));const u=Vt()(o.lastBackupTime).toISOString(),c=o.isBackedUp?Object(v.jsx)(m.EuiFlexGroup,{alignItems:"center",gutterSize:"s","data-test-subj":"dataBackedUpStatus"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiIcon,{type:"check",color:"success"})),Object(v.jsx)(m.EuiFlexItem,null,Object(v.jsx)(m.EuiText,null,Object(v.jsx)("p",null,Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.overview.cloudBackup.hasSnapshotMessage",defaultMessage:"Last snapshot created on {lastBackupTime}.",values:{lastBackupTime:Object(v.jsx)(j.a.Fragment,null,Object(v.jsx)(f.FormattedDate,{value:u,year:"numeric",month:"long",day:"2-digit"})," ",Object(v.jsx)(f.FormattedTime,{value:u,timeZoneName:"short",hour12:!1}))}}))))):Object(v.jsx)(m.EuiFlexGroup,{alignItems:"center",gutterSize:"s","data-test-subj":"dataNotBackedUpStatus"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiIcon,{type:"alert",color:"danger"})),Object(v.jsx)(m.EuiFlexItem,null,Object(v.jsx)(m.EuiText,null,Object(v.jsx)("p",null,T.i18n.translate("xpack.upgradeAssistant.overview.cloudBackup.noSnapshotMessage",{defaultMessage:"Your data isn't backed up."})))));return Object(v.jsx)(j.a.Fragment,null,c,Object(v.jsx)(m.EuiSpacer,{size:"s"}),Object(v.jsx)(m.EuiButton,{href:e,onClick:()=>{M.s.trackUiMetric(L.METRIC_TYPE.CLICK,M.a)},"data-test-subj":"cloudSnapshotsLink",target:"_blank",iconType:"popout",iconSide:"right"},Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.overview.cloudBackup.snapshotsLink",defaultMessage:"Create snapshot"})))},qs=T.i18n.translate("xpack.upgradeAssistant.overview.backupStepTitle",{defaultMessage:"Back up your data"}),Gs=({cloud:e,setIsComplete:t})=>{const[s,a]=Object(g.useState)(!1);return null!=e&&e.isCloudEnabled&&!s?Object(v.jsx)(Ws,{setIsComplete:t,cloudSnapshotsUrl:e.snapshotsUrl,setForceOnPremStep:a}):Object(v.jsx)(Us,null)},$s=({cloud:e,isComplete:t,setIsComplete:s})=>{const a=null!=e&&e.isCloudEnabled&&t?"complete":"incomplete";return{title:qs,status:a,"data-test-subj":`backupStep-${a}`,children:Object(v.jsx)(Gs,{cloud:e,setIsComplete:s})}},Ks=({children:e})=>Object(v.jsx)(m.EuiText,{color:"subdued","data-test-subj":"loadingIssuesError"},Object(v.jsx)(m.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiIcon,{type:"alert",color:"danger"})),Object(v.jsx)(m.EuiFlexItem,{grow:!1},e))),Ys={noPartialDeprecationIssuesText:T.i18n.translate("xpack.upgradeAssistant.noPartialDeprecationsMessage",{defaultMessage:"None"}),noDeprecationIssuesText:T.i18n.translate("xpack.upgradeAssistant.noDeprecationsMessage",{defaultMessage:"No issues"})},Qs=e=>{const{isPartial:t=!1}=e;return Object(v.jsx)(m.EuiText,{color:"success"},Object(v.jsx)(m.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiIcon,{type:"check"})),Object(v.jsx)(m.EuiFlexItem,{grow:!1,"data-test-subj":e["data-test-subj"]},t?Ys.noPartialDeprecationIssuesText:Ys.noDeprecationIssuesText)))};s(71);const Vs={warningDeprecationsTitle:T.i18n.translate("xpack.upgradeAssistant.deprecationStats.warningDeprecationsTitle",{defaultMessage:"Warning"}),criticalDeprecationsTitle:T.i18n.translate("xpack.upgradeAssistant.deprecationStats.criticalDeprecationsTitle",{defaultMessage:"Critical"})},Hs=e=>{const{deprecationSource:t,linkUrl:s,criticalDeprecationsCount:a,warningDeprecationsCount:n,isLoading:i,errorMessage:r,setIsFixed:o}=e,l=Object(b.useHistory)(),u=!!r,c=a>0,d=n>0,p=!(i||u||d||c);return Object(g.useEffect)((()=>{i||r||o(0===a)}),[o,a,i,r]),Object(v.jsx)(m.EuiCard,Pe()({"data-test-subj":e["data-test-subj"],className:"upgDeprecationIssuesPanel",layout:"horizontal",title:t,titleSize:"xs"},!p&&Object(O.j)(l,s)),Object(v.jsx)(m.EuiSpacer,{size:"s"}),u?Object(v.jsx)(Ks,null,r):p?Object(v.jsx)(Qs,{"data-test-subj":"noDeprecationIssues"}):Object(v.jsx)(m.EuiFlexGroup,null,Object(v.jsx)(m.EuiFlexItem,null,Object(v.jsx)(m.EuiStat,{"data-test-subj":"criticalDeprecations",className:"upgDeprecationIssuesPanel__stat",title:u?"--":c?Ce(a):Object(v.jsx)(Qs,{isPartial:!0,"data-test-subj":"noCriticalDeprecationIssues"}),titleElement:"span",description:Vs.criticalDeprecationsTitle,titleColor:"danger",isLoading:i})),Object(v.jsx)(m.EuiFlexItem,null,Object(v.jsx)(m.EuiStat,{"data-test-subj":"warningDeprecations",className:"upgDeprecationIssuesPanel__stat",title:u?"--":d?Ce(n):Object(v.jsx)(Qs,{isPartial:!0,"data-test-subj":"noWarningDeprecationIssues"}),titleElement:"span",description:Vs.warningDeprecationsTitle,isLoading:i}))))},Js=({setIsFixed:e})=>{var t,s,a,n,i,r;const{services:{api:o}}=k(),{data:l,isLoading:u,error:c}=o.useLoadEsDeprecations(),d=null!==(t=null==l||null===(s=l.deprecations)||void 0===s||null===(a=s.filter((e=>e.isCritical)))||void 0===a?void 0:a.length)&&void 0!==t?t:0,p=null!==(n=null==l||null===(i=l.deprecations)||void 0===i||null===(r=i.filter((e=>!1===e.isCritical)))||void 0===r?void 0:r.length)&&void 0!==n?n:0,g=c&&Z(c).message;return Object(v.jsx)(Hs,{"data-test-subj":"esStatsPanel",deprecationSource:"Elasticsearch",linkUrl:"/es_deprecations",criticalDeprecationsCount:d,warningDeprecationsCount:p,isLoading:u,errorMessage:g,setIsFixed:e})},Zs=({setIsFixed:e})=>{var t,s,a,n;const{services:{core:{deprecations:i}}}=k(),[r,o]=Object(g.useState)(void 0),[l,u]=Object(g.useState)(!1),[c,d]=Object(g.useState)(void 0);Object(g.useEffect)((()=>{!async function(){u(!0);try{const e=await i.getAllDeprecations();o(e)}catch(e){d(e)}u(!1)}()}),[i]);const p=null!==(t=null==r||null===(s=r.filter((e=>"critical"===e.level)))||void 0===s?void 0:s.length)&&void 0!==t?t:0,j=null!==(a=null==r||null===(n=r.filter((e=>"warning"===e.level)))||void 0===n?void 0:n.length)&&void 0!==a?a:0,x=c&&T.i18n.translate("xpack.upgradeAssistant.deprecationStats.loadingErrorMessage",{defaultMessage:"Could not retrieve Kibana deprecation issues."});return Object(v.jsx)(Hs,{"data-test-subj":"kibanaStatsPanel",deprecationSource:"Kibana",linkUrl:"/kibana_deprecations",criticalDeprecationsCount:p,warningDeprecationsCount:j,isLoading:l,errorMessage:x,setIsFixed:e})},Xs={reviewStepTitle:T.i18n.translate("xpack.upgradeAssistant.overview.fixIssuesStepTitle",{defaultMessage:"Review deprecated settings and resolve issues"})},ea=({setIsComplete:e})=>{const[t,s]=Object(g.useState)(!1),[a,n]=Object(g.useState)(!1);return Object(g.useEffect)((()=>{e(t&&a)}),[t,a]),Object(v.jsx)(m.EuiFlexGroup,null,Object(v.jsx)(m.EuiFlexItem,null,Object(v.jsx)(Js,{setIsFixed:s})),Object(v.jsx)(m.EuiFlexItem,null,Object(v.jsx)(Zs,{setIsFixed:n})))},ta=({isComplete:e,setIsComplete:t})=>{const s=e?"complete":"incomplete";return{title:Xs.reviewStepTitle,status:s,"data-test-subj":`fixIssuesStep-${s}`,children:Object(v.jsx)(j.a.Fragment,null,Object(v.jsx)(m.EuiText,null,Object(v.jsx)("p",null,Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.overview.fixIssuesStepDescription",defaultMessage:"You must resolve any critical Elasticsearch and Kibana configuration issues before upgrading to Elastic 8.x. Ignoring warnings might result in differences in behavior after you upgrade."}))),Object(v.jsx)(m.EuiSpacer,{size:"m"}),Object(v.jsx)(ea,{setIsComplete:t}))}},sa={upgradeStepTitle:T.i18n.translate("xpack.upgradeAssistant.overview.upgradeStepTitle",{defaultMessage:"Upgrade to Elastic 8.x"}),upgradeStepDescription:T.i18n.translate("xpack.upgradeAssistant.overview.upgradeStepDescription",{defaultMessage:"Once you’ve resolved all critical issues and verified that your applications are ready, you can upgrade to Elastic 8.x. Be sure to back up your data again before upgrading."}),upgradeStepDescriptionForCloud:T.i18n.translate("xpack.upgradeAssistant.overview.upgradeStepDescriptionForCloud",{defaultMessage:"Once you've resolved all critical issues and verified that your applications are ready, you can upgrade to Elastic 8.x. Be sure to back up your data again before upgrading. Upgrade your deployment on Elastic Cloud."}),upgradeStepCloudLink:T.i18n.translate("xpack.upgradeAssistant.overview.upgradeStepCloudLink",{defaultMessage:"Upgrade on Cloud"}),loadingUpgradeStatus:T.i18n.translate("xpack.upgradeAssistant.overview.loadingUpgradeStatus",{defaultMessage:"Loading upgrade status"}),upgradeGuideLink:T.i18n.translate("xpack.upgradeAssistant.overview.upgradeGuideLink",{defaultMessage:"View upgrade guide"})},aa=()=>{const{plugins:{cloud:e},services:{api:t,core:{docLinks:s}}}=k(),a=Boolean(null==e?void 0:e.isCloudEnabled),{data:n,isLoading:i,error:r,resendRequest:o}=t.useLoadUpgradeStatus();let l;if(a)if(r)l=Object(v.jsx)(m.EuiCallOut,{title:T.i18n.translate("xpack.upgradeAssistant.overview.errorLoadingUpgradeStatus",{defaultMessage:"An error occurred while retrieving the upgrade status"}),color:"danger",iconType:"alert","data-test-subj":"upgradeStatusErrorCallout"},Object(v.jsx)("p",null,r.statusCode," - ",r.message),Object(v.jsx)(m.EuiButton,{color:"danger",onClick:o,"data-test-subj":"upgradeStatusRetryButton",isLoading:i},T.i18n.translate("xpack.upgradeAssistant.overview.upgradeStatus.retryButton",{defaultMessage:"Try again"})));else{const t=null==n?void 0:n.readyForUpgrade,a=e.deploymentUrl+"?show_upgrade=true";l=Object(v.jsx)(m.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiButton,{href:a,target:"_blank","data-test-subj":"upgradeSetupCloudLink",iconSide:"right",iconType:"popout",isLoading:i,isDisabled:!t},i?sa.loadingUpgradeStatus:sa.upgradeStepCloudLink)),Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiButtonEmpty,{href:s.links.upgrade.upgradingStackOnCloud,target:"_blank","data-test-subj":"upgradeSetupDocsLink",iconSide:"right",iconType:"popout"},sa.upgradeGuideLink)))}else l=Object(v.jsx)(m.EuiButton,{href:s.links.upgrade.upgradingStackOnPrem,target:"_blank","data-test-subj":"upgradeSetupDocsLink",iconSide:"right",iconType:"popout"},sa.upgradeGuideLink);return Object(v.jsx)(j.a.Fragment,null,Object(v.jsx)(m.EuiText,null,Object(v.jsx)("p",null,a?sa.upgradeStepDescriptionForCloud:sa.upgradeStepDescription)),Object(v.jsx)(m.EuiSpacer,{size:"m"}),l)};var na=s(76),ia=s.n(na);const ra={closeButtonLabel:T.i18n.translate("xpack.upgradeAssistant.overview.systemIndices.flyoutCloseButtonLabel",{defaultMessage:"Close"}),flyoutTitle:T.i18n.translate("xpack.upgradeAssistant.overview.systemIndices.flyoutTitle",{defaultMessage:"Migrate system indices"}),flyoutDescription:T.i18n.translate("xpack.upgradeAssistant.overview.systemIndices.flyoutDescription",{defaultMessage:"Migrate the indices that store information for the following features before you upgrade."}),migrationCompleteLabel:T.i18n.translate("xpack.upgradeAssistant.overview.systemIndices.migrationCompleteLabel",{defaultMessage:"Migration complete"}),needsMigrationLabel:T.i18n.translate("xpack.upgradeAssistant.overview.systemIndices.needsMigrationLabel",{defaultMessage:"Migration required"}),migratingLabel:T.i18n.translate("xpack.upgradeAssistant.overview.systemIndices.migratingLabel",{defaultMessage:"Migration in progress"}),errorLabel:T.i18n.translate("xpack.upgradeAssistant.overview.systemIndices.errorLabel",{defaultMessage:"Migration failed"}),featureNameTableColumn:T.i18n.translate("xpack.upgradeAssistant.overview.systemIndices.featureNameTableColumn",{defaultMessage:"Feature"}),statusTableColumn:T.i18n.translate("xpack.upgradeAssistant.overview.systemIndices.statusTableColumn",{defaultMessage:"Status"})},oa=[{field:"feature_name",name:ra.featureNameTableColumn,sortable:!0,truncateText:!0,render:e=>Object(X.startCase)(e)},{field:"migration_status",name:ra.statusTableColumn,sortable:!0,render:e=>"NO_MIGRATION_NEEDED"===e?Object(v.jsx)(m.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiIcon,{type:"checkInCircleFilled",color:"success"})),Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiText,{color:"green",size:"s","data-test-subj":"featureNoUpgradeNeeded"},Object(v.jsx)("p",null,ra.migrationCompleteLabel)))):"MIGRATION_NEEDED"===e?Object(v.jsx)(m.EuiText,{size:"s","data-test-subj":"featureUpgradeNeeded"},Object(v.jsx)("p",null,ra.needsMigrationLabel)):"IN_PROGRESS"===e?Object(v.jsx)(m.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiLoadingSpinner,{size:"m"})),Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiText,{color:"subdued",size:"s","data-test-subj":"featureInProgress"},Object(v.jsx)("p",null,ra.migratingLabel)))):"ERROR"===e?Object(v.jsx)(m.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiIcon,{type:"alert",color:"danger"})),Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiText,{color:"danger",size:"s","data-test-subj":"featureError"},Object(v.jsx)("p",null,ra.errorLabel)))):""}],la=({closeFlyout:e,data:t})=>Object(v.jsx)(j.a.Fragment,null,Object(v.jsx)(m.EuiFlyoutHeader,{hasBorder:!0},Object(v.jsx)(m.EuiTitle,{size:"s","data-test-subj":"flyoutTitle"},Object(v.jsx)("h2",null,ra.flyoutTitle))),Object(v.jsx)(m.EuiFlyoutBody,{"data-test-subj":"flyoutDetails"},Object(v.jsx)(m.EuiText,null,Object(v.jsx)("p",null,ra.flyoutDescription)),Object(v.jsx)(m.EuiSpacer,{size:"l"}),Object(v.jsx)(m.EuiInMemoryTable,{"data-test-subj":"featuresTable",itemId:"feature_name",items:t.features,columns:oa,pagination:!0,sorting:!0})),Object(v.jsx)(m.EuiFlyoutFooter,null,Object(v.jsx)(m.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiButtonEmpty,{onClick:e,flush:"left"},ra.closeButtonLabel))))),ua="migrateSystemIndicesFlyout",{useGlobalFlyout:ca}=O.c,da={title:T.i18n.translate("xpack.upgradeAssistant.overview.systemIndices.title",{defaultMessage:"Migrate system indices"}),bodyDescription:e=>Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.overview.systemIndices.body",defaultMessage:"Prepare the system indices that store internal information for the upgrade. Any {hiddenIndicesLink} that need to be reindexed are shown in the next step.",values:{hiddenIndicesLink:Object(v.jsx)(m.EuiLink,{external:!0,target:"_blank",href:e},Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.overview.systemIndices.body.hiddenIndicesLink",defaultMessage:"hidden indices"}))}}),startButtonLabel:T.i18n.translate("xpack.upgradeAssistant.overview.systemIndices.startButtonLabel",{defaultMessage:"Migrate indices"}),inProgressButtonLabel:T.i18n.translate("xpack.upgradeAssistant.overview.systemIndices.inProgressButtonLabel",{defaultMessage:"Migration in progress"}),noMigrationNeeded:T.i18n.translate("xpack.upgradeAssistant.overview.systemIndices.noMigrationNeeded",{defaultMessage:"Migration complete"}),viewSystemIndicesStatus:T.i18n.translate("xpack.upgradeAssistant.overview.systemIndices.viewSystemIndicesStatus",{defaultMessage:"View migration details"}),retryButtonLabel:T.i18n.translate("xpack.upgradeAssistant.overview.systemIndices.retryButtonLabel",{defaultMessage:"Retry migration"}),loadingError:T.i18n.translate("xpack.upgradeAssistant.overview.systemIndices.loadingError",{defaultMessage:"Could not retrieve the system indices status"}),migrationFailedTitle:T.i18n.translate("xpack.upgradeAssistant.overview.systemIndices.migrationFailedTitle",{defaultMessage:"System indices migration failed"}),migrationFailedBody:e=>{const{feature:t,failureCause:s}=(e=>{const t=e.find((e=>"ERROR"===e.migration_status));if(t){var s;const e=t.indices.find((e=>e.failure_cause));return{feature:null==t?void 0:t.feature_name,failureCause:null==e||null===(s=e.failure_cause)||void 0===s?void 0:s.error.type}}return{}})(e);return Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.overview.systemIndices.migrationFailedBody",defaultMessage:"An error ocurred while migrating system indices for {feature}: {failureCause}",values:{feature:t,failureCause:Object(v.jsx)(m.EuiCode,null,s)}})}},pa=({setIsComplete:e})=>{var t,s,a,n,i;const{beginSystemIndicesMigration:r,startMigrationStatus:o,migrationStatus:l,setShowFlyout:u}=(()=>{const{services:{api:e}}=k(),[t,s]=Object(g.useState)(!1),[a,n]=Object(g.useState)({statusType:"idle"}),{data:i,error:r,isLoading:o,resendRequest:l,isInitialRequest:u}=e.useLoadSystemIndicesMigrationStatus(),c="IN_PROGRESS"===(null==i?void 0:i.migration_status);ia()(l,c?h.l:null);const{addContent:d,removeContent:p}=ca(),j=Object(g.useCallback)((()=>{s(!1),p(ua)}),[p]);Object(g.useEffect)((()=>{t&&d({id:ua,Component:la,props:{data:i,closeFlyout:j},flyoutProps:{onClose:j}})}),[d,i,t,j]);const x=Object(g.useCallback)((async()=>{const{error:t}=await e.migrateSystemIndices();n({statusType:t?"error":"started",error:null!=t?t:void 0}),t||l()}),[e,l]);return{setShowFlyout:s,startMigrationStatus:a,beginSystemIndicesMigration:x,migrationStatus:{data:i,error:r,isLoading:o,resendRequest:l,isInitialRequest:u}}})();if(Object(g.useEffect)((()=>{var t;e("NO_MIGRATION_NEEDED"===(null===(t=l.data)||void 0===t?void 0:t.migration_status))}),[null===(t=l.data)||void 0===t?void 0:t.migration_status]),l.error)return Object(v.jsx)(m.EuiCallOut,{title:da.loadingError,color:"danger",iconType:"alert","data-test-subj":"systemIndicesStatusErrorCallout"},Object(v.jsx)("p",null,l.error.statusCode," - ",l.error.message),Object(v.jsx)(m.EuiButton,{color:"danger",isLoading:l.isLoading,onClick:l.resendRequest,"data-test-subj":"systemIndicesStatusRetryButton"},da.retryButtonLabel));if("NO_MIGRATION_NEEDED"===(null===(s=l.data)||void 0===s?void 0:s.migration_status))return Object(v.jsx)(m.EuiFlexGroup,{alignItems:"center",gutterSize:"s","data-test-subj":"noMigrationNeededSection"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiIcon,{type:"check",color:"success"})),Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiText,{color:"success"},Object(v.jsx)("p",null,da.noMigrationNeeded))));const c=l.isInitialRequest&&l.isLoading,d="IN_PROGRESS"===(null===(a=l.data)||void 0===a?void 0:a.migration_status);return Object(v.jsx)(j.a.Fragment,null,"error"===o.statusType&&Object(v.jsx)(j.a.Fragment,null,Object(v.jsx)(m.EuiCallOut,{size:"s",color:"danger",iconType:"alert",title:`${o.error.statusCode} - ${o.error.message}`,"data-test-subj":"startSystemIndicesMigrationCalloutError"}),Object(v.jsx)(m.EuiSpacer,{size:"m"})),"ERROR"===(null===(n=l.data)||void 0===n?void 0:n.migration_status)&&Object(v.jsx)(j.a.Fragment,null,Object(v.jsx)(m.EuiCallOut,{size:"s",color:"danger",iconType:"alert",title:da.migrationFailedTitle,"data-test-subj":"migrationFailedCallout"},Object(v.jsx)("p",null,da.migrationFailedBody(null===(i=l.data)||void 0===i?void 0:i.features))),Object(v.jsx)(m.EuiSpacer,{size:"m"})),Object(v.jsx)(m.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiButton,{isLoading:d,isDisabled:c,onClick:r,"data-test-subj":"startSystemIndicesMigrationButton"},d?da.inProgressButtonLabel:da.startButtonLabel)),Object(v.jsx)(m.EuiFlexItem,{grow:!1},Object(v.jsx)(m.EuiButtonEmpty,{onClick:()=>u(!0),isDisabled:c,"data-test-subj":"viewSystemIndicesStateButton"},da.viewSystemIndicesStatus))))},ga=({isComplete:e,setIsComplete:t,docLinks:s})=>{const a=e?"complete":"incomplete";return{title:da.title,status:a,"data-test-subj":`migrateSystemIndicesStep-${a}`,children:Object(v.jsx)(j.a.Fragment,null,Object(v.jsx)(m.EuiText,null,Object(v.jsx)("p",null,da.bodyDescription(s.links.elasticsearch.hiddenIndices))),Object(v.jsx)(m.EuiSpacer,{size:"m"}),Object(v.jsx)(pa,{setIsComplete:t}))}},ja={logsStepTitle:T.i18n.translate("xpack.upgradeAssistant.overview.logsStep.title",{defaultMessage:"Address API deprecations"}),logsStepDescription:T.i18n.translate("xpack.upgradeAssistant.overview.logsStep.description",{defaultMessage:"Review the Elasticsearch deprecation logs to ensure you're not using deprecated APIs."}),viewLogsButtonLabel:T.i18n.translate("xpack.upgradeAssistant.overview.logsStep.viewLogsButtonLabel",{defaultMessage:"View logs"}),enableLogsButtonLabel:T.i18n.translate("xpack.upgradeAssistant.overview.logsStep.enableLogsButtonLabel",{defaultMessage:"Enable logging"}),logsCountDescription:(e,t)=>Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.overview.logsStep.countDescription",defaultMessage:"You have {deprecationCount, plural, =0 {no} other {{deprecationCount}}} deprecation {deprecationCount, plural, one {issue} other {issues}} since {checkpoint}.",values:{deprecationCount:e,checkpoint:Object(v.jsx)(j.a.Fragment,null,Object(v.jsx)(f.FormattedDate,{value:t,year:"numeric",month:"long",day:"2-digit"})," ",Object(v.jsx)(f.FormattedTime,{value:t,timeZoneName:"short",hour12:!1}))}}),missingPrivilegesTitle:T.i18n.translate("xpack.upgradeAssistant.overview.logsStep.missingPrivilegesTitle",{defaultMessage:"You require index privileges to analyze the deprecation logs"}),missingPrivilegesDescription:e=>{var t,s;return Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.overview.logsStep.missingPrivilegesDescription",defaultMessage:"The deprecation logs will continue to be indexed, but you won't be able to analyze them until you have the read index {privilegesCount, plural, one {privilege} other {privileges}} for: {missingPrivileges}",values:{missingPrivileges:Object(v.jsx)(m.EuiCode,{transparentBackground:!0},null==e||null===(t=e.index)||void 0===t?void 0:t.join(", ")),privilegesCount:null==e||null===(s=e.index)||void 0===s?void 0:s.length}})},loadingError:T.i18n.translate("xpack.upgradeAssistant.overview.logsStep.loadingError",{defaultMessage:"An error occurred while retrieving the deprecation log count"}),retryButton:T.i18n.translate("xpack.upgradeAssistant.overview.logsStep.retryButton",{defaultMessage:"Try again"})},xa=()=>Object(v.jsx)(m.EuiText,null,Object(v.jsx)("p",null,ja.logsStepDescription)),ba=({setIsComplete:e,hasPrivileges:t,privilegesMissing:s,navigateToEsDeprecationLogs:a})=>{const{services:{api:n}}=k(),{isDeprecationLogIndexingEnabled:i}=Ls(),r=Ds(),{data:o,error:l,isLoading:u,resendRequest:c,isInitialRequest:d}=n.getDeprecationLogsCount(r);return Object(g.useEffect)((()=>{i||e(!1),e(0===(null==o?void 0:o.count))}),[i,o]),!1===t&&i?Object(v.jsx)(j.a.Fragment,null,Object(v.jsx)(xa,null),Object(v.jsx)(m.EuiSpacer,null),Object(v.jsx)(m.EuiCallOut,{iconType:"help",color:"warning",title:ja.missingPrivilegesTitle,"data-test-subj":"missingPrivilegesCallout"},Object(v.jsx)("p",null,ja.missingPrivilegesDescription(s)))):u&&d?Object(v.jsx)(m.EuiLoadingContent,{lines:3}):t&&l?Object(v.jsx)(m.EuiCallOut,{title:ja.loadingError,color:"danger",iconType:"alert","data-test-subj":"deprecationLogsErrorCallout"},Object(v.jsx)("p",null,l.statusCode," - ",l.message),Object(v.jsx)(m.EuiButton,{color:"danger",onClick:c,"data-test-subj":"deprecationLogsRetryButton"},ja.retryButton)):Object(v.jsx)(j.a.Fragment,null,Object(v.jsx)(xa,null),i&&o?Object(v.jsx)(j.a.Fragment,null,Object(v.jsx)(m.EuiSpacer,null),Object(v.jsx)(m.EuiText,null,Object(v.jsx)("p",{"data-test-subj":"logsCountDescription"},ja.logsCountDescription(o.count,r))),Object(v.jsx)(m.EuiSpacer,null),Object(v.jsx)(m.EuiButton,{onClick:a,"data-test-subj":"viewLogsLink"},ja.viewLogsButtonLabel)):Object(v.jsx)(j.a.Fragment,null,Object(v.jsx)(m.EuiSpacer,null),Object(v.jsx)(m.EuiButton,{onClick:a,"data-test-subj":"enableLogsLink"},ja.enableLogsButtonLabel)),Object(v.jsx)(m.EuiSpacer,{size:"m"}))},fa=({isComplete:e,setIsComplete:t,navigateToEsDeprecationLogs:s})=>{const a=e?"complete":"incomplete";return{status:a,title:ja.logsStepTitle,"data-test-subj":`logsStep-${a}`,children:Object(v.jsx)(O.i,{privileges:`index.${h.g}`},(({hasPrivileges:e,isLoading:a,privilegesMissing:n})=>Object(v.jsx)(ba,{setIsComplete:t,hasPrivileges:!a&&e,navigateToEsDeprecationLogs:s,privilegesMissing:n})))}},ma=Object(b.withRouter)((({history:e})=>{const{services:{breadcrumbs:t,core:{docLinks:s}},plugins:{cloud:a}}=k();Object(g.useEffect)((()=>{M.s.trackUiMetric(L.METRIC_TYPE.LOADED,M.m)}),[]),Object(g.useEffect)((()=>{t.setBreadcrumbs("overview")}),[t]);const[n,i]=Object(g.useState)({backup:!1,migrate_system_indices:!1,fix_issues:!1,logs:!1}),r=e=>n[e],o=(e,t)=>{i({...n,[e]:t})};return Object(v.jsx)(m.EuiPageBody,{restrictWidth:!0,"data-test-subj":"overview"},Object(v.jsx)(m.EuiPageContentBody,{color:"transparent",paddingSize:"none"},Object(v.jsx)(m.EuiPageHeader,{bottomBorder:!0,pageTitle:T.i18n.translate("xpack.upgradeAssistant.overview.pageTitle",{defaultMessage:"Upgrade Assistant"}),description:T.i18n.translate("xpack.upgradeAssistant.overview.pageDescription",{defaultMessage:"Get ready for the next version of Elastic!"}),rightSideItems:[Object(v.jsx)(m.EuiButtonEmpty,{href:s.links.upgradeAssistant.overview,target:"_blank",iconType:"help","data-test-subj":"documentationLink"},Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.overview.documentationLinkText",defaultMessage:"Documentation"}))]},Object(v.jsx)(m.EuiText,{"data-test-subj":"whatsNewLink"},Object(v.jsx)(m.EuiLink,{href:s.links.elasticsearch.version8ReleaseHighlights,target:"_blank"},Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.overview.whatsNewLink",defaultMessage:"What's new in 8.x?"})))),Object(v.jsx)(m.EuiSpacer,{size:"l"}),Object(v.jsx)(m.EuiSteps,{steps:[$s({cloud:a,isComplete:r("backup"),setIsComplete:o.bind(null,"backup")}),ga({docLinks:s,isComplete:r("migrate_system_indices"),setIsComplete:o.bind(null,"migrate_system_indices")}),ta({isComplete:r("fix_issues"),setIsComplete:o.bind(null,"fix_issues")}),fa({isComplete:r("logs"),setIsComplete:o.bind(null,"logs"),navigateToEsDeprecationLogs:()=>e.push("/es_deprecation_logs")}),{title:sa.upgradeStepTitle,status:"incomplete","data-test-subj":"upgradeStep",children:Object(v.jsx)(aa,null)}]})))})),{GlobalFlyoutProvider:ha}=O.c,Oa=()=>{const{isReadOnlyMode:e,services:{api:t,core:s}}=k(),a=!0!==s.application.capabilities.spaces.manage,[n,i]=Object(g.useState)("isPreparingForUpgrade");return Object(g.useEffect)((()=>{t.onClusterUpgradeStateChange((e=>{i(e)}))}),[t]),a?Object(v.jsx)(m.EuiPageContent,{verticalPosition:"center",horizontalPosition:"center",color:"subdued","data-test-subj":"missingKibanaPrivilegesMessage"},Object(v.jsx)(O.e,{title:Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.app.deniedPrivilegeTitle",defaultMessage:"Kibana admin role required"}),message:Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.app.deniedPrivilegeDescription",defaultMessage:"To use Upgrade Assistant and resolve deprecation issues, you must have access to manage all Kibana spaces."})})):e?Object(v.jsx)(Ns,null):"isUpgrading"===n?Object(v.jsx)(m.EuiPageContent,{hasShadow:!1,paddingSize:"none",verticalPosition:"center",horizontalPosition:"center","data-test-subj":"isUpgradingMessage"},Object(v.jsx)(m.EuiEmptyPrompt,{iconType:"logoElasticsearch",title:Object(v.jsx)("h1",null,Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.upgradingTitle",defaultMessage:"Your cluster is upgrading"})),body:Object(v.jsx)("p",null,Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.upgradingDescription",defaultMessage:"One or more Elasticsearch nodes have a newer version of Elasticsearch than Kibana. Once all your nodes are upgraded, upgrade Kibana."})),"data-test-subj":"emptyPrompt"})):"isUpgradeComplete"===n?Object(v.jsx)(m.EuiPageContent,{hasShadow:!1,paddingSize:"none",verticalPosition:"center",horizontalPosition:"center","data-test-subj":"isUpgradeCompleteMessage"},Object(v.jsx)(m.EuiEmptyPrompt,{iconType:"logoElasticsearch",title:Object(v.jsx)("h1",null,Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.upgradedTitle",defaultMessage:"Your cluster has been upgraded"})),body:Object(v.jsx)("p",null,Object(v.jsx)(f.FormattedMessage,{id:"xpack.upgradeAssistant.upgradedDescription",defaultMessage:"All Elasticsearch nodes have been upgraded. You may now upgrade Kibana."})),"data-test-subj":"emptyPrompt"})):Object(v.jsx)(b.Switch,null,Object(v.jsx)(b.Route,{exact:!0,path:"/overview",component:ma}),Object(v.jsx)(b.Route,{exact:!0,path:"/es_deprecations",component:mt}),Object(v.jsx)(b.Route,{exact:!0,path:"/es_deprecation_logs",component:Bs}),Object(v.jsx)(b.Route,{exact:!0,path:"/kibana_deprecations",component:H}),Object(v.jsx)(b.Redirect,{from:"/",to:"/overview"}))},va=({history:e})=>{const{services:{api:t}}=k(),{isLoading:s,isInitialRequest:a}=t.useLoadClusterUpgradeStatus();return s&&a?Object(v.jsx)(m.EuiPageContent,{hasShadow:!1,paddingSize:"none",verticalPosition:"center",horizontalPosition:"center"},Object(v.jsx)(m.EuiEmptyPrompt,{body:Object(v.jsx)(m.EuiLoadingSpinner,{size:"l"})})):Object(v.jsx)(b.Router,{history:e},Object(v.jsx)(Oa,null))},ya=e=>{const{history:t,core:{i18n:s,application:a,http:n}}=e.services;return Object(v.jsx)(O.f,{application:a,className:O.a},Object(v.jsx)(O.b,{httpClient:n,privilegesEndpoint:`${h.a}/privileges`},Object(v.jsx)(s.Context,null,Object(v.jsx)(O.d,{theme$:e.theme$},Object(v.jsx)(E,{value:e},Object(v.jsx)(ha,null,Object(v.jsx)(va,{history:t})))))))};var Ea=s(10),ka=s(13);function Ca(e,t){const{element:s,setBreadcrumbs:a}=e;return Ea.a.setup(t.services.core.http),ka.a.setup(a),Object(x.render)(Object(v.jsx)(ya,t),s),()=>{Object(x.unmountComponentAtNode)(s)}}}])]);