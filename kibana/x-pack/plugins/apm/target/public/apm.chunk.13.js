/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.apm_bundle_jsonpfunction=window.apm_bundle_jsonpfunction||[]).push([[13],{1060:function(e,t,n){"use strict";n.r(t),n.d(t,"renderApp",(function(){return de}));var a=n(1),r=n.n(a),i=n(46),o=n.n(i),l=(n(472),n(21)),s=n(19),c=n(66),p=n(0),u=n(140),d=n(39),m=n(79),v=n(30),g=n(33),b=n(14),f=n(43);class scroll_to_top_on_path_change_ScrollToTopOnPathChange extends a.Component{componentDidUpdate(e){this.props.location.pathname!==e.location.pathname&&window.scrollTo(0,0)}render(){return null}}var h=n(186),x=n(185),_=n(54),y=n(188),E=n(464),k=n(129),w=n(465),A=n(13),j=n(75),T=n(12),M=n(141),S=n(53),O=n(11),C=n(56);function P(e){const{addFlyoutVisible:t,setAddFlyoutVisibility:n,alertType:i}=e,o=Object(M.a)(),{query:l}=Object(S.b)("/*"),c="rangeFrom"in l?l.rangeFrom:void 0,p="rangeTo"in l?l.rangeTo:void 0,{start:u,end:d}=Object(C.a)({rangeFrom:c,rangeTo:p,optional:!0}),m="environment"in l?l.environment:O.a.value,v="transactionType"in l?l.transactionType:void 0,{services:g}=Object(s.useKibana)(),b=function(e,t){const n=e?T.a[e].name:void 0,a=n?t?`${n} | ${t}`:n:void 0,r=["apm"];return t&&r.push(`service.name:${t}`.toLowerCase()),{tags:r,...a?{name:a}:{}}}(i,o),f=Object(a.useCallback)((()=>n(!1)),[n]),h=Object(a.useMemo)((()=>i&&g.triggersActionsUi.getAddAlertFlyout({consumer:T.c,onClose:f,ruleTypeId:i,canChangeTrigger:!1,initialValues:b,metadata:{environment:m,serviceName:o,...i===T.d.ErrorCount?{}:{transactionType:v},start:u,end:d}})),[i,m,f,g.triggersActionsUi,o,v,m,u,d]);return r.a.createElement(r.a.Fragment,null,t&&h)}const R=p.i18n.translate("xpack.apm.home.alertsMenu.alerts",{defaultMessage:"Alerts and rules"}),L=p.i18n.translate("xpack.apm.home.alertsMenu.transactionDuration",{defaultMessage:"Latency"}),z=p.i18n.translate("xpack.apm.home.alertsMenu.transactionErrorRate",{defaultMessage:"Failed transaction rate"}),F=p.i18n.translate("xpack.apm.home.alertsMenu.errorCount",{defaultMessage:" Create error count rule"}),D=p.i18n.translate("xpack.apm.home.alertsMenu.createThresholdAlert",{defaultMessage:"Create threshold rule"}),I=p.i18n.translate("xpack.apm.home.alertsMenu.createAnomalyAlert",{defaultMessage:"Create anomaly rule"}),N="create_threshold_panel";function U({basePath:e,canSaveAlerts:t,canReadAlerts:n,canReadAnomalies:i,includeTransactionDuration:o}){const[l,s]=Object(a.useState)(!1),[c,u]=Object(a.useState)(null),{plugins:{observability:d}}=Object(_.a)(),m=r.a.createElement(A.EuiHeaderLink,{color:"text",iconType:"arrowDown",iconSide:"right",onClick:()=>s((e=>!e))},R),v=[{id:0,title:R,items:[...t?[{name:D,panel:N},...i?[{name:I,onClick:()=>{u(T.d.Anomaly),s(!1)}}]:[],{name:F,onClick:()=>{u(T.d.ErrorCount),s(!1)}}]:[],...n?[{name:p.i18n.translate("xpack.apm.home.alertsMenu.viewActiveAlerts",{defaultMessage:"Manage rules"}),href:d.useRulesLink().href,icon:"tableOfContents"}]:[]]},{id:N,title:D,items:[...o?[{name:L,onClick:()=>{u(T.d.TransactionDuration),s(!1)}}]:[],{name:z,onClick:()=>{u(T.d.TransactionErrorRate),s(!1)}}]}];return r.a.createElement(r.a.Fragment,null,r.a.createElement(A.EuiPopover,{id:"integrations-menu",button:m,isOpen:l,closePopover:()=>s(!1),panelPaddingSize:"none",anchorPosition:"downRight"},r.a.createElement(A.EuiContextMenu,{initialPanelId:0,panels:v})),r.a.createElement(P,{alertType:c,addFlyoutVisible:!!c,setAddFlyoutVisibility:e=>{e||u(null)}}))}var H=n(128),V=n(112),$=n(57);function J(){const{query:e}=Object(S.b)("/*"),t="environment"in e&&e.environment||O.a.value,{core:n}=Object(_.a)(),{basePath:a}=n.http,i=Object($.a)(),{anomalyDetectionSetupState:o}=Object(V.a)();let l,s="",c="text";o===H.a.Failure?(c="warning",s=p.i18n.translate("xpack.apm.anomalyDetectionSetup.jobFetchFailureText",{defaultMessage:"Could not determine state of anomaly detection setup."}),l="alert"):o===H.a.NoJobs||o===H.a.NoJobsForEnvironment?(c="warning",s=function(e,t){return e===H.a.NoJobs?p.i18n.translate("xpack.apm.anomalyDetectionSetup.notEnabledText",{defaultMessage:"Anomaly detection is not yet enabled. Click to continue setup."}):p.i18n.translate("xpack.apm.anomalyDetectionSetup.notEnabledForEnvironmentText",{defaultMessage:'Anomaly detection is not yet enabled for the environment "{currentEnvironment}". Click to continue setup.',values:{currentEnvironment:Object(O.d)(t)}})}(o,t),l="alert"):o===H.a.UpgradeableJobs&&(c="success",s=p.i18n.translate("xpack.apm.anomalyDetectionSetup.upgradeableJobsText",{defaultMessage:"Updates available for existing anomaly detection jobs."}),l="wrench");let u=null;o===H.a.Loading?u=r.a.createElement(A.EuiLoadingSpinner,{size:"s"}):l&&(u=r.a.createElement(A.EuiIcon,{type:l,color:c,size:"s"}));const d=r.a.createElement(A.EuiHeaderLink,{color:c,href:Object(j.b)({basePath:a,path:"/settings/anomaly-detection"}),style:{whiteSpace:"nowrap"}},u,r.a.createElement("span",{style:{marginInlineStart:i.eui.euiSizeS}},q));return s?r.a.createElement(A.EuiToolTip,{position:"bottom",content:s},d):d}const q=p.i18n.translate("xpack.apm.anomalyDetectionSetup.linkLabel",{defaultMessage:"Anomaly detection"});function B(){const{inspector:e}=Object(_.a)(),{inspectorAdapters:t}=Object(b.useInspectorContext)(),{services:{uiSettings:n}}=Object(s.useKibana)();return(null==n?void 0:n.get(b.enableInspectEsQueries))?r.a.createElement(A.EuiHeaderLink,{color:"primary",onClick:()=>{e.open(t)}},p.i18n.translate("xpack.apm.inspectButtonText",{defaultMessage:"Inspect"})):null}function K(){var e;const{core:t,plugins:n}=Object(_.a)(),a=Object(M.a)(),{search:i}=window.location,{application:o,http:l}=t,{basePath:s}=l,{capabilities:c}=o,u=!(null===(e=c.ml)||void 0===e||!e.canAccessML),{isAlertingAvailable:d,canReadAlerts:m,canSaveAlerts:v,canReadAnomalies:g}=((e,t)=>{const n=!!t.apm["alerting:show"],a=!!t.apm["alerting:save"];return{isAlertingAvailable:!!e.alerting&&(n||a),canReadAlerts:n,canSaveAlerts:a,canReadAnomalies:!!("ml"in e&&t.ml.canAccessML&&t.ml.canGetJobs)}})(n,c),b=c.apm.save&&v;return r.a.createElement(A.EuiHeaderLinks,{gutterSize:"xs"},r.a.createElement(A.EuiHeaderLink,{color:"text",href:("/settings",Object(j.b)({basePath:s,path:"/settings",search:i}))},p.i18n.translate("xpack.apm.settingsLinkLabel",{defaultMessage:"Settings"})),u&&r.a.createElement(J,null),d&&r.a.createElement(U,{basePath:s,canReadAlerts:m,canSaveAlerts:b,canReadAnomalies:g,includeTransactionDuration:void 0!==a}),r.a.createElement(A.EuiHeaderLink,{color:"primary",href:s.prepend("/app/home#/tutorial/apm"),iconType:"indexOpen"},p.i18n.translate("xpack.apm.addDataButtonLabel",{defaultMessage:"Add data"})),r.a.createElement(B,null))}var G=n(64),W=n(88),Q=n.n(W),X=n(20);function Y({apmRouter:e,location:t}){return e.getRoutesToMatch(t.pathname).some((e=>"/services"===e.path||"/traces"===e.path||"/service-map"===e.path||"/backends"===e.path||"/services/{serviceName}"===e.path||"/service-groups"===e.path||"/"===t.pathname||""===t.pathname))}function Z({children:e}){const{isDateRangeSet:t,redirect:n}=function(){const e=Object(v.useHistory)(),t=Object(v.useLocation)(),n=Q.a.parse(t.search),{core:a,plugins:r}=Object(_.a)(),i=a.uiSettings.get(X.UI_SETTINGS.TIMEPICKER_TIME_DEFAULTS),o=r.data.query.timefilter.timefilter.getTime();return{isDateRangeSet:"rangeFrom"in n&&"rangeTo"in n,redirect:()=>{var a,r;const l={rangeFrom:null!==(a=o.from)&&void 0!==a?a:i.from,rangeTo:null!==(r=o.to)&&void 0!==r?r:i.to,...n};e.replace({...t,search:Q.a.stringify(l)})}}}(),a=Y({apmRouter:Object(G.a)(),location:Object(v.useLocation)()});return!t&&a?(n(),null):e}var ee=n(462);function te({children:e}){const t=Object(m.h)();return Object(b.useTrackPageview)({app:"apm",path:t},[t]),Object(b.useTrackPageview)({app:"apm",path:t,delay:15e3},[t]),e}var ne=n(193);function ae({children:e}){const t=Object(v.useLocation)(),n=Q.a.parse(t.search),a=Object(ne.a)();return"environment"in n?e:"/services"===t.pathname.replace(/\/$/,"")?r.a.createElement(v.Redirect,{to:Q.a.stringifyUrl({url:t.pathname,query:{...n,environment:a}})}):e}var re=n(62),ie=n(455),oe=n(90);function le({children:e}){const{core:t}=Object(_.a)(),n=Object(v.useLocation)(),a=Y({apmRouter:Object(G.a)(),location:n}),i=Q.a.parse(n.search);if(a&&("comparisonType"in i||!("comparisonEnabled"in i))){const{comparisonType:e,comparisonEnabled:a,...o}=i,l=Object(ie.a)({core:t,urlComparisonEnabled:a?Object(oe.c)(a):void 0}).toString(),s=e,c=re.b[s];return r.a.createElement(v.Redirect,{to:Q.a.stringifyUrl({url:n.pathname,query:{comparisonEnabled:l,...c?{offset:c}:{},...o}})})}return e}const se=new f.Storage(localStorage);function ce({apmPluginContextValue:e,pluginsStart:t}){const{appMountParameters:n,core:a}=e,{history:i}=n,o=a.i18n;return r.a.createElement(s.RedirectAppLinks,{application:a.application,className:l.APP_WRAPPER_CLASS,"data-test-subj":"apmMainContainer",role:"main"},r.a.createElement(x.a.Provider,{value:e},r.a.createElement(s.KibanaContextProvider,{services:{...a,...t,storage:se}},r.a.createElement(o.Context,null,r.a.createElement(k.b,null,r.a.createElement(m.c,{history:i,router:ee.a},r.a.createElement(ae,null,r.a.createElement(Z,null,r.a.createElement(le,null,r.a.createElement(te,null,r.a.createElement(y.b,null,r.a.createElement(w.b,null,r.a.createElement(E.b,null,r.a.createElement(h.b,null,r.a.createElement(b.InspectorContextProvider,null,r.a.createElement(ue,null,r.a.createElement(pe,null),r.a.createElement(v.Route,{component:scroll_to_top_on_path_change_ScrollToTopOnPathChange}),r.a.createElement(m.b,null)))))))))))))))))}function pe(){const{setHeaderActionMenu:e,theme$:t}=Object(_.a)().appMountParameters;return r.a.createElement(b.HeaderMenuPortal,{setHeaderActionMenu:e,theme$:t},r.a.createElement(K,null))}function ue({children:e}){const[t]=Object(s.useUiSetting$)("theme:darkMode");return r.a.createElement(g.ThemeProvider,{theme:e=>({...e,eui:t?d.euiDarkVars:d.euiLightVars,darkMode:t})},e)}const de=({coreStart:e,pluginsSetup:t,appMountParameters:n,config:a,pluginsStart:i,observabilityRuleTypeRegistry:d})=>{const{element:m,theme$:v}=n,g={appMountParameters:n,config:a,core:e,plugins:t,data:i.data,inspector:i.inspector,observability:i.observability,observabilityRuleTypeRegistry:d,dataViews:i.dataViews,unifiedSearch:i.unifiedSearch};return function({chrome:e,http:t}){e.setHelpExtension({appName:p.i18n.translate("xpack.apm.feedbackMenu.appName",{defaultMessage:"APM"}),links:[{linkType:"discuss",href:"https://discuss.elastic.co/c/apm"},{linkType:"custom",href:Object(u.a)(t.basePath),content:p.i18n.translate("xpack.apm.helpMenu.upgradeAssistantLink",{defaultMessage:"Upgrade assistant"})}]})}(e),function({application:e,chrome:t}){const n=e.capabilities.apm.save,{setBadge:a}=t;a(n?void 0:{text:p.i18n.translate("xpack.apm.header.badge.readOnly.text",{defaultMessage:"Read only"}),tooltip:p.i18n.translate("xpack.apm.header.badge.readOnly.tooltip",{defaultMessage:"Unable to save"}),iconType:"glasses"})}(e),Object(c.createCallApmApi)(e),(async()=>await Object(c.callApmApi)("POST /internal/apm/data_view/static",{signal:null}))().catch((e=>{console.log("Error creating static data view",e)})),m.classList.add(l.APP_WRAPPER_CLASS),o.a.render(r.a.createElement(s.KibanaThemeProvider,{theme$:v},r.a.createElement(ce,{apmPluginContextValue:g,pluginsStart:i})),m),()=>{o.a.unmountComponentAtNode(m)}}},472:function(e,t,n){var a=n(473),r=n(474);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);a(r,{insert:"head",singleton:!1}),e.exports=r.locals||{}},473:function(e,t,n){"use strict";var a,r=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),i=[];function o(e){for(var t=-1,n=0;n<i.length;n++)if(i[n].identifier===e){t=n;break}return t}function l(e,t){for(var n={},a=[],r=0;r<e.length;r++){var l=e[r],s=t.base?l[0]+t.base:l[0],c=n[s]||0,p="".concat(s," ").concat(c);n[s]=c+1;var u=o(p),d={css:l[1],media:l[2],sourceMap:l[3]};-1!==u?(i[u].references++,i[u].updater(d)):i.push({identifier:p,updater:g(d,t),references:1}),a.push(p)}return a}function s(e){var t=document.createElement("style"),a=e.attributes||{};if(void 0===a.nonce){var i=n.nc;i&&(a.nonce=i)}if(Object.keys(a).forEach((function(e){t.setAttribute(e,a[e])})),"function"==typeof e.insert)e.insert(t);else{var o=r(e.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}return t}var c,p=(c=[],function(e,t){return c[e]=t,c.filter(Boolean).join("\n")});function u(e,t,n,a){var r=n?"":a.media?"@media ".concat(a.media," {").concat(a.css,"}"):a.css;if(e.styleSheet)e.styleSheet.cssText=p(t,r);else{var i=document.createTextNode(r),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(i,o[t]):e.appendChild(i)}}function d(e,t,n){var a=n.css,r=n.media,i=n.sourceMap;if(r?e.setAttribute("media",r):e.removeAttribute("media"),i&&"undefined"!=typeof btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleSheet)e.styleSheet.cssText=a;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(a))}}var m=null,v=0;function g(e,t){var n,a,r;if(t.singleton){var i=v++;n=m||(m=s(t)),a=u.bind(null,n,i,!1),r=u.bind(null,n,i,!0)}else n=s(t),a=d.bind(null,n,t),r=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return a(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;a(e=t)}else r()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===a&&(a=Boolean(window&&document&&document.all&&!window.atob)),a));var n=l(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var a=0;a<n.length;a++){var r=o(n[a]);i[r].references--}for(var s=l(e,t),c=0;c<n.length;c++){var p=o(n[c]);0===i[p].references&&(i[p].updater(),i.splice(p,1))}n=s}}}},474:function(e,t,n){(t=n(475)(!1)).push([e.i,".react-vis-magic-css-import-rule{display:inherit}.rv-treemap{font-size:12px;position:relative}.rv-treemap__leaf{overflow:hidden;position:absolute}.rv-treemap__leaf--circle{align-items:center;border-radius:100%;display:flex;justify-content:center}.rv-treemap__leaf__content{overflow:hidden;padding:10px;text-overflow:ellipsis}.rv-xy-plot{color:#c3c3c3;position:relative}.rv-xy-plot canvas{pointer-events:none}.rv-xy-plot .rv-xy-canvas{pointer-events:none;position:absolute}.rv-xy-plot__inner{display:block}.rv-xy-plot__axis__line{fill:none;stroke-width:2px;stroke:#e6e6e9}.rv-xy-plot__axis__tick__line{stroke:#e6e6e9}.rv-xy-plot__axis__tick__text{fill:#6b6b76;font-size:11px}.rv-xy-plot__axis__title text{fill:#6b6b76;font-size:11px}.rv-xy-plot__grid-lines__line{stroke:#e6e6e9}.rv-xy-plot__circular-grid-lines__line{fill-opacity:0;stroke:#e6e6e9}.rv-xy-plot__series,.rv-xy-plot__series path{pointer-events:all}.rv-xy-plot__circular-grid-lines__line{fill-opacity:0;stroke:#e6e6e9}.rv-xy-plot__series,.rv-xy-plot__series path{pointer-events:all}.rv-xy-plot__series--line{fill:none;stroke:#000;stroke-width:2px}.rv-crosshair{position:absolute;font-size:11px;pointer-events:none}.rv-crosshair__line{background:#47d3d9;width:1px}.rv-crosshair__inner{position:absolute;text-align:left;top:0}.rv-crosshair__inner__content{border-radius:4px;background:#3a3a48;color:#fff;font-size:12px;padding:7px 10px;box-shadow:0 2px 4px rgba(0,0,0,0.5)}.rv-crosshair__inner--left{right:4px}.rv-crosshair__inner--right{left:4px}.rv-crosshair__title{font-weight:bold;white-space:nowrap}.rv-crosshair__item{white-space:nowrap}.rv-hint{position:absolute;pointer-events:none}.rv-hint__content{border-radius:4px;padding:7px 10px;font-size:12px;background:#3a3a48;box-shadow:0 2px 4px rgba(0,0,0,0.5);color:#fff;text-align:left;white-space:nowrap}.rv-discrete-color-legend{box-sizing:border-box;overflow-y:auto;font-size:12px}.rv-discrete-color-legend.horizontal{white-space:nowrap}.rv-discrete-color-legend-item{color:#3a3a48;border-radius:1px;padding:9px 10px}.rv-discrete-color-legend-item.horizontal{display:inline-block}.rv-discrete-color-legend-item.horizontal .rv-discrete-color-legend-item__title{margin-left:0;display:block}.rv-discrete-color-legend-item__color{background:#dcdcdc;display:inline-block;height:2px;vertical-align:middle;width:14px}.rv-discrete-color-legend-item__title{margin-left:10px}.rv-discrete-color-legend-item.disabled{color:#b8b8b8}.rv-discrete-color-legend-item.clickable{cursor:pointer}.rv-discrete-color-legend-item.clickable:hover{background:#f9f9f9}.rv-search-wrapper{display:flex;flex-direction:column}.rv-search-wrapper__form{flex:0}.rv-search-wrapper__form__input{width:100%;color:#a6a6a5;border:1px solid #e5e5e4;padding:7px 10px;font-size:12px;box-sizing:border-box;border-radius:2px;margin:0 0 9px;outline:0}.rv-search-wrapper__contents{flex:1;overflow:auto}.rv-continuous-color-legend{font-size:12px}.rv-continuous-color-legend .rv-gradient{height:4px;border-radius:2px;margin-bottom:5px}.rv-continuous-size-legend{font-size:12px}.rv-continuous-size-legend .rv-bubbles{text-align:justify;overflow:hidden;margin-bottom:5px;width:100%}.rv-continuous-size-legend .rv-bubble{background:#d8d9dc;display:inline-block;vertical-align:bottom}.rv-continuous-size-legend .rv-spacer{display:inline-block;font-size:0;line-height:0;width:100%}.rv-legend-titles{height:16px;position:relative}.rv-legend-titles__left,.rv-legend-titles__right,.rv-legend-titles__center{position:absolute;white-space:nowrap;overflow:hidden}.rv-legend-titles__center{display:block;text-align:center;width:100%}.rv-legend-titles__right{right:0}.rv-radial-chart .rv-xy-plot__series--label{pointer-events:none}\n",""]),e.exports=t},475:function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n,a,r,i=e[1]||"",o=e[3];if(!o)return i;if(t&&"function"==typeof btoa){var l=(n=o,a=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),r="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),"/*# ".concat(r," */")),s=o.sources.map((function(e){return"/*# sourceURL=".concat(o.sourceRoot||"").concat(e," */")}));return[i].concat(s).concat([l]).join("\n")}return[i].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,a){"string"==typeof e&&(e=[[null,e,""]]);var r={};if(a)for(var i=0;i<this.length;i++){var o=this[i][0];null!=o&&(r[o]=!0)}for(var l=0;l<e.length;l++){var s=[].concat(e[l]);a&&r[s[0]]||(n&&(s[2]?s[2]="".concat(n," and ").concat(s[2]):s[2]=n),t.push(s))}},t}}}]);