/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.lens_bundle_jsonpfunction=window.lens_bundle_jsonpfunction||[]).push([[9],{433:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(7),o=a(434);t.default=function(e,t){var a=o.useFirstMountState();n.useEffect((function(){if(!a)return e()}),t)}},434:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useFirstMountState=void 0;var n=a(7);t.useFirstMountState=function(){var e=n.useRef(!0);return e.current?(e.current=!1,!0):e.current}},464:function(e,t,a){"use strict";a.r(t);var n=a(73),o=a.n(n),l=a(0),r=a(7),i=a.n(r),s=a(132),u=a.n(s),c=a(2),d=a(5),p=a(21),v=a.n(p),g=a(69),m=a.n(g),b=a(76),j=["palettes","activePalette","setPalette","showCustomPalette","showDynamicColorOnly"];function y(e){var t=e.palettes,a=e.activePalette,n=e.setPalette,o=e.showCustomPalette,l=e.showDynamicColorOnly,r=m()(e,j),i=t.getAll().filter((function(e){var t=e.internal,a=e.canDynamicColoring;return l?a:!t})).map((function(e){var t,n=e.id,o=e.title,l=(0,e.getCategoricalColors)((null==a||null===(t=a.params)||void 0===t?void 0:t.steps)||b.b,n===(null==a?void 0:a.name)?null==a?void 0:a.params:void 0);return{value:n,title:o,type:b.h,palette:l,"data-test-subj":"".concat(n,"-palette")}}));return o&&i.push(function(e,t){var a,n=e.get(b.a),o=n.id,l=n.title;if(t&&t.name!==b.a){var r=e.get(t.name);if(r){var i,s,u=r.getCategoricalColors((null==t||null===(i=t.params)||void 0===i?void 0:i.steps)||b.b,null==t?void 0:t.params),c=null!==(s=t.params)&&void 0!==s&&s.reverse?u.reverse():u;return{value:o,title:l,type:b.h,palette:c,"data-test-subj":"custom-palette"}}}return null!=t&&null!==(a=t.params)&&void 0!==a&&a.stops?{value:o,title:l,type:b.h,"data-test-subj":"custom-palette",palette:(t.params.colorStops||t.params.stops).map((function(e){return e.color}))}:{value:o,title:l,type:"text","data-test-subj":"custom-palette"}}(t,a)),Object(c.jsx)(d.EuiColorPalettePicker,v()({"data-test-subj":"lns-palettePicker",compressed:!0,palettes:i,onChange:function(e){n({type:"palette",name:e})},valueOfSelected:(null==a?void 0:a.name)||b.f,selectionDisplay:"palette"},r))}var f=a(71),h=a.n(f),x=a(105),O=a.n(x),C=a(85),P=a.n(C),I=function(e){return"end"===e},M=function(e){var t=e[e.length-1];return[].concat(P()(e),[{start:t.end,color:t.color,end:void 0}]).sort((function(e,t){var a=e.start,n=t.start;return Number(a)-Number(n)})).reduce((function(e,a,n,o){var l=a.color;return n===o.length-2&&o[n+1].start!==t.end&&(l=o[n+1].color),n!==o.length-1&&e.push({color:l,start:a.start,end:o[n+1].start}),e}),[])},w=function(e,t,a){var n=P()(e);return n[t]=h()(h()({},n[t]),a),n},T=function(e,t,a,n){var o=t?parseFloat(t):Number.NaN,l=n;return"end"===a?l=w(l,e,{end:o}):(l=w(l,e,{start:o}),e>0&&(l=w(l,e-1,{end:o}))),l};function N(e,t,a,n,o){var l,r,i,s,u,c=null!==(l=null!=o?o:null===(r=t.params)||void 0===r?void 0:r.continuity)&&void 0!==l?l:b.c,d=a;a.some((function(e,t){return t!==a.length-1&&e.start>a[t+1].start}))&&(d=M(a));var p=function(e,t){var a=Object(b.k)(t)?Number.NEGATIVE_INFINITY:e[0].start,n=Object(b.j)(t)?Number.POSITIVE_INFINITY:e[e.length-1].end;return{min:a,max:n,colorStops:e.map((function(e,t){return{color:e.color,stop:0===t?a:e.start}}))}}(d,c),v=p.max,g=p.colorStops,m=function(e,t,a,n){var o;if((null==t||null===(o=t.params)||void 0===o?void 0:o.name)===b.a){var l=Object(b.n)(e,h()(h()({steps:b.b},t.params),a),{dataBounds:n});return _(t,h()(h()({},a),{},{stops:l}))}var r=h()(h()(h()({steps:b.b},t.params),a),{},{name:b.a}),i=Object(b.n)(e,r,{prevPalette:r.colorStops?void 0:t.name,dataBounds:n});return _({name:b.a,type:"palette"},h()(h()({},r),{},{stops:i}))}(e,t,{continuity:c,colorStops:g,steps:(null===(i=t.params)||void 0===i?void 0:i.steps)||b.b,reverse:null===(s=t.params)||void 0===s?void 0:s.reverse,rangeMin:null===(u=g[0])||void 0===u?void 0:u.stop,rangeMax:v},n);return{activePalette:m,colorRanges:a}}function E(e,t,a){var n;return{colorRanges:S(e,(null===(n=t.params)||void 0===n?void 0:n.colorStops)||[],t,a),activePalette:t}}function _(e,t){return h()(h()({},e),{},{params:h()(h()({},e.params),t)})}function V(e){return""!==e&&/^#/.test(e)&&function(e){try{return O()(e),!0}catch(e){return!1}}(e)}function R(e,t,a,n){var o;if((null==a?void 0:a.name)===b.a&&null!=t&&t.length)return t;var l=Object(b.n)(e,h()({},null==a?void 0:a.params),{dataBounds:n,mapFromMinValue:!0,defaultPaletteName:a.name});return null!=a&&null!==(o=a.params)&&void 0!==o&&o.reverse&&(l=Object(b.o)(l)),l}function S(e,t,a,n){var o,l=null!==(o=a.params)&&void 0!==o?o:{},r=l.continuity,i=void 0===r?b.c:r,s=l.rangeType,u=void 0===s?b.g:s,c=Object(b.l)(u,n),d=c.min,p=c.max;return R(e,t||[],a,n).map((function(e,t,n){var o,l,r,s,u,c,v,g=0===t,m=t===n.length-1;return{color:e.color,start:g&&Object(b.k)(i)?Number.NEGATIVE_INFINITY:null!==(o=null!==(l=e.stop)&&void 0!==l?l:null===(r=a.params)||void 0===r?void 0:r.rangeMin)&&void 0!==o?o:d,end:m&&Object(b.j)(i)?Number.POSITIVE_INFINITY:null!==(s=null!==(u=null===(c=n[t+1])||void 0===c?void 0:c.stop)&&void 0!==u?u:null===(v=a.params)||void 0===v?void 0:v.rangeMax)&&void 0!==s?s:p}}))}var B=a(31),F=a(32),A=function(e){return Object(c.jsx)("svg",v()({width:"15",height:"12",viewBox:"0 0 15 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),Object(c.jsx)("path",{d:"M4 .5a.5.5 0 0 1 1 0v11a.5.5 0 0 1-1 0V.5ZM0 3a1 1 0 0 1 1-1h2v8H1a1 1 0 0 1-1-1V3ZM10.5 0a.5.5 0 0 0-.5.5v11a.5.5 0 0 0 1 0V.5a.5.5 0 0 0-.5-.5ZM6 2h3v8H6V2ZM14 2h-2v8h2a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1Z"}))},k=["children","condition","tooltipContent"],L=function(e){var t=e.children,a=e.condition,n=e.tooltipContent,o=m()(e,k);return Object(c.jsx)(i.a.Fragment,null,a?Object(c.jsx)(d.EuiToolTip,v()({content:n,delay:"long"},o),Object(c.jsx)(i.a.Fragment,null,t)):t)},D=i.a.createContext({});function Y(e){var t=e.dispatch,a=e.shouldDisableAdd,n=void 0!==a&&a,o=e.shouldDisableReverse,i=void 0!==o&&o,s=e.shouldDisableDistribute,u=void 0!==s&&s,p=Object(r.useContext)(D),v=p.dataBounds,g=p.palettes,m=Object(r.useCallback)((function(){t({type:"addColorRange",payload:{dataBounds:v,palettes:g}})}),[v,t,g]),b=Object(r.useCallback)((function(){t({type:"reversePalette",payload:{dataBounds:v,palettes:g}})}),[t,v,g]),j=Object(r.useCallback)((function(){t({type:"distributeEqually",payload:{dataBounds:v,palettes:g}})}),[v,t,g]),y=l.i18n.translate("coloring.dynamicColoring.customPalette.oneColorRange",{defaultMessage:"Requires more than one color"});return Object(c.jsx)(d.EuiFlexGroup,{justifyContent:"flexStart",gutterSize:"none",wrap:!0},Object(c.jsx)(d.EuiFlexItem,{grow:!1},Object(c.jsx)(L,{tooltipContent:l.i18n.translate("coloring.dynamicColoring.customPalette.maximumStepsApplied",{defaultMessage:"You've applied the maximum number of steps"}),condition:n,position:"top",delay:"regular"},Object(c.jsx)(d.EuiButtonEmpty,{"data-test-subj":"lnsPalettePanel_dynamicColoring_addColor",iconType:"plusInCircle",color:"primary","aria-label":l.i18n.translate("coloring.dynamicColoring.customPalette.addColorAriaLabel",{defaultMessage:"Add color"}),size:"xs",flush:"left",disabled:n,onClick:m},Object(c.jsx)(F.FormattedMessage,{id:"coloring.dynamicColoring.customPalette.addColor",defaultMessage:"Add color"})))),Object(c.jsx)(d.EuiFlexItem,{grow:!1},Object(c.jsx)(L,{tooltipContent:y,condition:i,position:"top",delay:"regular"},Object(c.jsx)(d.EuiButtonEmpty,{"data-test-subj":"lnsPalettePanel_dynamicColoring_reverseColors",iconType:"sortable",color:"primary","aria-label":l.i18n.translate("coloring.dynamicColoring.customPaletteAriaLabel",{defaultMessage:"Reverse colors"}),size:"xs",flush:"left",onClick:b,disabled:i},Object(c.jsx)(F.FormattedMessage,{id:"coloring.dynamicColoring.customPalette.reverseColors",defaultMessage:"Reverse colors"})))),Object(c.jsx)(d.EuiFlexItem,{grow:!1},Object(c.jsx)(L,{tooltipContent:y,condition:u,position:"top",delay:"regular"},Object(c.jsx)(d.EuiButtonEmpty,{"data-test-subj":"lnsPalettePanel_dynamicColoring_distributeValues",iconType:A,color:"primary","aria-label":l.i18n.translate("coloring.dynamicColoring.customPalette.distributeValuesAriaLabel",{defaultMessage:"Distribute values"}),size:"xs",flush:"left",disabled:u,onClick:j},Object(c.jsx)(F.FormattedMessage,{id:"coloring.dynamicColoring.customPalette.distributeValues",defaultMessage:"Distribute values"})))))}var Z=a(433),G=a.n(Z),z=function(e){return Object(c.jsx)("svg",v()({width:"24",height:"24",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},e),Object(c.jsx)("path",{d:"M6 .5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5V8h4V6.5a.5.5 0 0 1 .82-.384l3 2.5a.5.5 0 0 1 0 .768l-3 2.5A.5.5 0 0 1 12 11.5V10H6.5a.5.5 0 0 1-.5-.5v-9Z"}))},H=function(e){return Object(c.jsx)("svg",v()({width:"16",height:"14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),Object(c.jsx)("path",{d:"M8 0a.5.5 0 0 1 .384.18l2.5 3A.5.5 0 0 1 10.5 4h-5a.5.5 0 0 1-.384-.82l2.5-3A.5.5 0 0 1 8 0ZM.916 5.223A.5.5 0 0 0 0 5.5v5a.5.5 0 0 0 1 0V7.151l1.084 1.626a.5.5 0 0 0 .832 0L4 7.151V10.5a.5.5 0 0 0 1 0v-5a.5.5 0 0 0-.916-.277L2.5 7.599.916 5.223Z"}),Object(c.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.5 5h-.545l-.098.006a3.572 3.572 0 0 0-1.33.36 2.693 2.693 0 0 0-1.052.911C6.18 6.72 6 7.287 6 8v2.5a.5.5 0 0 0 1 0V9h2v1.5a.5.5 0 0 0 1 0v-5a.5.5 0 0 0-.5-.5Zm-.5.5V5v.5ZM7 8h2V6h-.011a2.57 2.57 0 0 0-.297.032c-.202.034-.463.1-.718.228a1.695 1.695 0 0 0-.667.572C7.133 7.092 7 7.462 7 8Z"}),Object(c.jsx)("path",{d:"M11.188 5.11a.5.5 0 0 1 .702.078L13.5 7.2l1.61-2.012a.5.5 0 1 1 .78.624L14.14 8l1.75 2.188a.5.5 0 1 1-.78.624L13.5 8.8l-1.61 2.012a.5.5 0 0 1-.78-.624L12.86 8l-1.75-2.188a.5.5 0 0 1 .078-.702Z"}))},W=function(e){return Object(c.jsx)("svg",v()({width:"16",height:"14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),Object(c.jsx)("path",{d:"M10.367.018a.5.5 0 0 1 .562.225L13 3.695V.5a.5.5 0 0 1 1 0v5a.5.5 0 0 1-.929.257L11 2.305V5.5a.5.5 0 0 1-1 0v-5a.5.5 0 0 1 .367-.482ZM.916.223A.5.5 0 0 0 0 .5v5a.5.5 0 0 0 1 0V2.151l1.084 1.626a.5.5 0 0 0 .832 0L4 2.151V5.5a.5.5 0 0 0 1 0v-5a.5.5 0 0 0-.916-.277L2.5 2.599.916.223ZM7 11a.5.5 0 0 0 .384-.18l2.5-3A.5.5 0 0 0 9.5 7h-5a.5.5 0 0 0-.384.82l2.5 3A.5.5 0 0 0 7 11ZM6.5 0a.5.5 0 0 0 0 1H7v4h-.5a.5.5 0 0 0 0 1h2a.5.5 0 0 0 0-1H8V1h.5a.5.5 0 0 0 0-1h-2Z"}))},q=function(e,t){switch(t){case"none":return e?"above":"below";case"above":return e?"none":"all";case"below":return e?"all":"none";case"all":return e?"below":"above"}};function U(e){var t=e.index,a=e.dispatch,n=Object(r.useContext)(D),o=n.dataBounds,i=n.palettes,s=Object(r.useCallback)((function(){a({type:"deleteColorRange",payload:{index:t,dataBounds:o,palettes:i}})}),[a,t,o,i]),u=l.i18n.translate("coloring.dynamicColoring.customPalette.deleteButtonAriaLabel",{defaultMessage:"Delete"});return Object(c.jsx)(d.EuiButtonIcon,{iconType:"trash",color:"danger","aria-label":u,title:u,onClick:s,"data-test-subj":"lnsPalettePanel_dynamicColoring_removeColorRange_".concat(t)})}function J(e){var t=e.index,a=e.continuity,n=e.dispatch,o=e.accessor,i=Object(r.useContext)(D),s=i.dataBounds,u=i.palettes,p=i.disableSwitchingContinuity,v=I(o),g=Object(r.useCallback)((function(){var e=q(v,a);n({type:"updateContinuity",payload:{isLast:v,continuity:e,dataBounds:s,palettes:u}})}),[v,n,a,s,u]),m=v?l.i18n.translate("coloring.dynamicColoring.customPalette.setCustomMinValue",{defaultMessage:"Set custom maximum value"}):l.i18n.translate("coloring.dynamicColoring.customPalette.setCustomMaxValue",{defaultMessage:"Set custom minimum value"});return p&&(m=l.i18n.translate("coloring.dynamicColoring.customPalette.disallowedEditMinMaxValues",{defaultMessage:"You cannot set custom value for current configuration"})),Object(c.jsx)(L,{tooltipContent:m,condition:!0,position:"top",delay:"regular"},Object(c.jsx)(d.EuiButtonIcon,{iconType:"pencil","aria-label":m,disabled:p,onClick:g,"data-test-subj":"lnsPalettePanel_dynamicColoring_editValue_".concat(t)}))}function K(e){var t=e.continuity,a=e.dispatch,n=e.accessor,o=Object(r.useContext)(D),i=o.dataBounds,s=o.palettes,u=I(n),p=Object(r.useCallback)((function(){var e=q(u,t);a({type:"updateContinuity",payload:{isLast:u,continuity:e,dataBounds:i,palettes:s}})}),[t,i,a,u,s]),v=u?l.i18n.translate("coloring.dynamicColoring.customPalette.useAutoMaxValue",{defaultMessage:"Use maximum data value"}):l.i18n.translate("coloring.dynamicColoring.customPalette.useAutoMinValue",{defaultMessage:"Use minimum data value"});return Object(c.jsx)(L,{tooltipContent:v,condition:!0,position:"top",delay:"regular"},Object(c.jsx)(d.EuiButtonIcon,{iconType:u?H:W,"aria-label":v,onClick:p,"data-test-subj":"lnsPalettePanel_dynamicColoring_autoDetect_".concat(u?"maximum":"minimum")}))}var Q=function(e){return e?l.i18n.translate("coloring.dynamicColoring.customPalette.maxValuePlaceholder",{defaultMessage:"Max. value"}):l.i18n.translate("coloring.dynamicColoring.customPalette.minValuePlaceholder",{defaultMessage:"Min. value"})},X=function(e,t){var a=[];return"percent"===e&&"auto"!==t&&a.push("%"),a};function $(e){var t,a=e.accessor,n=e.index,i=e.colorRange,s=e.rangeType,u=e.colorRanges,p=e.validation,v=e.continuity,g=e.dispatch,m=Object(r.useContext)(D),j=m.dataBounds,y=m.palettes,f=Object(r.useState)(!1),h=o()(f,2),x=h[0],O=h[1],C=Object(r.useState)(i[a]),P=o()(C,2),M=P[0],w=P[1],T=I(a),N=function(e,t,a){return!t&&e>0?"value":(t?b.j:b.k)(a)?"auto":"edit"}(n,T,v),E="auto"===N,_=V(i.color),R=function(e){return"value"===e?U:"edit"===e?K:J}(N),S=null===(t=null==p?void 0:p.isValid)||void 0===t||t,B=Object(r.useCallback)((function(e){var t,a,o,l,r,s,c,d=null!==(t=null===(a=u[n-1])||void 0===a?void 0:a.start)&&void 0!==t?t:Number.NEGATIVE_INFINITY,p=null!==(o=null===(l=u[n+1])||void 0===l?void 0:l.start)&&void 0!==o?o:Number.POSITIVE_INFINITY,v=null!==(r=null===(s=u[u.length-1])||void 0===s?void 0:s.end)&&void 0!==r?r:Number.POSITIVE_INFINITY,m=i.start>p||d>i.start||!T&&i.start>v,b=(null===(c=e.currentTarget)||void 0===c?void 0:c.contains(e.relatedTarget))||x;m&&!b&&g({type:"sortColorRanges",payload:{dataBounds:j,palettes:y}})}),[i.start,u,g,n,x,j,y,T]),F=Object(r.useCallback)((function(e){var t=e.target.value;w(t),g({type:"updateValue",payload:{index:n,value:t,accessor:a,dataBounds:j,palettes:y}})}),[g,n,a,j,y]),A=Object(r.useCallback)((function(e){g({type:"updateColor",payload:{index:n,color:e,dataBounds:j,palettes:y}})}),[g,n,j,y]);G()((function(){Number.isNaN(i[a])||i[a]===M||w(i[a])}),[M,i,a]);var k=l.i18n.translate("coloring.dynamicColoring.customPalette.selectNewColor",{defaultMessage:"Select a new color"});return Object(c.jsx)(d.EuiFlexGroup,{alignItems:"center",gutterSize:"s",wrap:!1,responsive:!1},Object(c.jsx)(d.EuiFlexItem,{grow:!1},T?Object(c.jsx)(d.EuiIcon,{type:z,size:"l"}):Object(c.jsx)(d.EuiColorPicker,{onChange:A,button:_?Object(c.jsx)(d.EuiColorPickerSwatch,{color:i.color,"aria-label":k}):Object(c.jsx)(d.EuiButtonIcon,{color:"danger",iconType:"stopSlash",iconSize:"l","aria-label":k}),secondaryInputDisplay:"top",color:i.color,showAlpha:!0,onFocus:function(){return O(!0)},onBlur:function(){O(!1)},isInvalid:!_})),Object(c.jsx)(d.EuiFlexItem,{grow:!0},Object(c.jsx)(d.EuiFieldNumber,{compressed:!0,fullWidth:!0,isInvalid:!S,value:"auto"!==N&&void 0!==M&&isFinite(M)?M:"",disabled:E,onChange:F,placeholder:"auto"===N?Q(T):"",append:X(s,N),onBlur:B,"data-test-subj":"lnsPalettePanel_dynamicColoring_range_value_".concat(n),prepend:Object(c.jsx)("span",{className:"euiFormLabel"},T?"≤":"≥"),"aria-label":l.i18n.translate("coloring.dynamicColoring.customPalette.rangeAriaLabel",{defaultMessage:"Range {index}",values:{index:n+1}}),step:"any"})),R?Object(c.jsx)(d.EuiFlexItem,{grow:!1},Object(c.jsx)(R,{index:n,continuity:v,rangeType:s,colorRanges:u,dispatch:g,accessor:a})):null)}var ee=a(1),te=a.n(ee),ae=function(e,t){var a=[];return Number.isNaN(e[t])&&a.push("invalidValue"),"end"===t?e.start>e.end&&a.push("greaterThanMaxValue"):V(e.color)||a.push("invalidColor"),{isValid:!a.length,errors:a}},ne=function(e){var t=e.reduce((function(e,t,a){return h()(h()({},e),{},te()({},a,ae(t,"start")))}),{});return h()(h()({},t),{},{last:ae(e[e.length-1],"end")})};function oe(e){var t,a,n=e.colorRanges,i=e.paletteConfiguration,s=e.showExtraActions,u=e.dispatch,p=Object(r.useState)({}),v=o()(p,2),g=v[0],m=v[1],j=n[n.length-1],y=function(e){return Array.from(new Set(Object.values(e).map((function(e){return e.errors})).flat().map((function(e){switch(e){case"invalidColor":case"invalidValue":return l.i18n.translate("coloring.dynamicColoring.customPalette.invalidValueOrColor",{defaultMessage:"At least one color range contains the wrong value or color"});case"greaterThanMaxValue":return l.i18n.translate("coloring.dynamicColoring.customPalette.invalidMaxValue",{defaultMessage:"Maximum value must be greater than preceding values"});default:return""}}))))}(g),f=null!==(t=null==i?void 0:i.continuity)&&void 0!==t?t:b.c,h=null!==(a=null==i?void 0:i.rangeType)&&void 0!==a?a:b.g;return Object(r.useEffect)((function(){m(ne(n))}),[n]),Object(c.jsx)(d.EuiFlexGroup,{"data-test-subj":"lnsPalettePanel_dynamicColoring_custom_color_ranges",direction:"column",gutterSize:"s"},n.map((function(e,t){var a,o;return Object(c.jsx)(d.EuiFlexItem,{grow:!1,key:"".concat(null!==(a=null!==(o=e.end)&&void 0!==o?o:0+e.start)&&void 0!==a?a:0).concat(t)},Object(c.jsx)($,{colorRange:e,dispatch:u,colorRanges:n,continuity:f,rangeType:h,index:t,validation:g[t],accessor:"start"}))})),j?Object(c.jsx)(d.EuiFlexItem,{grow:!1},Object(c.jsx)($,{colorRange:j,dispatch:u,colorRanges:n,continuity:f,rangeType:h,index:n.length-1,validation:g.last,accessor:"end"})):null,Object(c.jsx)(d.EuiFlexItem,{grow:!1},y.map((function(e){return Object(c.jsx)(d.EuiTextColor,{color:"danger",key:"".concat(Object(B.camelCase)(e))},e)}))),s?Object(c.jsx)(d.EuiFlexItem,{grow:!1},Object(c.jsx)(Y,{dispatch:u,shouldDisableAdd:Boolean((null==i?void 0:i.maxSteps)&&n.length>=(null==i?void 0:i.maxSteps)||y.length),shouldDisableDistribute:Boolean(1===n.length),shouldDisableReverse:Boolean(1===n.length)})):null)}var le=function(e,t){switch(t.type){case"updateContinuity":var a,n,o=t.payload,l=o.continuity,r=o.isLast,i=o.dataBounds,s=o.palettes,u=null!==(a=null===(n=e.activePalette.params)||void 0===n?void 0:n.rangeType)&&void 0!==a?a:b.g,c=function(e,t,a,n,o){var l=Object(b.l)(n,o),r=l.max,i=l.min;return a?Object(b.j)(t)?Number.POSITIVE_INFINITY:Object(b.p)(e[e.length-1].start>r?e[e.length-1].start+1:r):Object(b.k)(t)?Number.NEGATIVE_INFINITY:Object(b.p)(e[0].end<i?e[0].end-1:i)}(e.colorRanges,l,r,u,i);return N(s,e.activePalette,T(r?e.colorRanges.length-1:0,"".concat(c),r?"end":"start",e.colorRanges),i,l);case"addColorRange":var d,p,v=t.payload,g=v.dataBounds;return N(v.palettes,e.activePalette,function(e,t,a){var n=P()(e),o=n.length-1,l=n[o].start,r=n[o].end,i=n[o].color,s=Object(b.l)(t,a).max,u=Math.max(s,r),c=Object(b.p)(Math.min(l+1,u));return c===Number.NEGATIVE_INFINITY&&(c=1),(n=w(n,o,{end:c})).push({color:i,start:c,end:r===c?r+1:r}),n}(e.colorRanges,null!==(d=null===(p=e.activePalette.params)||void 0===p?void 0:p.rangeType)&&void 0!==d?d:b.g,g),g);case"reversePalette":var m=t.payload,j=m.dataBounds;return N(m.palettes,e.activePalette,(ne=e.colorRanges).map((function(e,t){return{color:e.color,start:ne[ne.length-t-1].start,end:ne[ne.length-t-1].end}})).reverse(),j);case"distributeEqually":var y,f,x,O=t.payload,C=O.dataBounds;return N(O.palettes,e.activePalette,function(e,t,a,n){var o=e.length,l=e.length-1,r=Object(b.l)(t,n),i=r.min,s=r.max,u=Object(b.p)((s-i)/o),c=function(e){return Object(b.p)(i+u*e)},d=function(e){return 0===e?Object(b.k)(a)?Number.NEGATIVE_INFINITY:Object(b.p)(i):c(e)},p=function(e){return e===l?Object(b.j)(a)?Number.POSITIVE_INFINITY:Object(b.p)(s):c(e+1)};return e.map((function(e,t){return{color:e.color,start:d(t),end:p(t)}}))}(e.colorRanges,null===(y=e.activePalette.params)||void 0===y?void 0:y.rangeType,null!==(f=null===(x=e.activePalette.params)||void 0===x?void 0:x.continuity)&&void 0!==f?f:b.c,C),C);case"updateColor":var I=t.payload,V=I.index,S=I.color,B=I.palettes,F=I.dataBounds;return N(B,e.activePalette,function(e,t,a){return w(a,e,{color:t})}(V,S,e.colorRanges),F);case"sortColorRanges":var A=t.payload,k=A.dataBounds;return N(A.palettes,e.activePalette,M(e.colorRanges),k);case"updateValue":var L=t.payload,D=L.index,Y=L.value,Z=L.accessor,G=L.dataBounds;return N(L.palettes,e.activePalette,T(D,Y,Z,e.colorRanges),G);case"deleteColorRange":var z=t.payload,H=z.index,W=z.dataBounds;return N(z.palettes,e.activePalette,function(e,t){var a=t.length-1,n=t;return 0!==e&&(e!==a&&(n=w(n,e-1,{end:n[e+1].start})),e===a&&(n=w(n,e-1,{end:t[e].end}))),n.filter((function(t,a){return a!==e}))}(H,e.colorRanges),W);case"updateRangeType":var q=t.payload,U=q.dataBounds,J=q.palettes,K=function(e,t,a,n,o){var l,r,i,s,u=null!==(l=null===(r=t.params)||void 0===r?void 0:r.continuity)&&void 0!==l?l:b.c,c={rangeType:e},d=Object(b.l)(e,a),p=d.min,v=d.max,g=Object(b.l)(null===(i=t.params)||void 0===i?void 0:i.rangeType,a),m=g.min,j=g.max,y=function(e,t){var a=t.newInterval,n=t.oldInterval,o=t.newMin,l=t.oldMin;return(e||[]).map((function(e){var t=e.color,r=e.start,i=Object(b.i)(r,o,l,n,a);return 0===n&&(i=a+o),{color:t,stop:Object(b.p)(i)}}))}(o,{oldInterval:j-m,newInterval:v-p,newMin:p,oldMin:m});if(t.name===b.a){var f=Object(b.n)(n,h()(h()({},t.params),{},{colorStops:y},c),{dataBounds:a});c.colorStops=y,c.stops=f}else c.stops=Object(b.n)(n,h()(h()({},t.params),c),{prevPalette:t.name,dataBounds:a});var x=t.name===b.a?y[y.length-1].stop:c.stops[c.stops.length-1].stop;return c.rangeMin=Object(b.k)(u)?Number.NEGATIVE_INFINITY:t.name===b.a?y[0].stop:c.stops[0].stop,c.rangeMax=Object(b.j)(u)?Number.POSITIVE_INFINITY:null!==(s=t.params)&&void 0!==s&&s.rangeMax?Object(b.i)(t.params.rangeMax,p,m,j-m,v-p):x>v?x+1:v,c}(q.rangeType,e.activePalette,U,J,e.colorRanges);return E(J,_(e.activePalette,K),U);case"changeColorPalette":var Q=t.payload,X=Q.dataBounds,$=Q.palettes,ee=Q.palette,te=Q.disableSwitchingContinuity,ae=function(e,t,a,n,o){var l,r,i,s=e.name===b.a,u=h()(h()({},t.params),{},{name:e.name,colorStops:void 0,continuity:o&&null!==(l=null===(r=t.params)||void 0===r?void 0:r.continuity)&&void 0!==l?l:b.c,reverse:!1}),c=R(a,(null===(i=t.params)||void 0===i?void 0:i.colorStops)||[],t,n);return s&&(u.colorStops=c),h()(h()({},e),{},{params:h()(h()({},u),{},{stops:Object(b.n)(a,u,{prevPalette:s||t.name===b.a?void 0:e.name,dataBounds:n,mapFromMinValue:!0}),rangeMin:Object(b.k)(u.continuity)?Number.NEGATIVE_INFINITY:Math.min(n.min,c[0].stop),rangeMax:Object(b.j)(u.continuity)?Number.POSITIVE_INFINITY:Math.min(n.max,c[c.length-1].stop)})})}(ee,e.activePalette,$,X,te);return E($,ae,X);default:throw new Error("wrong action")}var ne};t.default=function(e){var t,a,n,s,p,v=e.palettes,g=e.activePalette,m=e.setPalette,j=e.dataBounds,f=void 0===j?Object(b.m)(null===(t=g.params)||void 0===t?void 0:t.rangeType):j,h=e.showExtraActions,x=void 0===h||h,O=e.showRangeTypeSelector,C=void 0===O||O,P=e.disableSwitchingContinuity,I=void 0!==P&&P,M=Object(r.useMemo)((function(){return Object(d.htmlIdGenerator)()()}),[]),w=S(v,(null===(a=g.params)||void 0===a?void 0:a.colorStops)||[],g,f),T=Object(r.useReducer)(le,{activePalette:g,colorRanges:w}),N=o()(T,2),E=N[0],_=N[1];u()((function(){var e;E.activePalette===g&&w===E.colorRanges||(e=E.colorRanges,!Object.values(ne(e)).every((function(e){return e.isValid})))||m(E.activePalette)}),250,[E]);var V=Object(d.useEuiTheme)().euiTheme,R=Object(r.useMemo)((function(){return Object(c.css)("padding:",V.size.base,";background-color:",V.colors.lightestShade,";border-bottom:",V.border.thin,";","")}),[V.size.base,V.colors.lightestShade,V.border.thin]);return Object(c.jsx)("div",{css:R,className:"lnsPalettePanel__section"},Object(c.jsx)(d.EuiFormRow,{display:"rowCompressed",label:l.i18n.translate("coloring.dynamicColoring.palettePicker.label",{defaultMessage:"Color palette"}),fullWidth:!0},Object(c.jsx)(y,{"data-test-subj":"lnsPalettePanel_dynamicColoring_palette_picker",palettes:v,activePalette:E.activePalette,setPalette:function(e){e.name!==g.name&&_({type:"changeColorPalette",payload:{palette:e,dataBounds:f,palettes:v,disableSwitchingContinuity:I}})},showCustomPalette:!0,showDynamicColorOnly:!0})),C&&Object(c.jsx)(d.EuiFormRow,{label:Object(c.jsx)(i.a.Fragment,null,l.i18n.translate("coloring.dynamicColoring.rangeType.label",{defaultMessage:"Value type"})," ",Object(c.jsx)(d.EuiIconTip,{content:l.i18n.translate("coloring.dynamicColoring.customPalette.colorStopsHelpPercentage",{defaultMessage:"Percent value types are relative to the full range of available data values."}),position:"top",size:"s"})),display:"rowCompressed"},Object(c.jsx)(d.EuiButtonGroup,{legend:l.i18n.translate("coloring.dynamicColoring.rangeType.label",{defaultMessage:"Value type"}),"data-test-subj":"lnsPalettePanel_dynamicColoring_custom_range_groups",name:"dynamicColoringRangeType",buttonSize:"compressed",options:[{id:"".concat(M,"percent"),label:l.i18n.translate("coloring.dynamicColoring.rangeType.percent",{defaultMessage:"Percent"}),"data-test-subj":"lnsPalettePanel_dynamicColoring_rangeType_groups_percent"},{id:"".concat(M,"number"),label:l.i18n.translate("coloring.dynamicColoring.rangeType.number",{defaultMessage:"Number"}),"data-test-subj":"lnsPalettePanel_dynamicColoring_rangeType_groups_number"}],idSelected:null!==(n=E.activePalette.params)&&void 0!==n&&n.rangeType?"".concat(M).concat(null===(s=E.activePalette.params)||void 0===s?void 0:s.rangeType):"".concat(M,"percent"),onChange:function(e){var t=e.replace(M,"");_({type:"updateRangeType",payload:{rangeType:t,dataBounds:f,palettes:v}})},isFullWidth:!0})),Object(c.jsx)(d.EuiFormRow,{label:l.i18n.translate("coloring.dynamicColoring.palettePicker.colorRangesLabel",{defaultMessage:"Color Ranges"}),display:"rowCompressed",fullWidth:!0},Object(c.jsx)(D.Provider,{value:{dataBounds:f,palettes:v,disableSwitchingContinuity:I}},Object(c.jsx)(oe,{showExtraActions:x,paletteConfiguration:null===(p=E.activePalette)||void 0===p?void 0:p.params,colorRanges:E.colorRanges,dispatch:_}))))}}}]);