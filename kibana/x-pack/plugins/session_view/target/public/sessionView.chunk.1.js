/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.sessionView_bundle_jsonpfunction=window.sessionView_bundle_jsonpfunction||[]).push([[1],{58:function(e,t){var s="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(s){var o=new Uint8Array(16);e.exports=function(){return s(o),o}}else{var i=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i}}},59:function(e,t){for(var s=[],o=0;o<256;++o)s[o]=(o+256).toString(16).substr(1);e.exports=function(e,t){var o=t||0,i=s;return[i[e[o++]],i[e[o++]],i[e[o++]],i[e[o++]],"-",i[e[o++]],i[e[o++]],"-",i[e[o++]],i[e[o++]],"-",i[e[o++]],i[e[o++]],"-",i[e[o++]],i[e[o++]],i[e[o++]],i[e[o++]],i[e[o++]],i[e[o++]]].join("")}},60:function(e,t,s){e.exports=s(11)(2)},61:function(e,t,s){var o=s(62),i=s(63),n=i;n.v1=o,n.v4=i,e.exports=n},62:function(e,t,s){var o,i,n=s(58),r=s(59),a=0,l=0;e.exports=function(e,t,s){var c=t&&s||0,d=t||[],u=(e=e||{}).node||o,p=void 0!==e.clockseq?e.clockseq:i;if(null==u||null==p){var b=n();null==u&&(u=o=[1|b[0],b[1],b[2],b[3],b[4],b[5]]),null==p&&(p=i=16383&(b[6]<<8|b[7]))}var j=void 0!==e.msecs?e.msecs:(new Date).getTime(),g=void 0!==e.nsecs?e.nsecs:l+1,m=j-a+(g-l)/1e4;if(m<0&&void 0===e.clockseq&&(p=p+1&16383),(m<0||j>a)&&void 0===e.nsecs&&(g=0),g>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");a=j,l=g,i=p;var x=(1e4*(268435455&(j+=122192928e5))+g)%4294967296;d[c++]=x>>>24&255,d[c++]=x>>>16&255,d[c++]=x>>>8&255,d[c++]=255&x;var v=j/4294967296*1e4&268435455;d[c++]=v>>>8&255,d[c++]=255&v,d[c++]=v>>>24&15|16,d[c++]=v>>>16&255,d[c++]=p>>>8|128,d[c++]=255&p;for(var h=0;h<6;++h)d[c+h]=u[h];return t||r(d)}},63:function(e,t,s){var o=s(58),i=s(59);e.exports=function(e,t,s){var n=t&&s||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var r=(e=e||{}).random||(e.rng||o)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t)for(var a=0;a<16;++a)t[n+a]=r[a];return t||i(r)}},64:function(e,t,s){"use strict";var o=Number.isNaN||function(e){return"number"==typeof e&&e!=e};function i(e,t){if(e.length!==t.length)return!1;for(var s=0;s<e.length;s++)if(!((i=e[s])===(n=t[s])||o(i)&&o(n)))return!1;var i,n;return!0}e.exports=function(e,t){void 0===t&&(t=i);var s=null;function o(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];if(s&&s.lastThis===this&&t(o,s.lastArgs))return s.lastResult;var n=e.apply(this,o);return s={lastResult:n,lastArgs:o,lastThis:this},n}return o.clear=function(){s=null},o}},65:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=s(3),i=s(66),n=function(){};t.default=function(e,t,s){if(!i.isClient)return[t,n,n];if(!e)throw new Error("useLocalStorage key may not be falsy");var r=s?s.raw?function(e){return e}:s.deserializer:JSON.parse,a=o.useState((function(){try{var o=s?s.raw?String:s.serializer:JSON.stringify,i=localStorage.getItem(e);return null!==i?r(i):(t&&localStorage.setItem(e,o(t)),t)}catch(e){return t}})),l=a[0],c=a[1],d=o.useCallback((function(t){try{var o="function"==typeof t?t(l):t;if(void 0===o)return;var i;i=s?s.raw?"string"==typeof o?o:JSON.stringify(o):s.serializer?s.serializer(o):JSON.stringify(o):JSON.stringify(o),localStorage.setItem(e,i),c(r(i))}catch(e){}}),[e,c]),u=o.useCallback((function(){try{localStorage.removeItem(e),c(void 0)}catch(e){}}),[e,c]);return[l,d,u]}},66:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDeepEqual=t.off=t.on=t.isClient=void 0;var o=s(57).__importDefault(s(67));t.isClient="object"==typeof window,t.on=function(e){for(var t=[],s=1;s<arguments.length;s++)t[s-1]=arguments[s];return e.addEventListener.apply(e,t)},t.off=function(e){for(var t=[],s=1;s<arguments.length;s++)t[s-1]=arguments[s];return e.removeEventListener.apply(e,t)},t.isDeepEqual=o.default},67:function(e,t,s){"use strict";e.exports=function e(t,s){if(t===s)return!0;if(t&&s&&"object"==typeof t&&"object"==typeof s){if(t.constructor!==s.constructor)return!1;var o,i,n;if(Array.isArray(t)){if((o=t.length)!=s.length)return!1;for(i=o;0!=i--;)if(!e(t[i],s[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===s.source&&t.flags===s.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===s.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===s.toString();if((o=(n=Object.keys(t)).length)!==Object.keys(s).length)return!1;for(i=o;0!=i--;)if(!Object.prototype.hasOwnProperty.call(s,n[i]))return!1;for(i=o;0!=i--;){var r=n[i];if(!("_owner"===r&&t.$$typeof||e(t[r],s[r])))return!1}return!0}return t!=t&&s!=s}},68:function(e,t,s){"use strict";s.r(t),s.d(t,"SessionView",(function(){return De})),s.d(t,"default",(function(){return De}));var o=s(3),i=s.n(o),n=s(17),r=s(51),a=s(52),l=s(65),c=s.n(l),d=s(54);const u="-",p=e=>void 0===e||""===e||"number"==typeof e&&isNaN(e)?u:e;var b=s(53),j=s.n(b);const g=500,m="sessionViewAlerts",x={stopPropagation:()=>{}},v={open:"primary",acknowledged:"warning",closed:"default"},h=e=>v[e||"closed"];var O=s(55);const f=(...e)=>{const t=Object(n.useEuiTheme)(...e),s=Object(o.useMemo)((()=>{const e="DARK"===t.colorMode?O.euiDarkVars:O.euiLightVars,s={euiColorVis6_asText:Object(n.shade)(e.euiColorVis6,.335),buttonsBackgroundNormalDefaultPrimary:"#006DE4"};return{...e,...s}}),[t.colorMode]);return{...t,euiVars:s}};var y=s(56);const w=()=>Object(y.useUiSetting)("dateFormat");var C=s(8);const T=({alert:e,isInvestigated:t,isSelected:s,onClick:i,selectAlert:r,onShowAlertDetails:a})=>{var l,c;const d=(({isInvestigated:e,isSelected:t})=>{const{euiTheme:s,euiVars:i}=f();return Object(o.useMemo)((()=>{const{size:o,colors:r,font:a}=s,{bgColor:l,hoverBgColor:c}=(()=>{let s="none",o=`${Object(n.transparentize)(r.primary,.04)}`;return e&&t?(s=`${Object(n.transparentize)(r.danger,.08)}`,o=`${Object(n.transparentize)(r.danger,.12)}`):e?(s=`${Object(n.transparentize)(r.danger,.04)}`,o=`${Object(n.transparentize)(r.danger,.12)}`):t&&(s=`${Object(n.transparentize)(r.primary,.08)}`,o=`${Object(n.transparentize)(r.primary,.12)}`),{bgColor:s,hoverBgColor:o}})();return{alert:{fontFamily:a.family,padding:`0 ${o.m}`,cursor:"pointer","&:not(:last-child)":{marginBottom:o.s},background:l,"&:hover":{background:c},"&& button":{flexShrink:0,marginRight:o.xs,"&:hover, &:focus, &:focus-within":{backgroundColor:Object(n.transparentize)(i.buttonsBackgroundNormalDefaultPrimary,.2)}},"&& .euiFlexItem":{marginTop:o.xxs,marginBottom:o.xxs}},alertStatus:{textTransform:"capitalize"},alertName:{color:r.title},actionBadge:{textTransform:"capitalize"}}}),[s,e,t,i])})({isInvestigated:t,isSelected:s}),{event:u}=e,{uuid:b,rule:j,workflow_status:g}=(null===(l=e.kibana)||void 0===l?void 0:l.alert)||{};Object(o.useEffect)((()=>{t&&b&&r(b)}),[t,b,r]);const m=Object(o.useCallback)((()=>{b&&a(b)}),[a,b]),x=Object(o.useCallback)((()=>{var t;null!==(t=e.kibana)&&void 0!==t&&t.alert&&i(e.kibana.alert)}),[null===(c=e.kibana)||void 0===c?void 0:c.alert,i]);if(!e.kibana||!j)return null;const{name:v}=j;return Object(C.jsx)("div",{key:b,css:d.alert,"data-id":b},Object(C.jsx)(n.EuiFlexGroup,{alignItems:"center",gutterSize:"s",wrap:!0,onClick:x,"data-test-subj":`sessionView:sessionViewAlertDetail-${b}`},Object(C.jsx)(n.EuiFlexItem,{grow:!1},Object(C.jsx)(n.EuiButtonIcon,{iconType:"expand","aria-label":"expand","data-test-subj":`sessionView:sessionViewAlertDetailExpand-${b}`,onClick:m})),Object(C.jsx)(n.EuiFlexItem,{grow:!1},Object(C.jsx)(n.EuiIcon,{type:"alert",color:"danger"})),Object(C.jsx)(n.EuiFlexItem,{grow:!1},Object(C.jsx)(n.EuiText,{css:d.alertName,size:"s"},p(v))),Object(C.jsx)(n.EuiFlexItem,{grow:!1},Object(C.jsx)(n.EuiBadge,{color:h(g),css:d.alertStatus},p(g))),Object(C.jsx)(n.EuiFlexItem,{grow:!1},Object(C.jsx)(n.EuiBadge,{css:d.actionBadge},null==u?void 0:u.action))))};function k({alerts:e,investigatedAlertId:t,isProcessSelected:s=!1,onAlertSelected:i,onShowAlertDetails:r}){const[a,l]=Object(o.useState)(null),c=(()=>{const{euiTheme:e}=Object(n.useEuiTheme)();return Object(o.useMemo)((()=>{const{size:t,colors:s,border:o}=e;return{container:{margin:`${t.xs} ${t.base} ${t.base} ${t.xs}`,color:s.text,padding:`${t.s} 0`,borderStyle:"solid",borderColor:s.lightShade,borderWidth:o.width.thin,borderRadius:o.radius.medium,maxHeight:378,overflowY:"auto",backgroundColor:s.emptyShade}}}),[e])})();Object(o.useEffect)((()=>{const s=t&&e.find((e=>{var s,o;return(null===(s=e.kibana)||void 0===s||null===(o=s.alert)||void 0===o?void 0:o.uuid)===t}));var o;s&&l(null===(o=s.kibana)||void 0===o?void 0:o.alert)}),[t,e]);const d=Object(o.useRef)(null),u=Object(o.useCallback)((e=>{if(null==d||!d.current)return;const t=d.current.querySelector(`[data-id="${e}"]`);if(t){const e=d.current.scrollTop,s=e+d.current.clientHeight,o=t.offsetTop,i=o+t.clientHeight;o>=e&&i<=s||t.scrollIntoView({block:"nearest"})}}),[]),p=Object(o.useCallback)((e=>{i(x),l(e)}),[i]);return 0===e.length?null:Object(C.jsx)("div",{ref:d,css:c.container,"data-test-subj":"sessionView:sessionViewAlertDetails"},e.map(((e,o)=>{var i,n;const l=(null===(i=e.kibana)||void 0===i||null===(n=i.alert)||void 0===n?void 0:n.uuid)||null;return Object(C.jsx)(T,{key:`${l}-${o}`,alert:e,isInvestigated:t===l,isSelected:s&&(null==a?void 0:a.uuid)===l,onClick:p,selectAlert:u,onShowAlertDetails:r})})))}const E=()=>{const{euiTheme:e,euiVars:t}=f();return Object(o.useMemo)((()=>{const{border:s,colors:o,size:i,font:r}=e,a={lineHeight:"18px",height:"20px",fontSize:i.m,fontFamily:r.family,fontWeight:r.weight.medium,borderRadius:s.radius.small,marginLeft:i.xs,marginRight:i.xs,minWidth:0,padding:`${i.s} ${i.xxs}`,color:t.euiColorVis6_asText,background:Object(n.transparentize)(t.euiColorVis6,.04),border:`${s.width.thin} solid ${Object(n.transparentize)(t.euiColorVis6,.48)}`,"&& > span":{padding:`0px ${i.xxs}`,svg:{transition:`transform ${e.animation.extraFast}`}},"&&:hover, &&:focus":{background:Object(n.transparentize)(t.euiColorVis6,.12),textDecoration:"none"},"&.isExpanded > span svg":{transform:"rotate(180deg)"},"&.isExpanded":{color:o.ghost,background:t.euiColorVis6,"&:hover, &:focus":{background:t.euiColorVis6}}};return{buttonArrow:{marginLeft:i.xs},button:a,alertButton:{...a,color:t.euiColorDanger,background:Object(n.transparentize)(t.euiColorDanger,.04),border:`${s.width.thin} solid ${Object(n.transparentize)(t.euiColorDanger,.48)}`,"&&:hover, &&:focus":{background:Object(n.transparentize)(t.euiColorDanger,.12),textDecoration:"none"},"&.isExpanded":{color:o.ghost,background:t.euiColorDanger,"&:hover, &:focus":{background:`${t.euiColorDanger}`}}},userChangedButton:{...a,cursor:"default",color:t.euiColorGhost,background:t.euiColorVis3,border:`${s.width.thin} solid ${Object(n.transparentize)(t.euiColorVis3,.48)}`,"&&:hover, &&:focus":{color:t.euiColorGhost,background:t.euiColorVis3,textDecoration:"none",transform:"none",animation:"none"}},buttonSize:{padding:`0px ${e.size.xs}`}}}),[e,t])},S=({onToggle:e,isExpanded:t})=>{const{button:s,buttonArrow:o}=E();return Object(C.jsx)(n.EuiButton,{className:t?"isExpanded":"",key:"child-processes-button",css:s,onClick:e,"data-test-subj":"sessionView:processTreeNodeChildProcessesButton"},Object(C.jsx)(a.FormattedMessage,{id:"xpack.sessionView.childProcesses",defaultMessage:"Child processes"}),Object(C.jsx)(n.EuiIcon,{css:o,size:"s",type:"arrowDown"}))},M=({isExpanded:e,onToggle:t,alertsCount:s})=>{const{alertButton:o,buttonArrow:i}=E();return Object(C.jsx)(n.EuiButton,{className:e?"isExpanded":"",key:"alert-button",css:o,onClick:t,"data-test-subj":"processTreeNodeAlertButton"},s>1?Object(C.jsx)(a.FormattedMessage,{id:"xpack.sessionView.alerts",defaultMessage:"Alerts"}):Object(C.jsx)(a.FormattedMessage,{id:"xpack.sessionView.alert",defaultMessage:"Alert"}),s>1&&(s>99?" (99+)":` (${s})`),Object(C.jsx)(n.EuiIcon,{css:i,size:"s",type:"arrowDown"}))};var V=s(4),A=s.n(V);const $={},P=({children:e,role:t="document",highlightIndices:s,highlightStyle:o,...n})=>Object(C.jsx)(i.a.Fragment,null,e.split("").map((function(e,t){const r=null==s?void 0:s.includes(t);return Object(C.jsx)("span",A()({"aria-hidden":"true",css:r?o:$,key:t},r?{"data-test-subj":"sessionView:splitTextIsHighlighted"}:{},n)," "===e?Object(C.jsx)(i.a.Fragment,null," "):e)}))),I={width:"6px",display:"inline-block"},z=()=>Object(C.jsx)("span",{css:I}," "),D={"&&":{display:"inline",fontSize:0,lineHeight:0,verticalAlign:"middle"}},B=({children:e,match:t,text:s,highlightStyle:o})=>{let n=0;return Object(C.jsx)("span",{css:D,"aria-label":s,role:"document"},t?i.a.Children.map(e,(e=>{const s=e.props.children.length,r=t.map((e=>e-n));return n+=s,i.a.cloneElement(e,{highlightIndices:r,highlightStyle:o})})):e)};function _({process:e,isSessionLeader:t=!1,depth:s=0,onProcessSelected:l,jumpToEntityId:c,investigatedAlertId:d,selectedProcess:u,showTimestamp:j,verboseMode:g,searchResults:m,scrollerRef:x,onChangeJumpToEventVisibility:v,onShowAlertDetails:h,loadPreviousButton:O,loadNextButton:y}){var T;const[V,A]=Object(o.useState)(t||e.autoExpand),[$,I]=Object(o.useState)(!1),{searchMatched:D}=e,F=w();Object(o.useEffect)((()=>{A(e.autoExpand)}),[e.autoExpand]),Object(o.useEffect)((()=>{!V&&u&&u.isDescendantOf(e)&&A(!0)}),[u,e,V]);const L=e.getAlerts(),N=Object(o.useMemo)((()=>!!L.length),[L]),R=Object(o.useMemo)((()=>!(!N||!L.find((e=>{var t,s;return d&&d===(null===(t=e.kibana)||void 0===t||null===(s=t.alert)||void 0===s?void 0:s.uuid)})))),[N,L,d]),H=(null==u?void 0:u.id)===e.id,J=(({depth:e,hasAlerts:t,hasInvestigatedAlert:s,isSelected:i,isSessionLeader:r})=>{const{euiTheme:a,euiVars:l}=f();return Object(o.useMemo)((()=>{const{colors:o,border:c,size:d,font:u}=a,p="21px",b="13px",j=`calc(${d.l} + ${d.xxs})`,g=d.s,m={color:o.text,fontFamily:u.familyCode},x={position:"relative",color:o.ghost,marginLeft:d.base,paddingLeft:d.s,borderLeft:c.editable},v={color:l.euiColorDarkShade},{bgColor:h,borderColor:O,hoverColor:f,searchResColor:y}=(()=>{let e="none",r=Object(n.transparentize)(o.primary,.04),a="transparent",l=Object(n.transparentize)(o.warning,.32);return t&&(a=o.danger),i&&(l=o.warning,e=Object(n.transparentize)(o.primary,.08),r=Object(n.transparentize)(o.primary,.12)),s&&(e=Object(n.transparentize)(o.danger,.04),r=Object(n.transparentize)(o.danger,.12),i&&(e=Object(n.transparentize)(o.danger,.08))),{bgColor:e,borderColor:a,hoverColor:r,searchResColor:l}})(),w={fontSize:0,lineHeight:0},C={...w,display:"block",cursor:"pointer",position:"relative",marginBottom:r?d.s:"0px","&:hover:before":{backgroundColor:f},"&:before":{position:"absolute",height:"100%",pointerEvents:"none",content:"''",marginLeft:`calc(-${e} * ${j} - ${g})`,borderLeft:`3px solid ${O}`,backgroundColor:h,width:`calc(100% + ${e} * ${j} + ${g})`},".euiToolTipAnchor":{verticalAlign:"middle"}},T={marginLeft:d.s,span:{fontSize:b,lineHeight:p,verticalAlign:"middle"}},k={...w,"span, b":{fontSize:b,lineHeight:p,display:"inline-block",verticalAlign:"middle"}};return{darkText:m,searchHighlight:`\n      color: ${o.fullShade};\n      border-radius: '0px';\n      background-color: ${y};\n    `,children:x,processNode:C,wrapper:{paddingLeft:d.s,position:"relative",verticalAlign:"middle",color:l.euiTextSubduedColor,wordBreak:"break-all",padding:`${d.xs} 0px`,button:{marginLeft:"6px",marginRight:d.xxs}},workingDir:{color:o.successText,fontFamily:u.familyCode,fontWeight:u.weight.regular},timeStamp:{float:"right",fontFamily:u.familyCode,fontSize:d.m,fontWeight:u.weight.regular,paddingRight:d.base,paddingLeft:d.xxl,position:"relative",lineHeight:p,marginTop:"1px"},alertDetails:{padding:d.s,border:c.editable,borderRadius:c.radius.medium},icon:v,textSection:T,sessionLeader:k}}),[e,a,t,s,i,l,r])})({depth:s,hasAlerts:N,hasInvestigatedAlert:R,isSelected:H,isSessionLeader:t}),W=E(),G=function({viewPortEl:e,visibleCallback:t,shouldAddListener:s=!1,offset:i=0,debounceTimeout:n=500}){const r=Object(o.useRef)(null),a=Object(o.useMemo)((()=>Object(b.debounce)((()=>{if(!r.current||!e)return;const{height:s,y:o}=r.current.getBoundingClientRect(),{y:n}=e.getBoundingClientRect(),a=n+e.clientHeight,l=o+s;t(l+i>=n&&o-i<=a,l+i<n)}),n)),[n,i,e,t]);return Object(o.useEffect)((()=>(s&&(null==e||e.addEventListener("scroll",a)),()=>{s&&(null==e||e.removeEventListener("scroll",a))})),[a,e,s]),r}({viewPortEl:x.current,visibleCallback:Object(o.useCallback)(((e,t)=>{v(e,t)}),[v]),shouldAddListener:R});Object(o.useEffect)((()=>{var t;e.id===(null==u?void 0:u.id)&&null!==(t=G.current)&&void 0!==t&&t.scrollIntoView&&G.current.scrollIntoView({behavior:"smooth",block:"nearest"})}),[u,e,G]),Object(o.useEffect)((()=>{R&&I(!0)}),[R]);const q=Object(o.useCallback)((()=>{A(!V)}),[V]),Q=Object(o.useCallback)((()=>{I(!$)}),[$]),U=Object(o.useCallback)((t=>{t.stopPropagation();const s=window.getSelection();s&&"Range"===s.type||null==l||l(e)}),[l,e]),K=e.getDetails(),Y=e.hasExec(),X=Object(o.useMemo)((()=>e.parent?Y?"console":"branch":"unlink"),[Y,e.parent]),Z=Object(o.useMemo)((()=>e.parent?Y?r.i18n.translate("xpack.sessionView.processNode.tooltipExec",{defaultMessage:"Process exec'd"}):r.i18n.translate("xpack.sessionView.processNode.tooltipFork",{defaultMessage:"Process forked (no exec)"}):r.i18n.translate("xpack.sessionView.processNode.tooltipOrphan",{defaultMessage:"Process missing parent (orphan)"})),[Y,e.parent]),ee=e.getChildren(g);if(null==K||!K.process)return null;const te=e.id,{args:se,name:oe,tty:ie,parent:ne,working_directory:re,start:ae,user:le}=K.process,ce=t||V&&(null==ee?void 0:ee.length)>0,de=s+1,ue=!t&&!(null==le||!le.name)&&le.name!==(null==ne||null===(T=ne.user)||void 0===T?void 0:T.name),pe=ie?"desktop":"gear",be=Y?"sessionView:processTreeNodeExecIcon":"sessionView:processTreeNodeForkIcon",je=Object(n.formatDate)(ae,F);return Object(C.jsx)("div",null,Object(C.jsx)("div",{"data-id":te,key:te+D,css:J.processNode,"data-test-subj":"sessionView:processTreeNode",ref:G},Object(C.jsx)("div",{"data-test-subj":"sessionView:processTreeNodeRow",css:J.wrapper,onClick:U},t?Object(C.jsx)("span",{css:J.sessionLeader},Object(C.jsx)(n.EuiIcon,{type:pe,css:J.icon}),Object(C.jsx)(z,null),Object(C.jsx)("b",{css:J.darkText},p(oe||(null==se?void 0:se[0]))),Object(C.jsx)(z,null),Object(C.jsx)("span",null,Object(C.jsx)(a.FormattedMessage,{id:"xpack.sessionView.startedBy",defaultMessage:"started by"})),Object(C.jsx)(z,null),Object(C.jsx)(n.EuiIcon,{type:"user"}),Object(C.jsx)(z,null),Object(C.jsx)("b",{css:J.darkText},p(null==le?void 0:le.name))):Object(C.jsx)(i.a.Fragment,null,j&&Object(C.jsx)("span",{"data-test-subj":"sessionView:processTreeNodeTimestamp",css:J.timeStamp},je),Object(C.jsx)(n.EuiToolTip,{position:"top",content:Z},Object(C.jsx)(n.EuiIcon,{"data-test-subj":be,type:X,css:J.icon})),Object(C.jsx)("span",{css:J.textSection},Object(C.jsx)(B,{text:`${null!=re?re:""} ${null==se?void 0:se.join(" ")}`,match:e.searchMatched,highlightStyle:J.searchHighlight},Object(C.jsx)(P,{css:J.workingDir},p(re)+" "),Object(C.jsx)(P,{css:J.darkText},`${p(null==se?void 0:se[0])}`),Object(C.jsx)(P,null,se&&se.length>1?" "+(null==se?void 0:se.slice(1).join(" ")):"")))),ue&&Object(C.jsx)(n.EuiButton,{"data-test-subj":"sessionView:processTreeNodeRootEscalationFlag",css:W.userChangedButton},Object(C.jsx)(a.FormattedMessage,{id:"xpack.sessionView.execUserChange",defaultMessage:"Exec user change: "}),Object(C.jsx)("span",null,le.name)),!t&&ee.length>0&&Object(C.jsx)(S,{isExpanded:V,onToggle:q}),L.length>0&&Object(C.jsx)(M,{onToggle:Q,isExpanded:$,alertsCount:L.length}))),$&&Object(C.jsx)(k,{alerts:L,investigatedAlertId:d,isProcessSelected:H,onAlertSelected:U,onShowAlertDetails:h}),ce&&Object(C.jsx)("div",{css:J.children},O,ee.map((e=>Object(C.jsx)(_,{key:e.id,process:e,depth:de,onProcessSelected:l,jumpToEntityId:c,investigatedAlertId:d,selectedProcess:u,showTimestamp:j,verboseMode:g,searchResults:m,scrollerRef:x,onChangeJumpToEventVisibility:v,onShowAlertDetails:h}))),y))}const F=({isDisplayedAbove:e=!1,onClick:t})=>{const s=(({isDisplayedAbove:e})=>{const{euiTheme:t,euiVars:s}=f();return Object(o.useMemo)((()=>{const{size:o,font:i}=t,n={color:O.euiLightVars.euiColorEmptyShade,backgroundColor:O.euiLightVars.euiColorPrimaryText},r={position:"absolute",height:o.xxxxl,width:"100%",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"},a={position:"sticky",pointerEvents:"auto",cursor:"pointer",fontWeight:i.weight.regular};return e?(r.top=0,r.background=`linear-gradient(180deg, ${s.euiColorLightestShade} 0%, transparent 100%)`):(r.bottom=0,r.background=`linear-gradient(360deg, ${s.euiColorLightestShade} 0%, transparent 100%)`),{container:r,jumpBackBadge:a,buttonStyle:n}}),[e,t,s])})({isDisplayedAbove:e});return Object(C.jsx)("div",{css:s.container},Object(C.jsx)(n.EuiBadge,{style:s.buttonStyle,css:s.jumpBackBadge,iconType:e?"arrowUp":"arrowDown",iconSide:"right",onClick:t,onClickAriaLabel:"Back to investigated alert","data-test-subj":"sessionView:backToInvestigatedAlert"},Object(C.jsx)(a.FormattedMessage,{id:"xpack.sessionView.backToInvestigatedAlert",defaultMessage:"Back to investigated alert"})))};var L=s(60),N=s.n(L),R=s(64),H=s.n(R);let J,W;!function(e){e.event="event",e.signal="signal"}(J||(J={})),function(e){e.fork="fork",e.exec="exec",e.end="end",e.output="output"}(W||(W={}));var G=s(61),q=s.n(G);const Q=(e,t)=>{var s,o,i,n;const r=(null===(s=e.getDetails())||void 0===s||null===(o=s.process)||void 0===o?void 0:o.start)||0,a=(null===(i=t.getDetails())||void 0===i||null===(n=i.process)||void 0===n?void 0:n.start)||0;return r<a?-1:r>a?1:0};function U(e,t){const s=(null==t?void 0:t.entity_id)||q.a.v4(),o=new hooks_ProcessImpl(s);if(e&&t){var i;const r={...e,process:{...e.process,...t},user:t.user,group:t.group,event:{...e.event,id:`fake-${s}`}};var n;(null===(i=e.process)||void 0===i?void 0:i.parent)===t&&(null===(n=r.process)||void 0===n||delete n.parent),o.addEvent(r)}return o}const K=(e,t)=>e.split("").reduce(((e,s,o)=>(t.find((e=>void 0!==e.index&&o>=e.index&&o<e.index+e[0].length))&&(e=[...e,o]),e)),[]),Y=(e,t)=>{for(const s of Object.keys(e)){const o=e[s];if(o.isUserEntered()||t===o.id||o.hasAlerts()){let{parent:e}=o;const t=new Set;for(;e&&!t.has(e.id);)t.add(e.id),e.autoExpand=!0,e=e.parent}}return e};class hooks_ProcessImpl{constructor(e){N()(this,"id",void 0),N()(this,"events",void 0),N()(this,"alerts",void 0),N()(this,"children",void 0),N()(this,"parent",void 0),N()(this,"autoExpand",void 0),N()(this,"searchMatched",void 0),N()(this,"orphans",void 0),N()(this,"getChildrenMemo",H()(((e,t,s)=>0===e.length&&0===t.length?[]:(t.length&&(e=[...e,...t]),s||(e=e.filter((e=>!(0===e.events.length||!e.autoExpand&&!e.hasAlerts()&&e.isVerbose())))),Object(b.sortedUniqBy)(e.sort(Q),(e=>e.id)))))),N()(this,"findEventByAction",H()(((e,t)=>e.find((({event:e})=>(null==e?void 0:e.action)===t))))),N()(this,"findEventByKind",H()(((e,t)=>e.find((({event:e})=>(null==e?void 0:e.kind)===t))))),N()(this,"filterEventsByAction",H()(((e,t)=>e.filter((({event:e})=>(null==e?void 0:e.action)===t))))),N()(this,"filterEventsByKind",H()(((e,t)=>e.filter((({event:e})=>(null==e?void 0:e.kind)===t))))),N()(this,"getDetailsMemo",H()((e=>{var t;const s=[W.fork,W.exec,W.end],o=e.filter((e=>{var t;return s.includes(null===(t=e.event)||void 0===t?void 0:t.action)}));return 0===o.length&&e.length>0?e[e.length-1]:null!==(t=o[o.length-1])&&void 0!==t?t:{}}))),this.id=e,this.events=[],this.alerts=[],this.children=[],this.orphans=[],this.autoExpand=!1,this.searchMatched=null}addEvent(e){this.events.find((t=>{var s,o;return(null===(s=t.event)||void 0===s?void 0:s.id)===(null===(o=e.event)||void 0===o?void 0:o.id)}))||(this.events=this.events.concat(e))}addAlert(e){this.alerts.find((t=>{var s,o;return(null===(s=t.event)||void 0===s?void 0:s.id)===(null===(o=e.event)||void 0===o?void 0:o.id)}))||(this.alerts=this.alerts.concat(e))}addChild(e){this.children=this.children.concat(e)}clearSearch(){this.searchMatched=null}getChildren(e){return this.getChildrenMemo(this.children,this.orphans,e)}isVerbose(){var e;const{group_leader:t,session_leader:s,entry_leader:o}=null!==(e=this.getDetails().process)&&void 0!==e?e:{};return!(this.id===(null==o?void 0:o.entity_id)||t&&s&&t.pid!==s.pid)}hasOutput(){return!!this.findEventByAction(this.events,W.output)}hasAlerts(){return!!this.alerts.length}hasAlert(e){return!!e&&!!this.alerts.find((t=>{var s,o;return(null===(s=t.kibana)||void 0===s||null===(o=s.alert)||void 0===o?void 0:o.uuid)===e}))}getAlerts(){return this.alerts}updateAlertsStatus(e){this.alerts=((e,t)=>e.map((e=>{var s,o,i,n,r;return e.kibana?{...e,kibana:{...e.kibana,alert:{...e.kibana.alert,workflow_status:null!==(s=null===(o=t[null!==(i=null===(n=e.kibana.alert)||void 0===n?void 0:n.uuid)&&void 0!==i?i:""])||void 0===o?void 0:o.status)&&void 0!==s?s:null===(r=e.kibana.alert)||void 0===r?void 0:r.workflow_status}}}:e})))(this.alerts,e)}hasExec(){return!!this.findEventByAction(this.events,W.exec)}hasExited(){return!!this.findEventByAction(this.events,W.end)}getDetails(){return this.getDetailsMemo(this.events)}getOutput(){return""}getEndTime(){const e=this.findEventByAction(this.events,W.end);return(null==e?void 0:e["@timestamp"])||""}isUserEntered(){var e;const t=this.getDetails();if(!t)return!1;const{pid:s,tty:o,parent:i,session_leader:n,group_leader:r}=null!==(e=t.process)&&void 0!==e?e:{},a=i&&n&&i.pid===n.pid,l=r&&s===r.pid;return!!(o&&a&&l)}getMaxAlertLevel(){return null}isDescendantOf(e){let t=this.parent;for(;t;){if(t===e)return!0;t=t.parent}return!1}}const X=({sessionEntityId:e,data:t,searchQuery:s,updatedAlertsStatus:i,verboseMode:n,jumpToEntityId:r})=>{var a,l;const c=null===(a=t[0])||void 0===a||null===(l=a.events)||void 0===l?void 0:l[0],d=Object(o.useMemo)((()=>{var e;const t=null==c||null===(e=c.process)||void 0===e?void 0:e.entry_leader;return U(c,t)}),[c]),u={[e]:d},[p,j]=Object(o.useState)(u),[g,m]=Object(o.useState)([]),[x,v]=Object(o.useState)([]),[h,O]=Object(o.useState)([]);return Object(o.useEffect)((()=>{let s=p,o=h;const i=[];t.forEach(((t,n)=>{if(!g.find((e=>{var s,o;return e.cursor===t.cursor&&(null===(s=e.events)||void 0===s?void 0:s.length)===(null===(o=t.events)||void 0===o?void 0:o.length)}))){const r=n<g.length,a=((e,t,s,o,i=!1)=>{if(!t||0===t.length)return[e,s];const n=((e,t)=>(t.forEach((t=>{var s,o,i;const{entity_id:n}=null!==(s=t.process)&&void 0!==s?s:{};if(!n)return;let r=e[n];r||(r=new hooks_ProcessImpl(n),e[n]=r),null!==(o=t.kibana)&&void 0!==o&&o.alert?r.addAlert(t):(null===(i=t.event)||void 0===i?void 0:i.kind)===J.event&&r.addEvent(t)})),e))(e,t),r=((e,t,s,o,i=!1)=>{i&&(t=t.slice().reverse()),t.forEach((t=>{var i,n;const{entity_id:r,parent:a}=null!==(i=t.process)&&void 0!==i?i:{},l=e[null!=r?r:""];let c=e[null!==(n=null==a?void 0:a.entity_id)&&void 0!==n?n:""];if(r&&a&&!l.parent&&r!==o){if(!c){var d;const o=null==t||null===(d=t.process)||void 0===d?void 0:d.parent;null!=o&&o.entity_id&&!e[o.entity_id]?(c=U(t,o),e[c.id]=c,s.includes(c)||s.push(c)):s.includes(l)||s.push(l)}c&&(l.parent=c,c.addChild(l))}}));const n=[];return null==s||s.forEach((t=>{var s,o;const i=null===(s=t.getDetails().process)||void 0===s||null===(o=s.parent)||void 0===o?void 0:o.entity_id;if(i){const s=e[i];if(s)return t.parent=s,void s.addChild(t)}n.push(t)})),n})(n,t,s,o,i);return[Y(n),r]})(s,t.events,h,e,r);s=a[0],o=a[1],i.push(t)}})),i.length>0&&(j({...s}),m([...g,...i]),O(o),Y(s,r))}),[t,p,h,g,e,r]),Object(o.useEffect)((()=>{v(((e,t,s)=>{const o=[];for(const r of Object.keys(e)){const a=e[r];if(t){var i,n;const e=a.getDetails(),r=null==e||null===(i=e.process)||void 0===i?void 0:i.entry_leader;if((null==r?void 0:r.entity_id)===a.id||!s&&a.isVerbose())continue;const l=a.getDetails(),{working_directory:c,args:d}=null!==(n=l.process)&&void 0!==n?n:{},u=`${null!=c?c:""} ${null==d?void 0:d.join(" ")}`,p=[...u.matchAll(new RegExp(Object(b.escapeRegExp)(t),"gi"))];a.searchMatched=p.length>0?K(u,p):null,a.searchMatched&&o.push(a)}else a.clearSearch()}return o.sort(Q)})(p,s,n))}),[s,p,n]),p[e].orphans=h,Object.keys(i).forEach((e=>{const t=p[i[e].processEntityId];t&&t.updateAlertsStatus(i)})),{sessionLeader:p[e],processMap:p,searchResults:x}},Z=({onClick:e,text:t,isFetching:s,eventsRemaining:i,forward:r})=>{const l=(()=>{const{euiTheme:e}=Object(n.useEuiTheme)();return Object(o.useMemo)((()=>{const{border:t}=e;return{wrapper:{display:"flex",alignItems:"center"},dottedLine:{flex:1,borderTop:`${t.width.thick} dotted ${t.color}`}}}),[e])})();return Object(C.jsx)("div",{css:l.wrapper},Object(C.jsx)(n.EuiButtonEmpty,{size:"xs",iconType:r?"arrowDown":"arrowUp",onClick:e,isLoading:s},t,i>0&&Object(C.jsx)(a.FormattedMessage,{id:"xpack.sessionView.processTreeLoadMoreButton",defaultMessage:" ({count} left)",values:{count:i}})),Object(C.jsx)("span",{css:l.dottedLine}))};const ee=r.i18n.translate("xpack.sessionView.processTree.loadMore",{defaultMessage:"Show {pageSize} next events",values:{pageSize:g}}),te=r.i18n.translate("xpack.sessionView.processTree.loadPrevious",{defaultMessage:"Show {pageSize} previous events",values:{pageSize:g}}),se=({sessionEntityId:e,data:t,jumpToEntityId:s,investigatedAlertId:r,isFetching:a,hasNextPage:l,hasPreviousPage:c,fetchNextPage:d,fetchPreviousPage:u,searchQuery:p,selectedProcess:b,onProcessSelected:g,setSearchResults:m,updatedAlertsStatus:x,onShowAlertDetails:v,showTimestamp:h=!0,verboseMode:O=!1})=>{const[y,w]=Object(o.useState)(!0),[T,k]=Object(o.useState)(!1),E=(()=>{const{euiTheme:e,euiVars:t}=f();return Object(o.useMemo)((()=>{const{colors:s,font:o,size:i}=e,r=s.primary;return{sessionViewProcessTree:{position:"relative",fontFamily:o.familyCode,overflow:"auto",height:"100%",backgroundColor:t.euiColorLightestShade,paddingTop:i.base,paddingLeft:i.s},selectionArea:{position:"absolute",display:"none",marginLeft:"-50%",width:"150%",height:"100%",backgroundColor:r,pointerEvents:"none",opacity:.1,transform:`translateY(-${i.xs})`},defaultSelected:Object(n.transparentize)(s.primary,.008),alertSelected:Object(n.transparentize)(s.danger,.008)}}),[e,t])})(),{sessionLeader:S,processMap:M,searchResults:V}=X({sessionEntityId:e,data:t,searchQuery:p,updatedAlertsStatus:x,verboseMode:O,jumpToEntityId:s}),A=Object(o.useMemo)((()=>{var e;return((null==t||null===(e=t[0])||void 0===e?void 0:e.total)||0)-t.reduce(((e,t)=>{var s;return e+((null==t||null===(s=t.events)||void 0===s?void 0:s.length)||0)}),0)}),[t]),$=Object(o.useRef)(null),P=Object(o.useCallback)(((e,t)=>{e!==y&&w(e),e||t===T||k(t)}),[y,T]),I=Object(o.useCallback)((()=>{g(null),w(!0)}),[g]);return Object(o.useEffect)((()=>{m&&m(V)}),[V,m]),function({div:e,handler:t}){Object(o.useEffect)((()=>{if(e){const s=j.a.debounce((()=>{const s=function(e){return e?e.scrollTop:document.documentElement.scrollTop||document.body.scrollTop}(e),o=s+e.offsetHeight>e.scrollHeight-20;t(s,o)}),500);return e.onscroll=s,()=>{s.cancel(),e.onscroll=null}}}),[e,t])}({div:$.current,handler:(e,t)=>{!a&&t&&d()}}),Object(o.useEffect)((()=>{if(s){const e=M[s],t=!(null==e||!e.getDetails());!b&&t&&g(e)}else b||g(S)}),[s,M,g,b,S]),Object(C.jsx)(i.a.Fragment,null,Object(C.jsx)("div",{ref:$,css:E.sessionViewProcessTree,"data-test-subj":"sessionView:sessionViewProcessTree"},S&&Object(C.jsx)(_,{isSessionLeader:!0,process:S,onProcessSelected:g,jumpToEntityId:s,investigatedAlertId:r,selectedProcess:b,scrollerRef:$,onChangeJumpToEventVisibility:P,onShowAlertDetails:v,showTimestamp:h,verboseMode:O,searchResults:V,loadPreviousButton:c?Object(C.jsx)(Z,{text:te,onClick:u,isFetching:a,eventsRemaining:A,forward:!1}):null,loadNextButton:l?Object(C.jsx)(Z,{text:ee,onClick:d,isFetching:a,eventsRemaining:A,forward:!0}):null})),!y&&Object(C.jsx)(F,{onClick:I,isDisplayedAbove:T}))},oe=({listItems:e})=>{const t=(()=>{const{euiTheme:e}=Object(n.useEuiTheme)();return Object(o.useMemo)((()=>({descriptionList:{padding:`${e.size.base} ${e.size.s} `},tabListTitle:{width:"40%",display:"flex",alignItems:"baseline",marginTop:"0px"},tabListDescription:{width:"60%",display:"flex",alignItems:"baseline",marginTop:"0px"}})),[e])})();return Object(C.jsx)(n.EuiDescriptionList,{type:"column",listItems:e,css:t.descriptionList,titleProps:{style:t.tabListTitle},descriptionProps:{style:t.tabListDescription},"data-test-subj":"sessionView:detail-panel-description-list"})},ie=({id:e,listItems:t,title:s,tooltipContent:i,extraActionTitle:r,onExtraActionClick:a,children:l,initialIsOpen:c=!1})=>{const d=(()=>{const{euiTheme:e}=Object(n.useEuiTheme)();return Object(o.useMemo)((()=>{const t={padding:e.size.base};return{accordion:{borderTop:e.border.thin,"&:last-child":{borderBottom:e.border.thin},dl:{paddingTop:"0px"},"&:only-child":{border:e.border.thin,borderRadius:e.border.radius.medium}},accordionButton:{padding:e.size.base,fontWeight:e.font.weight.bold},tabSection:t}}),[e])})();return Object(C.jsx)(n.EuiAccordion,{id:e,arrowDisplay:"right",initialIsOpen:c,buttonContent:Object(C.jsx)(n.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1,css:d.accordionButton},Object(C.jsx)(n.EuiFlexItem,{grow:!1},Object(C.jsx)("span",null,s)),i&&Object(C.jsx)(n.EuiFlexItem,{grow:!1,"data-test-subj":"sessionView:detail-panel-accordion-tooltip"},Object(C.jsx)(n.EuiIconTip,{content:i}))),css:d.accordion,"data-test-subj":"sessionView:detail-panel-accordion"},Object(C.jsx)(oe,{listItems:t}),l)},ne=({children:e,copy:t,display:s="grid"})=>{const[i,r]=Object(o.useState)(!1),a=(({display:e})=>{const{euiTheme:t}=Object(n.useEuiTheme)();return Object(o.useMemo)((()=>{const s={display:e,alignContent:"center",padding:`${t.size.xs} ${t.size.s} `,width:"100%",fontWeight:"inherit",height:"max-content",minHeight:t.size.l,letterSpacing:"0px",textAlign:"left","& .euiToolTipAnchor":{width:`calc(100% - ${t.size.xl})`,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}};return{item:s,copiableItem:{...s,position:"relative",borderRadius:t.border.radius.medium,"&:hover":{background:Object(n.transparentize)(t.colors.primary,.1)},height:"fit-content"}}}),[e,t])})({display:s}),l={size:"s",css:t?a.copiableItem:a.item};return t&&(l.onMouseEnter=()=>r(!0),l.onMouseLeave=()=>r(!1)),Object(C.jsx)(n.EuiText,A()({},l,{"data-test-subj":"sessionView:detail-panel-list-item"}),e,i&&t)},re=({children:e,textToCopy:t,tooltipContent:s,display:a="inlineBlock"})=>{const l=(()=>{const{euiTheme:e}=Object(n.useEuiTheme)();return Object(o.useMemo)((()=>({copyButton:{position:"absolute",right:e.size.s,top:0,bottom:0,margin:"auto"}})),[e])})(),c={copy:Object(C.jsx)(n.EuiCopy,{textToCopy:t,display:a},(e=>Object(C.jsx)(n.EuiButtonIcon,{css:l.copyButton,onClick:e,display:"base",iconType:"copyClipboard",size:"xs","aria-label":r.i18n.translate("xpack.sessionView.detailPanelCopy.copyButton",{defaultMessage:"Copy"})})))};return"block"===a&&(c.display=a),Object(C.jsx)(ne,c,Object(C.jsx)(n.EuiToolTip,{position:"top",content:s},Object(C.jsx)(i.a.Fragment,null,e)))},ae=[W.fork,W.exec],le={id:u,name:u,start:u,end:u,exitCode:u,userName:u,groupName:u,workingDirectory:u,interactive:u,args:u,pid:u,entryMetaType:u,entryMetaSourceIp:u,executable:[[u]]},ce=e=>{try{return e.map((e=>{const[t,s]=e;if(!t||!s||2!==e.length)throw new Error;return`${t} ${s}`})).join(", ")}catch(e){return""}},de=e=>e&&e.length&&e.map?`[${e.map((e=>`'${e}'`)).join(", ")}]`:u,ue=e=>e?"True":"False",pe=e=>{var t,s,o,i,n,r,a,l,c,d,u,p,b,j,g,m,x,v,h;return{...e,id:null!==(t=null==e?void 0:e.entity_id)&&void 0!==t?t:le.id,name:null!==(s=null==e?void 0:e.name)&&void 0!==s?s:le.name,start:null!==(o=null==e?void 0:e.start)&&void 0!==o?o:le.start,end:null!==(i=null==e?void 0:e.end)&&void 0!==i?i:le.end,exitCode:null!==(n=null==e||null===(r=e.exit_code)||void 0===r?void 0:r.toString())&&void 0!==n?n:le.exitCode,interactive:ue(null==e?void 0:e.tty),userName:null!==(a=null==e||null===(l=e.user)||void 0===l?void 0:l.name)&&void 0!==a?a:le.userName,groupName:null!==(c=null==e||null===(d=e.group)||void 0===d?void 0:d.name)&&void 0!==c?c:le.groupName,workingDirectory:null!==(u=null==e?void 0:e.working_directory)&&void 0!==u?u:le.workingDirectory,args:null!==(p=de(null==e?void 0:e.args))&&void 0!==p?p:le.args,pid:null!==(b=null==e||null===(j=e.pid)||void 0===j?void 0:j.toString())&&void 0!==b?b:le.pid,executable:null!=e&&e.executable?[[null==e?void 0:e.executable]]:le.executable,entryMetaType:null!==(g=null==e||null===(m=e.entry_meta)||void 0===m?void 0:m.type)&&void 0!==g?g:le.entryMetaType,entryMetaSourceIp:null!==(x=null==e||null===(v=e.entry_meta)||void 0===v||null===(h=v.source)||void 0===h?void 0:h.ip)&&void 0!==x?x:le.entryMetaSourceIp}},be=()=>{const{euiTheme:e}=Object(n.useEuiTheme)();return Object(o.useMemo)((()=>({descriptionSemibold:{fontWeight:e.font.weight.medium},executableAction:{fontWeight:e.font.weight.semiBold,paddingLeft:e.size.xs},ellipsis:{overflow:"hidden",textOverflow:"ellipsis"}})),[e])},je=[{id:"processEntryLeader",title:"Entry Leader",tooltipContent:r.i18n.translate("xpack.sessionView.detailPanel.entryLeaderTooltip",{defaultMessage:"Session leader process associated with initial terminal or remote access via SSH, SSM and other remote access protocols. Entry sessions are also used to represent a service directly started by the init process. In many cases this is the same as the session_leader."})},{id:"processSessionLeader",title:"Session Leader",tooltipContent:r.i18n.translate("xpack.sessionView.detailPanel.sessionLeaderTooltip",{defaultMessage:"Often the same as entry_leader. When it differs, this represents a session started within another session. Some tools like tmux and screen will start a new session to obtain a new tty and/or separate their lifecycle from the entry session."})},{id:"processGroupLeader",title:"Group Leader",tooltipContent:r.i18n.translate("xpack.sessionView.detailPanel.processGroupLeaderTooltip",{defaultMessage:"The process group leader to the current process."})},{id:"processParent",title:"Parent",tooltipContent:r.i18n.translate("xpack.sessionView.detailPanel.processParentTooltip",{defaultMessage:"The direct parent to the current process."})}],ge=["process.entry_leader","process.session_leader","process.group_leader","process.parent"],me=({selectedProcess:e})=>{const t=be(),s=Object(o.useMemo)((()=>(e=>{var t,s,o,i,n,r,a,l,c,d,u,b,j,g;const m={id:le.id,start:le.start,end:le.end,exitCode:le.exitCode,interactive:le.interactive,userName:le.userName,groupName:le.groupName,args:le.args,pid:le.pid,executable:le.executable,workingDirectory:le.workingDirectory,entryLeader:le,sessionLeader:le,groupLeader:le,parent:le};if(!e)return m;const x=e.getDetails();if(m.id=`${p(e.id)}`,m.start=`${p(null===(t=x.process)||void 0===t?void 0:t.start)}`,m.end=`${p(e.getEndTime())}`,m.exitCode=`${p(null===(s=x.process)||void 0===s?void 0:s.exit_code)}`,m.interactive=ue(null===(o=x.process)||void 0===o?void 0:o.tty),m.userName=`${p(null===(i=x.process)||void 0===i||null===(n=i.user)||void 0===n?void 0:n.name)}`,m.groupName=`${p(null===(r=x.process)||void 0===r||null===(a=r.group)||void 0===a?void 0:a.name)}`,m.pid=`${p(null===(l=x.process)||void 0===l?void 0:l.pid)}`,m.workingDirectory=`${p(null===(c=x.process)||void 0===c?void 0:c.working_directory)}`,null!==(d=x.process)&&void 0!==d&&d.args&&(m.args=de(x.process.args)),m.executable=[],e.events.forEach((e=>{var t,s;null!==(t=e.process)&&void 0!==t&&t.executable&&null!==(s=e.event)&&void 0!==s&&s.action&&ae.includes(e.event.action)&&m.executable.push([e.process.executable,`(${e.event.action})`])})),!m.executable.length){var v;const t=null===(v=e.getDetails().process)||void 0===v?void 0:v.executable;t?m.executable.push([t]):m.executable=le.executable}return m.entryLeader=pe(null==x||null===(u=x.process)||void 0===u?void 0:u.entry_leader),m.sessionLeader=pe(null==x||null===(b=x.process)||void 0===b?void 0:b.session_leader),m.groupLeader=pe(null==x||null===(j=x.process)||void 0===j?void 0:j.group_leader),m.parent=pe(null==x||null===(g=x.process)||void 0===g?void 0:g.parent),m})(e)),[e]),r=Object(o.useCallback)((e=>e.map(((e,s)=>{const[o,i]=e;return Object(C.jsx)("div",{key:`executable-${s}`,css:t.ellipsis},Object(C.jsx)(n.EuiTextColor,{color:"subdued",css:t.descriptionSemibold},o),i&&Object(C.jsx)(n.EuiTextColor,{color:"subdued",css:t.executableAction},i))}))),[t.descriptionSemibold,t.ellipsis,t.executableAction]),a=[s.entryLeader,s.sessionLeader,s.groupLeader,s.parent].map(((e,s)=>{const{id:o,start:i,end:a,exitCode:l,entryMetaType:c,interactive:d,workingDirectory:u,args:b,executable:j,pid:g,userName:m,groupName:x,entryMetaSourceIp:v}=e,h=ce(j),O=[{title:Object(C.jsx)(ne,null,"entity_id"),description:Object(C.jsx)(re,{textToCopy:`${ge[s]}.entity_id: "${o}"`,tooltipContent:o},Object(C.jsx)(n.EuiTextColor,{color:"subdued",css:t.descriptionSemibold},o))},{title:Object(C.jsx)(ne,null,"args"),description:Object(C.jsx)(re,{textToCopy:`${ge[s]}.args: "${b}"`,tooltipContent:b},b)},{title:Object(C.jsx)(ne,null,"executable"),description:Object(C.jsx)(re,{textToCopy:`${ge[s]}.executable: "${h}"`,tooltipContent:h},r(j))},{title:Object(C.jsx)(ne,null,"interactive"),description:Object(C.jsx)(re,{textToCopy:`${ge[s]}.interactive: "${d}"`,tooltipContent:d},Object(C.jsx)(n.EuiTextColor,{color:"subdued",css:t.descriptionSemibold},d))},{title:Object(C.jsx)(ne,null,"working_directory"),description:Object(C.jsx)(re,{textToCopy:`${ge[s]}.working_directory: "${u}"`,tooltipContent:u},Object(C.jsx)(n.EuiTextColor,{color:"subdued",css:t.descriptionSemibold},u))},{title:Object(C.jsx)(ne,null,"pid"),description:Object(C.jsx)(re,{textToCopy:`${ge[s]}.pid: "${g}"`,tooltipContent:g},Object(C.jsx)(n.EuiTextColor,{color:"subdued",css:t.descriptionSemibold},g))},{title:Object(C.jsx)(ne,null,"start"),description:Object(C.jsx)(re,{textToCopy:`${ge[s]}.start: "${i}"`,tooltipContent:i},i)},{title:Object(C.jsx)(ne,null,"end"),description:Object(C.jsx)(re,{textToCopy:`${ge[s]}.end: "${a}"`,tooltipContent:a},a)},{title:Object(C.jsx)(ne,null,"exit_code"),description:Object(C.jsx)(re,{textToCopy:`${ge[s]}.exit_code: "${l}"`,tooltipContent:l},Object(C.jsx)(n.EuiTextColor,{color:"subdued",css:t.descriptionSemibold},l))},{title:Object(C.jsx)(ne,null,"user.name"),description:Object(C.jsx)(re,{textToCopy:`${ge[s]}.user.name: "${m}"`,tooltipContent:m},m)},{title:Object(C.jsx)(ne,null,"group.name"),description:Object(C.jsx)(re,{textToCopy:`${ge[s]}.group.name: "${x}"`,tooltipContent:x},x)}];return 0===s&&O.push({title:Object(C.jsx)(ne,null,"entry_meta.type"),description:Object(C.jsx)(re,{textToCopy:`${ge[s]}.entry_meta.type: "${c}"`,tooltipContent:c},Object(C.jsx)(n.EuiTextColor,{color:"subdued",css:t.descriptionSemibold},c))},{title:Object(C.jsx)(ne,null,"entry_meta.source.ip"),description:Object(C.jsx)(re,{textToCopy:`${ge[s]}.entry_meta.source.ip: "${v}"`,tooltipContent:v},p(v))}),{...je[s],name:e.name,listItems:O}})),{id:l,start:c,end:d,executable:u,exitCode:b,pid:j,workingDirectory:g,interactive:m,userName:x,groupName:v,args:h}=s,O=ce(u);return Object(C.jsx)(i.a.Fragment,null,Object(C.jsx)(oe,{listItems:[{title:Object(C.jsx)(ne,null,"entity_id"),description:Object(C.jsx)(re,{textToCopy:`process.entity_id: "${l}"`,tooltipContent:l},Object(C.jsx)(n.EuiTextColor,{color:"subdued",css:t.descriptionSemibold},l))},{title:Object(C.jsx)(ne,null,"args"),description:Object(C.jsx)(re,{textToCopy:`process.args: "${h}"`,tooltipContent:h},h)},{title:Object(C.jsx)(ne,null,"executable"),description:Object(C.jsx)(re,{textToCopy:`process.executable: "${O}"`,tooltipContent:O,display:"block"},r(u))},{title:Object(C.jsx)(ne,null,"interactive"),description:Object(C.jsx)(re,{textToCopy:`process.interactive: "${m}"`,tooltipContent:m},Object(C.jsx)(n.EuiTextColor,{color:"subdued",css:t.descriptionSemibold},m))},{title:Object(C.jsx)(ne,null,"working_directory"),description:Object(C.jsx)(re,{textToCopy:`process.working_directory: "${g}"`,tooltipContent:g},Object(C.jsx)(n.EuiTextColor,{color:"subdued",css:t.descriptionSemibold},g))},{title:Object(C.jsx)(ne,null,"pid"),description:Object(C.jsx)(re,{textToCopy:`process.pid: "${j}"`,tooltipContent:j},Object(C.jsx)(n.EuiTextColor,{color:"subdued",css:t.descriptionSemibold},j))},{title:Object(C.jsx)(ne,null,"start"),description:Object(C.jsx)(re,{textToCopy:`process.start: "${c}"`,tooltipContent:c},c)},{title:Object(C.jsx)(ne,null,"end"),description:Object(C.jsx)(re,{textToCopy:`process.end: "${d}"`,tooltipContent:d},d)},{title:Object(C.jsx)(ne,null,"exit_code"),description:Object(C.jsx)(re,{textToCopy:`process.exit_code: "${b}"`,tooltipContent:b},Object(C.jsx)(n.EuiTextColor,{color:"subdued",css:t.descriptionSemibold},b))},{title:Object(C.jsx)(ne,null,"user.name"),description:Object(C.jsx)(re,{textToCopy:`process.user.name: "${x}"`,tooltipContent:x},x)},{title:Object(C.jsx)(ne,null,"group.name"),description:Object(C.jsx)(re,{textToCopy:`process.group.name: "${v}"`,tooltipContent:v},v)}]}),a.map((e=>Object(C.jsx)(ie,{key:e.id,id:e.id,title:e.title,tooltipContent:e.tooltipContent,listItems:e.listItems,extraActionTitle:e.name}))))},xe=({processHost:e,processContainer:t,processOrchestrator:s})=>{const a=be(),l=(()=>{const{euiTheme:e}=Object(n.useEuiTheme)();return Object(o.useMemo)((()=>({metadataHostOS:{margin:`${e.size.m} ${e.size.base} ${e.size.base} ${e.size.base}`,paddingBottom:e.size.base}})),[e])})(),c=Object(o.useMemo)((()=>(e=>{var t,s,o,i,n,r,a,l,c,d,b,j;const g={architecture:u,hostname:u,id:u,ip:u,mac:u,name:u,os:{family:u,full:u,kernel:u,name:u,platform:u,version:u}};return e?(g.hostname=p(e.hostname).toString(),g.id=p(e.id).toString(),g.ip=null!==(t=null===(s=e.ip)||void 0===s||null===(o=s.map)||void 0===o?void 0:o.call(s,(e=>p(e))).join(", "))&&void 0!==t?t:u,g.mac=null!==(i=null===(n=e.mac)||void 0===n||null===(r=n.map)||void 0===r?void 0:r.call(n,(e=>p(e))).join(", "))&&void 0!==i?i:u,g.name=p(e.name).toString(),g.architecture=p(e.architecture).toString(),g.os.family=p(null===(a=e.os)||void 0===a?void 0:a.family).toString(),g.os.full=p(null===(l=e.os)||void 0===l?void 0:l.full).toString(),g.os.kernel=p(null===(c=e.os)||void 0===c?void 0:c.kernel).toString(),g.os.name=p(null===(d=e.os)||void 0===d?void 0:d.name).toString(),g.os.platform=p(null===(b=e.os)||void 0===b?void 0:b.platform).toString(),g.os.version=p(null===(j=e.os)||void 0===j?void 0:j.version).toString(),g):g})(e)),[e]),d=Object(o.useMemo)((()=>(e=>{var t,s,o,i;const n={id:u,name:u,image:{name:u,tag:u,hash:{all:u}}};return e?(n.id=p(e.id).toString(),n.name=p(e.name).toString(),n.image.name=p(null==e||null===(t=e.image)||void 0===t?void 0:t.name).toString(),n.image.tag=p(null==e||null===(s=e.image)||void 0===s?void 0:s.tag).toString(),n.image.hash.all=p(null==e||null===(o=e.image)||void 0===o||null===(i=o.hash)||void 0===i?void 0:i.all).toString(),n):n})(t)),[t]),b=Object(o.useMemo)((()=>(e=>{var t,s,o,i,n,r;const a={resource:{name:u,type:u,ip:u},namespace:u,cluster:{name:u,id:u},parent:{type:u}};return e?(a.resource.name=p(null==e||null===(t=e.resource)||void 0===t?void 0:t.name).toString(),a.resource.type=p(null==e||null===(s=e.resource)||void 0===s?void 0:s.type).toString(),a.resource.ip=p(null==e||null===(o=e.resource)||void 0===o?void 0:o.ip).toString(),a.namespace=p(null==e?void 0:e.namespace).toString(),a.cluster.name=p(null==e||null===(i=e.cluster)||void 0===i?void 0:i.name).toString(),a.cluster.id=p(null==e||null===(n=e.cluster)||void 0===n?void 0:n.id).toString(),a.parent.type=p(null==e||null===(r=e.parent)||void 0===r?void 0:r.type).toString(),a):a})(s)),[s]);return Object(C.jsx)(i.a.Fragment,null,Object(C.jsx)(ie,{id:"metadataHost",title:r.i18n.translate("xpack.sessionView.metadataDetailsTab.metadata",{defaultMessage:"Metadata"}),initialIsOpen:!0,listItems:[{title:Object(C.jsx)(ne,null,"hostname"),description:Object(C.jsx)(re,{textToCopy:`host.hostname: "${c.hostname}"`,tooltipContent:c.hostname},Object(C.jsx)(n.EuiTextColor,{color:"subdued",css:a.descriptionSemibold},c.hostname))},{title:Object(C.jsx)(ne,null,"id"),description:Object(C.jsx)(re,{textToCopy:`host.id: "${c.id}"`,tooltipContent:c.id},Object(C.jsx)(n.EuiTextColor,{color:"subdued",css:a.descriptionSemibold},c.id))},{title:Object(C.jsx)(ne,null,"ip"),description:Object(C.jsx)(re,{textToCopy:`host.ip: "${c.ip}"`,tooltipContent:c.ip},Object(C.jsx)(n.EuiTextColor,{color:"subdued",css:a.descriptionSemibold},c.ip))},{title:Object(C.jsx)(ne,null,"mac"),description:Object(C.jsx)(re,{textToCopy:`host.mac: "${c.mac}"`,tooltipContent:c.mac},Object(C.jsx)(n.EuiTextColor,{color:"subdued",css:a.descriptionSemibold},c.mac))},{title:Object(C.jsx)(ne,null,"name"),description:Object(C.jsx)(re,{textToCopy:`host.name: "${c.name}"`,tooltipContent:c.name},Object(C.jsx)(n.EuiTextColor,{color:"subdued",css:a.descriptionSemibold},c.name))}]},Object(C.jsx)(n.EuiPanel,{hasShadow:!1,color:"subdued",hasBorder:!0,borderRadius:"m",paddingSize:"none",css:l.metadataHostOS},Object(C.jsx)(ie,{id:"hostOS",title:r.i18n.translate("xpack.sessionView.metadataDetailsTab.host",{defaultMessage:"Host OS"}),listItems:[{title:Object(C.jsx)(ne,null,"architecture"),description:Object(C.jsx)(re,{textToCopy:`host.architecture: "${c.architecture}"`,tooltipContent:c.architecture},Object(C.jsx)(n.EuiTextColor,{color:"subdued",css:a.descriptionSemibold},c.architecture))},{title:Object(C.jsx)(ne,null,"os.family"),description:Object(C.jsx)(re,{textToCopy:`host.os.family: "${c.os.family}"`,tooltipContent:c.os.family},Object(C.jsx)(n.EuiTextColor,{color:"subdued",css:a.descriptionSemibold},c.os.family))},{title:Object(C.jsx)(ne,null,"os.full"),description:Object(C.jsx)(re,{textToCopy:`host.os.full: "${c.os.full}"`,tooltipContent:c.os.full},Object(C.jsx)(n.EuiTextColor,{color:"subdued",css:a.descriptionSemibold},c.os.full))},{title:Object(C.jsx)(ne,null,"os.kernel"),description:Object(C.jsx)(re,{textToCopy:`host.os.kernel: "${c.os.kernel}"`,tooltipContent:c.os.kernel},Object(C.jsx)(n.EuiTextColor,{color:"subdued",css:a.descriptionSemibold},c.os.kernel))},{title:Object(C.jsx)(ne,null,"os.name"),description:Object(C.jsx)(re,{textToCopy:`host.os.name: "${c.os.name}"`,tooltipContent:c.os.name},Object(C.jsx)(n.EuiTextColor,{color:"subdued",css:a.descriptionSemibold},c.os.name))},{title:Object(C.jsx)(ne,null,"os.platform"),description:Object(C.jsx)(re,{textToCopy:`host.os.platform: "${c.os.platform}"`,tooltipContent:c.os.platform},Object(C.jsx)(n.EuiTextColor,{color:"subdued",css:a.descriptionSemibold},c.os.platform))},{title:Object(C.jsx)(ne,null,"os.version"),description:Object(C.jsx)(re,{textToCopy:`host.os.version: "${c.os.version}"`,tooltipContent:c.os.version},Object(C.jsx)(n.EuiTextColor,{color:"subdued",css:a.descriptionSemibold},c.os.version))}]}))),t&&Object(C.jsx)(i.a.Fragment,null,Object(C.jsx)(ie,{id:"metadataContainer",title:r.i18n.translate("xpack.sessionView.metadataDetailsTab.container",{defaultMessage:"Container"}),listItems:[{title:Object(C.jsx)(ne,null,"id"),description:Object(C.jsx)(re,{textToCopy:`container.id: "${d.id}"`,tooltipContent:d.id},Object(C.jsx)(n.EuiTextColor,{color:"subdued",css:a.descriptionSemibold},d.id))},{title:Object(C.jsx)(ne,null,"name"),description:Object(C.jsx)(re,{textToCopy:`container.name: "${d.name}"`,tooltipContent:d.name},Object(C.jsx)(n.EuiTextColor,{color:"subdued",css:a.descriptionSemibold},d.name))},{title:Object(C.jsx)(ne,null,"image.name"),description:Object(C.jsx)(re,{textToCopy:`container.image.name: "${d.image.name}"`,tooltipContent:d.image.name},Object(C.jsx)(n.EuiTextColor,{color:"subdued",css:a.descriptionSemibold},d.image.name))},{title:Object(C.jsx)(ne,null,"image.tag"),description:Object(C.jsx)(re,{textToCopy:`container.image.tag: "${d.image.tag}"`,tooltipContent:d.image.tag},Object(C.jsx)(n.EuiTextColor,{color:"subdued",css:a.descriptionSemibold},d.image.tag))},{title:Object(C.jsx)(ne,null,"image.hash.all"),description:Object(C.jsx)(re,{textToCopy:`container.image.hash.all: "${d.image.hash.all}"`,tooltipContent:d.image.hash.all},Object(C.jsx)(n.EuiTextColor,{color:"subdued",css:a.descriptionSemibold},d.image.hash.all))}]})),s&&Object(C.jsx)(i.a.Fragment,null,Object(C.jsx)(ie,{id:"metadataOrchestrator",title:r.i18n.translate("xpack.sessionView.metadataDetailsTab.orchestrator",{defaultMessage:"Orchestrator"}),listItems:[{title:Object(C.jsx)(ne,null,"resource.ip"),description:Object(C.jsx)(re,{textToCopy:`orchestrator.resource.ip: "${b.resource.ip}"`,tooltipContent:b.resource.ip},Object(C.jsx)(n.EuiTextColor,{color:"subdued",css:a.descriptionSemibold},b.resource.ip))},{title:Object(C.jsx)(ne,null,"resource.name"),description:Object(C.jsx)(re,{textToCopy:`orchestrator.resource.name: "${b.resource.name}"`,tooltipContent:b.resource.name},Object(C.jsx)(n.EuiTextColor,{color:"subdued",css:a.descriptionSemibold},b.resource.name))},{title:Object(C.jsx)(ne,null,"resource.type"),description:Object(C.jsx)(re,{textToCopy:`orchestrator.resource.type: "${b.resource.type}"`,tooltipContent:b.resource.type},Object(C.jsx)(n.EuiTextColor,{color:"subdued",css:a.descriptionSemibold},b.resource.type))},{title:Object(C.jsx)(ne,null,"namespace"),description:Object(C.jsx)(re,{textToCopy:`orchestrator.namespace: "${b.namespace}"`,tooltipContent:b.namespace},Object(C.jsx)(n.EuiTextColor,{color:"subdued",css:a.descriptionSemibold},b.namespace))},{title:Object(C.jsx)(ne,null,"cluster.id"),description:Object(C.jsx)(re,{textToCopy:`orchestrator.cluster.id: "${b.cluster.id}"`,tooltipContent:b.cluster.id},Object(C.jsx)(n.EuiTextColor,{color:"subdued",css:a.descriptionSemibold},b.cluster.id))},{title:Object(C.jsx)(ne,null,"cluster.name"),description:Object(C.jsx)(re,{textToCopy:`orchestrator.cluster.name: "${b.cluster.name}"`,tooltipContent:b.cluster.name},Object(C.jsx)(n.EuiTextColor,{color:"subdued",css:a.descriptionSemibold},b.cluster.name))},{title:Object(C.jsx)(ne,null,"parent.type"),description:Object(C.jsx)(re,{textToCopy:`orchestrator.parent.type: "${b.parent.type}"`,tooltipContent:b.parent.type},Object(C.jsx)(n.EuiTextColor,{color:"subdued",css:a.descriptionSemibold},b.parent.type))}]})))},ve=(e=!1,t=!1)=>{const{euiTheme:s}=Object(n.useEuiTheme)();return Object(o.useMemo)((()=>{const{colors:o,font:i,size:r,border:a}=s,l=Object(n.transparentize)(o.danger,.2),c=Object(n.transparentize)(o.danger,.08),d=a.width.thin,u=r.m;let p=o.text,b=o.lightShade;t&&(p=o.primaryText,b=l);const j=Object(C.css)("border:",d," solid ",b,";padding:",u,";border-radius:",a.radius.medium,";margin:0 ",u," ",u," ",u,";background-color:",o.emptyShade,";& .euiAccordion__buttonContent{width:100%;}& .euiAccordion__button{min-width:0;width:calc(100% - ",r.l,");}& .euiAccordion__childWrapper{overflow:visible;}","");return{alertItem:j,alertGroupItem:Object(C.css)(j," & .euiAccordion__childWrapper{overflow:hidden;}",""),alertTitleContainer:{display:e?"none":"initial",color:p,fontWeight:i.weight.semiBold},alertTitle:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"},alertIcon:{marginRight:r.s},alertAccordionButton:{width:`calc(100% - ${r.l})`,minWidth:0},alertCountArrowPad:{marginRight:r.xs},processPanel:{border:`${d} solid ${o.lightShade}`,fontFamily:i.familyCode,marginTop:e?r.s:r.m,padding:`${r.xs} ${r.s}`},investigatedLabel:{position:"relative",zIndex:1,bottom:`-${u}`,left:`-${u}`,width:`calc(100% + ${u} * 2)`,borderTop:`${d} solid ${l}`,borderBottomLeftRadius:a.radius.medium,borderBottomRightRadius:a.radius.medium,backgroundColor:c,textAlign:"center"},minimalContextMenu:{float:"right"},firstAlertPad:{"&:first-child":{paddingTop:r.base}},minimalHR:{marginBottom:0}}}),[s,t,e])},he=({event:e,onShowAlertDetails:t,onJumpToEvent:s})=>{var i,l,c;const[d,u]=Object(o.useState)(!1),p=Object(o.useCallback)((()=>{u(!1)}),[]),b=Object(o.useCallback)((()=>{u(!d)}),[d]),j=Object(o.useCallback)((()=>{s(e),u(!1)}),[e,s]),g=Object(o.useCallback)((()=>{var s,o;null!==(s=e.kibana)&&void 0!==s&&null!==(o=s.alert)&&void 0!==o&&o.uuid&&(t(e.kibana.alert.uuid),u(!1))}),[e,t]);if(!e.kibana)return null;const m=null!==(i=null===(l=e.kibana)||void 0===l||null===(c=l.alert)||void 0===c?void 0:c.uuid)&&void 0!==i?i:"",x=[Object(C.jsx)(n.EuiContextMenuItem,{key:"details","data-test-subj":"sessionView:detailPanelAlertActionShowDetails",onClick:g},Object(C.jsx)(a.FormattedMessage,{id:"xpack.sessionView.detailPanelAlertListItem.showDetailsAction",defaultMessage:"View alert details"})),Object(C.jsx)(n.EuiContextMenuItem,{key:"jumpTo","data-test-subj":"sessionView:detailPanelAlertActionJumpToProcess",onClick:j},Object(C.jsx)(a.FormattedMessage,{id:"xpack.sessionView.detailPanelAlertListItem.jumpToAlert",defaultMessage:"Jump to alerted process"}))];return Object(C.jsx)(n.EuiPopover,{id:m,button:Object(C.jsx)(n.EuiButtonIcon,{display:"empty",size:"s",iconType:"boxesHorizontal","aria-label":r.i18n.translate("xpack.sessionView.detailPanelAlertListItem.moreButton",{defaultMessage:"More"}),"data-test-subj":"sessionView:detailPanelAlertActionsBtn",onClick:b}),isOpen:d,closePopover:p,panelPaddingSize:"none",anchorPosition:"leftCenter"},Object(C.jsx)(n.EuiContextMenuPanel,{size:"s",items:x}))},Oe="sessionView:detailPanelAlertListItem",fe=({event:e,onJumpToEvent:t,onShowAlertDetails:s,isInvestigated:o,minimal:i})=>{var r,l,c;const d=ve(i,o),u=w();if(!e.kibana)return null;const b=Object(n.formatDate)(e["@timestamp"],u),j=null===(r=e.kibana)||void 0===r||null===(l=r.alert)||void 0===l?void 0:l.rule,g=(null==j?void 0:j.uuid)||"",m=(null==j?void 0:j.name)||"",{args:x}=null!==(c=e.process)&&void 0!==c?c:{},v=o?void 0:"open";return i?Object(C.jsx)("div",{"data-test-subj":Oe,css:d.firstAlertPad},Object(C.jsx)(n.EuiSpacer,{size:"xs"}),Object(C.jsx)(n.EuiFlexGroup,{alignItems:"center"},Object(C.jsx)(n.EuiFlexItem,null,Object(C.jsx)(n.EuiText,{color:"subdued",size:"s"},p(b))),Object(C.jsx)(n.EuiFlexItem,{grow:!1},Object(C.jsx)(he,{css:d.minimalContextMenu,event:e,onJumpToEvent:t,onShowAlertDetails:s}))),Object(C.jsx)(n.EuiPanel,{css:d.processPanel,color:"subdued",hasBorder:!0,hasShadow:!1,borderRadius:"m"},Object(C.jsx)(n.EuiText,{size:"xs"},p(null==x?void 0:x.join(" ")))),Object(C.jsx)(n.EuiHorizontalRule,{css:d.minimalHR,margin:"m",size:"full"})):Object(C.jsx)(n.EuiAccordion,{id:g,"data-test-subj":Oe,arrowDisplay:o?"right":"none",buttonContent:Object(C.jsx)(n.EuiText,{css:d.alertTitleContainer,size:"s"},Object(C.jsx)("p",{css:d.alertTitle},Object(C.jsx)(n.EuiIcon,{color:"danger",type:"alert",css:d.alertIcon}),p(m))),initialIsOpen:!0,forceState:v,css:d.alertItem,extraAction:Object(C.jsx)(he,{event:e,onJumpToEvent:t,onShowAlertDetails:s})},Object(C.jsx)(n.EuiSpacer,{size:"xs"}),Object(C.jsx)(n.EuiText,{"data-test-subj":"sessionView:detailPanelAlertListItemTimestamp",color:"subdued",size:"s"},p(b)),Object(C.jsx)(n.EuiPanel,{css:d.processPanel,color:"subdued",hasBorder:!0,hasShadow:!1,borderRadius:"m"},Object(C.jsx)(n.EuiText,{"data-test-subj":"sessionView:detailPanelAlertListItemArgs",size:"xs"},p(null==x?void 0:x.join(" ")))),o&&Object(C.jsx)("div",{css:d.investigatedLabel},Object(C.jsx)(n.EuiText,{size:"xs",color:"danger"},Object(C.jsx)(a.FormattedMessage,{id:"xpack.sessionView.detailPanelAlertListItem.investigatedLabel",defaultMessage:"Investigated alert"}))))},ye=({alerts:e,onJumpToEvent:t,onShowAlertDetails:s})=>{var o,i,r,a;const l=ve(),c=e.length.toLocaleString();if(!e[0].kibana)return null;const{rule:d}=null!==(o=null===(i=e[0])||void 0===i||null===(r=i.kibana)||void 0===r?void 0:r.alert)&&void 0!==o?o:{};return Object(C.jsx)(n.EuiAccordion,{id:null!==(a=null==d?void 0:d.uuid)&&void 0!==a?a:"","data-test-subj":"sessionView:detailPanelAlertGroupItem",arrowDisplay:"right",initialIsOpen:!1,buttonContent:Object(C.jsx)(n.EuiText,{"data-test-subj":"sessionView:detailPanelAlertGroupTitle",css:l.alertTitleContainer,size:"s"},Object(C.jsx)("p",{css:l.alertTitle},Object(C.jsx)(n.EuiIcon,{color:"danger",type:"alert",css:l.alertIcon}),p(null==d?void 0:d.name))),css:l.alertGroupItem,extraAction:Object(C.jsx)(n.EuiNotificationBadge,{"data-test-subj":"sessionView:detailPanelAlertGroupCount",className:"eui-alignCenter",size:"m",css:l.alertCountArrowPad},c)},e.map((e=>{var o,i;const n="minimal_"+(null===(o=e.kibana)||void 0===o||null===(i=o.alert)||void 0===i?void 0:i.uuid);return Object(C.jsx)(fe,{key:n,minimal:!0,event:e,onJumpToEvent:t,onShowAlertDetails:s})})))},we="listView",Ce=({alerts:e,isFetchingAlerts:t,hasNextPageAlerts:s,fetchNextPageAlerts:i,onJumpToEvent:l,onShowAlertDetails:c,investigatedAlertId:d})=>{const u=(()=>{const{euiTheme:e}=Object(n.useEuiTheme)();return Object(o.useMemo)((()=>{const{colors:t,size:s}=e;return{container:{position:"relative"},stickyItem:{position:"sticky",top:0,zIndex:1,backgroundColor:t.emptyShade},viewMode:{margin:s.base},loadMoreBtn:{margin:s.m,width:`calc(100% - ${s.m} * 2)`}}}),[e])})(),[p,j]=Object(o.useState)(we),g=[{id:we,label:r.i18n.translate("xpack.sessionView.alertDetailsTab.listView",{defaultMessage:"List view"})},{id:"groupView",label:r.i18n.translate("xpack.sessionView.alertDetailsTab.groupView",{defaultMessage:"Group view"})}],m=Object(o.useMemo)((()=>d&&e.find((e=>{var t,s;return(null===(t=e.kibana)||void 0===t||null===(s=t.alert)||void 0===s?void 0:s.uuid)===d}))),[d,e]),x=Object(o.useMemo)((()=>Object(b.groupBy)(e,(e=>{var t,s,o;return null===(t=e.kibana)||void 0===t||null===(s=t.alert)||void 0===s||null===(o=s.rule)||void 0===o?void 0:o.uuid}))),[e]);return 0===e.length?Object(C.jsx)(n.EuiEmptyPrompt,{"data-test-subj":"sessionView:detailPanelAlertsEmptyState",title:Object(C.jsx)("h2",null,Object(C.jsx)(a.FormattedMessage,{id:"xpack.sessionView.detailPanelAlertsEmptyTitle",defaultMessage:"No alerts"})),body:Object(C.jsx)("p",null,Object(C.jsx)(a.FormattedMessage,{id:"xpack.sessionView.detailPanelAlertsEmptyMsg",defaultMessage:"No alerts were created for this session."}))}):Object(C.jsx)("div",{css:u.container},Object(C.jsx)(n.EuiButtonGroup,{"data-test-subj":"sessionView:detailPanelAlertsViewMode",css:u.viewMode,legend:r.i18n.translate("xpack.sessionView.alertDetailsTab.toggleViewMode",{defaultMessage:"Toggle view mode"}),options:g,idSelected:p,onChange:j,buttonSize:"compressed",isFullWidth:!0}),m&&Object(C.jsx)("div",{css:u.stickyItem,"data-test-subj":"sessionView:detailPanelInvestigatedAlert"},Object(C.jsx)(fe,{event:m,onJumpToEvent:l,onShowAlertDetails:c,isInvestigated:!0}),Object(C.jsx)(n.EuiHorizontalRule,{margin:"m",size:"full"})),p===we?e.map((e=>{var t,s;const o=null===(t=e.kibana)||void 0===t||null===(s=t.alert)||void 0===s?void 0:s.uuid;if(o&&e!==m)return Object(C.jsx)(fe,{key:o,event:e,onJumpToEvent:l,onShowAlertDetails:c})})):Object.keys(x).map((e=>{var t,s,o;const i=x[e],n=null===(t=i[0].kibana)||void 0===t||null===(s=t.alert)||void 0===s||null===(o=s.rule)||void 0===o?void 0:o.uuid;if(n)return Object(C.jsx)(ye,{key:n,alerts:i,onJumpToEvent:l,onShowAlertDetails:c})})),s&&Object(C.jsx)(n.EuiButton,{color:"primary",isLoading:t,onClick:i,css:u.loadMoreBtn,"data-test-subj":"alerts-details-load-more"},Object(C.jsx)(a.FormattedMessage,{id:"xpack.sessionView.alertsLoadMoreButton",defaultMessage:"Load more alerts"})))},Te=({alerts:e,alertsCount:t,isFetchingAlerts:s,hasNextPageAlerts:i,fetchNextPageAlerts:a,selectedProcess:l,investigatedAlertId:c,onJumpToEvent:d,onShowAlertDetails:u})=>{const[p,b]=Object(o.useState)("process"),j=Object(o.useMemo)((()=>t>=500?"500+":t+""),[t]),g=Object(o.useMemo)((()=>{var t,o,p;const b=!(null==e||!e.length);return[{id:"process",name:r.i18n.translate("xpack.sessionView.detailsPanel.process",{defaultMessage:"Process"}),content:Object(C.jsx)(me,{selectedProcess:l})},{id:"metadata",name:r.i18n.translate("xpack.sessionView.detailsPanel.metadata",{defaultMessage:"Metadata"}),content:Object(C.jsx)(xe,{processHost:null==l||null===(t=l.events[0])||void 0===t?void 0:t.host,processContainer:null==l||null===(o=l.events[0])||void 0===o?void 0:o.container,processOrchestrator:null==l||null===(p=l.events[0])||void 0===p?void 0:p.orchestrator})},{id:"alerts",name:r.i18n.translate("xpack.sessionView.detailsPanel.alerts",{defaultMessage:"Alerts"}),append:b&&Object(C.jsx)(n.EuiNotificationBadge,{className:"eui-alignCenter",size:"m"},j),content:e&&Object(C.jsx)(Ce,{alerts:e,isFetchingAlerts:s,hasNextPageAlerts:i,fetchNextPageAlerts:a,onJumpToEvent:d,onShowAlertDetails:u,investigatedAlertId:c})}]}),[e,j,a,i,s,l,d,u,c]),m=Object(o.useCallback)((e=>{b(e)}),[]),x=Object(o.useMemo)((()=>((e,t)=>{const s=e.find((e=>e.id===t));return s?s.content:null})(g,p)),[g,p]),v=(()=>{const{euiTheme:e}=Object(n.useEuiTheme)();return Object(o.useMemo)((()=>{const{border:t}=e;return{detailsPanel:{borderLeft:t.thin,height:"100%"}}}),[e])})();return Object(C.jsx)("div",{css:v.detailsPanel},Object(C.jsx)(n.EuiTabs,{size:"l",expand:!0},g.map(((e,t)=>Object(C.jsx)(n.EuiTab,{key:t,onClick:()=>m(e.id),isSelected:e.id===p,disabled:e.disabled,prepend:e.prepend,append:e.append},e.name)))),x)},ke={placeholder:r.i18n.translate("xpack.sessionView.searchBar.searchBarKeyPlaceholder",{defaultMessage:"Find..."})},Ee=r.i18n.translate("xpack.sessionView.searchBar.searchBarNoResults",{defaultMessage:"No results"}),Se=({searchQuery:e,setSearchQuery:t,onProcessSelected:s,searchResults:i})=>{const r=!!e&&0!==(null==i?void 0:i.length),a=!!e&&0===(null==i?void 0:i.length),l=(({hasSearchResults:e})=>{const{euiTheme:t,euiVars:s}=f();return Object(o.useMemo)((()=>{const o={position:"absolute",top:t.size.s,right:t.size.xxl,'button[data-test-subj="pagination-button-last"]':{display:"none"},'button[data-test-subj="pagination-button-first"]':{display:"none"}},i={position:"absolute",color:t.colors.subdued,top:t.size.m,right:t.size.xxl};return{pagination:o,searchBar:{position:"relative",backgroundColor:s.euiFormBackgroundColor,input:{paddingRight:e?"200px":t.size.xxl}},noResults:i}}),[t,s,e])})({hasSearchResults:r}),[c,d]=Object(o.useState)(0);return Object(o.useEffect)((()=>{if(i){const e=i[c];e&&s(e)}}),[i,s,c]),Object(C.jsx)("div",{"data-test-subj":"sessionView:searchBar",css:l.searchBar},Object(C.jsx)(n.EuiSearchBar,{query:e,onChange:({query:e})=>{d(0),t(e?e.text:"")},box:ke}),a&&Object(C.jsx)("span",{css:l.noResults},Ee),r&&Object(C.jsx)(n.EuiPagination,{"data-test-subj":"sessionView:searchPagination",css:l.pagination,pageCount:null==i?void 0:i.length,activePage:c,onPageClick:d,compressed:!0}))},Me="Timestamp",Ve="Verbose mode",Ae=r.i18n.translate("xpack.sessionView.sessionViewToggle.sessionViewVerboseTipTitle",{defaultMessage:"Some results may be hidden"}),$e=r.i18n.translate("xpack.sessionView.sessionViewToggle.sessionViewVerboseTipContent",{defaultMessage:"For a complete set of results, turn on Verbose mode."}),Pe=({onChange:e,displayOptions:t,showVerboseSearchTooltip:s})=>{const[i,l]=Object(o.useState)(!1),c=Object(o.useMemo)((()=>({selectable:{width:240}})),[]),d=Object(o.useRef)(null);Object(o.useEffect)((()=>{d.current&&setTimeout((()=>{d.current&&(d.current.onFocus(),setTimeout((()=>{d.current&&d.current.onBlur()}),5e3))}),3e3)}),[s]);const u=Object(o.useMemo)((()=>[{label:r.i18n.translate("xpack.sessionView.sessionViewToggle.sessionViewToggleOptionsTimestamp",{defaultMessage:"Timestamp"}),key:Me,checked:null!=t&&t.timestamp?"on":void 0},{label:r.i18n.translate("xpack.sessionView.sessionViewToggle.sessionViewToggleOptionsVerbosemode",{defaultMessage:"Verbose mode"}),key:Ve,checked:null!=t&&t.verboseMode?"on":void 0,append:Object(C.jsx)(n.EuiIconTip,{content:Object(C.jsx)(a.FormattedMessage,{id:"xpack.sessionView.sessionViewToggle.sessionViewToggleOptionsVerboseModeTooltips",defaultMessage:"Verbose mode displays all processes created in a session, including shell startup, shell completion, and forks caused by built-in commands"})})}]),[t]),p=Object(C.jsx)(n.EuiFlexItem,{grow:!1},Object(C.jsx)(n.EuiButtonIcon,{iconType:"eye",display:t.verboseMode||t.timestamp?"fill":"empty",onClick:()=>{l(!i)},size:"m","aria-label":"Session view display option","data-test-subj":"sessionView:sessionViewOptionButton"})),b=Object(C.jsx)(n.EuiPopover,{button:p,isOpen:i,closePopover:()=>{l(!1)}},Object(C.jsx)(n.EuiSelectable,{options:u,onChange:s=>{const o=s.reduce(((e,t)=>(t.key===Me?e.timestamp="on"===t.checked:t.key===Ve&&(e.verboseMode="on"===t.checked),e)),{...t});e(o)}},(e=>Object(C.jsx)("div",{css:c.selectable},Object(C.jsx)(n.EuiPopoverTitle,null,Object(C.jsx)(a.FormattedMessage,{defaultMessage:"Display options",id:"xpack.sessionView.sessionViewToggle.sessionViewToggleTitle"})),e))));return!i&&s?Object(C.jsx)(n.EuiToolTip,{ref:d,position:"bottom",title:Ae,content:$e},b):b};var Ie=s(16);const ze=r.i18n.translate("xpack.sessionView.beta",{defaultMessage:"Beta"}),De=({sessionEntityId:e,height:t,isFullScreen:s=!1,jumpToEntityId:r,jumpToCursor:l,investigatedAlertId:u,loadAlertDetails:p})=>{var b,j;r===e&&(r=void 0,l=void 0);const[x,v]=Object(o.useState)(!1),[h,O]=Object(o.useState)(null),[w,T]=Object(o.useState)(""),[k,E]=Object(o.useState)(null),[S,M]=c()("sessionView:displayOptions",{timestamp:!0,verboseMode:!1}),[V,A]=Object(o.useState)([]),[$,P]=Object(o.useState)({}),[I,z]=Object(o.useState)(l),[D,B]=Object(o.useState)(r),_=(({height:e=500,isFullScreen:t})=>{const{euiTheme:s,euiVars:i}=f();return Object(o.useMemo)((()=>{const{border:o,colors:n,size:r}=s,a={height:t?"calc(100vh - 118px)":e+"px"};return{processTree:{...a,position:"relative"},detailPanel:{...a,borderRightWidth:"0px"},nonGrowGroup:{display:"flex",flexGrow:0,alignItems:"stretch"},resizeHandle:{zIndex:2},sessionViewerComponent:{border:o.thin,borderRadius:o.radius.medium,".sessionViewerToolbar":{backgroundColor:`${i.euiFormBackgroundDisabledColor}`,padding:`${r.m} ${r.base}`}},betaBadge:{backgroundColor:`${n.emptyShade}`}}}),[s,t,e,i])})({height:t,isFullScreen:s}),F=Object(o.useRef)((()=>{})),L=Object(o.useMemo)((()=>!(null!=S&&S.verboseMode||!w||0!==(null==k?void 0:k.length))),[null==S?void 0:S.verboseMode,k,w]),N=Object(o.useCallback)((e=>{O(e)}),[]),R=Object(o.useCallback)((t=>{if(t.process){const{entity_id:o}=t.process;if(o!==e){var s;const e=null===(s=t.kibana)||void 0===s?void 0:s.alert,i=e?null==e?void 0:e.original_time:t["@timestamp"];i&&(B(o),z(i))}O(null)}}),[e]),{data:H,error:J,fetchNextPage:W,hasNextPage:G,isFetching:q,fetchPreviousPage:Q,hasPreviousPage:U,refetch:K}=((e,t)=>{const{http:s}=Object(y.useKibana)().services,[i,n]=Object(o.useState)(""),r=Object(o.useMemo)((()=>["sessionViewProcessEvents",e,t]),[e,t]),a=Object(Ie.useInfiniteQuery)(r,(async({pageParam:o={}})=>{var i,n;let{cursor:r}=o;const{forward:a}=o;!r&&t&&(r=t);const l=await s.get("/internal/session_view/process_events_route",{query:{sessionEntityId:e,cursor:r,forward:a}});return{events:null!==(i=null===(n=l.events)||void 0===n?void 0:n.map((e=>e._source)))&&void 0!==i?i:[],cursor:r,total:l.total}}),{getNextPageParam:(e,s)=>{if(1===s.length&&t||e.events.length>=g){var o,i;const t=null===(o=e.events)||void 0===o||null===(i=o[e.events.length-1])||void 0===i?void 0:i["@timestamp"];if(t)return{cursor:t,forward:!0}}},getPreviousPageParam:(e,s)=>{const o=s.length>1&&e.events.length<g;var i,n;if(t&&!o)return{cursor:(null===(i=e.events)||void 0===i||null===(n=i[0])||void 0===n?void 0:n["@timestamp"])||t,forward:!1}},refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1});return Object(o.useEffect)((()=>{var e;t&&1===(null===(e=a.data)||void 0===e?void 0:e.pages.length)&&t!==i&&(a.fetchPreviousPage({cancelRefetch:!0}),n(t))}),[t,a,i]),a})(e,I),{data:Y,fetchNextPage:X,isFetching:Z,hasNextPage:ee,error:te,refetch:oe}=((e,t)=>{const{http:s}=Object(y.useKibana)().services,o=[m,e,t];return Object(Ie.useInfiniteQuery)(o,(async({pageParam:o={}})=>{var i,n;const{cursor:r}=o,a=await s.get("/internal/session_view/alerts_route",{query:{sessionEntityId:e,investigatedAlertId:t,cursor:r}});return{events:null!==(i=null===(n=a.events)||void 0===n?void 0:n.map((e=>e._source)))&&void 0!==i?i:[],cursor:r,total:a.total}}),{getNextPageParam:e=>{if(e.events.length>=100)return{cursor:e.events[e.events.length-1]["@timestamp"]}},refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1})})(e,u),ie=Object(o.useCallback)((()=>{K({refetchPage:(e,t,s)=>s.length-1===t}),oe({refetchPage:(e,t,s)=>s.length-1===t})}),[K,oe]),ne=Object(o.useMemo)((()=>{let e=[];return Y&&Y.pages.forEach((t=>{e=e.concat(t.events)})),e}),[Y]),re=Object(o.useMemo)((()=>{var e;return(null==Y||null===(e=Y.pages)||void 0===e?void 0:e[0].total)||0}),[Y]),ae=J||te,le=H&&(null===(b=H.pages)||void 0===b?void 0:b.length)>(l?1:0),ce=q&&!le,de=le&&H.pages[0].events.length>0,{data:ue}=((e,t)=>{const{http:s}=Object(y.useKibana)().services,o=[m,t];return Object(Ie.useQuery)(o,(async()=>{var o,i,n,r,a,l,c,d,u;if(!t)return e;const p=null!==(o=null===(i=(await s.get("/internal/session_view/alert_status_route",{query:{alertUuid:t}})).events)||void 0===i?void 0:i.map((e=>e._source)))&&void 0!==o?o:[];return{...e,[t]:{status:null!==(n=null===(r=p[0])||void 0===r||null===(a=r.kibana)||void 0===a||null===(l=a.alert)||void 0===l?void 0:l.workflow_status)&&void 0!==n?n:"",processEntityId:null!==(c=null===(d=p[0])||void 0===d||null===(u=d.process)||void 0===u?void 0:u.entity_id)&&void 0!==c?c:""}}}),{refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1,cacheTime:0})})($,null!==(j=V[0])&&void 0!==j?j:"");Object(o.useEffect)((()=>{ue&&(P({...ue}),V.shift())}),[ue,V]);const pe=Object(o.useCallback)((e=>{A([e])}),[]),be=Object(o.useCallback)((()=>{F.current(),v(!x)}),[x]),je=Object(o.useCallback)((e=>{p&&p(e,(()=>pe(e)))}),[p,pe]),ge=Object(o.useCallback)((e=>{M(e)}),[M]);return ce?Object(C.jsx)(d.SectionLoading,null,Object(C.jsx)(a.FormattedMessage,{id:"xpack.sessionView.loadingProcessTree",defaultMessage:"Loading session…"})):de?Object(C.jsx)(i.a.Fragment,null,Object(C.jsx)("div",{css:_.sessionViewerComponent},Object(C.jsx)(n.EuiPanel,{hasShadow:!1,borderRadius:"none",className:"sessionViewerToolbar"},Object(C.jsx)(n.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},Object(C.jsx)(n.EuiFlexItem,{grow:!1},Object(C.jsx)(n.EuiBetaBadge,{label:ze,size:"s",css:_.betaBadge})),Object(C.jsx)(n.EuiFlexItem,{"data-test-subj":"sessionView:sessionViewProcessEventsSearch"},Object(C.jsx)(Se,{searchQuery:w,setSearchQuery:T,onProcessSelected:N,searchResults:k})),Object(C.jsx)(n.EuiFlexItem,{grow:!1},Object(C.jsx)(n.EuiButtonIcon,{iconType:"refresh",display:"empty",onClick:ie,size:"m","aria-label":"Session View Refresh Button","data-test-subj":"sessionView:sessionViewRefreshButton",isLoading:q})),Object(C.jsx)(n.EuiFlexItem,{grow:!1},Object(C.jsx)(Pe,{displayOptions:S,onChange:ge,showVerboseSearchTooltip:L})),Object(C.jsx)(n.EuiFlexItem,{grow:!1},Object(C.jsx)(n.EuiButton,{onClick:be,iconType:"list","data-test-subj":"sessionView:sessionViewDetailPanelToggle",fill:x},Object(C.jsx)(a.FormattedMessage,{id:"xpack.sessionView.buttonOpenDetailPanel",defaultMessage:"Detail panel"}))))),Object(C.jsx)(n.EuiHorizontalRule,{margin:"none"}),Object(C.jsx)(n.EuiResizableContainer,null,((t,s,{togglePanel:o})=>(F.current=()=>{null==o||o("session-detail-panel",{direction:"left"})},Object(C.jsx)(i.a.Fragment,null,Object(C.jsx)(t,{initialSize:100,minSize:"60%",paddingSize:"none"},ae&&Object(C.jsx)(n.EuiEmptyPrompt,{iconType:"alert",color:"danger",title:Object(C.jsx)("h2",null,Object(C.jsx)(a.FormattedMessage,{id:"xpack.sessionView.errorHeading",defaultMessage:"Error loading Session View"})),body:Object(C.jsx)("p",null,Object(C.jsx)(a.FormattedMessage,{id:"xpack.sessionView.errorMessage",defaultMessage:"There was an error loading the Session View."}))}),de&&Object(C.jsx)("div",{css:_.processTree},Object(C.jsx)(se,{key:e+I,sessionEntityId:e,data:H.pages,searchQuery:w,selectedProcess:h,onProcessSelected:N,jumpToEntityId:D,investigatedAlertId:u,isFetching:q,hasPreviousPage:U,hasNextPage:G,fetchNextPage:W,fetchPreviousPage:Q,setSearchResults:E,updatedAlertsStatus:$,onShowAlertDetails:je,showTimestamp:null==S?void 0:S.timestamp,verboseMode:null==S?void 0:S.verboseMode}))),Object(C.jsx)(s,{css:_.resizeHandle}),Object(C.jsx)(t,{id:"session-detail-panel",initialSize:30,minSize:"320px",paddingSize:"none",css:_.detailPanel},Object(C.jsx)(Te,{alerts:ne,alertsCount:re,isFetchingAlerts:Z,hasNextPageAlerts:ee,fetchNextPageAlerts:X,investigatedAlertId:u,selectedProcess:h,onJumpToEvent:R,onShowAlertDetails:je})))))))):Object(C.jsx)(n.EuiEmptyPrompt,{"data-test-subj":"sessionView:sessionViewProcessEventsEmpty",title:Object(C.jsx)("h2",null,Object(C.jsx)(a.FormattedMessage,{id:"xpack.sessionView.emptyDataTitle",defaultMessage:"No data to render"})),body:Object(C.jsx)("p",null,Object(C.jsx)(a.FormattedMessage,{id:"xpack.sessionView.emptyDataMessage",defaultMessage:"No process events found for this query."}))})}}}]);