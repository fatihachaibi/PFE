/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.fleet_bundle_jsonpfunction=window.fleet_bundle_jsonpfunction||[]).push([[3],{150:function(e,t,a){"use strict";var n,l=function(){var e={};return function(t){if(void 0===e[t]){var a=document.querySelector(t);if(window.HTMLIFrameElement&&a instanceof window.HTMLIFrameElement)try{a=a.contentDocument.head}catch(e){a=null}e[t]=a}return e[t]}}(),i=[];function r(e){for(var t=-1,a=0;a<i.length;a++)if(i[a].identifier===e){t=a;break}return t}function s(e,t){for(var a={},n=[],l=0;l<e.length;l++){var s=e[l],o=t.base?s[0]+t.base:s[0],c=a[o]||0,u="".concat(o," ").concat(c);a[o]=c+1;var d=r(u),m={css:s[1],media:s[2],sourceMap:s[3]};-1!==d?(i[d].references++,i[d].updater(m)):i.push({identifier:u,updater:E(m,t),references:1}),n.push(u)}return n}function o(e){var t=document.createElement("style"),n=e.attributes||{};if(void 0===n.nonce){var i=a.nc;i&&(n.nonce=i)}if(Object.keys(n).forEach((function(e){t.setAttribute(e,n[e])})),"function"==typeof e.insert)e.insert(t);else{var r=l(e.insert||"head");if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(t)}return t}var c,u=(c=[],function(e,t){return c[e]=t,c.filter(Boolean).join("\n")});function d(e,t,a,n){var l=a?"":n.media?"@media ".concat(n.media," {").concat(n.css,"}"):n.css;if(e.styleSheet)e.styleSheet.cssText=u(t,l);else{var i=document.createTextNode(l),r=e.childNodes;r[t]&&e.removeChild(r[t]),r.length?e.insertBefore(i,r[t]):e.appendChild(i)}}function m(e,t,a){var n=a.css,l=a.media,i=a.sourceMap;if(l?e.setAttribute("media",l):e.removeAttribute("media"),i&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}var g=null,p=0;function E(e,t){var a,n,l;if(t.singleton){var i=p++;a=g||(g=o(t)),n=d.bind(null,a,i,!1),l=d.bind(null,a,i,!0)}else a=o(t),n=m.bind(null,a,t),l=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(a)};return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else l()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===n&&(n=Boolean(window&&document&&document.all&&!window.atob)),n));var a=s(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var n=0;n<a.length;n++){var l=r(a[n]);i[l].references--}for(var o=s(e,t),c=0;c<a.length;c++){var u=r(a[c]);0===i[u].references&&(i[u].updater(),i.splice(u,1))}a=o}}}},151:function(e,t,a){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var a=function(e,t){var a,n,l,i=e[1]||"",r=e[3];if(!r)return i;if(t&&"function"==typeof btoa){var s=(a=r,n=btoa(unescape(encodeURIComponent(JSON.stringify(a)))),l="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(n),"/*# ".concat(l," */")),o=r.sources.map((function(e){return"/*# sourceURL=".concat(r.sourceRoot||"").concat(e," */")}));return[i].concat(o).concat([s]).join("\n")}return[i].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(a,"}"):a})).join("")},t.i=function(e,a,n){"string"==typeof e&&(e=[[null,e,""]]);var l={};if(n)for(var i=0;i<this.length;i++){var r=this[i][0];null!=r&&(l[r]=!0)}for(var s=0;s<e.length;s++){var o=[].concat(e[s]);n&&l[o[0]]||(a&&(o[2]?o[2]="".concat(a," and ").concat(o[2]):o[2]=a),t.push(o))}},t}},283:function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(284);case"v8light":return a(286)}},284:function(e,t,a){var n=a(150),l=a(285);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);n(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},285:function(e,t,a){(t=a(151)(!1)).push([e.i,".fleet__epm__shiftNavTabs{margin-left:184px}\n",""]),e.exports=t},286:function(e,t,a){var n=a(150),l=a(287);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);n(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},287:function(e,t,a){(t=a(151)(!1)).push([e.i,".fleet__epm__shiftNavTabs{margin-left:184px}\n",""]),e.exports=t},304:function(e,t,a){"use strict";a.r(t),a.d(t,"ProtectedRoute",(function(){return Ft})),a.d(t,"renderApp",(function(){return Ct})),a.d(t,"teardownIntegrations",(function(){return Pt}));var n=a(0),l=a.n(n),i=a(64),r=a.n(i),s=a(12),o=a(10),c=a(6),u=a(152),d=a.n(u),m=a(22),g=a(65),p=a(70),E=a(78),f=a(79),b=a(84),h=a(102),k=a(62);const v=Object(n.memo)((({section:e,children:t})=>{const{getHref:a}=Object(o.Ib)();return l.a.createElement(h.a,{leftColumn:l.a.createElement(c.EuiFlexGroup,{direction:"column",gutterSize:"none",justifyContent:"center"},l.a.createElement(c.EuiText,null,l.a.createElement("h1",null,l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.integrationsHeaderTitle",defaultMessage:"Integrations"}))),l.a.createElement(c.EuiSpacer,{size:"s"}),l.a.createElement(c.EuiFlexItem,{grow:!1},l.a.createElement(c.EuiText,{size:"s",color:"subdued"},l.a.createElement("p",null,l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.epm.pageSubtitle",defaultMessage:"Choose an integration to start collecting and analyzing your data."}))))),tabs:[{name:l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.appNavigation.integrationsAllLinkText",defaultMessage:"Browse integrations"}),isSelected:"browse"===e,href:a("integrations_all")},{name:l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.appNavigation.integrationsInstalledLinkText",defaultMessage:"Installed integrations"}),isSelected:"manage"===e,href:a("integrations_installed")}]},t)}));var y=a(19),x=a.n(y),M=a(4),j=a(1),O=a(90),F=a(63),I=a.n(F),C=a(68),P=a(107);const w={beta:M.i18n.translate("xpack.fleet.epm.releaseBadge.betaLabel",{defaultMessage:"Beta"}),experimental:M.i18n.translate("xpack.fleet.epm.releaseBadge.experimentalLabel",{defaultMessage:"Technical preview"})},S={beta:M.i18n.translate("xpack.fleet.epm.releaseBadge.betaDescription",{defaultMessage:"This integration is not recommended for use in production environments."}),experimental:M.i18n.translate("xpack.fleet.epm.releaseBadge.experimentalDescription",{defaultMessage:"This functionality is in technical preview and may be changed or removed completely in a future release. Elastic will take a best effort approach to fix any issues, but features in technical preview are not subject to the support SLA of official GA features."})},T=({release:e})=>{if("ga"===e)return null;const t=w[e];return l.a.createElement(c.EuiToolTip,{position:"bottom",content:S[e],title:t},l.a.createElement(c.EuiBadge,null,t))},L=({release:e})=>{if("ga"===e)return null;const t=w[e];return l.a.createElement(c.EuiToolTip,{display:"inlineBlock",content:S[e],title:t},l.a.createElement(c.EuiBadge,{color:"hollow"},t))},_=I()(c.EuiCard).withConfig({displayName:"Card",componentId:"sc-1xgrkpq-0"})(["min-height:127px;"]);function A({description:e,name:t,title:a,version:n,icons:i,integration:r,url:s,release:o,id:u,fromIntegrations:d}){let m=null;o&&"ga"!==o&&(m=l.a.createElement(c.EuiFlexItem,{grow:!1},l.a.createElement(c.EuiSpacer,{size:"xs"}),l.a.createElement("span",null,l.a.createElement(L,{release:o}))));const{application:g}=Object(f.L)(),p=`integration-card:${u}`;return l.a.createElement(C.TrackApplicationView,{viewId:p},l.a.createElement(_,{"data-test-subj":p,layout:"horizontal",title:a||"",titleSize:"xs",description:e,hasBorder:!0,icon:l.a.createElement(P.a,{icons:i,packageName:t,integrationName:r,version:n,size:"xl"}),onClick:()=>{s.startsWith(b.c)?g.navigateToApp(b.d,{path:s.slice(b.c.length),state:{fromIntegrations:d}}):s.startsWith("http")||s.startsWith("https")?window.open(s,"_blank"):g.navigateToUrl(s)}},m))}const N=({isLoading:e,controls:t,title:a,list:i,initialSearch:r,onSearchChange:s,setSelectedCategory:o,showMissingIntegrationMessage:u=!1,featuredList:d=null,callout:m})=>{const[g,p]=Object(n.useState)(r||""),E=Object(f.G)(i),b=Object(n.useRef)(null),[h,k]=Object(n.useState)(!1),[v]=Object(n.useState)(window.scrollY);Object(n.useEffect)((()=>{const e=b.current,t=()=>{e&&k((null==e?void 0:e.getBoundingClientRect().top)<110)};return window.addEventListener("scroll",t),()=>window.removeEventListener("scroll",t)}),[v,h]);const y=l.a.createElement(z,{title:a,controls:t,sticky:h});let x;if(e||!E.current)x=l.a.createElement(O.m,null);else{const e=g?i.filter((e=>E.current.search(g).map((e=>e[f.h])).includes(e[f.h]))):i;x=l.a.createElement(U,{list:e,showMissingIntegrationMessage:u})}return l.a.createElement(l.a.Fragment,null,d,l.a.createElement("div",{ref:b},l.a.createElement(c.EuiFlexGroup,{alignItems:"flexStart",gutterSize:"xl"},l.a.createElement(c.EuiFlexItem,{grow:1,className:h?"kbnStickyMenu":""},y),l.a.createElement(c.EuiFlexItem,{grow:5},l.a.createElement(c.EuiSearchBar,{query:g||void 0,box:{placeholder:M.i18n.translate("xpack.fleet.epmList.searchPackagesPlaceholder",{defaultMessage:"Search for integrations"}),incremental:!0},onChange:({queryText:e,error:t})=>{t||(s(e),p(e))}}),m?l.a.createElement(l.a.Fragment,null,l.a.createElement(c.EuiSpacer,null),m):null,l.a.createElement(c.EuiSpacer,null),x,u&&l.a.createElement(l.a.Fragment,null,l.a.createElement(c.EuiSpacer,null),l.a.createElement(B,{resetQuery:()=>{p("")},setSelectedCategory:o}))))))};function z({controls:e,title:t,sticky:a}){let n;return t&&(n=l.a.createElement(l.a.Fragment,null,l.a.createElement(c.EuiTitle,{size:"s"},l.a.createElement("h2",null,t)),l.a.createElement(c.EuiSpacer,{size:"l"}))),l.a.createElement(c.EuiFlexGroup,{direction:"column",className:a?"kbnStickyMenu":"",gutterSize:"none"},n,e)}function U({list:e,showMissingIntegrationMessage:t=!1}){return l.a.createElement(c.EuiFlexGrid,{gutterSize:"l",columns:3},e.length?e.map((e=>l.a.createElement(c.EuiFlexItem,{key:e.id},l.a.createElement(A,e)))):l.a.createElement(c.EuiFlexItem,{grow:3},l.a.createElement(c.EuiText,null,l.a.createElement("p",null,t?l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.epmList.missingIntegrationPlaceholder",defaultMessage:"We didn't find any integrations matching your search term. Please try another keyword or browse using the categories on the left."}):l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.epmList.noPackagesFoundPlaceholder",defaultMessage:"No integrations found"})))))}function B({resetQuery:e,setSelectedCategory:t}){const a=Object(n.useCallback)((()=>{e(),t("custom")}),[e,t]);return l.a.createElement(c.EuiText,{size:"s",color:"subdued"},l.a.createElement("p",null,l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.integrations.missing",defaultMessage:"Don't see an integration? Collect any logs or metrics using our {customInputsLink}. Request new integrations in our {forumLink}.",values:{customInputsLink:l.a.createElement(c.EuiLink,{onClick:a},l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.integrations.customInputsLink",defaultMessage:"custom inputs"})),forumLink:l.a.createElement(c.EuiLink,{href:"https://discuss.elastic.co/tag/integrations",external:!0,target:"_blank"},l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.integrations.discussForumLink",defaultMessage:"forum"}))}})))}const R={id:"",title:M.i18n.translate("xpack.fleet.epmList.allPackagesFilterLinkText",{defaultMessage:"All categories"})},D={id:"",title:M.i18n.translate("xpack.fleet.epmList.allPackagesInstalledFilterLinkText",{defaultMessage:"All installed"})};function $({isLoading:e,categories:t,selectedCategory:a,onCategoryChange:n}){return l.a.createElement(c.EuiFacetGroup,null,e?l.a.createElement(O.m,null):t.map((e=>l.a.createElement(c.EuiFacetButton,{isSelected:e.id===a,key:e.id,id:e.id,quantity:e.count,onClick:()=>n(e)},e.title))))}const G=()=>{const{docLinks:e}=Object(f.L)();return l.a.createElement(c.EuiLink,{href:e.links.fleet.learnMoreBlog,target:"_blank"},M.i18n.translate("xpack.fleet.epmList.availableCalloutBlogText",{defaultMessage:"announcement blog post"}))},H=()=>l.a.createElement(c.EuiCallOut,{title:M.i18n.translate("xpack.fleet.epmList.availableCalloutTitle",{defaultMessage:"Only installed Elastic Agent Integrations are displayed."}),iconType:"iInCircle"},l.a.createElement("p",null,l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.epmList.availableCalloutIntroText",defaultMessage:"To learn more about integrations and the Elastic Agent, read our {link}",values:{link:l.a.createElement(G,null)}}))),V=Object(n.memo)((()=>{Object(f.q)("integrations_installed");const{data:e,isLoading:t}=Object(f.A)({experimental:!0}),{getHref:a,getAbsolutePath:i}=Object(f.E)(),{selectedCategory:r,searchParam:o}=re(Object(s.useParams)(),Object(s.useLocation)().search),c=Object(s.useHistory)();function u(e){const t=b.k.integrations_installed({category:e,searchTerm:o})[1];c.push(t)}const d=Object(n.useMemo)((()=>((null==e?void 0:e.response)||[]).filter((e=>e.status===j.Db.Installed))),[null==e?void 0:e.response]),m=Object(n.useMemo)((()=>d.filter((e=>"savedObject"in e&&x()(e.savedObject.attributes.version,e.version)))),[d]),g=Object(n.useMemo)((()=>[{...D,count:d.length},{id:"updates_available",count:m.length,title:M.i18n.translate("xpack.fleet.epmList.updatesAvailableFilterLinkText",{defaultMessage:"Updates available"})}]),[d.length,m.length]);if(!se(r,g))return c.replace(b.k.integrations_installed({category:"",searchTerm:o})[1]),null;const p=l.a.createElement($,{categories:g,selectedCategory:r,onCategoryChange:({id:e})=>u(e)}),E=("updates_available"===r?m:d).map((e=>oe(i,a,e,r||"installed"))),h="updates_available"===r?null:l.a.createElement(H,null);return l.a.createElement(N,{isLoading:t,controls:p,setSelectedCategory:u,callout:h,onSearchChange:function(e){c.replace(b.k.integrations_installed({category:r,searchTerm:e})[1])},initialSearch:o,list:E})}));var q=a(9),W=a.n(q),K=a(2),Y=a(69);const X=l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.epm.integrationPreference.recommendedTooltip",defaultMessage:"We recommend Elastic Agent integrations when they are generally available."}),J=I()(c.EuiFlexItem).withConfig({displayName:"Item",componentId:"sc-3a25e0-0"})(["padding-left:",";"],(e=>e.theme.eui.euiSizeXS)),Q=[{type:"recommended",label:l.a.createElement(c.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},l.a.createElement(c.EuiFlexItem,{grow:!1},M.i18n.translate("xpack.fleet.epm.integrationPreference.recommendedLabel",{defaultMessage:"Recommended"})),l.a.createElement(J,null,l.a.createElement(c.EuiIconTip,{content:X})))},{type:"agent",label:M.i18n.translate("xpack.fleet.epm.integrationPreference.elasticAgentLabel",{defaultMessage:"Elastic Agent only"})},{type:"beats",label:M.i18n.translate("xpack.fleet.epm.integrationPreference.beatsLabel",{defaultMessage:"Beats only"})}],Z=({initialType:e,onChange:t})=>{const[a,n]=l.a.useState(e),{docLinks:i}=Object(f.L)(),r=l.a.createElement(c.EuiLink,{href:i.links.fleet.beatsAgentComparison},l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.epm.integrationPreference.titleLink",defaultMessage:"Elastic Agent and Beats"})),s=l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.epm.integrationPreference.title",defaultMessage:"If an integration is available for {link}, show:",values:{link:r}}),o=Q.map((e=>({id:e.type,value:e.type,label:e.label})));return l.a.createElement(c.EuiPanel,{hasShadow:!1,paddingSize:"none"},l.a.createElement(c.EuiText,{size:"s"},s),l.a.createElement(c.EuiSpacer,{size:"m"}),l.a.createElement(c.EuiForm,null,l.a.createElement(c.EuiRadioGroup,{options:o,idSelected:a,onChange:(e,a)=>{n(e),t(a)},name:"preference"})),l.a.createElement(c.EuiSpacer,{size:"m"}))};var ee=a(74);const te=({statusCode:e})=>{let t,a;return 502===e?(t=M.i18n.translate("xpack.fleet.epmList.eprUnavailableBadGatewayCalloutTitle",{defaultMessage:"Kibana cannot reach the Elastic Package Registry, which provides Elastic Agent integrations\n"}),a=l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.epmList.eprUnavailableCallouBdGatewaytTitleMessage",defaultMessage:"To view these integrations, configure a  {registryproxy} or host {onpremregistry}.",values:{registryproxy:l.a.createElement(ae,null),onpremregistry:l.a.createElement(ne,null)}})):(t=M.i18n.translate("xpack.fleet.epmList.eprUnavailable400500CalloutTitle",{defaultMessage:"Kibana cannot connect to the Elastic Package Registry, which provides Elastic Agent integrations\n"}),a=l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.epmList.eprUnavailableCallout400500TitleMessage",defaultMessage:"Ensure the {registryproxy} or {onpremregistry} is configured correctly, or try again later.",values:{registryproxy:l.a.createElement(ae,null),onpremregistry:l.a.createElement(ne,null)}})),l.a.createElement(c.EuiCallOut,{title:t,iconType:"iInCircle",color:"warning"},l.a.createElement("p",null,a))};function ae(){const{docLinks:e}=Object(f.L)();return l.a.createElement(c.EuiLink,{href:e.links.fleet.settingsFleetServerProxySettings,target:"_blank"},M.i18n.translate("xpack.fleet.epmList.proxyLinkSnippedText",{defaultMessage:"proxy server"}))}function ne(){const{docLinks:e}=Object(f.L)();return l.a.createElement(c.EuiLink,{href:e.links.fleet.onPremRegistry,target:"_blank"},M.i18n.translate("xpack.fleet.epmList.onPremLinkSnippetText",{defaultMessage:"your own registry"}))}function le(e){var t;if(!Object(K.i)(e))return e.categories;const a=null===(t=e.policy_templates)||void 0===t?void 0:t.reduce(((e,t)=>[...e,...t.categories||[]]),e.categories||[]);return W.a.uniq(a)}const ie=Object(n.memo)((()=>{const[e,t]=Object(n.useState)("recommended");Object(f.q)("integrations_all");const{http:a}=Object(f.L)(),i=a.basePath.prepend,{selectedCategory:r,searchParam:o}=re(Object(s.useParams)(),Object(s.useLocation)().search),u=Object(s.useHistory)(),{getHref:d,getAbsolutePath:m}=Object(f.E)();function g(e){const t=b.k.integrations_all({category:e,searchTerm:o})[1];u.push(t)}const{data:p,isLoading:E,error:h}=Object(f.A)({category:"",excludeInstallStatus:!0}),k=Object(n.useMemo)((()=>((null==p?void 0:p.items)||[]).reduce(((e,t)=>{const{policy_templates:a=[],categories:n=[],...l}=t;return[...e,{...l,categories:le(t)},...Object(K.i)(t)?a.map((e=>{const{name:t,title:a,description:i,icons:r,categories:s=[]}=e,o=[...n,...s];return{...l,id:`${l.id}-${t}`,integration:t,title:a,description:i,icons:r||l.icons,categories:W.a.uniq(o)}})):[]]}),[])),[p]),{value:v}=Object(f.B)(),y=function(e,t){const a=[],n=t,l=e.filter((e=>e.name!==j.J));l.forEach((e=>{const t=function(e,t,a){return"ga"===a?[]:Object(Y.filterCustomIntegrations)(e,{eprPackageName:t})}(n,e.name,e.release);t.length?t.forEach((e=>{a.find((({id:t})=>t===e.id))||a.push(e)})):a.push(e)}));const i=n.filter((e=>!l.find((t=>t.name===e.eprOverlap))));return a.push(...i),a}("beats"===e?[]:k,"agent"===e?[]:v||[]),{loading:x,value:O}=Object(f.t)(),F=[...y,...O||[]].map((e=>oe(m,d,e)));F.sort(((e,t)=>e.title.localeCompare(t.title)));const{data:I,isLoading:P,error:w}=Object(f.u)({include_policy_templates:!0}),S=Object(n.useMemo)((()=>{const e=P?[]:function(e,t){const a=[],n=(e,t,n)=>{const l=a.find((t=>t.id===e));l?l.count+=t:a.push({id:e,count:t,title:n})};e.forEach((e=>{n(e.id,0,e.title)})),t.forEach((e=>{e.categories.forEach((e=>{const t=ee.INTEGRATION_CATEGORY_DISPLAY[e]?ee.INTEGRATION_CATEGORY_DISPLAY[e]:e;n(e,1,t)}))}));const l=a.filter((e=>e.count>0));return l.sort(((e,t)=>e.id.localeCompare(t.id))),l}(I?I.items:[],F);return[{...R,count:F.length},...e||[]]}),[F,I,P]);if(!P&&!se(r,S))return u.replace(b.k.integrations_all({category:"",searchTerm:o})[1]),null;let T=[l.a.createElement(c.EuiFlexItem,{grow:!1},l.a.createElement(c.EuiHorizontalRule,{margin:"m"}),l.a.createElement(Z,{initialType:e,onChange:t}))];S&&(T=[l.a.createElement(c.EuiFlexItem,{className:"eui-yScrollWithShadows"},l.a.createElement($,{isLoading:P||E||x,categories:S,selectedCategory:r,onCategoryChange:({id:e})=>{g(e)}})),...T]);const L=F.filter((e=>""===r||e.categories.includes(r))),_=l.a.createElement(l.a.Fragment,null,l.a.createElement(c.EuiFlexGrid,{columns:3},l.a.createElement(c.EuiFlexItem,null,l.a.createElement(C.TrackApplicationView,{viewId:"integration-card:epr:app_search_web_crawler:featured"},l.a.createElement(c.EuiCard,{"data-test-subj":"integration-card:epr:app_search_web_crawler:featured",icon:l.a.createElement(c.EuiIcon,{type:"logoAppSearch",size:"xxl"}),href:i("/app/enterprise_search/app_search/engines/new?method=crawler"),title:M.i18n.translate("xpack.fleet.featuredSearchTitle",{defaultMessage:"Web site crawler"}),description:M.i18n.translate("xpack.fleet.featuredSearchDesc",{defaultMessage:"Add search to your website with the App Search web crawler."})}))),l.a.createElement(c.EuiFlexItem,null,l.a.createElement(C.TrackApplicationView,{viewId:"integration-card:epr:apm:featured"},l.a.createElement(c.EuiCard,{"data-test-subj":"integration-card:epr:apm:featured",title:M.i18n.translate("xpack.fleet.featuredObsTitle",{defaultMessage:"Elastic APM"}),description:M.i18n.translate("xpack.fleet.featuredObsDesc",{defaultMessage:"Monitor, detect, and diagnose complex application performance issues."}),href:i("/app/home#/tutorial/apm"),icon:l.a.createElement(c.EuiIcon,{type:"logoObservability",size:"xxl"})}))),l.a.createElement(c.EuiFlexItem,null,l.a.createElement(C.TrackApplicationView,{viewId:"integration-card:epr:endpoint:featured"},l.a.createElement(c.EuiCard,{"data-test-subj":"integration-card:epr:endpoint:featured",icon:l.a.createElement(c.EuiIcon,{type:"logoSecurity",size:"xxl"}),href:i("/app/integrations/detail/endpoint/"),title:M.i18n.translate("xpack.fleet.featuredSecurityTitle",{defaultMessage:"Endpoint and Cloud Security"}),description:M.i18n.translate("xpack.fleet.featuredSecurityDesc",{defaultMessage:"Protect your hosts and cloud workloads with threat prevention, detection, and deep security data visibility."})})))),l.a.createElement(c.EuiSpacer,{size:"xl"}));let A;if(h||w){const e=h||w;A=l.a.createElement(te,{statusCode:null==e?void 0:e.statusCode})}return l.a.createElement(N,{featuredList:_,isLoading:E,controls:T,initialSearch:o,list:L,setSelectedCategory:g,onSearchChange:function(e){u.replace(b.k.integrations_all({searchTerm:e})[1])},showMissingIntegrationMessage:!0,callout:A})})),re=(e,t)=>{const{category:a}=e;return{selectedCategory:a||"",searchParam:new URLSearchParams(t).get(b.f)||""}},se=(e,t)=>t.some((t=>t.id===e)),oe=(e,t,a,n)=>{let l,i;if("ui_link"===a.type)l=a.uiExternalLink||e(a.uiInternalPath);else{let e=a.version;"savedObject"in a&&(e=a.savedObject.attributes.version||a.version),l=t("integration_details_overview",{pkgkey:`${a.name}-${e}`,...a.integration?{integration:a.integration}:{}})}return"release"in a?i=a.release:!0===a.isBeta&&(i="beta"),{id:`${"ui_link"===a.type?"ui_link":"epr"}:${a.id}`,description:a.description,icons:a.icons&&a.icons.length?a.icons:[],title:a.title,url:l,fromIntegrations:n,integration:"integration"in a&&a.integration||"",name:"name"in a&&a.name||"",version:"version"in a&&a.version||"",release:i,categories:(a.categories||[]).filter((e=>!!e))}},ce=Object(n.memo)((()=>l.a.createElement(s.Switch,null,l.a.createElement(s.Route,{path:b.e.integrations_installed},l.a.createElement(v,{section:"manage"},l.a.createElement(V,null))),l.a.createElement(s.Route,{path:b.e.integrations_all},l.a.createElement(v,{section:"browse"},l.a.createElement(ie,null))))));var ue=a(5),de=a(33);const me=["apm","cloud_security_posture","dga","endpoint","fleet_server","kubernetes","osquery_manager","problemchild","security_detection_engine","synthetics"];function ge(e){const{userCanInstallPackages:t,missingSecurityConfiguration:a,packageName:n,href:i,onClick:r}=e,s=t?void 0:{content:a?l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.epm.addPackagePolicyButtonSecurityRequiredTooltip",defaultMessage:"To add Elastic Agent Integrations, you must have security enabled and have the All privilege for Fleet. Contact your administrator."}):l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.epm.addPackagePolicyButtonPrivilegesRequiredTooltip",defaultMessage:"Elastic Agent Integrations require the All privilege for Fleet and All privilege for Integrations. Contact your administrator."})};return l.a.createElement(O.h,{fill:!0,isDisabled:!t,iconType:"plusInCircle",href:i,onClick:e=>r(e),"data-test-subj":"addIntegrationPolicyButton",tooltip:s},l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.epm.addPackagePolicyButtonText",defaultMessage:"Add {packageName}",values:{packageName:n}}))}const pe=({size:e="m"})=>l.a.createElement(c.EuiIconTip,{"aria-label":M.i18n.translate("xpack.fleet.epm.updateAvailableTooltip",{defaultMessage:"Update available"}),size:e,type:"alert",color:"warning",content:M.i18n.translate("xpack.fleet.epm.updateAvailableTooltip",{defaultMessage:"Update available"})}),Ee=Object(n.memo)((({packageName:e})=>{var t;const{data:a}=Object(f.z)(e);return l.a.createElement(l.a.Fragment,null,null!==(t=null==a?void 0:a.response.agent_policy_count)&&void 0!==t?t:0)})),fe=I()(c.EuiPanel).withConfig({displayName:"Panel",componentId:"sc-536qps-0"})(["padding:",";width:","px;svg,img{height:","px;width:","px;}.euiFlexItem{height:","px;justify-content:center;}"],(e=>e.theme.eui.euiSizeXL),(e=>6*parseFloat(e.theme.eui.euiSize)+2*parseFloat(e.theme.eui.euiSizeXL)),(e=>6*parseFloat(e.theme.eui.euiSize)),(e=>6*parseFloat(e.theme.eui.euiSize)),(e=>6*parseFloat(e.theme.eui.euiSize)));function be({packageName:e,integrationName:t,version:a,icons:n}){const i=Object(f.H)({packageName:e,integrationName:t,version:a,icons:n});return l.a.createElement(fe,null,l.a.createElement(c.EuiIcon,{type:i,size:"original"}))}function he(){return l.a.createElement(fe,null,l.a.createElement(O.m,null))}const ke=({checked:e,disabled:t=!1,onChange:a})=>l.a.createElement(l.a.Fragment,null,l.a.createElement(c.EuiSwitch,{label:M.i18n.translate("xpack.fleet.integrations.settings.keepIntegrationPoliciesUpToDateLabel",{defaultMessage:"Keep integration policies up to date automatically"}),checked:e,onChange:a,disabled:t}),l.a.createElement(c.EuiSpacer,{size:"s"}),l.a.createElement(c.EuiText,{color:"subdued",size:"xs"},l.a.createElement(c.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},l.a.createElement(c.EuiFlexItem,{grow:!1},l.a.createElement(c.EuiIcon,{type:"iInCircle"})),l.a.createElement(c.EuiFlexItem,{grow:!1},t?l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.integrations.settings.keepIntegrationPoliciesUpToDateDisabledDescription",defaultMessage:"This integration requires Fleet to automatically upgrade its integration policies"}):l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.integrations.settings.keepIntegrationPoliciesUpToDateDescription",defaultMessage:"When enabled, Fleet will attempt to upgrade and deploy integration policies automatically"}))))),ve=[de.c.dashboard,de.c.search,de.c.visualization];var ye=a(45);const xe=({savedObjects:e,type:t})=>{const{http:a}=Object(f.L)(),n=t===de.c.dashboard;return l.a.createElement(c.EuiAccordion,{initialIsOpen:n,buttonContent:l.a.createElement(c.EuiFlexGroup,{justifyContent:"center",alignItems:"center",gutterSize:"s",responsive:!1},l.a.createElement(c.EuiFlexItem,{grow:!1},l.a.createElement(c.EuiText,{size:"m"},l.a.createElement("h3",null,ye.a[t]))),l.a.createElement(c.EuiFlexItem,{grow:!1},l.a.createElement(c.EuiNotificationBadge,{color:"subdued",size:"m"},l.a.createElement("h3",null,e.length)))),id:t},l.a.createElement(l.a.Fragment,null,l.a.createElement(c.EuiSpacer,{size:"m"}),l.a.createElement(c.EuiSplitPanel.Outer,{hasBorder:!0,hasShadow:!1},e.map((({id:n,attributes:{title:i,description:r}},s)=>{if("view"===t)return;const o=Object(f.g)({http:a,id:n,type:t});return l.a.createElement(l.a.Fragment,null,l.a.createElement(c.EuiSplitPanel.Inner,{grow:!1,key:s},l.a.createElement(c.EuiText,{size:"m"},l.a.createElement("p",null,o?l.a.createElement(c.EuiLink,{href:o},i):i)),r&&l.a.createElement(l.a.Fragment,null,l.a.createElement(c.EuiSpacer,{size:"s"}),l.a.createElement(c.EuiText,{size:"s",color:"subdued"},l.a.createElement("p",null,r)))),s+1<e.length&&l.a.createElement(c.EuiHorizontalRule,{margin:"none"}))})))))},Me=new Set(ve),je=({packageInfo:e})=>{const{name:t,version:a}=e,i=`${t}-${a}`,{spaces:r,savedObjects:{client:o}}=Object(f.L)(),u=Object(f.M)(e.name,"package-detail-assets"),{getPath:d}=Object(f.E)(),m=Object(f.x)()(e.name),[g,p]=Object(n.useState)(!0),[E,b]=Object(n.useState)(),[h,v]=Object(n.useState)(),[y,x]=Object(n.useState)(!0);if(Object(n.useEffect)((()=>{(async()=>{if("savedObject"in e){if(r){const{id:t}=await r.getActiveSpace(),a=e.savedObject.attributes.installed_kibana_space_id;if(a&&a!==t)return p(!1),void x(!1)}const{savedObject:{attributes:t}}=e;if(!t.installed_kibana||0===t.installed_kibana.length)return void x(!1);try{const e=t.installed_kibana.map((({id:e,type:t})=>({id:e,type:t}))),a=await Promise.all(Object.entries(Object(q.groupBy)(e,"type")).map((([e,t])=>o.bulkResolve(t).catch((e=>{var t;if(403===(null==e||null===(t=e.body)||void 0===t?void 0:t.statusCode))return{resolved_objects:[]};throw e})).then((({resolved_objects:e})=>e.map((({saved_object:e})=>e)).filter((e=>{var t;return 404!==(null==e||null===(t=e.error)||void 0===t?void 0:t.statusCode)&&Me.has(e.type)})))))));b(a.flat())}catch(e){v(e)}finally{x(!1)}}else x(!1)})()}),[o,e,r]),m.status!==de.b.installed)return l.a.createElement(s.Redirect,{to:d("integration_details_overview",{pkgkey:i})});let M;return M=y?l.a.createElement(O.m,null):h?l.a.createElement(O.g,{title:l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.epm.packageDetails.assets.fetchAssetsErrorTitle",defaultMessage:"Error loading assets"}),error:h}):g?void 0===E||0===E.length?u?l.a.createElement(O.i,null,l.a.createElement(u.Component,null)):l.a.createElement(c.EuiTitle,null,l.a.createElement("h2",null,l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.epm.packageDetails.assets.noAssetsFoundLabel",defaultMessage:"No assets found"}))):[...ve.map((e=>{const t=E.filter((t=>t.type===e));return t.length?l.a.createElement(l.a.Fragment,null,l.a.createElement(xe,{savedObjects:t,type:e}),l.a.createElement(c.EuiSpacer,{size:"l"})):null})),u?l.a.createElement(O.i,null,l.a.createElement(u.Component,null)):null]:l.a.createElement(c.EuiTitle,null,l.a.createElement("h2",null,l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.epm.packageDetails.assets.assetsNotAvailableInCurrentSpace",defaultMessage:"This integration is installed, but no assets are available in this space"}))),l.a.createElement(c.EuiFlexGroup,{alignItems:"flexStart"},l.a.createElement(c.EuiFlexItem,{grow:1}),l.a.createElement(c.EuiFlexItem,{grow:6},M))},Oe=I()(c.EuiPagination).withConfig({displayName:"Pagination",componentId:"sc-1fbln0a-0"})(["max-width:130px;"]),Fe=Object(n.memo)((({images:e,packageName:t,version:a})=>{const{toPackageImage:i}=Object(f.F)(),[r,s]=Object(n.useState)(0),o=Object(n.useMemo)((()=>e.length-1),[e.length]),u=Object(n.useMemo)((()=>i(e[r],t,a)),[r,e,t,i,a]);return l.a.createElement(c.EuiFlexGroup,{direction:"column",gutterSize:"s"},l.a.createElement(c.EuiFlexItem,null,l.a.createElement(c.EuiFlexGroup,{direction:"row",alignItems:"center",gutterSize:"xs",justifyContent:"spaceBetween"},l.a.createElement(c.EuiFlexItem,{grow:!1},l.a.createElement(c.EuiText,null,l.a.createElement("h4",null,l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.epm.screenshotsTitle",defaultMessage:"Screenshots"})))),l.a.createElement(c.EuiFlexItem,{grow:!1},l.a.createElement(Oe,{"aria-label":M.i18n.translate("xpack.fleet.epm.screenshotPaginationAriaLabel",{defaultMessage:"{packageName} screenshot pagination",values:{packageName:t}}),pageCount:o+1,activePage:r,onPageClick:e=>s(e),compressed:!0})))),l.a.createElement(c.EuiFlexItem,null,u?l.a.createElement(c.EuiImage,{allowFullScreen:!0,hasShadow:!0,alt:e[r].title||M.i18n.translate("xpack.fleet.epm.screenshotAltText",{defaultMessage:"{packageName} screenshot #{imageNumber}",values:{packageName:t,imageNumber:r+1}}),title:e[r].title,url:u}):l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.epm.screenshotErrorText",defaultMessage:"Unable to load this screenshot"})))}));var Ie=a(118),Ce=a.n(Ie);const Pe={$json:"json",$yml:"yml"},we={root:({children:e})=>l.a.createElement(c.EuiText,{grow:!0},e),table:({children:e})=>l.a.createElement("table",{className:"euiTable euiTable--responsive"},e),tableRow:({children:e})=>l.a.createElement(c.EuiTableRow,null,e),tableCell:({isHeader:e,children:t})=>e?l.a.createElement(c.EuiTableHeaderCell,null,t):l.a.createElement(c.EuiTableRowCell,null,t),heading:({level:e,children:t})=>{switch(e){case 1:return l.a.createElement("h3",null,t);case 2:return l.a.createElement("h4",null,t);case 3:return l.a.createElement("h5",null,t);default:return l.a.createElement("h6",null,t)}},link:({children:e,href:t})=>l.a.createElement(c.EuiLink,{href:t,target:"_blank",rel:"noopener nofollow noreferrer"},e),code:({language:e,value:t})=>{let a=e;const n=Pe[e];return n&&(a=n),l.a.createElement(c.EuiCodeBlock,{language:a,isCopyable:!0},t)}};function Se({readmePath:e,packageName:t,version:a}){const[i,r]=Object(n.useState)(void 0),{toRelativeImage:s}=Object(f.F)(),o=l.a.useCallback((e=>0!==e.indexOf("http://")&&0!==e.indexOf("https://")?s({packageName:t,version:a,path:e}):e),[s,t,a]);return Object(n.useEffect)((()=>{Object(f.k)(e).then((e=>{r(e.data||"")}))}),[e]),l.a.createElement(n.Fragment,null,void 0!==i?l.a.createElement(Ce.a,{transformImageUri:o,renderers:we,source:i}):l.a.createElement(c.EuiText,null,l.a.createElement("p",null,l.a.createElement(c.EuiLoadingContent,{lines:5})),l.a.createElement("p",null,l.a.createElement(c.EuiLoadingContent,{lines:6})),l.a.createElement("p",null,l.a.createElement(c.EuiLoadingContent,{lines:4}))))}const Te=({noticePath:e,onClose:t})=>{const{notifications:a}=Object(f.L)(),[i,r]=Object(n.useState)(void 0);return Object(n.useEffect)((()=>{!async function(){try{const{data:t}=await Object(f.k)(e);r(t||"")}catch(e){a.toasts.addError(e,{title:M.i18n.translate("xpack.fleet.epm.errorLoadingNotice",{defaultMessage:"Error loading NOTICE.txt"})})}}()}),[e,a]),l.a.createElement(c.EuiModal,{maxWidth:!0,onClose:t},l.a.createElement(c.EuiModalHeader,null,l.a.createElement(c.EuiModalHeaderTitle,null,l.a.createElement("h1",null,"NOTICE.txt"))),l.a.createElement(c.EuiModalBody,null,l.a.createElement(c.EuiCodeBlock,{overflowHeight:360},i||l.a.createElement(l.a.Fragment,null,l.a.createElement("p",null,l.a.createElement(c.EuiLoadingContent,{lines:5})),l.a.createElement("p",null,l.a.createElement(c.EuiLoadingContent,{lines:6}))))),l.a.createElement(c.EuiModalFooter,null,l.a.createElement(c.EuiButton,{color:"primary",fill:!0,onClick:t},l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.epm.noticeModalCloseBtn",defaultMessage:"Close"}))))},Le=Object(Y.withSuspense)(Y.LazyReplacementCard),_e=Object(g.euiStyled)(c.EuiFlexItem)`
  margin: 0;

  & .euiAccordion {
    padding-top: ${({theme:e})=>2*parseInt(e.eui.euiSizeL,10)}px;

    &::before {
      content: '';
      display: block;
      border-top: 1px solid ${({theme:e})=>e.eui.euiColorLightShade};
      position: relative;
      top: -${({theme:e})=>e.eui.euiSizeL};
      margin: 0 ${({theme:e})=>e.eui.euiSizeXS};
    }
  }
`,Ae=Object(n.memo)((({packageInfo:e})=>{const{data:t,isLoading:a}=Object(f.u)(),i=Object(n.useMemo)((()=>!a&&t&&t.response?t.response.filter((t=>{var a;return null===(a=e.categories)||void 0===a?void 0:a.includes(t.id)})).map((e=>e.title)):[]),[t,a,e.categories]),[r,s]=Object(n.useState)(!1),o=Object(n.useCallback)((()=>{s(!r)}),[r]),u=Object(n.useMemo)((()=>{var t;const a=[{title:l.a.createElement(c.EuiTextColor,{color:"subdued"},l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.epm.versionLabel",defaultMessage:"Version"})),description:e.version},{title:l.a.createElement(c.EuiTextColor,{color:"subdued"},l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.epm.categoryLabel",defaultMessage:"Category"})),description:i.join(", ")}];Object(de.d)(e.assets).forEach((([e,t])=>{const n=Object(de.d)(t).reduce(((t,[a,n])=>(ye.b[e].includes(a)&&(t[a]=n),t)),{});Object.entries(n).length&&a.push({title:l.a.createElement(c.EuiTextColor,{color:"subdued"},l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.epm.assetGroupTitle",defaultMessage:"{assetType} assets",values:{assetType:ye.c[e]}})),description:l.a.createElement(c.EuiFlexGroup,{direction:"column",gutterSize:"xs"},Object(de.d)(n).map((([e,t],a)=>{const n=e;return l.a.createElement(c.EuiFlexItem,{key:`item-${a}`},l.a.createElement(c.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",justifyContent:"spaceBetween"},l.a.createElement(c.EuiFlexItem,{grow:!1},ye.a[n]),l.a.createElement(c.EuiFlexItem,{grow:!1},l.a.createElement(c.EuiNotificationBadge,{color:"subdued"},t.length))))})))})}));const n=[...new Set((null===(t=e.data_streams)||void 0===t?void 0:t.map((e=>e.type)))||[])];return n.length&&a.push({title:l.a.createElement(c.EuiTextColor,{color:"subdued"},l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.epm.featuresLabel",defaultMessage:"Features"})),description:n.join(", ")}),(e.license||e.notice)&&a.push({title:l.a.createElement(c.EuiTextColor,{color:"subdued"},l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.epm.licenseLabel",defaultMessage:"License"})),description:l.a.createElement(l.a.Fragment,null,l.a.createElement("p",null,e.license),e.notice&&l.a.createElement("p",null,l.a.createElement(c.EuiLink,{onClick:o},"NOTICE.txt")))}),a}),[i,e.assets,e.data_streams,e.license,e.notice,e.version,o]);return l.a.createElement(l.a.Fragment,null,l.a.createElement(c.EuiPortal,null,r&&e.notice&&l.a.createElement(Te,{noticePath:e.notice,onClose:o})),l.a.createElement(c.EuiFlexGroup,{direction:"column",gutterSize:"m"},l.a.createElement(c.EuiFlexItem,null,l.a.createElement(c.EuiText,null,l.a.createElement("h4",null,l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.epm.detailsTitle",defaultMessage:"Details"})))),l.a.createElement(c.EuiFlexItem,null,l.a.createElement(c.EuiDescriptionList,{type:"column",compressed:!0,listItems:u})),l.a.createElement(_e,null,l.a.createElement(Le,{eprPackageName:e.name}))))})),Ne=I()(c.EuiFlexItem).withConfig({displayName:"LeftColumn",componentId:"sc-uj4rsg-0"})(["&&&{margin-top:77px;}"]),ze=Object(n.memo)((({packageInfo:e,integrationInfo:t})=>{const a=Object(n.useMemo)((()=>(null==t?void 0:t.screenshots)||e.screenshots||[]),[t,e.screenshots]);return l.a.createElement(c.EuiFlexGroup,{alignItems:"flexStart"},l.a.createElement(Ne,{grow:2}),l.a.createElement(c.EuiFlexItem,{grow:9,className:"eui-textBreakWord"},e.readme?l.a.createElement(Se,{readmePath:(null==t?void 0:t.readme)||e.readme,packageName:e.name,version:e.version}):null),l.a.createElement(c.EuiFlexItem,{grow:3},l.a.createElement(c.EuiFlexGroup,{direction:"column",gutterSize:"l",alignItems:"flexStart"},a.length?l.a.createElement(c.EuiFlexItem,null,l.a.createElement(Fe,{images:a,packageName:e.name,version:e.version})):null,l.a.createElement(c.EuiFlexItem,null,l.a.createElement(Ae,{packageInfo:e})))))}));var Ue=a(14);const Be=({onAddAgent:e})=>l.a.createElement(c.EuiButton,{iconType:"plusInCircle","data-test-subj":"addAgentButton",onClick:e,size:"s"},l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.epm.packageDetails.integrationList.addAgent",defaultMessage:"Add agent"})),Re=({onAddAgent:e})=>{const[t,a]=Object(n.useState)(!0),i=l.a.createElement(Be,{onAddAgent:()=>{a(!1),e()}});return l.a.createElement(O.a,{button:i,isOpen:t,closePopover:()=>a(!1)})},De=({agentPolicy:e,agentCount:t=0,onAddAgent:a,hasHelpPopover:n=!1})=>t>0||e.is_managed?l.a.createElement(O.l,{count:t,agentPolicyId:e.id,className:"eui-textTruncate"}):n?l.a.createElement(Re,{onAddAgent:a}):l.a.createElement(Be,{onAddAgent:a});var $e=a(82),Ge=a.n($e);const He={minWidth:0},Ve=Object(n.memo)((({name:e,className:t,"data-test-subj":a,title:i,...r})=>{const s=Object(n.useCallback)((e=>{if(a)return`${a}-${e}`}),[a]);return l.a.createElement(c.EuiFlexGroup,{gutterSize:"s",alignItems:"baseline",style:He,className:t,"data-test-subj":a,title:i,responsive:!1},l.a.createElement(c.EuiFlexItem,{grow:!1},l.a.createElement(c.EuiAvatar,Ge()({name:e,"data-test-subj":s("avatar")},r))),l.a.createElement(c.EuiFlexItem,{grow:!1,className:"eui-textTruncate"},l.a.createElement(c.EuiText,{size:"s",className:"eui-textTruncate","data-test-subj":s("name")},e)))})),qe=Object(n.memo)((({packagePolicy:e})=>{const{getHref:t}=Object(f.E)();return l.a.createElement(c.EuiLink,{className:"eui-textTruncate","data-test-subj":"integrationNameLink",title:e.name,href:t("integration_policy_edit",{packagePolicyId:e.id})},e.name)})),We=({name:e,version:t})=>{var a,i,r,o;const{search:u}=Object(s.useLocation)(),d=Object(s.useHistory)(),m=Object(n.useMemo)((()=>new URLSearchParams(u)),[u]),g=Object(n.useMemo)((()=>m.get("addAgentToPolicyId")),[m]),p=Object(n.useMemo)((()=>m.get("showAddAgentHelpForPolicyId")),[m]),[E,h]=Object(n.useState)(g),{getPath:v,getHref:y}=Object(f.E)(),x=Object(f.x)()(e),{pagination:j,pageSizeOptions:F,setPagination:I}=Object(f.O)(),{data:C,isLoading:P,resendRequest:w}=(e=>{const{data:t,error:a,isLoading:l,resendRequest:i}=Object(f.y)(e),r=Object(n.useMemo)((()=>{if(null==t||!t.items.length)return"";const e=new Set;return`${b.a}.package_policies: (${t.items.filter((t=>!e.has(t.policy_id)&&(e.add(t.policy_id),!0))).map((e=>e.id)).join(" or ")}) `}),[t]),{data:s,isLoading:o}=Object(f.r)({path:K.c.getListPath(),method:"get",query:{perPage:100,kuery:r},shouldSendRequest:!(null==t||!t.items.length)}),[c,u]=Object(n.useState)();return Object(n.useEffect)((()=>{if(l||o)return;if(null==t||!t.items)return void u(void 0);const e={};if(null!=s&&s.items)for(const t of s.items)e[t.id]=t;const a=t.items.map((t=>({packagePolicy:t,agentPolicy:e[t.policy_id]})));u({...t,items:a})}),[o,l,t,s]),{data:c,error:a,isLoading:l||o,resendRequest:i}})({page:j.currentPage,perPage:j.pageSize,kuery:`${b.h}.package.name: ${e}`}),{updatableIntegrations:S}=Object(f.I)(),T=Object(f.p)().integrations.writeIntegrationPolicies,L=Object(n.useMemo)((()=>{if(null==C||!C.items)return[];const e=C.items.map((({agentPolicy:e,packagePolicy:t})=>{var a,n;const l=S.get(null!==(a=null===(n=t.package)||void 0===n?void 0:n.name)&&void 0!==a?a:""),i=!!l&&l.policiesToUpgrade.some((({pkgPolicyId:e})=>e===t.id));return{agentPolicy:e,packagePolicy:{...t,hasUpgrade:i}}}));return e}),[null==C?void 0:C.items,S]),_=null===(a=L.find((({agentPolicy:e})=>e.id===p)))||void 0===a||null===(i=a.packagePolicy)||void 0===i?void 0:i.id;Object(n.useEffect)((()=>{const e=d.listen((e=>{const t=new URLSearchParams(e.search).get("addAgentToPolicyId");t&&h(t)}));return()=>e()}),[d]);const A=Object(n.useCallback)((({page:e})=>{I({currentPage:e.index+1,pageSize:e.size})}),[I]),N=Object(n.useMemo)((()=>[{field:"packagePolicy.name",name:M.i18n.translate("xpack.fleet.epm.packageDetails.integrationList.name",{defaultMessage:"Integration policy"}),render:(e,{packagePolicy:t})=>l.a.createElement(qe,{packagePolicy:t})},{field:"packagePolicy.package.version",name:M.i18n.translate("xpack.fleet.epm.packageDetails.integrationList.version",{defaultMessage:"Version"}),render:(e,{agentPolicy:t,packagePolicy:a})=>l.a.createElement(c.EuiFlexGroup,{gutterSize:"s",alignItems:"center",wrap:!0},l.a.createElement(c.EuiFlexItem,{grow:!1},l.a.createElement(c.EuiText,{size:"s",className:"eui-textNoWrap","data-test-subj":"packageVersionText"},l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.epm.packageDetails.integrationList.packageVersion",defaultMessage:"v{version}",values:{version:e}}))),a.hasUpgrade&&l.a.createElement(c.EuiFlexItem,{grow:!1},l.a.createElement(c.EuiButton,{size:"s",minWidth:"0",href:`${y("upgrade_package_policy",{policyId:t.id,packagePolicyId:a.id})}?from=integrations-policy-list`,"data-test-subj":"integrationPolicyUpgradeBtn",isDisabled:!T},l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.policyDetails.packagePoliciesTable.upgradeButton",defaultMessage:"Upgrade"}))))},{field:"packagePolicy.policy_id",name:M.i18n.translate("xpack.fleet.epm.packageDetails.integrationList.agentPolicy",{defaultMessage:"Agent policy"}),truncateText:!0,render:(e,{agentPolicy:t})=>l.a.createElement(O.e,{policy:t})},{field:"packagePolicy.updated_by",name:M.i18n.translate("xpack.fleet.epm.packageDetails.integrationList.updatedBy",{defaultMessage:"Last updated by"}),truncateText:!0,render:e=>l.a.createElement(Ve,{size:"s",name:e,title:e})},{field:"packagePolicy.updated_at",name:M.i18n.translate("xpack.fleet.epm.packageDetails.integrationList.updatedAt",{defaultMessage:"Last updated"}),truncateText:!0,render:e=>l.a.createElement("span",{className:"eui-textTruncate",title:e},l.a.createElement(k.FormattedRelative,{value:e}))},{field:"",name:M.i18n.translate("xpack.fleet.epm.packageDetails.integrationList.agentCount",{defaultMessage:"Agents"}),render:({agentPolicy:e,packagePolicy:t})=>l.a.createElement(De,{agentPolicy:e,agentCount:e.agents,onAddAgent:()=>h(e.id),hasHelpPopover:_===t.id})},{field:"",name:M.i18n.translate("xpack.fleet.epm.packageDetails.integrationList.actions",{defaultMessage:"Actions"}),width:"8ch",align:"right",render:({agentPolicy:e,packagePolicy:t})=>l.a.createElement(O.p,{agentPolicy:e,packagePolicy:t,showAddAgent:!0,upgradePackagePolicyHref:`${y("upgrade_package_policy",{policyId:e.id,packagePolicyId:t.id})}?from=integrations-policy-list`})}]),[y,_,T]),z=Object(n.useMemo)((()=>P?l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.epm.packageDetails.integrationList.loadingPoliciesMessage",defaultMessage:"Loading integration policiesâ€¦"}):void 0),[P]),U=Object(n.useMemo)((()=>{var e;return{pageIndex:j.currentPage-1,pageSize:j.pageSize,totalItemCount:null!==(e=null==C?void 0:C.total)&&void 0!==e?e:0,pageSizeOptions:F}}),[null==C?void 0:C.total,F,j.currentPage,j.pageSize]);if(x.status!==de.b.installed)return l.a.createElement(s.Redirect,{to:v("integration_details_overview",{pkgkey:`${e}-${t}`})});const B=L.find((({agentPolicy:e})=>e.id===E)),R=null==B?void 0:B.agentPolicy,D=null==B?void 0:B.packagePolicy;return l.a.createElement(f.b.Provider,{value:{refresh:w}},l.a.createElement(c.EuiFlexGroup,{alignItems:"flexStart"},l.a.createElement(c.EuiFlexItem,{grow:1}),l.a.createElement(c.EuiFlexItem,{grow:6},l.a.createElement(c.EuiBasicTable,{items:L||[],columns:N,loading:P,"data-test-subj":"integrationPolicyTable",pagination:U,onChange:A,noItemsMessage:z}))),E&&R&&!P&&l.a.createElement(O.b,{onClose:()=>{h(null);const{addAgentToPolicyId:e,...t}=Object(Ue.parse)(u);d.replace({search:Object(Ue.stringify)(t)})},agentPolicy:R,isIntegrationFlow:!0,installedPackagePolicy:{name:(null==D||null===(r=D.package)||void 0===r?void 0:r.name)||"",version:(null==D||null===(o=D.package)||void 0===o?void 0:o.version)||""}}))},Ke=e=>{const{onCancel:t,onConfirm:a,packageName:n,numOfAssets:i}=e;return l.a.createElement(c.EuiConfirmModal,{title:l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.integrations.settings.confirmInstallModal.installTitle",defaultMessage:"Install {packageName}",values:{packageName:n}}),onCancel:t,onConfirm:a,cancelButtonText:l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.integrations.settings.confirmInstallModal.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.integrations.settings.confirmInstallModal.installButtonLabel",defaultMessage:"Install {packageName}",values:{packageName:n}}),defaultFocusedButton:"confirm"},l.a.createElement(c.EuiCallOut,{iconType:"iInCircle",title:l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.integrations.settings.confirmInstallModal.installCalloutTitle",defaultMessage:"This action will install {numOfAssets} assets",values:{numOfAssets:i}})}),l.a.createElement(c.EuiSpacer,{size:"l"}),l.a.createElement("p",null,l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.integrations.settings.confirmInstallModal.installDescription",defaultMessage:"Kibana assets will be installed in the current Space (Default) and will only be accessible to users who have permission to view this Space. Elasticsearch assets are installed globally and will be accessible to all Kibana users."})))};function Ye(e){const{name:t,numOfAssets:a,title:i,version:r}=e,s=Object(f.p)().integrations.installPackages,o=Object(f.C)(),u=Object(f.x)(),{status:d}=u(t),m=d===de.b.installing,[g,p]=Object(n.useState)(!1),E=Object(n.useCallback)((()=>{p(!g)}),[g]),b=Object(n.useCallback)((()=>{o({name:t,version:r,title:i}),E()}),[o,t,i,E,r]),h=l.a.createElement(Ke,{numOfAssets:a,packageName:i,onCancel:E,onConfirm:b});return s?l.a.createElement(n.Fragment,null,l.a.createElement(c.EuiButton,{iconType:"importAction",isLoading:m,onClick:E},m?l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.integrations.installPackage.installingPackageButtonLabel",defaultMessage:"Installing {title} assets",values:{title:i}}):l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.integrations.installPackage.installPackageButtonLabel",defaultMessage:"Install {title} assets",values:{title:i}})),g&&h):null}function Xe(e){const{name:t,title:a,version:i}=e,r=Object(f.p)().integrations.installPackages,s=Object(f.C)(),o=Object(f.x)(),{status:u}=o(t),d=u===de.b.reinstalling,m=Object(n.useCallback)((()=>{s({name:t,version:i,title:a,isReinstall:!0})}),[s,t,a,i]);return r?l.a.createElement(n.Fragment,null,l.a.createElement(c.EuiButton,{iconType:"refresh",isLoading:d,onClick:m},d?l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.integrations.installPackage.reinstallingPackageButtonLabel",defaultMessage:"Reinstalling {title}",values:{title:a}}):l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.integrations.installPackage.reinstallPackageButtonLabel",defaultMessage:"Reinstall {title}",values:{title:a}}))):null}const Je=({dryRunData:e,isUpgradingPackagePolicies:t=!1,name:a,packagePolicyIds:i=[],setIsUpgradingPackagePolicies:r=(()=>{}),title:o,version:u,theme$:d})=>{const g=Object(s.useHistory)(),{getPath:p}=Object(f.E)(),{notifications:E}=Object(f.L)(),h=Object(f.p)().integrations.upgradePackages,v=Object(f.C)(),y=Object(f.x)(),{status:x}=y(a),j=x===de.b.installing,[O,F]=Object(n.useState)(!1),[I,C]=Object(n.useState)(!0),[P,w]=Object(n.useState)();Object(n.useEffect)((()=>{(async()=>{if(i&&i.length>0){const{data:e}=await Object(f.i)({perPage:b.j,page:1,kuery:`${b.a}.package_policies:${i.map((e=>`"${e}"`)).join(" or ")}`});w(e)}})()}),[i]);const S=Object(n.useMemo)((()=>i.length),[i]),T=Object(n.useMemo)((()=>null!=P&&P.items?P.items.reduce(((e,t)=>{var a;return e+((null!=t&&t.package_policies?(a=t.package_policies,Array.isArray(a)&&a.every((e=>"string"==typeof e))?t.package_policies.filter((e=>i.includes(e))):t.package_policies.filter((e=>i.includes(e.id)))):[]).length>0&&null!=t&&t.agents?null==t?void 0:t.agents:0)}),0):0),[P,i]),L=Object(n.useMemo)((()=>null==e?void 0:e.filter((e=>e.hasErrors)).length),[e]),_=Object(n.useCallback)((()=>{C((e=>!e))}),[]),A=Object(n.useCallback)((()=>{if(!g.location.pathname.match(p("integration_details_settings",{pkgkey:`${a}-.*`})))return;const e=p("integration_details_settings",{pkgkey:`${a}-${u}`});g.push(e)}),[g,p,a,u]),N=Object(n.useCallback)((async()=>{await v({name:a,version:u,title:o,fromUpdate:!0})}),[v,a,o,u]),z=Object(n.useCallback)((async()=>{t||(F(!1),r(!0),await v({name:a,version:u,title:o}),await Object(f.m)(i.filter((t=>{var a;return!(null!=e&&null!==(a=e.find((e=>{var a;return(null===(a=e.diff)||void 0===a?void 0:a[0].id)===t})))&&void 0!==a&&a.hasErrors)}))),r(!1),E.toasts.addSuccess({title:Object(m.toMountPoint)(l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.integrations.packageUpdateSuccessTitle",defaultMessage:"Updated {title} and upgraded policies",values:{title:o}}),{theme$:d}),text:Object(m.toMountPoint)(l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.integrations.packageUpdateSuccessDescription",defaultMessage:"Successfully updated {title} and upgraded policies",values:{title:o}}),{theme$:d})}),A())}),[e,v,t,a,A,E.toasts,i,r,o,u,d]),U=l.a.createElement(c.EuiConfirmModal,{isLoading:t,maxWidth:568,onCancel:()=>{F(!1)},cancelButtonText:M.i18n.translate("xpack.fleet.integrations.settings.confirmUpdateModal.cancel",{defaultMessage:"Cancel"}),onConfirm:z,confirmButtonText:M.i18n.translate("xpack.fleet.integrations.settings.confirmUpdateModal.confirm",{defaultMessage:"Upgrade {packageName} and policies",values:{packageName:o}}),title:M.i18n.translate("xpack.fleet.integrations.settings.confirmUpdateModal.updateTitle",{defaultMessage:"Upgrade {packageName} and policies",values:{packageName:o}})},l.a.createElement(l.a.Fragment,null,L&&L>0?l.a.createElement(l.a.Fragment,null,l.a.createElement(c.EuiCallOut,{color:"warning",iconType:"alert",title:M.i18n.translate("xpack.fleet.integrations.settings.confirmUpdateModal.conflictCallOut.title",{defaultMessage:"Some integration policies have conflicts"})},l.a.createElement("strong",null,l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.integrations.settings.confirmUpdateModal.conflictCallOut.integrationPolicyCount",defaultMessage:"{conflictCount, plural, one { # integration policy} other { # integration policies}}",values:{conflictCount:L}}))," ",l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.integrations.settings.confirmUpdateModal.conflictCallOut.body",defaultMessage:"{conflictCount, plural, one { has} other { have}} conflicts and will not be upgraded automatically. You can manually resolve these conflicts via agent policy settings in Fleet after performing this upgrade.",values:{conflictCount:L}})),l.a.createElement(c.EuiSpacer,{size:"l"})):null,l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.integrations.settings.confirmUpdateModal.body",defaultMessage:"This action will deploy updates to all agents which use these policies. Fleet has detected that {packagePolicyCountText} {packagePolicyCount, plural, one { is} other { are}} ready to be upgraded and {packagePolicyCount, plural, one { is} other { are}} already in use by {agentCountText}.",values:{packagePolicyCount:S,packagePolicyCountText:l.a.createElement("strong",null,l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.integrations.confirmUpdateModal.body.policyCount",defaultMessage:"{packagePolicyCount, plural, one {# integration policy} other {# integration policies}}",values:{packagePolicyCount:S}})),agentCountText:l.a.createElement("strong",null,l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.integrations.confirmUpdateModal.body.agentCount",defaultMessage:"{agentCount, plural, one {# agent} other {# agents}}",values:{agentCount:T}}))}})));return l.a.createElement(l.a.Fragment,null,l.a.createElement(c.EuiFlexGroup,{alignItems:"center"},l.a.createElement(c.EuiFlexItem,{grow:!1},l.a.createElement(c.EuiButton,{isLoading:j||t,onClick:I?()=>F(!0):N,"data-test-subj":"updatePackageBtn",isDisabled:!h},l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.integrations.updatePackage.updatePackageButtonLabel",defaultMessage:"Upgrade to latest version"}))),S>0&&l.a.createElement(c.EuiFlexItem,{grow:!1},l.a.createElement(c.EuiCheckbox,{compressed:!0,labelProps:{style:{display:"flex"}},id:"upgradePoliciesCheckbox",disabled:!h,checked:I,onChange:_,label:M.i18n.translate("xpack.fleet.integrations.updatePackage.upgradePoliciesCheckboxLabel",{defaultMessage:"Upgrade integration policies"})}))),O&&U)},Qe=e=>{const{onCancel:t,onConfirm:a,packageName:n,numOfAssets:i}=e;return l.a.createElement(c.EuiConfirmModal,{title:l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.integrations.settings.confirmUninstallModal.uninstallTitle",defaultMessage:"Uninstall {packageName}",values:{packageName:n}}),onCancel:t,onConfirm:a,cancelButtonText:l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.integrations.settings.confirmUninstallModal.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.integrations.settings.confirmUninstallModal.uninstallButtonLabel",defaultMessage:"Uninstall {packageName}",values:{packageName:n}}),defaultFocusedButton:"confirm",buttonColor:"danger"},l.a.createElement(c.EuiCallOut,{color:"danger",title:l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.integrations.settings.confirmUninstallModal.uninstallCallout.title",defaultMessage:"This action will remove {numOfAssets} assets",values:{numOfAssets:i}})},l.a.createElement("p",null,l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.integrations.settings.confirmUninstallModal.uninstallCallout.description",defaultMessage:"Kibana and Elasticsearch assets that were created by this integration will be removed. Agents policies and any data sent by your agents will not be effected."}))),l.a.createElement(c.EuiSpacer,{size:"l"}),l.a.createElement("p",null,l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.integrations.settings.confirmUninstallModal.uninstallDescription",defaultMessage:"This action cannot be undone. Are you sure you wish to continue?"})))},Ze=({disabled:e=!1,latestVersion:t,name:a,numOfAssets:i,title:r,version:s})=>{const o=Object(f.p)().integrations.removePackages,u=Object(f.N)(),d=Object(f.x)(),{status:m}=d(a),g=m===de.b.uninstalling,[p,E]=Object(n.useState)(!1),b=Object(n.useCallback)((()=>{u({name:a,version:s,title:r,redirectToVersion:null!=t?t:s}),E(!1)}),[u,a,r,s,t]),h=l.a.createElement(Qe,{numOfAssets:i,packageName:r,onCancel:()=>E(!1),onConfirm:b});return o?l.a.createElement(l.a.Fragment,null,l.a.createElement(c.EuiButton,{iconType:"trash",isLoading:g,onClick:()=>E(!0),color:"danger",disabled:!(!e&&!g)},g?l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.integrations.uninstallPackage.uninstallingPackageButtonLabel",defaultMessage:"Uninstalling {title}",values:{title:r}}):l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.integrations.uninstallPackage.uninstallPackageButtonLabel",defaultMessage:"Uninstall {title}",values:{title:r}})),p&&h):null},et=I.a.td.withConfig({displayName:"SettingsTitleCell",componentId:"sc-1lbna4d-0"})(["padding-right:",";padding-bottom:",";"],(e=>e.theme.eui.euiSizeXL),(e=>e.theme.eui.euiSizeM)),tt=()=>l.a.createElement("strong",null,l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.integrations.settings.packageUninstallNoteDescription.packageUninstallNoteLabel",defaultMessage:"Note:"})),at=({latestVersion:e})=>l.a.createElement(c.EuiCallOut,{color:"warning",iconType:"alert",title:M.i18n.translate("xpack.fleet.integrations.settings.versionInfo.updatesAvailable",{defaultMessage:"New version available"})},l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.integration.settings.versionInfo.updatesAvailableBody",defaultMessage:"Upgrade to version {latestVersion} to get the latest features",values:{latestVersion:e}})),nt=({name:e,version:t})=>{const{getHref:a}=Object(f.E)(),n=a("integration_details_settings",{pkgkey:`${e}-${t}`});return l.a.createElement(c.EuiLink,{href:n},l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.integrations.settings.packageLatestVersionLink",defaultMessage:"latest version"}))},lt=Object(n.memo)((({packageInfo:e,theme$:t})=>{const{name:a,title:i,latestVersion:r,version:s,keepPoliciesUpToDate:o}=e,[u,d]=Object(n.useState)(),[m,g]=Object(n.useState)(!1),p=Object(f.x)(),{data:E}=Object(f.y)({perPage:b.j,page:1,kuery:`${b.h}.package.name:${a}`}),{notifications:h}=Object(f.L)(),v=Object(n.useMemo)((()=>b.g.some((e=>e.name===a))),[a]),y=Object(n.useMemo)((()=>b.b.some((e=>e.name===a))),[a]),[j,O]=Object(n.useState)(null!=o&&o),F=Object(n.useCallback)((()=>{(async()=>{try{O((e=>!e)),await Object(f.l)(e.name,e.version,{keepPoliciesUpToDate:!j}),h.toasts.addSuccess({title:M.i18n.translate("xpack.fleet.integrations.integrationSaved",{defaultMessage:"Integration settings saved"}),text:j?M.i18n.translate("xpack.fleet.integrations.keepPoliciesUpToDateDisabledSuccess",{defaultMessage:"Fleet will not automatically keep integration policies up to date for {title}",values:{title:i}}):M.i18n.translate("xpack.fleet.integrations.keepPoliciesUpToDateEnabledSuccess",{defaultMessage:"Fleet will automatically keep integration policies up to date for {title}",values:{title:i}})})}catch(e){h.toasts.addError(e,{title:M.i18n.translate("xpack.fleet.integrations.integrationSavedError",{defaultMessage:"Error saving integration settings"}),toastMessage:M.i18n.translate("xpack.fleet.integrations.keepPoliciesUpToDateError",{defaultMessage:"Error saving integration settings for {title}",values:{title:i}})})}})()}),[j,h.toasts,e.name,e.version,i]),{status:I,version:C}=p(a),P=!(null==E||!E.total),w=Object(n.useMemo)((()=>null==E?void 0:E.items.map((({id:e})=>e))),[E]);Object(n.useEffect)((()=>{(async()=>{if(w&&w.length){const{data:e}=await Object(f.n)(w,r);d(e)}})()}),[r,w]);const S=!(!C||!x()(C,r)),T=s<r,L=I===de.b.notInstalled&&T||I===de.b.installed&&C!==s,_=I===de.b.installing&&C,A=Object(n.useMemo)((()=>Object.entries(e.assets).reduce(((e,[t,a])=>e+Object.entries(a).reduce(((e,[t,a])=>e+a.length),0)),0)),[e.assets]);return l.a.createElement(c.EuiFlexGroup,{alignItems:"flexStart"},l.a.createElement(c.EuiFlexItem,{grow:1}),l.a.createElement(c.EuiFlexItem,{grow:6},l.a.createElement(c.EuiText,null,l.a.createElement(c.EuiTitle,null,l.a.createElement("h3",null,l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.integrations.settings.packageSettingsTitle",defaultMessage:"Settings"}))),l.a.createElement(c.EuiSpacer,{size:"s"}),null!==C&&l.a.createElement("div",null,l.a.createElement(c.EuiTitle,null,l.a.createElement("h4",null,l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.integrations.settings.packageVersionTitle",defaultMessage:"{title} version",values:{title:i}}))),l.a.createElement(c.EuiSpacer,{size:"s"}),l.a.createElement("table",null,l.a.createElement("tbody",null,l.a.createElement("tr",null,l.a.createElement(et,null,l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.integrations.settings.versionInfo.installedVersion",defaultMessage:"Installed version"})),l.a.createElement("td",null,l.a.createElement(c.EuiTitle,{size:"xs","data-test-subj":"installedVersion"},l.a.createElement("span",null,C)))),l.a.createElement("tr",null,l.a.createElement(et,null,l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.integrations.settings.versionInfo.latestVersion",defaultMessage:"Latest version"})),l.a.createElement("td",null,l.a.createElement(c.EuiTitle,{size:"xs","data-test-subj":"latestVersion"},l.a.createElement("span",null,r)))))),v&&l.a.createElement(l.a.Fragment,null,l.a.createElement(ke,{checked:j,onChange:F,disabled:y}),l.a.createElement(c.EuiSpacer,{size:"l"})),(S||m)&&l.a.createElement(l.a.Fragment,null,l.a.createElement(at,{latestVersion:r}),l.a.createElement(c.EuiSpacer,{size:"l"}),l.a.createElement("p",null,l.a.createElement(Je,Ge()({},e,{version:r,packagePolicyIds:w,dryRunData:u,isUpgradingPackagePolicies:m,setIsUpgradingPackagePolicies:g,theme$:t}))))),!L&&!_&&l.a.createElement("div",null,l.a.createElement(c.EuiSpacer,{size:"s"}),I===de.b.notInstalled||I===de.b.installing?l.a.createElement("div",null,l.a.createElement(c.EuiTitle,null,l.a.createElement("h4",null,l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.integrations.settings.packageInstallTitle",defaultMessage:"Install {title}",values:{title:i}}))),l.a.createElement(c.EuiSpacer,{size:"s"}),l.a.createElement("p",null,l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.integrations.settings.packageInstallDescription",defaultMessage:"Install this integration to setup Kibana and Elasticsearch assets designed for {title} data.",values:{title:i}})),l.a.createElement(c.EuiFlexGroup,null,l.a.createElement(c.EuiFlexItem,{grow:!1},l.a.createElement("p",null,l.a.createElement(Ye,Ge()({},e,{numOfAssets:A,disabled:!E||P})))))):l.a.createElement(l.a.Fragment,null,l.a.createElement(c.EuiFlexGroup,{direction:"column",gutterSize:"m"},l.a.createElement(c.EuiFlexItem,null,l.a.createElement(c.EuiTitle,null,l.a.createElement("h4",null,l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.integrations.settings.packageUninstallTitle",defaultMessage:"Uninstall"})))),l.a.createElement(c.EuiFlexItem,null,l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.integrations.settings.packageUninstallDescription",defaultMessage:"Remove Kibana and Elasticsearch assets that were installed by this integration."})),l.a.createElement(c.EuiFlexItem,null,l.a.createElement("div",null,l.a.createElement(Ze,Ge()({},e,{numOfAssets:A,latestVersion:r,disabled:!E||P})))),P&&l.a.createElement(c.EuiFlexItem,null,l.a.createElement(c.EuiText,{color:"subdued",size:"s"},l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.integrations.settings.packageUninstallNoteDescription.packageUninstallNoteDetail",defaultMessage:"{strongNote} {title} cannot be uninstalled because there are active agents that use this integration. To uninstall, remove all {title} integrations from your agent policies.",values:{title:i,strongNote:l.a.createElement(tt,null)}})))),l.a.createElement(c.EuiSpacer,{size:"l"}),l.a.createElement(c.EuiFlexGroup,{direction:"column",gutterSize:"m"},l.a.createElement(c.EuiFlexItem,null,l.a.createElement(c.EuiTitle,null,l.a.createElement("h4",null,l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.integrations.settings.packageReinstallTitle",defaultMessage:"Reinstall"})))),l.a.createElement(c.EuiFlexItem,null,l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.integrations.settings.packageReinstallDescription",defaultMessage:"Reinstall Kibana and Elasticsearch assets for this integration."})),l.a.createElement(c.EuiFlexItem,{grow:!1},l.a.createElement("div",null,l.a.createElement(Xe,e)))))),L&&T&&!_&&l.a.createElement("div",null,l.a.createElement(c.EuiSpacer,{size:"s"}),l.a.createElement("div",null,l.a.createElement(c.EuiTitle,null,l.a.createElement("h4",null,l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.integrations.settings.packageInstallTitle",defaultMessage:"Install {title}",values:{title:i}}))),l.a.createElement(c.EuiSpacer,{size:"s"}),l.a.createElement("p",null,l.a.createElement(c.EuiText,{color:"subdued"},l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.integrations.settings.packageSettingsOldVersionMessage",defaultMessage:"Version {version} is out of date. The {latestVersion} of this integration is available to be installed.",values:{version:s,latestVersion:l.a.createElement(nt,{name:a,version:r})}}))))))))})),it=Object(n.memo)((({packageInfo:e})=>{const t=Object(f.M)(e.name,"package-detail-custom"),{getPath:a}=Object(f.E)(),i=Object(n.useMemo)((()=>Object(K.v)(e)),[e]);return t?l.a.createElement(c.EuiFlexGroup,{alignItems:"flexStart"},l.a.createElement(c.EuiFlexItem,{grow:1}),l.a.createElement(c.EuiFlexItem,{grow:6},l.a.createElement(O.i,null,l.a.createElement(t.Component,{pkgkey:i,packageInfo:e})))):l.a.createElement(s.Redirect,{to:a("integration_details_overview",{pkgkey:i})})}));a(283);const rt=I.a.div.withConfig({displayName:"Divider",componentId:"sc-1xcdwih-0"})(["width:0;height:100%;border-left:",";"],(e=>e.theme.eui.euiBorderThin)),st=I()(c.EuiFlexItem).withConfig({displayName:"FlexItemWithMinWidth",componentId:"sc-1xcdwih-1"})(["min-width:0px;"]),ot=I()(c.EuiFlexItem).withConfig({displayName:"FlexItemWithMaxHeight",componentId:"sc-1xcdwih-2"})(["@media (min-width:768px){max-height:60px;}"]);function ct({packageTitle:e}){return Object(f.q)("integration_details_overview",{pkgTitle:e}),null}function ut(){var e,t,a,i,r,o;const{getId:u}=Object(f.o)(),{getFromIntegrations:d}=Object(f.D)(),{pkgkey:m,panel:g}=Object(s.useParams)(),{getHref:p}=Object(f.E)(),E=Object(f.p)().integrations.installPackages,v=Object(f.p)().integrations.readPackageSettings,y=Object(f.p)().integrations.readIntegrationPolicies,j=Object(f.J)(),F=!(null!==(e=j.data)&&void 0!==e&&e.success)&&"MISSING_SECURITY"===(null===(t=j.data)||void 0===t?void 0:t.error),I=E&&(null===(a=j.data)||void 0===a?void 0:a.success),C=Object(s.useHistory)(),{pathname:P,search:w,hash:S}=Object(s.useLocation)(),L=Object(n.useMemo)((()=>new URLSearchParams(w)),[w]),_=Object(n.useMemo)((()=>L.get("integration")),[L]),A=Object(f.L)(),N=!(null==A||null===(i=A.cloud)||void 0===i||!i.cloudId),{createPackagePolicyMultiPageLayout:z}=K.b.get(),U=u(),[B,R]=Object(n.useState)(null),D=Object(f.K)(),$=Object(f.x)(),G=Object(f.M)(null!==(r=null==B?void 0:B.name)&&void 0!==r?r:"","package-detail-assets"),H=Object(n.useMemo)((()=>{if(null!==B&&B.name)return $(B.name).status}),[B,$]),V=Object(n.useMemo)((()=>H===de.b.installed||H===de.b.reinstalling),[H]),q=B&&"savedObject"in B&&B.savedObject&&x()(B.savedObject.attributes.version,B.latestVersion),{pkgName:W,pkgVersion:Y}=Object(ue.splitPkgKey)(m),{data:X,error:J,isLoading:Q,isInitialRequest:Z,resendRequest:ee}=Object(f.w)(W,Y),{isFirstTimeAgentUser:te=!1,isLoading:ae}=(()=>{const[e,t]=Object(n.useState)({isLoading:!0});return Object(n.useEffect)((()=>{e.isLoading&&(async()=>{const{data:e}=await Object(f.i)({full:!0}),a=((null==e?void 0:e.items)||[]).filter((e=>Object(K.w)(e))).map((e=>`policy_id:${e.id}`)).join(" or "),n='not (_exists_:"unenrolled_at")'+(a.length?` and not (${a})`:""),{data:l}=await Object(f.j)({page:1,perPage:1,showInactive:!0,kuery:n});t({isLoading:!1,isFirstTimeAgentUser:0===(null==l?void 0:l.total)})})()}),[e]),e})(),[ne,le]=Object(n.useState)(H);Object(n.useEffect)((()=>{"not_installed"===H&&le(H),"not_installed"===ne&&"installed"===H&&(le(H),ee())}),[H,ne,ee]);const ie=Q&&!Z||j.isLoading||ae,re=void 0!==Object(f.M)(null!==(o=null==X?void 0:X.item.name)&&void 0!==o?o:"","package-detail-custom");Object(n.useEffect)((()=>{if(null!=X&&X.item){const e=X.item;let t;R(e);const{name:a}=X.item;"savedObject"in e&&(t=e.savedObject.attributes.version);const n=null==e?void 0:e.status;a&&D({name:a,status:n,version:t||null})}}),[X,D,R]);const se=Object(n.useMemo)((()=>{var e;return _?null==B||null===(e=B.policy_templates)||void 0===e?void 0:e.find((e=>e.name===_)):void 0}),[_,B]),oe=d(),ce=p("updates_available"===oe?"integrations_installed_updates_available":"installed"===oe?"integrations_installed":"integrations_all"),fe=Object(n.useMemo)((()=>l.a.createElement(c.EuiFlexGroup,{direction:"column",gutterSize:"m"},l.a.createElement(c.EuiFlexItem,null,l.a.createElement("div",null,l.a.createElement(c.EuiButtonEmpty,{iconType:"arrowLeft",size:"xs",flush:"left",href:ce},l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.epm.browseAllButtonText",defaultMessage:"Back to integrations"})))),l.a.createElement(c.EuiFlexItem,null,l.a.createElement(c.EuiFlexGroup,{gutterSize:"l"},l.a.createElement(ot,{grow:!1},ie||!B?l.a.createElement(he,null):l.a.createElement(be,{packageName:B.name,integrationName:null==se?void 0:se.name,version:B.version,icons:(null==se?void 0:se.icons)||B.icons})),l.a.createElement(st,{grow:!0},l.a.createElement(c.EuiFlexGroup,{direction:"column",justifyContent:"flexStart",gutterSize:"xs"},l.a.createElement(c.EuiFlexItem,{grow:!1},l.a.createElement(c.EuiText,null,l.a.createElement("h1",null,(null==se?void 0:se.title)||(null==B?void 0:B.title)||"Â "))),l.a.createElement(c.EuiFlexItem,null,l.a.createElement(c.EuiFlexGroup,{gutterSize:"xs"},l.a.createElement(c.EuiFlexItem,{grow:!1},l.a.createElement(c.EuiBadge,{color:"default"},M.i18n.translate("xpack.fleet.epm.elasticAgentBadgeLabel",{defaultMessage:"Elastic Agent"}))),null!=B&&B.release&&"ga"!==B.release?l.a.createElement(c.EuiFlexItem,{grow:!1},l.a.createElement(T,{release:B.release})):null)))))))),[se,ie,B,ce]),ke=Object(n.useCallback)((e=>{e.preventDefault();const t=C.createHref({pathname:P,search:w,hash:S}),a=(({currentPath:e,integration:t,agentPolicyId:a,pkgkey:n,isFirstTimeAgentUser:l,isCloud:i,isExperimentalAddIntegrationPageEnabled:r})=>{const s=t?{integration:t}:{},o=(e=>me.some((t=>e.startsWith(t))))(n),c=r&&i&&l&&!o,u=b.k.add_integration_to_policy({pkgkey:n,useMultiPageLayout:c,...s,...a?{agentPolicyId:a}:{}})[1];let d,m;a?(d=[b.i,{path:b.k.policy_details({policyId:a})[1]}],m={showAddAgentHelp:!0,openEnrollmentFlyout:!0}):(d=[b.d,{path:b.k.integration_details_policies({pkgkey:n,...s})[1]}],m={showAddAgentHelp:{renameKey:"showAddAgentHelpForPolicyId",policyIdAsValue:!0},openEnrollmentFlyout:{renameKey:"addAgentToPolicyId",policyIdAsValue:!0}});const g={onSaveNavigateTo:d,onSaveQueryParams:m,onCancelNavigateTo:[b.d,{path:b.k.integration_details_overview({pkgkey:n,...s})[1]}],onCancelUrl:e};return[b.i,{path:u,state:g}]})({agentPolicyId:U,currentPath:t,integration:_,isCloud:N,isExperimentalAddIntegrationPageEnabled:z,isFirstTimeAgentUser:te,pkgkey:m});A.application.navigateToApp(...a)}),[U,S,C,_,N,z,te,P,m,w,A.application]),ve=Object(n.useMemo)((()=>B?l.a.createElement(l.a.Fragment,null,l.a.createElement(c.EuiSpacer,{size:"l"}),l.a.createElement(c.EuiFlexGroup,{justifyContent:"flexEnd",direction:"row"},[{label:M.i18n.translate("xpack.fleet.epm.versionLabel",{defaultMessage:"Version"}),content:l.a.createElement(c.EuiFlexGroup,{gutterSize:"s"},l.a.createElement(c.EuiFlexItem,null,B.version),q?l.a.createElement(c.EuiFlexItem,{grow:!1},l.a.createElement(pe,null)):null)},...V?[{isDivider:!0},{label:M.i18n.translate("xpack.fleet.epm.usedByLabel",{defaultMessage:"Agent policies"}),"data-test-subj":"agentPolicyCount",content:l.a.createElement(Ee,{packageName:B.name})}]:[],{isDivider:!0},{content:l.a.createElement(ge,{userCanInstallPackages:I,href:p("add_integration_to_policy",{pkgkey:m,..._?{integration:_}:{},...U?{agentPolicyId:U}:{}}),missingSecurityConfiguration:F,packageName:(null==se?void 0:se.title)||B.title,onClick:ke})}].map(((e,t)=>{var a;return l.a.createElement(c.EuiFlexItem,{grow:!1,key:t,"data-test-subj":e["data-test-subj"]},null!==(a=e.isDivider)&&void 0!==a&&a?l.a.createElement(rt,null):e.label?l.a.createElement(c.EuiDescriptionList,{className:"eui-textRight",compressed:!0,textStyle:"reverse"},l.a.createElement(c.EuiDescriptionListTitle,null,e.label),l.a.createElement(c.EuiDescriptionListDescription,null,e.content)):e.content)})))):void 0),[B,q,V,I,p,m,_,U,F,null==se?void 0:se.title,ke]),ye=Object(n.useMemo)((()=>{if(!B)return[];const e=Object(K.v)(B),t=[{id:"overview",name:l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.epm.packageDetailsNav.overviewLinkText",defaultMessage:"Overview"}),isSelected:"overview"===g,"data-test-subj":"tab-overview",href:p("integration_details_overview",{pkgkey:e,..._?{integration:_}:{}})}];return y&&V&&t.push({id:"policies",name:l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.epm.packageDetailsNav.packagePoliciesLinkText",defaultMessage:"Integration policies"}),isSelected:"policies"===g,"data-test-subj":"tab-policies",href:p("integration_details_policies",{pkgkey:e,..._?{integration:_}:{}})}),V&&(B.assets||G)&&t.push({id:"assets",name:l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.epm.packageDetailsNav.packageAssetsLinkText",defaultMessage:"Assets"}),isSelected:"assets"===g,"data-test-subj":"tab-assets",href:p("integration_details_assets",{pkgkey:e,..._?{integration:_}:{}})}),v&&t.push({id:"settings",name:l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.epm.packageDetailsNav.settingsLinkText",defaultMessage:"Settings"}),isSelected:"settings"===g,"data-test-subj":"tab-settings",href:p("integration_details_settings",{pkgkey:e,..._?{integration:_}:{}})}),v&&re&&t.push({id:"custom",name:l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.epm.packageDetailsNav.packageCustomLinkText",defaultMessage:"Advanced"}),isSelected:"custom"===g,"data-test-subj":"tab-custom",href:p("integration_details_custom",{pkgkey:e,..._?{integration:_}:{}})}),t}),[B,g,p,_,y,V,G,v,re]),xe=F?l.a.createElement(l.a.Fragment,null,l.a.createElement(c.EuiCallOut,{color:"warning",iconType:"lock",title:l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.epm.packageDetailsSecurityRequiredCalloutTitle",defaultMessage:"Security needs to be enabled in order to add Elastic Agent integrations"})},l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.epm.packageDetailsSecurityRequiredCalloutDescription",defaultMessage:"In order to fully use Fleet, you must enable Elasticsearch and Kibana security features. Follow the {guideLink} to enable security.",values:{guideLink:l.a.createElement("a",{href:A.http.basePath.prepend("/app/fleet")},l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.epm.packageDetailsSecurityRequiredCalloutDescriptionGuideLink",defaultMessage:"steps in this guide"}))}})),l.a.createElement(c.EuiSpacer,null)):void 0;return l.a.createElement(h.a,{leftColumn:fe,rightColumn:ve,rightColumnGrow:!1,topContent:xe,tabs:ye,tabsClassName:"fleet__epm__shiftNavTabs"},se||B?l.a.createElement(ct,{packageTitle:(null==se?void 0:se.title)||(null==B?void 0:B.title)||""}):null,J?l.a.createElement(O.g,{title:l.a.createElement(k.FormattedMessage,{id:"xpack.fleet.epm.loadingIntegrationErrorTitle",defaultMessage:"Error loading integration details"}),error:J}):ie||!B?l.a.createElement(O.m,null):l.a.createElement(s.Switch,null,l.a.createElement(s.Route,{path:b.e.integration_details_overview},l.a.createElement(ze,{packageInfo:B,integrationInfo:se})),l.a.createElement(s.Route,{path:b.e.integration_details_settings},l.a.createElement(lt,{packageInfo:B,theme$:A.theme.theme$})),l.a.createElement(s.Route,{path:b.e.integration_details_assets},l.a.createElement(je,{packageInfo:B})),l.a.createElement(s.Route,{path:b.e.integration_details_policies},l.a.createElement(We,{name:B.name,version:B.version})),l.a.createElement(s.Route,{path:b.e.integration_details_custom},l.a.createElement(it,{packageInfo:B})),l.a.createElement(s.Redirect,{to:b.e.integration_details_overview})))}var dt=a(127);const mt=Object(n.memo)((()=>{var e,t,a,n;const{params:{packagePolicyId:i}}=Object(s.useRouteMatch)(),r=Object(f.v)(i),o=Object(f.M)(null!==(e=null===(t=r.data)||void 0===t||null===(a=t.item)||void 0===a||null===(n=a.package)||void 0===n?void 0:n.name)&&void 0!==e?e:"","package-policy-edit");return l.a.createElement(dt.a,{packagePolicyId:i,from:"package-edit",forceUpgrade:null==o?void 0:o.useLatestPackageVersion})})),gt=()=>(Object(f.q)("integrations"),l.a.createElement(s.Switch,null,l.a.createElement(s.Route,{path:b.e.integration_policy_edit},l.a.createElement(mt,null)),l.a.createElement(s.Route,{path:b.e.integration_details},l.a.createElement(f.d,null,l.a.createElement(ut,null))),l.a.createElement(s.Route,{path:b.e.integrations},l.a.createElement(ce,null))));var pt,Et=(pt=function(e,t){return pt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])},pt(e,t)},function(e,t){function a(){this.constructor=e}pt(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}),ft=function(e){function t(t){var a=e.call(this,t)||this;return a.addPropsChannel=function(){Object.assign(a.props.node,{setPortalProps:function(e){a.setState({nodeProps:e})}})},a.state={nodeProps:a.props.node.getInitialPortalProps()},a}return Et(t,e),t.prototype.componentDidMount=function(){this.addPropsChannel()},t.prototype.componentDidUpdate=function(){this.addPropsChannel()},t.prototype.render=function(){var e=this,t=this.props,a=t.children,l=t.node;return i.createPortal(n.Children.map(a,(function(t){return n.isValidElement(t)?n.cloneElement(t,e.state.nodeProps):t})),l)},t}(n.PureComponent),bt=function(e){function t(t){var a=e.call(this,t)||this;return a.placeholderNode=n.createRef(),a.passPropsThroughPortal(),a}return Et(t,e),t.prototype.passPropsThroughPortal=function(){var e=Object.assign({},this.props,{node:void 0});this.props.node.setPortalProps(e)},t.prototype.componentDidMount=function(){var e=this.props.node,t=this.placeholderNode.current,a=t.parentNode;e.mount(a,t),this.passPropsThroughPortal()},t.prototype.componentDidUpdate=function(){var e=this.props.node,t=this.placeholderNode.current,a=t.parentNode;e.mount(a,t),this.passPropsThroughPortal()},t.prototype.componentWillUnmount=function(){this.props.node.unmount(this.placeholderNode.current)},t.prototype.render=function(){return n.createElement("div",{ref:this.placeholderNode})},t}(n.PureComponent);const ht=({children:e,setHeaderActionMenu:t,theme$:a})=>{const i=Object(n.useMemo)((()=>function(){var e,t,a={},n=Object.assign(document.createElement("div"),{setPortalProps:function(e){a=e},getInitialPortalProps:function(){return a},mount:function(a,l){l!==t&&(n.unmount(),a.replaceChild(n,l),e=a,t=l)},unmount:function(a){a&&a!==t||e&&t&&(e.replaceChild(t,n),e=void 0,t=void 0)}});return n}()),[]);return Object(n.useEffect)((()=>(t((e=>Object(m.toMountPoint)(l.a.createElement(bt,{node:i}),{theme$:a})(e))),()=>{i.unmount(),t(void 0)})),[i,t,a]),l.a.createElement(ft,{node:i},e)},kt=I()(c.EuiText).withConfig({displayName:"Description",componentId:"sc-kml9g-0"})(["margin-bottom:",";"],(({theme:e})=>e.eui.euiSizeL)),vt=({cloudId:e,learnMoreUrl:t,managementUrl:a})=>{const[n,i]=l.a.useState(!1),r=l.a.createElement(c.EuiHeaderLink,{onClick:()=>i(!n),iconType:"iInCircle",iconSide:"left",isActive:!0},M.i18n.translate("xpack.fleet.integrations.deploymentButton",{defaultMessage:"View deployment details"})),s=a?l.a.createElement(c.EuiFormRow,{label:"API keys",fullWidth:!0},l.a.createElement(c.EuiFlexGroup,{gutterSize:"m",alignItems:"center"},l.a.createElement(c.EuiFlexItem,null,l.a.createElement(c.EuiButton,{href:a},"Create and manage API keys")),l.a.createElement(c.EuiFlexItem,null,l.a.createElement(c.EuiLink,{external:!0,href:t,target:"_blank"},"Learn more")))):null;return l.a.createElement(c.EuiPopover,{isOpen:n,closePopover:()=>i(!1),button:r,anchorPosition:"downCenter"},l.a.createElement("div",{style:{width:450}},l.a.createElement(kt,null,"Send data to Elastic from your applications by referencing your deployment and Elasticsearch information."),l.a.createElement(c.EuiForm,{component:"div"},l.a.createElement(c.EuiFormRow,{label:"Cloud ID",fullWidth:!0},l.a.createElement(c.EuiFlexGroup,{gutterSize:"s"},l.a.createElement(c.EuiFlexItem,null,l.a.createElement(c.EuiFieldText,{value:e,fullWidth:!0,disabled:!0})),l.a.createElement(c.EuiFlexItem,{grow:!1},l.a.createElement(c.EuiCopy,{textToCopy:e},(e=>l.a.createElement(c.EuiButtonIcon,{onClick:e,iconType:"copyClipboard",display:"base",size:"m"})))))),s)))},yt=()=>{var e;const{share:t,cloud:a,docLinks:n}=Object(f.L)();if(!a)return null;const{isCloudEnabled:i,cloudId:r}=a;if(!i||!r)return null;const s=null===(e=t.url.locators.get("MANAGEMENT_APP_LOCATOR"))||void 0===e?void 0:e.useUrl({sectionId:"security",appId:"api_keys"}),o=n.links.fleet.apiKeysLearnMore;return l.a.createElement(vt,{cloudId:r,managementUrl:s,learnMoreUrl:o})},xt=({setHeaderActionMenu:e,theme$:t})=>l.a.createElement(ht,{setHeaderActionMenu:e,theme$:t},l.a.createElement(c.EuiHeaderSection,{grow:!1},l.a.createElement(c.EuiHeaderSectionItem,null,l.a.createElement(c.EuiHeaderLinks,null,l.a.createElement(yt,null))))),Mt=()=>l.a.createElement(l.a.Fragment,null),jt=Object(n.memo)((({children:e,startServices:t,config:a,history:n,kibanaVersion:i,extensions:r,setHeaderActionMenu:u,theme$:E})=>{var b;const h=d()(t.uiSettings.get$("theme:darkMode")),k=(null===(b=t.cloud)||void 0===b?void 0:b.CloudContextProvider)||Mt;return l.a.createElement(m.RedirectAppLinks,{application:t.application},l.a.createElement(t.i18n.Context,null,l.a.createElement(m.KibanaContextProvider,{services:{...t}},l.a.createElement(c.EuiErrorBoundary,null,l.a.createElement(o.b.Provider,{value:a},l.a.createElement(o.e.Provider,{value:i},l.a.createElement(m.KibanaThemeProvider,{theme$:E},l.a.createElement(g.EuiThemeProvider,{darkMode:h},l.a.createElement(f.f.Provider,{value:r},l.a.createElement(o.c,null,l.a.createElement(t.customIntegrations.ContextProvider,null,l.a.createElement(k,null,l.a.createElement(s.Router,{history:n},l.a.createElement(f.a,null,l.a.createElement(f.e,{notifications:t.notifications,theme$:E},l.a.createElement(f.c,null,l.a.createElement(xt,{setHeaderActionMenu:u,theme$:E}),e,l.a.createElement(p.Chat,null)))))))))))))))))})),Ot=Object(n.memo)((()=>{var e;const t=Object(f.s)(),a=Object(o.jb)();return l.a.createElement(l.a.Fragment,null,l.a.createElement(s.Switch,null,l.a.createElement(s.Route,{path:b.e.integrations},l.a.createElement(gt,null)),l.a.createElement(s.Route,{render:({location:e})=>{if(!(""===e.pathname&&e.hash.length>0))return l.a.createElement(s.Redirect,{to:b.k.integrations_all({})[1]});const t=e.hash.replace(/^#/,"");return l.a.createElement(s.Redirect,{to:{...e,pathname:t,hash:void 0}})}})),t.isEnrollmentFlyoutOpen&&l.a.createElement(c.EuiPortal,null,l.a.createElement(O.b,{defaultMode:a.isReady&&null!==(e=a.missingRequirements)&&void 0!==e&&e.includes("fleet_server")?"managed":"standalone",isIntegrationFlow:!0,onClose:()=>t.closeEnrollmentFlyout()})),t.isFleetServerFlyoutOpen&&l.a.createElement(c.EuiPortal,null,l.a.createElement(E.j,{onClose:()=>t.closeFleetServerFlyout()})))})),Ft=({isAllowed:e=!1,restrictedPath:t="/",...a})=>e?l.a.createElement(s.Route,a):l.a.createElement(s.Redirect,{to:{pathname:t}}),It=({basepath:e,startServices:t,config:a,history:n,kibanaVersion:i,extensions:r,setHeaderActionMenu:s,theme$:o})=>l.a.createElement(jt,{basepath:e,startServices:t,config:a,history:n,kibanaVersion:i,extensions:r,setHeaderActionMenu:s,theme$:o},l.a.createElement(Ot,null));function Ct(e,{element:t,appBasePath:a,history:n,setHeaderActionMenu:i,theme$:s},o,c,u,d){return r.a.render(l.a.createElement(d,null,l.a.createElement(It,{basepath:a,startServices:e,config:o,history:n,kibanaVersion:c,extensions:u,setHeaderActionMenu:i,theme$:s})),t),()=>{r.a.unmountComponentAtNode(t)}}const Pt=e=>{e.chrome.docTitle.reset(),e.chrome.setBreadcrumbs([]),o.i.stop()}}}]);