/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.ml_bundle_jsonpfunction=window.ml_bundle_jsonpfunction||[]).push([[12],{682:function(e,t,a){var n,o=o||function(e){"use strict";if("undefined"==typeof navigator||!/MSIE [1-9]\./.test(navigator.userAgent)){var t=e.document,a=function(){return e.URL||e.webkitURL||e},n=t.createElementNS("http://www.w3.org/1999/xhtml","a"),o="download"in n,s=e.webkitRequestFileSystem,i=e.requestFileSystem||s||e.mozRequestFileSystem,l=function(t){(e.setImmediate||e.setTimeout)((function(){throw t}),0)},r="application/octet-stream",c=0,d=function(t){var n=function(){"string"==typeof t?a().revokeObjectURL(t):t.remove()};e.chrome?n():setTimeout(n,500)},b=function(e,t,a){for(var n=(t=[].concat(t)).length;n--;){var o=e["on"+t[n]];if("function"==typeof o)try{o.call(e,a||e)}catch(e){l(e)}}},u=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e},j=function(t,l,j){j||(t=u(t));var m,p,x,g=this,f=t.type,h=!1,O=function(){b(g,"writestart progress write writeend".split(" "))},y=function(){!h&&m||(m=a().createObjectURL(t)),p?p.location.href=m:null==e.open(m,"_blank")&&"undefined"!=typeof safari&&(e.location.href=m),g.readyState=g.DONE,O(),d(m)},M=function(e){return function(){if(g.readyState!==g.DONE)return e.apply(this,arguments)}},E={create:!0,exclusive:!1};if(g.readyState=g.INIT,l||(l="download"),o)return m=a().createObjectURL(t),n.href=m,n.download=l,void setTimeout((function(){var e,t;e=n,t=new MouseEvent("click"),e.dispatchEvent(t),O(),d(m),g.readyState=g.DONE}));e.chrome&&f&&f!==r&&(x=t.slice||t.webkitSlice,t=x.call(t,0,t.size,r),h=!0),s&&"download"!==l&&(l+=".download"),(f===r||s)&&(p=e),i?(c+=t.size,i(e.TEMPORARY,c,M((function(e){e.root.getDirectory("saved",E,M((function(e){var a=function(){e.getFile(l,E,M((function(e){e.createWriter(M((function(a){a.onwriteend=function(t){p.location.href=e.toURL(),g.readyState=g.DONE,b(g,"writeend",t),d(e)},a.onerror=function(){var e=a.error;e.code!==e.ABORT_ERR&&y()},"writestart progress write abort".split(" ").forEach((function(e){a["on"+e]=g["on"+e]})),a.write(t),g.abort=function(){a.abort(),g.readyState=g.DONE},g.readyState=g.WRITING})),y)})),y)};e.getFile(l,{create:!1},M((function(e){e.remove(),a()})),M((function(e){e.code===e.NOT_FOUND_ERR?a():y()})))})),y)})),y)):y()},m=j.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,a){return a||(e=u(e)),navigator.msSaveOrOpenBlob(e,t||"download")}:(m.abort=function(){var e=this;e.readyState=e.DONE,b(e,"abort")},m.readyState=m.INIT=0,m.WRITING=1,m.DONE=2,m.error=m.onwritestart=m.onprogress=m.onwrite=m.onabort=m.onerror=m.onwriteend=null,function(e,t,a){return new j(e,t,a)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);
/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */e.exports?e.exports.saveAs=o:null!==a(683)&&null!=a(684)&&(void 0===(n=function(){return o}.apply(t,[]))||(e.exports=n))},683:function(e,t,a){e.exports=a(39)(1592)},684:function(e,t){(function(t){e.exports=t}).call(this,{})},685:function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(686);case"v8light":return a(688)}},686:function(e,t,a){var n=a(80),o=a(687);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);n(o,{insert:"head",singleton:!1}),e.exports=o.locals||{}},687:function(e,t,a){(t=a(81)(!1)).push([e.i,"#kibanaManagementMLSection .stat{margin-right:8px}#kibanaManagementMLSection .stat .stat-value{font-weight:bold}#kibanaManagementMLSection .mlStatsBar{height:42px;padding:14px;background-color:#25262E}#kibanaManagementMLSection .managementJobsList{clear:both}#kibanaManagementMLSection .tab-contents{margin:-8px;padding:8px;background-color:#1D1E24}#kibanaManagementMLSection .tab-contents .col-md-6:nth-child(1){padding-right:7px}#kibanaManagementMLSection .tab-contents .col-md-6:nth-child(2){padding-left:7px}#kibanaManagementMLSection .tab-contents .job-section{overflow:auto;padding:5px 15px;background-color:#25262E;border:1px solid #343741;border-radius:6px;margin:4px 0}#kibanaManagementMLSection .tab-contents .job-section .euiTable{background-color:transparent}#kibanaManagementMLSection .tab-contents .job-section .euiTable .euiTableRow:first-child .euiTableRowCell{border-top:0}#kibanaManagementMLSection .tab-contents .job-section .euiTable .euiTableRow:last-child .euiTableRowCell{border-bottom:0}#kibanaManagementMLSection .tab-contents .job-section .euiTable .euiTableRow .euiTableRowCell{vertical-align:top;border-bottom:1px solid #343741}#kibanaManagementMLSection .tab-contents .job-section .euiTable .euiTableRow .euiTableRowCell .euiTableCellContent__text{word-wrap:break-word}#kibanaManagementMLSection .tab-contents .job-section .euiTable .euiTableRow:hover{background-color:inherit}#kibanaManagementMLSection .tab-contents .job-section .job-item{font-size:12px}#kibanaManagementMLSection .tab-contents .job-section .job-item.header{font-weight:bold}#kibanaManagementMLSection .tab-contents .json-textarea{height:500px}#kibanaManagementMLSection .job-messages-table{max-height:500px;overflow:auto;text-align:left}#kibanaManagementMLSection .job-messages-table tr:last-child td{border-bottom:none}#kibanaManagementMLSection .job-messages-table .euiTableRowCell{background-color:#1D1E24}#kibanaManagementMLSection .mlAnalyticsTable .euiTableRow-isExpandedRow .euiTableCellContent{animation:none !important}#kibanaManagementMLSection .mlAnalyticsTable .euiTableRow-isExpandedRow .euiTableCellContent .euiTableCellContent__text{width:100%}#kibanaManagementMLSection .mlAnalyticsTable .euiIcon-isLoaded{animation:none !important}#kibanaManagementMLSection .mlTaskStateBadge{max-width:100px}#kibanaManagementMLSection .mlKibanaManagement__analyticsSpacer{clear:both}#kibanaManagementMLSection .mlKibanaManagement__analyticsRefreshButton{float:right}\n",""]),e.exports=t},688:function(e,t,a){var n=a(80),o=a(689);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);n(o,{insert:"head",singleton:!1}),e.exports=o.locals||{}},689:function(e,t,a){(t=a(81)(!1)).push([e.i,"#kibanaManagementMLSection .stat{margin-right:8px}#kibanaManagementMLSection .stat .stat-value{font-weight:bold}#kibanaManagementMLSection .mlStatsBar{height:42px;padding:14px;background-color:#F5F7FA}#kibanaManagementMLSection .managementJobsList{clear:both}#kibanaManagementMLSection .tab-contents{margin:-8px;padding:8px;background-color:#fff}#kibanaManagementMLSection .tab-contents .col-md-6:nth-child(1){padding-right:7px}#kibanaManagementMLSection .tab-contents .col-md-6:nth-child(2){padding-left:7px}#kibanaManagementMLSection .tab-contents .job-section{overflow:auto;padding:5px 15px;background-color:#F5F7FA;border:1px solid #D3DAE6;border-radius:6px;margin:4px 0}#kibanaManagementMLSection .tab-contents .job-section .euiTable{background-color:transparent}#kibanaManagementMLSection .tab-contents .job-section .euiTable .euiTableRow:first-child .euiTableRowCell{border-top:0}#kibanaManagementMLSection .tab-contents .job-section .euiTable .euiTableRow:last-child .euiTableRowCell{border-bottom:0}#kibanaManagementMLSection .tab-contents .job-section .euiTable .euiTableRow .euiTableRowCell{vertical-align:top;border-bottom:1px solid #D3DAE6}#kibanaManagementMLSection .tab-contents .job-section .euiTable .euiTableRow .euiTableRowCell .euiTableCellContent__text{word-wrap:break-word}#kibanaManagementMLSection .tab-contents .job-section .euiTable .euiTableRow:hover{background-color:inherit}#kibanaManagementMLSection .tab-contents .job-section .job-item{font-size:12px}#kibanaManagementMLSection .tab-contents .job-section .job-item.header{font-weight:bold}#kibanaManagementMLSection .tab-contents .json-textarea{height:500px}#kibanaManagementMLSection .job-messages-table{max-height:500px;overflow:auto;text-align:left}#kibanaManagementMLSection .job-messages-table tr:last-child td{border-bottom:none}#kibanaManagementMLSection .job-messages-table .euiTableRowCell{background-color:#fff}#kibanaManagementMLSection .mlAnalyticsTable .euiTableRow-isExpandedRow .euiTableCellContent{animation:none !important}#kibanaManagementMLSection .mlAnalyticsTable .euiTableRow-isExpandedRow .euiTableCellContent .euiTableCellContent__text{width:100%}#kibanaManagementMLSection .mlAnalyticsTable .euiIcon-isLoaded{animation:none !important}#kibanaManagementMLSection .mlTaskStateBadge{max-width:100px}#kibanaManagementMLSection .mlKibanaManagement__analyticsSpacer{clear:both}#kibanaManagementMLSection .mlKibanaManagement__analyticsRefreshButton{float:right}\n",""]),e.exports=t},74:function(e,t,a){"use strict";a.r(t),a.d(t,"mountApp",(function(){return le}));var n=a(53),o=a.n(n),s=a(17),i=a.n(s),l=a(48),r=a(2),c=a(44),d=a(43),b=a(45),u=a(4),j=a(79),m=a(374),p=a(378),x=a(270),g=a(13);const f=()=>Object(g.jsx)(i.a.Fragment,null,Object(g.jsx)(d.EuiPageContent,{verticalPosition:"center",horizontalPosition:"center",color:"danger","data-test-subj":"mlPageAccessDenied"},Object(g.jsx)(d.EuiEmptyPrompt,{iconType:"alert",title:Object(g.jsx)("h2",null,Object(g.jsx)(c.FormattedMessage,{id:"xpack.ml.management.jobsList.noPermissionToAccessLabel",defaultMessage:"Access denied"})),body:Object(g.jsx)("p",null,Object(g.jsx)(c.FormattedMessage,{id:"xpack.ml.management.jobsList.noGrantedPrivilegesDescription",defaultMessage:"You donâ€™t have permission to manage Machine Learning jobs. Access to the plugin requires the Machine Learning feature to be visible in this space."}))}))),h=({basePath:e})=>Object(g.jsx)(i.a.Fragment,null,Object(g.jsx)(d.EuiPageContent,{verticalPosition:"center",horizontalPosition:"center",color:"danger","data-test-subj":"mlPageInsufficientLicense"},Object(g.jsx)(d.EuiEmptyPrompt,{iconType:"alert",title:Object(g.jsx)("h2",null,Object(g.jsx)(c.FormattedMessage,{id:"xpack.ml.management.jobsList.insufficientLicenseLabel",defaultMessage:"Upgrade for subscription features"})),body:Object(g.jsx)("p",null,Object(g.jsx)(c.FormattedMessage,{id:"xpack.ml.management.jobsList.insufficientLicenseDescription",defaultMessage:"To use these machine learning features, you must {link}.",values:{link:Object(g.jsx)(d.EuiLink,{href:`${e.get()}/app/management/stack/license_management/home`},Object(g.jsx)(c.FormattedMessage,{id:"xpack.ml.management.jobsList.insufficientLicenseDescription.link",defaultMessage:"start a trial or upgrade your subscription"}))}}))})));var O=a(385),y=a(275),M=a(213),E=a(281),k=a(210),I=a.n(k),F=a(75);const S=({jobs:e,autoExpand:t=!1})=>0===e.length?null:Object(g.jsx)(i.a.Fragment,null,Object(g.jsx)(d.EuiCallOut,{title:r.i18n.translate("xpack.ml.importExport.importFlyout.cannotImportJobCallout.title",{defaultMessage:"{num, plural, one {# job} other {# jobs}} cannot be imported",values:{num:e.length}}),color:"warning","data-test-subj":"mlJobMgmtImportJobsCannotBeImportedCallout"},t?Object(g.jsx)(v,{jobs:e}):Object(g.jsx)(d.EuiAccordion,{id:"advancedOptions",paddingSize:"s","aria-label":r.i18n.translate("xpack.ml.importExport.importFlyout.cannotImportJobCallout.jobListAria",{defaultMessage:"view jobs"}),buttonContent:Object(g.jsx)(c.FormattedMessage,{id:"xpack.ml.importExport.importFlyout.cannotImportJobCallout.jobListButton",defaultMessage:"View jobs"})},Object(g.jsx)(v,{jobs:e}))),Object(g.jsx)(d.EuiSpacer,{size:"m"})),v=({jobs:e})=>Object(g.jsx)(i.a.Fragment,null,e.length>0&&Object(g.jsx)(i.a.Fragment,null,e.map((({jobId:e,missingIndices:t,missingFilters:a})=>Object(g.jsx)(d.EuiText,{size:"s"},Object(g.jsx)("h5",null,e),t.length>0&&Object(g.jsx)(c.FormattedMessage,{id:"xpack.ml.importExport.importFlyout.cannotImportJobCallout.missingIndex",defaultMessage:"Missing index {num, plural, one {pattern} other {patterns}}: {indices}",values:{num:t.length,indices:t.join(",")}}),a.length>0&&Object(g.jsx)(c.FormattedMessage,{id:"xpack.ml.importExport.importFlyout.cannotImportJobCallout.missingFilters",defaultMessage:"Missing filter {num, plural, one {list} other {lists}}: {filters}",values:{num:a.length,filters:a.join(",")}})))))),w=()=>Object(g.jsx)(i.a.Fragment,null,Object(g.jsx)(d.EuiSpacer,{size:"l"}),Object(g.jsx)(d.EuiCallOut,{title:r.i18n.translate("xpack.ml.importExport.importFlyout.cannotReadFileCallout.title",{defaultMessage:"File cannot be read"}),color:"warning"},Object(g.jsx)("div",{"data-test-subj":"mlJobMgmtImportJobsFileReadErrorCallout"},Object(g.jsx)(c.FormattedMessage,{id:"xpack.ml.importExport.importFlyout.cannotReadFileCallout.body",defaultMessage:"Please select a file contained Machine Learning jobs which have been exported from Kibana using the Export Jobs option"}))));var C=a(82);class JobImportService{_readFile(e){return new Promise(((t,a)=>{if(e&&e.size){const n=new FileReader;n.readAsText(e),n.onload=()=>{const e=n.result;if("string"==typeof e)try{const a=JSON.parse(e);t(a)}catch(e){a()}else a()}}else a()}))}async readJobConfigs(e){try{const a=await this._readFile(e),n=Array.isArray(a)?a:[a];if(t=n,Array.isArray(t)&&t.some((e=>e.job&&e.datafeed))){const e=n.map((e=>e.job.job_id));return{jobs:n,jobIds:e,jobType:"anomaly-detector"}}if(function(e){return Array.isArray(e)&&e.some((e=>e.dest&&e.analysis))}(n)){const e=n.map((e=>e.id));return{jobs:n,jobIds:e,jobType:"data-frame-analytics"}}return{jobs:[],jobIds:[],jobType:null}}catch(e){return{jobs:[],jobIds:[],jobType:null}}var t}renameAdJobs(e,t){return t.length!=t.length?t:t.map(((t,a)=>{const{jobId:n}=e[a];return t.job.job_id=n,t.datafeed.job_id=n,t.datafeed.datafeed_id=`datafeed-${n}`,t}))}renameDfaJobs(e,t){return t.length!=t.length?t:t.map(((t,a)=>{const{jobId:n,destIndex:o}=e[a];return t.id=n,void 0!==o&&(t.dest.index=o),t}))}async validateJobs(e,t,a,n){const o=new Set(await a()),s=new Set((await n()).map((e=>e.filter_id))),i=[],l=[];return("anomaly-detector"===t?e.map((e=>({jobId:e.job.job_id,indices:e.datafeed.indices,filters:T(e.job)}))):e.map((e=>({jobId:e.id,destIndex:e.dest.index,indices:Array.isArray(e.source.index)?e.source.index:[e.source.index]})))).forEach((({jobId:e,indices:a,filters:n=[],destIndex:r})=>{const c=a.filter((e=>!1===o.has(e))),d=n.filter((e=>!1===s.has(e)));0===c.length&&0===d.length?i.push({jobId:e,..."data-frame-analytics"===t?{destIndex:r}:{}}):l.push({jobId:e,missingIndices:c,missingFilters:d})})),{jobs:i,skippedJobs:l}}}function T(e){const t=new Set;return e.analysis_config.detectors.forEach((e=>{void 0!==e.custom_rules&&e.custom_rules.forEach((e=>{void 0!==e.scope&&Object.values(e.scope).forEach((e=>{t.add(e.filter_id)}))}))})),[...t]}var L=a(310),_=a(83),J=a(29);const A=r.i18n.translate("xpack.ml.importExport.importFlyout.validateJobId.jobNameEmpty",{defaultMessage:"Enter a valid job ID"}),D=r.i18n.translate("xpack.ml.importExport.importFlyout.validateJobId.jobNameAllowedCharacters",{defaultMessage:"Job ID can contain lowercase alphanumeric (a-z and 0-9), hyphens or underscores; must start and end with an alphanumeric character"}),B=r.i18n.translate("xpack.ml.importExport.importFlyout.validateJobId.jobIdInvalidMaxLengthErrorMessage",{defaultMessage:"Job ID must be no more than {maxLength, plural, one {# character} other {# characters}} long.",values:{maxLength:J.b}}),R=r.i18n.translate("xpack.ml.importExport.importFlyout.validateJobId.jobNameAlreadyExists",{defaultMessage:"Job ID already exists. A job ID cannot be the same as an existing job or group."}),z=r.i18n.translate("xpack.ml.importExport.importFlyout.validateDestIndex.destIndexEmpty",{defaultMessage:"Enter a valid destination index"}),V=r.i18n.translate("xpack.ml.importExport.importFlyout.validateDestIndex.destIndexInvalid",{defaultMessage:"Invalid destination index name."}),P=r.i18n.translate("xpack.ml.importExport.importFlyout.validateDestIndex.destIndexExists",{defaultMessage:"An index with this name already exists. Be aware that running this analytics job will modify this destination index."});var N=a(27);const U=({isDisabled:e})=>{const{jobs:{bulkCreateJobs:t},dataFrameAnalytics:{createDataFrameAnalytics:a},filters:{filters:n}}=Object(F.a)(),{services:{data:{dataViews:{getTitles:o}},notifications:{toasts:l},mlServices:{mlUsageCollection:b}}}=Object(F.b)(),u=Object(s.useMemo)((()=>new JobImportService),[]),[j,m]=Object(s.useState)(!1),[p,x]=Object(s.useState)([]),[f,h]=Object(s.useState)([]),[O,y]=Object(s.useState)([]),[M,E]=Object(s.useState)([]),[k,v]=Object(s.useState)(!1),[T,U]=Object(s.useState)(null),[K,H]=Object(s.useState)(0),[q,Y]=Object(s.useState)(!0),[$,Q]=Object(s.useState)(!0),[X,Z]=Object(s.useState)(""),[ee,te]=Object(s.useState)(!1),[ae,ne]=Object(s.useState)(!1),{displayErrorToast:oe,displaySuccessToast:se}=Object(s.useMemo)((()=>Object(C.b)(l)),[l]),[ie]=((e,t,a,n,o)=>{const{jobs:{jobsExist:i},dataFrameAnalytics:{jobsExist:l},checkIndicesExists:r}=Object(F.a)();return[Object(s.useCallback)((async()=>{const a=[],s=[],c="anomaly-detector"===e;if(t.filter((({jobIdValidated:e})=>!1===e)).forEach((e=>{e.jobIdValid=!0,e.jobIdInvalidMessage="",""===e.jobId?(e.jobIdValid=!1,e.jobIdInvalidMessage=A,e.jobIdValidated=c):e.jobId.length>J.b?(e.jobIdValid=!1,e.jobIdInvalidMessage=B,e.jobIdValidated=c):!1===Object(_.i)(e.jobId)&&(e.jobIdValid=!1,e.jobIdInvalidMessage=D,e.jobIdValidated=c),!0===e.jobIdValid&&a.push(e.jobId)})),"data-frame-analytics"===e&&t.filter((({destIndexValidated:e})=>!1===e)).forEach((e=>{void 0!==e.destIndex&&(e.destIndexValid=!0,e.destIndexInvalidMessage="",""===e.destIndex?(e.destIndexValid=!1,e.destIndexInvalidMessage=z,e.destIndexValidated=!0):!1===Object(L.a)(e.destIndex)&&(e.destIndexValid=!1,e.destIndexInvalidMessage=V,e.destIndexValidated=!0),!0===e.destIndexValid&&s.push(e.destIndex))})),null!==e){const c="anomaly-detector"===e?i:l,d=await c(a,!0);if(t.forEach((e=>{const t=d[e.jobId];if(t){const{exists:a}=t;e.jobIdValid=!a,e.jobIdInvalidMessage=a?R:"",e.jobIdValidated=!0}})),"data-frame-analytics"===e){const e=await r({indices:s});t.forEach((t=>{if(void 0!==t.destIndex&&!1===t.destIndexValidated){var a;const n=!0===(null===(a=e[t.destIndex])||void 0===a?void 0:a.exists);t.destIndexInvalidMessage=n?P:"",t.destIndexValidated=!0}}))}n([...t]),o(!1)}}),[a,t])]})(T,O,X,y,te);I()(ie,400,[X]);const le=Object(s.useCallback)(((e=!1)=>{x([]),h([]),y([]),Z(""),v(!1),U(null),H(0),te(!1),ne(e)}),[]);Object(s.useEffect)((function(){le()}),[j]);const re=Object(s.useCallback)((async e=>{if(ne(!1),0!==e.length)try{const t=await u.readJobConfigs(e[0]);if(null===t.jobType)return void le(!0);H(t.jobs.length);const a=await u.validateJobs(t.jobs,t.jobType,o,n);if("anomaly-detector"===t.jobType){const e=t.jobs.filter((e=>a.jobs.map((({jobId:e})=>e)).includes(e.job.job_id)));x(e)}else if("data-frame-analytics"===t.jobType){const e=t.jobs.filter((e=>a.jobs.map((({jobId:e})=>e)).includes(e.id)));h(e)}U(t.jobType),y(a.jobs.map((({jobId:e,destIndex:t})=>({jobId:e,originalId:e,jobIdValid:!0,jobIdInvalidMessage:"",jobIdValidated:!1,destIndex:t,originalDestIndex:t,destIndexValid:!0,destIndexInvalidMessage:"",destIndexValidated:!1}))));const s=G(a.jobs,t.jobType);Z(s),te(!0),E(a.skippedJobs)}catch(e){oe(e)}else le()}),[]),ce=Object(s.useCallback)((async()=>{if(v(!0),"anomaly-detector"===T){const e=u.renameAdJobs(O,p);try{await de(e),b.count("imported_anomaly_detector_jobs",e.length)}catch(e){oe(e)}}else if("data-frame-analytics"===T){const e=u.renameDfaJobs(O,f);await be(e),b.count("imported_data_frame_analytics_jobs",e.length)}v(!1),m(!1)}),[T,O,p,f]),de=Object(s.useCallback)((async e=>{const a=await t(e);let n=0;const o=[],s=new Set;Object.entries(a).forEach((([e,{job:t,datafeed:a}])=>{t.error||a.error?(s.add(e),t.error&&o.push(t.error),a.error&&o.push(a.error)):n++})),n>0&&ue(n),o.length>0&&(je(o,s.size),b.count("import_failed_anomaly_detector_jobs",s.size))}),[]),be=Object(s.useCallback)((async e=>{const t=[],n=await Promise.all(e.map((async({id:e,...n})=>{try{return await a(e,n)}catch(e){t.push(e)}}))),o=Object.values(n).filter((e=>void 0!==e)).length;o>0&&ue(o),t.length>0&&(je(t,t.length),b.count("import_failed_data_frame_analytics_jobs",t.length))}),[]),ue=Object(s.useCallback)((e=>{const t=r.i18n.translate("xpack.ml.importExport.importFlyout.importJobSuccessToast",{defaultMessage:"{count, plural, one {# job} other {# jobs}} successfully imported",values:{count:e}});se(t)}),[]),je=Object(s.useCallback)(((e,t)=>{const a=r.i18n.translate("xpack.ml.importExport.importFlyout.importJobErrorToast",{defaultMessage:"{count, plural, one {# job} other {# jobs}} failed to import correctly",values:{count:t}}),n=e.map(N.c);oe(n,a)}),[]),me=Object(s.useCallback)((e=>{if("anomaly-detector"===T){const t=[...p];t.splice(e,1),x(t)}else if("data-frame-analytics"===T){const t=[...f];t.splice(e,1),h(t)}const t=[...O];t.splice(e,1),y(t);const a=G(t,T);Z(a),te(!0)}),[O,p,f]);Object(s.useEffect)((()=>{const e=0===O.length||!0===k||!0===ee||O.some((({jobIdValid:e,destIndexValid:t})=>!1===e||!1===t));Y(e),Q(!0===k||!0===ee)}),[O,X,ee,k]);const pe=Object(s.useCallback)(((e,t)=>{O[t].jobId=e,O[t].jobIdValid=!1,O[t].jobIdValidated=!1,y([...O]);const a=G(O,T);Z(a),te(!0)}),[O]),xe=Object(s.useCallback)(((e,t)=>{O[t].destIndex=e,O[t].destIndexValid=!1,O[t].destIndexValidated=!1,O[t].destIndexInvalidMessage="",y([...O]);const a=G(O,T);Z(a),te(!0)}),[O]),ge=({index:e})=>Object(g.jsx)(d.EuiButtonIcon,{iconType:"trash","aria-label":r.i18n.translate("xpack.ml.importExport.importFlyout.deleteButtonAria",{defaultMessage:"Delete"}),color:$?"text":"danger",disabled:$,onClick:()=>me(e)});return Object(g.jsx)(i.a.Fragment,null,Object(g.jsx)(W,{onClick:function(){m(!j)},isDisabled:e}),!0===j&&!1===e&&Object(g.jsx)(d.EuiFlyout,{onClose:m.bind(null,!1),hideCloseButton:!0,size:"m","data-test-subj":"mlJobMgmtImportJobsFlyout"},Object(g.jsx)(d.EuiFlyoutHeader,{hasBorder:!0},Object(g.jsx)(d.EuiTitle,{size:"m"},Object(g.jsx)("h2",null,Object(g.jsx)(c.FormattedMessage,{id:"xpack.ml.importExport.importFlyout.flyoutHeader",defaultMessage:"Import jobs"})))),Object(g.jsx)(d.EuiFlyoutBody,null,Object(g.jsx)(i.a.Fragment,null,Object(g.jsx)(d.EuiText,{textAlign:"center"},Object(g.jsx)(d.EuiFilePicker,{disabled:k,fullWidth:!0,id:"filePicker",initialPromptText:r.i18n.translate("xpack.ml.importExport.importFlyout.fileSelect",{defaultMessage:"Select or drag and drop a file"}),onChange:re,className:"file-datavisualizer-file-picker"})),ae?Object(g.jsx)(w,null):null,K>0&&null!==T&&Object(g.jsx)("div",{"data-test-subj":"mlJobMgmtImportJobsFileRead"},Object(g.jsx)(d.EuiSpacer,{size:"l"}),"anomaly-detector"===T&&Object(g.jsx)("div",{"data-test-subj":"mlJobMgmtImportJobsADTitle"},Object(g.jsx)(c.FormattedMessage,{id:"xpack.ml.importExport.importFlyout.selectedFiles.ad",defaultMessage:"{num} anomaly detection {num, plural, one {job} other {jobs}} read from file",values:{num:K}})),"data-frame-analytics"===T&&Object(g.jsx)("div",{"data-test-subj":"mlJobMgmtImportJobsDFATitle"},Object(g.jsx)(c.FormattedMessage,{id:"xpack.ml.importExport.importFlyout.selectedFiles.dfa",defaultMessage:"{num} data frame analytics {num, plural, one {job} other {jobs}} read from file",values:{num:K}})),Object(g.jsx)(d.EuiSpacer,{size:"m"}),Object(g.jsx)(S,{jobs:M,autoExpand:0===O.length||1===M.length}),Object(g.jsx)(c.FormattedMessage,{id:"xpack.ml.importExport.importFlyout.importableFiles",defaultMessage:"Import {num, plural, one {# job} other {# jobs}}",values:{num:O.length}}),Object(g.jsx)(d.EuiSpacer,{size:"m"}),O.map(((e,t)=>Object(g.jsx)("div",{key:e.originalId},Object(g.jsx)(d.EuiPanel,{hasBorder:!0},Object(g.jsx)(d.EuiFlexGroup,null,Object(g.jsx)(d.EuiFlexItem,null,Object(g.jsx)(d.EuiFormRow,{error:e.jobIdInvalidMessage,isInvalid:!1===e.jobIdValid},Object(g.jsx)(d.EuiFieldText,{prepend:r.i18n.translate("xpack.ml.importExport.importFlyout.jobId",{defaultMessage:"Job ID"}),disabled:k,compressed:!0,value:e.jobId,onChange:e=>pe(e.target.value,t),isInvalid:!1===e.jobIdValid,"data-test-subj":"mlJobMgmtImportJobIdInput"})),"data-frame-analytics"===T&&Object(g.jsx)(d.EuiFormRow,{helpText:!0===e.destIndexValid?e.destIndexInvalidMessage:"",error:!1===e.destIndexValid?e.destIndexInvalidMessage:"",isInvalid:!1===e.destIndexValid},Object(g.jsx)(d.EuiFieldText,{prepend:r.i18n.translate("xpack.ml.importExport.importFlyout.destIndex",{defaultMessage:"Destination index"}),disabled:k,compressed:!0,value:e.destIndex,onChange:e=>xe(e.target.value,t),isInvalid:!1===e.destIndexValid}))),Object(g.jsx)(d.EuiFlexItem,{grow:!1},Object(g.jsx)(ge,{index:t})))),Object(g.jsx)(d.EuiSpacer,{size:"m"}))))))),Object(g.jsx)(d.EuiFlyoutFooter,null,Object(g.jsx)(d.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(g.jsx)(d.EuiFlexItem,{grow:!1},Object(g.jsx)(d.EuiButtonEmpty,{iconType:"cross",onClick:m.bind(null,!1),flush:"left"},Object(g.jsx)(c.FormattedMessage,{id:"xpack.ml.importExport.importFlyout.closeButton",defaultMessage:"Close"}))),Object(g.jsx)(d.EuiFlexItem,{grow:!1},Object(g.jsx)(d.EuiButton,{disabled:q,onClick:ce,fill:!0,"data-test-subj":"mlJobMgmtImportImportButton"},Object(g.jsx)(c.FormattedMessage,{id:"xpack.ml.importExport.importFlyout.closeButton.importButton",defaultMessage:"Import"})))))))},W=({isDisabled:e,onClick:t})=>Object(g.jsx)(d.EuiButtonEmpty,{iconType:"importAction",onClick:t,isDisabled:e,"data-test-subj":"mlJobsImportButton"},Object(g.jsx)(c.FormattedMessage,{id:"xpack.ml.importExport.importButton",defaultMessage:"Import jobs"}));function G(e,t){return e.map((({jobId:e})=>e)).join("")+("data-frame-analytics"===t?e.map((({destIndex:e})=>e)).join(""):"")}const K=({jobs:e})=>{const[t,a,n]=function(e){return e.reduce(((e,t)=>{const a=t.calendarIds.length>0,n=t.filterIds.length>0;return(a||n)&&(e[0].push(t),a&&e[1].push(t),n&&e[2].push(t)),e}),[[],[],[]])}(e),o=a.length>0,s=n.length>0;return!1===o&&!1===s?null:Object(g.jsx)(i.a.Fragment,null,Object(g.jsx)(d.EuiCallOut,{title:Y(t,a.length,n.length),color:"warning"},Object(g.jsx)(c.FormattedMessage,{id:"xpack.ml.importExport.exportFlyout.exportJobDependenciesWarningCallout.calendarDependencies",defaultMessage:"When you export jobs, calendars and filter lists are not included. You must create the filter lists before you import jobs; otherwise, the import fails. If you want the new jobs to continue to ignore scheduled events, you must create the calendars."}),Object(g.jsx)(d.EuiSpacer,null),o&&Object(g.jsx)(d.EuiAccordion,{id:"advancedOptions",paddingSize:"s","aria-label":r.i18n.translate("xpack.ml.importExport.exportFlyout.exportJobDependenciesWarningCallout.jobUsingCalendarsAria",{defaultMessage:"Jobs using calendars"}),buttonContent:Object(g.jsx)(c.FormattedMessage,{id:"xpack.ml.importExport.exportFlyout.exportJobDependenciesWarningCallout.jobUsingCalendarsButton",defaultMessage:"Jobs using calendars"})},Object(g.jsx)(H,{jobs:a})),s&&Object(g.jsx)(d.EuiAccordion,{id:"advancedOptions",paddingSize:"s","aria-label":r.i18n.translate("xpack.ml.importExport.exportFlyout.exportJobDependenciesWarningCallout.jobUsingFiltersAria",{defaultMessage:"Jobs using filter lists"}),buttonContent:Object(g.jsx)(c.FormattedMessage,{id:"xpack.ml.importExport.exportFlyout.exportJobDependenciesWarningCallout.jobUsingFiltersButton",defaultMessage:"Jobs using filter lists"})},Object(g.jsx)(q,{jobs:n}))),Object(g.jsx)(d.EuiSpacer,{size:"m"}))},H=({jobs:e})=>Object(g.jsx)(i.a.Fragment,null,e.length>0&&Object(g.jsx)(i.a.Fragment,null,e.map((({jobId:e,calendarIds:t})=>Object(g.jsx)(i.a.Fragment,null,Object(g.jsx)(d.EuiText,{size:"s"},Object(g.jsx)("h5",null,e),t.length>0&&Object(g.jsx)(c.FormattedMessage,{id:"xpack.ml.importExport.exportFlyout.exportJobDependenciesWarningCallout.calendarList",defaultMessage:"{num, plural, one {calendar} other {calendars}}: {calendars}",values:{num:t.length,calendars:t.join(", ")}})),Object(g.jsx)(d.EuiSpacer,{size:"s"})))))),q=({jobs:e})=>Object(g.jsx)(i.a.Fragment,null,e.length>0&&Object(g.jsx)(i.a.Fragment,null,e.map((({jobId:e,filterIds:t})=>Object(g.jsx)(i.a.Fragment,null,Object(g.jsx)(d.EuiText,{size:"s"},Object(g.jsx)("h5",null,e),t.length>0&&Object(g.jsx)(c.FormattedMessage,{id:"xpack.ml.importExport.exportFlyout.exportJobDependenciesWarningCallout.filterList",defaultMessage:"Filter {num, plural, one {list} other {lists}}: {filters}",values:{num:t.length,filters:t.join(", ")}})),Object(g.jsx)(d.EuiSpacer,{size:"s"}))))));function Y(e,t,a){return t>0&&0===a?r.i18n.translate("xpack.ml.importExport.exportFlyout.exportJobDependenciesWarningCallout.calendarOnlyTitle",{defaultMessage:"{jobCount, plural, one {# job uses} other {# jobs use}} {calendarCount, plural, one {a calendar} other {calendars}}",values:{jobCount:e.length,calendarCount:t}}):0===t&&a>0?r.i18n.translate("xpack.ml.importExport.exportFlyout.exportJobDependenciesWarningCallout.filterOnlyTitle",{defaultMessage:"{jobCount, plural, one {# job uses} other {# jobs use}} {filterCount, plural, one {a filter list} other {filter lists}}",values:{jobCount:e.length,filterCount:a}}):r.i18n.translate("xpack.ml.importExport.exportFlyout.exportJobDependenciesWarningCallout.filterAndCalendarTitle",{defaultMessage:"{jobCount, plural, one {# job uses} other {# jobs use}} filter lists and calendars",values:{jobCount:e.length}})}var $=a(682),Q=a(196);class jobs_export_service_JobsExportService{constructor(e){this._mlApiServices=e}async exportAnomalyDetectionJobs(e){const t=await Promise.all(e.map(this._mlApiServices.jobs.jobForCloning));this._export(t,"anomaly-detector")}async exportDataframeAnalyticsJobs(e){const{data_frame_analytics:t}=await this._mlApiServices.dataFrameAnalytics.getDataFrameAnalytics(e.join(","),!0);this._export(t,"data-frame-analytics")}_export(e,t){const a=1===e.length?e[0]:e,n=new Blob([JSON.stringify(a,null,2)],{type:"application/json"}),o=this._createFileName(t);Object($.saveAs)(n,o)}_createFileName(e){return("anomaly-detector"===e?"anomaly_detection":"data_frame_analytics")+"_jobs.json"}async getJobDependencies(e){const t=await this._mlApiServices.calendars(),a=e.reduce(((e,t)=>(Array.isArray(t.groups)&&t.groups.forEach((a=>{void 0===e[a]&&(e[a]=[]),e[a].push(t.job_id)})),e)),{}),n=t.reduce(((t,n)=>(n.job_ids.forEach((o=>{o===Q.a?e.forEach((e=>{void 0===t[e.job_id]&&(t[e.job_id]=[]),t[e.job_id].push(n.calendar_id)})):void 0!==a[o]?a[o].forEach((e=>{void 0===t[e]&&(t[e]=[]),t[e].push(n.calendar_id)})):(void 0===t[o]&&(t[o]=[]),t[o].push(n.calendar_id))})),t)),{}),o=e.reduce(((e,t)=>(void 0===e[t.job_id]&&(e[t.job_id]=[]),t.analysis_config.detectors.forEach((a=>{void 0!==a.custom_rules&&a.custom_rules.forEach((a=>{void 0!==a.scope&&Object.values(a.scope).forEach((a=>{e[t.job_id].push(a.filter_id)}))}))})),e)),{});return e.map((e=>{var t,a;const s=e.job_id;return{jobId:s,calendarIds:null!==(t=[...new Set(n[s])])&&void 0!==t?t:[],filterIds:null!==(a=[...new Set(o[s])])&&void 0!==a?a:[]}}))}}const X=({isDisabled:e,currentTab:t})=>{const a=Object(F.a)(),{getJobs:n,dataFrameAnalytics:{getDataFrameAnalytics:o}}=a,{services:{notifications:{toasts:l},mlServices:{mlUsageCollection:b}}}=Object(F.b)(),u=Object(s.useMemo)((()=>new jobs_export_service_JobsExportService(a)),[]),[j,m]=Object(s.useState)(!0),[p,x]=Object(s.useState)(!0),[f,h]=Object(s.useState)(!1),[O,y]=Object(s.useState)([]),[M,E]=Object(s.useState)([]),[k,I]=Object(s.useState)([]),[S,v]=Object(s.useState)(!1),[w,T]=Object(s.useState)(t),[L,_]=Object(s.useState)(!1),[J,A]=Object(s.useState)(t),{displayErrorToast:D,displaySuccessToast:B}=Object(s.useMemo)((()=>Object(C.b)(l)),[l]),[R,z]=Object(s.useState)([]),[V,P]=Object(s.useState)([]);function N(e,t){I(e?[...k,t]:k.filter((e=>e!==t)))}Object(s.useEffect)((function(){m(!0),x(!0),y([]),I([]),v(!1),T(t),_(!1),f&&(n().then((({jobs:e})=>{m(!1),y(e.map((e=>e.job_id))),u.getJobDependencies(e).then((e=>{z(e),m(!1)})).catch((e=>{const t=r.i18n.translate("xpack.ml.importExport.exportFlyout.calendarsError",{defaultMessage:"Could not load calendars"});D(e,t)}))})).catch((e=>{const t=r.i18n.translate("xpack.ml.importExport.exportFlyout.adJobsError",{defaultMessage:"Could not load anomaly detection jobs"});D(e,t)})),o().then((({data_frame_analytics:e})=>{x(!1),E(e.map((e=>e.id)))})).catch((e=>{const t=r.i18n.translate("xpack.ml.importExport.exportFlyout.dfaJobsError",{defaultMessage:"Could not load data frame analytics jobs"});D(e,t)})))}),[f]);const U=Object(s.useCallback)((e=>{if(e!==w)return k.length>0?(A(e),void _(!0)):void W(e)}),[k]);function W(e){_(!1),I([]),T(e)}function G(){const e="anomaly-detector"===w?O:M;k.length===e.length?I([]):I([...e])}return Object(s.useEffect)((()=>{P(R.filter((({jobId:e})=>k.includes(e))))}),[k]),Object(g.jsx)(i.a.Fragment,null,Object(g.jsx)(Z,{onClick:function(){h(!f)},isDisabled:e}),!0===f&&!1===e&&Object(g.jsx)(i.a.Fragment,null,Object(g.jsx)(d.EuiFlyout,{onClose:()=>h(!1),hideCloseButton:!0,size:"s","data-test-subj":"mlJobMgmtExportJobsFlyout"},Object(g.jsx)(d.EuiFlyoutHeader,{hasBorder:!0},Object(g.jsx)(d.EuiTitle,{size:"m"},Object(g.jsx)("h2",null,Object(g.jsx)(c.FormattedMessage,{id:"xpack.ml.importExport.exportFlyout.flyoutHeader",defaultMessage:"Export jobs"})))),Object(g.jsx)(d.EuiFlyoutBody,null,Object(g.jsx)(K,{jobs:V}),Object(g.jsx)(d.EuiTabs,{size:"s"},Object(g.jsx)(d.EuiTab,{isSelected:"anomaly-detector"===w,onClick:()=>U("anomaly-detector"),disabled:S,"data-test-subj":"mlJobMgmtExportJobsADTab"},Object(g.jsx)(c.FormattedMessage,{id:"xpack.ml.importExport.exportFlyout.adTab",defaultMessage:"Anomaly detection"})),Object(g.jsx)(d.EuiTab,{isSelected:"data-frame-analytics"===w,onClick:()=>U("data-frame-analytics"),disabled:S,"data-test-subj":"mlJobMgmtExportJobsDFATab"},Object(g.jsx)(c.FormattedMessage,{id:"xpack.ml.importExport.exportFlyout.dfaTab",defaultMessage:"Analytics"}))),Object(g.jsx)(d.EuiSpacer,{size:"s"}),Object(g.jsx)(i.a.Fragment,null,"anomaly-detector"===w&&Object(g.jsx)(i.a.Fragment,null,!0===j?Object(g.jsx)(ee,null):Object(g.jsx)(i.a.Fragment,null,Object(g.jsx)(d.EuiButtonEmpty,{size:"xs",onClick:G,isDisabled:e,"data-test-subj":"mlJobMgmtExportJobsSelectAllButton"},k.length===O.length?Object(g.jsx)(c.FormattedMessage,{id:"xpack.ml.importExport.exportFlyout.adDeselectAllButton",defaultMessage:"Deselect all"}):Object(g.jsx)(c.FormattedMessage,{id:"xpack.ml.importExport.exportFlyout.adSelectAllButton",defaultMessage:"Select all"})),Object(g.jsx)(d.EuiSpacer,{size:"xs"}),Object(g.jsx)("div",{"data-test-subj":"mlJobMgmtExportJobsADJobList"},O.map((e=>Object(g.jsx)("div",{key:e},Object(g.jsx)(d.EuiCheckbox,{id:e,label:e,checked:k.includes(e),onChange:t=>N(t.target.checked,e)}),Object(g.jsx)(d.EuiSpacer,{size:"s"}))))))),"data-frame-analytics"===w&&Object(g.jsx)(i.a.Fragment,null,!0===p?Object(g.jsx)(ee,null):Object(g.jsx)(i.a.Fragment,null,Object(g.jsx)(d.EuiButtonEmpty,{size:"xs",onClick:G,isDisabled:e,"data-test-subj":"mlJobMgmtExportJobsSelectAllButton"},k.length===M.length?Object(g.jsx)(c.FormattedMessage,{id:"xpack.ml.importExport.exportFlyout.dfaDeselectAllButton",defaultMessage:"Deselect all"}):Object(g.jsx)(c.FormattedMessage,{id:"xpack.ml.importExport.exportFlyout.dfaSelectAllButton",defaultMessage:"Select all"})),Object(g.jsx)(d.EuiSpacer,{size:"xs"}),Object(g.jsx)("div",{"data-test-subj":"mlJobMgmtExportJobsDFAJobList"},M.map((e=>Object(g.jsx)("div",{key:e},Object(g.jsx)(d.EuiCheckbox,{id:e,label:e,checked:k.includes(e),onChange:t=>N(t.target.checked,e)}),Object(g.jsx)(d.EuiSpacer,{size:"s"}))))))))),Object(g.jsx)(d.EuiFlyoutFooter,null,Object(g.jsx)(d.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(g.jsx)(d.EuiFlexItem,{grow:!1},Object(g.jsx)(d.EuiButtonEmpty,{iconType:"cross",onClick:h.bind(null,!1),flush:"left"},Object(g.jsx)(c.FormattedMessage,{id:"xpack.ml.importExport.exportFlyout.closeButton",defaultMessage:"Close"}))),Object(g.jsx)(d.EuiFlexItem,{grow:!1},Object(g.jsx)(d.EuiButton,{disabled:0===k.length||!0===S,onClick:async function(){v(!0);const e=r.i18n.translate("xpack.ml.importExport.exportFlyout.exportDownloading",{defaultMessage:"Your file is downloading in the background"});B(e);try{"anomaly-detector"===w?await u.exportAnomalyDetectionJobs(k):await u.exportDataframeAnalyticsJobs(k),b.count("anomaly-detector"===w?"exported_anomaly_detector_jobs":"exported_data_frame_analytics_jobs",k.length),v(!1),h(!1)}catch(e){const t=r.i18n.translate("xpack.ml.importExport.exportFlyout.exportError",{defaultMessage:"Could not export selected jobs"});D(e,t),v(!1)}},fill:!0,"data-test-subj":"mlJobMgmtExportExportButton"},Object(g.jsx)(c.FormattedMessage,{id:"xpack.ml.importExport.exportFlyout.exportButton",defaultMessage:"Export"})))))),!0===L?Object(g.jsx)(te,{onCancel:_.bind(null,!1),onConfirm:()=>W(J)}):null))},Z=({isDisabled:e,onClick:t})=>Object(g.jsx)(d.EuiButtonEmpty,{iconType:"exportAction",onClick:t,isDisabled:e,"data-test-subj":"mlJobsExportButton"},Object(g.jsx)(c.FormattedMessage,{id:"xpack.ml.importExport.exportButton",defaultMessage:"Export jobs"})),ee=()=>Object(g.jsx)(i.a.Fragment,null,Object(g.jsx)(d.EuiSpacer,{size:"l"}),Object(g.jsx)(d.EuiFlexGroup,{justifyContent:"spaceAround"},Object(g.jsx)(d.EuiFlexItem,{grow:!1},Object(g.jsx)(d.EuiLoadingSpinner,{size:"l"})))),te=({onCancel:e,onConfirm:t})=>Object(g.jsx)(d.EuiConfirmModal,{title:r.i18n.translate("xpack.ml.importExport.exportFlyout.switchTabsConfirm.title",{defaultMessage:"Change tabs?"}),onCancel:e,onConfirm:t,cancelButtonText:r.i18n.translate("xpack.ml.importExport.exportFlyout.switchTabsConfirm.cancelButton",{defaultMessage:"Cancel"}),confirmButtonText:r.i18n.translate("xpack.ml.importExport.exportFlyout.switchTabsConfirm.confirmButton",{defaultMessage:"Confirm"}),defaultFocusedButton:"confirm"},Object(g.jsx)("p",null,Object(g.jsx)(c.FormattedMessage,{id:"xpack.ml.importExport.exportFlyout.switchTabsConfirm.text",defaultMessage:"Changing tabs will clear currently selected jobs"})));function ae(e){const[t,a]=Object(s.useState)(e),n=Object(s.useCallback)((e=>{a({...t,...e})}),[t]);return[t,n]}const ne=({children:e})=>Object(g.jsx)(i.a.Fragment,null,e),oe=({coreStart:e,share:t,history:a,spacesApi:n,data:o,usageCollection:k,fieldFormats:I})=>{const F=void 0!==n,[S,v]=Object(s.useState)(!1),[w,C]=Object(s.useState)(!1),[T,L]=Object(s.useState)(!0),[_,J]=Object(s.useState)(!1),[A,D]=Object(s.useState)(!1),B=function(e,t){const[a,n]=ae(Object(y.b)()),[o,i]=ae(Object(E.b)()),[l,c]=ae(Object(x.b)());return Object(s.useMemo)((()=>[{"data-test-subj":"mlStackManagementJobsListAnomalyDetectionTab",id:"anomaly-detector",name:r.i18n.translate("xpack.ml.management.jobsList.anomalyDetectionTab",{defaultMessage:"Anomaly detection"}),content:Object(g.jsx)(s.Fragment,null,Object(g.jsx)(d.EuiSpacer,{size:"m"}),Object(g.jsx)(m.a,{jobsViewState:a,onJobsViewStateUpdate:n,isManagementTable:!0,isMlEnabledInSpace:e,spacesApi:t}))},{"data-test-subj":"mlStackManagementJobsListAnalyticsTab",id:"data-frame-analytics",name:r.i18n.translate("xpack.ml.management.jobsList.analyticsTab",{defaultMessage:"Analytics"}),content:Object(g.jsx)(s.Fragment,null,Object(g.jsx)(d.EuiSpacer,{size:"m"}),Object(g.jsx)(p.a,{isManagementTable:!0,isMlEnabledInSpace:e,spacesApi:t,pageState:o,updatePageState:i}))},{"data-test-subj":"mlStackManagementJobsListAnalyticsTab",id:"trained-model",name:r.i18n.translate("xpack.ml.management.jobsList.trainedModelsTab",{defaultMessage:"Trained models"}),content:Object(g.jsx)(s.Fragment,null,Object(g.jsx)(d.EuiSpacer,{size:"m"}),Object(g.jsx)(x.a,{isManagementTable:!0,pageState:l,updatePageState:c}))}]),[e,a,n,o,i,l,c])}(A,n),[R,z]=Object(s.useState)("anomaly-detector"),V=e.i18n.Context,P=e.theme.theme$;Object(s.useEffect)((()=>{(async()=>{try{const{mlFeatureEnabledInSpace:e}=await Object(j.d)();D(e)}catch(e){e.mlFeatureEnabledInSpace&&!1===e.isPlatinumOrTrialLicense?L(!1):C(!0)}v(!0)})()}),[]);const N=Object(s.useCallback)(n?n.ui.components.getSpacesContextProvider:ne,[n]);return!1===S?null:w?Object(g.jsx)(f,null):!1===T?Object(g.jsx)(h,{basePath:e.http.basePath}):Object(g.jsx)(b.RedirectAppLinks,{application:e.application},Object(g.jsx)(V,null,Object(g.jsx)(b.KibanaThemeProvider,{theme$:P},Object(g.jsx)(b.KibanaContextProvider,{services:{...e,share:t,data:o,usageCollection:k,fieldFormats:I,spacesApi:n,mlServices:Object(M.getMlGlobalServices)(e.http,k)}},Object(g.jsx)(N,{feature:u.e},Object(g.jsx)(l.Router,{history:a},Object(g.jsx)(d.EuiPageHeader,{pageTitle:Object(g.jsx)(c.FormattedMessage,{id:"xpack.ml.management.jobsList.jobsListTitle",defaultMessage:"Machine Learning"}),description:Object(g.jsx)(c.FormattedMessage,{id:"xpack.ml.management.jobsList.jobsListTagline",defaultMessage:"View, export, and import machine learning analytics and anomaly detection items."}),rightSideItems:[Object(g.jsx)(se,{currentTabId:R})],bottomBorder:!0}),Object(g.jsx)(d.EuiSpacer,{size:"l"}),Object(g.jsx)(d.EuiPageContentBody,{id:"kibanaManagementMLSection","data-test-subj":"mlPageStackManagementJobsList"},Object(g.jsx)(d.EuiFlexGroup,null,Object(g.jsx)(d.EuiFlexItem,{grow:!1},F&&Object(g.jsx)(i.a.Fragment,null,Object(g.jsx)(d.EuiButtonEmpty,{onClick:()=>J(!0),"data-test-subj":"mlStackMgmtSyncButton"},r.i18n.translate("xpack.ml.management.jobsList.syncFlyoutButton",{defaultMessage:"Synchronize saved objects"})),_&&Object(g.jsx)(O.a,{onClose:function(){J(!1)}}),Object(g.jsx)(d.EuiSpacer,{size:"s"}))),Object(g.jsx)(d.EuiFlexItem,{grow:!1},Object(g.jsx)(X,{isDisabled:!1,currentTab:"trained-model"===R?"anomaly-detector":R})),Object(g.jsx)(d.EuiFlexItem,{grow:!1},Object(g.jsx)(U,{isDisabled:!1}))),Object(g.jsx)(d.EuiTabbedContent,{onTabClick:({id:e})=>{z(e)},size:"s",tabs:B,initialSelectedTab:B[0]}))))))))},se=({currentTabId:e})=>{const{services:{docLinks:{links:{ml:t}}}}=Object(F.b)();let a=t.anomalyDetectionJobs,n=r.i18n.translate("xpack.ml.management.jobsList.anomalyDetectionDocsLabel",{defaultMessage:"Anomaly detection jobs docs"});return"data-frame-analytics"===e?(a=t.dataFrameAnalytics,n=r.i18n.translate("xpack.ml.management.jobsList.analyticsDocsLabel",{defaultMessage:"Analytics jobs docs"})):"trained-model"===e&&(a=t.trainedModels,n=r.i18n.translate("xpack.ml.management.jobsList.trainedModelsDocsLabel",{defaultMessage:"Trained models docs"})),Object(g.jsx)(d.EuiButtonEmpty,{href:a,target:"_blank",iconType:"help","data-test-subj":"documentationLink"},n)};var ie=a(26);async function le(e,t,a){const[s,l]=await e.getStartServices();return Object(ie.n)({docLinks:s.docLinks,basePath:s.http.basePath,http:s.http,i18n:s.i18n}),t.setBreadcrumbs([{text:r.i18n.translate("xpack.ml.management.breadcrumb",{defaultMessage:"Machine Learning"}),href:"#/management/ml/jobs_list"}]),((e,t,a,s,l,r,c,d)=>(o.a.render(i.a.createElement(oe,{coreStart:a,history:t,share:s,data:l,spacesApi:c,usageCollection:d,fieldFormats:r}),e),()=>{Object(n.unmountComponentAtNode)(e),Object(ie.a)()}))(t.element,t.history,s,l.share,l.data,l.fieldFormats,l.spaces,a.usageCollection)}a(685)}}]);