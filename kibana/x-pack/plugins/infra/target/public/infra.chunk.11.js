/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.infra_bundle_jsonpfunction=window.infra_bundle_jsonpfunction||[]).push([[11],{107:function(e,t,a){"use strict";a.d(t,"a",(function(){return z}));var n=a(2),s=a(18),r=a(19),i=a(24),l=a(67),o=a.n(l),c=a(0),u=a(23),d=a(49),m=a.n(d);const p=new c.Type("TimestampFromString",(e=>"number"==typeof e),((e,t)=>Object(i.pipe)(c.string.validate(e,t),Object(s.chain)((e=>{const a=m()(e);return a.isValid()?c.success(a.valueOf()):c.failure(e,t)})))),(e=>new Date(e).toISOString())),f=(c.type({sources:c.type({default:c.partial({fields:c.partial({message:c.array(c.string)})})})}),c.type({timestampColumn:c.type({id:c.string})})),g=c.type({messageColumn:c.type({id:c.string})}),b=c.type({fieldColumn:c.type({id:c.string,field:c.string})}),y=c.union([f,g,b]),h=c.type({type:c.literal("index_pattern"),indexPatternId:c.string}),v=c.type({type:c.literal("index_name"),indexName:c.string}),E=c.union([h,v]),x=c.type({message:c.array(c.string)}),k=c.type({name:c.string,description:c.string,metricAlias:c.string,logIndices:E,inventoryDefaultView:c.string,metricsExplorerDefaultView:c.string,fields:x,logColumns:c.array(y),anomalyThreshold:c.number}),O=c.partial(Object(u.omit)(x.props,["message"])),w=c.intersection([c.partial(Object(u.omit)(k.props,["fields"])),c.partial({fields:O})]),C=c.partial(x.props),M=(c.partial({...k.props,fields:C}),c.type({...k.props,fields:x,logColumns:c.array(y)})),j=c.type({name:c.string,type:c.string,searchable:c.boolean,aggregatable:c.boolean,displayable:c.boolean}),T=c.type({logIndicesExist:c.boolean,metricIndicesExist:c.boolean,indexFields:c.array(j)}),S=c.intersection([c.type({id:c.string,origin:c.keyof({fallback:null,internal:null,stored:null}),configuration:M}),c.partial({version:c.string,updatedAt:c.number,status:T})]),B=(c.type({source:S}),c.intersection([c.type({id:c.string,attributes:w}),c.partial({version:c.string,updated_at:p})]),c.strict({name:k.props.name,description:k.props.description,metricAlias:k.props.metricAlias,inventoryDefaultView:k.props.inventoryDefaultView,metricsExplorerDefaultView:k.props.metricsExplorerDefaultView,anomalyThreshold:c.number})),F=(c.partial({...B.type.props}),c.keyof({fallback:null,internal:null,stored:null})),I=c.strict({metricIndicesExist:T.props.metricIndicesExist,indexFields:T.props.indexFields}),L=c.exact(c.intersection([c.type({id:c.string,origin:F,configuration:B}),c.partial({updatedAt:c.number,version:c.string,status:I})])),P=c.type({source:L});var D=a(79),R=a(17);const z=({sourceId:e="default",fetch:t,toastWarning:a})=>{const{error:l,loading:o,response:c,makeRequest:u}=Object(D.a)(`/api/metrics/source/${e}`,"GET",null,(e=>Object(i.pipe)(P.decode(e),Object(s.fold)(Object(R.c)(R.a),r.identity))),t,a);return Object(n.useEffect)((()=>{(async()=>{await u()})()}),[u]),{createDerivedIndexPattern:Object(n.useCallback)((()=>{return{fields:null!=c&&c.source.status?c.source.status.indexFields:[],title:(e=null==c?void 0:c.source,t="metrics",e?"metrics"===t?e.configuration.metricAlias:`${e.configuration.metricAlias}`:"unknown-index")};var e,t}),[c]),source:Object(n.useMemo)((()=>c?c.source:null),[c]),loading:o,error:l}},A=o()(z),[_,N]=A},110:function(e,t,a){var n=a(162),s=a(163),r=s;r.v1=n,r.v4=s,e.exports=r},111:function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var n=a(0),s=a(75),r=a(86);const i=n.type({from:n.number,to:n.number,interval:n.string}),l=n.union([n.string,n.null,n[void 0]]),o=n.type({id:n.string,aggregations:s.d}),c=(n.intersection([n.type({timerange:i,indexPattern:n.string,metrics:n.array(o)}),n.partial({groupBy:n.array(l),modules:n.array(n.string),afterKey:n.union([n.null,r.b]),limit:n.union([n.number,n.null,n[void 0]]),filters:n.array(n.object),dropPartialBuckets:n.boolean,alignDataToEnd:n.boolean})]),n.type({afterKey:n.union([n.null,r.b,n[void 0]]),interval:n.number})),u=n.keyof({date:null,number:null,string:null}),d=n.type({name:n.string,type:u}),m=n.intersection([n.type({timestamp:n.number}),n.record(n.string,n.union([n.string,n.number,n.null,n[void 0],n.array(n.object)]))]),p=n.intersection([n.type({id:n.string,columns:n.array(d),rows:n.array(m)}),n.partial({keys:n.array(n.string)})]);n.type({series:n.array(n.intersection([p,n.partial({metricsets:n.array(n.string)})])),info:c})},113:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(9),s=a(54);function r(){const[e]=Object(n.useUiSetting$)(s.UI_SETTINGS.DATEFORMAT_TZ);return e&&"Browser"!==e?e:"local"}},117:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(1),s=a(23);const r={CPUUsage:n.i18n.translate("xpack.infra.waffle.metricOptions.cpuUsageText",{defaultMessage:"CPU usage"}),MemoryUsage:n.i18n.translate("xpack.infra.waffle.metricOptions.memoryUsageText",{defaultMessage:"memory usage"}),InboundTraffic:n.i18n.translate("xpack.infra.waffle.metricOptions.inboundTrafficText",{defaultMessage:"inbound traffic"}),OutboundTraffic:n.i18n.translate("xpack.infra.waffle.metricOptions.outboundTrafficText",{defaultMessage:"outbound traffic"}),LogRate:n.i18n.translate("xpack.infra.waffle.metricOptions.hostLogRateText",{defaultMessage:"log rate"}),Load:n.i18n.translate("xpack.infra.waffle.metricOptions.loadText",{defaultMessage:"load"}),Count:n.i18n.translate("xpack.infra.waffle.metricOptions.countText",{defaultMessage:"count"}),DiskIOReadBytes:n.i18n.translate("xpack.infra.waffle.metricOptions.diskIOReadBytes",{defaultMessage:"disk reads"}),DiskIOWriteBytes:n.i18n.translate("xpack.infra.waffle.metricOptions.diskIOWriteBytes",{defaultMessage:"disk writes"}),s3BucketSize:n.i18n.translate("xpack.infra.waffle.metricOptions.s3BucketSize",{defaultMessage:"bucket size"}),s3TotalRequests:n.i18n.translate("xpack.infra.waffle.metricOptions.s3TotalRequests",{defaultMessage:"total requests"}),s3NumberOfObjects:n.i18n.translate("xpack.infra.waffle.metricOptions.s3NumberOfObjects",{defaultMessage:"number of objects"}),s3DownloadBytes:n.i18n.translate("xpack.infra.waffle.metricOptions.s3DownloadBytes",{defaultMessage:"downloads (bytes)"}),s3UploadBytes:n.i18n.translate("xpack.infra.waffle.metricOptions.s3UploadBytes",{defaultMessage:"uploads (bytes)"}),rdsConnections:n.i18n.translate("xpack.infra.waffle.metricOptions.rdsConnections",{defaultMessage:"connections"}),rdsQueriesExecuted:n.i18n.translate("xpack.infra.waffle.metricOptions.rdsQueriesExecuted",{defaultMessage:"queries executed"}),rdsActiveTransactions:n.i18n.translate("xpack.infra.waffle.metricOptions.rdsActiveTransactions",{defaultMessage:"active transactions"}),rdsLatency:n.i18n.translate("xpack.infra.waffle.metricOptions.rdsLatency",{defaultMessage:"latency"}),sqsMessagesVisible:n.i18n.translate("xpack.infra.waffle.metricOptions.sqsMessagesVisible",{defaultMessage:"messages available"}),sqsMessagesDelayed:n.i18n.translate("xpack.infra.waffle.metricOptions.sqsMessagesDelayed",{defaultMessage:"messages delayed"}),sqsMessagesSent:n.i18n.translate("xpack.infra.waffle.metricOptions.sqsMessagesSent",{defaultMessage:"messages added"}),sqsMessagesEmpty:n.i18n.translate("xpack.infra.waffle.metricOptions.sqsMessagesEmpty",{defaultMessage:"messages returned empty"}),sqsOldestMessage:n.i18n.translate("xpack.infra.waffle.metricOptions.sqsOldestMessage",{defaultMessage:"oldest message"})},i=Object(s.mapValues)(r,(e=>`${e[0].toUpperCase()}${e.slice(1)}`)),l=e=>{switch(e){case"cpu":return{text:i.CPUUsage,textLC:r.CPUUsage,value:"cpu"};case"memory":return{text:i.MemoryUsage,textLC:r.MemoryUsage,value:"memory"};case"rx":return{text:i.InboundTraffic,textLC:r.InboundTraffic,value:"rx"};case"tx":return{text:i.OutboundTraffic,textLC:r.OutboundTraffic,value:"tx"};case"logRate":return{text:i.LogRate,textLC:r.LogRate,value:"logRate"};case"load":return{text:i.Load,textLC:r.Load,value:"load"};case"count":return{text:i.Count,textLC:r.Count,value:"count"};case"diskIOReadBytes":return{text:i.DiskIOReadBytes,textLC:r.DiskIOReadBytes,value:"diskIOReadBytes"};case"diskIOWriteBytes":return{text:i.DiskIOWriteBytes,textLC:r.DiskIOWriteBytes,value:"diskIOWriteBytes"};case"s3BucketSize":return{text:i.s3BucketSize,textLC:r.s3BucketSize,value:"s3BucketSize"};case"s3TotalRequests":return{text:i.s3TotalRequests,textLC:r.s3TotalRequests,value:"s3TotalRequests"};case"s3NumberOfObjects":return{text:i.s3NumberOfObjects,textLC:r.s3NumberOfObjects,value:"s3NumberOfObjects"};case"s3DownloadBytes":return{text:i.s3DownloadBytes,textLC:r.s3DownloadBytes,value:"s3DownloadBytes"};case"s3UploadBytes":return{text:i.s3UploadBytes,textLC:r.s3UploadBytes,value:"s3UploadBytes"};case"rdsConnections":return{text:i.rdsConnections,textLC:r.rdsConnections,value:"rdsConnections"};case"rdsQueriesExecuted":return{text:i.rdsQueriesExecuted,textLC:r.rdsQueriesExecuted,value:"rdsQueriesExecuted"};case"rdsActiveTransactions":return{text:i.rdsActiveTransactions,textLC:r.rdsActiveTransactions,value:"rdsActiveTransactions"};case"rdsLatency":return{text:i.rdsLatency,textLC:r.rdsLatency,value:"rdsLatency"};case"sqsMessagesVisible":return{text:i.sqsMessagesVisible,textLC:r.sqsMessagesVisible,value:"sqsMessagesVisible"};case"sqsMessagesDelayed":return{text:i.sqsMessagesDelayed,textLC:r.sqsMessagesDelayed,value:"sqsMessagesDelayed"};case"sqsMessagesSent":return{text:i.sqsMessagesSent,textLC:r.sqsMessagesSent,value:"sqsMessagesSent"};case"sqsMessagesEmpty":return{text:i.sqsMessagesEmpty,textLC:r.sqsMessagesEmpty,value:"sqsMessagesEmpty"};case"sqsOldestMessage":return{text:i.sqsOldestMessage,textLC:r.sqsOldestMessage,value:"sqsOldestMessage"}}}},128:function(e,t){var a="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(a){var n=new Uint8Array(16);e.exports=function(){return a(n),n}}else{var s=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),s[t]=e>>>((3&t)<<3)&255;return s}}},129:function(e,t){for(var a=[],n=0;n<256;++n)a[n]=(n+256).toString(16).substr(1);e.exports=function(e,t){var n=t||0,s=a;return[s[e[n++]],s[e[n++]],s[e[n++]],s[e[n++]],"-",s[e[n++]],s[e[n++]],"-",s[e[n++]],s[e[n++]],"-",s[e[n++]],s[e[n++]],"-",s[e[n++]],s[e[n++]],s[e[n++]],s[e[n++]],s[e[n++]],s[e[n++]]].join("")}},133:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(18),s=a(19),r=a(24),i=a(2),l=a(17),o=a(79),c=a(72);function u(e,t,a,u,d,m,p,f,g=!0,b){b=b||{interval:"1m",to:m,from:m-12e5,lookbackSize:5};const{error:y,loading:h,response:v,makeRequest:E}=Object(o.a)("/api/metrics/snapshot","POST",JSON.stringify({metrics:t,groupBy:a,nodeType:u,timerange:b,filterQuery:e,sourceId:d,accountId:p,region:f,includeTimeseries:!0}),(e=>Object(r.pipe)(c.g.decode(e),Object(n.fold)(Object(l.c)(l.a),s.identity))));return Object(i.useEffect)((()=>{(async()=>{g&&await E()})()}),[E,g]),{error:y&&y.message||null,loading:h,nodes:v?v.nodes:[],interval:v?v.interval:"60s",reload:E}}},134:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(23),s=a(31),r=a(72),i=a(114),l=a(33);const o={count:{formatter:s.b.number,template:"{{value}}"},cpu:{formatter:s.b.percent,template:"{{value}}"},memory:{formatter:s.b.percent,template:"{{value}}"},rx:{formatter:s.b.bits,template:"{{value}}/s"},tx:{formatter:s.b.bits,template:"{{value}}/s"},logRate:{formatter:s.b.abbreviatedNumber,template:"{{value}}/s"},diskIOReadBytes:{formatter:s.b.bytes,template:"{{value}}/s"},diskIOWriteBytes:{formatter:s.b.bytes,template:"{{value}}/s"},s3BucketSize:{formatter:s.b.bytes,template:"{{value}}"},s3TotalRequests:{formatter:s.b.abbreviatedNumber,template:"{{value}}"},s3NumberOfObjects:{formatter:s.b.abbreviatedNumber,template:"{{value}}"},s3UploadBytes:{formatter:s.b.bytes,template:"{{value}}"},s3DownloadBytes:{formatter:s.b.bytes,template:"{{value}}"},sqsOldestMessage:{formatter:s.b.number,template:"{{value}} seconds"},rdsLatency:{formatter:s.b.number,template:"{{value}} ms"}},c=e=>t=>{if(r.d.is(e))return Object(i.a)(e)(t);const a=Object(n.get)(o,e.type,o.count);return null==t?"":Object(l.b)(a.formatter,a.template)(t)}},135:function(e,t,a){"use strict";a.d(t,"i",(function(){return p})),a.d(t,"d",(function(){return f})),a.d(t,"f",(function(){return g})),a.d(t,"j",(function(){return b})),a.d(t,"k",(function(){return y})),a.d(t,"h",(function(){return h})),a.d(t,"g",(function(){return v})),a.d(t,"a",(function(){return x})),a.d(t,"e",(function(){return k})),a.d(t,"c",(function(){return O})),a.d(t,"b",(function(){return w}));var n=a(2),s=a.n(n),r=a(50),i=a(49),l=a.n(i),o=a(1),c=a(12),u=a(16),d=a(23),m=a(11);const p={headerFormatter:e=>l()(e.value).format("Y-MM-DD HH:mm:ss")},f=20,g={s:o.i18n.translate("xpack.infra.alerts.timeLabels.seconds",{defaultMessage:"seconds"}),m:o.i18n.translate("xpack.infra.alerts.timeLabels.minutes",{defaultMessage:"minutes"}),h:o.i18n.translate("xpack.infra.alerts.timeLabels.hours",{defaultMessage:"hours"}),d:o.i18n.translate("xpack.infra.alerts.timeLabels.days",{defaultMessage:"days"})},b=(e,t)=>Object(n.useMemo)((()=>"number"==typeof e&&"number"==typeof t?Object(r.niceTimeFormatter)([e,t]):e=>`${e}`),[e,t]),y=m.a,h=(e,t=!1)=>{let a=null,n=null;const s=e.reduce(((e,t)=>(t.points.forEach((t=>{const a=e[t.timestamp]||[];e[t.timestamp]=[...a,t.value]})),e)),{});Object.values(s).forEach((e=>{const s=t?Object(d.sum)(e):Object(d.max)(e),r=Object(d.min)(e);s&&(!n||s>n)&&(n=s),r&&(!a||r<a)&&(a=r)}));const r=Object.keys(s).map(Number),i=Object(d.min)(r)||0,l=Object(d.max)(r)||0;return{yMin:a||0,yMax:n||0,xMin:i,xMax:l}},v=e=>e?r.DARK_THEME:r.LIGHT_THEME,E=({children:e})=>s.a.createElement("div",{style:{width:"100%",height:150,display:"flex",justifyContent:"center",alignItems:"center"}},e),x=({children:e})=>s.a.createElement("div",{style:{width:"100%",height:150}},e),k=()=>s.a.createElement(E,null,s.a.createElement(c.EuiText,{color:"subdued","data-test-subj":"noChartData"},s.a.createElement(u.FormattedMessage,{id:"xpack.infra.alerts.charts.noDataMessage",defaultMessage:"No chart data available"}))),O=()=>s.a.createElement(E,null,s.a.createElement(c.EuiText,{color:"subdued","data-test-subj":"loadingData"},s.a.createElement(u.FormattedMessage,{id:"xpack.infra.alerts.charts.loadingMessage",defaultMessage:"Loading"}))),w=()=>s.a.createElement(E,null,s.a.createElement(c.EuiText,{color:"subdued","data-test-subj":"chartErrorState"},s.a.createElement(u.FormattedMessage,{id:"xpack.infra.alerts.charts.errorMessage",defaultMessage:"Uh oh, something went wrong"})))},149:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(1);const s=n.i18n.translate("xpack.infra.groupByDisplayNames.availabilityZone",{defaultMessage:"Availability zone"}),r=n.i18n.translate("xpack.infra.groupByDisplayNames.machineType",{defaultMessage:"Machine type"}),i=e=>({"kubernetes.namespace":n.i18n.translate("xpack.infra.groupByDisplayNames.kubernetesNamespace",{defaultMessage:"Namespace"}),"kubernetes.node.name":n.i18n.translate("xpack.infra.groupByDisplayNames.kubernetesNodeName",{defaultMessage:"Node"}),"host.name":n.i18n.translate("xpack.infra.groupByDisplayNames.hostName",{defaultMessage:"Host"}),"cloud.availability_zone":s,"cloud.machine.type":r,"cloud.project.id":n.i18n.translate("xpack.infra.groupByDisplayNames.projectID",{defaultMessage:"Project ID"}),"cloud.provider":n.i18n.translate("xpack.infra.groupByDisplayNames.provider",{defaultMessage:"Cloud provider"}),"service.type":n.i18n.translate("xpack.infra.groupByDisplayNames.serviceType",{defaultMessage:"Service type"}),"aws.cloud.availability_zone":s,"aws.cloud.machine.type":r,"aws.tags":n.i18n.translate("xpack.infra.groupByDisplayNames.tags",{defaultMessage:"Tags"}),"aws.ec2.instance.image.id":n.i18n.translate("xpack.infra.groupByDisplayNames.image",{defaultMessage:"Image"}),"aws.ec2.instance.state.name":n.i18n.translate("xpack.infra.groupByDisplayNames.state.name",{defaultMessage:"State"}),"cloud.region":n.i18n.translate("xpack.infra.groupByDisplayNames.cloud.region",{defaultMessage:"Region"}),"aws.rds.db_instance.class":n.i18n.translate("xpack.infra.groupByDisplayNames.rds.db_instance.class",{defaultMessage:"Instance Class"}),"aws.rds.db_instance.status":n.i18n.translate("xpack.infra.groupByDisplayNames.rds.db_instance.status",{defaultMessage:"Status"})}[e]||e)},157:function(e,t,a){"use strict";a.d(t,"a",(function(){return f})),a.d(t,"b",(function(){return g}));var n=a(2),s=a.n(n),r=a(12),i=a(149),l=a(70),o=a(76),c=a(1),u=a(74),d=a(80);const m=e=>Object(u.b)(e).displayName,p=()=>{const{changeNodeType:e,changeGroupBy:t,changeMetric:a,changeAccount:i,changeRegion:l,changeCustomMetrics:p,nodeType:f}=Object(o.d)(),[g,b]=Object(n.useState)(!1),y=Object(n.useCallback)((()=>b(!1)),[]),h=Object(n.useCallback)((()=>b(!0)),[]),v=Object(n.useCallback)((n=>{y(),e(n),t([]),p([]),i(""),l("");const s=Object(u.b)(n);a({type:s.metrics.defaultSnapshot})}),[y,e,t,p,i,l,a]),E=Object(n.useCallback)((()=>v("host")),[v]),x=Object(n.useCallback)((()=>v("pod")),[v]),k=Object(n.useCallback)((()=>v("container")),[v]),O=Object(n.useCallback)((()=>v("awsEC2")),[v]),w=Object(n.useCallback)((()=>v("awsS3")),[v]),C=Object(n.useCallback)((()=>v("awsRDS")),[v]),M=Object(n.useCallback)((()=>v("awsSQS")),[v]),j=Object(n.useMemo)((()=>[{id:"firstPanel",items:[{"data-test-subj":"goToHost",name:m("host"),onClick:E},{"data-test-subj":"goToPods",name:m("pod"),onClick:x},{"data-test-subj":"goToDocker",name:m("container"),onClick:k},{name:"AWS",panel:"awsPanel"}]},{id:"awsPanel",title:"AWS",items:[{name:m("awsEC2"),onClick:O},{name:m("awsS3"),onClick:w},{name:m("awsRDS"),onClick:C},{name:m("awsSQS"),onClick:M}]}]),[O,C,w,M,k,E,x]),T=Object(n.useMemo)((()=>m(f)),[f]),S=s.a.createElement(d.a,{"data-test-subj":"openInventorySwitcher",onClick:h,label:c.i18n.translate("xpack.infra.waffle.showLabel",{defaultMessage:"Show"})},T);return s.a.createElement(r.EuiPopover,{id:"contextMenu",button:S,isOpen:g,closePopover:y,panelPaddingSize:"none",anchorPosition:"downLeft"},s.a.createElement(r.EuiContextMenu,{initialPanelId:"firstPanel",panels:j}))},f=e=>{const{changeMetric:t,changeGroupBy:a,changeCustomOptions:n,changeAccount:i,changeRegion:c,changeSort:u,customOptions:d,groupBy:m,metric:f,nodeType:g,accountId:b,view:y,region:h,legend:v,sort:E,customMetrics:x,changeCustomMetrics:k}=Object(o.d)(),{createDerivedIndexPattern:O}=Object(l.c)();return s.a.createElement(r.EuiFlexGroup,{responsive:!1,wrap:!0,gutterSize:"m"},s.a.createElement(r.EuiFlexItem,{grow:!1},s.a.createElement(p,null)),e.children({createDerivedIndexPattern:O,changeMetric:t,changeGroupBy:a,changeAccount:i,changeRegion:c,changeCustomOptions:n,changeSort:u,customOptions:d,groupBy:m,sort:E,view:y,metric:f,nodeType:g,region:h,accountId:b,legend:v,customMetrics:x,changeCustomMetrics:k}))},g=e=>({text:Object(i.a)(e),field:e})},162:function(e,t,a){var n,s,r=a(128),i=a(129),l=0,o=0;e.exports=function(e,t,a){var c=t&&a||0,u=t||[],d=(e=e||{}).node||n,m=void 0!==e.clockseq?e.clockseq:s;if(null==d||null==m){var p=r();null==d&&(d=n=[1|p[0],p[1],p[2],p[3],p[4],p[5]]),null==m&&(m=s=16383&(p[6]<<8|p[7]))}var f=void 0!==e.msecs?e.msecs:(new Date).getTime(),g=void 0!==e.nsecs?e.nsecs:o+1,b=f-l+(g-o)/1e4;if(b<0&&void 0===e.clockseq&&(m=m+1&16383),(b<0||f>l)&&void 0===e.nsecs&&(g=0),g>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");l=f,o=g,s=m;var y=(1e4*(268435455&(f+=122192928e5))+g)%4294967296;u[c++]=y>>>24&255,u[c++]=y>>>16&255,u[c++]=y>>>8&255,u[c++]=255&y;var h=f/4294967296*1e4&268435455;u[c++]=h>>>8&255,u[c++]=255&h,u[c++]=h>>>24&15|16,u[c++]=h>>>16&255,u[c++]=m>>>8|128,u[c++]=255&m;for(var v=0;v<6;++v)u[c+v]=d[v];return t||i(u)}},163:function(e,t,a){var n=a(128),s=a(129);e.exports=function(e,t,a){var r=t&&a||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var i=(e=e||{}).random||(e.rng||n)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t)for(var l=0;l<16;++l)t[r+l]=i[l];return t||s(i)}},176:function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return u}));var n=a(29),s=a.n(n),r=a(2),i=a.n(r),l=a(77);const o=["cpu","memory","load","rx","tx","logRate"],c=["cloud.availability_zone","cloud.machine.type","cloud.project.id","cloud.provider","service.type"],u=e=>i.a.createElement(l.a,s()({},e,{metricTypes:o,groupByFields:c}))},177:function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return u}));var n=a(29),s=a.n(n),r=a(2),i=a.n(r),l=a(77);const o=["cpu","memory","rx","tx"],c=["host.name","cloud.availability_zone","cloud.machine.type","cloud.project.id","cloud.provider","service.type"],u=e=>i.a.createElement(l.a,s()({},e,{metricTypes:o,groupByFields:c}))},178:function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return u}));var n=a(29),s=a.n(n),r=a(2),i=a.n(r),l=a(77);const o=["cpu","memory","rx","tx"],c=["kubernetes.namespace","kubernetes.node.name","service.type"],u=e=>i.a.createElement(l.a,s()({},e,{metricTypes:o,groupByFields:c}))},179:function(e,t,a){"use strict";a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return d}));var n=a(29),s=a.n(n),r=a(2),i=a.n(r),l=a(77),o=a(93);const c=["cpu","rx","tx","diskIOReadBytes","diskIOWriteBytes"],u=["cloud.availability_zone","cloud.machine.type","aws.ec2.instance.image.id","aws.ec2.instance.state.name"],d=e=>i.a.createElement(i.a.Fragment,null,i.a.createElement(o.a,e),i.a.createElement(l.a,s()({},e,{metricTypes:c,groupByFields:u})))},180:function(e,t,a){"use strict";a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return d}));var n=a(29),s=a.n(n),r=a(2),i=a.n(r),l=a(77),o=a(93);const c=["s3BucketSize","s3NumberOfObjects","s3TotalRequests","s3DownloadBytes","s3UploadBytes"],u=["cloud.region"],d=e=>i.a.createElement(i.a.Fragment,null,i.a.createElement(o.a,e),i.a.createElement(l.a,s()({},e,{metricTypes:c,groupByFields:u})))},181:function(e,t,a){"use strict";a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return d}));var n=a(29),s=a.n(n),r=a(2),i=a.n(r),l=a(77),o=a(93);const c=["cpu","rdsConnections","rdsQueriesExecuted","rdsActiveTransactions","rdsLatency"],u=["cloud.availability_zone","aws.rds.db_instance.class","aws.rds.db_instance.status"],d=e=>i.a.createElement(i.a.Fragment,null,i.a.createElement(o.a,e),i.a.createElement(l.a,s()({},e,{metricTypes:c,groupByFields:u})))},182:function(e,t,a){"use strict";a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return d}));var n=a(29),s=a.n(n),r=a(2),i=a.n(r),l=a(77),o=a(93);const c=["sqsMessagesVisible","sqsMessagesDelayed","sqsMessagesSent","sqsMessagesEmpty","sqsOldestMessage"],u=["cloud.region"],d=e=>i.a.createElement(i.a.Fragment,null,i.a.createElement(o.a,e),i.a.createElement(l.a,s()({},e,{metricTypes:c,groupByFields:u})))},183:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(50),s=a(23),r=a(2),i=a.n(r),l=a(7),o=a(78);const c=.3,u=({threshold:e,sortedThresholds:t,comparator:a,color:r,id:u,firstTimestamp:d,lastTimestamp:m,domain:p})=>{if(!a||!e)return null;const f=[l.b.GT,l.b.GT_OR_EQ].includes(a),g=[l.b.LT,l.b.LT_OR_EQ].includes(a);return i.a.createElement(i.a.Fragment,null,i.a.createElement(n.LineAnnotation,{id:`${u}-thresholds`,domainType:n.AnnotationDomainType.YDomain,"data-test-subj":"threshold-line",dataValues:t.map((e=>({dataValue:e}))),style:{line:{strokeWidth:2,stroke:Object(o.b)(r),opacity:1}}}),2===t.length&&a===l.b.BETWEEN?i.a.createElement(i.a.Fragment,null,i.a.createElement(n.RectAnnotation,{id:`${u}-lower-threshold`,"data-test-subj":"between-rect",style:{fill:Object(o.b)(r),opacity:c},dataValues:[{coordinates:{x0:d,x1:m,y0:Object(s.first)(e),y1:Object(s.last)(e)}}]})):null,2===t.length&&a===l.b.OUTSIDE_RANGE?i.a.createElement(i.a.Fragment,null,i.a.createElement(n.RectAnnotation,{id:`${u}-lower-threshold`,"data-test-subj":"outside-range-lower-rect",style:{fill:Object(o.b)(r),opacity:c},dataValues:[{coordinates:{x0:d,x1:m,y0:p.min,y1:Object(s.first)(e)}}]}),i.a.createElement(n.RectAnnotation,{id:`${u}-upper-threshold`,"data-test-subj":"outside-range-upper-rect",style:{fill:Object(o.b)(r),opacity:c},dataValues:[{coordinates:{x0:d,x1:m,y0:Object(s.last)(e),y1:p.max}}]})):null,g&&null!=Object(s.first)(e)?i.a.createElement(n.RectAnnotation,{id:`${u}-upper-threshold`,"data-test-subj":"below-rect",style:{fill:Object(o.b)(r),opacity:c},dataValues:[{coordinates:{x0:d,x1:m,y0:p.min,y1:Object(s.first)(e)}}]}):null,f&&null!=Object(s.first)(e)?i.a.createElement(n.RectAnnotation,{id:`${u}-upper-threshold`,"data-test-subj":"above-rect",style:{fill:Object(o.b)(r),opacity:c},dataValues:[{coordinates:{x0:d,x1:m,y0:Object(s.first)(e),y1:p.max}}]}):null)}},289:function(e,t,a){"use strict";a.r(t),a.d(t,"defaultExpression",(function(){return J})),a.d(t,"Expressions",(function(){return Y})),a.d(t,"ExpressionRow",(function(){return ae})),a.d(t,"nodeTypes",(function(){return re}));var n=a(2),s=a.n(n),r=a(12),i=a(1),l=a(16),o=a(23),c=a(15),u=a(56),d=a(7),m=a(72),p=a(74),f=a(179),g=a(181),b=a(180),y=a(182),h=a(177),v=a(176),E=a(178),x=a(75),k=a(117),O=a(107),w=a(13),C=a(148),M=a(105),j=a(50),T=a(49),S=a.n(T),B=a(78),F=a(133),I=a(76),L=a(134),P=a(116),D=a(147),R=a(115),z=a(82),A=a(135),_=a(183);const N=({expression:e,filterQuery:t,nodeType:a,sourceId:i})=>{var c,u,d,m,p;const f=Object(n.useMemo)((()=>({interval:`${e.timeSize||1}${e.timeUnit}`,from:S()().subtract(20*(e.timeSize||1),e.timeUnit).valueOf(),to:S()().valueOf(),forceInterval:!0,ignoreLookback:!0})),[e.timeSize,e.timeUnit]),g=e=>({...e,type:"custom"}),b=Object(I.d)(),{loading:y,nodes:h}=Object(F.a)(t,"custom"===e.metric?[g(e.customMetric)]:[{type:e.metric}],[],a,i,0,b.accountId,b.region,!0,f),{uiSettings:v}=Object(w.b)().services,E={field:e.metric,aggregation:"avg",color:B.a.color0},x=(null==v?void 0:v.get("theme:darkMode"))||!1,k=Object(n.useMemo)((()=>{var e,t,a,n;const s=null===(e=h[0])||void 0===e||null===(t=e.metrics[0])||void 0===t?void 0:t.timeseries,r=null===(a=Object(o.first)(null==s?void 0:s.rows))||void 0===a?void 0:a.timestamp,i=null===(n=Object(o.last)(null==s?void 0:s.rows))||void 0===n?void 0:n.timestamp;return null==r||null==i?e=>`${e}`:Object(j.niceTimeFormatter)([r,i])}),[h]),O=Object(n.useCallback)(Object(L.a)("custom"===e.metric?g(e.customMetric):{type:e.metric}),[e.metric]);if(y||!h)return s.a.createElement(A.c,null);const C=t=>q(e.metric,t),M=e.threshold.map(C),T=null!==(c=null===(u=e.warningThreshold)||void 0===u?void 0:u.map(C))&&void 0!==c?c:[],N=M.slice().sort(),U=T.slice().sort(),W=[...N,...U].sort(),G=null===(d=h[0])||void 0===d||null===(m=d.metrics[0])||void 0===m?void 0:m.timeseries;if(!G||!G.rows||0===G.rows.length)return s.a.createElement(A.e,null);const Q={...G,id:null===(p=h[0])||void 0===p?void 0:p.name,rows:G.rows.map((e=>{const t={...e};return W.forEach(((e,a)=>{t[Object(D.a)(E,`threshold_${a}`)]=e})),t}))},V=Object(o.first)(G.rows).timestamp,$=Object(o.last)(G.rows).timestamp,H=Object(P.a)(Q,[E],!1),K={max:1.1*Math.max(H.max,Object(o.last)(W)||H.max),min:.9*Math.min(H.min,Object(o.first)(W)||H.min)};K.min===Object(o.first)(M)&&(K.min=.9*K.min);const{timeSize:J,timeUnit:Y}=e,Z=A.f[Y];return s.a.createElement(s.a.Fragment,null,s.a.createElement(A.a,null,s.a.createElement(j.Chart,null,s.a.createElement(R.a,{type:z.b.bar,metric:E,id:"0",series:Q,stack:!1}),s.a.createElement(_.a,{comparator:e.comparator,threshold:M,sortedThresholds:N,color:B.a.color1,id:"critical",firstTimestamp:V,lastTimestamp:$,domain:K}),e.warningComparator&&e.warningThreshold&&s.a.createElement(_.a,{comparator:e.warningComparator,threshold:T,sortedThresholds:U,color:B.a.color5,id:"warning",firstTimestamp:V,lastTimestamp:$,domain:K}),s.a.createElement(j.Axis,{id:"timestamp",position:j.Position.Bottom,showOverlappingTicks:!0,tickFormat:k}),s.a.createElement(j.Axis,{id:"values",position:j.Position.Left,tickFormat:O,domain:K}),s.a.createElement(j.Settings,{tooltip:A.i,theme:Object(A.g)(x)}))),s.a.createElement("div",{style:{textAlign:"center"}},"ALL"!==Q.id?s.a.createElement(r.EuiText,{size:"xs",color:"subdued"},s.a.createElement(l.FormattedMessage,{id:"xpack.infra.metrics.alerts.dataTimeRangeLabelWithGrouping",defaultMessage:"Last {lookback} {timeLabel} of data for {id}",values:{id:Q.id,timeLabel:Z,lookback:20*J}})):s.a.createElement(r.EuiText,{size:"xs",color:"subdued"},s.a.createElement(l.FormattedMessage,{id:"xpack.infra.metrics.alerts.dataTimeRangeLabel",defaultMessage:"Last {lookback} {timeLabel}",values:{timeLabel:Z,lookback:20*J}}))))},q=(e,t)=>U[e]?U[e](t):t,U={cpu:e=>Number(e)/100,memory:e=>Number(e)/100};var W=a(87);const G={avg:i.i18n.translate("xpack.infra.waffle.customMetrics.aggregationLables.avg",{defaultMessage:"Average"}),max:i.i18n.translate("xpack.infra.waffle.customMetrics.aggregationLables.max",{defaultMessage:"Max"}),min:i.i18n.translate("xpack.infra.waffle.customMetrics.aggregationLables.min",{defaultMessage:"Min"}),rate:i.i18n.translate("xpack.infra.waffle.customMetrics.aggregationLables.rate",{defaultMessage:"Rate"})},Q=m.b.map((e=>({text:G[e],value:e}))),V=({metric:e,metrics:t,customMetric:a,fields:c,errors:u,onChange:d,onChangeCustom:p,popupPosition:f})=>{var g;const[b,y]=Object(n.useState)(!1),[h,v]=Object(n.useState)("custom"===(null==e?void 0:e.value)),[E,x]=Object(n.useState)(null==e?void 0:e.value),[k,O]=Object(n.useState)(null==a?void 0:a.label),w={text:i.i18n.translate("xpack.infra.metrics.alertFlyout.expression.metric.selectFieldLabel",{defaultMessage:"Select a metric"}),value:""},C=Object(n.useMemo)((()=>c.filter((e=>e.aggregatable&&"number"===e.type&&!((null==a?void 0:a.field)===e.name))).map((e=>({label:e.name})))),[c,null==a?void 0:a.field]),M=Object(n.useMemo)((()=>h?(null==a?void 0:a.field)&&Object(W.a)(a):(null==e?void 0:e.text)||w.text),[h,e,a,w]),j=Object(n.useCallback)((e=>{"metric-popover-custom"===e?(v(!0),d("custom")):(v(!1),d(E))}),[v,d,E]),T=Object(n.useCallback)((e=>{const t=e.target.value,n=m.c.is(t)?t:"avg",s={...a,aggregation:n};m.d.is(s)&&p(s)}),[a,p]),S=Object(n.useCallback)((e=>{const t={...a,field:e[0].label};m.d.is(t)&&p(t)}),[a,p]),B=Object(o.debounce)(p,500),F=Object(n.useCallback)((e=>{O(e.target.value);const t={...a,label:e.target.value};m.d.is(t)&&B(t)}),[a,B]),I=t.map((e=>({label:e.text,value:e.value})),[]);return s.a.createElement(r.EuiPopover,{id:"metricPopover",button:s.a.createElement(r.EuiExpression,{description:i.i18n.translate("xpack.infra.metrics.alertFlyout.expression.metric.whenLabel",{defaultMessage:"When"}),value:M,isActive:Boolean(b||u.metric&&u.metric.length>0),onClick:()=>{y(!0)},color:null!==(g=u.metric)&&void 0!==g&&g.length?"danger":"success"}),isOpen:b,closePopover:()=>{y(!1)},anchorPosition:null!=f?f:"downRight",zIndex:8e3},s.a.createElement("div",{style:{width:620}},s.a.createElement($,{onClose:()=>y(!1)},s.a.createElement(l.FormattedMessage,{id:"xpack.infra.metrics.alertFlyout.expression.metric.popoverTitle",defaultMessage:"Metric"})),s.a.createElement(r.EuiButtonGroup,{isFullWidth:!0,buttonSize:"compressed",legend:"Metric type",options:[{id:"metric-popover-default",label:"Default metric"},{id:"metric-popover-custom",label:"Custom metric"}],idSelected:h?"metric-popover-custom":"metric-popover-default",onChange:j}),s.a.createElement(r.EuiSpacer,{size:"m"}),h?s.a.createElement(s.a.Fragment,null,s.a.createElement(r.EuiFormRow,{fullWidth:!0},s.a.createElement(r.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},s.a.createElement(r.EuiFlexItem,{grow:!1},s.a.createElement(r.EuiSelect,{onChange:T,value:(null==a?void 0:a.aggregation)||"avg",options:Q,fullWidth:!0})),s.a.createElement(r.EuiFlexItem,{grow:!1},s.a.createElement(r.EuiText,{color:"subdued"},s.a.createElement("span",null,i.i18n.translate("xpack.infra.waffle.customMetrics.of",{defaultMessage:"of"})))),s.a.createElement(r.EuiFlexItem,null,s.a.createElement(r.EuiComboBox,{fullWidth:!0,placeholder:i.i18n.translate("xpack.infra.waffle.customMetrics.fieldPlaceholder",{defaultMessage:"Select a field"}),singleSelection:{asPlainText:!0},selectedOptions:null!=a&&a.field?[{label:a.field}]:[],options:C,onChange:S,isClearable:!1,isInvalid:u.metric.length>0})))),s.a.createElement(r.EuiFormRow,{label:i.i18n.translate("xpack.infra.waffle.alerting.customMetrics.labelLabel",{defaultMessage:"Metric name (optional)"}),display:"rowCompressed",fullWidth:!0,helpText:i.i18n.translate("xpack.infra.waffle.alerting.customMetrics.helpText",{defaultMessage:'Choose a name to help identify your custom metric. Defaults to "<function> of <field name>".'})},s.a.createElement(r.EuiFieldText,{name:"label",placeholder:i.i18n.translate("xpack.infra.waffle.customMetrics.labelPlaceholder",{defaultMessage:'Choose a name to appear in the "Metric" dropdown'}),value:k,fullWidth:!0,onChange:F}))):s.a.createElement(r.EuiFormRow,{fullWidth:!0},s.a.createElement(r.EuiFlexGroup,null,s.a.createElement(r.EuiFlexItem,{className:"actOf__metricContainer"},s.a.createElement(r.EuiComboBox,{fullWidth:!0,singleSelection:{asPlainText:!0},"data-test-subj":"availablefieldsOptionsComboBox",isInvalid:u.metric.length>0,placeholder:w.text,options:I,noSuggestions:!I.length,selectedOptions:e?I.filter((t=>t.value===e.value)):[],renderOption:e=>e.label,onChange:e=>{e.length>0?(d(e[0].value),x(e[0].value)):d()}}))))))},$=({children:e,onClose:t})=>s.a.createElement(r.EuiPopoverTitle,null,s.a.createElement(r.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},s.a.createElement(r.EuiFlexItem,null,e),s.a.createElement(r.EuiFlexItem,{grow:!1},s.a.createElement(r.EuiButtonIcon,{iconType:"cross",color:"danger","aria-label":i.i18n.translate("xpack.infra.metrics.expressionItems.components.closablePopoverTitle.closeLabel",{defaultMessage:"Close"}),onClick:()=>t()})))),H=({value:e,options:t,onChange:a,popupPosition:o})=>{const[c,u]=Object(n.useState)(!1);return s.a.createElement(r.EuiPopover,{button:s.a.createElement(r.EuiExpression,{"data-test-subj":"nodeTypeExpression",description:i.i18n.translate("xpack.infra.metrics.alertFlyout.expression.for.descriptionLabel",{defaultMessage:"For"}),value:t[e].text,isActive:c,onClick:()=>{u(!0)}}),isOpen:c,closePopover:()=>{u(!1)},ownFocus:!0,anchorPosition:null!=o?o:"downLeft"},s.a.createElement("div",null,s.a.createElement(K,{onClose:()=>u(!1)},s.a.createElement(l.FormattedMessage,{id:"xpack.infra.metrics.alertFlyout.expression.for.popoverTitle",defaultMessage:"Node Type"})),s.a.createElement(r.EuiSelect,{"data-test-subj":"forExpressionSelect",value:e,fullWidth:!0,onChange:e=>{a(e.target.value),u(!1)},options:Object.values(t).map((e=>e))})))},K=({children:e,onClose:t})=>s.a.createElement(r.EuiPopoverTitle,null,s.a.createElement(r.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},s.a.createElement(r.EuiFlexItem,null,e),s.a.createElement(r.EuiFlexItem,{grow:!1},s.a.createElement(r.EuiButtonIcon,{iconType:"cross",color:"danger","aria-label":i.i18n.translate("xpack.infra.metrics.expressionItems.components.closablePopoverTitle.closeLabel",{defaultMessage:"Close"}),onClick:()=>t()})))),J={metric:"cpu",comparator:d.b.GT,threshold:[],timeSize:1,timeUnit:"m",customMetric:{type:"custom",id:"alert-custom-metric",field:"",aggregation:"avg"}},Y=e=>{const{http:t,notifications:a}=Object(w.b)().services,{setRuleParams:c,ruleParams:p,errors:f,metadata:g}=e,{source:b,createDerivedIndexPattern:y}=Object(O.a)({sourceId:"default",fetch:t.fetch,toastWarning:a.toasts.addWarning}),[h,v]=Object(n.useState)(1),[E,x]=Object(n.useState)("m"),k=Object(n.useMemo)((()=>y()),[y]),j=Object(n.useCallback)(((e,t)=>{const a=p.criteria?p.criteria.slice():[];a[e]=t,c("criteria",a)}),[c,p.criteria]),T=Object(n.useCallback)((()=>{var e;const t=(null===(e=p.criteria)||void 0===e?void 0:e.slice())||[];t.push({...J,timeSize:null!=h?h:J.timeSize,timeUnit:null!=E?E:J.timeUnit}),c("criteria",t)}),[c,p.criteria,h,E]),S=Object(n.useCallback)((e=>{const t=p.criteria.slice();t.length>1&&(t.splice(e,1),c("criteria",t))}),[c,p.criteria]),B=Object(n.useCallback)((e=>{c("filterQueryText",e||"");try{c("filterQuery",Object(M.a)(e,k,!1)||"")}catch(e){c("filterQuery",d.f)}}),[k,c]),F=Object(n.useCallback)(Object(o.debounce)(B,500),[B]),I=Object(n.useMemo)((()=>({aggField:[],timeSizeUnit:[],timeWindowSize:[]})),[]),L=Object(n.useCallback)((e=>{const t=p.criteria.map((t=>({...t,timeSize:e})));v(e||void 0),c("criteria",t)}),[p.criteria,c]),P=Object(n.useCallback)((e=>{const t=p.criteria.map((t=>({...t,timeUnit:e})));x(e),c("criteria",t)}),[p.criteria,c]),D=Object(n.useCallback)((e=>{c("nodeType",e)}),[c]),R=Object(n.useCallback)((e=>B(e.target.value)),[B]),z=Object(n.useCallback)((()=>{const e=g;e&&e.options?c("criteria",[{...J,metric:e.options.metric.type,customMetric:m.d.is(e.options.metric)?e.options.metric:J.customMetric}]):c("criteria",[J])}),[g,c]),A=Object(n.useCallback)((()=>{const e=g;e&&e.filter&&(c("filterQueryText",e.filter),c("filterQuery",Object(M.a)(e.filter,k)||""))}),[g,k,c]);return Object(n.useEffect)((()=>{const e=g;p.nodeType||(e&&e.nodeType?c("nodeType",e.nodeType):c("nodeType","host")),p.criteria&&p.criteria.length?(v(p.criteria[0].timeSize),x(p.criteria[0].timeUnit)):z(),p.filterQuery||A(),p.sourceId||c("sourceId",(null==b?void 0:b.id)||"default")}),[g,k,J,b]),s.a.createElement(s.a.Fragment,null,s.a.createElement(r.EuiSpacer,{size:"m"}),s.a.createElement(r.EuiText,{size:"xs"},s.a.createElement("h4",null,s.a.createElement(l.FormattedMessage,{id:"xpack.infra.metrics.alertFlyout.conditions",defaultMessage:"Conditions"}))),s.a.createElement(ee,null,s.a.createElement(X,null,s.a.createElement(Z,null,s.a.createElement(H,{options:re,value:p.nodeType||"host",onChange:D})))),s.a.createElement(r.EuiSpacer,{size:"xs"}),p.criteria&&p.criteria.map(((e,t)=>s.a.createElement(ae,{nodeType:p.nodeType,canDelete:p.criteria.length>1,remove:S,addExpression:T,key:t,expressionId:t,setRuleParams:j,errors:f[t]||I,expression:e||{},fields:k.fields},s.a.createElement(N,{expression:e,filterQuery:p.filterQuery,nodeType:p.nodeType,sourceId:p.sourceId,"data-test-subj":"preview-chart"})))),s.a.createElement(Z,null,s.a.createElement(u.ForLastExpression,{timeWindowSize:h,timeWindowUnit:E,errors:I,onChangeWindowSize:L,onChangeWindowUnit:P})),s.a.createElement("div",null,s.a.createElement(r.EuiButtonEmpty,{color:"primary",iconSide:"left",flush:"left",iconType:"plusInCircleFilled",onClick:T},s.a.createElement(l.FormattedMessage,{id:"xpack.infra.metrics.alertFlyout.addCondition",defaultMessage:"Add condition"}))),s.a.createElement(r.EuiSpacer,{size:"m"}),s.a.createElement(r.EuiCheckbox,{id:"metrics-alert-no-data-toggle",label:s.a.createElement(s.a.Fragment,null,i.i18n.translate("xpack.infra.metrics.alertFlyout.alertOnNoData",{defaultMessage:"Alert me if there's no data"})," ",s.a.createElement(r.EuiToolTip,{content:i.i18n.translate("xpack.infra.metrics.alertFlyout.noDataHelpText",{defaultMessage:"Enable this to trigger the action if the metric(s) do not report any data over the expected time period, or if the alert fails to query Elasticsearch"})},s.a.createElement(r.EuiIcon,{type:"questionInCircle",color:"subdued"}))),checked:p.alertOnNoData,onChange:e=>c("alertOnNoData",e.target.checked)}),s.a.createElement(r.EuiSpacer,{size:"m"}),s.a.createElement(r.EuiFormRow,{label:i.i18n.translate("xpack.infra.metrics.alertFlyout.filterLabel",{defaultMessage:"Filter (optional)"}),helpText:i.i18n.translate("xpack.infra.metrics.alertFlyout.filterHelpText",{defaultMessage:"Use a KQL expression to limit the scope of your alert trigger."}),fullWidth:!0,display:"rowCompressed"},g&&s.a.createElement(C.a,{derivedIndexPattern:k,onSubmit:B,onChange:F,value:p.filterQueryText})||s.a.createElement(r.EuiFieldSearch,{onChange:R,value:p.filterQueryText,fullWidth:!0})),s.a.createElement(r.EuiSpacer,{size:"m"}))};t.default=Y;const Z=c.euiStyled.div`
  margin-left: 28px;
`,X=Object(c.euiStyled)(r.EuiFlexGroup)`
  display: flex;
  flex-wrap: wrap;
  margin: 0 -4px;
`,ee=c.euiStyled.div`
  padding: 0 4px;
`,te=Object(c.euiStyled)(r.EuiHealth)`
  margin-left: 4px;
`,ae=e=>{var t,a,c;const[u,p]=Object(n.useState)(!0),O=Object(n.useCallback)((()=>p(!u)),[u]),{children:w,setRuleParams:C,expression:M,errors:j,expressionId:T,remove:S,canDelete:B,fields:F}=e,{metric:I,comparator:L=d.b.GT,threshold:P=[],customMetric:D,warningThreshold:R=[],warningComparator:z}=M,[A,_]=Object(n.useState)(Boolean(null==R?void 0:R.length)),N=Object(n.useCallback)((e=>{const t=x.f.is(e)?e:Boolean(e)?"custom":void 0,a={...M,metric:t};C(T,a)}),[T,M,C]),q=Object(n.useCallback)((e=>{m.d.is(e)&&C(T,{...M,customMetric:e})}),[T,M,C]),U=Object(n.useCallback)((e=>{C(T,{...M,comparator:e})}),[T,M,C]),W=Object(n.useCallback)((e=>{C(T,{...M,warningComparator:e})}),[T,M,C]),G=Object(n.useCallback)((e=>{e.join()!==M.threshold.join()&&C(T,{...M,threshold:e})}),[T,M,C]),Q=Object(n.useCallback)((e=>{var t;e.join()!==(null===(t=M.warningThreshold)||void 0===t?void 0:t.join())&&C(T,{...M,warningThreshold:e})}),[T,M,C]),$=Object(n.useCallback)((()=>{A?(_(!1),C(T,Object(o.omit)(M,"warningComparator","warningThreshold"))):(_(!0),C(T,{...M,warningComparator:L,warningThreshold:[]}))}),[A,_,C,L,M,T]),H=s.a.createElement(ne,{comparator:L,threshold:P,updateComparator:U,updateThreshold:G,errors:null!==(t=j.critical)&&void 0!==t?t:{},metric:I}),K=A&&s.a.createElement(ne,{comparator:z||L,threshold:R,updateComparator:W,updateThreshold:Q,errors:null!==(a=j.warning)&&void 0!==a?a:{},metric:I}),J=Object(n.useMemo)((()=>{let t=v.b;switch(e.nodeType){case"awsEC2":t=f.b;break;case"awsRDS":t=g.b;break;case"awsS3":t=b.b;break;case"awsSQS":t=y.b;break;case"host":t=v.b;break;case"pod":t=E.b;break;case"container":t=h.b}return t.map(k.a)}),[e.nodeType]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(r.EuiFlexGroup,{gutterSize:"xs"},s.a.createElement(r.EuiFlexItem,{grow:!1},s.a.createElement(r.EuiButtonIcon,{iconType:u?"arrowDown":"arrowRight",onClick:O,"aria-label":i.i18n.translate("xpack.infra.metrics.alertFlyout.expandRowLabel",{defaultMessage:"Expand row."})})),s.a.createElement(r.EuiFlexItem,{grow:!0},s.a.createElement(X,null,s.a.createElement(ee,null,s.a.createElement(V,{metric:{value:I,text:(null===(c=J.find((e=>(null==e?void 0:e.value)===I)))||void 0===c?void 0:c.text)||""},metrics:J.filter((e=>void 0!==e&&void 0!==e.value)),onChange:N,onChangeCustom:q,errors:j,customMetric:D,fields:F})),!A&&H),A&&s.a.createElement(s.a.Fragment,null,s.a.createElement(X,null,H,s.a.createElement(te,{color:"danger"},s.a.createElement(l.FormattedMessage,{id:"xpack.infra.metrics.alertFlyout.criticalThreshold",defaultMessage:"Alert"}))),s.a.createElement(X,null,K,s.a.createElement(te,{color:"warning"},s.a.createElement(l.FormattedMessage,{id:"xpack.infra.metrics.alertFlyout.warningThreshold",defaultMessage:"Warning"})),s.a.createElement(r.EuiButtonIcon,{"aria-label":i.i18n.translate("xpack.infra.metrics.alertFlyout.removeWarningThreshold",{defaultMessage:"Remove warningThreshold"}),iconSize:"s",color:"text",iconType:"crossInACircleFilled",onClick:$}))),!A&&s.a.createElement(s.a.Fragment,null," ",s.a.createElement(r.EuiSpacer,{size:"xs"}),s.a.createElement(X,null,s.a.createElement(r.EuiButtonEmpty,{color:"primary",flush:"left",size:"xs",iconType:"plusInCircleFilled",onClick:$},s.a.createElement(l.FormattedMessage,{id:"xpack.infra.metrics.alertFlyout.addWarningThreshold",defaultMessage:"Add warning threshold"}))))),B&&s.a.createElement(r.EuiFlexItem,{grow:!1},s.a.createElement(r.EuiButtonIcon,{"aria-label":i.i18n.translate("xpack.infra.metrics.alertFlyout.removeCondition",{defaultMessage:"Remove condition"}),color:"danger",iconType:"trash",onClick:()=>S(T)}))),u?s.a.createElement("div",{style:{padding:"0 0 0 28px"}},w):null,s.a.createElement(r.EuiSpacer,{size:"s"}))},ne=({updateComparator:e,updateThreshold:t,threshold:a,metric:n,comparator:i,errors:l})=>{var o;return s.a.createElement(s.a.Fragment,null,s.a.createElement(ee,null,s.a.createElement(u.ThresholdExpression,{thresholdComparator:i||d.b.GT,threshold:a,onChangeSelectedThresholdComparator:e,onChangeSelectedThreshold:t,errors:l})),n&&s.a.createElement("div",{style:{alignSelf:"center"}},s.a.createElement(r.EuiText,{size:"s"},(null===(o=ie[n])||void 0===o?void 0:o.label)||"")))},se=e=>Object(p.b)(e).displayName,re={host:{text:se("host"),value:"host"},pod:{text:se("pod"),value:"pod"},container:{text:se("container"),value:"container"},awsEC2:{text:se("awsEC2"),value:"awsEC2"},awsS3:{text:se("awsS3"),value:"awsS3"},awsRDS:{text:se("awsRDS"),value:"awsRDS"},awsSQS:{text:se("awsSQS"),value:"awsSQS"}},ie={count:{label:""},cpu:{label:"%"},memory:{label:"%"},rx:{label:"bits/s"},tx:{label:"bits/s"},logRate:{label:"/s"},diskIOReadBytes:{label:"bytes/s"},diskIOWriteBytes:{label:"bytes/s"},s3BucketSize:{label:"bytes"},s3TotalRequests:{label:""},s3NumberOfObjects:{label:""},s3UploadBytes:{label:"bytes"},s3DownloadBytes:{label:"bytes"},sqsOldestMessage:{label:"seconds"},rdsLatency:{label:"ms"},custom:{label:""}}},70:function(e,t,a){"use strict";a.d(t,"a",(function(){return u})),a.d(t,"b",(function(){return d})),a.d(t,"c",(function(){return m}));var n=a(67),s=a.n(n),r=a(2),i=a(9),l=a(68);const o=(e,t)=>e?"metrics"===t?e.configuration.metricAlias:`${e.configuration.metricAlias}`:"unknown-index",c="Failed to load source: No fetch client available.",u=s()((({sourceId:e})=>{var t;const a=null===(t=Object(i.useKibana)().services.http)||void 0===t?void 0:t.fetch,n=`/api/metrics/source/${e}`,[s,u]=Object(r.useState)(void 0),[d,m]=Object(l.c)({cancelPreviousOn:"resolution",createPromise:async()=>{if(!a)throw new Error(c);return await a(`${n}`,{method:"GET"})},onResolve:e=>{u(e.source)}},[a,e]),[p,f]=Object(l.c)({createPromise:async e=>{if(!a)throw new Error(c);return await a(n,{method:"PATCH",body:JSON.stringify(e)})},onResolve:e=>{e&&u(e.source)}},[a,e]),[g,b]=Object(l.c)({createPromise:async e=>{if(!a)throw new Error(c);return await a(n,{method:"PATCH",body:JSON.stringify(e)})},onResolve:e=>{e&&u(e.source)}},[a,e]),y=Object(r.useMemo)((()=>[d.state,p.state,g.state].some((e=>"pending"===e))),[d.state,p.state,g.state]),h=Object(r.useMemo)((()=>"uninitialized"===d.state),[d.state]),v=Object(r.useMemo)((()=>s?!!s.version:void 0),[s]),E=Object(r.useMemo)((()=>s&&s.status&&s.status.metricIndicesExist),[s]);return Object(r.useEffect)((()=>{m()}),[m,e]),{createSourceConfiguration:f,createDerivedIndexPattern:()=>({fields:null!=s&&s.status?s.status.indexFields:[],title:o(s,"metrics")}),isLoading:y,isLoadingSource:"pending"===d.state,isUninitialized:h,hasFailedLoadingSource:"rejected"===d.state,loadSource:m,loadSourceFailureMessage:"rejected"===d.state?`${d.value}`:void 0,metricIndicesExist:E,source:s,sourceExists:v,sourceId:e,updateSourceConfiguration:b,version:s&&s.version?s.version:void 0}})),[d,m]=u},72:function(e,t,a){"use strict";a.d(t,"g",(function(){return d})),a.d(t,"a",(function(){return m})),a.d(t,"e",(function(){return p})),a.d(t,"b",(function(){return g})),a.d(t,"c",(function(){return y})),a.d(t,"d",(function(){return h})),a.d(t,"f",(function(){return v}));var n=a(0),s=a(75),r=a(111);const i=n.intersection([n.type({value:n.string,label:n.string}),n.partial({ip:n.union([n.string,n.null])})]),l=n.partial({value:n.union([n.number,n.null]),avg:n.union([n.number,n.null]),max:n.union([n.number,n.null]),timeseries:r.a}),o=n.type({name:n.union([s.f,n.string])}),c=n.intersection([o,l]),u=n.type({metrics:n.array(c),path:n.array(i),name:n.string}),d=n.type({nodes:n.array(u),interval:n.string}),m=n.intersection([n.type({interval:n.string,to:n.number,from:n.number}),n.partial({lookbackSize:n.number,ignoreLookback:n.boolean,forceInterval:n.boolean})]),p=n.array(n.partial({label:n.union([n.string,n.null]),field:n.union([n.string,n.null])})),f=n.type({type:s.f}),g=["avg","max","min","rate"],b=g.reduce(((e,t)=>({...e,[t]:null})),{}),y=n.keyof(b),h=n.intersection([n.type({type:n.literal("custom"),field:n.string,aggregation:y,id:n.string}),n.partial({label:n.string})]),v=n.union([f,h]);n.intersection([n.type({timerange:m,metrics:n.array(v),groupBy:n.union([p,n.null]),nodeType:s.c,sourceId:n.string}),n.partial({accountId:n.string,region:n.string,filterQuery:n.union([n.string,n.null]),includeTimeseries:n.boolean,overrideCompositeSize:n.number})])},75:function(e,t,a){"use strict";a.d(t,"c",(function(){return s})),a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return i})),a.d(t,"d",(function(){return T})),a.d(t,"e",(function(){return S})),a.d(t,"f",(function(){return B}));var n=a(0);const s=n.keyof({host:null,pod:null,container:null,awsEC2:null,awsS3:null,awsSQS:null,awsRDS:null}),r=n.keyof({line:null,area:null,bar:null}),i=(n.keyof({abbreviatedNumber:null,bits:null,bytes:null,number:null,percent:null,highPercision:null}),n.keyof({hostSystemOverview:null,hostCpuUsage:null,hostFilesystem:null,hostK8sOverview:null,hostK8sCpuCap:null,hostK8sDiskCap:null,hostK8sMemoryCap:null,hostK8sPodCap:null,hostLoad:null,hostMemoryUsage:null,hostNetworkTraffic:null,hostDockerOverview:null,hostDockerInfo:null,hostDockerTop5ByCpu:null,hostDockerTop5ByMemory:null,podOverview:null,podCpuUsage:null,podMemoryUsage:null,podLogUsage:null,podNetworkTraffic:null,containerOverview:null,containerCpuKernel:null,containerCpuUsage:null,containerDiskIOOps:null,containerDiskIOBytes:null,containerMemory:null,containerNetworkTraffic:null,nginxHits:null,nginxRequestRate:null,nginxActiveConnections:null,nginxRequestsPerConnection:null,awsOverview:null,awsCpuUtilization:null,awsNetworkBytes:null,awsNetworkPackets:null,awsDiskioBytes:null,awsDiskioOps:null,awsEC2CpuUtilization:null,awsEC2NetworkTraffic:null,awsEC2DiskIOBytes:null,awsS3TotalRequests:null,awsS3NumberOfObjects:null,awsS3BucketSize:null,awsS3DownloadBytes:null,awsS3UploadBytes:null,awsRDSCpuTotal:null,awsRDSConnections:null,awsRDSQueriesExecuted:null,awsRDSActiveTransactions:null,awsRDSLatency:null,awsSQSMessagesVisible:null,awsSQSMessagesDelayed:null,awsSQSMessagesSent:null,awsSQSMessagesEmpty:null,awsSQSOldestMessage:null,custom:null})),l=n.keyof({avg:null,max:null,min:null,calculation:null,cardinality:null,series_agg:null,positive_only:null,derivative:null,count:null,sum:null,cumulative_sum:null}),o=n.type({id:n.string,type:n.literal("count")}),c=n.intersection([n.type({id:n.string,type:l}),n.partial({field:n.string})]),u=n.type({field:n.string,id:n.string,name:n.string}),d=n.type({id:n.string,script:n.string,type:n.literal("calculation"),variables:n.array(u)}),m=n.type({id:n.string,field:n.string,unit:n.string,type:n.literal("derivative")}),p=n.type({id:n.string,function:n.string,type:n.literal("series_agg")}),f=n.type({id:n.string,value:n.number}),g=n.intersection([n.type({id:n.string,type:n.literal("percentile"),percentiles:n.array(f)}),n.partial({field:n.string})]),b=n.union([o,c,d,m,g,p]),y=n.intersection([n.type({id:n.string,metrics:n.array(b),split_mode:n.string}),n.partial({terms_field:n.string,terms_size:n.number,terms_order_by:n.string,filter:n.type({query:n.string,language:n.keyof({lucene:null,kuery:null})})})]),h=(n.intersection([n.type({id:i,requires:n.array(n.string),index_pattern:n.union([n.string,n.array(n.string)]),interval:n.string,time_field:n.string,type:n.string,series:n.array(y)}),n.partial({filter:n.string,map_field_to:n.string,id_type:n.keyof({cloud:null,node:null}),drop_last_bucket:n.boolean})]),n.record(n.string,n.union([n[void 0],n.type({field:n.string})]))),v=n.type({percentiles:n.type({field:n.string,percents:n.array(n.number)})}),E=n.type({cardinality:n.partial({field:n.string,script:n.string})}),x=n.type({bucket_script:n.intersection([n.type({buckets_path:n.record(n.string,n.string),script:n.type({source:n.string,lang:n.keyof({painless:null,expression:null})})}),n.partial({gap_policy:n.keyof({skip:null,insert_zeros:null})})])}),k=n.type({cumulative_sum:n.type({buckets_path:n.string})}),O=n.type({derivative:n.type({buckets_path:n.string,gap_policy:n.keyof({skip:null,insert_zeros:null}),unit:n.string})}),w=n.type({sum_bucket:n.type({buckets_path:n.string})}),C=n.type({top_metrics:n.type({metrics:n.union([n.array(n.type({field:n.string})),n.type({field:n.string})])})}),M=n.recursion("SnapshotModelRT",(()=>n.type({terms:n.type({field:n.string}),aggregations:T}))),j=n.union([h,v,x,k,O,w,M,E,C]),T=n.record(n.string,j),S={count:null,cpu:null,load:null,memory:null,tx:null,rx:null,logRate:null,diskIOReadBytes:null,diskIOWriteBytes:null,s3TotalRequests:null,s3NumberOfObjects:null,s3BucketSize:null,s3DownloadBytes:null,s3UploadBytes:null,rdsConnections:null,rdsQueriesExecuted:null,rdsActiveTransactions:null,rdsLatency:null,sqsMessagesVisible:null,sqsMessagesDelayed:null,sqsMessagesSent:null,sqsMessagesEmpty:null,sqsOldestMessage:null,custom:null},B=n.keyof(S)},76:function(e,t,a){"use strict";a.d(t,"a",(function(){return g})),a.d(t,"b",(function(){return b})),a.d(t,"c",(function(){return O})),a.d(t,"d",(function(){return w}));var n=a(2),s=a(0),r=a(24),i=a(18),l=a(19),o=a(67),c=a.n(o),u=a(108),d=a(31),m=a(72),p=a(81),f=a(75);const g={palette:"cool",steps:10,reverseColors:!1},b={metric:{type:"cpu"},groupBy:[],nodeType:"host",view:"map",customOptions:[],boundsOverride:{max:1,min:0},autoBounds:!0,accountId:"",region:"",customMetrics:[],legend:g,source:"default",sort:{by:"name",direction:"desc"},timelineOpen:!1},y=s.type({palette:d.d,steps:s.number,reverseColors:s.boolean}),h=s.type({by:s.keyof({name:null,value:null}),direction:s.keyof({asc:null,desc:null})}),v=s.intersection([s.type({metric:m.f,groupBy:m.e,nodeType:f.c,view:s.string,customOptions:s.array(s.type({text:s.string,field:s.string})),boundsOverride:s.type({min:s.number,max:s.number}),autoBounds:s.boolean,accountId:s.string,region:s.string,customMetrics:s.array(m.d),sort:h}),s.partial({source:s.string,legend:y,timelineOpen:s.boolean})]),E=e=>v.encode(e),x=e=>{const t=Object(r.pipe)(v.decode(e),Object(i.fold)(Object(l.constant)(void 0),l.identity));return t&&(t.source="url"),t},k=c()((()=>{const[e,t]=Object(p.b)({defaultState:b,decodeUrlState:x,encodeUrlState:E,urlStateKey:"waffleOptions"}),[a,s]=Object(n.useState)(e);Object(n.useEffect)((()=>t(a)),[t,a]);const r=Object(n.useCallback)((e=>s((t=>({...t,metric:e})))),[s]),i=Object(n.useCallback)((e=>s((t=>({...t,groupBy:e})))),[s]),l=Object(n.useCallback)((e=>s((t=>({...t,nodeType:e})))),[s]),o=Object(n.useCallback)((e=>s((t=>({...t,view:e})))),[s]),c=Object(n.useCallback)((e=>s((t=>({...t,customOptions:e})))),[s]),d=Object(n.useCallback)((e=>s((t=>({...t,autoBounds:e})))),[s]),m=Object(n.useCallback)((e=>s((t=>({...t,boundsOverride:e})))),[s]),f=Object(n.useCallback)((e=>s((t=>({...t,accountId:e})))),[s]),g=Object(n.useCallback)((e=>s((t=>({...t,region:e})))),[s]),y=Object(n.useCallback)((e=>{s((t=>({...t,customMetrics:e})))}),[s]),h=Object(n.useCallback)((e=>{s((t=>({...t,legend:e})))}),[s]),v=Object(n.useCallback)((e=>{s((t=>({...t,sort:e})))}),[s]),{inventoryPrefill:k}=Object(u.b)();Object(n.useEffect)((()=>{const{setNodeType:e,setMetric:t,setCustomMetrics:n}=k;e(a.nodeType),t(a.metric),n(a.customMetrics)}),[a,k]);const O=Object(n.useCallback)((e=>s((t=>({...t,timelineOpen:e})))),[s]);return{...b,...a,changeMetric:r,changeGroupBy:i,changeNodeType:l,changeView:o,changeCustomOptions:c,changeAutoBounds:d,changeBoundsOverride:m,changeAccount:f,changeRegion:g,changeCustomMetrics:y,changeLegend:h,changeSort:v,changeTimelineOpen:O,setWaffleOptionsState:s}})),[O,w]=k},77:function(e,t,a){"use strict";a.d(t,"a",(function(){return F}));var n=a(2),s=a.n(n),r=a(12),i=a(117),l=a(1),o=a(15),c=a(80);const u={name:l.i18n.translate("xpack.infra.waffle.sortNameLabel",{defaultMessage:"Name"}),value:l.i18n.translate("xpack.infra.waffle.sort.valueLabel",{defaultMessage:"Metric value"})},d=({sort:e,onChange:t})=>{const[a,i]=Object(n.useState)(!1),o=Object(n.useCallback)((()=>{i(!0)}),[i]),d=Object(n.useCallback)((()=>{i(!1)}),[i]),p=u[e.by],f=s.a.createElement(c.a,{label:l.i18n.translate("xpack.infra.waffle.sortLabel",{defaultMessage:"Sort by"}),onClick:o,"data-test-subj":"waffleSortByDropdown"},p),g=Object(n.useCallback)((()=>{t({...e,by:"name"}),d()}),[d,t,e]),b=Object(n.useCallback)((()=>{t({...e,by:"value"}),d()}),[d,t,e]),y=Object(n.useCallback)((()=>{t({...e,direction:"asc"===e.direction?"desc":"asc"}),d()}),[d,e,t]),h=Object(n.useMemo)((()=>[{id:0,title:"",items:[{name:u.name,icon:"name"===e.by?"check":"empty",onClick:g,"data-test-subj":"waffleSortByName"},{name:u.value,icon:"value"===e.by?"check":"empty",onClick:b,"data-test-subj":"waffleSortByValue"}]}]),[e.by,g,b]);return s.a.createElement(r.EuiPopover,{isOpen:a,id:"sortPopover",button:f,anchorPosition:"downLeft",panelPaddingSize:"none",closePopover:d},s.a.createElement(r.EuiContextMenu,{initialPanelId:0,panels:h}),s.a.createElement(m,null,s.a.createElement(r.EuiSwitch,{compressed:!0,label:l.i18n.translate("xpack.infra.waffle.sortDirectionLabel",{defaultMessage:"Reverse direction"}),checked:"desc"===e.direction,onChange:y,"data-test-subj":"waffleSortByDirection"})))},m=Object(o.withTheme)((({children:e,theme:t})=>s.a.createElement("div",{style:{padding:null==t?void 0:t.eui.paddingSizes.m,borderTop:`1px solid ${null==t?void 0:t.eui.euiBorderColor}`}},e)));var p=a(87),f=a(72),g=a(110),b=a.n(g),y=a(16);const h={avg:l.i18n.translate("xpack.infra.waffle.customMetrics.aggregationLables.avg",{defaultMessage:"Average"}),max:l.i18n.translate("xpack.infra.waffle.customMetrics.aggregationLables.max",{defaultMessage:"Max"}),min:l.i18n.translate("xpack.infra.waffle.customMetrics.aggregationLables.min",{defaultMessage:"Min"}),rate:l.i18n.translate("xpack.infra.waffle.customMetrics.aggregationLables.rate",{defaultMessage:"Rate"})},v=Object(o.withTheme)((({theme:e,onCancel:t,fields:a,onChange:i,metric:o})=>{const[c,u]=Object(n.useState)(o?o.label:void 0),[d,m]=Object(n.useState)(o?o.aggregation:"avg"),[p,g]=Object(n.useState)(o?o.field:void 0),v=Object(n.useCallback)((()=>{if(o&&d&&p)i({...o,label:c,aggregation:d,field:p});else if(d&&p){const e={type:"custom",id:b.a.v1(),label:c,aggregation:d,field:p};i(e)}}),[o,d,p,i,c]),E=Object(n.useCallback)((e=>{u(e.target.value)}),[u]),x=Object(n.useCallback)((e=>{g(e[0].label)}),[g]),k=Object(n.useCallback)((e=>{const t=e.target.value,a=f.c.is(t)?t:"avg";m(a)}),[m]),O=a.filter((e=>e.aggregatable&&"number"===e.type&&!(p&&p===e.name))).map((e=>({label:e.name}))),w=f.b.map((e=>({text:h[e],value:e}))),C=!p||!d,M=o?l.i18n.translate("xpack.infra.waffle.customMetricPanelLabel.edit",{defaultMessage:"Edit custom metric"}):l.i18n.translate("xpack.infra.waffle.customMetricPanelLabel.add",{defaultMessage:"Add custom metric"}),j=o?l.i18n.translate("xpack.infra.waffle.customMetricPanelLabel.editAriaLabel",{defaultMessage:"Back to custom metrics edit mode"}):l.i18n.translate("xpack.infra.waffle.customMetricPanelLabel.addAriaLabel",{defaultMessage:"Back to metric picker"});return s.a.createElement("div",{style:{width:685}},s.a.createElement(r.EuiForm,null,s.a.createElement(r.EuiPopoverTitle,null,s.a.createElement(r.EuiButtonEmpty,{iconType:"arrowLeft",onClick:t,color:"text",size:"xs",flush:"left",style:{fontWeight:700,textTransform:"uppercase"},"aria-label":j},M)),s.a.createElement("div",{style:{padding:null==e?void 0:e.eui.paddingSizes.m,borderBottom:`${null==e?void 0:e.eui.euiBorderWidthThin} solid ${null==e?void 0:e.eui.euiBorderColor}`}},s.a.createElement(r.EuiFormRow,{label:l.i18n.translate("xpack.infra.waffle.customMetrics.metricLabel",{defaultMessage:"Metric"}),display:"rowCompressed",fullWidth:!0},s.a.createElement(r.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},s.a.createElement(r.EuiFlexItem,{grow:!1},s.a.createElement(r.EuiSelect,{onChange:k,value:d,options:w,fullWidth:!0})),s.a.createElement(r.EuiFlexItem,{grow:!1},s.a.createElement(r.EuiText,{color:"subdued"},s.a.createElement("span",null,"of"))),s.a.createElement(r.EuiFlexItem,null,s.a.createElement(r.EuiComboBox,{fullWidth:!0,placeholder:l.i18n.translate("xpack.infra.waffle.customMetrics.fieldPlaceholder",{defaultMessage:"Select a field"}),singleSelection:{asPlainText:!0},selectedOptions:p?[{label:p}]:[],options:O,onChange:x,isClearable:!1})))),s.a.createElement(r.EuiFormRow,{label:l.i18n.translate("xpack.infra.waffle.customMetrics.labelLabel",{defaultMessage:"Label (optional)"}),display:"rowCompressed",fullWidth:!0},s.a.createElement(r.EuiFieldText,{name:"label",placeholder:l.i18n.translate("xpack.infra.waffle.customMetrics.labelPlaceholder",{defaultMessage:'Choose a name to appear in the "Metric" dropdown'}),value:c,fullWidth:!0,onChange:E}))),s.a.createElement("div",{style:{padding:null==e?void 0:e.eui.paddingSizes.m,textAlign:"right"}},s.a.createElement(r.EuiButtonEmpty,{onClick:t,size:"s",style:{paddingRight:null==e?void 0:e.eui.paddingSizes.xl}},s.a.createElement(y.FormattedMessage,{id:"xpack.infra.waffle.customMetrics.cancelLabel",defaultMessage:"Cancel"})),s.a.createElement(r.EuiButton,{type:"submit",size:"s",fill:!0,onClick:v,disabled:C},s.a.createElement(y.FormattedMessage,{id:"xpack.infra.waffle.customMetrics.submitLabel",defaultMessage:"Save"})))))}));var E=a(75);const x=({onClose:e,onChange:t,metric:a,options:i,customMetrics:l})=>{const o=f.d.is(a)&&a.id?a.id:a.type,c=Object(n.useCallback)((a=>{if(E.f.is(a))t({type:a});else{const e=l.find((e=>e.id===a));e&&t(e)}e()}),[l,t,e]),u=[{id:0,title:"",items:[...i.map((e=>{const t=e.value===o?"check":"empty";return{name:e.text,onClick:()=>c(e.value),icon:t}})),...l.map((e=>{const t=e.id===o?"check":"empty";return{name:Object(p.a)(e),onClick:()=>c(e.id),icon:t}}))]}];return s.a.createElement(r.EuiContextMenu,{initialPanelId:0,panels:u})},k=Object(o.withTheme)((({onSave:e,onEditCancel:t,onEdit:a,onAdd:n,mode:i,customMetrics:o,theme:c})=>["editMetric","addMetric"].includes(i)?null:s.a.createElement("div",{style:{borderTop:`${null==c?void 0:c.eui.euiBorderWidthThin} solid ${null==c?void 0:c.eui.euiBorderColor}`,padding:12}},s.a.createElement(r.EuiFlexGroup,{justifyContent:"spaceBetween"},"edit"===i?s.a.createElement(s.a.Fragment,null,s.a.createElement(r.EuiFlexItem,{grow:!1},s.a.createElement(r.EuiButtonEmpty,{size:"s",flush:"left",onClick:t,"aria-label":l.i18n.translate("xpack.infra.waffle.customMetrics.modeSwitcher.cancelAriaLabel",{defaultMessage:"Cancel edit mode"})},s.a.createElement(y.FormattedMessage,{id:"xpack.infra.waffle.customMetrics.modeSwitcher.cancel",defaultMessage:"Cancel"}))),s.a.createElement(r.EuiFlexItem,{grow:!1},s.a.createElement(r.EuiButton,{onClick:e,size:"s",fill:!0,"aria-label":l.i18n.translate("xpack.infra.waffle.customMetrics.modeSwitcher.saveButtonAriaLabel",{defaultMessage:"Save changes to custom metrics"})},s.a.createElement(y.FormattedMessage,{id:"xpack.infra.waffle.customMetrics.modeSwitcher.saveButton",defaultMessage:"Save"})))):s.a.createElement(s.a.Fragment,null,s.a.createElement(r.EuiFlexItem,{grow:!1},s.a.createElement(r.EuiButtonEmpty,{size:"s",flush:"left",onClick:a,disabled:0===o.length,"aria-label":l.i18n.translate("xpack.infra.waffle.customMetrics.modeSwitcher.editAriaLabel",{defaultMessage:"Edit custom metrics"})},s.a.createElement(y.FormattedMessage,{id:"xpack.infra.waffle.customMetrics.modeSwitcher.edit",defaultMessage:"Edit"}))),s.a.createElement(r.EuiFlexItem,{grow:!1},s.a.createElement(r.EuiButtonEmpty,{onClick:n,size:"s",flush:"right","aria-label":l.i18n.translate("xpack.infra.waffle.customMetrics.modeSwitcher.addMetricAriaLabel",{defaultMessage:"Add custom metric"})},s.a.createElement(y.FormattedMessage,{id:"xpack.infra.waffle.customMetrics.modeSwitcher.addMetric",defaultMessage:"Add metric"})))))))),O=Object(o.withTheme)((({theme:e,customMetrics:t,options:a,onEdit:n,onDelete:i})=>s.a.createElement("div",{style:{width:256}},a.map((t=>s.a.createElement("div",{key:t.value,style:{padding:"14px 14px 13px 36px"}},s.a.createElement("span",{style:{color:null==e?void 0:e.eui.euiButtonColorDisabled}},t.text)))),t.map((e=>s.a.createElement(r.EuiFlexGroup,{key:e.id,alignItems:"center",gutterSize:"none",style:{padding:"10px 0px 9px"}},s.a.createElement(r.EuiFlexItem,{grow:!1,style:{width:36}},s.a.createElement(r.EuiButtonIcon,{iconType:"pencil",onClick:()=>n(e),"aria-label":l.i18n.translate("xpack.infra.waffle.customMetrics.editMode.editButtonAriaLabel",{defaultMessage:"Edit custom metric for {name}",values:{name:Object(p.a)(e)}})})),s.a.createElement(r.EuiFlexItem,{grow:1,style:{overflow:"hidden"}},Object(p.a)(e)),s.a.createElement(r.EuiFlexItem,{grow:!1,style:{width:36,textAlign:"right"}},s.a.createElement(r.EuiButtonIcon,{iconType:"trash",color:"danger",onClick:()=>i(e),"aria-label":l.i18n.translate("xpack.infra.waffle.customMetrics.editMode.deleteAriaLabel",{defaultMessage:"Delete custom metric for {name}",values:{name:Object(p.a)(e)}})})))))))),w=({fields:e,onChange:t,onChangeCustomMetrics:a,metric:i,options:o,customMetrics:u})=>{var d;const[m,g]=Object(n.useState)(!1),[b,y]=Object(n.useState)("pick"),[h,E]=Object(n.useState)([]),[w,C]=Object(n.useState)(),M=Object(n.useCallback)((()=>{g(!1)}),[g]),j=Object(n.useCallback)((()=>{g(!m)}),[m]),T=Object(n.useCallback)((e=>{a([...u,e]),t(e),y("pick")}),[u,t,a,y]),S=Object(n.useCallback)((()=>{y("edit"),E(u)}),[u]),B=Object(n.useCallback)((()=>{y("addMetric")}),[y]),F=Object(n.useCallback)((()=>{y("pick"),E([])}),[y]),I=Object(n.useCallback)((e=>{f.d.is(i)&&e.id===i.id&&t({type:o[0].value});const a=h.filter((t=>t.id!==e.id));E(a)}),[h,i,t,o]),L=Object(n.useCallback)((e=>{const t=u.map((t=>t.id===e.id&&e||t));a(t),F(),C(void 0),E([])}),[u,a,F]),P=Object(n.useCallback)((e=>{C(e),y("editMetric")}),[y,C]),D=Object(n.useCallback)((()=>{a(h),y("pick")}),[h,a]);if(!o.length||!i.type)throw Error(l.i18n.translate("xpack.infra.waffle.unableToSelectMetricErrorTitle",{defaultMessage:"Unable to select options or value for metric."}));const R=f.d.is(i)&&i.id?i.id:i.type,z=f.d.is(i)?Object(p.a)(i):null===(d=o.find((e=>e.value===R)))||void 0===d?void 0:d.text;if(!z)return null;const A=s.a.createElement(c.a,{onClick:j,label:l.i18n.translate("xpack.infra.waffle.metriclabel",{defaultMessage:"Metric"})},z);return s.a.createElement(s.a.Fragment,null,s.a.createElement(r.EuiPopover,{isOpen:m,id:"metricsPanel",button:A,anchorPosition:"downLeft",panelPaddingSize:"none",closePopover:M},"pick"===b?s.a.createElement(x,{onChange:t,onClose:M,metric:i,customMetrics:u,options:o}):null,"addMetric"===b?s.a.createElement(v,{fields:e,customMetrics:u,onChange:T,onCancel:F}):null,"editMetric"===b?s.a.createElement(v,{metric:w,fields:e,customMetrics:u,onChange:L,onCancel:S}):null,"edit"===b?s.a.createElement(O,{customMetrics:h,options:o,onEdit:P,onDelete:I}):null,s.a.createElement(k,{onEditCancel:F,onEdit:S,onAdd:B,mode:b,onSave:D,customMetrics:u})))};var C=a(6),M=a.n(C);const j={selectedOptions:[]};class custom_field_panel_CustomFieldPanel extends s.a.PureComponent{constructor(...e){super(...e),M()(this,"state",j),M()(this,"handleSubmit",(()=>{this.props.onSubmit(this.state.selectedOptions[0].label)})),M()(this,"handleFieldSelection",(e=>{this.setState({selectedOptions:e})}))}render(){const{fields:e,currentOptions:t}=this.props,a=e.filter((e=>e.aggregatable&&"string"===e.type&&!(t&&t.some((t=>t.field===e.name))))).map((e=>({label:e.name}))),n=!this.state.selectedOptions.length;return s.a.createElement("div",{style:{padding:16}},s.a.createElement(r.EuiForm,null,s.a.createElement(r.EuiFormRow,{label:l.i18n.translate("xpack.infra.waffle.customGroupByFieldLabel",{defaultMessage:"Field"}),helpText:l.i18n.translate("xpack.infra.waffle.customGroupByHelpText",{defaultMessage:"This is the field used for the terms aggregation"}),display:"rowCompressed",fullWidth:!0},s.a.createElement(r.EuiComboBox,{"data-test-subj":"groupByCustomField",placeholder:l.i18n.translate("xpack.infra.waffle.customGroupByDropdownPlacehoder",{defaultMessage:"Select one"}),singleSelection:{asPlainText:!0},selectedOptions:this.state.selectedOptions,options:a,onChange:this.handleFieldSelection,fullWidth:!0,isClearable:!1})),s.a.createElement(r.EuiButton,{"data-test-subj":"groupByCustomFieldAddButton",disabled:n,type:"submit",size:"s",fill:!0,onClick:this.handleSubmit},"Add")))}}M()(custom_field_panel_CustomFieldPanel,"displayName","CustomFieldPanel");const T={isPopoverOpen:!1};class waffle_group_by_controls_WaffleGroupByControls extends s.a.PureComponent{constructor(...e){super(...e),M()(this,"state",T),M()(this,"handleRemove",(e=>()=>{const{groupBy:t}=this.props;this.props.onChange(t.filter((t=>t.field!==e)));const a=this.props.customOptions.filter((t=>t.field!==e));this.props.onChangeCustomOptions(a),setTimeout((()=>this.handleClose()))})),M()(this,"handleClose",(()=>{this.setState({isPopoverOpen:!1})})),M()(this,"handleToggle",(()=>{this.setState((e=>({isPopoverOpen:!e.isPopoverOpen})))})),M()(this,"handleCustomField",(e=>{const t=[...this.props.customOptions,{text:e,field:e}];this.props.onChangeCustomOptions(t),this.handleClick(e)()})),M()(this,"handleClick",(e=>()=>{const{groupBy:t}=this.props;t.some((t=>t.field===e))?this.handleRemove(e)():this.props.groupBy.length<2&&this.props.onChange([...t,{field:e}]),this.handleClose()}))}render(){const{nodeType:e,groupBy:t}=this.props,a=this.props.customOptions.map((e=>({...e,toolTipContent:e.text}))),n=this.props.options.concat(a);if(!n.length)throw Error(l.i18n.translate("xpack.infra.waffle.unableToSelectGroupErrorMessage",{defaultMessage:"Unable to select group by options for {nodeType}",values:{nodeType:e}}));const i=t.length>=2,o=l.i18n.translate("xpack.infra.waffle.maxGroupByTooltip",{defaultMessage:"Only two groupings can be selected at a time"}),u=[{id:"firstPanel",title:l.i18n.translate("xpack.infra.waffle.selectTwoGroupingsTitle",{defaultMessage:"Select up to two groupings"}),items:[{name:l.i18n.translate("xpack.infra.waffle.customGroupByOptionName",{defaultMessage:"Custom field"}),disabled:i,toolTipContent:i?o:null,icon:"empty",panel:"customPanel"},...n.map((e=>{const a=t.some((t=>t.field===e.field))?"check":"empty",n={name:e.text,onClick:this.handleClick(e.field),icon:a};return e.toolTipContent&&(n.toolTipContent=e.toolTipContent),i&&"empty"===a&&(n.toolTipContent=o,n.disabled=!0),n}))]},{id:"customPanel",title:l.i18n.translate("xpack.infra.waffle.customGroupByPanelTitle",{defaultMessage:"Group By Custom Field"}),width:685,content:s.a.createElement(custom_field_panel_CustomFieldPanel,{currentOptions:this.props.customOptions,onSubmit:this.handleCustomField,fields:this.props.fields})}],d=t.length>0?t.map((e=>n.find((t=>t.field===e.field)))).filter((e=>null!=e)).map((e=>s.a.createElement(r.EuiBadge,{color:"hollow",key:e&&e.field},e&&e.text))):s.a.createElement(y.FormattedMessage,{id:"xpack.infra.waffle.groupByAllTitle",defaultMessage:"All"}),m=s.a.createElement(c.a,{label:l.i18n.translate("xpack.infra.waffle.groupByLabel",{defaultMessage:"Group by"}),onClick:this.handleToggle,"data-test-subj":"waffleGroupByDropdown"},d);return s.a.createElement(r.EuiPopover,{isOpen:this.state.isPopoverOpen,id:"groupByPanel",button:m,panelPaddingSize:"none",closePopover:this.handleClose},s.a.createElement(S,{initialPanelId:"firstPanel",panels:u,"data-test-subj":"groupByContextMenu"}))}}M()(waffle_group_by_controls_WaffleGroupByControls,"displayName","WaffleGroupByControls");const S=Object(o.euiStyled)(r.EuiContextMenu)`
  width: 320px;
  & .euiContextMenuItem__text {
    overflow: hidden;
    text-overflow: ellipsis;
  }
`;var B=a(157);const F=e=>{const t=Object(n.useMemo)((()=>e.metricTypes.map(i.a).filter((e=>e))),[e.metricTypes]),a=Object(n.useMemo)((()=>e.groupByFields.map(B.b)),[e.groupByFields]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(r.EuiFlexItem,{grow:!1},s.a.createElement(w,{fields:e.createDerivedIndexPattern().fields,options:t,metric:e.metric,onChange:e.changeMetric,onChangeCustomMetrics:e.changeCustomMetrics,customMetrics:e.customMetrics})),s.a.createElement(r.EuiFlexItem,{grow:!1},s.a.createElement(waffle_group_by_controls_WaffleGroupByControls,{options:a,groupBy:e.groupBy,nodeType:e.nodeType,onChange:e.changeGroupBy,fields:e.createDerivedIndexPattern().fields,onChangeCustomOptions:e.changeCustomOptions,customOptions:e.customOptions})),"map"===e.view&&s.a.createElement(r.EuiFlexItem,{grow:!1},s.a.createElement(d,{sort:e.sort,onChange:e.changeSort})))}},79:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(2),s=a.n(n),r=a(1),i=a(9),l=a(68);function o(e,t,a,o=(e=>e),c,u){var d;const m=Object(i.useKibana)(),p=c||(null===(d=m.services.http)||void 0===d?void 0:d.fetch),f=u||m.notifications.toasts.danger,[g,b]=Object(n.useState)(null),[y,h]=Object(n.useState)(null),[v,E]=Object(l.c)({cancelPreviousOn:"resolution",createPromise:()=>{if(!p)throw new Error("HTTP service is unavailable");return p(e,{method:t,body:a})},onResolve:e=>b(o(e)),onReject:e=>{var t,a,n,i,o;const c=e;e&&e instanceof l.a||(h(c),f({toastLifeTimeMs:3e3,title:r.i18n.translate("xpack.infra.useHTTPRequest.error.title",{defaultMessage:"Error while fetching resource"}),body:s.a.createElement("div",null,c.response?s.a.createElement(s.a.Fragment,null,s.a.createElement("h5",null,r.i18n.translate("xpack.infra.useHTTPRequest.error.status",{defaultMessage:"Error"})),null===(t=c.response)||void 0===t?void 0:t.statusText," (",null===(a=c.response)||void 0===a?void 0:a.status,")",s.a.createElement("h5",null,r.i18n.translate("xpack.infra.useHTTPRequest.error.url",{defaultMessage:"URL"})),null===(n=c.response)||void 0===n?void 0:n.url,s.a.createElement("h5",null,r.i18n.translate("xpack.infra.useHTTPRequest.error.body.message",{defaultMessage:"Message"})),(null===(i=c.body)||void 0===i?void 0:i.message)||c.message):s.a.createElement("h5",null,(null===(o=c.body)||void 0===o?void 0:o.message)||c.message))}))}},[e,a,t,c,f]),x=Object(n.useMemo)((()=>"resolved"===v.state&&null===g||"pending"===v.state),[v.state,g]);return{response:g,error:y,loading:x,makeRequest:E}}},80:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(12),s=a(2),r=a.n(s),i=a(15);const l=Object(i.withTheme)((e=>{const{onClick:t,label:a,theme:s,children:i}=e;return r.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"none",style:{border:null==s?void 0:s.eui.euiFormInputGroupBorder,boxShadow:`0px 3px 2px ${null==s?void 0:s.eui.euiTableActionsBorderColor}, 0px 1px 1px ${null==s?void 0:s.eui.euiTableActionsBorderColor}`}},r.a.createElement(n.EuiFlexItem,{grow:!1,style:{padding:12,background:null==s?void 0:s.eui.euiFormInputGroupLabelBackground,fontSize:"0.75em",fontWeight:600,color:null==s?void 0:s.eui.euiTitleColor}},a),r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiButtonEmpty,{"data-test-subj":e["data-test-subj"],color:"text",iconType:"arrowDown",onClick:t,iconSide:"right",size:"xs"},i)))}))},86:function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"c",(function(){return i})),a.d(t,"d",(function(){return c})),a.d(t,"b",(function(){return p})),a.d(t,"e",(function(){return E}));var n=a(0);const s=["avg","max","min","cardinality","rate","count","sum","p95","p99"],r=s.reduce(((e,t)=>({...e,[t]:null})),{}),i=n.keyof(r),l=n.type({aggregation:i}),o=n.partial({field:n.union([n.string,n[void 0]])}),c=n.intersection([l,o]),u=n.type({from:n.number,to:n.number,interval:n.string}),d=n.type({timerange:u,indexPattern:n.string,metrics:n.array(c)}),m=n.union([n.string,n.null,n[void 0]]),p=n.record(n.string,n.union([n.string,n.null])),f=n.partial({groupBy:n.union([m,n.array(m)]),afterKey:n.union([n.string,n.null,n[void 0],p]),limit:n.union([n.number,n.null,n[void 0]]),filterQuery:n.union([n.string,n.null,n[void 0]]),forceInterval:n.boolean,dropLastBucket:n.boolean}),g=(n.intersection([d,f]),n.type({total:n.number,afterKey:n.union([n.string,n.null,p])})),b=n.keyof({date:null,number:null,string:null}),y=n.type({name:n.string,type:b}),h=n.intersection([n.type({timestamp:n.number}),n.record(n.string,n.union([n.string,n.number,n.null,n[void 0],n.array(n.object)]))]),v=n.intersection([n.type({id:n.string,columns:n.array(y),rows:n.array(h)}),n.partial({keys:n.array(n.string)})]),E=n.type({series:n.array(v),pageInfo:g})},87:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(1);const s=e=>{const t={avg:n.i18n.translate("xpack.infra.waffle.aggregationNames.avg",{defaultMessage:"Avg of {field}",values:{field:e.field}}),max:n.i18n.translate("xpack.infra.waffle.aggregationNames.max",{defaultMessage:"Max of {field}",values:{field:e.field}}),min:n.i18n.translate("xpack.infra.waffle.aggregationNames.min",{defaultMessage:"Min of {field}",values:{field:e.field}}),rate:n.i18n.translate("xpack.infra.waffle.aggregationNames.rate",{defaultMessage:"Rate of {field}",values:{field:e.field}})};return e.label?e.label:t[e.aggregation]}},93:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(2),s=a.n(n),r=a(12),i=a(1),l=a(80);const o=e=>{const{accountId:t,options:a}=e,[o,c]=Object(n.useState)(!1),u=Object(n.useCallback)((()=>{c(!0)}),[c]),d=Object(n.useCallback)((()=>{c(!1)}),[c]),m=a.find((e=>e.value===t)),p=Object(n.useCallback)((a=>{t===a?e.changeAccount(""):e.changeAccount(a),d()}),[t,d,e]),f=Object(n.useMemo)((()=>[{id:0,title:"",items:a.map((e=>{const a=e.value===t?"check":"empty";return{name:e.name,onClick:()=>p(e.value),icon:a}}))}]),[a,t,p]),g=s.a.createElement(l.a,{label:i.i18n.translate("xpack.infra.waffle.accountLabel",{defaultMessage:"Account"}),onClick:u},m?m.name:i.i18n.translate("xpack.infra.waffle.accountAllTitle",{defaultMessage:"All"}));return s.a.createElement(r.EuiPopover,{isOpen:o,id:"accontPopOver",button:g,anchorPosition:"downLeft",panelPaddingSize:"none",closePopover:d},s.a.createElement(r.EuiContextMenu,{initialPanelId:0,panels:f}))},c=e=>{const{region:t,options:a}=e,[o,c]=Object(n.useState)(!1),u=Object(n.useCallback)((()=>{c(!0)}),[c]),d=Object(n.useCallback)((()=>{c(!1)}),[c]),m=a.find((e=>t===e)),p=Object(n.useCallback)((a=>{t===a?e.changeRegion(""):e.changeRegion(a),d()}),[t,d,e]),f=Object(n.useMemo)((()=>[{id:0,title:"",items:a.map((e=>({name:e,onClick:()=>p(e),icon:e===t?"check":"empty"})))}]),[p,a,t]),g=s.a.createElement(l.a,{onClick:u,label:i.i18n.translate("xpack.infra.waffle.regionLabel",{defaultMessage:"Region"})},m||i.i18n.translate("xpack.infra.waffle.region",{defaultMessage:"All"}));return s.a.createElement(r.EuiPopover,{isOpen:o,id:"regionPanel",button:g,anchorPosition:"downLeft",panelPaddingSize:"none",closePopover:d},s.a.createElement(r.EuiContextMenu,{initialPanelId:0,panels:f}))},u=e=>s.a.createElement(s.a.Fragment,null,e.accounts.length>0&&s.a.createElement(r.EuiFlexItem,{grow:!1},s.a.createElement(o,{changeAccount:e.changeAccount,accountId:e.accountId,options:e.accounts})),e.regions.length>0&&s.a.createElement(r.EuiFlexItem,{grow:!1},s.a.createElement(c,{changeRegion:e.changeRegion,region:e.region,options:e.regions})))}}]);