/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.infra_bundle_jsonpfunction=window.infra_bundle_jsonpfunction||[]).push([[7],{105:function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var n=s(106);const i=(e,t,s=!0)=>{try{return e?JSON.stringify(Object(n.d)(Object(n.c)(e),t)):""}catch(e){if(s)return"";throw e}}},108:function(e,t,s){"use strict";s.d(t,"a",(function(){return u})),s.d(t,"b",(function(){return a}));var n=s(67),i=s.n(n),r=s(23),o=s(2);const[u,a]=i()((()=>({metricThresholdPrefill:(()=>{const[e,t]=Object(o.useState)({groupBy:void 0,filterQuery:void 0,metrics:[]}),{groupBy:s,filterQuery:n,metrics:i}=e;return{groupBy:s,filterQuery:n,metrics:i,setPrefillOptions(s){Object(r.isEqual)(s,e)||t(s)}}})(),inventoryPrefill:(()=>{const[e,t]=Object(o.useState)("host"),[s,n]=Object(o.useState)(),[i,r]=Object(o.useState)({type:"cpu"}),[u,a]=Object(o.useState)([]);return{nodeType:e,filterQuery:s,metric:i,customMetrics:u,setNodeType:t,setFilterQuery:n,setMetric:r,setCustomMetrics:a}})()})))},114:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s(33),i=s(31),r=s(219);const o=e=>{if(e&&e.field){const t=Object(r.a)(e);return t===i.b.bits&&"rate"===e.aggregation?Object(n.b)(i.b.bits,"{{value}}/s"):Object(n.b)(t)}return Object(n.b)(i.b.number)}},115:function(e,t,s){"use strict";s.d(t,"a",(function(){return g}));var n=s(2),i=s.n(n),r=s(50),o=s(78),u=s(220),a=s(82),c=s(113),l=s(147);const g=e=>a.b.bar===e.type?i.a.createElement(p,e):i.a.createElement(d,e),d=({metric:e,id:t,series:s,type:n,stack:g,opacity:d})=>{const p=Object(c.a)(),h=e.color&&Object(o.b)(e.color)||Object(o.b)(o.a.color0),f=Array.isArray(t)?t.map((t=>Object(l.a)(e,t))).slice(t.length-1,t.length):[Object(l.a)(e,t)],m=Array.isArray(t)&&t.length>1?t.map((t=>Object(l.a)(e,t))).slice(0,1):void 0,b=`series-${s.id}-${f.join("-")}`,y={line:{strokeWidth:2,visible:!0},area:{opacity:d||.5,visible:n===a.b.area}};return i.a.createElement(r.AreaSeries,{id:b,key:b,name:Object(u.a)(e),xScaleType:r.ScaleType.Time,yScaleType:r.ScaleType.Linear,xAccessor:"timestamp",yAccessors:f,y0Accessors:m,data:s.rows,stackAccessors:g?["timestamp"]:void 0,areaSeriesStyle:y,color:h,timeZone:p})},p=({metric:e,id:t,series:s,stack:n})=>{const a=Object(c.a)(),g=e.color&&Object(o.b)(e.color)||Object(o.b)(o.a.color0),d=Array.isArray(t)?t.map((t=>Object(l.a)(e,t))).slice(t.length-1,t.length):[Object(l.a)(e,t)],p=`series-${s.id}-${d.join("-")}`,h={rectBorder:{stroke:g,strokeWidth:1,visible:!0},rect:{opacity:1}};return i.a.createElement(r.BarSeries,{id:p,key:p,name:Object(u.a)(e),xScaleType:r.ScaleType.Time,yScaleType:r.ScaleType.Linear,xAccessor:"timestamp",yAccessors:d,data:s.rows,stackAccessors:n?["timestamp"]:void 0,barSeriesStyle:h,color:g,timeZone:a})}},116:function(e,t,s){"use strict";s.d(t,"a",(function(){return u}));var n=s(23),i=s(147);const r=e=>{const t=Object(n.min)(e);return Object(n.isNumber)(t)&&Number.isFinite(t)?t:void 0},o=e=>{const t=Object(n.max)(e);return Object(n.isNumber)(t)&&Number.isFinite(t)?t:void 0},u=(e,t,s=!1)=>{const u=e.rows.reduce(((e,u)=>{const a=t.map(((e,t)=>u[Object(i.a)(e,t)]||null)).filter((e=>Object(n.isNumber)(e))),c=r(a),l=s?1.1*Object(n.sum)(a):o(a);return e.concat([c||null,l||null])}),[]).filter((e=>Object(n.isNumber)(e)));return{min:r(u)||0,max:o(u)||0}}},147:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));const n=(e,t)=>`metric_${t}`},148:function(e,t,s){"use strict";s.d(t,"a",(function(){return c}));var n=s(1),i=s(106),r=s(2),o=s.n(r),u=s(221),a=s(231);const c=({derivedIndexPattern:e,onSubmit:t,onChange:s,value:c,placeholder:g,curryLoadSuggestions:d=l})=>{const[p,h]=Object(r.useState)(c||""),[f,m]=Object(r.useState)(!0);Object(r.useEffect)((()=>{c&&h(c)}),[c]);const b=e=>{m(function(e){try{Object(i.c)(e)}catch(e){return!1}return!0}(e)),h(e),s&&s(e)},y={...e,fields:e.fields},S=n.i18n.translate("xpack.infra.homePage.toolbar.kqlSearchFieldPlaceholder",{defaultMessage:"Search for infrastructure dataâ€¦ (e.g. host.name:host-1)"});return o.a.createElement(u.a,{indexPattern:y},(({isLoadingSuggestions:e,loadSuggestions:s,suggestions:n})=>o.a.createElement(a.a,{"aria-label":g,isLoadingSuggestions:e,isValid:f,loadSuggestions:d(s),onChange:b,onSubmit:t,placeholder:g||S,suggestions:n,value:p})))},l=e=>(...t)=>e(...t)},219:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var n=s(23),i=s(31);const r=e=>{if(e&&e.field){const t=Object(n.last)(e.field.split(/\./));if("pct"===t)return i.b.percent;if("bytes"===t&&"rate"===e.aggregation)return i.b.bits;if("bytes"===t)return i.b.bytes}return i.b.number}},220:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));const n=e=>e.label?e.label:`${e.aggregation}(${e.field||""})`},221:function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));var n=s(6),i=s.n(n),r=s(2),o=s.n(r),u=s(9);class WithKueryAutocompletionComponent extends o.a.Component{constructor(...e){super(...e),i()(this,"state",{currentRequest:null,suggestions:[]}),i()(this,"loadSuggestions",(async(e,t,s,n)=>{var i;const{indexPattern:r}=this.props,o="kuery";if(!(null===(i=this.props.kibana.services.unifiedSearch)||void 0===i?void 0:i.autocomplete.hasQuerySuggestions(o)))return;this.setState({currentRequest:{expression:e,cursorPosition:t},suggestions:[]});const u=await this.props.kibana.services.unifiedSearch.autocomplete.getQuerySuggestions({language:o,query:e,selectionStart:t,selectionEnd:t,indexPatterns:[r],boolFilter:[]})||[],a=n?n(u):u;this.setState((n=>n.currentRequest&&n.currentRequest.expression!==e&&n.currentRequest.cursorPosition!==t?n:{...n,currentRequest:null,suggestions:s?a.slice(0,s):a}))}))}render(){const{currentRequest:e,suggestions:t}=this.state;return this.props.children({isLoadingSuggestions:null!==e,loadSuggestions:this.loadSuggestions,suggestions:t})}}const a=Object(u.withKibana)(WithKueryAutocompletionComponent)},231:function(e,t,s){"use strict";s.d(t,"a",(function(){return autocomplete_field_AutocompleteField}));var n=s(6),i=s.n(n),r=s(12),o=s(2),u=s.n(o),a=s(15);function c(...e){return(t,s)=>e.reduce(((e,t)=>t(e,s)||e),t)}s(23);var l=s(59),g=s(101);const d=e=>{const{isSelected:t,onClick:s,onMouseEnter:n,suggestion:i}=e;return u.a.createElement(p,{isSelected:t,onClick:s,onMouseEnter:n},u.a.createElement(f,{suggestionType:i.type},u.a.createElement(r.EuiIcon,{type:y(i.type)})),u.a.createElement(m,null,i.text),u.a.createElement(b,null,i.description))};d.defaultProps={isSelected:!1};const p=a.euiStyled.div`
  display: flex;
  flex-direction: row;
  font-size: ${e=>e.theme.eui.euiFontSizeS};
  height: ${e=>e.theme.eui.euiSizeXL};
  white-space: nowrap;
  background-color: ${e=>e.isSelected?e.theme.eui.euiColorLightestShade:"transparent"};
`,h=a.euiStyled.div`
  align-items: center;
  cursor: pointer;
  display: flex;
  flex-direction: row;
  height: ${e=>e.theme.eui.euiSizeXL};
  padding: ${e=>e.theme.eui.euiSizeXS};
`,f=Object(a.euiStyled)(h)`
  background-color: ${e=>Object(g.transparentize)(.9,S(e.theme,e.suggestionType))};
  color: ${e=>S(e.theme,e.suggestionType)};
  flex: 0 0 auto;
  justify-content: center;
  width: ${e=>e.theme.eui.euiSizeXL};
`,m=Object(a.euiStyled)(h)`
  flex: 2 0 0;
  font-family: ${e=>e.theme.eui.euiCodeFontFamily};
`,b=Object(a.euiStyled)(h)`
  flex: 3 0 0;

  p {
    display: inline;

    span {
      font-family: ${e=>e.theme.eui.euiCodeFontFamily};
    }
  }
`,y=e=>{switch(e){case l.QuerySuggestionTypes.Field:return"kqlField";case l.QuerySuggestionTypes.Value:return"kqlValue";case l.QuerySuggestionTypes.RecentSearch:return"search";case l.QuerySuggestionTypes.Conjunction:return"kqlSelector";case l.QuerySuggestionTypes.Operator:return"kqlOperand";default:return"empty"}},S=(e,t)=>{switch(t){case l.QuerySuggestionTypes.Field:return null==e?void 0:e.eui.euiColorVis7;case l.QuerySuggestionTypes.Value:return null==e?void 0:e.eui.euiColorVis0;case l.QuerySuggestionTypes.Operator:return null==e?void 0:e.eui.euiColorVis1;case l.QuerySuggestionTypes.Conjunction:return null==e?void 0:e.eui.euiColorVis2;case l.QuerySuggestionTypes.RecentSearch:default:return null==e?void 0:e.eui.euiColorMediumShade}};class autocomplete_field_AutocompleteField extends u.a.Component{constructor(...e){super(...e),i()(this,"state",{areSuggestionsVisible:!1,isFocused:!1,selectedIndex:null}),i()(this,"inputElement",null),i()(this,"handleChangeInputRef",(e=>{this.inputElement=e})),i()(this,"handleChange",(e=>{this.changeValue(e.currentTarget.value)})),i()(this,"handleKeyDown",(e=>{const{suggestions:t}=this.props;switch(e.key){case"ArrowUp":e.preventDefault(),t.length>0&&this.setState(c(x,O));break;case"ArrowDown":e.preventDefault(),t.length>0?this.setState(c(x,v)):this.updateSuggestions();break;case"Enter":e.preventDefault(),null!==this.state.selectedIndex?this.applySelectedSuggestion():this.submit();break;case"Escape":e.preventDefault(),this.setState(E)}})),i()(this,"handleKeyUp",(e=>{switch(e.key){case"ArrowLeft":case"ArrowRight":case"Home":case"End":this.updateSuggestions()}})),i()(this,"handleFocus",(()=>{this.setState(c(x,k))})),i()(this,"handleBlur",(()=>{this.setState(c(E,w))})),i()(this,"selectSuggestionAt",(e=>()=>{this.setState(j(e))})),i()(this,"applySelectedSuggestion",(()=>{null!==this.state.selectedIndex&&this.applySuggestionAt(this.state.selectedIndex)()})),i()(this,"applySuggestionAt",(e=>()=>{const{value:t,suggestions:s}=this.props,n=s[e];if(!n)return;const i=t.substr(0,n.start)+n.text+t.substr(n.end);this.setState(E),this.changeValue(i),this.focusInputElement()})),i()(this,"changeValue",(e=>{const{onChange:t}=this.props;t&&t(e)})),i()(this,"focusInputElement",(()=>{this.inputElement&&this.inputElement.focus()})),i()(this,"showSuggestions",(()=>{this.setState(x)})),i()(this,"submit",(()=>{const{isValid:e,onSubmit:t,value:s}=this.props;e&&t&&t(s),this.setState(E)})),i()(this,"updateSuggestions",(()=>{const e=this.inputElement&&this.inputElement.selectionStart||0;this.props.loadSuggestions(this.props.value,e,200)}))}render(){const{suggestions:e,isLoadingSuggestions:t,isValid:s,placeholder:n,value:i,disabled:o,"aria-label":a}=this.props,{areSuggestionsVisible:c,selectedIndex:l}=this.state;return u.a.createElement(r.EuiOutsideClickDetector,{onOutsideClick:this.handleBlur},u.a.createElement(A,null,u.a.createElement(r.EuiFieldSearch,{fullWidth:!0,disabled:o,inputRef:this.handleChangeInputRef,isLoading:t,isInvalid:!s,onChange:this.handleChange,onFocus:this.handleFocus,onKeyDown:this.handleKeyDown,onKeyUp:this.handleKeyUp,onSearch:this.submit,placeholder:n,value:i,"aria-label":a,"data-test-subj":"infraSearchField"}),c&&!t&&e.length>0?u.a.createElement(T,null,e.map(((e,t)=>u.a.createElement(d,{key:e.text,suggestion:e,isSelected:t===l,onMouseEnter:this.selectSuggestionAt(t),onClick:this.applySuggestionAt(t)})))):null))}componentDidMount(){this.inputElement&&this.props.autoFocus&&this.inputElement.focus()}componentDidUpdate(e){const t=e.value!==this.props.value,s=e.suggestions!==this.props.suggestions;t&&this.updateSuggestions(),t&&""===this.props.value&&this.submit(),s&&this.state.isFocused&&this.showSuggestions()}}const O=(e,t)=>({...e,selectedIndex:0===t.suggestions.length?null:null!==e.selectedIndex?(e.selectedIndex+t.suggestions.length-1)%t.suggestions.length:Math.max(t.suggestions.length-1,0)}),v=(e,t)=>({...e,selectedIndex:0===t.suggestions.length?null:null!==e.selectedIndex?(e.selectedIndex+1)%t.suggestions.length:0}),j=e=>(t,s)=>({...t,selectedIndex:0===s.suggestions.length?null:e>=0&&e<s.suggestions.length?e:0}),x=e=>({...e,areSuggestionsVisible:!0}),E=e=>({...e,areSuggestionsVisible:!1,selectedIndex:null}),k=e=>({...e,isFocused:!0}),w=e=>({...e,isFocused:!1}),A=a.euiStyled.div`
  position: relative;
`,T=Object(a.euiStyled)(r.EuiPanel).attrs((()=>({paddingSize:"none",hasShadow:!0})))`
  position: absolute;
  width: 100%;
  margin-top: 2px;
  overflow-x: hidden;
  overflow-y: scroll;
  z-index: ${e=>e.theme.eui.euiZLevel1};
  max-height: 322px;
`},78:function(e,t,s){"use strict";s.d(t,"a",(function(){return i})),s.d(t,"b",(function(){return u})),s(23);var n=s(12);let i;!function(e){e.color0="color0",e.color1="color1",e.color2="color2",e.color3="color3",e.color4="color4",e.color5="color5",e.color6="color6",e.color7="color7",e.color8="color8",e.color9="color9"}(i||(i={}));const r=Object(n.euiPaletteColorBlind)(),o={[i.color0]:r[1],[i.color1]:r[2],[i.color2]:r[0],[i.color3]:r[3],[i.color4]:r[4],[i.color5]:r[5],[i.color6]:r[6],[i.color7]:r[7],[i.color8]:r[8],[i.color9]:r[9]},u=(a=o,e=>a[e]);var a},82:function(e,t,s){"use strict";s.d(t,"b",(function(){return p})),s.d(t,"d",(function(){return h})),s.d(t,"f",(function(){return f})),s.d(t,"e",(function(){return y})),s.d(t,"g",(function(){return S})),s.d(t,"a",(function(){return x})),s.d(t,"c",(function(){return k}));var n=s(0),i=s(23),r=s(67),o=s.n(r),u=s(2),a=s(108),c=s(78),l=s(86),g=s(123);const d=n.intersection([l.d,n.partial({rate:n.boolean,color:n.keyof(Object.fromEntries(Object(i.values)(c.a).map((e=>[e,null])))),label:n.string})]);let p,h;!function(e){e.line="line",e.area="area",e.bar="bar"}(p||(p={})),function(e){e.fromZero="fromZero",e.auto="auto"}(h||(h={}));const f=n.type({yAxisMode:n.keyof(Object.fromEntries(Object(i.values)(h).map((e=>[e,null])))),type:n.keyof(Object.fromEntries(Object(i.values)(p).map((e=>[e,null])))),stack:n.boolean}),m=n.type({aggregation:n.string,metrics:n.array(d)}),b=n.partial({limit:n.number,groupBy:n.union([n.string,n.array(n.string)]),filterQuery:n.string,source:n.string,forceInterval:n.boolean,dropLastBucket:n.boolean}),y=n.intersection([m,b]),S=n.type({from:n.string,to:n.string,interval:n.string}),O={from:"now-1h",to:"now",interval:">=10s"},v={type:p.line,yAxisMode:h.fromZero,stack:!1},j={aggregation:"avg",metrics:[{aggregation:"avg",field:"system.cpu.total.norm.pct",color:c.a.color0},{aggregation:"avg",field:"kubernetes.pod.cpu.usage.node.pct",color:c.a.color1},{aggregation:"avg",field:"docker.cpu.total.pct",color:c.a.color2}],source:"default"},x={options:j,chartOptions:v,currentTimerange:O};function E(e,t){const s=localStorage.getItem(e),[n,i]=Object(u.useState)(function(e,t){if(!e)return t;try{return JSON.parse(e)}catch(e){return t}}(s,t));return Object(u.useEffect)((()=>{localStorage.setItem(e,JSON.stringify(n))}),[e,n]),[n,i]}const k=o()((()=>{const e={from:"now-1h",to:"now"},[t]=Object(g.a)(e),{from:s,to:n}=t(),i={from:s,to:n,interval:O.interval},[r,o]=E("MetricsExplorerOptions",j),[c,l]=Object(u.useState)(i);Object(g.b)(e,{from:c.from,to:c.to});const[d,p]=E("MetricsExplorerChartOptions",v),[h,f]=Object(u.useState)(!1),{metricThresholdPrefill:m}=Object(a.b)(),b=Object(u.useMemo)((()=>m),[m]);return Object(u.useEffect)((()=>{if(b){const{setPrefillOptions:e}=b,{metrics:t,groupBy:s,filterQuery:n}=r;e({metrics:t,groupBy:s,filterQuery:n})}}),[r,b]),{defaultViewState:{options:j,chartOptions:v,currentTimerange:i},options:r,chartOptions:d,setChartOptions:p,currentTimerange:c,isAutoReloading:h,setOptions:o,setTimeRange:l,startAutoReload:()=>f(!0),stopAutoReload:()=>f(!1)}}))}}]);