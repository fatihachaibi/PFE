/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.infra_bundle_jsonpfunction=window.infra_bundle_jsonpfunction||[]).push([[12],{109:function(e,t,a){"use strict";a.d(t,"a",(function(){return y})),a.d(t,"b",(function(){return E}));var n=a(1),i=a(23),r=a(2),o=a.n(r),s=a(51),l=a(94),c=a.n(l),u=a(74),d=a(90),m=a(92),g=a(88),f=a(98),h=a(13),p=a(71),b=a(99);const y=({match:{params:{nodeId:e,nodeType:t,sourceId:a="default"}},location:r})=>{const{services:l}=Object(h.b)(),{isLoading:y,load:E}=Object(p.b)({fetch:l.http.fetch,logViewId:a,logViews:l.logViews.client});if(c()((()=>{E()})),y)return o.a.createElement(d.a,{"data-test-subj":`nodeLoadingPage-${t}`,message:n.i18n.translate("xpack.infra.redirectToNodeLogs.loadingNodeLogsMessage",{defaultMessage:"Loading {nodeType} logs",values:{nodeType:t}})});const v=`${Object(u.a)(t).id}: ${e}`,x=Object(b.a)(r),_=x?`(${v}) and (${x})`:v,M=Object(i.flowRight)(Object(m.c)({language:"kuery",query:_}),Object(g.c)(Object(b.c)(r)),Object(f.a)(a))("");return o.a.createElement(s.Redirect,{to:`/stream?${M}`})},E=({nodeId:e,nodeType:t,time:a})=>({app:"logs",pathname:`link-to/${t}-logs/${e}`,search:a?{time:`${a}`}:void 0})},121:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(52),i=a(2),r=n.__importDefault(a(122));t.default=function(e,t,a){void 0===t&&(t=0),void 0===a&&(a=[]);var n=r.default(e,t),o=n[0],s=n[1],l=n[2];return i.useEffect(l,a),[o,s]}},122:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2);t.default=function(e,t){void 0===t&&(t=0);var a=n.useRef(!1),i=n.useRef(),r=n.useRef(e),o=n.useCallback((function(){return a.current}),[]),s=n.useCallback((function(){a.current=!1,i.current&&clearTimeout(i.current),i.current=setTimeout((function(){a.current=!0,r.current()}),t)}),[t]),l=n.useCallback((function(){a.current=null,i.current&&clearTimeout(i.current)}),[]);return n.useEffect((function(){r.current=e}),[e]),n.useEffect((function(){return s(),l}),[t]),[o,l,s]}},144:function(e,t,a){!function(e,t,a,n,i,r,o,s){"use strict";var l=Array.prototype,c=l.map,u=l.slice,d={name:"implicit"};function m(e){var t=a.map(),n=[],i=d;function r(a){var r=a+"",o=t.get(r);if(!o){if(i!==d)return i;t.set(r,o=n.push(a))}return e[(o-1)%e.length]}return e=null==e?[]:u.call(e),r.domain=function(e){if(!arguments.length)return n.slice();n=[],t=a.map();for(var i,o,s=-1,l=e.length;++s<l;)t.has(o=(i=e[s])+"")||t.set(o,n.push(i));return r},r.range=function(t){return arguments.length?(e=u.call(t),r):e.slice()},r.unknown=function(e){return arguments.length?(i=e,r):i},r.copy=function(){return m().domain(n).range(e).unknown(i)},r}function g(){var e,a,n=m().unknown(void 0),i=n.domain,r=n.range,o=[0,1],s=!1,l=0,c=0,u=.5;function d(){var n=i().length,d=o[1]<o[0],m=o[d-0],g=o[1-d];e=(g-m)/Math.max(1,n-l+2*c),s&&(e=Math.floor(e)),m+=(g-m-e*(n-l))*u,a=e*(1-l),s&&(m=Math.round(m),a=Math.round(a));var f=t.range(n).map((function(t){return m+e*t}));return r(d?f.reverse():f)}return delete n.unknown,n.domain=function(e){return arguments.length?(i(e),d()):i()},n.range=function(e){return arguments.length?(o=[+e[0],+e[1]],d()):o.slice()},n.rangeRound=function(e){return o=[+e[0],+e[1]],s=!0,d()},n.bandwidth=function(){return a},n.step=function(){return e},n.round=function(e){return arguments.length?(s=!!e,d()):s},n.padding=function(e){return arguments.length?(l=c=Math.max(0,Math.min(1,e)),d()):l},n.paddingInner=function(e){return arguments.length?(l=Math.max(0,Math.min(1,e)),d()):l},n.paddingOuter=function(e){return arguments.length?(c=Math.max(0,Math.min(1,e)),d()):c},n.align=function(e){return arguments.length?(u=Math.max(0,Math.min(1,e)),d()):u},n.copy=function(){return g().domain(i()).range(o).round(s).paddingInner(l).paddingOuter(c).align(u)},d()}function f(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return f(t())},e}var h=function(e){return function(){return e}},p=function(e){return+e},b=[0,1];function y(e,t){return(t-=e=+e)?function(a){return(a-e)/t}:h(t)}function E(e,t,a,n){var i=e[0],r=e[1],o=t[0],s=t[1];return r<i?(i=a(r,i),o=n(s,o)):(i=a(i,r),o=n(o,s)),function(e){return o(i(e))}}function v(e,a,n,i){var r=Math.min(e.length,a.length)-1,o=new Array(r),s=new Array(r),l=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),a=a.slice().reverse());++l<r;)o[l]=n(e[l],e[l+1]),s[l]=i(a[l],a[l+1]);return function(a){var n=t.bisect(e,a,1,r)-1;return s[n](o[n](a))}}function x(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp())}function _(e,t){var a,i,r,o=b,s=b,l=n.interpolate,d=!1;function m(){return a=Math.min(o.length,s.length)>2?v:E,i=r=null,g}function g(t){return(i||(i=a(o,s,d?function(e){return function(t,a){var n=e(t=+t,a=+a);return function(e){return e<=t?0:e>=a?1:n(e)}}}(e):e,l)))(+t)}return g.invert=function(e){return(r||(r=a(s,o,y,d?function(e){return function(t,a){var n=e(t=+t,a=+a);return function(e){return e<=0?t:e>=1?a:n(e)}}}(t):t)))(+e)},g.domain=function(e){return arguments.length?(o=c.call(e,p),m()):o.slice()},g.range=function(e){return arguments.length?(s=u.call(e),m()):s.slice()},g.rangeRound=function(e){return s=u.call(e),l=n.interpolateRound,m()},g.clamp=function(e){return arguments.length?(d=!!e,m()):d},g.interpolate=function(e){return arguments.length?(l=e,m()):l},m()}function M(e){var a=e.domain;return e.ticks=function(e){var n=a();return t.ticks(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){return function(e,a,n){var r,o=e[0],s=e[e.length-1],l=t.tickStep(o,s,null==a?10:a);switch((n=i.formatSpecifier(null==n?",f":n)).type){case"s":var c=Math.max(Math.abs(o),Math.abs(s));return null!=n.precision||isNaN(r=i.precisionPrefix(l,c))||(n.precision=r),i.formatPrefix(n,c);case"":case"e":case"g":case"p":case"r":null!=n.precision||isNaN(r=i.precisionRound(l,Math.max(Math.abs(o),Math.abs(s))))||(n.precision=r-("e"===n.type));break;case"f":case"%":null!=n.precision||isNaN(r=i.precisionFixed(l))||(n.precision=r-2*("%"===n.type))}return i.format(n)}(a(),e,n)},e.nice=function(n){null==n&&(n=10);var i,r=a(),o=0,s=r.length-1,l=r[o],c=r[s];return c<l&&(i=l,l=c,c=i,i=o,o=s,s=i),(i=t.tickIncrement(l,c,n))>0?(l=Math.floor(l/i)*i,c=Math.ceil(c/i)*i,i=t.tickIncrement(l,c,n)):i<0&&(l=Math.ceil(l*i)/i,c=Math.floor(c*i)/i,i=t.tickIncrement(l,c,n)),i>0?(r[o]=Math.floor(l/i)*i,r[s]=Math.ceil(c/i)*i,a(r)):i<0&&(r[o]=Math.ceil(l*i)/i,r[s]=Math.floor(c*i)/i,a(r)),e},e}var S=function(e,t){var a,n=0,i=(e=e.slice()).length-1,r=e[n],o=e[i];return o<r&&(a=n,n=i,i=a,a=r,r=o,o=a),e[n]=t.floor(r),e[i]=t.ceil(o),e};function T(e,t){return(t=Math.log(t/e))?function(a){return Math.log(a/e)/t}:h(t)}function C(e,t){return e<0?function(a){return-Math.pow(-t,a)*Math.pow(-e,1-a)}:function(a){return Math.pow(t,a)*Math.pow(e,1-a)}}function O(e){return isFinite(e)?+("1e"+e):e<0?0:e}function j(e){return 10===e?O:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}function w(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}function k(e){return function(t){return-e(-t)}}function I(e,t){return e<0?-Math.pow(-e,t):Math.pow(e,t)}function F(){var e=1,t=_((function(t,a){return(a=I(a,e)-(t=I(t,e)))?function(n){return(I(n,e)-t)/a}:h(a)}),(function(t,a){return a=I(a,e)-(t=I(t,e)),function(n){return I(t+a*n,1/e)}})),a=t.domain;return t.exponent=function(t){return arguments.length?(e=+t,a(a())):e},t.copy=function(){return x(t,F().exponent(e))},M(t)}var L=1e3,D=6e4,P=36e5,R=864e5,N=2592e6,A=31536e6;function H(e){return new Date(e)}function U(e){return e instanceof Date?+e:+new Date(+e)}function V(e,a,i,r,o,s,l,u,d){var m=_(y,n.interpolateNumber),g=m.invert,f=m.domain,h=d(".%L"),p=d(":%S"),b=d("%I:%M"),E=d("%I %p"),v=d("%a %d"),M=d("%b %d"),T=d("%B"),C=d("%Y"),O=[[l,1,L],[l,5,5e3],[l,15,15e3],[l,30,3e4],[s,1,D],[s,5,3e5],[s,15,9e5],[s,30,18e5],[o,1,P],[o,3,108e5],[o,6,216e5],[o,12,432e5],[r,1,R],[r,2,1728e5],[i,1,6048e5],[a,1,N],[a,3,7776e6],[e,1,A]];function j(t){return(l(t)<t?h:s(t)<t?p:o(t)<t?b:r(t)<t?E:a(t)<t?i(t)<t?v:M:e(t)<t?T:C)(t)}function w(a,n,i,r){if(null==a&&(a=10),"number"==typeof a){var o=Math.abs(i-n)/a,s=t.bisector((function(e){return e[2]})).right(O,o);s===O.length?(r=t.tickStep(n/A,i/A,a),a=e):s?(r=(s=O[o/O[s-1][2]<O[s][2]/o?s-1:s])[1],a=s[0]):(r=Math.max(t.tickStep(n,i,a),1),a=u)}return null==r?a:a.every(r)}return m.invert=function(e){return new Date(g(e))},m.domain=function(e){return arguments.length?f(c.call(e,U)):f().map(H)},m.ticks=function(e,t){var a,n=f(),i=n[0],r=n[n.length-1],o=r<i;return o&&(a=i,i=r,r=a),a=(a=w(e,i,r,t))?a.range(i,r+1):[],o?a.reverse():a},m.tickFormat=function(e,t){return null==t?j:d(t)},m.nice=function(e,t){var a=f();return(e=w(e,a[0],a[a.length-1],t))?f(S(a,e)):m},m.copy=function(){return x(m,V(e,a,i,r,o,s,l,u,d))},m}var z=function(e){return e.match(/.{6}/g).map((function(e){return"#"+e}))},J=z("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),Y=z("393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6"),B=z("3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9"),$=z("1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5"),q=n.interpolateCubehelixLong(s.cubehelix(300,.5,0),s.cubehelix(-240,.5,1)),W=n.interpolateCubehelixLong(s.cubehelix(-100,.75,.35),s.cubehelix(80,1.5,.8)),G=n.interpolateCubehelixLong(s.cubehelix(260,.75,.35),s.cubehelix(80,1.5,.8)),Q=s.cubehelix();function Z(e){var t=e.length;return function(a){return e[Math.max(0,Math.min(t-1,Math.floor(a*t)))]}}var X=Z(z("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),K=Z(z("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),ee=Z(z("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),te=Z(z("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));e.scaleBand=g,e.scalePoint=function(){return f(g().paddingInner(1))},e.scaleIdentity=function e(){var t=[0,1];function a(e){return+e}return a.invert=a,a.domain=a.range=function(e){return arguments.length?(t=c.call(e,p),a):t.slice()},a.copy=function(){return e().domain(t)},M(a)},e.scaleLinear=function e(){var t=_(y,n.interpolateNumber);return t.copy=function(){return x(t,e())},M(t)},e.scaleLog=function e(){var a=_(T,C).domain([1,10]),n=a.domain,r=10,o=w(10),s=j(10);function l(){return o=w(r),s=j(r),n()[0]<0&&(o=k(o),s=k(s)),a}return a.base=function(e){return arguments.length?(r=+e,l()):r},a.domain=function(e){return arguments.length?(n(e),l()):n()},a.ticks=function(e){var a,i=n(),l=i[0],c=i[i.length-1];(a=c<l)&&(g=l,l=c,c=g);var u,d,m,g=o(l),f=o(c),h=null==e?10:+e,p=[];if(!(r%1)&&f-g<h){if(g=Math.round(g)-1,f=Math.round(f)+1,l>0){for(;g<f;++g)for(d=1,u=s(g);d<r;++d)if(!((m=u*d)<l)){if(m>c)break;p.push(m)}}else for(;g<f;++g)for(d=r-1,u=s(g);d>=1;--d)if(!((m=u*d)<l)){if(m>c)break;p.push(m)}}else p=t.ticks(g,f,Math.min(f-g,h)).map(s);return a?p.reverse():p},a.tickFormat=function(e,t){if(null==t&&(t=10===r?".0e":","),"function"!=typeof t&&(t=i.format(t)),e===1/0)return t;null==e&&(e=10);var n=Math.max(1,r*e/a.ticks().length);return function(e){var a=e/s(Math.round(o(e)));return a*r<r-.5&&(a*=r),a<=n?t(e):""}},a.nice=function(){return n(S(n(),{floor:function(e){return s(Math.floor(o(e)))},ceil:function(e){return s(Math.ceil(o(e)))}}))},a.copy=function(){return x(a,e().base(r))},a},e.scaleOrdinal=m,e.scaleImplicit=d,e.scalePow=F,e.scaleSqrt=function(){return F().exponent(.5)},e.scaleQuantile=function e(){var a=[],n=[],i=[];function r(){var e=0,r=Math.max(1,n.length);for(i=new Array(r-1);++e<r;)i[e-1]=t.quantile(a,e/r);return o}function o(e){if(!isNaN(e=+e))return n[t.bisect(i,e)]}return o.invertExtent=function(e){var t=n.indexOf(e);return t<0?[NaN,NaN]:[t>0?i[t-1]:a[0],t<i.length?i[t]:a[a.length-1]]},o.domain=function(e){if(!arguments.length)return a.slice();a=[];for(var n,i=0,o=e.length;i<o;++i)null==(n=e[i])||isNaN(n=+n)||a.push(n);return a.sort(t.ascending),r()},o.range=function(e){return arguments.length?(n=u.call(e),r()):n.slice()},o.quantiles=function(){return i.slice()},o.copy=function(){return e().domain(a).range(n)},o},e.scaleQuantize=function e(){var a=0,n=1,i=1,r=[.5],o=[0,1];function s(e){if(e<=e)return o[t.bisect(r,e,0,i)]}function l(){var e=-1;for(r=new Array(i);++e<i;)r[e]=((e+1)*n-(e-i)*a)/(i+1);return s}return s.domain=function(e){return arguments.length?(a=+e[0],n=+e[1],l()):[a,n]},s.range=function(e){return arguments.length?(i=(o=u.call(e)).length-1,l()):o.slice()},s.invertExtent=function(e){var t=o.indexOf(e);return t<0?[NaN,NaN]:t<1?[a,r[0]]:t>=i?[r[i-1],n]:[r[t-1],r[t]]},s.copy=function(){return e().domain([a,n]).range(o)},M(s)},e.scaleThreshold=function e(){var a=[.5],n=[0,1],i=1;function r(e){if(e<=e)return n[t.bisect(a,e,0,i)]}return r.domain=function(e){return arguments.length?(a=u.call(e),i=Math.min(a.length,n.length-1),r):a.slice()},r.range=function(e){return arguments.length?(n=u.call(e),i=Math.min(a.length,n.length-1),r):n.slice()},r.invertExtent=function(e){var t=n.indexOf(e);return[a[t-1],a[t]]},r.copy=function(){return e().domain(a).range(n)},r},e.scaleTime=function(){return V(r.timeYear,r.timeMonth,r.timeWeek,r.timeDay,r.timeHour,r.timeMinute,r.timeSecond,r.timeMillisecond,o.timeFormat).domain([new Date(2e3,0,1),new Date(2e3,0,2)])},e.scaleUtc=function(){return V(r.utcYear,r.utcMonth,r.utcWeek,r.utcDay,r.utcHour,r.utcMinute,r.utcSecond,r.utcMillisecond,o.utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)])},e.schemeCategory10=J,e.schemeCategory20b=Y,e.schemeCategory20c=B,e.schemeCategory20=$,e.interpolateCubehelixDefault=q,e.interpolateRainbow=function(e){(e<0||e>1)&&(e-=Math.floor(e));var t=Math.abs(e-.5);return Q.h=360*e-100,Q.s=1.5-1.5*t,Q.l=.8-.9*t,Q+""},e.interpolateWarm=W,e.interpolateCool=G,e.interpolateViridis=X,e.interpolateMagma=K,e.interpolateInferno=ee,e.interpolatePlasma=te,e.scaleSequential=function e(t){var a=0,n=1,i=!1;function r(e){var r=(e-a)/(n-a);return t(i?Math.max(0,Math.min(1,r)):r)}return r.domain=function(e){return arguments.length?(a=+e[0],n=+e[1],r):[a,n]},r.clamp=function(e){return arguments.length?(i=!!e,r):i},r.interpolator=function(e){return arguments.length?(t=e,r):t},r.copy=function(){return e(t).domain([a,n]).clamp(i)},M(r)},Object.defineProperty(e,"__esModule",{value:!0})}(t,a(125),a(257),a(258),a(259),a(217),a(260),a(216))},145:function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return o}));var n=a(12),i=a(15);const r=i.euiStyled.div`
  display: flex;
  flex-direction: column;
  flex: 1 0 auto;
  width: 100%
`,o=i.euiStyled.div`
  flex: 1 0 0%;
  display: flex;
  flex-direction: row;
  background-color: ${e=>e.theme.eui.euiColorEmptyShade};
`;Object(i.euiStyled)(n.EuiPage)`
  align-self: stretch;
  flex: 1 0 0%;
`},155:function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var n=a(2),i=a.n(n),r=a(51),o=a(23),s=a(92),l=a(88),c=a(98),u=a(99);const d=({location:e,match:t})=>{const a=t.params.sourceId||"default",n=Object(u.a)(e),d=Object(o.flowRight)(Object(s.c)({language:"kuery",query:n}),Object(l.c)(Object(u.c)(e)),Object(c.a)(a))("");return i.a.createElement(r.Redirect,{to:`/stream?${d}`})};var m=a(109);const g=a(74).d.map((e=>e.id)).join("|"),f=e=>i.a.createElement(r.Switch,null,i.a.createElement(r.Route,{path:`${e.match.url}/:sourceId?/:nodeType(${g})-logs/:nodeId`,component:m.a}),i.a.createElement(r.Route,{path:`${e.match.url}/:sourceId?/logs`,component:d}),i.a.createElement(r.Route,{path:`${e.match.url}/:sourceId?`,component:d}),i.a.createElement(r.Redirect,{to:"/"}))},214:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(52),i=a(2);t.default=function(e){void 0===e&&(e=new Set);var t=i.useState(e),a=t[0],r=t[1],o=i.useMemo((function(){return{add:function(e){return r((function(t){return new Set(n.__spreadArrays(Array.from(t),[e]))}))},remove:function(e){return r((function(t){return new Set(Array.from(t).filter((function(t){return t!==e})))}))},toggle:function(e){return r((function(t){return t.has(e)?new Set(Array.from(t).filter((function(t){return t!==e}))):new Set(n.__spreadArrays(Array.from(t),[e]))}))},reset:function(){return r(e)}}}),[r]),s=n.__assign({has:i.useCallback((function(e){return a.has(e)}),[a])},o);return[a,s]}},216:function(e,t,a){!function(e){"use strict";function t(e,t,a){e.prototype=t.prototype=a,a.constructor=e}function a(e,t){var a=Object.create(e.prototype);for(var n in t)a[n]=t[n];return a}function n(){}var i=.7,r=1/i,o="\\s*([+-]?\\d+)\\s*",s="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",l="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",c=/^#([0-9a-f]{3,8})$/,u=new RegExp("^rgb\\("+[o,o,o]+"\\)$"),d=new RegExp("^rgb\\("+[l,l,l]+"\\)$"),m=new RegExp("^rgba\\("+[o,o,o,s]+"\\)$"),g=new RegExp("^rgba\\("+[l,l,l,s]+"\\)$"),f=new RegExp("^hsl\\("+[s,l,l]+"\\)$"),h=new RegExp("^hsla\\("+[s,l,l,s]+"\\)$"),p={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function b(){return this.rgb().formatHex()}function y(){return this.rgb().formatRgb()}function E(e){var t,a;return e=(e+"").trim().toLowerCase(),(t=c.exec(e))?(a=t[1].length,t=parseInt(t[1],16),6===a?v(t):3===a?new S(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===a?x(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===a?x(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=u.exec(e))?new S(t[1],t[2],t[3],1):(t=d.exec(e))?new S(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=m.exec(e))?x(t[1],t[2],t[3],t[4]):(t=g.exec(e))?x(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=f.exec(e))?j(t[1],t[2]/100,t[3]/100,1):(t=h.exec(e))?j(t[1],t[2]/100,t[3]/100,t[4]):p.hasOwnProperty(e)?v(p[e]):"transparent"===e?new S(NaN,NaN,NaN,0):null}function v(e){return new S(e>>16&255,e>>8&255,255&e,1)}function x(e,t,a,n){return n<=0&&(e=t=a=NaN),new S(e,t,a,n)}function _(e){return e instanceof n||(e=E(e)),e?new S((e=e.rgb()).r,e.g,e.b,e.opacity):new S}function M(e,t,a,n){return 1===arguments.length?_(e):new S(e,t,a,null==n?1:n)}function S(e,t,a,n){this.r=+e,this.g=+t,this.b=+a,this.opacity=+n}function T(){return"#"+O(this.r)+O(this.g)+O(this.b)}function C(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}function O(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function j(e,t,a,n){return n<=0?e=t=a=NaN:a<=0||a>=1?e=t=NaN:t<=0&&(e=NaN),new I(e,t,a,n)}function w(e){if(e instanceof I)return new I(e.h,e.s,e.l,e.opacity);if(e instanceof n||(e=E(e)),!e)return new I;if(e instanceof I)return e;var t=(e=e.rgb()).r/255,a=e.g/255,i=e.b/255,r=Math.min(t,a,i),o=Math.max(t,a,i),s=NaN,l=o-r,c=(o+r)/2;return l?(s=t===o?(a-i)/l+6*(a<i):a===o?(i-t)/l+2:(t-a)/l+4,l/=c<.5?o+r:2-o-r,s*=60):l=c>0&&c<1?0:s,new I(s,l,c,e.opacity)}function k(e,t,a,n){return 1===arguments.length?w(e):new I(e,t,a,null==n?1:n)}function I(e,t,a,n){this.h=+e,this.s=+t,this.l=+a,this.opacity=+n}function F(e,t,a){return 255*(e<60?t+(a-t)*e/60:e<180?a:e<240?t+(a-t)*(240-e)/60:t)}t(n,E,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:b,formatHex:b,formatHsl:function(){return w(this).formatHsl()},formatRgb:y,toString:y}),t(S,M,a(n,{brighter:function(e){return e=null==e?r:Math.pow(r,e),new S(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?i:Math.pow(i,e),new S(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:T,formatHex:T,formatRgb:C,toString:C})),t(I,k,a(n,{brighter:function(e){return e=null==e?r:Math.pow(r,e),new I(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?i:Math.pow(i,e),new I(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,a=this.l,n=a+(a<.5?a:1-a)*t,i=2*a-n;return new S(F(e>=240?e-240:e+120,i,n),F(e,i,n),F(e<120?e+240:e-120,i,n),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}}));var L=Math.PI/180,D=180/Math.PI,P=.96422,R=.82521,N=4/29,A=6/29,H=3*A*A;function U(e){if(e instanceof z)return new z(e.l,e.a,e.b,e.opacity);if(e instanceof G)return Q(e);e instanceof S||(e=_(e));var t,a,n=$(e.r),i=$(e.g),r=$(e.b),o=J((.2225045*n+.7168786*i+.0606169*r)/1);return n===i&&i===r?t=a=o:(t=J((.4360747*n+.3850649*i+.1430804*r)/P),a=J((.0139322*n+.0971045*i+.7141733*r)/R)),new z(116*o-16,500*(t-o),200*(o-a),e.opacity)}function V(e,t,a,n){return 1===arguments.length?U(e):new z(e,t,a,null==n?1:n)}function z(e,t,a,n){this.l=+e,this.a=+t,this.b=+a,this.opacity=+n}function J(e){return e>.008856451679035631?Math.pow(e,1/3):e/H+N}function Y(e){return e>A?e*e*e:H*(e-N)}function B(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function $(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function q(e){if(e instanceof G)return new G(e.h,e.c,e.l,e.opacity);if(e instanceof z||(e=U(e)),0===e.a&&0===e.b)return new G(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*D;return new G(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function W(e,t,a,n){return 1===arguments.length?q(e):new G(e,t,a,null==n?1:n)}function G(e,t,a,n){this.h=+e,this.c=+t,this.l=+a,this.opacity=+n}function Q(e){if(isNaN(e.h))return new z(e.l,0,0,e.opacity);var t=e.h*L;return new z(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}t(z,V,a(n,{brighter:function(e){return new z(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker:function(e){return new z(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,a=isNaN(this.b)?e:e-this.b/200;return new S(B(3.1338561*(t=P*Y(t))-1.6168667*(e=1*Y(e))-.4906146*(a=R*Y(a))),B(-.9787684*t+1.9161415*e+.033454*a),B(.0719453*t-.2289914*e+1.4052427*a),this.opacity)}})),t(G,W,a(n,{brighter:function(e){return new G(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker:function(e){return new G(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb:function(){return Q(this).rgb()}}));var Z=-.14861,X=1.78277,K=-.29227,ee=-.90649,te=1.97294,ae=te*ee,ne=te*X,ie=X*K-ee*Z;function re(e){if(e instanceof se)return new se(e.h,e.s,e.l,e.opacity);e instanceof S||(e=_(e));var t=e.r/255,a=e.g/255,n=e.b/255,i=(ie*n+ae*t-ne*a)/(ie+ae-ne),r=n-i,o=(te*(a-i)-K*r)/ee,s=Math.sqrt(o*o+r*r)/(te*i*(1-i)),l=s?Math.atan2(o,r)*D-120:NaN;return new se(l<0?l+360:l,s,i,e.opacity)}function oe(e,t,a,n){return 1===arguments.length?re(e):new se(e,t,a,null==n?1:n)}function se(e,t,a,n){this.h=+e,this.s=+t,this.l=+a,this.opacity=+n}t(se,oe,a(n,{brighter:function(e){return e=null==e?r:Math.pow(r,e),new se(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?i:Math.pow(i,e),new se(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*L,t=+this.l,a=isNaN(this.s)?0:this.s*t*(1-t),n=Math.cos(e),i=Math.sin(e);return new S(255*(t+a*(Z*n+X*i)),255*(t+a*(K*n+ee*i)),255*(t+a*(te*n)),this.opacity)}})),e.color=E,e.cubehelix=oe,e.gray=function(e,t){return new z(e,0,0,null==t?1:t)},e.hcl=W,e.hsl=k,e.lab=V,e.lch=function(e,t,a,n){return 1===arguments.length?q(e):new G(a,t,e,null==n?1:n)},e.rgb=M,Object.defineProperty(e,"__esModule",{value:!0})}(t)},217:function(e,t,a){!function(e){"use strict";var t=new Date,a=new Date;function n(e,i,r,o){function s(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return s.floor=function(t){return e(t=new Date(+t)),t},s.ceil=function(t){return e(t=new Date(t-1)),i(t,1),e(t),t},s.round=function(e){var t=s(e),a=s.ceil(e);return e-t<a-e?t:a},s.offset=function(e,t){return i(e=new Date(+e),null==t?1:Math.floor(t)),e},s.range=function(t,a,n){var r,o=[];if(t=s.ceil(t),n=null==n?1:Math.floor(n),!(t<a&&n>0))return o;do{o.push(r=new Date(+t)),i(t,n),e(t)}while(r<t&&t<a);return o},s.filter=function(t){return n((function(a){if(a>=a)for(;e(a),!t(a);)a.setTime(a-1)}),(function(e,a){if(e>=e)if(a<0)for(;++a<=0;)for(;i(e,-1),!t(e););else for(;--a>=0;)for(;i(e,1),!t(e););}))},r&&(s.count=function(n,i){return t.setTime(+n),a.setTime(+i),e(t),e(a),Math.floor(r(t,a))},s.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?s.filter(o?function(t){return o(t)%e==0}:function(t){return s.count(0,t)%e==0}):s:null}),s}var i=n((function(){}),(function(e,t){e.setTime(+e+t)}),(function(e,t){return t-e}));i.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?n((function(t){t.setTime(Math.floor(t/e)*e)}),(function(t,a){t.setTime(+t+a*e)}),(function(t,a){return(a-t)/e})):i:null};var r=i.range,o=1e3,s=6e4,l=36e5,c=864e5,u=6048e5,d=n((function(e){e.setTime(e-e.getMilliseconds())}),(function(e,t){e.setTime(+e+t*o)}),(function(e,t){return(t-e)/o}),(function(e){return e.getUTCSeconds()})),m=d.range,g=n((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*o)}),(function(e,t){e.setTime(+e+t*s)}),(function(e,t){return(t-e)/s}),(function(e){return e.getMinutes()})),f=g.range,h=n((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*o-e.getMinutes()*s)}),(function(e,t){e.setTime(+e+t*l)}),(function(e,t){return(t-e)/l}),(function(e){return e.getHours()})),p=h.range,b=n((function(e){e.setHours(0,0,0,0)}),(function(e,t){e.setDate(e.getDate()+t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*s)/c}),(function(e){return e.getDate()-1})),y=b.range;function E(e){return n((function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)}),(function(e,t){e.setDate(e.getDate()+7*t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*s)/u}))}var v=E(0),x=E(1),_=E(2),M=E(3),S=E(4),T=E(5),C=E(6),O=v.range,j=x.range,w=_.range,k=M.range,I=S.range,F=T.range,L=C.range,D=n((function(e){e.setDate(1),e.setHours(0,0,0,0)}),(function(e,t){e.setMonth(e.getMonth()+t)}),(function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())}),(function(e){return e.getMonth()})),P=D.range,R=n((function(e){e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,t){e.setFullYear(e.getFullYear()+t)}),(function(e,t){return t.getFullYear()-e.getFullYear()}),(function(e){return e.getFullYear()}));R.every=function(e){return isFinite(e=Math.floor(e))&&e>0?n((function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,a){t.setFullYear(t.getFullYear()+a*e)})):null};var N=R.range,A=n((function(e){e.setUTCSeconds(0,0)}),(function(e,t){e.setTime(+e+t*s)}),(function(e,t){return(t-e)/s}),(function(e){return e.getUTCMinutes()})),H=A.range,U=n((function(e){e.setUTCMinutes(0,0,0)}),(function(e,t){e.setTime(+e+t*l)}),(function(e,t){return(t-e)/l}),(function(e){return e.getUTCHours()})),V=U.range,z=n((function(e){e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+t)}),(function(e,t){return(t-e)/c}),(function(e){return e.getUTCDate()-1})),J=z.range;function Y(e){return n((function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+7*t)}),(function(e,t){return(t-e)/u}))}var B=Y(0),$=Y(1),q=Y(2),W=Y(3),G=Y(4),Q=Y(5),Z=Y(6),X=B.range,K=$.range,ee=q.range,te=W.range,ae=G.range,ne=Q.range,ie=Z.range,re=n((function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCMonth(e.getUTCMonth()+t)}),(function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())}),(function(e){return e.getUTCMonth()})),oe=re.range,se=n((function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)}),(function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()}),(function(e){return e.getUTCFullYear()}));se.every=function(e){return isFinite(e=Math.floor(e))&&e>0?n((function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,a){t.setUTCFullYear(t.getUTCFullYear()+a*e)})):null};var le=se.range;e.timeDay=b,e.timeDays=y,e.timeFriday=T,e.timeFridays=F,e.timeHour=h,e.timeHours=p,e.timeInterval=n,e.timeMillisecond=i,e.timeMilliseconds=r,e.timeMinute=g,e.timeMinutes=f,e.timeMonday=x,e.timeMondays=j,e.timeMonth=D,e.timeMonths=P,e.timeSaturday=C,e.timeSaturdays=L,e.timeSecond=d,e.timeSeconds=m,e.timeSunday=v,e.timeSundays=O,e.timeThursday=S,e.timeThursdays=I,e.timeTuesday=_,e.timeTuesdays=w,e.timeWednesday=M,e.timeWednesdays=k,e.timeWeek=v,e.timeWeeks=O,e.timeYear=R,e.timeYears=N,e.utcDay=z,e.utcDays=J,e.utcFriday=Q,e.utcFridays=ne,e.utcHour=U,e.utcHours=V,e.utcMillisecond=i,e.utcMilliseconds=r,e.utcMinute=A,e.utcMinutes=H,e.utcMonday=$,e.utcMondays=K,e.utcMonth=re,e.utcMonths=oe,e.utcSaturday=Z,e.utcSaturdays=ie,e.utcSecond=d,e.utcSeconds=m,e.utcSunday=B,e.utcSundays=X,e.utcThursday=G,e.utcThursdays=ae,e.utcTuesday=q,e.utcTuesdays=ee,e.utcWednesday=W,e.utcWednesdays=te,e.utcWeek=B,e.utcWeeks=X,e.utcYear=se,e.utcYears=le,Object.defineProperty(e,"__esModule",{value:!0})}(t)},246:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(52),i=a(247),r=n.__importDefault(a(249));t.default=function(e,t){r.default(e,t,i.isDeepEqual)}},247:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDeepEqual=t.off=t.on=t.isClient=void 0;var n=a(52).__importDefault(a(248));t.isClient="object"==typeof window,t.on=function(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];return e.addEventListener.apply(e,t)},t.off=function(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];return e.removeEventListener.apply(e,t)},t.isDeepEqual=n.default},248:function(e,t,a){"use strict";e.exports=function e(t,a){if(t===a)return!0;if(t&&a&&"object"==typeof t&&"object"==typeof a){if(t.constructor!==a.constructor)return!1;var n,i,r;if(Array.isArray(t)){if((n=t.length)!=a.length)return!1;for(i=n;0!=i--;)if(!e(t[i],a[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===a.source&&t.flags===a.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===a.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===a.toString();if((n=(r=Object.keys(t)).length)!==Object.keys(a).length)return!1;for(i=n;0!=i--;)if(!Object.prototype.hasOwnProperty.call(a,r[i]))return!1;for(i=n;0!=i--;){var o=r[i];if(!("_owner"===o&&t.$$typeof||e(t[o],a[o])))return!1}return!0}return t!=t&&a!=a}},249:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2);t.default=function(e,t,a){var i=n.useRef(void 0);i.current&&a(t,i.current)||(i.current=t),n.useEffect(e,i.current)}},257:function(e,t,a){!function(e){"use strict";var t="$";function a(){}function n(e,t){var n=new a;if(e instanceof a)e.each((function(e,t){n.set(t,e)}));else if(Array.isArray(e)){var i,r=-1,o=e.length;if(null==t)for(;++r<o;)n.set(r,e[r]);else for(;++r<o;)n.set(t(i=e[r],r,e),i)}else if(e)for(var s in e)n.set(s,e[s]);return n}function i(){return{}}function r(e,t,a){e[t]=a}function o(){return n()}function s(e,t,a){e.set(t,a)}function l(){}a.prototype=n.prototype={constructor:a,has:function(e){return t+e in this},get:function(e){return this[t+e]},set:function(e,a){return this[t+e]=a,this},remove:function(e){var a=t+e;return a in this&&delete this[a]},clear:function(){for(var e in this)e[0]===t&&delete this[e]},keys:function(){var e=[];for(var a in this)a[0]===t&&e.push(a.slice(1));return e},values:function(){var e=[];for(var a in this)a[0]===t&&e.push(this[a]);return e},entries:function(){var e=[];for(var a in this)a[0]===t&&e.push({key:a.slice(1),value:this[a]});return e},size:function(){var e=0;for(var a in this)a[0]===t&&++e;return e},empty:function(){for(var e in this)if(e[0]===t)return!1;return!0},each:function(e){for(var a in this)a[0]===t&&e(this[a],a.slice(1),this)}};var c=n.prototype;function u(e,t){var a=new l;if(e instanceof l)e.each((function(e){a.add(e)}));else if(e){var n=-1,i=e.length;if(null==t)for(;++n<i;)a.add(e[n]);else for(;++n<i;)a.add(t(e[n],n,e))}return a}l.prototype=u.prototype={constructor:l,has:c.has,add:function(e){return this[t+(e+="")]=e,this},remove:c.remove,clear:c.clear,values:c.keys,size:c.size,empty:c.empty,each:c.each},e.nest=function(){var e,t,a,l=[],c=[];function u(a,i,r,o){if(i>=l.length)return null!=e&&a.sort(e),null!=t?t(a):a;for(var s,c,d,m=-1,g=a.length,f=l[i++],h=n(),p=r();++m<g;)(d=h.get(s=f(c=a[m])+""))?d.push(c):h.set(s,[c]);return h.each((function(e,t){o(p,t,u(e,i,r,o))})),p}function d(e,a){if(++a>l.length)return e;var n,i=c[a-1];return null!=t&&a>=l.length?n=e.entries():(n=[],e.each((function(e,t){n.push({key:t,values:d(e,a)})}))),null!=i?n.sort((function(e,t){return i(e.key,t.key)})):n}return a={object:function(e){return u(e,0,i,r)},map:function(e){return u(e,0,o,s)},entries:function(e){return d(u(e,0,o,s),0)},key:function(e){return l.push(e),a},sortKeys:function(e){return c[l.length-1]=e,a},sortValues:function(t){return e=t,a},rollup:function(e){return t=e,a}}},e.set=u,e.map=n,e.keys=function(e){var t=[];for(var a in e)t.push(a);return t},e.values=function(e){var t=[];for(var a in e)t.push(e[a]);return t},e.entries=function(e){var t=[];for(var a in e)t.push({key:a,value:e[a]});return t},Object.defineProperty(e,"__esModule",{value:!0})}(t)},258:function(e,t,a){!function(e,t){"use strict";function a(e,t,a,n,i){var r=e*e,o=r*e;return((1-3*e+3*r-o)*t+(4-6*r+3*o)*a+(1+3*e+3*r-3*o)*n+o*i)/6}function n(e){var t=e.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),r=e[i],o=e[i+1],s=i>0?e[i-1]:2*r-o,l=i<t-1?e[i+2]:2*o-r;return a((n-i/t)*t,s,r,o,l)}}function i(e){var t=e.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*t),r=e[(i+t-1)%t],o=e[i%t],s=e[(i+1)%t],l=e[(i+2)%t];return a((n-i/t)*t,r,o,s,l)}}function r(e){return function(){return e}}function o(e,t){return function(a){return e+a*t}}function s(e,t){var a=t-e;return a?o(e,a>180||a<-180?a-360*Math.round(a/360):a):r(isNaN(e)?t:e)}function l(e){return 1==(e=+e)?c:function(t,a){return a-t?function(e,t,a){return e=Math.pow(e,a),t=Math.pow(t,a)-e,a=1/a,function(n){return Math.pow(e+n*t,a)}}(t,a,e):r(isNaN(t)?a:t)}}function c(e,t){var a=t-e;return a?o(e,a):r(isNaN(e)?t:e)}var u=function e(a){var n=l(a);function i(e,a){var i=n((e=t.rgb(e)).r,(a=t.rgb(a)).r),r=n(e.g,a.g),o=n(e.b,a.b),s=c(e.opacity,a.opacity);return function(t){return e.r=i(t),e.g=r(t),e.b=o(t),e.opacity=s(t),e+""}}return i.gamma=e,i}(1);function d(e){return function(a){var n,i,r=a.length,o=new Array(r),s=new Array(r),l=new Array(r);for(n=0;n<r;++n)i=t.rgb(a[n]),o[n]=i.r||0,s[n]=i.g||0,l[n]=i.b||0;return o=e(o),s=e(s),l=e(l),i.opacity=1,function(e){return i.r=o(e),i.g=s(e),i.b=l(e),i+""}}}var m=d(n),g=d(i);function f(e,t){t||(t=[]);var a,n=e?Math.min(t.length,e.length):0,i=t.slice();return function(r){for(a=0;a<n;++a)i[a]=e[a]*(1-r)+t[a]*r;return i}}function h(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function p(e,t){var a,n=t?t.length:0,i=e?Math.min(n,e.length):0,r=new Array(i),o=new Array(n);for(a=0;a<i;++a)r[a]=M(e[a],t[a]);for(;a<n;++a)o[a]=t[a];return function(e){for(a=0;a<i;++a)o[a]=r[a](e);return o}}function b(e,t){var a=new Date;return e=+e,t=+t,function(n){return a.setTime(e*(1-n)+t*n),a}}function y(e,t){return e=+e,t=+t,function(a){return e*(1-a)+t*a}}function E(e,t){var a,n={},i={};for(a in null!==e&&"object"==typeof e||(e={}),null!==t&&"object"==typeof t||(t={}),t)a in e?n[a]=M(e[a],t[a]):i[a]=t[a];return function(e){for(a in n)i[a]=n[a](e);return i}}var v=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,x=new RegExp(v.source,"g");function _(e,t){var a,n,i,r=v.lastIndex=x.lastIndex=0,o=-1,s=[],l=[];for(e+="",t+="";(a=v.exec(e))&&(n=x.exec(t));)(i=n.index)>r&&(i=t.slice(r,i),s[o]?s[o]+=i:s[++o]=i),(a=a[0])===(n=n[0])?s[o]?s[o]+=n:s[++o]=n:(s[++o]=null,l.push({i:o,x:y(a,n)})),r=x.lastIndex;return r<t.length&&(i=t.slice(r),s[o]?s[o]+=i:s[++o]=i),s.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var a,n=0;n<t;++n)s[(a=l[n]).i]=a.x(e);return s.join("")})}function M(e,a){var n,i=typeof a;return null==a||"boolean"===i?r(a):("number"===i?y:"string"===i?(n=t.color(a))?(a=n,u):_:a instanceof t.color?u:a instanceof Date?b:h(a)?f:Array.isArray(a)?p:"function"!=typeof a.valueOf&&"function"!=typeof a.toString||isNaN(a)?E:y)(e,a)}var S,T,C,O,j=180/Math.PI,w={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function k(e,t,a,n,i,r){var o,s,l;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(l=e*a+t*n)&&(a-=e*l,n-=t*l),(s=Math.sqrt(a*a+n*n))&&(a/=s,n/=s,l/=s),e*n<t*a&&(e=-e,t=-t,l=-l,o=-o),{translateX:i,translateY:r,rotate:Math.atan2(t,e)*j,skewX:Math.atan(l)*j,scaleX:o,scaleY:s}}function I(e,t,a,n){function i(e){return e.length?e.pop()+" ":""}return function(r,o){var s=[],l=[];return r=e(r),o=e(o),function(e,n,i,r,o,s){if(e!==i||n!==r){var l=o.push("translate(",null,t,null,a);s.push({i:l-4,x:y(e,i)},{i:l-2,x:y(n,r)})}else(i||r)&&o.push("translate("+i+t+r+a)}(r.translateX,r.translateY,o.translateX,o.translateY,s,l),function(e,t,a,r){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),r.push({i:a.push(i(a)+"rotate(",null,n)-2,x:y(e,t)})):t&&a.push(i(a)+"rotate("+t+n)}(r.rotate,o.rotate,s,l),function(e,t,a,r){e!==t?r.push({i:a.push(i(a)+"skewX(",null,n)-2,x:y(e,t)}):t&&a.push(i(a)+"skewX("+t+n)}(r.skewX,o.skewX,s,l),function(e,t,a,n,r,o){if(e!==a||t!==n){var s=r.push(i(r)+"scale(",null,",",null,")");o.push({i:s-4,x:y(e,a)},{i:s-2,x:y(t,n)})}else 1===a&&1===n||r.push(i(r)+"scale("+a+","+n+")")}(r.scaleX,r.scaleY,o.scaleX,o.scaleY,s,l),r=o=null,function(e){for(var t,a=-1,n=l.length;++a<n;)s[(t=l[a]).i]=t.x(e);return s.join("")}}}var F=I((function(e){return"none"===e?w:(S||(S=document.createElement("DIV"),T=document.documentElement,C=document.defaultView),S.style.transform=e,e=C.getComputedStyle(T.appendChild(S),null).getPropertyValue("transform"),T.removeChild(S),k(+(e=e.slice(7,-1).split(","))[0],+e[1],+e[2],+e[3],+e[4],+e[5]))}),"px, ","px)","deg)"),L=I((function(e){return null==e?w:(O||(O=document.createElementNS("http://www.w3.org/2000/svg","g")),O.setAttribute("transform",e),(e=O.transform.baseVal.consolidate())?k((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):w)}),", ",")",")"),D=Math.SQRT2;function P(e){return((e=Math.exp(e))+1/e)/2}function R(e){return function(a,n){var i=e((a=t.hsl(a)).h,(n=t.hsl(n)).h),r=c(a.s,n.s),o=c(a.l,n.l),s=c(a.opacity,n.opacity);return function(e){return a.h=i(e),a.s=r(e),a.l=o(e),a.opacity=s(e),a+""}}}var N=R(s),A=R(c);function H(e){return function(a,n){var i=e((a=t.hcl(a)).h,(n=t.hcl(n)).h),r=c(a.c,n.c),o=c(a.l,n.l),s=c(a.opacity,n.opacity);return function(e){return a.h=i(e),a.c=r(e),a.l=o(e),a.opacity=s(e),a+""}}}var U=H(s),V=H(c);function z(e){return function a(n){function i(a,i){var r=e((a=t.cubehelix(a)).h,(i=t.cubehelix(i)).h),o=c(a.s,i.s),s=c(a.l,i.l),l=c(a.opacity,i.opacity);return function(e){return a.h=r(e),a.s=o(e),a.l=s(Math.pow(e,n)),a.opacity=l(e),a+""}}return n=+n,i.gamma=a,i}(1)}var J=z(s),Y=z(c);e.interpolate=M,e.interpolateArray=function(e,t){return(h(t)?f:p)(e,t)},e.interpolateBasis=n,e.interpolateBasisClosed=i,e.interpolateCubehelix=J,e.interpolateCubehelixLong=Y,e.interpolateDate=b,e.interpolateDiscrete=function(e){var t=e.length;return function(a){return e[Math.max(0,Math.min(t-1,Math.floor(a*t)))]}},e.interpolateHcl=U,e.interpolateHclLong=V,e.interpolateHsl=N,e.interpolateHslLong=A,e.interpolateHue=function(e,t){var a=s(+e,+t);return function(e){var t=a(e);return t-360*Math.floor(t/360)}},e.interpolateLab=function(e,a){var n=c((e=t.lab(e)).l,(a=t.lab(a)).l),i=c(e.a,a.a),r=c(e.b,a.b),o=c(e.opacity,a.opacity);return function(t){return e.l=n(t),e.a=i(t),e.b=r(t),e.opacity=o(t),e+""}},e.interpolateNumber=y,e.interpolateNumberArray=f,e.interpolateObject=E,e.interpolateRgb=u,e.interpolateRgbBasis=m,e.interpolateRgbBasisClosed=g,e.interpolateRound=function(e,t){return e=+e,t=+t,function(a){return Math.round(e*(1-a)+t*a)}},e.interpolateString=_,e.interpolateTransformCss=F,e.interpolateTransformSvg=L,e.interpolateZoom=function(e,t){var a,n,i=e[0],r=e[1],o=e[2],s=t[0],l=t[1],c=t[2],u=s-i,d=l-r,m=u*u+d*d;if(m<1e-12)n=Math.log(c/o)/D,a=function(e){return[i+e*u,r+e*d,o*Math.exp(D*e*n)]};else{var g=Math.sqrt(m),f=(c*c-o*o+4*m)/(2*o*2*g),h=(c*c-o*o-4*m)/(2*c*2*g),p=Math.log(Math.sqrt(f*f+1)-f),b=Math.log(Math.sqrt(h*h+1)-h);n=(b-p)/D,a=function(e){var t,a=e*n,s=P(p),l=o/(2*g)*(s*(t=D*a+p,((t=Math.exp(2*t))-1)/(t+1))-function(e){return((e=Math.exp(e))-1/e)/2}(p));return[i+l*u,r+l*d,o*s/P(D*a+p)]}}return a.duration=1e3*n,a},e.piecewise=function(e,t){for(var a=0,n=t.length-1,i=t[0],r=new Array(n<0?0:n);a<n;)r[a]=e(i,i=t[++a]);return function(e){var t=Math.max(0,Math.min(n-1,Math.floor(e*=n)));return r[t](e-t)}},e.quantize=function(e,t){for(var a=new Array(t),n=0;n<t;++n)a[n]=e(n/(t-1));return a},Object.defineProperty(e,"__esModule",{value:!0})}(t,a(216))},259:function(e,t,a){!function(e){"use strict";function t(e,t){if((a=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var a,n=e.slice(0,a);return[n.length>1?n[0]+n.slice(2):n,+e.slice(a+1)]}function a(e){return(e=t(Math.abs(e)))?e[1]:NaN}var n,i=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function r(e){if(!(t=i.exec(e)))throw new Error("invalid format: "+e);var t;return new o({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function o(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function s(e,a){var n=t(e,a);if(!n)return e+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}r.prototype=o.prototype,o.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var l={"%":function(e,t){return(100*e).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.round(e).toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return s(100*e,t)},r:s,s:function(e,a){var i=t(e,a);if(!i)return e+"";var r=i[0],o=i[1],s=o-(n=3*Math.max(-8,Math.min(8,Math.floor(o/3))))+1,l=r.length;return s===l?r:s>l?r+new Array(s-l+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+t(e,Math.max(0,a+s-1))[0]},X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function c(e){return e}var u,d=Array.prototype.map,m=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function g(e){var t,i,o=void 0===e.grouping||void 0===e.thousands?c:(t=d.call(e.grouping,Number),i=e.thousands+"",function(e,a){for(var n=e.length,r=[],o=0,s=t[0],l=0;n>0&&s>0&&(l+s+1>a&&(s=Math.max(1,a-l)),r.push(e.substring(n-=s,n+s)),!((l+=s+1)>a));)s=t[o=(o+1)%t.length];return r.reverse().join(i)}),s=void 0===e.currency?"":e.currency[0]+"",u=void 0===e.currency?"":e.currency[1]+"",g=void 0===e.decimal?".":e.decimal+"",f=void 0===e.numerals?c:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(d.call(e.numerals,String)),h=void 0===e.percent?"%":e.percent+"",p=void 0===e.minus?"-":e.minus+"",b=void 0===e.nan?"NaN":e.nan+"";function y(e){var t=(e=r(e)).fill,a=e.align,i=e.sign,c=e.symbol,d=e.zero,y=e.width,E=e.comma,v=e.precision,x=e.trim,_=e.type;"n"===_?(E=!0,_="g"):l[_]||(void 0===v&&(v=12),x=!0,_="g"),(d||"0"===t&&"="===a)&&(d=!0,t="0",a="=");var M="$"===c?s:"#"===c&&/[boxX]/.test(_)?"0"+_.toLowerCase():"",S="$"===c?u:/[%p]/.test(_)?h:"",T=l[_],C=/[defgprs%]/.test(_);function O(e){var r,s,l,c=M,u=S;if("c"===_)u=T(e)+u,e="";else{var h=(e=+e)<0||1/e<0;if(e=isNaN(e)?b:T(Math.abs(e),v),x&&(e=function(e){e:for(var t,a=e.length,n=1,i=-1;n<a;++n)switch(e[n]){case".":i=t=n;break;case"0":0===i&&(i=n),t=n;break;default:if(!+e[n])break e;i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(t+1):e}(e)),h&&0==+e&&"+"!==i&&(h=!1),c=(h?"("===i?i:p:"-"===i||"("===i?"":i)+c,u=("s"===_?m[8+n/3]:"")+u+(h&&"("===i?")":""),C)for(r=-1,s=e.length;++r<s;)if(48>(l=e.charCodeAt(r))||l>57){u=(46===l?g+e.slice(r+1):e.slice(r))+u,e=e.slice(0,r);break}}E&&!d&&(e=o(e,1/0));var O=c.length+e.length+u.length,j=O<y?new Array(y-O+1).join(t):"";switch(E&&d&&(e=o(j+e,j.length?y-u.length:1/0),j=""),a){case"<":e=c+e+u+j;break;case"=":e=c+j+e+u;break;case"^":e=j.slice(0,O=j.length>>1)+c+e+u+j.slice(O);break;default:e=j+c+e+u}return f(e)}return v=void 0===v?6:/[gprs]/.test(_)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v)),O.toString=function(){return e+""},O}return{format:y,formatPrefix:function(e,t){var n=y(((e=r(e)).type="f",e)),i=3*Math.max(-8,Math.min(8,Math.floor(a(t)/3))),o=Math.pow(10,-i),s=m[8+i/3];return function(e){return n(o*e)+s}}}}function f(t){return u=g(t),e.format=u.format,e.formatPrefix=u.formatPrefix,u}f({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"}),e.FormatSpecifier=o,e.formatDefaultLocale=f,e.formatLocale=g,e.formatSpecifier=r,e.precisionFixed=function(e){return Math.max(0,-a(Math.abs(e)))},e.precisionPrefix=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(a(t)/3)))-a(Math.abs(e)))},e.precisionRound=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,a(t)-a(e))+1},Object.defineProperty(e,"__esModule",{value:!0})}(t)},260:function(e,t,a){!function(e,t){"use strict";function a(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function n(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function i(e,t,a){return{y:e,m:t,d:a,H:0,M:0,S:0,L:0}}function r(e){var r=e.dateTime,o=e.date,l=e.time,c=e.periods,u=e.days,d=e.shortDays,m=e.months,ye=e.shortMonths,Ee=g(c),ve=f(c),xe=g(u),_e=f(u),Me=g(d),Se=f(d),Te=g(m),Ce=f(m),Oe=g(ye),je=f(ye),we={a:function(e){return d[e.getDay()]},A:function(e){return u[e.getDay()]},b:function(e){return ye[e.getMonth()]},B:function(e){return m[e.getMonth()]},c:null,d:P,e:P,f:U,H:R,I:N,j:A,L:H,m:V,M:z,p:function(e){return c[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:pe,s:be,S:J,u:Y,U:B,V:$,w:q,W:W,x:null,X:null,y:G,Y:Q,Z:Z,"%":he},ke={a:function(e){return d[e.getUTCDay()]},A:function(e){return u[e.getUTCDay()]},b:function(e){return ye[e.getUTCMonth()]},B:function(e){return m[e.getUTCMonth()]},c:null,d:X,e:X,f:ne,H:K,I:ee,j:te,L:ae,m:ie,M:re,p:function(e){return c[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:pe,s:be,S:oe,u:se,U:le,V:ce,w:ue,W:de,x:null,X:null,y:me,Y:ge,Z:fe,"%":he},Ie={a:function(e,t,a){var n=Me.exec(t.slice(a));return n?(e.w=Se[n[0].toLowerCase()],a+n[0].length):-1},A:function(e,t,a){var n=xe.exec(t.slice(a));return n?(e.w=_e[n[0].toLowerCase()],a+n[0].length):-1},b:function(e,t,a){var n=Oe.exec(t.slice(a));return n?(e.m=je[n[0].toLowerCase()],a+n[0].length):-1},B:function(e,t,a){var n=Te.exec(t.slice(a));return n?(e.m=Ce[n[0].toLowerCase()],a+n[0].length):-1},c:function(e,t,a){return De(e,r,t,a)},d:T,e:T,f:I,H:O,I:O,j:C,L:k,m:S,M:j,p:function(e,t,a){var n=Ee.exec(t.slice(a));return n?(e.p=ve[n[0].toLowerCase()],a+n[0].length):-1},q:M,Q:L,s:D,S:w,u:p,U:b,V:y,w:h,W:E,x:function(e,t,a){return De(e,o,t,a)},X:function(e,t,a){return De(e,l,t,a)},y:x,Y:v,Z:_,"%":F};function Fe(e,t){return function(a){var n,i,r,o=[],l=-1,c=0,u=e.length;for(a instanceof Date||(a=new Date(+a));++l<u;)37===e.charCodeAt(l)&&(o.push(e.slice(c,l)),null!=(i=s[n=e.charAt(++l)])?n=e.charAt(++l):i="e"===n?" ":"0",(r=t[n])&&(n=r(a,i)),o.push(n),c=l+1);return o.push(e.slice(c,l)),o.join("")}}function Le(e,r){return function(o){var s,l,c=i(1900,void 0,1);if(De(c,e,o+="",0)!=o.length)return null;if("Q"in c)return new Date(c.Q);if("s"in c)return new Date(1e3*c.s+("L"in c?c.L:0));if(r&&!("Z"in c)&&(c.Z=0),"p"in c&&(c.H=c.H%12+12*c.p),void 0===c.m&&(c.m="q"in c?c.q:0),"V"in c){if(c.V<1||c.V>53)return null;"w"in c||(c.w=1),"Z"in c?(l=(s=n(i(c.y,0,1))).getUTCDay(),s=l>4||0===l?t.utcMonday.ceil(s):t.utcMonday(s),s=t.utcDay.offset(s,7*(c.V-1)),c.y=s.getUTCFullYear(),c.m=s.getUTCMonth(),c.d=s.getUTCDate()+(c.w+6)%7):(l=(s=a(i(c.y,0,1))).getDay(),s=l>4||0===l?t.timeMonday.ceil(s):t.timeMonday(s),s=t.timeDay.offset(s,7*(c.V-1)),c.y=s.getFullYear(),c.m=s.getMonth(),c.d=s.getDate()+(c.w+6)%7)}else("W"in c||"U"in c)&&("w"in c||(c.w="u"in c?c.u%7:"W"in c?1:0),l="Z"in c?n(i(c.y,0,1)).getUTCDay():a(i(c.y,0,1)).getDay(),c.m=0,c.d="W"in c?(c.w+6)%7+7*c.W-(l+5)%7:c.w+7*c.U-(l+6)%7);return"Z"in c?(c.H+=c.Z/100|0,c.M+=c.Z%100,n(c)):a(c)}}function De(e,t,a,n){for(var i,r,o=0,l=t.length,c=a.length;o<l;){if(n>=c)return-1;if(37===(i=t.charCodeAt(o++))){if(i=t.charAt(o++),!(r=Ie[i in s?t.charAt(o++):i])||(n=r(e,a,n))<0)return-1}else if(i!=a.charCodeAt(n++))return-1}return n}return we.x=Fe(o,we),we.X=Fe(l,we),we.c=Fe(r,we),ke.x=Fe(o,ke),ke.X=Fe(l,ke),ke.c=Fe(r,ke),{format:function(e){var t=Fe(e+="",we);return t.toString=function(){return e},t},parse:function(e){var t=Le(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=Fe(e+="",ke);return t.toString=function(){return e},t},utcParse:function(e){var t=Le(e+="",!0);return t.toString=function(){return e},t}}}var o,s={"-":"",_:" ",0:"0"},l=/^\s*\d+/,c=/^%/,u=/[\\^$*+?|[\]().{}]/g;function d(e,t,a){var n=e<0?"-":"",i=(n?-e:e)+"",r=i.length;return n+(r<a?new Array(a-r+1).join(t)+i:i)}function m(e){return e.replace(u,"\\$&")}function g(e){return new RegExp("^(?:"+e.map(m).join("|")+")","i")}function f(e){for(var t={},a=-1,n=e.length;++a<n;)t[e[a].toLowerCase()]=a;return t}function h(e,t,a){var n=l.exec(t.slice(a,a+1));return n?(e.w=+n[0],a+n[0].length):-1}function p(e,t,a){var n=l.exec(t.slice(a,a+1));return n?(e.u=+n[0],a+n[0].length):-1}function b(e,t,a){var n=l.exec(t.slice(a,a+2));return n?(e.U=+n[0],a+n[0].length):-1}function y(e,t,a){var n=l.exec(t.slice(a,a+2));return n?(e.V=+n[0],a+n[0].length):-1}function E(e,t,a){var n=l.exec(t.slice(a,a+2));return n?(e.W=+n[0],a+n[0].length):-1}function v(e,t,a){var n=l.exec(t.slice(a,a+4));return n?(e.y=+n[0],a+n[0].length):-1}function x(e,t,a){var n=l.exec(t.slice(a,a+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),a+n[0].length):-1}function _(e,t,a){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(a,a+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),a+n[0].length):-1}function M(e,t,a){var n=l.exec(t.slice(a,a+1));return n?(e.q=3*n[0]-3,a+n[0].length):-1}function S(e,t,a){var n=l.exec(t.slice(a,a+2));return n?(e.m=n[0]-1,a+n[0].length):-1}function T(e,t,a){var n=l.exec(t.slice(a,a+2));return n?(e.d=+n[0],a+n[0].length):-1}function C(e,t,a){var n=l.exec(t.slice(a,a+3));return n?(e.m=0,e.d=+n[0],a+n[0].length):-1}function O(e,t,a){var n=l.exec(t.slice(a,a+2));return n?(e.H=+n[0],a+n[0].length):-1}function j(e,t,a){var n=l.exec(t.slice(a,a+2));return n?(e.M=+n[0],a+n[0].length):-1}function w(e,t,a){var n=l.exec(t.slice(a,a+2));return n?(e.S=+n[0],a+n[0].length):-1}function k(e,t,a){var n=l.exec(t.slice(a,a+3));return n?(e.L=+n[0],a+n[0].length):-1}function I(e,t,a){var n=l.exec(t.slice(a,a+6));return n?(e.L=Math.floor(n[0]/1e3),a+n[0].length):-1}function F(e,t,a){var n=c.exec(t.slice(a,a+1));return n?a+n[0].length:-1}function L(e,t,a){var n=l.exec(t.slice(a));return n?(e.Q=+n[0],a+n[0].length):-1}function D(e,t,a){var n=l.exec(t.slice(a));return n?(e.s=+n[0],a+n[0].length):-1}function P(e,t){return d(e.getDate(),t,2)}function R(e,t){return d(e.getHours(),t,2)}function N(e,t){return d(e.getHours()%12||12,t,2)}function A(e,a){return d(1+t.timeDay.count(t.timeYear(e),e),a,3)}function H(e,t){return d(e.getMilliseconds(),t,3)}function U(e,t){return H(e,t)+"000"}function V(e,t){return d(e.getMonth()+1,t,2)}function z(e,t){return d(e.getMinutes(),t,2)}function J(e,t){return d(e.getSeconds(),t,2)}function Y(e){var t=e.getDay();return 0===t?7:t}function B(e,a){return d(t.timeSunday.count(t.timeYear(e)-1,e),a,2)}function $(e,a){var n=e.getDay();return e=n>=4||0===n?t.timeThursday(e):t.timeThursday.ceil(e),d(t.timeThursday.count(t.timeYear(e),e)+(4===t.timeYear(e).getDay()),a,2)}function q(e){return e.getDay()}function W(e,a){return d(t.timeMonday.count(t.timeYear(e)-1,e),a,2)}function G(e,t){return d(e.getFullYear()%100,t,2)}function Q(e,t){return d(e.getFullYear()%1e4,t,4)}function Z(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+d(t/60|0,"0",2)+d(t%60,"0",2)}function X(e,t){return d(e.getUTCDate(),t,2)}function K(e,t){return d(e.getUTCHours(),t,2)}function ee(e,t){return d(e.getUTCHours()%12||12,t,2)}function te(e,a){return d(1+t.utcDay.count(t.utcYear(e),e),a,3)}function ae(e,t){return d(e.getUTCMilliseconds(),t,3)}function ne(e,t){return ae(e,t)+"000"}function ie(e,t){return d(e.getUTCMonth()+1,t,2)}function re(e,t){return d(e.getUTCMinutes(),t,2)}function oe(e,t){return d(e.getUTCSeconds(),t,2)}function se(e){var t=e.getUTCDay();return 0===t?7:t}function le(e,a){return d(t.utcSunday.count(t.utcYear(e)-1,e),a,2)}function ce(e,a){var n=e.getUTCDay();return e=n>=4||0===n?t.utcThursday(e):t.utcThursday.ceil(e),d(t.utcThursday.count(t.utcYear(e),e)+(4===t.utcYear(e).getUTCDay()),a,2)}function ue(e){return e.getUTCDay()}function de(e,a){return d(t.utcMonday.count(t.utcYear(e)-1,e),a,2)}function me(e,t){return d(e.getUTCFullYear()%100,t,2)}function ge(e,t){return d(e.getUTCFullYear()%1e4,t,4)}function fe(){return"+0000"}function he(){return"%"}function pe(e){return+e}function be(e){return Math.floor(+e/1e3)}function ye(t){return o=r(t),e.timeFormat=o.format,e.timeParse=o.parse,e.utcFormat=o.utcFormat,e.utcParse=o.utcParse,o}ye({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var Ee="%Y-%m-%dT%H:%M:%S.%LZ";var ve=Date.prototype.toISOString?function(e){return e.toISOString()}:e.utcFormat(Ee);var xe=+new Date("2000-01-01T00:00:00.000Z")?function(e){var t=new Date(e);return isNaN(t)?null:t}:e.utcParse(Ee);e.isoFormat=ve,e.isoParse=xe,e.timeFormatDefaultLocale=ye,e.timeFormatLocale=r,Object.defineProperty(e,"__esModule",{value:!0})}(t,a(217))},261:function(e,t,a){!function(e,t){"use strict";function a(e){return function(){return e}}var n=Math.abs,i=Math.atan2,r=Math.cos,o=Math.max,s=Math.min,l=Math.sin,c=Math.sqrt,u=1e-12,d=Math.PI,m=d/2,g=2*d;function f(e){return e>1?0:e<-1?d:Math.acos(e)}function h(e){return e>=1?m:e<=-1?-m:Math.asin(e)}function p(e){return e.innerRadius}function b(e){return e.outerRadius}function y(e){return e.startAngle}function E(e){return e.endAngle}function v(e){return e&&e.padAngle}function x(e,t,a,n,i,r,o,s){var l=a-e,c=n-t,d=o-i,m=s-r,g=m*l-d*c;if(!(g*g<u))return[e+(g=(d*(t-r)-m*(e-i))/g)*l,t+g*c]}function _(e,t,a,n,i,r,s){var l=e-a,u=t-n,d=(s?r:-r)/c(l*l+u*u),m=d*u,g=-d*l,f=e+m,h=t+g,p=a+m,b=n+g,y=(f+p)/2,E=(h+b)/2,v=p-f,x=b-h,_=v*v+x*x,M=i-r,S=f*b-p*h,T=(x<0?-1:1)*c(o(0,M*M*_-S*S)),C=(S*x-v*T)/_,O=(-S*v-x*T)/_,j=(S*x+v*T)/_,w=(-S*v+x*T)/_,k=C-y,I=O-E,F=j-y,L=w-E;return k*k+I*I>F*F+L*L&&(C=j,O=w),{cx:C,cy:O,x01:-m,y01:-g,x11:C*(i/M-1),y11:O*(i/M-1)}}function M(e){this._context=e}function S(e){return new M(e)}function T(e){return e[0]}function C(e){return e[1]}function O(){var e=T,n=C,i=a(!0),r=null,o=S,s=null;function l(a){var l,c,u,d=a.length,m=!1;for(null==r&&(s=o(u=t.path())),l=0;l<=d;++l)!(l<d&&i(c=a[l],l,a))===m&&((m=!m)?s.lineStart():s.lineEnd()),m&&s.point(+e(c,l,a),+n(c,l,a));if(u)return s=null,u+""||null}return l.x=function(t){return arguments.length?(e="function"==typeof t?t:a(+t),l):e},l.y=function(e){return arguments.length?(n="function"==typeof e?e:a(+e),l):n},l.defined=function(e){return arguments.length?(i="function"==typeof e?e:a(!!e),l):i},l.curve=function(e){return arguments.length?(o=e,null!=r&&(s=o(r)),l):o},l.context=function(e){return arguments.length?(null==e?r=s=null:s=o(r=e),l):r},l}function j(){var e=T,n=null,i=a(0),r=C,o=a(!0),s=null,l=S,c=null;function u(a){var u,d,m,g,f,h=a.length,p=!1,b=new Array(h),y=new Array(h);for(null==s&&(c=l(f=t.path())),u=0;u<=h;++u){if(!(u<h&&o(g=a[u],u,a))===p)if(p=!p)d=u,c.areaStart(),c.lineStart();else{for(c.lineEnd(),c.lineStart(),m=u-1;m>=d;--m)c.point(b[m],y[m]);c.lineEnd(),c.areaEnd()}p&&(b[u]=+e(g,u,a),y[u]=+i(g,u,a),c.point(n?+n(g,u,a):b[u],r?+r(g,u,a):y[u]))}if(f)return c=null,f+""||null}function d(){return O().defined(o).curve(l).context(s)}return u.x=function(t){return arguments.length?(e="function"==typeof t?t:a(+t),n=null,u):e},u.x0=function(t){return arguments.length?(e="function"==typeof t?t:a(+t),u):e},u.x1=function(e){return arguments.length?(n=null==e?null:"function"==typeof e?e:a(+e),u):n},u.y=function(e){return arguments.length?(i="function"==typeof e?e:a(+e),r=null,u):i},u.y0=function(e){return arguments.length?(i="function"==typeof e?e:a(+e),u):i},u.y1=function(e){return arguments.length?(r=null==e?null:"function"==typeof e?e:a(+e),u):r},u.lineX0=u.lineY0=function(){return d().x(e).y(i)},u.lineY1=function(){return d().x(e).y(r)},u.lineX1=function(){return d().x(n).y(i)},u.defined=function(e){return arguments.length?(o="function"==typeof e?e:a(!!e),u):o},u.curve=function(e){return arguments.length?(l=e,null!=s&&(c=l(s)),u):l},u.context=function(e){return arguments.length?(null==e?s=c=null:c=l(s=e),u):s},u}function w(e,t){return t<e?-1:t>e?1:t>=e?0:NaN}function k(e){return e}M.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}};var I=L(S);function F(e){this._curve=e}function L(e){function t(t){return new F(e(t))}return t._curve=e,t}function D(e){var t=e.curve;return e.angle=e.x,delete e.x,e.radius=e.y,delete e.y,e.curve=function(e){return arguments.length?t(L(e)):t()._curve},e}function P(){return D(O().curve(I))}function R(){var e=j().curve(I),t=e.curve,a=e.lineX0,n=e.lineX1,i=e.lineY0,r=e.lineY1;return e.angle=e.x,delete e.x,e.startAngle=e.x0,delete e.x0,e.endAngle=e.x1,delete e.x1,e.radius=e.y,delete e.y,e.innerRadius=e.y0,delete e.y0,e.outerRadius=e.y1,delete e.y1,e.lineStartAngle=function(){return D(a())},delete e.lineX0,e.lineEndAngle=function(){return D(n())},delete e.lineX1,e.lineInnerRadius=function(){return D(i())},delete e.lineY0,e.lineOuterRadius=function(){return D(r())},delete e.lineY1,e.curve=function(e){return arguments.length?t(L(e)):t()._curve},e}function N(e,t){return[(t=+t)*Math.cos(e-=Math.PI/2),t*Math.sin(e)]}F.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(e,t){this._curve.point(t*Math.sin(e),t*-Math.cos(e))}};var A=Array.prototype.slice;function H(e){return e.source}function U(e){return e.target}function V(e){var n=H,i=U,r=T,o=C,s=null;function l(){var a,l=A.call(arguments),c=n.apply(this,l),u=i.apply(this,l);if(s||(s=a=t.path()),e(s,+r.apply(this,(l[0]=c,l)),+o.apply(this,l),+r.apply(this,(l[0]=u,l)),+o.apply(this,l)),a)return s=null,a+""||null}return l.source=function(e){return arguments.length?(n=e,l):n},l.target=function(e){return arguments.length?(i=e,l):i},l.x=function(e){return arguments.length?(r="function"==typeof e?e:a(+e),l):r},l.y=function(e){return arguments.length?(o="function"==typeof e?e:a(+e),l):o},l.context=function(e){return arguments.length?(s=null==e?null:e,l):s},l}function z(e,t,a,n,i){e.moveTo(t,a),e.bezierCurveTo(t=(t+n)/2,a,t,i,n,i)}function J(e,t,a,n,i){e.moveTo(t,a),e.bezierCurveTo(t,a=(a+i)/2,n,a,n,i)}function Y(e,t,a,n,i){var r=N(t,a),o=N(t,a=(a+i)/2),s=N(n,a),l=N(n,i);e.moveTo(r[0],r[1]),e.bezierCurveTo(o[0],o[1],s[0],s[1],l[0],l[1])}var B={draw:function(e,t){var a=Math.sqrt(t/d);e.moveTo(a,0),e.arc(0,0,a,0,g)}},$={draw:function(e,t){var a=Math.sqrt(t/5)/2;e.moveTo(-3*a,-a),e.lineTo(-a,-a),e.lineTo(-a,-3*a),e.lineTo(a,-3*a),e.lineTo(a,-a),e.lineTo(3*a,-a),e.lineTo(3*a,a),e.lineTo(a,a),e.lineTo(a,3*a),e.lineTo(-a,3*a),e.lineTo(-a,a),e.lineTo(-3*a,a),e.closePath()}},q=Math.sqrt(1/3),W=2*q,G={draw:function(e,t){var a=Math.sqrt(t/W),n=a*q;e.moveTo(0,-a),e.lineTo(n,0),e.lineTo(0,a),e.lineTo(-n,0),e.closePath()}},Q=Math.sin(d/10)/Math.sin(7*d/10),Z=Math.sin(g/10)*Q,X=-Math.cos(g/10)*Q,K={draw:function(e,t){var a=Math.sqrt(.8908130915292852*t),n=Z*a,i=X*a;e.moveTo(0,-a),e.lineTo(n,i);for(var r=1;r<5;++r){var o=g*r/5,s=Math.cos(o),l=Math.sin(o);e.lineTo(l*a,-s*a),e.lineTo(s*n-l*i,l*n+s*i)}e.closePath()}},ee={draw:function(e,t){var a=Math.sqrt(t),n=-a/2;e.rect(n,n,a,a)}},te=Math.sqrt(3),ae={draw:function(e,t){var a=-Math.sqrt(t/(3*te));e.moveTo(0,2*a),e.lineTo(-te*a,-a),e.lineTo(te*a,-a),e.closePath()}},ne=-.5,ie=Math.sqrt(3)/2,re=1/Math.sqrt(12),oe=3*(re/2+1),se={draw:function(e,t){var a=Math.sqrt(t/oe),n=a/2,i=a*re,r=n,o=a*re+a,s=-r,l=o;e.moveTo(n,i),e.lineTo(r,o),e.lineTo(s,l),e.lineTo(ne*n-ie*i,ie*n+ne*i),e.lineTo(ne*r-ie*o,ie*r+ne*o),e.lineTo(ne*s-ie*l,ie*s+ne*l),e.lineTo(ne*n+ie*i,ne*i-ie*n),e.lineTo(ne*r+ie*o,ne*o-ie*r),e.lineTo(ne*s+ie*l,ne*l-ie*s),e.closePath()}},le=[B,$,G,ee,K,ae,se];function ce(){}function ue(e,t,a){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+a)/6)}function de(e){this._context=e}function me(e){this._context=e}function ge(e){this._context=e}function fe(e,t){this._basis=new de(e),this._beta=t}de.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:ue(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:ue(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},me.prototype={areaStart:ce,areaEnd:ce,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:ue(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},ge.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var a=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(a,n):this._context.moveTo(a,n);break;case 3:this._point=4;default:ue(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},fe.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,a=e.length-1;if(a>0)for(var n,i=e[0],r=t[0],o=e[a]-i,s=t[a]-r,l=-1;++l<=a;)n=l/a,this._basis.point(this._beta*e[l]+(1-this._beta)*(i+n*o),this._beta*t[l]+(1-this._beta)*(r+n*s));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};var he=function e(t){function a(e){return 1===t?new de(e):new fe(e,t)}return a.beta=function(t){return e(+t)},a}(.85);function pe(e,t,a){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-a),e._x2,e._y2)}function be(e,t){this._context=e,this._k=(1-t)/6}be.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:pe(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:pe(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var ye=function e(t){function a(e){return new be(e,t)}return a.tension=function(t){return e(+t)},a}(0);function Ee(e,t){this._context=e,this._k=(1-t)/6}Ee.prototype={areaStart:ce,areaEnd:ce,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:pe(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var ve=function e(t){function a(e){return new Ee(e,t)}return a.tension=function(t){return e(+t)},a}(0);function xe(e,t){this._context=e,this._k=(1-t)/6}xe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:pe(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var _e=function e(t){function a(e){return new xe(e,t)}return a.tension=function(t){return e(+t)},a}(0);function Me(e,t,a){var n=e._x1,i=e._y1,r=e._x2,o=e._y2;if(e._l01_a>u){var s=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,l=3*e._l01_a*(e._l01_a+e._l12_a);n=(n*s-e._x0*e._l12_2a+e._x2*e._l01_2a)/l,i=(i*s-e._y0*e._l12_2a+e._y2*e._l01_2a)/l}if(e._l23_a>u){var c=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,d=3*e._l23_a*(e._l23_a+e._l12_a);r=(r*c+e._x1*e._l23_2a-t*e._l12_2a)/d,o=(o*c+e._y1*e._l23_2a-a*e._l12_2a)/d}e._context.bezierCurveTo(n,i,r,o,e._x2,e._y2)}function Se(e,t){this._context=e,this._alpha=t}Se.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var a=this._x2-e,n=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(a*a+n*n,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:Me(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Te=function e(t){function a(e){return t?new Se(e,t):new be(e,0)}return a.alpha=function(t){return e(+t)},a}(.5);function Ce(e,t){this._context=e,this._alpha=t}Ce.prototype={areaStart:ce,areaEnd:ce,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){if(e=+e,t=+t,this._point){var a=this._x2-e,n=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(a*a+n*n,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Me(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Oe=function e(t){function a(e){return t?new Ce(e,t):new Ee(e,0)}return a.alpha=function(t){return e(+t)},a}(.5);function je(e,t){this._context=e,this._alpha=t}je.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var a=this._x2-e,n=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(a*a+n*n,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Me(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var we=function e(t){function a(e){return t?new je(e,t):new xe(e,0)}return a.alpha=function(t){return e(+t)},a}(.5);function ke(e){this._context=e}function Ie(e){return e<0?-1:1}function Fe(e,t,a){var n=e._x1-e._x0,i=t-e._x1,r=(e._y1-e._y0)/(n||i<0&&-0),o=(a-e._y1)/(i||n<0&&-0),s=(r*i+o*n)/(n+i);return(Ie(r)+Ie(o))*Math.min(Math.abs(r),Math.abs(o),.5*Math.abs(s))||0}function Le(e,t){var a=e._x1-e._x0;return a?(3*(e._y1-e._y0)/a-t)/2:t}function De(e,t,a){var n=e._x0,i=e._y0,r=e._x1,o=e._y1,s=(r-n)/3;e._context.bezierCurveTo(n+s,i+s*t,r-s,o-s*a,r,o)}function Pe(e){this._context=e}function Re(e){this._context=new Ne(e)}function Ne(e){this._context=e}function Ae(e){this._context=e}function He(e){var t,a,n=e.length-1,i=new Array(n),r=new Array(n),o=new Array(n);for(i[0]=0,r[0]=2,o[0]=e[0]+2*e[1],t=1;t<n-1;++t)i[t]=1,r[t]=4,o[t]=4*e[t]+2*e[t+1];for(i[n-1]=2,r[n-1]=7,o[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)a=i[t]/r[t-1],r[t]-=a,o[t]-=a*o[t-1];for(i[n-1]=o[n-1]/r[n-1],t=n-2;t>=0;--t)i[t]=(o[t]-i[t+1])/r[t];for(r[n-1]=(e[n]+i[n-1])/2,t=0;t<n-1;++t)r[t]=2*e[t+1]-i[t+1];return[i,r]}function Ue(e,t){this._context=e,this._t=t}function Ve(e,t){if((i=e.length)>1)for(var a,n,i,r=1,o=e[t[0]],s=o.length;r<i;++r)for(n=o,o=e[t[r]],a=0;a<s;++a)o[a][1]+=o[a][0]=isNaN(n[a][1])?n[a][0]:n[a][1]}function ze(e){for(var t=e.length,a=new Array(t);--t>=0;)a[t]=t;return a}function Je(e,t){return e[t]}function Ye(e){var t=e.map(Be);return ze(e).sort((function(e,a){return t[e]-t[a]}))}function Be(e){for(var t,a=-1,n=0,i=e.length,r=-1/0;++a<i;)(t=+e[a][1])>r&&(r=t,n=a);return n}function $e(e){var t=e.map(qe);return ze(e).sort((function(e,a){return t[e]-t[a]}))}function qe(e){for(var t,a=0,n=-1,i=e.length;++n<i;)(t=+e[n][1])&&(a+=t);return a}ke.prototype={areaStart:ce,areaEnd:ce,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}},Pe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:De(this,this._t0,Le(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var a=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,De(this,Le(this,a=Fe(this,e,t)),a);break;default:De(this,this._t0,a=Fe(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=a}}},(Re.prototype=Object.create(Pe.prototype)).point=function(e,t){Pe.prototype.point.call(this,t,e)},Ne.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,a,n,i,r){this._context.bezierCurveTo(t,e,n,a,r,i)}},Ae.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,a=e.length;if(a)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===a)this._context.lineTo(e[1],t[1]);else for(var n=He(e),i=He(t),r=0,o=1;o<a;++r,++o)this._context.bezierCurveTo(n[0][r],i[0][r],n[1][r],i[1][r],e[o],t[o]);(this._line||0!==this._line&&1===a)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}},Ue.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var a=this._x*(1-this._t)+e*this._t;this._context.lineTo(a,this._y),this._context.lineTo(a,t)}}this._x=e,this._y=t}},e.arc=function(){var e=p,o=b,M=a(0),S=null,T=y,C=E,O=v,j=null;function w(){var a,p,b=+e.apply(this,arguments),y=+o.apply(this,arguments),E=T.apply(this,arguments)-m,v=C.apply(this,arguments)-m,w=n(v-E),k=v>E;if(j||(j=a=t.path()),y<b&&(p=y,y=b,b=p),y>u)if(w>g-u)j.moveTo(y*r(E),y*l(E)),j.arc(0,0,y,E,v,!k),b>u&&(j.moveTo(b*r(v),b*l(v)),j.arc(0,0,b,v,E,k));else{var I,F,L=E,D=v,P=E,R=v,N=w,A=w,H=O.apply(this,arguments)/2,U=H>u&&(S?+S.apply(this,arguments):c(b*b+y*y)),V=s(n(y-b)/2,+M.apply(this,arguments)),z=V,J=V;if(U>u){var Y=h(U/b*l(H)),B=h(U/y*l(H));(N-=2*Y)>u?(P+=Y*=k?1:-1,R-=Y):(N=0,P=R=(E+v)/2),(A-=2*B)>u?(L+=B*=k?1:-1,D-=B):(A=0,L=D=(E+v)/2)}var $=y*r(L),q=y*l(L),W=b*r(R),G=b*l(R);if(V>u){var Q,Z=y*r(D),X=y*l(D),K=b*r(P),ee=b*l(P);if(w<d&&(Q=x($,q,K,ee,Z,X,W,G))){var te=$-Q[0],ae=q-Q[1],ne=Z-Q[0],ie=X-Q[1],re=1/l(f((te*ne+ae*ie)/(c(te*te+ae*ae)*c(ne*ne+ie*ie)))/2),oe=c(Q[0]*Q[0]+Q[1]*Q[1]);z=s(V,(b-oe)/(re-1)),J=s(V,(y-oe)/(re+1))}}A>u?J>u?(I=_(K,ee,$,q,y,J,k),F=_(Z,X,W,G,y,J,k),j.moveTo(I.cx+I.x01,I.cy+I.y01),J<V?j.arc(I.cx,I.cy,J,i(I.y01,I.x01),i(F.y01,F.x01),!k):(j.arc(I.cx,I.cy,J,i(I.y01,I.x01),i(I.y11,I.x11),!k),j.arc(0,0,y,i(I.cy+I.y11,I.cx+I.x11),i(F.cy+F.y11,F.cx+F.x11),!k),j.arc(F.cx,F.cy,J,i(F.y11,F.x11),i(F.y01,F.x01),!k))):(j.moveTo($,q),j.arc(0,0,y,L,D,!k)):j.moveTo($,q),b>u&&N>u?z>u?(I=_(W,G,Z,X,b,-z,k),F=_($,q,K,ee,b,-z,k),j.lineTo(I.cx+I.x01,I.cy+I.y01),z<V?j.arc(I.cx,I.cy,z,i(I.y01,I.x01),i(F.y01,F.x01),!k):(j.arc(I.cx,I.cy,z,i(I.y01,I.x01),i(I.y11,I.x11),!k),j.arc(0,0,b,i(I.cy+I.y11,I.cx+I.x11),i(F.cy+F.y11,F.cx+F.x11),k),j.arc(F.cx,F.cy,z,i(F.y11,F.x11),i(F.y01,F.x01),!k))):j.arc(0,0,b,R,P,k):j.lineTo(W,G)}else j.moveTo(0,0);if(j.closePath(),a)return j=null,a+""||null}return w.centroid=function(){var t=(+e.apply(this,arguments)+ +o.apply(this,arguments))/2,a=(+T.apply(this,arguments)+ +C.apply(this,arguments))/2-d/2;return[r(a)*t,l(a)*t]},w.innerRadius=function(t){return arguments.length?(e="function"==typeof t?t:a(+t),w):e},w.outerRadius=function(e){return arguments.length?(o="function"==typeof e?e:a(+e),w):o},w.cornerRadius=function(e){return arguments.length?(M="function"==typeof e?e:a(+e),w):M},w.padRadius=function(e){return arguments.length?(S=null==e?null:"function"==typeof e?e:a(+e),w):S},w.startAngle=function(e){return arguments.length?(T="function"==typeof e?e:a(+e),w):T},w.endAngle=function(e){return arguments.length?(C="function"==typeof e?e:a(+e),w):C},w.padAngle=function(e){return arguments.length?(O="function"==typeof e?e:a(+e),w):O},w.context=function(e){return arguments.length?(j=null==e?null:e,w):j},w},e.area=j,e.areaRadial=R,e.curveBasis=function(e){return new de(e)},e.curveBasisClosed=function(e){return new me(e)},e.curveBasisOpen=function(e){return new ge(e)},e.curveBundle=he,e.curveCardinal=ye,e.curveCardinalClosed=ve,e.curveCardinalOpen=_e,e.curveCatmullRom=Te,e.curveCatmullRomClosed=Oe,e.curveCatmullRomOpen=we,e.curveLinear=S,e.curveLinearClosed=function(e){return new ke(e)},e.curveMonotoneX=function(e){return new Pe(e)},e.curveMonotoneY=function(e){return new Re(e)},e.curveNatural=function(e){return new Ae(e)},e.curveStep=function(e){return new Ue(e,.5)},e.curveStepAfter=function(e){return new Ue(e,1)},e.curveStepBefore=function(e){return new Ue(e,0)},e.line=O,e.lineRadial=P,e.linkHorizontal=function(){return V(z)},e.linkRadial=function(){var e=V(Y);return e.angle=e.x,delete e.x,e.radius=e.y,delete e.y,e},e.linkVertical=function(){return V(J)},e.pie=function(){var e=k,t=w,n=null,i=a(0),r=a(g),o=a(0);function s(a){var s,l,c,u,d,m=a.length,f=0,h=new Array(m),p=new Array(m),b=+i.apply(this,arguments),y=Math.min(g,Math.max(-g,r.apply(this,arguments)-b)),E=Math.min(Math.abs(y)/m,o.apply(this,arguments)),v=E*(y<0?-1:1);for(s=0;s<m;++s)(d=p[h[s]=s]=+e(a[s],s,a))>0&&(f+=d);for(null!=t?h.sort((function(e,a){return t(p[e],p[a])})):null!=n&&h.sort((function(e,t){return n(a[e],a[t])})),s=0,c=f?(y-m*v)/f:0;s<m;++s,b=u)l=h[s],u=b+((d=p[l])>0?d*c:0)+v,p[l]={data:a[l],index:s,value:d,startAngle:b,endAngle:u,padAngle:E};return p}return s.value=function(t){return arguments.length?(e="function"==typeof t?t:a(+t),s):e},s.sortValues=function(e){return arguments.length?(t=e,n=null,s):t},s.sort=function(e){return arguments.length?(n=e,t=null,s):n},s.startAngle=function(e){return arguments.length?(i="function"==typeof e?e:a(+e),s):i},s.endAngle=function(e){return arguments.length?(r="function"==typeof e?e:a(+e),s):r},s.padAngle=function(e){return arguments.length?(o="function"==typeof e?e:a(+e),s):o},s},e.pointRadial=N,e.radialArea=R,e.radialLine=P,e.stack=function(){var e=a([]),t=ze,n=Ve,i=Je;function r(a){var r,o,s=e.apply(this,arguments),l=a.length,c=s.length,u=new Array(c);for(r=0;r<c;++r){for(var d,m=s[r],g=u[r]=new Array(l),f=0;f<l;++f)g[f]=d=[0,+i(a[f],m,f,a)],d.data=a[f];g.key=m}for(r=0,o=t(u);r<c;++r)u[o[r]].index=r;return n(u,o),u}return r.keys=function(t){return arguments.length?(e="function"==typeof t?t:a(A.call(t)),r):e},r.value=function(e){return arguments.length?(i="function"==typeof e?e:a(+e),r):i},r.order=function(e){return arguments.length?(t=null==e?ze:"function"==typeof e?e:a(A.call(e)),r):t},r.offset=function(e){return arguments.length?(n=null==e?Ve:e,r):n},r},e.stackOffsetDiverging=function(e,t){if((s=e.length)>0)for(var a,n,i,r,o,s,l=0,c=e[t[0]].length;l<c;++l)for(r=o=0,a=0;a<s;++a)(i=(n=e[t[a]][l])[1]-n[0])>0?(n[0]=r,n[1]=r+=i):i<0?(n[1]=o,n[0]=o+=i):(n[0]=0,n[1]=i)},e.stackOffsetExpand=function(e,t){if((n=e.length)>0){for(var a,n,i,r=0,o=e[0].length;r<o;++r){for(i=a=0;a<n;++a)i+=e[a][r][1]||0;if(i)for(a=0;a<n;++a)e[a][r][1]/=i}Ve(e,t)}},e.stackOffsetNone=Ve,e.stackOffsetSilhouette=function(e,t){if((a=e.length)>0){for(var a,n=0,i=e[t[0]],r=i.length;n<r;++n){for(var o=0,s=0;o<a;++o)s+=e[o][n][1]||0;i[n][1]+=i[n][0]=-s/2}Ve(e,t)}},e.stackOffsetWiggle=function(e,t){if((i=e.length)>0&&(n=(a=e[t[0]]).length)>0){for(var a,n,i,r=0,o=1;o<n;++o){for(var s=0,l=0,c=0;s<i;++s){for(var u=e[t[s]],d=u[o][1]||0,m=(d-(u[o-1][1]||0))/2,g=0;g<s;++g){var f=e[t[g]];m+=(f[o][1]||0)-(f[o-1][1]||0)}l+=d,c+=m*d}a[o-1][1]+=a[o-1][0]=r,l&&(r-=c/l)}a[o-1][1]+=a[o-1][0]=r,Ve(e,t)}},e.stackOrderAppearance=Ye,e.stackOrderAscending=$e,e.stackOrderDescending=function(e){return $e(e).reverse()},e.stackOrderInsideOut=function(e){var t,a,n=e.length,i=e.map(qe),r=Ye(e),o=0,s=0,l=[],c=[];for(t=0;t<n;++t)a=r[t],o<s?(o+=i[a],l.push(a)):(s+=i[a],c.push(a));return c.reverse().concat(l)},e.stackOrderNone=ze,e.stackOrderReverse=function(e){return ze(e).reverse()},e.symbol=function(){var e=a(B),n=a(64),i=null;function r(){var a;if(i||(i=a=t.path()),e.apply(this,arguments).draw(i,+n.apply(this,arguments)),a)return i=null,a+""||null}return r.type=function(t){return arguments.length?(e="function"==typeof t?t:a(t),r):e},r.size=function(e){return arguments.length?(n="function"==typeof e?e:a(+e),r):n},r.context=function(e){return arguments.length?(i=null==e?null:e,r):i},r},e.symbolCircle=B,e.symbolCross=$,e.symbolDiamond=G,e.symbolSquare=ee,e.symbolStar=K,e.symbolTriangle=ae,e.symbolWye=se,e.symbols=le,Object.defineProperty(e,"__esModule",{value:!0})}(t,a(262))},262:function(e,t,a){!function(e){"use strict";var t=Math.PI,a=2*t,n=1e-6,i=a-n;function r(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function o(){return new r}r.prototype=o.prototype={constructor:r,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,a,n){this._+="Q"+ +e+","+ +t+","+(this._x1=+a)+","+(this._y1=+n)},bezierCurveTo:function(e,t,a,n,i,r){this._+="C"+ +e+","+ +t+","+ +a+","+ +n+","+(this._x1=+i)+","+(this._y1=+r)},arcTo:function(e,a,i,r,o){e=+e,a=+a,i=+i,r=+r,o=+o;var s=this._x1,l=this._y1,c=i-e,u=r-a,d=s-e,m=l-a,g=d*d+m*m;if(o<0)throw new Error("negative radius: "+o);if(null===this._x1)this._+="M"+(this._x1=e)+","+(this._y1=a);else if(g>n)if(Math.abs(m*c-u*d)>n&&o){var f=i-s,h=r-l,p=c*c+u*u,b=f*f+h*h,y=Math.sqrt(p),E=Math.sqrt(g),v=o*Math.tan((t-Math.acos((p+g-b)/(2*y*E)))/2),x=v/E,_=v/y;Math.abs(x-1)>n&&(this._+="L"+(e+x*d)+","+(a+x*m)),this._+="A"+o+","+o+",0,0,"+ +(m*f>d*h)+","+(this._x1=e+_*c)+","+(this._y1=a+_*u)}else this._+="L"+(this._x1=e)+","+(this._y1=a)},arc:function(e,r,o,s,l,c){e=+e,r=+r,c=!!c;var u=(o=+o)*Math.cos(s),d=o*Math.sin(s),m=e+u,g=r+d,f=1^c,h=c?s-l:l-s;if(o<0)throw new Error("negative radius: "+o);null===this._x1?this._+="M"+m+","+g:(Math.abs(this._x1-m)>n||Math.abs(this._y1-g)>n)&&(this._+="L"+m+","+g),o&&(h<0&&(h=h%a+a),h>i?this._+="A"+o+","+o+",0,1,"+f+","+(e-u)+","+(r-d)+"A"+o+","+o+",0,1,"+f+","+(this._x1=m)+","+(this._y1=g):h>n&&(this._+="A"+o+","+o+",0,"+ +(h>=t)+","+f+","+(this._x1=e+o*Math.cos(l))+","+(this._y1=r+o*Math.sin(l))))},rect:function(e,t,a,n){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +a+"v"+ +n+"h"+-a+"Z"},toString:function(){return this._}},e.path=o,Object.defineProperty(e,"__esModule",{value:!0})}(t)},286:function(e,t,a){"use strict";a.r(t),a.d(t,"renderApp",(function(){return Js}));var n=a(2),i=a.n(n),r=a(22),o=a.n(r),s=a(51),l=a(55),c=(a(193),a(196)),u=a(155),d=a(12),m=a(29),g=a.n(m),f=a(1),h=a(9),p=a(30),b=a(40),y=a(100),E=a(203),v=a(204),x=a(36),_=a(205),M=a(206),S=a(5),T=a(83);const C=e=>{Object(M.a)(S.d,T.d,e)};var O=a(69),j=a(90),w=a(185),k=a(16),I=a(94),F=a.n(I),L=a(0),D=a(17);const P=async(e,t)=>{const{spaceId:a,sourceId:n,jobTypes:i}=e,r=await t("/api/ml/jobs/jobs_summary",{method:"POST",body:JSON.stringify(R.encode({jobIds:i.map((e=>Object(O.k)(a,n,e)))}))});return Object(D.b)(J)(r)},R=L.type({jobIds:L.array(L.string)}),N=L.keyof({started:null,starting:null,stopped:null,stopping:null,"":null}),A=L.keyof({closed:null,closing:null,deleting:null,failed:null,opened:null,opening:null,resetting:null,reverting:null}),H=L.partial({per_partition_categorization:L.intersection([L.type({enabled:L.boolean}),L.partial({stop_on_warn:L.boolean})])}),U=L.keyof({ok:null,warn:null}),V=L.type({categorization_status:U,categorized_doc_count:L.number,dead_category_count:L.number,frequent_category_count:L.number,log_time:L.number,rare_category_count:L.number,total_category_count:L.number}),z=L.intersection([L.type({id:L.string,jobState:A}),L.partial({awaitingNodeAssignment:L.boolean,datafeedIndices:L.array(L.string),datafeedState:N,fullJob:L.partial({analysis_config:H,create_time:L.number,custom_settings:O.q,finished_time:L.number,model_size_stats:V,datafeed_config:L.partial({runtime_mappings:L.UnknownRecord})})})]),J=L.array(z),Y=async(e,t)=>{const a=await t(`/api/ml/modules/get_module/${e}`,{method:"GET"});return Object(D.b)($)(a)},B=L.type({id:L.string,config:L.type({custom_settings:O.q})}),$=L.type({id:L.string,jobs:L.array(B)}),q=async(e,t)=>{const{moduleId:a,start:n,end:i,spaceId:r,sourceId:o,indexPattern:s,jobOverrides:l=[],datafeedOverrides:c=[],query:u,useDedicatedIndex:d=!1}=e,m=await t(`/api/ml/modules/setup/${a}`,{method:"POST",body:JSON.stringify(X.encode({start:n,end:i,indexPatternName:s,prefix:Object(O.l)(r,o),startDatafeed:!0,jobOverrides:l,datafeedOverrides:c,query:u,useDedicatedIndex:d}))});return Object(D.b)(ne)(m)},W=L.partial({start:L.number,end:L.number}),G=L.type({job_id:L.string,custom_settings:O.q}),Q=L.object,Z=L.intersection([L.strict({indexPatternName:L.string,prefix:L.string,startDatafeed:L.boolean,jobOverrides:L.array(G),datafeedOverrides:L.array(Q),useDedicatedIndex:L.boolean}),L.exact(L.partial({query:L.object}))]),X=L.intersection([W,Z]),K=L.type({reason:L.string,type:L.string}),ee=L.type({status:L.number,error:L.intersection([K,L.type({root_cause:L.array(K)})])}),te=L.intersection([L.type({id:L.string,started:L.boolean,success:L.boolean}),L.partial({awaitingNodeAssignment:L.boolean,error:ee})]),ae=L.intersection([L.type({id:L.string,success:L.boolean}),L.partial({error:ee})]),ne=L.type({datafeeds:L.array(te),jobs:L.array(ae)});var ie=a(85);const re=async(e,t)=>{const{indices:a,timestampField:n,startTime:i,endTime:r,runtimeMappings:o}=e,s=await t(ie.c,{method:"POST",body:JSON.stringify(ie.t.encode({data:{endTime:r,indices:a,startTime:i,timestampField:n,runtimeMappings:o}}))});return Object(D.b)(ie.u)(s)},oe=async(e,t)=>{const{indices:a,fields:n,runtimeMappings:i}=e,r=await t(ie.d,{method:"POST",body:JSON.stringify(ie.w.encode({data:{indices:a,fields:n,runtimeMappings:i}}))});return Object(D.b)(ie.x)(r)},se=async e=>{const t=await e("/api/ml/jobs/deleting_jobs_tasks");return Object(D.b)(ue)(t)},le=L.type({jobIds:L.array(L.string)}),ce=L.record(L.string,L.type({deleted:L.boolean})),ue=L.type({jobIds:L.array(L.string)}),de=L.type({datafeedIds:L.array(L.string)}),me=L.record(L.string,L.type({stopped:L.boolean})),ge=async(e,t,a,n)=>{try{await(async(e,t)=>{const{spaceId:a,sourceId:n,jobTypes:i}=e,r=await t("/api/ml/jobs/stop_datafeeds",{method:"POST",body:JSON.stringify(de.encode({datafeedIds:i.map((e=>Object(O.i)(a,n,e)))}))});return Object(D.b)(me)(r)})({spaceId:e,sourceId:t,jobTypes:a},n)}catch(e){var i;if(404!==(null==e||null===(i=e.res)||void 0===i?void 0:i.status))throw e}return await fe(e,t,a,n)},fe=async(e,t,a,n)=>{const i=await(async(e,t)=>{const{spaceId:a,sourceId:n,jobTypes:i}=e,r=await t("/api/ml/jobs/delete_jobs",{method:"POST",body:JSON.stringify(le.encode({jobIds:i.map((e=>Object(O.k)(a,n,e)))}))});return Object(D.b)(ce)(r)})({spaceId:e,sourceId:t,jobTypes:a},n);return await he(e,t,a,n),i},he=async(e,t,a,n)=>{const i=a.map((a=>Object(O.k)(e,t,a)));for(;;){const{jobIds:e}=await se(n);if(!e.some((e=>i.includes(e))))return!0;await pe(1e3)}},pe=e=>new Promise((t=>setTimeout(t,e))),be="logs_ui_categories",ye=f.i18n.translate("xpack.infra.logs.analysis.logEntryCategoriesModuleName",{defaultMessage:"Categorization"}),Ee=f.i18n.translate("xpack.infra.logs.analysis.logEntryCategoriesModuleDescription",{defaultMessage:"Use Machine Learning to automatically categorize log messages."}),ve=(e,t)=>O.t.reduce(((a,n)=>({...a,[n]:Object(O.k)(e,t,n)})),{}),xe={moduleId:be,moduleName:ye,moduleDescription:Ee,jobTypes:O.t,bucketSpan:O.c,getJobIds:ve,getJobSummary:async(e,t,a)=>{const n=await P({spaceId:e,sourceId:t,jobTypes:O.t},a),i=Object.values(ve(e,t));return n.filter((e=>i.includes(e.id)))},getModuleDefinition:async e=>await Y(be,e),setUpModule:async(e,t,a,{spaceId:n,sourceId:i,indices:r,timestampField:o,runtimeMappings:s},l)=>{const c=r.join(","),u=[{job_id:"log-entry-categories-count",analysis_config:{bucket_span:`${O.c}ms`},data_description:{time_field:o},custom_settings:{logs_source_config:{indexPattern:c,timestampField:o,bucketSpan:O.c,datasetFilter:a}}}],d=[{job_id:"log-entry-categories-count",runtime_mappings:s}],m={bool:{filter:[..."includeSome"===a.type?[{terms:{"event.dataset":a.datasets}}]:[],{exists:{field:"message"}}]}};return q({moduleId:be,start:e,end:t,spaceId:n,sourceId:i,indexPattern:c,jobOverrides:u,datafeedOverrides:d,query:m,useDedicatedIndex:!0},l)},cleanUpModule:async(e,t,a)=>await ge(e,t,O.t,a),validateSetupDatasets:async(e,t,a,n,i,r)=>await re({indices:e,timestampField:t,startTime:a,endTime:n,runtimeMappings:i},r),validateSetupIndices:async(e,t,a,n)=>await oe({indices:e,fields:[{name:t,validTypes:["date"]},{name:O.z,validTypes:["keyword"]},{name:O.d,validTypes:["text"]}],runtimeMappings:a},n)};var _e=a(67),Me=a.n(_e),Se=a(13),Te=a(68);const Ce=({jobTypes:e})=>({jobStatus:e.reduce(((e,t)=>({...e,[t]:"unknown"})),{}),jobSummaries:[],lastSetupErrorMessages:[],setupStatus:{type:"initializing"}}),Oe=e=>null!=e.error,je=e=>Object(n.useReducer)((e=>(t,a)=>{switch(a.type){case"startedSetup":return{...t,jobStatus:e.reduce(((e,t)=>({...e,[t]:"initializing"})),{}),setupStatus:{type:"pending"}};case"finishedSetup":{const{datafeedSetupResults:n,jobSetupResults:i,jobSummaries:r,spaceId:o,sourceId:s}=a,l=e.reduce(((e,t)=>{return{...e,[t]:(r=Object(O.k)(o,s,t),e=>e.filter((e=>e.id===r&&e.success&&!e.error)).length>0)(i)&&(a=Object(O.i)(o,s,t),e=>e.filter((e=>e.id===a&&e.success&&e.started&&!e.error)).length>0)(n)?"started":"failed"};var a,r}),{}),c=Object.values(l).every((e=>"started"===e||"starting"===e))?{type:"succeeded"}:{type:"failed",reasons:[...Object.values(n).filter(Oe).map((e=>{var t;return null===(t=e.error.error)||void 0===t?void 0:t.reason})),...Object.values(i).filter(Oe).map((e=>{var t;return null===(t=e.error.error)||void 0===t?void 0:t.reason}))]};return{...t,jobStatus:l,jobSummaries:r,setupStatus:c}}case"failedSetup":return{...t,jobStatus:e.reduce(((e,t)=>({...e,[t]:"failed"})),{}),setupStatus:{type:"failed",reasons:["unknown"]}};case"fetchingJobStatuses":return{...t,setupStatus:"unknown"===t.setupStatus.type?{type:"initializing"}:t.setupStatus};case"fetchedJobStatuses":{const{payload:i,spaceId:r,sourceId:o}=a,{setupStatus:s}=t,l=e.reduce(((e,t)=>{return{...e,[t]:(a=Object(O.k)(r,o,t),e=>e.filter((e=>e.id===a)).map((e=>"failed"===e.jobState||""===e.datafeedState?"failed":"closed"===e.jobState&&"stopped"===e.datafeedState&&e.fullJob&&null!=e.fullJob.finished_time?"finished":"closed"===e.jobState||"closing"===e.jobState||"stopped"===e.datafeedState?"stopped":"opening"===e.jobState&&!1===e.awaitingNodeAssignment||"resetting"===e.jobState||"reverting"===e.jobState?"initializing":"opened"===e.jobState&&"started"===e.datafeedState||"opening"===e.jobState&&"starting"===e.datafeedState&&!0===e.awaitingNodeAssignment?"started":"unknown"))[0]||"missing")(i)};var a}),{}),c=(n=l,e=>Object.entries(n).reduce(((e,[,t])=>"missing"===t?{type:"required"}:"required"===e.type||"succeeded"===e.type?e:"skipped"===e.type||Object(O.p)(t)?{type:"skipped",newlyCreated:"skipped"===e.type&&e.newlyCreated}:e),e))(s);return{...t,jobSummaries:i,jobStatus:l,setupStatus:c}}case"failedFetchingJobStatuses":return{...t,setupStatus:{type:"unknown"},jobStatus:e.reduce(((e,t)=>({...e,[t]:"unknown"})),{})};case"viewedResults":return{...t,setupStatus:{type:"skipped",newlyCreated:!0}};default:return t}var n})(e),{jobTypes:e},Ce),we=({sourceConfiguration:e,moduleDescriptor:t})=>{const{services:a}=Object(Se.b)(),{spaceId:i,sourceId:r,timestampField:o,runtimeMappings:s}=e,[l,c]=je(t.jobTypes),u=Object(p.useUiTracker)({app:"infra_logs"}),[,d]=Object(Te.c)({cancelPreviousOn:"resolution",createPromise:async()=>(c({type:"fetchingJobStatuses"}),await t.getJobSummary(i,r,a.http.fetch)),onResolve:e=>{c({type:"fetchedJobStatuses",payload:e,spaceId:i,sourceId:r})},onReject:()=>{c({type:"failedFetchingJobStatuses"})}},[i,r]),[,m]=Object(Te.c)({cancelPreviousOn:"resolution",createPromise:async(e,n,l,u)=>(c({type:"startedSetup"}),{setupResult:await t.setUpModule(n,l,u,{indices:e,sourceId:r,spaceId:i,timestampField:o,runtimeMappings:s},a.http.fetch),jobSummaries:await t.getJobSummary(i,r,a.http.fetch)}),onResolve:({setupResult:{datafeeds:e,jobs:t},jobSummaries:a})=>{[...e,...t].reduce(((e,t)=>[...e,...Object.keys(t)]),[]).some((e=>"error"===e))&&([...e,...t].filter((e=>void 0!==e.error)).map((e=>{var t,a,n;return null!==(t=null===(a=e.error)||void 0===a||null===(n=a.error)||void 0===n?void 0:n.reason)&&void 0!==t?t:""})).filter((e=>e.includes("because it has no mappings"))).length>0?u({metric:"logs_ml_setup_error_bad_indices_or_mappings"}):u({metric:"logs_ml_setup_error_unknown_cause"})),c({type:"finishedSetup",datafeedSetupResults:e,jobSetupResults:t,jobSummaries:a,spaceId:i,sourceId:r})},onReject:e=>{var t;c({type:"failedSetup"}),403===(null==e||null===(t=e.body)||void 0===t?void 0:t.statusCode)&&u({metric:"logs_ml_setup_error_lack_of_privileges"})}},[t.setUpModule,i,r,o]),[g,f]=Object(Te.c)({cancelPreviousOn:"resolution",createPromise:async()=>await t.cleanUpModule(i,r,a.http.fetch)},[i,r]),h=Object(n.useMemo)((()=>"pending"===g.state),[g.state]),b=Object(n.useCallback)(((e,t,a,n)=>{c({type:"startedSetup"}),f().then((()=>{m(e,t,a,n)})).catch((()=>{c({type:"failedSetup"})}))}),[f,c,m]),y=Object(n.useCallback)((()=>{c({type:"viewedResults"})}),[c]),E=Object(n.useMemo)((()=>t.getJobIds(i,r)),[t,i,r]);return{cleanUpAndSetUpModule:b,cleanUpModule:f,fetchJobStatus:d,isCleaningUp:h,jobIds:E,jobStatus:l.jobStatus,jobSummaries:l.jobSummaries,lastSetupErrorMessages:l.lastSetupErrorMessages,moduleDescriptor:t,setUpModule:m,setupStatus:l.setupStatus,sourceConfiguration:e,viewResults:y}};var ke=a(165),Ie=a.n(ke);const Fe=({moduleDescriptor:e,sourceConfiguration:t})=>({getIsJobConfigurationOutdated:Object(n.useMemo)((()=>Le(e,t)),[t,e])}),Le=({bucketSpan:e},t)=>a=>{var n;if(!a.fullJob||!a.fullJob.custom_settings||!a.fullJob.datafeed_config)return!1;const i=a.fullJob.custom_settings.logs_source_config,r=null!==(n=a.fullJob.datafeed_config.runtime_mappings)&&void 0!==n?n:{};return!(i&&i.bucketSpan===e&&i.indexPattern&&De(new Set(i.indexPattern.split(",")),new Set(t.indices))&&i.timestampField===t.timestampField&&Ie()(r,t.runtimeMappings))},De=(e,t)=>Array.from(e).every((e=>t.has(e))),Pe=({sourceConfiguration:{spaceId:e,sourceId:t},moduleDescriptor:a})=>{const{services:i}=Object(Se.b)(),[r,o]=Object(n.useState)(),s=Object(n.useMemo)((()=>r?r.jobs.reduce(((a,n)=>({...a,[Object(O.k)(e,t,n.id)]:n})),{}):{}),[r,t,e]),[l,c]=Object(Te.c)({cancelPreviousOn:"resolution",createPromise:async()=>await a.getModuleDefinition(i.http.fetch),onResolve:e=>{o(e)},onReject:()=>{o(void 0)}},[a.getModuleDefinition,e,t]),u=Object(n.useCallback)((e=>{var t,a,n;const i=s[e.id];if(null==i)return!1;const r=null==i?void 0:i.config.custom_settings.job_revision;return(null!==(t=null===(a=e.fullJob)||void 0===a||null===(n=a.custom_settings)||void 0===n?void 0:n.job_revision)&&void 0!==t?t:0)<(null!=r?r:0)}),[s]);return{fetchModuleDefinition:c,fetchModuleDefinitionRequestState:l.state,getIsJobDefinitionOutdated:u,jobDefinitionByJobId:s,moduleDefinition:r}};var Re=a(246),Ne=a.n(Re);const Ae=e=>{var t,a;return"warn"===(null===(t=e.fullJob)||void 0===t||null===(a=t.model_size_stats)||void 0===a?void 0:a.categorization_status)},He=e=>{var t,a,n;return null!==(t=null===(a=e.fullJob)||void 0===a||null===(n=a.analysis_config)||void 0===n?void 0:n.per_partition_categorization)&&void 0!==t&&t},Ue=({categorized_doc_count:e,dead_category_count:t,frequent_category_count:a,rare_category_count:n,total_category_count:i})=>{const r=n/i,o=i/e,s=t/i;return[...1===i?[{type:"singleCategory"}]:[],...r>=.9?[{type:"manyRareCategories",rareCategoriesRatio:r}]:[],...e>100&&o>=.5?[{type:"manyCategories",categoriesDocumentRatio:o}]:[],...0===a?[{type:"noFrequentCategories"}]:[],...s>=.5?[{type:"manyDeadCategories",deadCategoriesRatio:s}]:[]]},[Ve,ze]=Me()((({indexPattern:e,sourceId:t,spaceId:a,timestampField:i,runtimeMappings:r})=>{const o=Object(n.useMemo)((()=>({indices:e.split(","),sourceId:t,spaceId:a,timestampField:i,runtimeMappings:r})),[e,t,a,i,r]),s=we({moduleDescriptor:xe,sourceConfiguration:o}),{getIsJobConfigurationOutdated:l}=Fe({sourceConfiguration:o,moduleDescriptor:xe}),{fetchModuleDefinition:c,getIsJobDefinitionOutdated:u}=Pe({sourceConfiguration:o,moduleDescriptor:xe}),{categoryQualityWarnings:d}=(({jobSummaries:e})=>{const{services:{http:{fetch:t}}}=Object(Se.b)(),[a,i]=Object(n.useState)([]),r=Object(n.useMemo)((()=>e.filter(Ae)),[e]),o=Object(n.useMemo)((()=>r.filter(He)),[r]),[s,l]=Object(Te.c)({cancelPreviousOn:"creation",createPromise:e=>Promise.all(e.map((({jobId:e,startTime:a,endTime:n})=>(async({jobIds:e,startTime:t,endTime:a,includeCategorizerStatuses:n},i)=>{const r=await i(ie.b,{method:"POST",body:JSON.stringify(ie.j.encode({data:{jobIds:e,timeRange:{startTime:t,endTime:a},includeCategorizerStatuses:n}}))});return Object(D.b)(ie.k)(r)})({jobIds:[e],startTime:a,endTime:n,includeCategorizerStatuses:["warn"]},t)))),onResolve:e=>{i(e.flatMap((({data:{datasetStats:e}})=>e)))}},[]);return Ne()((()=>{l(o.map((e=>{var t,a,n,i,r;return{jobId:e.id,startTime:null!==(t=null===(a=e.fullJob)||void 0===a?void 0:a.create_time)&&void 0!==t?t:0,endTime:null!==(n=null===(i=e.fullJob)||void 0===i||null===(r=i.model_size_stats)||void 0===r?void 0:r.log_time)&&void 0!==n?n:Date.now()}})))}),[o]),{categoryQualityWarnings:Object(n.useMemo)((()=>[...r.filter((e=>!He(e))).map((e=>{var t;return{type:"categoryQualityWarning",jobId:e.id,dataset:"",reasons:null!==(t=e.fullJob)&&void 0!==t&&t.model_size_stats?Ue(e.fullJob.model_size_stats):[]}})),...a.map((e=>({type:"categoryQualityWarning",jobId:e.job_id,dataset:e.dataset,reasons:Ue(e)})))]),[r,a]),lastLatestWarnedDatasetsStatsRequestErrors:"rejected"===s.state?s.value:null,isLoadingCategoryQualityWarnings:"pending"===s.state}})({jobSummaries:s.jobSummaries}),m=Object(n.useMemo)((()=>s.jobSummaries.some(l)),[l,s.jobSummaries]),g=Object(n.useMemo)((()=>s.jobSummaries.some(u)),[u,s.jobSummaries]),f=Object(n.useMemo)((()=>Object.values(s.jobStatus).some((e=>"stopped"===e))),[s.jobStatus]);return{...s,categoryQualityWarnings:d,fetchModuleDefinition:c,hasOutdatedJobConfigurations:m,hasOutdatedJobDefinitions:g,hasStoppedJobs:f}}));var Je=a(23),Ye=a(166),Be=a.n(Ye);const $e=({cleanUpAndSetUpModule:e,moduleDescriptor:{validateSetupDatasets:t,validateSetupIndices:a},setUpModule:i,sourceConfiguration:r})=>{const{services:o}=Object(Se.b)(),[s,l]=Object(n.useState)(Date.now()-24192e5),[c,u]=Object(n.useState)(void 0),d=Object(n.useMemo)((()=>null==s||null==c||s<c),[c,s]),[m,g]=Object(n.useState)(r.indices.map((e=>({name:e,validity:"unknown"})))),f=Object(n.useCallback)((e=>g((t=>t.map((t=>{const a=e.filter((({index:e})=>e===t.name));return a.length>0?{validity:"invalid",name:t.name,errors:a}:"valid"===t.validity?{...t,validity:"valid",errors:[]}:{validity:"valid",name:t.name,isSelected:!Object(O.o)(t.name),availableDatasets:[],datasetFilter:{type:"includeAll"}}}))))),[]),h=Object(n.useCallback)((e=>g((t=>t.map((t=>{if("valid"!==t.validity)return t;const a=e.filter((({indexName:e})=>e===t.name)),n=a.flatMap((({datasets:e})=>e)),i=a.length>0?Object(O.g)(t.datasetFilter,(e=>n.includes(e))):t.datasetFilter;return{...t,availableDatasets:n,datasetFilter:i}}))))),[]),p=Object(n.useMemo)((()=>m.filter((e=>"valid"===e.validity)).map((e=>e.name))),[m]),b=Object(n.useMemo)((()=>m.filter((e=>"valid"===e.validity&&e.isSelected)).map((e=>e.name))),[m]),y=Object(n.useMemo)((()=>m.flatMap((e=>"valid"===e.validity?e.datasetFilter:{type:"includeAll"})).reduce(O.f,{type:"includeAll"})),[m]),[E,v]=Object(Te.c)({cancelPreviousOn:"resolution",createPromise:async()=>await a(r.indices,r.timestampField,r.runtimeMappings,o.http.fetch),onResolve:({data:{errors:e}})=>{f(e)},onReject:()=>{g([])}},[r.indices,r.timestampField]),[x,_]=Object(Te.c)({cancelPreviousOn:"resolution",createPromise:async()=>0===p.length?{data:{datasets:[]}}:await t(p,r.timestampField,null!=s?s:0,null!=c?c:Date.now(),r.runtimeMappings,o.http.fetch),onResolve:({data:{datasets:e}})=>{h(e)}},[p,r.timestampField,s,c]),M=Object(n.useCallback)((()=>i(b,s,c,y)),[i,b,s,c,y]),S=Object(n.useCallback)((()=>e(b,s,c,y)),[e,b,s,c,y]),T=Object(n.useMemo)((()=>"pending"===E.state||"pending"===x.state),[x.state,E.state]),C=Object(n.useMemo)((()=>T?[]:[..."rejected"===E.state||"rejected"===x.state?[{error:"NETWORK_ERROR"}]:[],...m.reduce(((e,t)=>"invalid"===t.validity&&b.includes(t.name)?[...e,...t.errors]:e),[]),...0===b.length?[{error:"TOO_FEW_SELECTED_INDICES"}]:[],...d?[]:[{error:"INVALID_TIME_RANGE"}]]),[T,E.state,x.state,m,b,d]),j=Be()(s),w=Be()(c),k=Be()(p);return Object(n.useEffect)((()=>{d&&v()}),[d,v]),Object(n.useEffect)((()=>{d&&(s===j&&c===w&&Object(Je.isEqual)(p,k)||_())}),[c,d,w,j,k,s,p,_]),{cleanUpAndSetUp:S,datasetFilter:y,endTime:c,isValidating:T,selectedIndexNames:b,setEndTime:u,setStartTime:l,setUp:M,startTime:s,validatedIndices:m,setValidatedIndices:g,validationErrors:C}};var qe=a(152),We=a(153);const Ge=({onClose:e})=>{const{categoryQualityWarnings:t,cleanUpAndSetUp:a,endTime:r,fetchJobStatus:o,isValidating:s,lastSetupErrorMessages:l,moduleDescriptor:c,setEndTime:u,setStartTime:m,setValidatedIndices:g,setUp:f,setupStatus:h,startTime:p,validatedIndices:b,validationErrors:y,viewResults:E}=(()=>{const{categoryQualityWarnings:e,cleanUpAndSetUpModule:t,fetchJobStatus:a,lastSetupErrorMessages:n,moduleDescriptor:i,setUpModule:r,setupStatus:o,sourceConfiguration:s,viewResults:l}=ze(),{cleanUpAndSetUp:c,endTime:u,isValidating:d,setEndTime:m,setStartTime:g,setValidatedIndices:f,setUp:h,startTime:p,validatedIndices:b,validationErrors:y}=$e({cleanUpAndSetUpModule:t,moduleDescriptor:i,setUpModule:r,sourceConfiguration:s});return{categoryQualityWarnings:e,cleanUpAndSetUp:c,endTime:u,fetchJobStatus:a,isValidating:d,lastSetupErrorMessages:n,moduleDescriptor:i,setEndTime:m,setStartTime:g,setValidatedIndices:f,setUp:h,setupStatus:o,startTime:p,validatedIndices:b,validationErrors:y,viewResults:l}})();F()((()=>{o()}));const v=Object(n.useCallback)((()=>{E(),e()}),[E,e]),x=Object(n.useMemo)((()=>[Object(qe.a)({setStartTime:m,setEndTime:u,startTime:p,endTime:r,isValidating:s,validatedIndices:b,setupStatus:h,setValidatedIndices:g,validationErrors:y,previousQualityWarnings:t}),Object(We.a)({cleanUpAndSetUp:a,errorMessages:l,isConfigurationValid:y.length<=0&&!s,setUp:f,setupStatus:h,viewResults:v})]),[t,a,r,s,l,u,m,f,g,h,p,b,y,v]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiTitle,{size:"s"},i.a.createElement("h3",null,c.moduleName," ")),i.a.createElement(d.EuiText,{size:"s"},c.moduleDescription),i.a.createElement(d.EuiSpacer,null),i.a.createElement(d.EuiSteps,{steps:x}))},Qe="logs_ui_analysis",Ze=f.i18n.translate("xpack.infra.logs.analysis.logEntryRateModuleName",{defaultMessage:"Log rate"}),Xe=f.i18n.translate("xpack.infra.logs.analysis.logEntryRateModuleDescription",{defaultMessage:"Use Machine Learning to automatically detect anomalous log entry rates."}),Ke=(e,t)=>O.w.reduce(((a,n)=>({...a,[n]:Object(O.k)(e,t,n)})),{}),et={moduleId:Qe,moduleName:Ze,moduleDescription:Xe,jobTypes:O.w,bucketSpan:O.c,getJobIds:Ke,getJobSummary:async(e,t,a)=>{const n=await P({spaceId:e,sourceId:t,jobTypes:O.w},a),i=Object.values(Ke(e,t));return n.filter((e=>i.includes(e.id)))},getModuleDefinition:async e=>await Y(Qe,e),setUpModule:async(e,t,a,{spaceId:n,sourceId:i,indices:r,timestampField:o,runtimeMappings:s},l)=>{const c=r.join(","),u=[{job_id:"log-entry-rate",analysis_config:{bucket_span:`${O.c}ms`},data_description:{time_field:o},custom_settings:{logs_source_config:{indexPattern:c,timestampField:o,bucketSpan:O.c}}}],d=[{job_id:"log-entry-rate",runtime_mappings:s}],m="includeSome"===a.type?{bool:{filter:[{terms:{"event.dataset":a.datasets}}]}}:void 0;return q({moduleId:Qe,start:e,end:t,spaceId:n,sourceId:i,indexPattern:c,jobOverrides:u,datafeedOverrides:d,query:m,useDedicatedIndex:!0},l)},cleanUpModule:async(e,t,a)=>await ge(e,t,O.w,a),validateSetupDatasets:async(e,t,a,n,i,r)=>await re({indices:e,timestampField:t,startTime:a,endTime:n,runtimeMappings:i},r),validateSetupIndices:async(e,t,a,n)=>await oe({indices:e,fields:[{name:t,validTypes:["date"]},{name:O.z,validTypes:["keyword"]}],runtimeMappings:a},n)},[tt,at]=Me()((({indexPattern:e,sourceId:t,spaceId:a,timestampField:i,runtimeMappings:r})=>{const o=Object(n.useMemo)((()=>({indices:e.split(","),sourceId:t,spaceId:a,timestampField:i,runtimeMappings:r})),[e,t,a,i,r]),s=we({moduleDescriptor:et,sourceConfiguration:o}),{getIsJobConfigurationOutdated:l}=Fe({sourceConfiguration:o,moduleDescriptor:et}),{fetchModuleDefinition:c,getIsJobDefinitionOutdated:u}=Pe({sourceConfiguration:o,moduleDescriptor:et}),d=Object(n.useMemo)((()=>s.jobSummaries.some(l)),[l,s.jobSummaries]),m=Object(n.useMemo)((()=>s.jobSummaries.some(u)),[u,s.jobSummaries]),g=Object(n.useMemo)((()=>Object.values(s.jobStatus).some((e=>"stopped"===e))),[s.jobStatus]);return{...s,fetchModuleDefinition:c,hasOutdatedJobConfigurations:d,hasOutdatedJobDefinitions:m,hasStoppedJobs:g}})),nt=()=>{const{cleanUpAndSetUpModule:e,lastSetupErrorMessages:t,moduleDescriptor:a,setUpModule:n,setupStatus:i,sourceConfiguration:r,viewResults:o}=at(),{cleanUpAndSetUp:s,endTime:l,isValidating:c,setEndTime:u,setStartTime:d,setValidatedIndices:m,setUp:g,startTime:f,validatedIndices:h,validationErrors:p}=$e({cleanUpAndSetUpModule:e,moduleDescriptor:a,setUpModule:n,sourceConfiguration:r});return{cleanUpAndSetUp:s,endTime:l,isValidating:c,lastSetupErrorMessages:t,moduleDescriptor:a,setEndTime:u,setStartTime:d,setValidatedIndices:m,setUp:g,setupStatus:i,startTime:f,validatedIndices:h,validationErrors:p,viewResults:o}},[it,rt]=Me()(nt),ot=({onClose:e})=>{const{cleanUpAndSetUp:t,endTime:a,isValidating:r,lastSetupErrorMessages:o,moduleDescriptor:s,setEndTime:l,setStartTime:c,setValidatedIndices:u,setUp:m,setupStatus:g,startTime:f,validatedIndices:h,validationErrors:p,viewResults:b}=nt(),y=Object(n.useCallback)((()=>{b(),e()}),[b,e]),E=Object(n.useMemo)((()=>[Object(qe.a)({setStartTime:c,setEndTime:l,startTime:f,endTime:a,isValidating:r,validatedIndices:h,setupStatus:g,setValidatedIndices:u,validationErrors:p}),Object(We.a)({cleanUpAndSetUp:t,errorMessages:o,isConfigurationValid:p.length<=0&&!r,setUp:m,setupStatus:g,viewResults:y})]),[t,a,r,o,l,c,m,u,g,f,h,p,y]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiTitle,{size:"s"},i.a.createElement("h3",null,s.moduleName," ")),i.a.createElement(d.EuiText,{size:"s"},s.moduleDescription),i.a.createElement(d.EuiSpacer,null),i.a.createElement(d.EuiSteps,{steps:E}))},st=L.type({capabilities:L.type({canGetJobs:L.boolean,canCreateJob:L.boolean,canDeleteJob:L.boolean,canOpenJob:L.boolean,canCloseJob:L.boolean,canForecastJob:L.boolean,canGetDatafeeds:L.boolean,canStartStopDatafeed:L.boolean,canUpdateJob:L.boolean,canUpdateDatafeed:L.boolean,canPreviewDatafeed:L.boolean}),isPlatinumOrTrialLicense:L.boolean,mlFeatureEnabledInSpace:L.boolean,upgradeInProgress:L.boolean}),[lt,ct]=Me()((()=>{const{services:e}=Object(Se.b)(),[t,a]=Object(n.useState)(ut),[i,r]=Object(Te.c)({cancelPreviousOn:"resolution",createPromise:async()=>{const t=await e.http.fetch("/api/ml/ml_capabilities");return Object(D.b)(st)(t)},onResolve:e=>{a(e)}},[]);Object(n.useEffect)((()=>{r()}),[r]);const o=Object(n.useMemo)((()=>"pending"===i.state),[i.state]),s=t.capabilities.canCreateJob,l=t.capabilities.canGetJobs;return{hasLogAnalysisCapabilites:t.isPlatinumOrTrialLicense&&t.mlFeatureEnabledInSpace,hasLogAnalysisReadCapabilities:l,hasLogAnalysisSetupCapabilities:s,isLoading:o}})),ut={capabilities:{canGetJobs:!1,canCreateJob:!1,canDeleteJob:!1,canOpenJob:!1,canCloseJob:!1,canForecastJob:!1,canGetDatafeeds:!1,canStartStopDatafeed:!1,canUpdateJob:!1,canUpdateDatafeed:!1,canPreviewDatafeed:!1,canGetCalendars:!1,canCreateCalendar:!1,canDeleteCalendar:!1,canGetFilters:!1,canCreateFilter:!1,canDeleteFilter:!1,canFindFileStructure:!1,canGetDataFrameJobs:!1,canDeleteDataFrameJob:!1,canPreviewDataFrameJob:!1,canCreateDataFrameJob:!1,canStartStopDataFrameJob:!1},isPlatinumOrTrialLicense:!1,mlFeatureEnabledInSpace:!1,upgradeInProgress:!1};var dt=a(192);const mt=({jobId:e,hasSetupCapabilities:t,moduleDescription:a,moduleName:r,moduleStatus:o,onViewSetup:s})=>{const{services:{ml:l,application:{navigateToUrl:c},notifications:{toasts:u}}}=Object(Se.b)(),[m,g]=Object(n.useState)("");Object(n.useEffect)((()=>{(async()=>{l.locator?g(await l.locator.getUrl({page:"jobs",pageState:{jobId:e}})):u.addWarning({title:gt})})()}));const f="required"===o.type?i.a.createElement(d.EuiIcon,{size:"xxl",type:"machineLearningApp"}):i.a.createElement(d.EuiIcon,{color:"success",size:"xxl",type:"check"}),h="required"===o.type?i.a.createElement(dt.a,{hasSetupCapabilities:t,onClick:s},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.analysis.enableAnomalyDetectionButtonLabel",defaultMessage:"Enable anomaly detection"})):i.a.createElement(i.a.Fragment,null,i.a.createElement(dt.b,{hasSetupCapabilities:t,onClick:s}),m?i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiSpacer,{size:"xs"}),i.a.createElement(d.EuiButtonEmpty,{onClick:async()=>{await c(m)}},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.analysis.viewInMlButtonLabel",defaultMessage:"View in Machine Learning"}))):null);return i.a.createElement(d.EuiCard,{description:a,footer:i.a.createElement("div",null,h),icon:f,title:r})},gt=f.i18n.translate("xpack.infra.logs.analysis.mlNotAvailable",{defaultMessage:"ML plugin is not available"}),ft=({onViewModuleSetup:e})=>{const{hasLogAnalysisSetupCapabilities:t}=ct(),{setupStatus:a,jobIds:r}=at(),{setupStatus:o,jobIds:s}=ze(),l=Object(n.useCallback)((()=>{e("logs_ui_analysis")}),[e]),c=Object(n.useCallback)((()=>{e("logs_ui_categories")}),[e]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiFlexGroup,null,i.a.createElement(d.EuiFlexItem,null,i.a.createElement(mt,{jobId:r["log-entry-rate"],hasSetupCapabilities:t,moduleDescription:et.moduleDescription,moduleName:et.moduleName,moduleStatus:a,onViewSetup:l})),i.a.createElement(d.EuiFlexItem,null,i.a.createElement(mt,{jobId:s["log-entry-categories-count"],hasSetupCapabilities:t,moduleDescription:xe.moduleDescription,moduleName:xe.moduleName,moduleStatus:o,onViewSetup:c}))))},ht=["logs_ui_analysis","logs_ui_categories"],[pt,bt]=Me()((({initialFlyoutView:e={view:"hidden"}})=>{const[t,a]=Object(n.useState)(e),i=Object(n.useCallback)((()=>a({view:"hidden"})),[]),r=Object(n.useCallback)((()=>a({view:"moduleList"})),[]),o=Object(n.useCallback)((e=>{a({view:"moduleSetup",module:e})}),[a]);return{closeFlyout:i,flyoutView:t,setFlyoutView:a,showModuleList:r,showModuleSetup:o}})),yt="logAnalysisSetupFlyoutHeading",Et=({allowedModules:e=ht})=>{const{closeFlyout:t,flyoutView:a,showModuleList:n,showModuleSetup:r}=bt();return"hidden"===a.view?null:i.a.createElement(d.EuiFlyout,{"aria-labelledby":yt,maxWidth:800,onClose:t},i.a.createElement(d.EuiFlyoutHeader,{hasBorder:!0},i.a.createElement(d.EuiTitle,null,i.a.createElement("h2",{id:yt},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.analysis.setupFlyoutTitle",defaultMessage:"Anomaly detection with Machine Learning"})))),i.a.createElement(d.EuiFlyoutBody,null,"moduleList"===a.view?i.a.createElement(ft,{onViewModuleSetup:r}):"moduleSetup"===a.view&&e.includes(a.module)?i.a.createElement(vt,{moduleId:a.module,onClose:t,onViewModuleList:e.length>1?n:void 0}):null))},vt=({moduleId:e,onClose:t,onViewModuleList:a})=>{switch(e){case"logs_ui_analysis":return i.a.createElement(xt,{onViewModuleList:a},i.a.createElement(ot,{onClose:t}));case"logs_ui_categories":return i.a.createElement(xt,{onViewModuleList:a},i.a.createElement(Ge,{onClose:t}))}},xt=({children:e,onViewModuleList:t})=>i.a.createElement(d.EuiFlexGroup,{alignItems:"flexStart",direction:"column",gutterSize:"none"},t?i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiButtonEmpty,{flush:"left",iconSide:"left",iconType:"arrowLeft",onClick:t},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.analysis.setupFlyoutGotoListButtonLabel",defaultMessage:"All Machine Learning jobs"}))):null,i.a.createElement(d.EuiFlexItem,null,e));var _t=a(190),Mt=a(71);const St=({hasData:e=!0,"data-test-subj":t,...a})=>{const{services:{observability:{navigation:{PageTemplate:n}},docLinks:r}}=Object(Se.b)(),{http:o}=Object(h.useKibana)().services,s=o.basePath.get(),l=e?void 0:{solution:f.i18n.translate("xpack.infra.logs.noDataConfig.solutionName",{defaultMessage:"Observability"}),actions:{beats:{title:f.i18n.translate("xpack.infra.logs.noDataConfig.beatsCard.title",{defaultMessage:"Add a logging integration"}),description:f.i18n.translate("xpack.infra.logs.noDataConfig.beatsCard.description",{defaultMessage:"Use the Elastic Agent or Beats to send logs to Elasticsearch. We make it easy with integrations for many popular systems and apps."}),href:s+"/app/integrations/browse"}},docsLink:r.links.observability.guide};return i.a.createElement(n,g()({"data-test-subj":e?t:"noDataPage",noDataConfig:l},a))};var Tt=a(10),Ct=a.n(Tt),Ot=a(49),jt=a.n(Ot),wt=a(124),kt=a.n(wt),It=a(15),Ft=a(53),Lt=a(160);const Dt=({hasSetupCapabilities:e,moduleName:t,onRecreateMlJob:a})=>i.a.createElement(Lt.a,{hasSetupCapabilities:e,title:f.i18n.translate("xpack.infra.logs.analysis.jobConfigurationOutdatedCalloutTitle",{defaultMessage:"The {moduleName} ML job configuration is outdated",values:{moduleName:t}}),onRecreateMlJob:a},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.analysis.jobConfigurationOutdatedCalloutMessage",defaultMessage:"The {moduleName} ML job was created using a different source configuration. Recreate the job to apply the current configuration. This removes previously detected anomalies.",values:{moduleName:t},tagName:"p"})),Pt=({hasSetupCapabilities:e,moduleName:t,onRecreateMlJob:a})=>i.a.createElement(Lt.a,{hasSetupCapabilities:e,title:f.i18n.translate("xpack.infra.logs.analysis.jobDefinitionOutdatedCalloutTitle",{defaultMessage:"The {moduleName} ML job definition is outdated",values:{moduleName:t}}),onRecreateMlJob:a},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.analysis.jobDefinitionOutdatedCalloutMessage",defaultMessage:"A newer version of the {moduleName} ML job is available. Recreate the job to deploy the newer version. This removes previously detected anomalies.",values:{moduleName:t},tagName:"p"})),Rt=()=>i.a.createElement(d.EuiCallOut,{color:"primary",title:Nt},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.analysis.jobStoppedCalloutMessage",defaultMessage:"The ML job has been stopped manually or due to a lack of resources. New log entries will not be processed until the job has been restarted.",tagName:"p"})),Nt=f.i18n.translate("xpack.infra.logs.analysis.jobStoppedCalloutTitle",{defaultMessage:"ML job stopped"}),At=({href:e})=>{const{services:{application:t}}=Object(Se.b)(),a=Object(n.useCallback)((a=>{e&&Object(p.shouldHandleLinkEvent)(a)&&t.navigateToUrl(e)}),[e,t]);return i.a.createElement(d.EuiButton,{fill:!1,size:"s",onClick:a},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.analysis.analyzeInMlButtonLabel",defaultMessage:"Analyze in ML"}))},Ht=()=>i.a.createElement(d.EuiCallOut,{color:"success",title:f.i18n.translate("xpack.infra.logs.analysis.onboardingSuccessTitle",{defaultMessage:"Success!"})},i.a.createElement("p",null,f.i18n.translate("xpack.infra.logs.analysis.onboardingSuccessContent",{defaultMessage:"Please allow a few minutes for our machine learning robots to begin collecting data."}))),Ut=({hasOutdatedJobConfigurations:e,hasOutdatedJobDefinitions:t,hasSetupCapabilities:a,hasStoppedJobs:n,isFirstUse:r,moduleName:o,onRecreateMlJobForReconfiguration:s,onRecreateMlJobForUpdate:l})=>i.a.createElement(i.a.Fragment,null,t?i.a.createElement(Pt,{hasSetupCapabilities:a,moduleName:o,onRecreateMlJob:l}):null,e?i.a.createElement(Dt,{hasSetupCapabilities:a,moduleName:o,onRecreateMlJob:s}):null,n?i.a.createElement(Rt,null):null,r?i.a.createElement(Ht,null):null);var Vt=a(207);const zt=({hasOutdatedJobConfigurations:e,hasOutdatedJobDefinitions:t,hasSetupCapabilities:a,hasStoppedJobs:n,isFirstUse:r,moduleName:o,onRecreateMlJobForReconfiguration:s,onRecreateMlJobForUpdate:l,qualityWarnings:c})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(Ut,{hasOutdatedJobConfigurations:e,hasOutdatedJobDefinitions:t,hasSetupCapabilities:a,hasStoppedJobs:n,isFirstUse:r,moduleName:o,onRecreateMlJobForReconfiguration:s,onRecreateMlJobForUpdate:l}),i.a.createElement(Vt.b,{hasSetupCapabilities:a,qualityWarnings:c,onRecreateMlJob:s})),Jt=({availableDatasets:e,isLoading:t=!1,onChangeDatasetSelection:a,selectedDatasets:r})=>{const o=Object(n.useMemo)((()=>e.map((e=>({value:e,label:Object(O.j)(e)})))),[e]),s=Object(n.useMemo)((()=>o.filter((({value:e})=>null!=e&&r.includes(e)))),[o,r]),l=Object(n.useCallback)((e=>a(e.map((({value:e})=>e)).filter(Bt))),[a]);return i.a.createElement(d.EuiComboBox,{"aria-label":Yt,isLoading:t,onChange:l,options:o,placeholder:Yt,selectedOptions:s})},Yt=f.i18n.translate("xpack.infra.logs.analysis.datasetFilterPlaceholder",{defaultMessage:"Filter by datasets"}),Bt=e=>null!=e,$t=Me()((e=>{const[t,a]=Object(n.useState)(),{startTimestamp:i,endTimestamp:r,sourceId:o}=e;return[{startTimestamp:i,endTimestamp:r,sourceId:o,contextEntry:t},{setContextEntry:a}]})),qt=()=>window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,Wt=()=>window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;var Gt=a(209);const Qt=()=>{const[{contextEntry:e,startTimestamp:t,endTimestamp:a,sourceId:r},{setContextEntry:o}]=Object(n.useContext)($t.Context),s=Object(n.useCallback)((()=>o(void 0)),[o]),{width:l,height:c}=function(){const[e,t]=Object(n.useState)({width:qt(),height:Wt()});return Object(n.useEffect)((()=>{const e=Object(Je.throttle)((()=>{t({width:qt(),height:Wt()})}),250);return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),e}(),u=Object(n.useMemo)((()=>{if(e&&!Object(Je.isEmpty)(e.context))return Object.entries(e.context).reduce(((e,[t,a])=>{const n=`${t} : "${a}"`;return e.length>0?`${e} AND ${n}`:n}),"")}),[e]);return e?i.a.createElement(d.EuiModal,{onClose:s,maxWidth:!1},i.a.createElement(Zt,{width:l-50,height:c-50},i.a.createElement(d.EuiFlexGroup,{direction:"column",responsive:!1,wrap:!1,style:{height:"100%"}},i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(Xt,{context:e.context})),i.a.createElement(d.EuiFlexItem,{grow:1},i.a.createElement(Gt.a,{sourceId:r,startTimestamp:t,endTimestamp:a,query:u,center:e.cursor,highlight:e.id,height:"100%"}))))):null},Zt=It.euiStyled.div`
  padding: 16px;
  width: ${e=>"number"==typeof e.width?`${e.width}px`:e.width};
  height: ${e=>"number"==typeof e.height?`${e.height}px`:e.height};
  max-height: 75vh; // Same as EuiModal
`,Xt=({context:e})=>{let t;if("container.id"in e&&(t=i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.viewInContext.logsFromContainerTitle",defaultMessage:"Displayed logs are from container {container}",values:{container:e["container.id"]}})),"host.name"in e){const a=e["log.file.path"].length>45?e["log.file.path"].slice(0,20)+"..."+e["log.file.path"].slice(-25):e["log.file.path"];t=i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.viewInContext.logsFromFileTitle",defaultMessage:"Displayed logs are from file {file} and host {host}",values:{file:i.a.createElement(d.EuiToolTip,{content:e["log.file.path"]},i.a.createElement("span",null,a)),host:e["host.name"]}})}return i.a.createElement(d.EuiText,{size:"s"},i.a.createElement("p",null,i.a.createElement(d.EuiTextColor,{color:"subdued"},t)))};var Kt=a(140),ea=a(57),ta=a.n(ea),aa=a(214),na=a.n(aa);const ia=({isExpanded:e,item:t,onCollapse:a,onExpand:r})=>{const o=Object(n.useCallback)((()=>e?a(t):r(t)),[e,t,a,r]);return i.a.createElement(d.EuiButtonIcon,{onClick:o,"aria-label":e?ra:oa,iconType:e?"arrowUp":"arrowDown"})},ra=f.i18n.translate("xpack.infra.table.collapseRowLabel",{defaultMessage:"Collapse"}),oa=f.i18n.translate("xpack.infra.table.expandRowLabel",{defaultMessage:"Expand"});var sa=a(170);const la=({datasets:e})=>i.a.createElement("ul",null,e.map((e=>{const t=Object(O.j)(e.name);return i.a.createElement("li",{key:t},i.a.createElement(sa.a,{anomalyScore:e.maximumAnomalyScore}))})));var ca=a(95);const ua=({onReload:e})=>i.a.createElement(d.EuiFlexGroup,{alignItems:"center"},i.a.createElement(d.EuiFlexItem,{grow:!1,className:"eui-textNoWrap"},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.logEntryExamples.exampleEmptyDescription",defaultMessage:"No examples found within the selected time range. Increase the log entry retention period to improve message sample availability."})),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiButton,{onClick:e,size:"s"},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.logEntryExamples.exampleEmptyReloadButtonLabel",defaultMessage:"Reload"})))),da=({onRetry:e})=>i.a.createElement(d.EuiFlexGroup,{alignItems:"center"},i.a.createElement(d.EuiFlexItem,{grow:!1,className:"eui-textNoWrap"},i.a.createElement(d.EuiTextColor,{color:"danger"},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.logEntryExamples.exampleLoadingFailureDescription",defaultMessage:"Failed to load examples."}))),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiButton,{onClick:e,size:"s"},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.logEntryExamples.exampleLoadingFailureRetryButtonLabel",defaultMessage:"Retry"})))),ma=({exampleCount:e})=>i.a.createElement(i.a.Fragment,null,Array.from(new Array(e),((e,t)=>i.a.createElement(d.EuiLoadingContent,{key:t,lines:1})))),ga=({isLoading:e,hasFailedLoading:t,exampleCount:a,hasResults:n,onReload:r,children:o})=>i.a.createElement(fa,null,e?i.a.createElement(ma,{exampleCount:a}):t?i.a.createElement(da,{onRetry:r}):n?o:i.a.createElement(ua,{onReload:r})),fa=It.euiStyled.div`
  align-items: stretch;
  flex-direction: column;
  flex: 1 0 0%;
  overflow: hidden;
  padding-top: 1px; // Buffer for the "Reload" buttons' hover state
`;var ha=a(14),pa=a(150),ba=a(143);const ya=({id:e,dataset:t,message:a,timestamp:r,timeRange:o,tiebreaker:s,context:l})=>{const c=Object(p.useUiTracker)({app:"infra_logs"}),[,{setContextEntry:u}]=Object(n.useContext)($t.Context),d=Object(O.j)(t),[m,g]=Object(n.useState)(!1),h=Object(n.useCallback)((()=>g(!0)),[]),b=Object(n.useCallback)((()=>g(!1)),[]),[y,E]=Object(n.useState)(!1),v=Object(n.useCallback)((()=>E(!0)),[]),x=Object(n.useCallback)((()=>E(!1)),[]),_=Object(p.useLinkProps)({app:"logs",pathname:"stream",search:{logPosition:Object(ha.encode)({end:jt()(o.endTime).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),position:{tiebreaker:s,time:r},start:jt()(o.startTime).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),streamLive:!1}),flyoutOptions:Object(ha.encode)({surroundingLogsId:e}),logFilter:Object(ha.encode)({expression:`${O.z}: ${t}`,kind:"kuery"})}});return i.a.createElement(pa.e,{scale:"medium",onMouseEnter:h,onMouseLeave:b},i.a.createElement(pa.a,Sa[va],i.a.createElement(pa.f,{format:"dateTime",time:r})),i.a.createElement(pa.a,Sa[xa],i.a.createElement(pa.d,{columnValue:{columnId:xa,message:[{field:"message",value:[a],highlights:[]}]},highlights:Ea,isActiveHighlight:!1,wrapMode:"none"})),i.a.createElement(pa.a,Sa[_a],i.a.createElement(pa.c,{columnValue:{columnId:_a,field:"event.dataset",value:[d],highlights:[]},highlights:Ea,isActiveHighlight:!1,wrapMode:"none"})),i.a.createElement(pa.a,Sa[Ma],m||y?i.a.createElement(ba.a,{isOpen:y,onOpen:v,onClose:x,items:[{label:f.i18n.translate("xpack.infra.logs.categoryExample.viewInStreamText",{defaultMessage:"View in stream"}),onClick:_.onClick,href:_.href},{label:f.i18n.translate("xpack.infra.logs.categoryExample.viewInContextText",{defaultMessage:"View in context"}),onClick:()=>{const t={id:e,index:"",context:l,cursor:{time:r,tiebreaker:s},columns:[]};c({metric:"view_in_context__categories"}),u(t)}}]}):null))},Ea=[],va="category-example-timestamp-column",xa="category-examples-message-column",_a="category-examples-dataset-column",Ma="category-examples-icon-column",Sa={[va]:{growWeight:0,shrinkWeight:0,baseWidth:"332px"},[xa]:{growWeight:1,shrinkWeight:0,baseWidth:"0%"},[_a]:{growWeight:0,shrinkWeight:0,baseWidth:"400px"},[Ma]:{growWeight:0,shrinkWeight:0,baseWidth:"32px"}},Ta=({categoryId:e,timeRange:t,sourceId:a})=>{const{getLogEntryCategoryExamples:r,hasFailedLoadingLogEntryCategoryExamples:o,isLoadingLogEntryCategoryExamples:s,logEntryCategoryExamples:l}=(({categoryId:e,endTime:t,exampleCount:a,sourceId:i,startTime:r})=>{const{services:o}=Object(Se.b)(),[s,l]=Object(n.useState)([]),[c,u]=Object(Te.c)({cancelPreviousOn:"creation",createPromise:async()=>await(async(e,t)=>{const{sourceId:a,startTime:n,endTime:i,categoryId:r,exampleCount:o}=e,s=await t(ca.f,{method:"POST",body:JSON.stringify(ca.t.encode({data:{categoryId:r,exampleCount:o,sourceId:a,timeRange:{startTime:n,endTime:i}}}))});return Object(D.b)(ca.u)(s)})({sourceId:i,startTime:r,endTime:t,categoryId:e,exampleCount:a},o.http.fetch),onResolve:({data:{examples:e}})=>{l(e)}},[e,t,a,i,r]),d=Object(n.useMemo)((()=>"pending"===c.state),[c.state]);return{getLogEntryCategoryExamples:u,hasFailedLoadingLogEntryCategoryExamples:Object(n.useMemo)((()=>"rejected"===c.state),[c.state]),isLoadingLogEntryCategoryExamples:d,logEntryCategoryExamples:s}})({categoryId:e,endTime:t.endTime,exampleCount:5,sourceId:a,startTime:t.startTime});return Object(n.useEffect)((()=>{r()}),[r]),i.a.createElement(ga,{isLoading:s,hasFailedLoading:o,hasResults:l.length>0,exampleCount:5,onReload:r},l.map(((e,a)=>i.a.createElement(ya,{key:a,id:e.id,dataset:e.dataset,message:e.message,timeRange:t,timestamp:e.timestamp,tiebreaker:e.tiebreaker,context:e.context}))))},Ca=Object(n.memo)((({maximumSegmentCount:e=30,regularExpression:t})=>{const a=t.split(ka);return i.a.createElement(Oa,null,a.slice(0,e).map(((e,t)=>[t>0?i.a.createElement(ja,{key:`wildcard-${t}`},"⁕"):null,i.a.createElement(wa,{key:`segment-${t}`},e.replace(Ia,"$1"))])),a.length>e?i.a.createElement(ja,{title:f.i18n.translate("xpack.infra.logs.logEntryCategories.truncatedPatternSegmentDescription",{defaultMessage:"{extraSegmentCount, plural, one {one more segment} other {# more segments}}",values:{extraSegmentCount:a.length-e}})},"…"):null)})),Oa=It.euiStyled.span`
  font-family: ${e=>e.theme.eui.euiCodeFontFamily};
  word-break: break-all;
`,ja=It.euiStyled.span`
  color: ${e=>e.theme.eui.euiColorMediumShade};
`,wa=It.euiStyled.span`
  font-weight: bold;
`,ka=/\.[+*]\??/g,Ia=/\\([\\^$*+?.()\[\]])/g;var Fa=a(139);const La=({categorizationJobId:e,categoryId:t,dataset:a,timeRange:r})=>{const{services:{ml:o,http:s,application:l}}=Object(Se.b)(),c=Object(Ft.useMlHref)(o,s.basePath.get(),{page:Ft.ML_PAGES.SINGLE_METRIC_VIEWER,pageState:{jobIds:[e],timeRange:{from:jt()(r.startTime).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),to:jt()(r.endTime).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),mode:"absolute"},entities:{[Fa.i]:a,mlcategory:`${t}`}}}),u=Object(n.useCallback)((e=>{c&&Object(p.shouldHandleLinkEvent)(e)&&l.navigateToUrl(c)}),[l,c]);return i.a.createElement(d.EuiToolTip,{content:Pa,delay:"long"},i.a.createElement(d.EuiButtonIcon,{"aria-label":Da,iconType:"machineLearningApp","data-test-subj":"analyzeCategoryDatasetInMlButton",href:c,onClick:u}))},Da=f.i18n.translate("xpack.infra.logs.logEntryCategories.analyzeCategoryInMlButtonLabel",{defaultMessage:"Analyze in ML"}),Pa=f.i18n.translate("xpack.infra.logs.logEntryCategories.analyzeCategoryInMlTooltipDescription",{defaultMessage:"Analyze this category in the ML app."}),Ra=({categorizationJobId:e,categoryId:t,datasets:a,timeRange:n})=>i.a.createElement("ul",null,a.map((a=>{const r=Object(O.j)(a.name);return i.a.createElement("li",{key:r},i.a.createElement(La,{categorizationJobId:e,categoryId:t,dataset:a.name,timeRange:n}))}))),Na=({datasets:e})=>i.a.createElement("ul",null,e.map((e=>{const t=Object(O.j)(e.name);return i.a.createElement("li",{key:t},i.a.createElement(Aa,null,t))}))),Aa=It.euiStyled.div`
  display: inline-block;
  margin-bottom: 2.5px;
  margin-top: 1px;
`,Ha=({currentValue:e,previousValue:t})=>{const a=e/t-1;return a<0?i.a.createElement(za,null,i.a.createElement(d.EuiIcon,{type:"sortDown",color:"danger"}),i.a.createElement(d.EuiTextColor,{color:"danger"},Ua(a))):a>0&&Number.isFinite(a)?i.a.createElement(za,null,i.a.createElement(d.EuiIcon,{type:"sortUp",color:"success"}),i.a.createElement(d.EuiTextColor,{color:"success"},Ua(a))):a>0&&!Number.isFinite(a)?i.a.createElement(za,null,i.a.createElement(d.EuiIcon,{type:"sortUp",color:"success"}),i.a.createElement(d.EuiTextColor,{color:"success"},Va)):null},Ua=e=>ta()(e).format("+0,0 %"),Va=f.i18n.translate("xpack.infra.logs.logEntryCategories.newCategoryTrendLabel",{defaultMessage:"new"}),za=It.euiStyled.span`
  white-space: nowrap;
`;var Ja=a(50),Ya=a(63),Ba=a(103),$a=a(113);const qa=["value"],Wa={height:20,width:100},Ga=({metric:e,timeRange:t})=>{const[a]=Object(Ba.a)("theme:darkMode"),r=Object($a.a)(),o=Object(n.useMemo)((()=>[Ya.EUI_SPARKLINE_THEME_PARTIAL,a?Ya.EUI_CHARTS_THEME_DARK.theme:Ya.EUI_CHARTS_THEME_LIGHT.theme]),[a]),s=Object(n.useMemo)((()=>({max:t.endTime,min:t.startTime})),[t]);return i.a.createElement(Ja.Chart,{size:Wa},i.a.createElement(Ja.Settings,{showLegend:!1,theme:o,tooltip:Ja.TooltipType.None,xDomain:s}),i.a.createElement(Ja.AreaSeries,{id:"metric",data:e,xAccessor:"timestamp",xScaleType:Ja.ScaleType.Time,yAccessors:qa,timeZone:r}))},Qa=({currentCount:e,histograms:t,timeRange:a})=>{const r=Object(n.useMemo)((()=>{var e,a,n;return null!==(e=null===(a=t.find((e=>"history"===e.histogramId)))||void 0===a||null===(n=a.buckets)||void 0===n?void 0:n.map((({startTime:e,logEntryCount:t})=>({timestamp:e,value:t}))))&&void 0!==e?e:[]}),[t]),o=Object(n.useMemo)((()=>{var e,a,n,i;return null!==(e=null===(a=t.find((e=>"reference"===e.histogramId)))||void 0===a||null===(n=a.buckets)||void 0===n||null===(i=n[0])||void 0===i?void 0:i.logEntryCount)&&void 0!==e?e:0}),[t]),s=Object(n.useMemo)((()=>({endTime:a.endTime,startTime:a.startTime-(a.endTime-a.startTime)})),[a.endTime,a.startTime]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(Ga,{metric:r,timeRange:s}),i.a.createElement(Ha,{previousValue:o,currentValue:e}))},Za=Object(It.euiStyled)((({categorizationJobId:e,className:t,sourceId:a,timeRange:r,topCategories:o,sortOptions:s,changeSortOptions:l})=>{const c=Object(n.useMemo)((()=>({sort:s})),[s]),u=Object(n.useCallback)((({sort:e={}})=>{l(e)}),[l]),[m,{add:g,remove:f}]=na()(new Set),h=Object(n.useMemo)((()=>Xa(r,e,m,g,f)),[e,f,g,m,r]),p=Object(n.useMemo)((()=>[...m].reduce(((e,t)=>({...e,[t]:i.a.createElement(Ta,{categoryId:t,sourceId:a,timeRange:r})})),{})),[m,a,r]);return i.a.createElement(d.EuiBasicTable,{columns:h,itemIdToExpandedRowMap:p,itemId:"categoryId",items:o,rowProps:{className:`${t} euiTableRow--topAligned`},onChange:u,sorting:c})}))`
  &.euiTableRow--topAligned .euiTableRowCell {
    vertical-align: top;
  }
`,Xa=(e,t,a,n,r)=>[{align:"right",field:"logEntryCount",name:f.i18n.translate("xpack.infra.logs.logEntryCategories.countColumnTitle",{defaultMessage:"Message count"}),sortable:!0,render:e=>ta()(e).format("0,0"),width:"120px"},{field:"histograms",name:f.i18n.translate("xpack.infra.logs.logEntryCategories.trendColumnTitle",{defaultMessage:"Trend"}),render:(t,a)=>i.a.createElement(Qa,{currentCount:a.logEntryCount,histograms:t,timeRange:e}),width:"220px"},{field:"regularExpression",name:f.i18n.translate("xpack.infra.logs.logEntryCategories.categoryColumnTitle",{defaultMessage:"Category"}),truncateText:!0,render:e=>i.a.createElement(Ca,{regularExpression:e})},{field:"datasets",name:f.i18n.translate("xpack.infra.logs.logEntryCategories.datasetColumnTitle",{defaultMessage:"Datasets"}),render:e=>i.a.createElement(Na,{datasets:e}),width:"200px"},{align:"right",field:"maximumAnomalyScore",name:f.i18n.translate("xpack.infra.logs.logEntryCategories.maximumAnomalyScoreColumnTitle",{defaultMessage:"Maximum anomaly score"}),sortable:!0,render:(e,t)=>i.a.createElement(la,{datasets:t.datasets}),width:"160px"},{actions:[{render:a=>i.a.createElement(Ra,{categorizationJobId:t,categoryId:a.categoryId,datasets:a.datasets,timeRange:e})}],width:"40px"},{align:"right",isExpander:!0,render:e=>i.a.createElement(ia,{isExpanded:a.has(e.categoryId),item:e.categoryId,onCollapse:r,onExpand:n}),width:"40px"}],Ka=({isLoadingTopCategories:e=!1,jobId:t,sourceId:a,timeRange:n,topCategories:r,sortOptions:o,changeSortOptions:s})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(Kt.a,{isLoading:e,loadingChildren:i.a.createElement(tn,null)},i.a.createElement(Za,{categorizationJobId:t,sourceId:a,timeRange:n,topCategories:r,sortOptions:o,changeSortOptions:s}))),en=f.i18n.translate("xpack.infra.logs.logEntryCategories.topCategoriesSectionLoadingAriaLabel",{defaultMessage:"Loading message categories"}),tn=()=>i.a.createElement(d.EuiLoadingSpinner,{size:"xl","aria-label":en});var an=a(18),nn=a(19),rn=a(24),on=a(81),sn=a(123);const ln=L.union([L.type({interval:L.number,isPaused:L.boolean}),L[void 0]]),cn=L.type({startTime:L.string,endTime:L.string}),un=L.union([cn,L[void 0]]),dn={from:"now-2w",to:"now"},mn=({onOpenSetup:e,pageTitle:t})=>{Object(p.useTrackPageview)({app:"infra_logs",path:"log_entry_categories_results"}),Object(p.useTrackPageview)({app:"infra_logs",path:"log_entry_categories_results",delay:15e3});const{services:{ml:a,http:r}}=Object(Se.b)(),{logViewStatus:o}=Object(Mt.c)(),{hasLogAnalysisSetupCapabilities:s}=ct(),{fetchJobStatus:l,fetchModuleDefinition:c,moduleDescriptor:u,setupStatus:m,hasOutdatedJobConfigurations:g,hasOutdatedJobDefinitions:f,hasStoppedJobs:b,jobIds:y,categoryQualityWarnings:E,sourceConfiguration:{sourceId:v}}=ze(),{timeRange:x,setTimeRange:_,autoRefresh:M,setAutoRefresh:S}=(()=>{const[e]=Object(sn.a)(dn),{from:t,to:a}=e(),[n,i]=Object(on.b)({defaultState:{startTime:t,endTime:a},decodeUrlState:e=>Object(rn.pipe)(un.decode(e),Object(an.fold)(Object(nn.constant)(void 0),nn.identity)),encodeUrlState:un.encode,urlStateKey:"timeRange",writeDefaultState:!0});Object(sn.b)(dn,{from:n.startTime,to:n.endTime});const[r,o]=Object(on.b)({defaultState:{isPaused:!1,interval:6e4},decodeUrlState:e=>Object(rn.pipe)(ln.decode(e),Object(an.fold)(Object(nn.constant)(void 0),nn.identity)),encodeUrlState:ln.encode,urlStateKey:"autoRefresh",writeDefaultState:!0});return{timeRange:n,setTimeRange:i,autoRefresh:r,setAutoRefresh:o}})(),[T,C]=Object(n.useState)((()=>({lastChangedTime:Date.now(),timeRange:gn(x)}))),[O,j]=Object(n.useState)([]),{services:w}=Object(h.useKibana)(),k=Object(n.useCallback)((e=>{var t;null===(t=w.notifications)||void 0===t||t.toasts.addError(e,{title:fn})}),[w.notifications]),{getLogEntryCategoryDatasets:I,getTopLogEntryCategories:F,isLoadingLogEntryCategoryDatasets:L,isLoadingTopLogEntryCategories:P,logEntryCategoryDatasets:R,topLogEntryCategories:N,sortOptions:A,changeSortOptions:H}=(({categoriesCount:e,filteredDatasets:t,endTime:a,onGetLogEntryCategoryDatasetsError:i,onGetTopLogEntryCategoriesError:r,sourceId:o,startTime:s})=>{const[l,c]=Object(n.useState)({field:"maximumAnomalyScore",direction:"desc"}),{services:u}=Object(Se.b)(),[d,m]=Object(n.useState)([]),[g,f]=Object(n.useState)([]),[h,p]=Object(Te.c)({cancelPreviousOn:"creation",createPromise:async()=>await(async(e,t)=>{const{sourceId:a,startTime:n,endTime:i,categoryCount:r,datasets:o,sort:s}=e,l=i-n,c=await t(ca.d,{method:"POST",body:JSON.stringify(ca.p.encode({data:{sourceId:a,timeRange:{startTime:n,endTime:i},categoryCount:r,datasets:o,histograms:[{id:"history",timeRange:{startTime:n-l,endTime:i},bucketCount:10},{id:"reference",timeRange:{startTime:n-l,endTime:n},bucketCount:1}],sort:s}}))});return Object(D.b)(ca.q)(c)})({sourceId:o,startTime:s,endTime:a,categoryCount:e,datasets:t,sort:l},u.http.fetch),onResolve:({data:{categories:e}})=>{m(e)},onReject:e=>{e instanceof Error&&!(e instanceof Te.a)&&r&&r(e)}},[e,a,t,o,s,l]),[b,y]=Object(Te.c)({cancelPreviousOn:"creation",createPromise:async()=>await(async(e,t)=>{const{sourceId:a,startTime:n,endTime:i}=e,r=await t(ca.e,{method:"POST",body:JSON.stringify(ca.r.encode({data:{sourceId:a,timeRange:{startTime:n,endTime:i}}}))});return Object(D.b)(ca.s)(r)})({sourceId:o,startTime:s,endTime:a},u.http.fetch),onResolve:({data:{datasets:e}})=>{f(e)},onReject:e=>{e instanceof Error&&!(e instanceof Te.a)&&i&&i(e)}},[e,a,o,s]),E=Object(n.useMemo)((()=>"pending"===h.state),[h.state]),v=Object(n.useMemo)((()=>"pending"===b.state),[b.state]);return{getLogEntryCategoryDatasets:y,getTopLogEntryCategories:p,isLoading:Object(n.useMemo)((()=>E||v),[v,E]),isLoadingLogEntryCategoryDatasets:v,isLoadingTopLogEntryCategories:E,logEntryCategoryDatasets:g,topLogEntryCategories:d,sortOptions:l,changeSortOptions:c}})({categoriesCount:25,endTime:T.timeRange.endTime,filteredDatasets:O,onGetTopLogEntryCategoriesError:k,sourceId:v,startTime:T.timeRange.startTime}),U=Object(n.useCallback)((({start:e,end:t})=>{C((a=>({...a,timeRange:gn({startTime:e,endTime:t}),lastChangedTime:Date.now()})))}),[C]),V=Object(n.useCallback)((e=>{e.isInvalid||(_({startTime:e.start,endTime:e.end}),U(e))}),[_,U]),z=Object(n.useCallback)((({isPaused:e,refreshInterval:t})=>{S({isPaused:e,interval:t})}),[S]),J=Object(n.useMemo)((()=>N.length>0),[N.length]),Y=Object(n.useMemo)((()=>("skipped"===m.type&&!!m.newlyCreated||"succeeded"===m.type)&&!J),[J,m]);Object(n.useEffect)((()=>{F()}),[F,O,T.lastChangedTime,A]),Object(n.useEffect)((()=>{I()}),[I,T.lastChangedTime]),Object(n.useEffect)((()=>{c()}),[c]),kt()((()=>{l()}),3e4),kt()((()=>{U({start:x.startTime,end:x.endTime})}),M.isPaused?null:M.interval);const B=Object(Ft.useMlHref)(a,r.basePath.get(),{page:Ft.ML_PAGES.ANOMALY_EXPLORER,pageState:{jobIds:[y["log-entry-categories-count"]],timeRange:{from:jt()(T.timeRange.startTime).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),to:jt()(T.timeRange.endTime).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),mode:"absolute"}}});return i.a.createElement($t.Provider,{sourceId:v,startTimestamp:T.timeRange.startTime,endTimestamp:T.timeRange.endTime},i.a.createElement(St,{hasData:"missing"!==(null==o?void 0:o.index),pageHeader:{pageTitle:t,rightSideItems:[i.a.createElement(dt.b,{hasSetupCapabilities:s,onClick:e,size:"s"}),i.a.createElement(At,{href:B})]}},i.a.createElement(d.EuiFlexGroup,{direction:"column"},i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},i.a.createElement(d.EuiFlexItem,null,i.a.createElement(Jt,{availableDatasets:R,isLoading:L,onChangeDatasetSelection:j,selectedDatasets:O})),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiSuperDatePicker,{start:x.startTime,end:x.endTime,onTimeChange:V,isPaused:M.isPaused,refreshInterval:M.interval,onRefreshChange:z})))),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(Ft.MLJobsAwaitingNodeWarning,{jobIds:Object.values(y)}),i.a.createElement(zt,{hasOutdatedJobConfigurations:g,hasOutdatedJobDefinitions:f,hasSetupCapabilities:s,hasStoppedJobs:b,isFirstUse:Y,moduleName:u.moduleName,onRecreateMlJobForReconfiguration:e,onRecreateMlJobForUpdate:e,qualityWarnings:E})),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(Ka,{isLoadingTopCategories:P,jobId:y["log-entry-categories-count"],sourceId:v,timeRange:T.timeRange,topCategories:N,sortOptions:A,changeSortOptions:H})))),i.a.createElement(Qt,null))},gn=e=>({startTime:jt()(Ct.a.parse(e.startTime,{momentInstance:jt.a})).valueOf(),endTime:jt()(Ct.a.parse(e.endTime,{momentInstance:jt.a,roundUp:!0})).valueOf()}),fn=(Object(It.euiStyled)(d.EuiPage)`
  flex: 1 0 0%;
  flex-direction: column;

  .euiFlexGroup--responsive > .euiFlexItem {
    flex-basis: auto !important;
  }
`,f.i18n.translate("xpack.infra.logs.logEntryCategories.loadDataErrorTitle",{defaultMessage:"Failed to load category data"})),hn=({onOpenSetup:e})=>(Object(p.useTrackPageview)({app:"infra_logs",path:"log_entry_categories_setup"}),Object(p.useTrackPageview)({app:"infra_logs",path:"log_entry_categories_setup",delay:15e3}),i.a.createElement(d.EuiEmptyPrompt,{"data-test-subj":"logEntryCategoriesSetupPage",title:i.a.createElement("h2",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.logEntryCategories.setupTitle",defaultMessage:"Set up log category analysis"})),body:i.a.createElement(d.EuiText,{size:"s"},i.a.createElement("p",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.logEntryCategories.setupDescription",defaultMessage:"To enable log categories, set up a machine learning job."}))),actions:i.a.createElement(d.EuiButton,{fill:!0,onClick:e},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.logEntryCategories.showAnalysisSetupButtonLabel",defaultMessage:"ML setup"}))})),pn=f.i18n.translate("xpack.infra.logs.logCategoriesTitle",{defaultMessage:"Categories"}),bn=()=>{const{hasLogAnalysisCapabilites:e,hasLogAnalysisReadCapabilities:t,hasLogAnalysisSetupCapabilities:a}=ct(),{fetchJobStatus:r,setupStatus:o,jobStatus:s}=ze(),{showModuleSetup:l}=bt(),c=Object(n.useCallback)((()=>l("logs_ui_categories")),[l]);return Object(n.useEffect)((()=>{t&&r()}),[r,t]),e?t?"initializing"===o.type?i.a.createElement(j.a,{message:f.i18n.translate("xpack.infra.logs.logEntryCategories.jobStatusLoadingMessage",{defaultMessage:"Checking status of categorization jobs..."})}):"unknown"===o.type?i.a.createElement(En,{isEmptyState:!0},i.a.createElement(w.a,{retry:r})):Object(O.p)(s["log-entry-categories-count"])?i.a.createElement(i.a.Fragment,null,i.a.createElement(mn,{onOpenSetup:c,pageTitle:pn}),i.a.createElement(Et,{allowedModules:yn})):a?i.a.createElement(i.a.Fragment,null,i.a.createElement(En,{isEmptyState:!0},i.a.createElement(hn,{onOpenSetup:c})),i.a.createElement(Et,{allowedModules:yn})):i.a.createElement(En,{isEmptyState:!0},i.a.createElement(w.c,null)):i.a.createElement(En,{isEmptyState:!0},i.a.createElement(w.b,null)):i.a.createElement(_t.a,{"data-test-subj":"logsLogEntryCategoriesPage",pageHeader:{pageTitle:pn}})},yn=["logs_ui_categories"],En=({children:e,...t})=>{const{logViewStatus:a}=Object(Mt.c)();return i.a.createElement(St,g()({hasData:"missing"!==(null==a?void 0:a.index),"data-test-subj":"logsLogEntryCategoriesPage",pageHeader:t.isEmptyState?void 0:{pageTitle:pn}},t),e)};var vn=a(58),xn=a(3);const _n=({errors:e,onRetry:t})=>{const a=Object(p.useLinkProps)({app:"logs",pathname:"/settings"});return i.a.createElement(St,{isEmptyState:!0},i.a.createElement(d.EuiEmptyPrompt,{iconType:"alert",iconColor:"danger",title:i.a.createElement("h2",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceErrorPage.failedToLoadSourceTitle",defaultMessage:"Failed to load configuration"})),body:i.a.createElement(i.a.Fragment,null,i.a.createElement("p",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceErrorPage.failedToLoadSourceMessage",defaultMessage:"Errors occurred while attempting to load the configuration. Try again or change the configuration to fix the problem."})),e.map((e=>i.a.createElement(i.a.Fragment,{key:e.name},i.a.createElement(Mn,{error:e}),i.a.createElement(d.EuiSpacer,null))))),actions:[i.a.createElement(d.EuiButton,{onClick:t,iconType:"refresh",fill:!0},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceErrorPage.tryAgainButtonLabel",defaultMessage:"Try again"})),i.a.createElement(d.EuiButtonEmpty,g()({iconType:"gear"},a),i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceErrorPage.navigateToSettingsButtonLabel",defaultMessage:"Change configuration"}))]}))},Mn=({error:e})=>{var t,a,n,r,o,s;return e instanceof xn.d?i.a.createElement(Sn,{title:i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceErrorPage.resolveLogSourceConfigurationErrorTitle",defaultMessage:"Failed to resolve the log source configuration"})},e.cause instanceof vn.SavedObjectNotFound?i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceErrorPage.savedObjectNotFoundErrorMessage",defaultMessage:"Failed to locate that {savedObjectType}: {savedObjectId}",values:{savedObjectType:e.cause.savedObjectType,savedObjectId:e.cause.savedObjectId}}):`${null!==(t=null===(a=e.cause)||void 0===a?void 0:a.message)&&void 0!==t?t:e.message}`):e instanceof xn.a?i.a.createElement(Sn,{title:i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceErrorPage.fetchLogSourceConfigurationErrorTitle",defaultMessage:"Failed to load the log source configuration"})},`${null!==(n=null===(r=e.cause)||void 0===r?void 0:r.message)&&void 0!==n?n:e.message}`):e instanceof xn.b?i.a.createElement(Sn,{title:i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceErrorPage.fetchLogSourceStatusErrorTitle",defaultMessage:"Failed to determine the status of the log source"})},`${null!==(o=null===(s=e.cause)||void 0===s?void 0:s.message)&&void 0!==o?o:e.message}`):i.a.createElement(Sn,{title:e.name},`${e.message}`)},Sn=({title:e,children:t})=>i.a.createElement(d.EuiCallOut,{className:"eui-textLeft",color:"danger",iconType:"alert",title:e},i.a.createElement("p",null,t));var Tn=a(104),Cn=a(171);const On=({children:e})=>{const{hasFailedLoading:t,isLoading:a,isUninitialized:n,latestLoadLogViewFailures:r,load:o,resolvedLogView:s,logViewId:l}=Object(Mt.c)(),{space:c}=Object(Cn.a)();return null==c?null:t?i.a.createElement(_n,{errors:r,onRetry:o}):a||n?i.a.createElement(Tn.a,null):null!=s?i.a.createElement(Ve,{indexPattern:s.indices,sourceId:l,spaceId:c.id,timestampField:s.timestampField,runtimeMappings:s.runtimeMappings},i.a.createElement(pt,null,e)):null},jn=()=>(C([{text:T.c}]),i.a.createElement(d.EuiErrorBoundary,null,i.a.createElement(On,null,i.a.createElement(bn,null))));var wn=a(34);const kn=e=>i.a.createElement(d.EuiButton,e,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.analysis.manageMlJobsButtonLabel",defaultMessage:"Manage ML jobs"}));var In=a(119),Fn=a(210);const Ln=L.type({sourceId:L.string,logEntryId:L.string}),Dn=L.type({id:L.string,index:L.string,fields:L.array(In.e),cursor:In.d}),Pn=L.intersection([L.type({data:L.union([Dn,L.null])}),L.partial({errors:L.array(Fn.a)})]);var Rn=a(151);const Nn=Object(Rn.b)(null,Object(D.b)(Pn)),An=Object(It.euiStyled)(d.EuiFlyoutBody)`
  & .euiFlyoutBody__overflow {
    display: flex;
    flex-direction: column;
  }

  & .euiFlyoutBody__overflowContent {
    align-items: center;
    align-self: stretch;
    display: flex;
    flex-direction: column;
    flex-grow: 1;
    justify-content: center;
    overflow: hidden;
  }
`,Hn=({errors:e,onRetry:t,title:a})=>{const n=e.some((e=>"aborted"!==e.type))?"danger":"warning";return i.a.createElement(d.EuiCallOut,{color:n,iconType:"alert",title:a},null==e?void 0:e.map(((e,t)=>i.a.createElement(Un,{key:t,error:e}))),t?i.a.createElement(d.EuiButton,{color:n,size:"s",onClick:t},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.dataSearch.loadingErrorRetryButtonLabel",defaultMessage:"Retry"})):null)},Un=({error:e})=>"aborted"===e.type?i.a.createElement(Vn,{error:e}):"shardFailure"===e.type?i.a.createElement(Jn,{error:e}):i.a.createElement(zn,{error:e}),Vn=({})=>i.a.createElement(k.FormattedMessage,{tagName:"p",id:"xpack.infra.dataSearch.abortedRequestErrorMessage",defaultMessage:"The request was aborted."}),zn=({error:e})=>{var t;return i.a.createElement("p",null,null!==(t=e.message)&&void 0!==t?t:`${e}`)},Jn=({error:e})=>i.a.createElement(k.FormattedMessage,{tagName:"p",id:"xpack.infra.dataSearch.shardFailureErrorMessage",defaultMessage:"Index {indexName}: {errorMessage}",values:{indexName:e.shardInfo.index,errorMessage:e.message}}),Yn=({label:e,maxValue:t,onCancel:a,value:r})=>{const o=Object(n.useMemo)((()=>Number.isFinite(t)&&Number.isFinite(r)?`${r} / ${t}`:void 0),[r,t]);return i.a.createElement(d.EuiFlexGroup,{alignItems:"center"},i.a.createElement(d.EuiFlexItem,null,i.a.createElement(d.EuiProgress,{label:e,size:"s",max:t,value:r,valueText:o})),a?i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiButtonIcon,{color:"danger",iconType:"cross",onClick:a,title:Bn,"aria-label":Bn})):null)},Bn=f.i18n.translate("xpack.infra.dataSearch.cancelButtonLabel",{defaultMessage:"Cancel request"});var $n=a(141);const qn=["container.id","host.ip","kubernetes.pod.uid"],Wn=({logEntry:e})=>{const{hide:t,isVisible:a,show:r}=Object($n.a)(!1),o=Object(n.useMemo)((()=>Qn(e)),[e]),s=Object(n.useMemo)((()=>Gn(e)),[e]),l=Object(p.useLinkProps)({app:"uptime",...s||{}}),c=Object(p.useLinkProps)({app:"apm",...o||{}}),u=Object(n.useMemo)((()=>[i.a.createElement(d.EuiContextMenuItem,g()({"data-test-subj":"logEntryActionsMenuItem uptimeLogEntryActionsMenuItem",disabled:!s,icon:"uptimeApp",key:"uptimeLink"},l),i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logEntryActionsMenu.uptimeActionLabel",defaultMessage:"View status in Uptime"})),i.a.createElement(d.EuiContextMenuItem,g()({"data-test-subj":"logEntryActionsMenuItem apmLogEntryActionsMenuItem",disabled:!o,icon:"apmApp",key:"apmLink"},c),i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logEntryActionsMenu.apmActionLabel",defaultMessage:"View in APM"}))]),[s,o,c,l]),m=Object(n.useMemo)((()=>u.length>0),[u]);return i.a.createElement(d.EuiPopover,{anchorPosition:"downRight",button:i.a.createElement(d.EuiButton,{"data-test-subj":"logEntryActionsMenuButton",disabled:!m,iconSide:"right",iconType:"arrowDown",onClick:r},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logEntryActionsMenu.buttonLabel",defaultMessage:"Investigate"})),closePopover:t,id:"logEntryActionsMenu",isOpen:a,panelPaddingSize:"none"},i.a.createElement(d.EuiContextMenuPanel,{items:u}))},Gn=e=>{const t=e.fields.filter((({field:e,value:t})=>null!=t&&qn.includes(e))).reduce(((e,t)=>{const{field:a,value:n}=t;return e.concat(n.map((e=>`${a}:${e}`)))}),[]);if(0!==t.length)return{app:"uptime",hash:"/",search:{search:`${t.join(" or ")}`}}},Qn=e=>{var t,a;const n=null===(t=e.fields.find((({field:e,value:t})=>"string"==typeof t[0]&&"trace.id"===e)))||void 0===t||null===(a=t.value)||void 0===a?void 0:a[0];if("string"!=typeof n)return;const i=e.fields.find((({field:e})=>"@timestamp"===e)),r=i?i.value[0]:null,{rangeFrom:o,rangeTo:s}="number"==typeof r?(()=>{const e=new Date(r),t=new Date(r);return e.setMinutes(e.getMinutes()-10),t.setMinutes(t.getMinutes()+10),{rangeFrom:e.toISOString(),rangeTo:t.toISOString()}})():{rangeFrom:"now-1y",rangeTo:"now"};return{app:"apm",pathname:Object(p.getApmTraceUrl)({traceId:n,rangeFrom:o,rangeTo:s})}};var Zn=a(130),Xn=a(189);const Kn=({logEntry:e,onSetFieldFilter:t})=>{const a=Object(n.useMemo)((()=>t?a=>()=>{L.array(Zn.c).is(a.value)&&(null==t||t({language:"kuery",query:`${ri(a.field)}:${a.value.map(ri).join(" OR ")}`},e.id,e.cursor))}:void 0),[e,t]),r=Object(n.useMemo)((()=>[{field:"field",name:f.i18n.translate("xpack.infra.logFlyout.fieldColumnLabel",{defaultMessage:"Field"}),sortable:!0},{actions:[{type:"icon",icon:"filter",name:ni,description:ii,available:()=>!!a,onClick:e=>null==a?void 0:a(e)()}]},{field:"value",name:f.i18n.translate("xpack.infra.logFlyout.valueColumnLabel",{defaultMessage:"Value"}),render:(e,t)=>i.a.createElement(Xn.a,{highlightTerms:ei,isActiveHighlight:!1,value:t.value})}]),[a]);return i.a.createElement(d.EuiInMemoryTable,{columns:r,items:e.fields,search:ai,sorting:ti})},ei=[],ti={sort:{field:"field",direction:"asc"}},ai={box:{incremental:!0,schema:!0}},ni=f.i18n.translate("xpack.infra.logFlyout.filterAriaLabel",{defaultMessage:"Filter"}),ii=f.i18n.translate("xpack.infra.logFlyout.setFilterTooltip",{defaultMessage:"View event with filter"}),ri=e=>"string"==typeof e?`"${e.replace(/"/g,'\\"')}"`:e,oi=({logEntryId:e,onCloseFlyout:t,onSetFieldFilter:a,sourceId:r})=>{var o;const{cancelRequest:s,errors:l,fetchLogEntry:c,isRequestRunning:u,loaded:m,logEntry:g,total:f}=(({sourceId:e,logEntryId:t})=>{const{search:a,requests$:i}=Object(Rn.c)({getRequest:Object(n.useCallback)((()=>t&&e?{request:{params:Ln.encode({sourceId:e,logEntryId:t})},options:{strategy:"infra-log-entry"}}:null),[e,t]),parseResponses:Nn}),{cancelRequest:r,isRequestRunning:o,isResponsePartial:s,latestResponseData:l,latestResponseErrors:c,loaded:u,total:d}=Object(Rn.e)(i);return{cancelRequest:r,errors:c,fetchLogEntry:a,isRequestRunning:o,isResponsePartial:s,loaded:u,logEntry:null!=l?l:null,total:d}})({sourceId:r,logEntryId:e});return Object(n.useEffect)((()=>{r&&e&&c()}),[c,r,e]),i.a.createElement(d.EuiFlyout,{onClose:t,size:"m"},i.a.createElement(d.EuiFlyoutHeader,{hasBorder:!0},i.a.createElement(d.EuiFlexGroup,{alignItems:"center"},i.a.createElement(d.EuiFlexItem,null,i.a.createElement(d.EuiTitle,{size:"s"},i.a.createElement("h3",{id:"flyoutTitle"},i.a.createElement(k.FormattedMessage,{defaultMessage:"Details for log entry {logEntryId}",id:"xpack.infra.logFlyout.flyoutTitle",values:{logEntryId:e?i.a.createElement("code",null,e):""}}))),g?i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiSpacer,{size:"s"}),i.a.createElement(d.EuiTextColor,{color:"subdued"},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logFlyout.flyoutSubTitle",defaultMessage:"From index {indexName}",values:{indexName:i.a.createElement("code",null,g.index)}}))):null),i.a.createElement(d.EuiFlexItem,{style:{padding:8},grow:!1},g?i.a.createElement(Wn,{logEntry:g}):null))),u?i.a.createElement(An,null,i.a.createElement("div",{style:{width:"75%"}},i.a.createElement(Yn,{label:si,maxValue:f,onCancel:s,value:m}))):g?i.a.createElement(d.EuiFlyoutBody,{banner:(null!==(o=null==l?void 0:l.length)&&void 0!==o?o:0)>0?i.a.createElement(Hn,{title:li,errors:null!=l?l:[],onRetry:c}):void 0},i.a.createElement(Kn,{logEntry:g,onSetFieldFilter:a})):i.a.createElement(An,null,i.a.createElement("div",{style:{width:"75%"}},i.a.createElement(Hn,{title:li,errors:null!=l?l:[],onRetry:c}))))},si=f.i18n.translate("xpack.infra.logFlyout.loadingMessage",{defaultMessage:"Searching log entry in shards"}),li=f.i18n.translate("xpack.infra.logFlyout.loadingErrorCalloutTitle",{defaultMessage:"Error while searching the log entry"});var ci=a(89);let ui;!function(e){e.hidden="hidden",e.visible="visible"}(ui||(ui={}));const di=Me()((()=>{const[e,t]=Object(n.useState)(!1),[a,i]=Object(n.useState)(null),[r,o]=Object(n.useState)(null);return{isFlyoutOpen:e,closeFlyout:Object(n.useCallback)((()=>t(!1)),[]),openFlyout:Object(n.useCallback)((e=>{e&&i(e),t(!0)}),[]),logEntryId:a,setLogEntryId:i,surroundingLogsId:r,setSurroundingLogsId:o}})),[mi,gi]=di,fi=()=>{const{isFlyoutOpen:e,openFlyout:t,closeFlyout:a,logEntryId:n,setLogEntryId:r,surroundingLogsId:o,setSurroundingLogsId:s}=gi();return i.a.createElement(ci.a,{urlState:{flyoutVisibility:e?ui.visible:ui.hidden,flyoutId:n,surroundingLogsId:o},urlStateKey:"flyoutOptions",mapToUrlState:hi,onChange:e=>{e&&e.flyoutId&&r(e.flyoutId),e&&e.surroundingLogsId&&s(e.surroundingLogsId),e&&e.flyoutVisibility===ui.visible&&t(),e&&e.flyoutVisibility===ui.hidden&&a()},onInitialize:e=>{e&&e.flyoutId&&r(e.flyoutId),e&&e.surroundingLogsId&&s(e.surroundingLogsId),e&&e.flyoutVisibility===ui.visible&&t(),e&&e.flyoutVisibility===ui.hidden&&a()}})},hi=e=>e?{flyoutId:pi(e.flyoutId),flyoutVisibility:yi(e.flyoutVisibility),surroundingLogsId:bi(e.surroundingLogsId)}:void 0,pi=e=>e&&Object(Je.isString)(e)?e:void 0,bi=e=>e&&Object(Je.isString)(e)?e:void 0,yi=e=>{if(e){if("visible"===e)return ui.visible;if("hidden"===e)return ui.hidden}};var Ei=a(38),vi=a(97);const xi=({embeddableType:e})=>i.a.createElement(d.EuiCallOut,{size:"s",color:"warning",title:f.i18n.translate("xpack.infra.missingEmebeddableFactoryCallout",{defaultMessage:"{embeddableType} embeddable is unavailable. This can happen if the embeddable plugin isn't enabled.",values:{embeddableType:e}})}),_i={pause:!0,value:0},Mi=e=>{const{embeddable:t}=Object(Se.b)().services;return t?i.a.createElement(Si,e):null},Si=({timeRange:e,jobIds:t,selectedDatasets:a})=>{const{embeddable:r}=Object(Se.b)().services,o=null==r?void 0:r.getEmbeddableFactory(Ft.ANOMALY_SWIMLANE_EMBEDDABLE_TYPE),s=Object(n.useMemo)((()=>({id:"LOG_ENTRY_ANOMALIES_EMBEDDABLE_INSTANCE",jobIds:t,swimlaneType:"viewBy",timeRange:{from:jt()(e.startTime).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),to:jt()(e.endTime).format("YYYY-MM-DDTHH:mm:ss.SSSZ")},refreshConfig:_i,viewBy:vi.i,filters:[],query:{language:"kuery",query:a.map((e=>`${vi.i} : ${""!==e?e:'""'}`)).join(" or ")}})),[t,e.startTime,e.endTime,a]);return o?i.a.createElement(Ei.EmbeddableRenderer,{input:s,factory:o}):i.a.createElement(xi,{embeddableType:Ft.ANOMALY_SWIMLANE_EMBEDDABLE_TYPE})};var Ti=a(64);var Ci=a(212);const Oi=e=>null!=e&&"messageColumn"in e,ji=e=>null!=e&&"timestampColumn"in e;var wi=a(169);const ki=f.i18n.translate("xpack.infra.logAnomalies.logEntryExamplesMenuLabel",{defaultMessage:"View actions for log entry"}),Ii=f.i18n.translate("xpack.infra.logs.analysis.logEntryExamplesViewDetailsLabel",{defaultMessage:"View details"}),Fi=f.i18n.translate("xpack.infra.logs.analysis.logEntryExamplesViewInStreamLabel",{defaultMessage:"View in stream"}),Li=f.i18n.translate("xpack.infra.logs.analysis.logEntryExamplesViewAnomalyInMlLabel",{defaultMessage:"View anomaly in machine learning"}),Di=({id:e,dataset:t,message:a,timestamp:r,tiebreaker:o,timeRange:s,anomaly:l})=>{const{services:{ml:c,http:u,application:d}}=Object(Se.b)(),[m,f]=Object(n.useState)(!1),[h,b]=Object(n.useState)(!1),y=Object(n.useCallback)((()=>b(!0)),[]),E=Object(n.useCallback)((()=>b(!1)),[]),v=Object(n.useCallback)((()=>f(!0)),[]),x=Object(n.useCallback)((()=>f(!1)),[]),{openFlyout:_}=gi(),M=Object(O.j)(t),S=Object(p.useLinkProps)({app:"logs",pathname:"stream",search:{logPosition:Object(ha.encode)({end:jt()(s.endTime).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),position:{tiebreaker:o,time:r},start:jt()(s.startTime).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),streamLive:!1}),flyoutOptions:Object(ha.encode)({surroundingLogsId:e}),...t?{logFilter:Object(ha.encode)({expression:`${Fa.i}: ${t}`,kind:"kuery"})}:{}}}),T=Object(Ft.useMlHref)(c,u.basePath.get(),{page:Ft.ML_PAGES.SINGLE_METRIC_VIEWER,pageState:{jobIds:[l.jobId],timeRange:{from:jt()(s.startTime).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),to:jt()(s.endTime).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),mode:"absolute"},entities:{[Fa.i]:t,...Object(O.n)(l)?{mlcategory:l.categoryId}:{}}}}),C=Object(n.useCallback)((e=>{T&&Object(p.shouldHandleLinkEvent)(e)&&d.navigateToUrl(T)}),[T,d]),j=Object(n.useMemo)((()=>{if(S.onClick&&T)return[{label:Ii,onClick:()=>{_(e)}},{label:Fi,onClick:S.onClick,href:S.href},{label:Li,onClick:C,href:T}]}),[e,_,S,T,C]);return i.a.createElement(pa.e,{scale:"medium",onMouseEnter:v,onMouseLeave:x},i.a.createElement(pa.a,Hi[Ri],i.a.createElement(pa.f,{format:"time",time:r})),i.a.createElement(pa.a,Hi[Ni],i.a.createElement(pa.d,{columnValue:{columnId:Ni,message:[{field:"message",value:[a],highlights:[]}]},highlights:Pi,isActiveHighlight:!1,wrapMode:"none"})),i.a.createElement(pa.a,Hi[Ai],i.a.createElement(pa.c,{columnValue:{columnId:Ai,field:"event.dataset",value:[M],highlights:[]},highlights:Pi,isActiveHighlight:!1,wrapMode:"none"})),i.a.createElement(pa.a,g()({key:"logColumn iconLogColumn iconLogColumn:details"},Hi[pa.h]),(m||h)&&j?i.a.createElement(pa.b,{"aria-label":ki,isOpen:h,onOpen:y,onClose:E,items:j}):null))},Pi=[],Ri="log-entry-example-timestamp-column",Ni="log-entry-examples-message-column",Ai="log-entry-examples-dataset-column",Hi={[Ri]:{growWeight:0,shrinkWeight:0,baseWidth:"122px"},[Ni]:{growWeight:1,shrinkWeight:0,baseWidth:"0%"},[Ai]:{growWeight:0,shrinkWeight:0,baseWidth:"250px"},[pa.h]:{growWeight:0,shrinkWeight:0,baseWidth:"48px"}},Ui=[{timestampColumn:{id:Ri}},{messageColumn:{id:Ni}},{fieldColumn:{field:"event.dataset",id:Ai}}],Vi=({dateTime:e})=>i.a.createElement(zi,null,i.a.createElement(i.a.Fragment,null,Ui.map((t=>{return ji(t)?i.a.createElement(Ci.a,{key:t.timestampColumn.id,columnWidth:Hi[t.timestampColumn.id],"data-test-subj":"logColumnHeader timestampLogColumnHeader"},Object(wi.a)(e)):Oi(t)?i.a.createElement(Ci.a,{columnWidth:Hi[t.messageColumn.id],"data-test-subj":"logColumnHeader messageLogColumnHeader",key:t.messageColumn.id},"Message"):null!=(a=t)&&"fieldColumn"in a?i.a.createElement(Ci.a,{columnWidth:Hi[t.fieldColumn.id],"data-test-subj":"logColumnHeader fieldLogColumnHeader",key:t.fieldColumn.id},t.fieldColumn.field):void 0;var a})),i.a.createElement(Ci.a,{columnWidth:Hi[pa.h],"data-test-subj":"logColumnHeader contextMenuLogColumnHeader",key:"icon-column-header"},null))),zi=Object(It.euiStyled)(Ci.c)`
  border-bottom: none;
  box-shadow: none;
  padding-right: 0;
`,Ji=f.i18n.translate("xpack.infra.logs.analysis.anomaliesTableExamplesTitle",{defaultMessage:"Example log entries"}),Yi=({anomaly:e,timeRange:t})=>{const{logViewId:a}=Object(Mt.c)(),{getLogEntryExamples:r,hasFailedLoadingLogEntryExamples:o,isLoadingLogEntryExamples:s,logEntryExamples:l}=(({dataset:e,endTime:t,exampleCount:a,sourceId:i,startTime:r,categoryId:o})=>{const{services:s}=Object(Se.b)(),[l,c]=Object(n.useState)([]),[u,d]=Object(Te.c)({cancelPreviousOn:"creation",createPromise:async()=>await(async(e,t)=>{const{sourceId:a,startTime:n,endTime:i,dataset:r,exampleCount:o,categoryId:s}=e,l=await t(ca.g,{method:"POST",body:JSON.stringify(ca.v.encode({data:{dataset:r,exampleCount:o,sourceId:a,timeRange:{startTime:n,endTime:i},categoryId:s}}))});return Object(D.b)(ca.w)(l)})({sourceId:i,startTime:r,endTime:t,dataset:e,exampleCount:a,categoryId:o},s.http.fetch),onResolve:({data:{examples:e}})=>{c(e)}},[e,t,a,i,r]),m=Object(n.useMemo)((()=>"pending"===u.state),[u.state]);return{getLogEntryExamples:d,hasFailedLoadingLogEntryExamples:Object(n.useMemo)((()=>"rejected"===u.state),[u.state]),isLoadingLogEntryExamples:m,logEntryExamples:l}})({dataset:e.dataset,endTime:e.startTime+e.duration,exampleCount:5,sourceId:a,startTime:e.startTime,categoryId:Object(O.n)(e)?e.categoryId:void 0});return F()((()=>{r()})),i.a.createElement(i.a.Fragment,null,i.a.createElement(Bi,{direction:"column"},i.a.createElement(d.EuiFlexItem,null,i.a.createElement(d.EuiTitle,{size:"xs"},i.a.createElement("h3",null,Ji))),i.a.createElement(d.EuiFlexItem,null,i.a.createElement(ga,{isLoading:s,hasFailedLoading:o,hasResults:l.length>0,exampleCount:5,onReload:r},l.length>0?i.a.createElement(i.a.Fragment,null,i.a.createElement(Vi,{dateTime:l[0].timestamp}),l.map(((a,n)=>i.a.createElement(Di,{key:n,id:a.id,dataset:a.dataset,message:a.message,timestamp:a.timestamp,tiebreaker:a.tiebreaker,timeRange:t,anomaly:e})))):null)),i.a.createElement(d.EuiFlexItem,null,i.a.createElement(d.EuiFlexGroup,null,i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiStat,{titleSize:"xs",title:`${ta()(e.typical).format("0.[00]a")} ${f.i18n.translate("xpack.infra.logs.analysis.anomaliesExpandedRowTypicalRateTitle",{defaultMessage:"{typicalCount, plural, one {message} other {messages}}",values:{typicalCount:e.typical}})}`,description:f.i18n.translate("xpack.infra.logs.analysis.anomaliesExpandedRowTypicalRateDescription",{defaultMessage:"Typical"})})),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiStat,{titleSize:"xs",title:`${ta()(e.actual).format("0.[00]a")} ${f.i18n.translate("xpack.infra.logs.analysis.anomaliesExpandedRowActualRateTitle",{defaultMessage:"{actualCount, plural, one {message} other {messages}}",values:{actualCount:e.actual}})}`,description:f.i18n.translate("xpack.infra.logs.analysis.anomaliesExpandedRowActualRateDescription",{defaultMessage:"Actual"})}))))))},Bi=Object(It.euiStyled)(d.EuiFlexGroup)`
  overflow: hidden;
`,$i=f.i18n.translate("xpack.infra.logs.analysis.anomaliesTableAnomalyScoreColumnName",{defaultMessage:"Anomaly score"}),qi=f.i18n.translate("xpack.infra.logs.analysis.anomaliesTableAnomalyMessageName",{defaultMessage:"Anomaly"}),Wi=f.i18n.translate("xpack.infra.logs.analysis.anomaliesTableAnomalyStartTime",{defaultMessage:"Start time"}),Gi=f.i18n.translate("xpack.infra.logs.analysis.anomaliesTableAnomalyDatasetName",{defaultMessage:"Dataset"}),Qi=({results:e,timeRange:t,changeSortOptions:a,sortOptions:r,changePaginationOptions:o,paginationOptions:s,fetchNextPage:l,fetchPreviousPage:c,page:u,isLoading:m})=>{const[g]=Object(Ba.a)("dateFormat","Y-MM-DD HH:mm:ss"),f=Object(n.useMemo)((()=>({sort:r})),[r]),h=Object(n.useMemo)((()=>e.map((e=>({id:e.id,dataset:e.dataset,anomalyScore:e.anomalyScore,startTime:e.startTime,type:e.type,typical:e.typical,actual:e.actual,categoryRegex:Object(O.n)(e)?e.categoryRegex:void 0})))),[e]),[p,{add:b,remove:y}]=na()(new Set),E=Object(n.useMemo)((()=>[...p].reduce(((a,n)=>{const r=e.find((e=>e.id===n));return{...a,[n]:r?i.a.createElement(Yi,{anomaly:r,timeRange:t}):null}}),{})),[p,e,t]),v=Object(n.useCallback)((({sort:e={}})=>{a(e)}),[a]),x=Object(n.useMemo)((()=>[{field:"anomalyScore",name:$i,sortable:!0,truncateText:!0,dataType:"number",width:"130px",render:e=>i.a.createElement(sa.a,{anomalyScore:e})},{name:qi,truncateText:!0,render:e=>i.a.createElement(Zi,{anomaly:e})},{field:"startTime",name:Wi,sortable:!0,truncateText:!0,width:"230px",render:e=>jt()(e).format(g)},{field:"dataset",name:Gi,sortable:!0,truncateText:!0,width:"200px",render:e=>Object(O.j)(e)},{align:Ti.RIGHT_ALIGNMENT,width:"40px",isExpander:!0,render:e=>i.a.createElement(ia,{isExpanded:p.has(e.id),item:e.id,onExpand:b,onCollapse:y})}]),[y,b,p,g]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(Kt.a,{isLoading:m},i.a.createElement(d.EuiBasicTable,{items:h,itemId:"id",itemIdToExpandedRowMap:E,isExpandable:!0,hasActions:!0,columns:x,sorting:f,onChange:v}),i.a.createElement(d.EuiSpacer,{size:"l"}),i.a.createElement(er,{fetchNextPage:l,fetchPreviousPage:c,page:u,isLoading:m})))},Zi=({anomaly:e})=>{const{type:t,actual:a,typical:n}=e,r=f.i18n.translate("xpack.infra.logs.analysis.anomaliesTableMoreThanExpectedAnomalyMessage",{defaultMessage:"more log messages in this {type, select, logRate {dataset} logCategory {category}} than expected",values:{type:t}}),o=f.i18n.translate("xpack.infra.logs.analysis.anomaliesTableFewerThanExpectedAnomalyMessage",{defaultMessage:"fewer log messages in this {type, select, logRate {dataset} logCategory {category}} than expected",values:{type:t}}),s=a>n,l=s?r:o,c=s?a/n:n/a,u=s?"sortUp":"sortDown",m=c!==1/0?`${Object(O.h)(c)}x`:"";return i.a.createElement(d.EuiFlexGroup,{gutterSize:"s",responsive:!1,alignItems:"center"},i.a.createElement(d.EuiFlexItem,{grow:!1,component:"span"},i.a.createElement(d.EuiIcon,{type:u})),i.a.createElement(d.EuiFlexItem,{component:"span"},`${m} ${l}`,e.categoryRegex&&i.a.createElement(i.a.Fragment,null,": ",i.a.createElement(Ca,{regularExpression:e.categoryRegex}))))},Xi=f.i18n.translate("xpack.infra.logs.analysis.anomaliesTablePreviousPageLabel",{defaultMessage:"Previous page"}),Ki=f.i18n.translate("xpack.infra.logs.analysis.anomaliesTableNextPageLabel",{defaultMessage:"Next page"}),er=({fetchPreviousPage:e,fetchNextPage:t,page:a,isLoading:n})=>i.a.createElement(d.EuiFlexGroup,{justifyContent:"center"},i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiFlexGroup,null,i.a.createElement(d.EuiButtonIcon,{iconType:"arrowLeft",isDisabled:!e||n,onClick:e,"aria-label":Xi}),i.a.createElement("span",null,i.a.createElement("strong",null,a)),i.a.createElement(d.EuiButtonIcon,{iconType:"arrowRight",isDisabled:!t||n,onClick:t,"aria-label":Ki})))),tr=({isLoadingAnomaliesResults:e,timeRange:t,anomalies:a,changeSortOptions:n,sortOptions:r,changePaginationOptions:o,paginationOptions:s,fetchNextPage:l,fetchPreviousPage:c,page:u,selectedDatasets:m,jobIds:g,autoRefresh:h})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiFlexGroup,null,i.a.createElement(d.EuiFlexItem,null,i.a.createElement(Mi,{jobIds:g,timeRange:t,selectedDatasets:m,autoRefresh:h}))),i.a.createElement(d.EuiSpacer,{size:"l"}),i.a.createElement(i.a.Fragment,null,a&&0!==a.length?i.a.createElement(Qi,{results:a,timeRange:t,changeSortOptions:n,changePaginationOptions:o,sortOptions:r,paginationOptions:s,fetchNextPage:l,fetchPreviousPage:c,page:u,isLoading:e}):i.a.createElement(Kt.a,{isLoading:e,loadingChildren:i.a.createElement(nr,null)},i.a.createElement(d.EuiEmptyPrompt,{title:i.a.createElement("h2",null,f.i18n.translate("xpack.infra.logs.analysis.anomalySectionNoDataTitle",{defaultMessage:"There is no data to display."})),titleSize:"m",body:i.a.createElement("p",null,f.i18n.translate("xpack.infra.logs.analysis.anomalySectionNoDataBody",{defaultMessage:"You may want to adjust your time range."}))})))),ar=f.i18n.translate("xpack.infra.logs.analysis.anomaliesSectionLoadingAriaLabel",{defaultMessage:"Loading anomalies"}),nr=()=>i.a.createElement(d.EuiLoadingSpinner,{size:"xl","aria-label":ar}),ir={selectedDatasets:[],selectedDatasetsFilters:[]};function rr(e,t){switch(t.type){case"changeSelectedDatasets":return{...e,selectedDatasets:t.payload.datasets};case"updateDatasetsFilters":const a=t.payload.filters.filter((t=>!e.selectedDatasets.includes(t.meta.params.query))).map((e=>e.meta.params.query));return{...e,selectedDatasets:[...e.selectedDatasets,...a],selectedDatasetsFilters:t.payload.filters};default:throw new Error("Unknown action")}}const or=(e,t)=>{const a={page:1,paginationCursor:void 0};switch(t.type){case"changePaginationOptions":case"changeSortOptions":case"changeTimeRange":case"changeFilteredDatasets":return{...e,...a,...t.payload};case"changeHasNextPage":case"changeLastReceivedCursors":return{...e,...t.payload};case"fetchNextPage":return e.lastReceivedCursors?{...e,page:e.page+1,paginationCursor:{searchAfter:e.lastReceivedCursors.nextPageCursor}}:e;case"fetchPreviousPage":return e.lastReceivedCursors?{...e,page:e.page-1,paginationCursor:{searchBefore:e.lastReceivedCursors.previousPageCursor}}:e;default:return e}},sr={page:1,lastReceivedCursors:void 0,paginationCursor:void 0,hasNextPage:!1},lr=L.type({interval:L.number,isPaused:L.boolean}),cr=L.union([lr,L[void 0]]),ur=Object(D.b)(cr),dr={isPaused:!1,interval:3e4},mr=L.type({startTime:L.string,endTime:L.string}),gr=L.union([mr,L[void 0]]),fr=Object(D.b)(gr),hr={from:"now-2w",to:"now"},pr=e=>({startTime:jt()(Ct.a.parse(e.start,{momentInstance:jt.a})).valueOf(),endTime:jt()(Ct.a.parse(e.end,{momentInstance:jt.a,roundUp:!0})).valueOf()}),br={direction:"desc",field:"anomalyScore"},yr={pageSize:25},Er=({pageTitle:e})=>{var t;Object(p.useTrackPageview)({app:"infra_logs",path:"log_entry_rate_results"}),Object(p.useTrackPageview)({app:"infra_logs",path:"log_entry_rate_results",delay:15e3});const a=null===(t=Object(h.useKibana)().services.application)||void 0===t?void 0:t.navigateToApp,{logViewId:r,logViewStatus:o}=Object(Mt.c)(),{hasLogAnalysisSetupCapabilities:s}=ct(),{hasOutdatedJobConfigurations:l,hasOutdatedJobDefinitions:c,hasStoppedJobs:u,moduleDescriptor:m,setupStatus:g,jobStatus:f,jobIds:b}=at(),{categoryQualityWarnings:y,hasOutdatedJobConfigurations:E,hasOutdatedJobDefinitions:v,hasStoppedJobs:x,moduleDescriptor:_,setupStatus:M,jobStatus:S,jobIds:T}=ze(),C=Object(n.useMemo)((()=>[...Object(O.p)(f["log-entry-rate"])?[b["log-entry-rate"]]:[],...Object(O.p)(S["log-entry-categories-count"])?[T["log-entry-categories-count"]]:[]]),[b,T,f,S]),{timeRange:j,friendlyTimeRange:w,setTimeRange:k,autoRefresh:I,setAutoRefresh:L}=(()=>{const[e]=Object(sn.a)(hr),{from:t,to:a}=e(),i=Object(n.useMemo)((()=>({startTime:t,endTime:a})),[t,a]),[r,o]=Object(on.b)({defaultState:i,decodeUrlState:fr,encodeUrlState:gr.encode,urlStateKey:"timeRange",writeDefaultState:!0}),[s,l]=Object(n.useState)((()=>({value:pr({start:r.startTime,end:r.endTime}),lastChangedTime:Date.now()}))),c=Object(n.useCallback)((({start:e,end:t})=>{l({value:pr({start:e,end:t}),lastChangedTime:Date.now()})}),[l]),u=Object(n.useCallback)((e=>{o({startTime:e.start,endTime:e.end}),c(e)}),[o,c]),d=Object(n.useCallback)((e=>{const{from:t,to:a}=e;u({start:t,end:a})}),[u]);Object(sn.b)(hr,{from:r.startTime,to:r.endTime},d);const[m,g]=Object(on.b)({defaultState:dr,decodeUrlState:ur,encodeUrlState:cr.encode,urlStateKey:"autoRefresh",writeDefaultState:!0});return kt()((()=>{c({start:r.startTime,end:r.endTime})}),m.isPaused?null:m.interval),{timeRange:s,friendlyTimeRange:r,setTimeRange:u,autoRefresh:m,setAutoRefresh:g}})(),{closeFlyout:P,isFlyoutOpen:R,logEntryId:N}=gi(),A=Object(n.useCallback)(((e,t,n)=>{const i={logPosition:Object(ha.encode)({end:jt()(j.value.endTime).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),position:n,start:jt()(j.value.startTime).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),streamLive:!1}),flyoutOptions:Object(ha.encode)({surroundingLogsId:t}),logFilter:Object(ha.encode)(e)};null==a||a("logs",{path:`/stream?${Object(wn.stringify)(i)}`})}),[j,a]),{selectedDatasets:H,setSelectedDatasets:U}=(()=>{const{services:e}=Object(Se.b)(),[t,a]=Object(n.useReducer)(rr,ir),i=Object(n.useCallback)((e=>{a({type:"changeSelectedDatasets",payload:{datasets:e}})}),[a]);return Object(n.useEffect)((()=>{const t=e.data.query.filterManager.getUpdates$().subscribe((()=>{const t=e.data.query.filterManager.getFilters().filter((e=>e.meta.controlledBy&&e.meta.controlledBy===Ft.CONTROLLED_BY_SWIM_LANE_FILTER));a({type:"updateDatasetsFilters",payload:{filters:t}})}));return()=>t.unsubscribe()}),[e.data.query.filterManager,a]),Object(n.useEffect)((()=>{const a=t.selectedDatasetsFilters.filter((e=>!t.selectedDatasets.includes(e.meta.params.query)));a.length>0&&a.forEach((t=>{e.data.query.filterManager.removeFilter(t)}))}),[t.selectedDatasets,t.selectedDatasetsFilters,e.data.query.filterManager]),{selectedDatasets:t.selectedDatasets,setSelectedDatasets:i,selectedDatasetsFilters:t.selectedDatasetsFilters}})(),{isLoadingLogEntryAnomalies:V,logEntryAnomalies:z,page:J,fetchNextPage:Y,fetchPreviousPage:B,changeSortOptions:$,changePaginationOptions:q,sortOptions:W,paginationOptions:G,datasets:Q,isLoadingDatasets:Z}=(({endTime:e,startTime:t,sourceId:a,defaultSortOptions:i,defaultPaginationOptions:r,onGetLogEntryAnomaliesDatasetsError:o,filteredDatasets:s})=>{const{services:l}=Object(Se.b)(),[c,u]=Object(n.useReducer)(or,sr,(a=>({...a,paginationOptions:r,sortOptions:i,filteredDatasets:s,timeRange:{start:t,end:e}}))),[d,m]=Object(n.useState)([]),[g,f]=Object(Te.c)({cancelPreviousOn:"creation",createPromise:async()=>{const{timeRange:{start:e,end:t},sortOptions:n,paginationOptions:i,paginationCursor:r,filteredDatasets:o}=c;return await(async(e,t)=>{const{sourceId:a,startTime:n,endTime:i,sort:r,pagination:o,datasets:s}=e,l=await t(ca.c,{method:"POST",body:JSON.stringify(ca.n.encode({data:{sourceId:a,timeRange:{startTime:n,endTime:i},sort:r,pagination:o,datasets:s}}))});return Object(D.b)(ca.o)(l)})({sourceId:a,startTime:e,endTime:t,sort:n,pagination:{...i,cursor:r},datasets:o},l.http.fetch)},onResolve:({data:{anomalies:e,paginationCursors:t,hasMoreEntries:a}})=>{const{paginationCursor:n}=c;t&&u({type:"changeLastReceivedCursors",payload:{lastReceivedCursors:t}}),!n||n&&"searchAfter"in n?u({type:"changeHasNextPage",payload:{hasNextPage:a}}):n&&"searchBefore"in n&&u({type:"changeHasNextPage",payload:{hasNextPage:!0}}),m(e)}},[a,u,c.timeRange,c.sortOptions,c.paginationOptions,c.paginationCursor,c.filteredDatasets]),h=Object(n.useCallback)((e=>{u({type:"changeSortOptions",payload:{sortOptions:e}})}),[u]),p=Object(n.useCallback)((e=>{u({type:"changePaginationOptions",payload:{paginationOptions:e}})}),[u]);Object(n.useEffect)((()=>{u({type:"changeTimeRange",payload:{timeRange:{start:t,end:e}}})}),[t,e]),Object(n.useEffect)((()=>{u({type:"changeFilteredDatasets",payload:{filteredDatasets:s}})}),[s]),Object(n.useEffect)((()=>{f()}),[f]);const b=Object(n.useCallback)((()=>{c.lastReceivedCursors&&u({type:"fetchNextPage"})}),[u,c]),y=Object(n.useCallback)((()=>{c.lastReceivedCursors&&u({type:"fetchPreviousPage"})}),[u,c]),E=Object(n.useMemo)((()=>"pending"===g.state),[g.state]),v=Object(n.useMemo)((()=>"rejected"===g.state),[g.state]),[x,_]=Object(n.useState)([]),[M,S]=Object(Te.c)({cancelPreviousOn:"creation",createPromise:async()=>await(async(e,t)=>{const{sourceId:a,startTime:n,endTime:i}=e,r=await t(ca.b,{method:"POST",body:JSON.stringify(ca.l.encode({data:{sourceId:a,timeRange:{startTime:n,endTime:i}}}))});return Object(D.b)(ca.m)(r)})({sourceId:a,startTime:t,endTime:e},l.http.fetch),onResolve:({data:{datasets:e}})=>{_(e)},onReject:e=>{e instanceof Error&&!(e instanceof Te.a)&&o&&o(e)}},[e,a,t]),T=Object(n.useMemo)((()=>"pending"===M.state),[M.state]),C=Object(n.useMemo)((()=>"rejected"===M.state),[M.state]);return F()((()=>{S()})),{logEntryAnomalies:d,getLogEntryAnomalies:f,isLoadingLogEntryAnomalies:E,isLoadingDatasets:T,hasFailedLoadingDatasets:C,datasets:x,hasFailedLoadingLogEntryAnomalies:v,changeSortOptions:h,sortOptions:c.sortOptions,changePaginationOptions:p,paginationOptions:c.paginationOptions,fetchPreviousPage:c.page>1?y:void 0,fetchNextPage:c.hasNextPage?b:void 0,page:c.page}})({sourceId:r,startTime:j.value.startTime,endTime:j.value.endTime,defaultSortOptions:br,defaultPaginationOptions:yr,filteredDatasets:H}),X=Object(n.useCallback)((({isPaused:e,refreshInterval:t})=>{L({isPaused:e,interval:t})}),[L]),{showModuleList:K,showModuleSetup:ee}=bt(),te=Object(n.useCallback)((()=>ee("logs_ui_analysis")),[ee]),ae=Object(n.useCallback)((()=>ee("logs_ui_categories")),[ee]),ne=z.length>0,ie=Object(n.useMemo)((()=>("skipped"===M.type&&!!M.newlyCreated||"succeeded"===M.type||"skipped"===g.type&&!!g.newlyCreated||"succeeded"===g.type)&&!ne),[ne,M,g]),re=Object(n.useCallback)((e=>{e.isInvalid||k(e)}),[k]);return i.a.createElement(St,{hasData:"missing"!==(null==o?void 0:o.index),pageHeader:{pageTitle:e,rightSideItems:[i.a.createElement(kn,{onClick:K,size:"s"})]}},i.a.createElement(d.EuiFlexGroup,{direction:"column"},i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiFlexGroup,{justifyContent:"spaceBetween"},i.a.createElement(d.EuiFlexItem,null,i.a.createElement(Jt,{availableDatasets:Q,isLoading:Z,selectedDatasets:H,onChangeDatasetSelection:U})),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiSuperDatePicker,{start:w.startTime,end:w.endTime,onTimeChange:re,isPaused:I.isPaused,refreshInterval:I.interval,onRefreshChange:X})))),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(Ut,{hasOutdatedJobConfigurations:l,hasOutdatedJobDefinitions:c,hasSetupCapabilities:s,hasStoppedJobs:u,isFirstUse:!1,moduleName:m.moduleName,onRecreateMlJobForReconfiguration:te,onRecreateMlJobForUpdate:te}),i.a.createElement(Ft.MLJobsAwaitingNodeWarning,{jobIds:C}),i.a.createElement(zt,{hasOutdatedJobConfigurations:E,hasOutdatedJobDefinitions:v,hasSetupCapabilities:s,hasStoppedJobs:x,isFirstUse:ie,moduleName:_.moduleName,onRecreateMlJobForReconfiguration:ae,onRecreateMlJobForUpdate:ae,qualityWarnings:y})),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(tr,{isLoadingAnomaliesResults:V,anomalies:z,timeRange:j.value,page:J,fetchNextPage:Y,fetchPreviousPage:B,changeSortOptions:$,changePaginationOptions:q,sortOptions:W,paginationOptions:G,selectedDatasets:H,jobIds:C,autoRefresh:I}))),R?i.a.createElement(oi,{logEntryId:N,onCloseFlyout:P,onSetFieldFilter:A,sourceId:r}):null)},vr=({onOpenSetup:e})=>(Object(p.useTrackPageview)({app:"infra_logs",path:"log_entry_rate_setup"}),Object(p.useTrackPageview)({app:"infra_logs",path:"log_entry_rate_setup",delay:15e3}),i.a.createElement(d.EuiEmptyPrompt,{"data-test-subj":"logEntryRateSetupPage",title:i.a.createElement("h2",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.logEntryRate.setupTitle",defaultMessage:"Set up log anomaly analysis"})),body:i.a.createElement(d.EuiText,{size:"s"},i.a.createElement("p",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.logEntryRate.setupDescription",defaultMessage:"To enable log anomalies, set up a machine learning job"}))),actions:i.a.createElement(d.EuiButton,{fill:!0,onClick:e},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.logEntryRate.showAnalysisSetupButtonLabel",defaultMessage:"ML Setup"}))})),xr=f.i18n.translate("xpack.infra.logs.anomaliesPageTitle",{defaultMessage:"Anomalies"}),_r=Object(n.memo)((()=>{const{hasLogAnalysisCapabilites:e,hasLogAnalysisReadCapabilities:t,hasLogAnalysisSetupCapabilities:a}=ct(),{fetchJobStatus:r,fetchModuleDefinition:o,jobStatus:s,setupStatus:l}=ze(),{fetchJobStatus:c,fetchModuleDefinition:u,jobStatus:d,setupStatus:m}=at(),{showModuleList:g}=bt(),h=Object(n.useCallback)((()=>Promise.all([r(),c()])),[r,c]);return Object(n.useEffect)((()=>{t&&h()}),[h,t]),Object(n.useEffect)((()=>{t&&o()}),[o,t]),Object(n.useEffect)((()=>{t&&u()}),[u,t]),kt()((()=>{"pending"!==l.type&&t&&r(),"pending"!==m.type&&t&&c()}),3e4),e?t?"initializing"===l.type||"initializing"===m.type?i.a.createElement(j.a,{message:f.i18n.translate("xpack.infra.logs.analysisPage.loadingMessage",{defaultMessage:"Checking status of analysis jobs..."})}):"unknown"===l.type||"unknown"===m.type?i.a.createElement(Mr,{isEmptyState:!0},i.a.createElement(w.a,{retry:h})):Object(O.p)(s["log-entry-categories-count"])||Object(O.p)(d["log-entry-rate"])?i.a.createElement(i.a.Fragment,null,i.a.createElement(Er,{pageTitle:xr}),i.a.createElement(Et,null)):a?i.a.createElement(i.a.Fragment,null,i.a.createElement(Mr,{isEmptyState:!0},i.a.createElement(vr,{onOpenSetup:g})),i.a.createElement(Et,null)):i.a.createElement(Mr,{isEmptyState:!0},i.a.createElement(w.c,null),";"):i.a.createElement(Mr,{isEmptyState:!0},i.a.createElement(w.b,null)):i.a.createElement(_t.a,{"data-test-subj":"logsLogEntryRatePage",pageHeader:{pageTitle:xr}})})),Mr=({children:e,...t})=>{const{logViewStatus:a}=Object(Mt.c)();return i.a.createElement(St,g()({hasData:"missing"!==(null==a?void 0:a.index),"data-test-subj":"logsLogEntryRatePage",pageHeader:t.isEmptyState?void 0:{pageTitle:xr}},t),e)},Sr=({children:e})=>{const{hasFailedLoading:t,isLoading:a,isUninitialized:n,latestLoadLogViewFailures:r,load:o,logViewId:s,resolvedLogView:l}=Object(Mt.c)(),{space:c}=Object(Cn.a)();return null==c?null:a||n?i.a.createElement(Tn.a,null):t?i.a.createElement(_n,{errors:r,onRetry:o}):null!=l?i.a.createElement(di.Provider,null,i.a.createElement(tt,{indexPattern:l.indices,sourceId:s,spaceId:c.id,timestampField:l.timestampField,runtimeMappings:l.runtimeMappings},i.a.createElement(Ve,{indexPattern:l.indices,sourceId:s,spaceId:c.id,timestampField:l.timestampField,runtimeMappings:l.runtimeMappings},i.a.createElement(pt,null,e)))):null},Tr=()=>(C([{text:T.a}]),i.a.createElement(d.EuiErrorBoundary,null,i.a.createElement(Sr,null,i.a.createElement(_r,null))));var Cr=a(215),Or=a.n(Cr);const jr=Symbol("unset form value"),wr=({initialValue:e,validate:t})=>{const[a,i]=Object(n.useState)(jr),r=a!==jr?a:e,o=Object(n.useCallback)((t=>i((a=>t(a===jr?e:a)))),[e]),s=Object(n.useCallback)((()=>i(jr)),[]),l=Object(n.useMemo)((()=>!Ie()(r,e)),[r,e]),c=kr(r,t);return Object(n.useMemo)((()=>({initialValue:e,isDirty:l,resetValue:s,updateValue:o,validity:c,value:r})),[e,l,s,o,c,r])},kr=(e,t)=>{const a=Or()((()=>{var a;return null!==(a=null==t?void 0:t(e))&&void 0!==a?a:Promise.resolve([])}),[t,e]);return Object(n.useMemo)((()=>a.loading?{validity:"pending"}:null!=a.error?{validity:"invalid",reasons:[{type:"generic",message:`${a.error}`}]}:a.value&&a.value.length>0?{validity:"invalid",reasons:a.value}:{validity:"valid"}),[a.error,a.loading,a.value])},Ir=e=>t=>e(t.value),Fr=({errors:e})=>i.a.createElement(d.EuiCallOut,{color:"danger",iconType:"alert",title:Dr},i.a.createElement("ul",null,e.map(((e,t)=>i.a.createElement("li",{key:t},i.a.createElement(Lr,{error:e})))))),Lr=({error:e})=>"generic"===e.type?i.a.createElement(i.a.Fragment,null,e.message):"empty_field"===e.type?i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceConfiguration.emptyFieldErrorMessage",defaultMessage:"The field '{fieldName}' must not be empty.",values:{fieldName:e.fieldName}}):"empty_column_list"===e.type?i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceConfiguration.emptyColumnListErrorMessage",defaultMessage:"The column list must not be empty."}):"child"===e.type?i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceConfiguration.childFormElementErrorMessage",defaultMessage:"At least one form field is in an invalid state."}):"missing_timestamp_field"===e.type?i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceConfiguration.missingTimestampFieldErrorMessage",defaultMessage:"The data view must be time-based."}):"missing_message_field"===e.type?i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceConfiguration.missingMessageFieldErrorMessage",defaultMessage:"The data view must contain a {messageField} field.",values:{messageField:i.a.createElement(d.EuiCode,null,"message")}}):"invalid_message_field_type"===e.type?i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceConfiguration.invalidMessageFieldTypeErrorMessage",defaultMessage:"The {messageField} field must be a text field.",values:{messageField:i.a.createElement(d.EuiCode,null,"message")}}):"rollup_index_pattern"===e.type?i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceConfiguration.rollupIndexPatternErrorMessage",defaultMessage:"The data view must not be a rollup index pattern."}):"missing_index_pattern"===e.type?i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceConfiguration.missingDataViewErrorMessage",defaultMessage:"The data view {dataViewId} must exist.",values:{dataViewId:i.a.createElement(d.EuiCode,null,e.indexPatternId)}}):null,Dr=f.i18n.translate("xpack.infra.logSourceConfiguration.logSourceConfigurationFormErrorsCalloutTitle",{defaultMessage:"Inconsistent source configuration"}),Pr=e=>({error:"invalid"===e.validity.validity?e.validity.reasons.map((e=>i.a.createElement(Lr,{error:e}))):[],isInvalid:"invalid"===e.validity.validity}),Rr=(e,t)=>a=>({isInvalid:"invalid"===a.validity.validity,onChange:t=>{const n=t.currentTarget.value;a.updateValue((()=>e(n)))},value:t(a.value)}),Nr=Rr((e=>`${e}`),(e=>e)),Ar=({isLoading:e,isReadOnly:t,indexNamesFormElement:a})=>(Object(p.useTrackPageview)({app:"infra_logs",path:"log_source_configuration_index_name"}),Object(p.useTrackPageview)({app:"infra_logs",path:"log_source_configuration_index_name",delay:15e3}),i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiDescribedFormGroup,{title:i.a.createElement("h4",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.logIndicesTitle",defaultMessage:"Log indices"})),description:i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.logIndicesDescription",defaultMessage:"Index pattern for matching indices that contain log data"})},i.a.createElement(d.EuiFormRow,g()({fullWidth:!0,helpText:i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.logIndicesRecommendedValue",defaultMessage:"The recommended value is {defaultValue}",values:{defaultValue:i.a.createElement(d.EuiCode,null,"logs-*,filebeat-*")}}),label:i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.logIndicesLabel",defaultMessage:"Log indices"})},Pr(a)),i.a.createElement(d.EuiFieldText,g()({"data-test-subj":"logIndicesInput",fullWidth:!0,disabled:e,isLoading:e,readOnly:t},Hr(a))))))),Hr=Rr((e=>({type:"index_name",indexName:e})),(({indexName:e})=>e)),Ur=()=>{const{services:{data:{indexPatterns:e}}}=Object(Se.b)();return e},Vr=({indexPatternId:e,isLoading:t,isReadOnly:a,onChangeIndexPatternId:r})=>{const{indexPatternTitles:o,latestIndexPatternTitlesRequest:s,fetchIndexPatternTitles:l}=(()=>{const e=Ur(),[t,a]=Object(n.useState)([]),[i,r]=Object(Te.c)({createPromise:()=>e.getIdsWithTitle(!0),onResolve:a},[e]);return{fetchIndexPatternTitles:r,indexPatternTitles:t,latestIndexPatternTitlesRequest:i}})();Object(n.useEffect)((()=>{l()}),[l]);const c=Object(n.useMemo)((()=>[...o.map((({id:e,title:t})=>({key:e,label:t,value:e}))),...null==e||o.some((({id:t})=>t===e))?[]:[{key:e,label:f.i18n.translate("xpack.infra.logSourceConfiguration.missingDataViewsLabel",{defaultMessage:"Missing data view {indexPatternId}",values:{indexPatternId:e}}),value:e}]]),[o,e]),u=Object(n.useMemo)((()=>c.filter((({key:t})=>t===e))),[c,e]),m=Object(n.useCallback)((([e])=>"string"==typeof(null==e?void 0:e.key)?r(e.key):r(void 0)),[r]);return i.a.createElement(d.EuiComboBox,{isLoading:t||"pending"===s.state,isDisabled:a,options:c,placeholder:zr,selectedOptions:u,singleSelection:{asPlainText:!0},onChange:m})},zr=f.i18n.translate("xpack.infra.logSourceConfiguration.dataViewSelectorPlaceholder",{defaultMessage:"Choose a data view"}),Jr=({isLoading:e,isReadOnly:t,indexPatternFormElement:a})=>{var r;Object(p.useTrackPageview)({app:"infra_logs",path:"log_source_configuration_index_pattern"}),Object(p.useTrackPageview)({app:"infra_logs",path:"log_source_configuration_index_pattern",delay:15e3});const o=Object(n.useCallback)((e=>{null!=e?a.updateValue((()=>({type:"data_view",dataViewId:e}))):a.updateValue((()=>{}))}),[a]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(Yr,null),i.a.createElement(d.EuiSpacer,{size:"m"}),i.a.createElement(d.EuiDescribedFormGroup,{title:i.a.createElement("h4",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceConfiguration.dataViewTitle",defaultMessage:"Log data view"})),description:i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceConfiguration.dataViewDescription",defaultMessage:"Data view that contains log data"})},i.a.createElement(d.EuiFormRow,g()({fullWidth:!0,label:i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceConfiguration.dataViewLabel",defaultMessage:"Log data view"})},Object(n.useMemo)((()=>e?{}:Pr(a)),[e,a])),i.a.createElement(Vr,{isLoading:e||"pending"===a.validity.validity,isReadOnly:t,indexPatternId:null===(r=a.value)||void 0===r?void 0:r.dataViewId,onChangeIndexPatternId:o}))))},Yr=i.a.memo((()=>{const e=Object(p.useLinkProps)({app:"management",pathname:"/kibana/dataViews"});return i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceConfiguration.logDataViewHelpText",defaultMessage:"Data views are shared among apps in the Kibana space and can be managed via the {dataViewsManagementLink}. A single data view can target multiple indices.",values:{dataViewsManagementLink:i.a.createElement(d.EuiLink,e,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceConfiguration.dataViewsManagementLinkText",defaultMessage:"data views management screen"}))}})})),Br=i.a.memo((({isLoading:e,isReadOnly:t,indicesFormElement:a})=>{const r=Object(p.useUiTracker)({app:"infra_logs"}),o=Object(n.useCallback)((()=>{xn.f.is(a.initialValue)?a.updateValue((()=>a.initialValue)):a.updateValue((()=>{})),r({metric:"configuration_switch_to_index_pattern_reference"})}),[a,r]),s=Object(n.useCallback)((()=>{var e;"index_name"===(null===(e=a.initialValue)||void 0===e?void 0:e.type)?a.updateValue((()=>a.initialValue)):a.updateValue((()=>({type:"index_name",indexName:""}))),r({metric:"configuration_switch_to_index_names_reference"})}),[a,r]);return i.a.createElement(d.EuiFormFieldset,{legend:{children:i.a.createElement(d.EuiTitle,{size:"s"},i.a.createElement("h3",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceConfiguration.logSourcesTitle",defaultMessage:"Log sources"})))}},i.a.createElement(d.EuiCheckableCard,{id:"dataView",label:i.a.createElement(d.EuiTitle,{size:"xs"},i.a.createElement("h2",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceConfiguration.dataViewSectionTitle",defaultMessage:"Data view (recommended)"}))),name:"dataView",value:"dataView",checked:$r(a),onChange:o,disabled:t},$r(a)&&i.a.createElement(Jr,{isLoading:e,isReadOnly:t,indexPatternFormElement:a})),i.a.createElement(d.EuiSpacer,{size:"m"}),i.a.createElement(d.EuiCheckableCard,{id:"indexNames",label:i.a.createElement(d.EuiTitle,{size:"xs"},i.a.createElement("h2",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.indicesSectionTitle",defaultMessage:"Indices"}))),name:"indexNames",value:"indexNames",checked:qr(a),onChange:s,disabled:t},qr(a)&&i.a.createElement(Ar,{isLoading:e,isReadOnly:t,indexNamesFormElement:a})))})),$r=Ir((e=>null==e||xn.f.is(e))),qr=Ir(xn.g.is);var Wr=a(110);const Gr=({addLogColumn:e,availableFields:t,isDisabled:a})=>{const{isVisible:r,show:o,hide:s}=Object($n.a)(!1),l=Object(n.useMemo)((()=>[{optionProps:{append:i.a.createElement(Xr,null),"data-test-subj":"addTimestampLogColumn",key:"timestamp",label:"Timestamp"},columnConfiguration:{timestampColumn:{id:Object(Wr.v4)()}}},{optionProps:{"data-test-subj":"addMessageLogColumn",append:i.a.createElement(Xr,null),key:"message",label:"Message"},columnConfiguration:{messageColumn:{id:Object(Wr.v4)()}}},...t.map((e=>({optionProps:{"data-test-subj":`addFieldLogColumn addFieldLogColumn:${e}`,key:`field-${e}`,label:e},columnConfiguration:{fieldColumn:{id:Object(Wr.v4)(),field:e}}})))]),[t]),c=Object(n.useMemo)((()=>l.map((e=>e.optionProps))),[l]),u=Object(n.useCallback)((t=>{s();const a=t.findIndex((e=>"on"===e.checked)),n=l[a];e(n.columnConfiguration)}),[e,l,s]);return i.a.createElement(d.EuiPopover,{anchorPosition:"downRight",button:i.a.createElement(d.EuiButton,{"data-test-subj":"addLogColumnButton",isDisabled:a,iconType:"plusInCircle",onClick:o},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.addLogColumnButtonLabel",defaultMessage:"Add column"})),closePopover:s,id:"addLogColumn",isOpen:r,ownFocus:!0,panelPaddingSize:"none"},i.a.createElement(d.EuiSelectable,{height:600,listProps:Zr,onChange:u,options:c,searchable:!0,searchProps:Qr,singleSelection:!0},((e,t)=>i.a.createElement(Kr,{"data-test-subj":"addLogColumnPopover"},i.a.createElement(d.EuiPopoverTitle,null,t),e))))},Qr={"data-test-subj":"fieldSearchInput"},Zr={showIcons:!1},Xr=()=>i.a.createElement(d.EuiBadge,null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.systemColumnBadgeLabel",defaultMessage:"System"})),Kr=It.euiStyled.div`
  width: 400px;
`,eo=i.a.memo((({availableFields:e,isLoading:t,logColumnsFormElement:a})=>{const r=Object(n.useCallback)((e=>a.updateValue((t=>[...t,e]))),[a]),o=Object(n.useCallback)((e=>a.updateValue((t=>t.filter((t=>t!==e))))),[a]),s=Object(n.useCallback)(((e,t)=>{a.updateValue((n=>{if(t>=0&&e<=a.value.length-1){const n=[...a.value];return n.splice(t,0,n.splice(e,1)[0]),n}return n}))}),[a]),l=Object(n.useCallback)((({source:e,destination:t})=>t&&s(e.index,t.index)),[s]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiFlexGroup,null,i.a.createElement(d.EuiFlexItem,null,i.a.createElement(d.EuiTitle,{size:"s","data-test-subj":"sourceConfigurationLogColumnsSectionTitle"},i.a.createElement("h3",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.logColumnsSectionTitle",defaultMessage:"Log columns"})))),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(Gr,{addLogColumn:r,availableFields:e,isDisabled:t}))),a.value.length>0?i.a.createElement(d.EuiDragDropContext,{onDragEnd:l},i.a.createElement(d.EuiDroppable,{droppableId:"COLUMN_CONFIG_DROPPABLE_AREA"},a.value.map(((e,t)=>{const a=(e=>ji(e)?e.timestampColumn.id:Oi(e)?e.messageColumn.id:e.fieldColumn.id)(e);return i.a.createElement(d.EuiDraggable,{key:`logColumnConfigurationPanel-${a}`,index:t,draggableId:a,customDragHandle:!0},(t=>i.a.createElement(to,{dragHandleProps:t.dragHandleProps,logColumnConfiguration:e,onRemove:o})))})))):i.a.createElement(so,null),"invalid"===a.validity.validity?a.validity.reasons.map((e=>i.a.createElement(d.EuiText,{key:e.type,textAlign:"center",color:"danger"},i.a.createElement(Lr,{error:e})))):null)})),to=({logColumnConfiguration:e,dragHandleProps:t,onRemove:a})=>{const r=Object(n.useCallback)((()=>a(e)),[e,a]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiSpacer,{size:"m"}),ji(e)?i.a.createElement(ao,{dragHandleProps:t,logColumnConfiguration:e,onRemove:r}):Oi(e)?i.a.createElement(no,{dragHandleProps:t,logColumnConfiguration:e,onRemove:r}):i.a.createElement(io,{dragHandleProps:t,logColumnConfiguration:e,onRemove:r}))},ao=({dragHandleProps:e,onRemove:t})=>i.a.createElement(ro,{fieldName:"Timestamp",helpText:i.a.createElement(k.FormattedMessage,{tagName:"span",id:"xpack.infra.sourceConfiguration.timestampLogColumnDescription",defaultMessage:"This system field shows the log entry's time as determined by the {timestampSetting} field setting.",values:{timestampSetting:i.a.createElement("code",null,"timestamp")}}),onRemove:t,dragHandleProps:e}),no=({dragHandleProps:e,onRemove:t})=>i.a.createElement(ro,{fieldName:"Message",helpText:i.a.createElement(k.FormattedMessage,{tagName:"span",id:"xpack.infra.sourceConfiguration.messageLogColumnDescription",defaultMessage:"This system field shows the log entry message as derived from the document fields."}),onRemove:t,dragHandleProps:e}),io=({dragHandleProps:e,logColumnConfiguration:{fieldColumn:{field:t}},onRemove:a})=>i.a.createElement(d.EuiPanel,{color:"subdued","data-test-subj":`logColumnPanel fieldLogColumnPanel fieldLogColumnPanel:${t}`,hasShadow:!1},i.a.createElement(d.EuiFlexGroup,{alignItems:"center"},i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement("div",g()({"data-test-subj":"moveLogColumnHandle"},e),i.a.createElement(d.EuiIcon,{type:"grab"}))),i.a.createElement(d.EuiFlexItem,{grow:1},lo),i.a.createElement(d.EuiFlexItem,{grow:3},i.a.createElement("code",null,t)),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(oo,{onClick:a,columnDescription:`${lo} - ${t}`})))),ro=({fieldName:e,helpText:t,onRemove:a,dragHandleProps:n})=>i.a.createElement(d.EuiPanel,{color:"subdued","data-test-subj":`logColumnPanel systemLogColumnPanel systemLogColumnPanel:${e}`,hasShadow:!1},i.a.createElement(d.EuiFlexGroup,{alignItems:"center"},i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement("div",g()({"data-test-subj":"moveLogColumnHandle"},n),i.a.createElement(d.EuiIcon,{type:"grab"}))),i.a.createElement(d.EuiFlexItem,{grow:1},e),i.a.createElement(d.EuiFlexItem,{grow:3},i.a.createElement(d.EuiText,{size:"s",color:"subdued"},t)),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(oo,{onClick:a,columnDescription:String(e)})))),oo=({onClick:e,columnDescription:t})=>{const a=f.i18n.translate("xpack.infra.sourceConfiguration.removeLogColumnButtonLabel",{defaultMessage:"Remove {columnDescription} column",values:{columnDescription:t}});return i.a.createElement(d.EuiButtonIcon,{color:"danger","data-test-subj":"removeLogColumnButton",iconType:"trash",onClick:e,title:a,"aria-label":a})},so=()=>i.a.createElement(d.EuiEmptyPrompt,{iconType:"list",title:i.a.createElement("h2",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.noLogColumnsTitle",defaultMessage:"No columns"})),body:i.a.createElement("p",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.noLogColumnsDescription",defaultMessage:"Add a column to this list using the button above."}))}),lo=f.i18n.translate("xpack.infra.sourceConfiguration.fieldLogColumnTitle",{defaultMessage:"Field"}),co=i.a.memo((({isLoading:e,isReadOnly:t,nameFormElement:a})=>i.a.createElement(d.EuiForm,null,i.a.createElement(d.EuiTitle,{size:"s","data-test-subj":"sourceConfigurationNameSectionTitle"},i.a.createElement("h3",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.nameSectionTitle",defaultMessage:"Name"}))),i.a.createElement(d.EuiSpacer,{size:"m"}),i.a.createElement(d.EuiDescribedFormGroup,{title:i.a.createElement("h4",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.nameLabel",defaultMessage:"Name"})),description:i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.nameDescription",defaultMessage:"A descriptive name for the source configuration"})},i.a.createElement(d.EuiFormRow,g()({fullWidth:!0,label:i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.nameLabel",defaultMessage:"Name"})},Object(n.useMemo)((()=>Pr(a)),[a])),i.a.createElement(d.EuiFieldText,g()({"data-test-subj":"nameInput",fullWidth:!0,disabled:e,readOnly:t,isLoading:e,name:"name"},Object(n.useMemo)((()=>Nr(a)),[a]))))))));var uo=a(54);const mo=(e,t)=>""===t?[{type:"empty_field",fieldName:e}]:[],go=e=>[...fo(e),...ho(e),...po(e)],fo=e=>e.isTimeBased()?[]:[{type:"missing_timestamp_field",indexPatternTitle:e.title}],ho=e=>{const t=e.getFieldByName("message");return null==t?[{type:"missing_message_field",indexPatternTitle:e.title}]:t.type!==uo.KBN_FIELD_TYPES.STRING?[{type:"invalid_message_field_type",indexPatternTitle:e.title}]:[]},po=e=>null!=e.type?[{type:"rollup_index_pattern",indexPatternTitle:e.title}]:[],bo=()=>{var e,t;const a=null===(e=Object(h.useKibana)().services.application)||void 0===e?void 0:e.capabilities,r=!0===(null==a||null===(t=a.logs)||void 0===t?void 0:t.configureSource);Object(p.useTrackPageview)({app:"infra_logs",path:"log_source_configuration"}),Object(p.useTrackPageview)({app:"infra_logs",path:"log_source_configuration",delay:15e3}),C([{text:T.h}]);const{logView:o,hasFailedLoadingLogView:s,isLoading:l,isUninitialized:c,update:u,resolvedLogView:m}=Object(Mt.c)(),g=Object(n.useMemo)((()=>{var e;return null!==(e=null==m?void 0:m.fields.map((e=>e.name)))&&void 0!==e?e:[]}),[m]),{sourceConfigurationFormElement:f,formState:b,logIndicesFormElement:y,logColumnsFormElement:E,nameFormElement:v}=(e=>{var t;const a=(i=null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"",wr({initialValue:i,validate:Object(n.useMemo)((()=>async e=>mo("name",e)),[])}));var i;const r=(e=>{const t=Ur(),a=Object(p.useUiTracker)({app:"infra_logs"});return wr({initialValue:e,validate:Object(n.useMemo)((()=>async e=>{if(null==e)return mo("log data view","");if(xn.g.is(e))return mo("log indices",e.indexName);{const n=mo("log data view",e.dataViewId);if(n.length>0)return n;const i=await t.get(e.dataViewId).then(go,(t=>{if(t instanceof vn.SavedObjectNotFound)return[{type:"missing_index_pattern",indexPatternId:e.dataViewId}];throw t}));return i.length>0?a({metric:"configuration_index_pattern_validation_failed"}):a({metric:"configuration_index_pattern_validation_succeeded"}),i}}),[t,a])})})(Object(n.useMemo)((()=>{var t;return null!==(t=null==e?void 0:e.logIndices)&&void 0!==t?t:{type:"index_name",indexName:""}}),[e])),o=(e=>wr({initialValue:e,validate:Object(n.useMemo)((()=>async e=>e.length<=0?[{type:"empty_column_list"}]:[]),[])}))(Object(n.useMemo)((()=>{var t;return null!==(t=null==e?void 0:e.logColumns)&&void 0!==t?t:[]}),[e])),s=(({childFormElements:e,validate:t})=>{const a=Object(n.useMemo)((()=>Object.entries(e)),Object.entries(e).flat()),i=Object(n.useMemo)((()=>a.reduce(((e,[t,a])=>({...e,[t]:a.value})),{})),[a]),r=Object(n.useCallback)((e=>{const t=e(i);a.forEach((([e,a])=>a.updateValue((()=>t[e]))))}),[a,i]),o=Object(n.useMemo)((()=>a.some((([,e])=>e.isDirty))),[a]),s=kr(i,t),l=Object(n.useMemo)((()=>a.some((([,e])=>"invalid"===e.validity.validity))?{validity:"invalid",reasons:[{type:"child"}]}:a.some((([,e])=>"pending"===e.validity.validity))?{validity:"pending"}:{validity:"valid"}),[a]),c=Object(n.useMemo)((()=>{return t=l,"invalid"===(e=s).validity||"invalid"===t.validity?{validity:"invalid",reasons:[..."invalid"===e.validity?e.reasons:[],..."invalid"===t.validity?t.reasons:[]]}:"pending"===e.validity||"pending"===t.validity?{validity:"pending"}:{validity:"valid"};var e,t}),[s,l]),u=Object(n.useCallback)((()=>{a.forEach((([,e])=>e.resetValue()))}),[a]),d=Object(n.useMemo)((()=>a.reduce(((e,[t,a])=>({...e,[t]:a.initialValue})),{})),[a]);return Object(n.useMemo)((()=>({childFormElements:e,initialValue:d,isDirty:o,resetValue:u,updateValue:r,validity:c,value:i})),[e,d,o,u,r,c,i])})(Object(n.useMemo)((()=>({childFormElements:{name:a,logIndices:r,logColumns:o},validate:async()=>[]})),[a,r,o]));return{formState:s.value,logIndicesFormElement:r,logColumnsFormElement:o,nameFormElement:a,sourceConfigurationFormElement:s}})(null==o?void 0:o.attributes),x=Object(n.useCallback)((async()=>{await u(b),f.resetValue()}),[u,f,b]),_=Object(n.useMemo)((()=>r&&o&&"internal"!==o.origin),[r,o]);return!l&&!c||m?s?null:i.a.createElement(d.EuiErrorBoundary,null,i.a.createElement(St,{pageHeader:{pageTitle:T.h},"data-test-subj":"sourceConfigurationContent",restrictWidth:!0},i.a.createElement(p.Prompt,{prompt:f.isDirty?yo:void 0}),i.a.createElement(d.EuiPanel,{paddingSize:"l",hasShadow:!1,hasBorder:!0},i.a.createElement(co,{isLoading:l,isReadOnly:!_,nameFormElement:v})),i.a.createElement(d.EuiSpacer,null),i.a.createElement(d.EuiPanel,{paddingSize:"l",hasShadow:!1,hasBorder:!0},i.a.createElement(Br,{isLoading:l,isReadOnly:!_,indicesFormElement:y})),i.a.createElement(d.EuiSpacer,null),i.a.createElement(d.EuiPanel,{paddingSize:"l",hasShadow:!1,hasBorder:!0},i.a.createElement(eo,{availableFields:g,isLoading:l,logColumnsFormElement:E})),i.a.createElement(d.EuiSpacer,null),"invalid"===f.validity.validity?i.a.createElement(i.a.Fragment,null,i.a.createElement(Fr,{errors:f.validity.reasons}),i.a.createElement(d.EuiSpacer,null)):null,i.a.createElement(d.EuiFlexGroup,null,_&&i.a.createElement(d.EuiFlexItem,null,l?i.a.createElement(d.EuiFlexGroup,{justifyContent:"flexEnd"},i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiButton,{color:"primary",isLoading:!0,fill:!0},"Loading"))):i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiFlexGroup,{justifyContent:"flexEnd"},i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiButton,{"data-test-subj":"discardSettingsButton",color:"danger",iconType:"cross",isDisabled:l||!f.isDirty,onClick:()=>{f.resetValue()}},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.discardSettingsButtonLabel",defaultMessage:"Discard"}))),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiButton,{"data-test-subj":"applySettingsButton",color:"primary",isDisabled:!f.isDirty||"valid"!==f.validity.validity,fill:!0,onClick:x},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.applySettingsButtonLabel",defaultMessage:"Apply"}))))))))):i.a.createElement(Tn.a,null)},yo=f.i18n.translate("xpack.infra.logSourceConfiguration.unsavedFormPromptMessage",{defaultMessage:"Are you sure you want to leave? Changes will be lost"});var Eo=a(28),vo=a(112),xo=a(6),_o=a.n(xo),Mo=a(144),So=a(261);const To=({buckets:e,start:t,end:a,width:i,height:r})=>{if(t>=a||r<=0||i<=0||e.length<=0)return null;const o=Object(Mo.scaleTime)().domain([t,a]).range([0,r]),s=Object(Je.max)(e.map((e=>e.entriesCount)))||0,l=Object(Mo.scaleLinear)().domain([0,s]).range([0,i]),c=Object(So.area)().x0(l(0)).x1((e=>l(e.entriesCount))).y0((e=>o(e.start))).y1((e=>o(e.end))).curve(So.curveMonotoneY),u=e[0],d=e[e.length-1],m=c([{start:t,end:t,entriesCount:u.entriesCount},...e,{start:d.end,end:d.end,entriesCount:d.entriesCount},{start:a,end:a,entriesCount:0}]);return n.createElement("g",null,n.createElement(Co,{width:i,height:r}),n.createElement(Oo,{d:m||""}))},Co=It.euiStyled.rect`
  fill: ${e=>e.theme.darkMode?e.theme.eui.euiColorLightShade:e.theme.eui.euiColorLightestShade};
`,Oo=It.euiStyled.path`
  fill: ${e=>e.theme.darkMode?e.theme.eui.euiColorMediumShade:e.theme.eui.euiColorLightShade};
`,jo=({className:e,end:t,getPositionOfTime:a,start:i,targetWidth:r,width:o,target:s})=>{const l=a(i),c=a(t),u=s&&a(s);return n.createElement(n.Fragment,null,u&&n.createElement(wo,{className:e,x1:0,x2:r,y1:u,y2:u}),n.createElement(ko,{className:e,points:` ${r},${l} ${o},${l} ${o},${c}  ${r},${c}`}))};jo.displayName="HighlightedInterval";const wo=It.euiStyled.line`
  stroke: ${e=>e.theme.eui.euiColorPrimary};
  stroke-width: 1;
`,ko=It.euiStyled.polygon`
  fill: ${e=>e.theme.eui.euiColorPrimary};
  fill-opacity: 0.3;
  stroke: ${e=>e.theme.eui.euiColorPrimary};
  stroke-width: 1;
`;var Io=a(65),Fo=a.n(Io);class search_marker_tooltip_SearchMarkerTooltip extends n.PureComponent{render(){const{children:e,markerPosition:t}=this.props;return n.createElement(d.EuiPortal,null,n.createElement("div",null,n.createElement(vo.a,{content:!1,bounds:!0},(({measureRef:a,bounds:{width:i,height:r}})=>{const{top:o,left:s}=i&&r?Object(d.calculatePopoverPosition)(t,{width:i,height:r},"left",16,["left"]):{left:-9999,top:0};return n.createElement("div",{className:"euiToolTip euiToolTip--left euiToolTipPopover",style:{left:s,top:o},ref:a},n.createElement("div",{className:"euiToolTip__arrow",style:{left:i||0,top:(r||0)/2-6}}),n.createElement("div",null,e))}))))}}class search_marker_SearchMarker extends n.PureComponent{constructor(...e){super(...e),_o()(this,"state",{hoveredPosition:null}),_o()(this,"handleClick",(e=>{e.stopPropagation(),this.props.jumpToTarget(this.props.bucket.representativeKey)})),_o()(this,"handleMouseEnter",(e=>{this.setState({hoveredPosition:e.currentTarget.getBoundingClientRect()})})),_o()(this,"handleMouseLeave",(()=>{this.setState({hoveredPosition:null})}))}render(){const{bucket:e,height:t,width:a}=this.props,{hoveredPosition:i}=this.state,r=e.entriesCount>1?n.createElement(Ro,{x:"-2",y:"-2",width:"4",height:t+2,rx:"2",ry:"2"}):n.createElement(n.Fragment,null,n.createElement(Ro,{x:"-1",y:"0",width:"2",height:t}),n.createElement(Ro,{x:"-2",y:t/2-2,width:"4",height:"4",rx:"2",ry:"2"}));return n.createElement(n.Fragment,null,i?n.createElement(search_marker_tooltip_SearchMarkerTooltip,{markerPosition:i},n.createElement(k.FormattedMessage,{id:"xpack.infra.logs.searchResultTooltip",defaultMessage:"{bucketCount, plural, one {# highlighted entry} other {# highlighted entries}}",values:{bucketCount:e.entriesCount}})):null,n.createElement(Do,{onClick:this.handleClick,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},n.createElement(Po,{x:"0",y:"0",width:a,height:t}),r))}}const Lo=It.keyframes`
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
`,Do=It.euiStyled.g`
  animation: ${Lo} ${e=>e.theme.eui.euiAnimSpeedExtraSlow} ease-in both;
`,Po=It.euiStyled.rect`
  fill: ${e=>e.theme.eui.euiColorAccent};
  opacity: 0;
  transition: opacity ${e=>e.theme.eui.euiAnimSpeedNormal} ease-in;
  cursor: pointer;

  ${Do}:hover & {
    opacity: 0.3;
  }
`,Ro=It.euiStyled.rect`
  fill: ${e=>e.theme.eui.euiColorAccent};
`;class search_markers_SearchMarkers extends n.PureComponent{render(){const{buckets:e,start:t,end:a,width:i,height:r,jumpToTarget:o,className:s}=this.props,l=Fo()("minimapSearchMarkers",s);if(t>=a||r<=0||Object.keys(e).length<=0)return null;const c=Object(Mo.scaleTime)().domain([t,a]).range([0,r]);return n.createElement("g",{transform:`translate(${i/2}, 0)`,className:l},e.map((e=>n.createElement("g",{key:`${e.representativeKey.time}:${e.representativeKey.tiebreaker}`,transform:`translate(0, ${c(e.start)})`},n.createElement(search_marker_SearchMarker,{bucket:e,height:c(e.end)-c(e.start),width:i,jumpToTarget:o})))))}}const No=({end:e,height:t,start:a,tickCount:i,width:r})=>{const o=Object(Mo.scaleTime)().domain([a,e]).range([0,t]),s=o.ticks(i),l=o.tickFormat(i,function(e,t){const a=Math.abs(t-e);return a<15e3?":%S.%L":a<96e4?"%I:%M:%S":void 0}(a,e));return n.createElement("g",null,s.map(((e,t)=>{const a=o(e);return n.createElement("g",{key:`tick${t}`},n.createElement(Ao,{x:0,y:a-4},l(e)),n.createElement(Ho,{x1:0,y1:a,x2:r,y2:a}))})))};No.displayName="TimeRuler";const Ao=It.euiStyled.text`
  font-size: 9px;
  line-height: ${e=>e.theme.eui.euiLineHeight};
  fill: ${e=>e.theme.eui.euiTextSubduedColor};
  user-select: none;
  pointer-events: none;
`,Ho=It.euiStyled.line`
  stroke: ${e=>e.theme.darkMode?e.theme.eui.euiColorDarkestShade:e.theme.eui.euiColorDarkShade};
  stroke-opacity: 0.5;
  stroke-width: 1px;
`,Uo=50;function Vo(e,t,a){return Object(Mo.scaleLinear)().domain([e||0,t||0]).range([0,a])}class log_minimap_LogMinimap extends n.Component{constructor(e){super(e),_o()(this,"handleClick",(e=>{const t=e.currentTarget.getBoundingClientRect().top,a=e.clientY-t,n=Math.floor(this.getYScale().invert(a));this.props.jumpToTarget({tiebreaker:0,time:n})})),_o()(this,"getYScale",(()=>{const{start:e,end:t,height:a}=this.props;return Vo(e,t,a)})),_o()(this,"getPositionOfTime",(e=>this.getYScale()(e))),_o()(this,"updateTimeCursor",(e=>{const t=e.currentTarget.getBoundingClientRect(),a=e.clientY-t.top;this.setState({timeCursorY:a})})),this.state={timeCursorY:0,target:e.target}}render(){const{start:e,end:t,className:a,height:i,highlightedInterval:r,jumpToTarget:o,summaryBuckets:s,summaryHighlightBuckets:l,width:c}=this.props,{timeCursorY:u,target:d}=this.state,[m,g]=Vo(e,t,i).domain(),f=i?Math.floor(i/50):12;return n.createElement(Yo,{className:a,height:i,preserveAspectRatio:"none",viewBox:`0 0 ${c} ${i}`,width:c,onClick:this.handleClick,onMouseMove:this.updateTimeCursor},n.createElement(zo,{x1:Uo,x2:Uo,y1:0,y2:i}),n.createElement(No,{start:m,end:g,width:Uo,height:i,tickCount:f}),n.createElement("g",{transform:"translate(50, 0)"},n.createElement(To,{buckets:s,start:m,end:g,width:c-Uo,height:i}),n.createElement(search_markers_SearchMarkers,{buckets:l||[],start:m,end:g,width:c-Uo,height:i,jumpToTarget:o})),r?n.createElement(jo,{end:r.end,getPositionOfTime:this.getPositionOfTime,start:r.start,targetWidth:Uo,width:c,target:d}):null,n.createElement(Jo,{x1:Uo,x2:c,y1:u,y2:u}))}}const zo=It.euiStyled.line`
  stroke: ${e=>e.theme.eui.euiColorMediumShade};
  stroke-width: 1px;
`,Jo=It.euiStyled.line`
  pointer-events: none;
  stroke-width: 1px;
  stroke: ${e=>e.theme.darkMode?e.theme.eui.euiColorDarkestShade:e.theme.eui.euiColorDarkShade};
`,Yo=It.euiStyled.svg`
  cursor: pointer;
  fill: ${e=>e.theme.eui.euiColorEmptyShade};
  & ${Jo} {
    visibility: hidden;
  }
  &:hover ${Jo} {
    visibility: visible;
  }
`;var Bo=a(145),$o=a(92),qo=a(172),Wo=a.n(qo);function Go(e,t){return Object(n.useMemo)((()=>e&&t?(t-e)/100:null),[e,t])}var Qo=a(154);var Zo=a(88);const Xo=Me()((({sourceId:e,sourceVersion:t,centerCursor:a,size:i,filterQuery:r})=>{const[o,s]=Object(n.useState)([]),{visibleMidpoint:l,jumpToTargetPosition:c,startTimestamp:u,endTimestamp:d}=Object(n.useContext)(Zo.a.Context),m=Wo()(u,3e3),g=Wo()(d,3e3),{logEntryHighlights:f,logEntryHighlightsById:h,loadLogEntryHighlightsRequest:p}=((e,t,a,i,r,o,s,l)=>{const{services:c}=Object(Se.b)(),[u,d]=Object(n.useState)([]),[m,g]=Object(Te.c)({cancelPreviousOn:"resolution",createPromise:async()=>{if(!(a&&i&&r&&l.length))throw new Error("Skipping request: Insufficient parameters");return await(async(e,t)=>{const a=await t(ie.e,{method:"POST",body:JSON.stringify(ie.n.encode(e))});return Object(D.b)(ie.o)(a)})({sourceId:e,startTimestamp:a,endTimestamp:i,center:r,size:o,query:s||void 0,highlightTerms:l},c.http.fetch)},onResolve:e=>{d(e.data)}},[e,a,i,r,o,s,l]);Object(n.useEffect)((()=>{d([])}),[l]),Object(n.useEffect)((()=>{l.filter((e=>e.length>0)).length&&a&&i?g():d([])}),[i,s,l,g,t,a]);const f=Object(n.useMemo)((()=>u.reduce(((e,t)=>t.entries.reduce(((e,t)=>{const a=e[t.id]||[];return{...e,[t.id]:[...a,t]}}),e)),{})),[u]);return{logEntryHighlights:u,logEntryHighlightsById:f,loadLogEntryHighlightsRequest:m}})(e,t,m,g,a,i,r,o),{logSummaryHighlights:b,loadLogSummaryHighlightsRequest:y}=((e,t,a,i,r,o)=>{const{services:s}=Object(Se.b)(),[l,c]=Object(n.useState)([]),u=Go(a,i),[d,m]=Object(Te.c)({cancelPreviousOn:"resolution",createPromise:async()=>{if(!(a&&i&&u&&o.length))throw new Error("Skipping request: Insufficient parameters");return await(async(e,t)=>{const a=await t(ie.f,{method:"POST",body:JSON.stringify(ie.p.encode(e))});return Object(D.b)(ie.q)(a)})({sourceId:e,startTimestamp:a,endTimestamp:i,bucketSize:u,query:r,highlightTerms:o},s.http.fetch)},onResolve:e=>{c(e.data)}},[e,a,i,u,r,o]),g=Object(n.useMemo)((()=>Object(Je.debounce)(m,275)),[m]);return Object(n.useEffect)((()=>{c([])}),[o]),Object(n.useEffect)((()=>{o.filter((e=>e.length>0)).length&&a&&i?g():c([])}),[u,g,r,o,t,a,i]),{logSummaryHighlights:l,loadLogSummaryHighlightsRequest:d}})(e,t,m,g,r,o),{currentHighlightKey:E,hasPreviousHighlight:v,hasNextHighlight:x,goToPreviousHighlight:_,goToNextHighlight:M}=(({highlightTerms:e,jumpToTargetPosition:t,logEntryHighlights:a,visibleMidpoint:i})=>{const[r,o]=Object(n.useState)(null),s=Object(n.useMemo)((()=>a&&a.length>0?a[0].entries:[]),[a]);Object(n.useEffect)((()=>{o(null)}),[e]),Object(n.useEffect)((()=>{r&&t(r)}),[r,t]),Object(n.useEffect)((()=>{if(null===r&&s.length>0){const n=i?(e=Object(Qo.b)(s,i),t=0,a=s.length-1,Math.min(Math.max(e,t),a)):0,r=Object(Qo.c)(s[n]);o(r)}var e,t,a}),[r,s,o,i]);const l=Object(n.useMemo)((()=>r&&s.length>0?Object(Qo.a)(s,r):null),[r,s]),c=Object(n.useMemo)((()=>Object(Je.isNumber)(l)&&l>0),[l]),u=Object(n.useMemo)((()=>s.length>0&&Object(Je.isNumber)(l)&&l<s.length-1),[l,s]),d=Object(n.useCallback)((()=>{if(s.length&&Object(Je.isNumber)(l)){const e=l-1,t=Object(Qo.c)(s[e]);o(t)}}),[l,s]),m=Object(n.useCallback)((()=>{if(s.length>0&&Object(Je.isNumber)(l)){const e=l+1,t=Object(Qo.c)(s[e]);o(t)}}),[l,s]);return{currentHighlightKey:r,hasPreviousHighlight:c,hasNextHighlight:u,goToPreviousHighlight:d,goToNextHighlight:m}})({visibleMidpoint:l,logEntryHighlights:f,highlightTerms:o,jumpToTargetPosition:c});return{highlightTerms:o,setHighlightTerms:s,logEntryHighlights:f,logEntryHighlightsById:h,logSummaryHighlights:b,loadLogEntryHighlightsRequest:p,loadLogSummaryHighlightsRequest:y,currentHighlightKey:E,hasPreviousHighlight:v,hasNextHighlight:x,goToPreviousHighlight:_,goToNextHighlight:M}}));var Ko=a(186);const es=({children:e})=>{var t;const{logViewId:a}=Object(Mt.c)(),{filterQuery:i}=Object(n.useContext)($o.a.Context),{startTimestamp:r,endTimestamp:o}=Object(n.useContext)(Zo.a.Context),s=Wo()(r,3e3),l=Wo()(o,3e3),{buckets:c,start:u,end:d}=((e,t,a,i)=>{const{services:r}=Object(Se.b)(),[o,s]=Object(n.useState)([]),l=Go(t,a);var c,u;return c=n=>{null!==t&&null!==a&&null!==l&&(async(e,t)=>{const a=await t(ie.g,{method:"POST",body:JSON.stringify(ie.r.encode(e))});return Object(D.b)(ie.s)(a)})({sourceId:e,startTimestamp:t,endTimestamp:a,bucketSize:l,query:i},r.http.fetch).then((e=>{n()||s(e.data.buckets)}))},u=[e,i,t,a,l],Object(n.useEffect)((()=>{const e=(()=>{const e={isCancelled:!1,cancel:()=>{e.isCancelled=!0}};return e})();return c((()=>e.isCancelled)),e.cancel}),u),{buckets:o,start:t,end:a}})(a,s,l,null!==(t=null==i?void 0:i.serializedQuery)&&void 0!==t?t:null);return e({buckets:c,start:u,end:d})},ts=Me()((()=>{const[e,t]=Object(n.useState)("medium"),[a,i]=Object(n.useState)(!0);return{availableTextScales:as,setTextScale:t,setTextWrap:i,textScale:e,textWrap:a}})),as=["large","medium","small"],ns=()=>{const{textScale:e,textWrap:t,setTextScale:a,setTextWrap:r}=Object(n.useContext)(ts.Context),o=Object(n.useMemo)((()=>({textScale:e,wrap:t})),[e,t]);return i.a.createElement(ci.a,{urlState:o,urlStateKey:"logTextview",mapToUrlState:is,onChange:e=>{e&&e.textScale&&a(e.textScale),e&&void 0!==e.wrap&&r(e.wrap)},onInitialize:e=>{e&&e.textScale&&a(e.textScale),e&&void 0!==e.wrap&&r(e.wrap)}})},is=e=>e?{textScale:rs(e.textScale),wrap:os(e.wrap)}:void 0,rs=e=>as.includes(e)?e:void 0,os=e=>"boolean"==typeof e?e:void 0;var ss=a(27),ls=a(59);class log_customization_menu_LogCustomizationMenu extends n.Component{constructor(...e){super(...e),_o()(this,"state",{isShown:!1}),_o()(this,"show",(()=>{this.setState({isShown:!0})})),_o()(this,"hide",(()=>{this.setState({isShown:!1})})),_o()(this,"toggleVisibility",(()=>{this.setState((e=>({isShown:!e.isShown})))}))}render(){const{children:e}=this.props,{isShown:t}=this.state,a=n.createElement(d.EuiButtonEmpty,{color:"text",iconType:"eye",onClick:this.toggleVisibility,size:"xs"},n.createElement(k.FormattedMessage,{id:"xpack.infra.logs.customizeLogs.customizeButtonLabel",defaultMessage:"Customize"}));return n.createElement(d.EuiPopover,{id:"customizePopover",button:a,closePopover:this.hide,isOpen:t,anchorPosition:"downRight",ownFocus:!0},n.createElement(cs,null,e))}}const cs=It.euiStyled.div`
  min-width: 200px;
`,us=({startDateExpression:e,endDateExpression:t,isStreaming:a,onUpdateDateRange:r,onStartStreaming:o,onStopStreaming:s})=>{const l=Object(n.useCallback)((({start:e,end:t,isInvalid:a})=>{r&&!a&&r({startDateExpression:e,endDateExpression:t})}),[r]);return i.a.createElement(d.EuiFlexGroup,{gutterSize:"s"},i.a.createElement(d.EuiFlexItem,null,i.a.createElement(d.EuiSuperDatePicker,{start:e,end:t,onTimeChange:l,showUpdateButton:!1,isDisabled:a})),i.a.createElement(d.EuiFlexItem,{grow:!1},a?i.a.createElement(d.EuiButton,{color:"primary",iconType:"pause",iconSide:"left",onClick:s},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.stopStreamingButtonLabel",defaultMessage:"Stop streaming"})):i.a.createElement(d.EuiButton,{color:"primary",iconType:"play",iconSide:"left",onClick:o},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.startStreamingButtonLabel",defaultMessage:"Stream live"}))))},ds=({onChange:e,isLoading:t,activeHighlights:a,hasPreviousHighlight:r,goToPreviousHighlight:o,hasNextHighlight:s,goToNextHighlight:l})=>{const{isVisible:c,hide:u,toggle:m}=Object($n.a)(!1),[g,f]=Object(n.useState)(""),h=Object(n.useMemo)((()=>Object(Je.debounce)(e,275)),[e]),p=Object(n.useCallback)((e=>f((t=>{const a="function"==typeof e?e(t):e;return a!==t&&h([a]),a}))),[h]),b=Object(n.useCallback)((e=>{const t=e.target.value;p(t)}),[p]),y=Object(n.useCallback)((()=>p("")),[p]),E=i.a.createElement(d.EuiButtonEmpty,{color:"text",size:"xs",iconType:"brush",onClick:m},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.highlights.highlightsPopoverButtonLabel",defaultMessage:"Highlights"}),a?i.a.createElement(ps,null):null);return i.a.createElement(d.EuiPopover,{id:"popover",button:E,isOpen:c,closePopover:u,ownFocus:!0},i.a.createElement(bs,null,i.a.createElement(d.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},i.a.createElement(d.EuiFlexItem,null,i.a.createElement(d.EuiFieldText,{placeholder:ms,fullWidth:!0,value:g,onChange:b,isLoading:t,"aria-label":ms})),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiButtonIcon,{"aria-label":fs,iconType:"arrowUp",onClick:o,title:fs,isDisabled:!r})),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiButtonIcon,{"aria-label":hs,iconType:"arrowDown",onClick:l,title:hs,isDisabled:!s})),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiButtonIcon,{"aria-label":gs,color:"danger",isDisabled:""===g,iconType:"trash",onClick:y,title:gs})))))},ms=f.i18n.translate("xpack.infra.logs.highlights.highlightTermsFieldLabel",{defaultMessage:"Terms to highlight"}),gs=f.i18n.translate("xpack.infra.logs.highlights.clearHighlightTermsButtonLabel",{defaultMessage:"Clear terms to highlight"}),fs=f.i18n.translate("xpack.infra.logs.highlights.goToPreviousHighlightButtonLabel",{defaultMessage:"Jump to previous highlight"}),hs=f.i18n.translate("xpack.infra.logs.highlights.goToNextHighlightButtonLabel",{defaultMessage:"Jump to next highlight"}),ps=Object(It.euiStyled)(d.EuiIcon).attrs((({theme:e})=>({type:"checkInCircleFilled",size:"m",color:null==e?void 0:e.eui.euiColorAccent})))`
  padding-left: ${e=>e.theme.eui.paddingSizes.xs};
`,bs=It.euiStyled.div`
  width: 300px;
`;class log_text_scale_controls_LogTextScaleControls extends n.PureComponent{constructor(...e){super(...e),_o()(this,"setTextScale",(e=>{["small","medium","large"].includes(e)&&this.props.setTextScale(e)}))}render(){const{availableTextScales:e,textScale:t}=this.props;return n.createElement(d.EuiFormRow,{label:n.createElement(k.FormattedMessage,{id:"xpack.infra.logs.customizeLogs.textSizeFormRowLabel",defaultMessage:"Text Size"})},n.createElement(d.EuiRadioGroup,{options:e.map((e=>({id:e.toString(),label:n.createElement(k.FormattedMessage,{id:"xpack.infra.logs.customizeLogs.textSizeRadioGroup",defaultMessage:"{textScale, select, small {Small} medium {Medium} large {Large} other {{textScale}} }",values:{textScale:e}})}))),idSelected:t,onChange:this.setTextScale}))}}class log_text_wrap_controls_LogTextWrapControls extends n.PureComponent{constructor(...e){super(...e),_o()(this,"toggleWrap",(()=>{this.props.setTextWrap(!this.props.wrap)}))}render(){const{wrap:e}=this.props;return n.createElement(d.EuiFormRow,{label:n.createElement(k.FormattedMessage,{id:"xpack.infra.logs.customizeLogs.lineWrappingFormRowLabel",defaultMessage:"Line Wrapping"})},n.createElement(d.EuiSwitch,{label:n.createElement(k.FormattedMessage,{id:"xpack.infra.logs.customizeLogs.wrapLongLinesSwitchLabel",defaultMessage:"Wrap long lines"}),checked:e,onChange:this.toggleWrap}))}}const ys=()=>{const{derivedDataView:e}=Object(Mt.c)(),{availableTextScales:t,setTextScale:a,setTextWrap:r,textScale:o,textWrap:s}=Object(n.useContext)(ts.Context),{filterQueryDraft:l,isFilterQueryDraftValid:c,applyLogFilterQuery:u,setLogFilterQueryDraft:m}=Object(n.useContext)($o.a.Context),{setSurroundingLogsId:g}=Object(n.useContext)(di.Context),{setHighlightTerms:h,loadLogEntryHighlightsRequest:p,highlightTerms:b,hasPreviousHighlight:y,hasNextHighlight:E,goToPreviousHighlight:v,goToNextHighlight:x}=Object(n.useContext)(Xo.Context),{isStreaming:_,startLiveStreaming:M,stopLiveStreaming:S,startDateExpression:T,endDateExpression:C,updateDateRange:O}=Object(n.useContext)(Zo.a.Context);return i.a.createElement("div",null,i.a.createElement(d.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween",gutterSize:"l",wrap:!0},i.a.createElement(Es,null,i.a.createElement(ls.QueryStringInput,{disableLanguageSwitcher:!0,iconType:"search",indexPatterns:[e],isInvalid:!c,onChange:e=>{g(null),m(e)},onSubmit:e=>{g(null),u(e)},placeholder:f.i18n.translate("xpack.infra.logsPage.toolbar.kqlSearchFieldPlaceholder",{defaultMessage:"Search for log entries… (e.g. host.name:host-1)"}),query:l})),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiFlexGroup,null,i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(log_customization_menu_LogCustomizationMenu,null,i.a.createElement(log_text_wrap_controls_LogTextWrapControls,{wrap:s,setTextWrap:r}),i.a.createElement(log_text_scale_controls_LogTextScaleControls,{availableTextScales:t,textScale:o,setTextScale:a}))),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(ds,{onChange:h,isLoading:"pending"===p.state,activeHighlights:b.filter((e=>e.length>0)).length>0,goToPreviousHighlight:v,goToNextHighlight:x,hasPreviousHighlight:y,hasNextHighlight:E})))),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(us,{startDateExpression:T,endDateExpression:C,onStartStreaming:M,onStopStreaming:S,isStreaming:_,onUpdateDateRange:O}))))},Es=Object(It.euiStyled)(d.EuiFlexItem)`
  @media (min-width: 1200px) {
    flex: 0 0 100% !important;
    margin-left: 0 !important;
    margin-right: 0 !important;
    padding-left: 12px;
    padding-right: 12px;
  }
`,vs=()=>{const{resolvedLogView:e,logView:t,logViewId:a}=Object(Mt.c)(),{textScale:r,textWrap:o}=Object(n.useContext)(ts.Context),{surroundingLogsId:s,setSurroundingLogsId:l,closeFlyout:c,openFlyout:u,isFlyoutOpen:m,logEntryId:g}=gi(),{startTimestamp:f,endTimestamp:h,isStreaming:p,targetPosition:b,visibleMidpointTime:y,visibleTimeInterval:E,reportVisiblePositions:v,jumpToTargetPosition:x,startLiveStreaming:_,stopLiveStreaming:M,startDateExpression:S,endDateExpression:T,updateDateRange:C,lastCompleteDateRangeExpressionUpdate:O}=Object(n.useContext)(Zo.a.Context),{filterQuery:j,applyLogFilterQuery:w}=Object(n.useContext)($o.a.Context),{isReloading:k,entries:I,topCursor:F,bottomCursor:L,hasMoreAfter:D,hasMoreBefore:P,isLoadingMore:R,lastLoadedTime:N,fetchEntries:A,fetchPreviousEntries:H,fetchNextEntries:U,fetchNewestEntries:V}=Object(Ko.c)(),z=Be()(f),J=Be()(h),Y=Be()(j),B=Be()(O);Object(n.useEffect)((()=>{const e=!z||!J,t=O!==B,a=null!=b&&(null!=F&&b.time<F.time||null!=L&&b.time>L.time);(e||t||a||j!==Y)&&(p?V():A())}),[A,V,p,z,J,f,h,b,F,L,j,Y,O,B]);const{logSummaryHighlights:$,currentHighlightKey:q,logEntryHighlightsById:W}=Object(n.useContext)(Xo.Context),G=Object(n.useMemo)((()=>k?[]:I.map((e=>_s(e,W[e.id]||[])))),[I,k,W]),[,{setContextEntry:Q}]=Object(n.useContext)($t.Context),Z=Object(n.useCallback)((e=>{C(e),"startDateExpression"in e&&Object(ss.c)(e.startDateExpression)&&H({force:!0,extendTo:Object(ss.a)(e.startDateExpression)}),"endDateExpression"in e&&Object(ss.c)(e.endDateExpression)&&U({force:!0,extendTo:Object(ss.a)(e.endDateExpression)})}),[C,H,U]),X=Object(n.useCallback)((e=>{v(e),e.fromScroll&&(R||(e.pagesBeforeStart<2?H():e.pagesAfterEnd<2&&U()))}),[v,R,H,U]),K=Object(n.useCallback)(((e,t,a)=>{w(e),a&&x(a),l(t),M()}),[w,x,l,M]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(ns,null),i.a.createElement(fi,null),i.a.createElement(ys,null),i.a.createElement(d.EuiSpacer,{size:"m"}),i.a.createElement(Qt,null),m?i.a.createElement(oi,{logEntryId:g,onCloseFlyout:c,onSetFieldFilter:K,sourceId:a}):null,i.a.createElement(Bo.b,{key:`${a}-${null==t?void 0:t.version}`},i.a.createElement(pa.g,{columnConfigurations:e&&e.columns||[],hasMoreAfterEnd:D,hasMoreBeforeStart:P,isLoadingMore:R,isReloading:k,isStreaming:p,items:G,jumpToTarget:x,lastLoadedTime:N,reloadItems:A,reportVisibleInterval:X,scale:r,target:b,wrap:o,onOpenLogEntryFlyout:u,setContextEntry:Q,highlightedItem:s||null,currentHighlightKey:q,startDateExpression:S,endDateExpression:T,updateDateRange:Z,startLiveStreaming:_}),i.a.createElement(vo.a,{content:!0,bounds:!0,detectAnyWindowResize:"height"},(({measureRef:e,bounds:{height:t=0},content:{width:a=0}})=>i.a.createElement(xs,{ref:e},i.a.createElement(es,null,(({buckets:e,start:n,end:r})=>i.a.createElement(log_minimap_LogMinimap,{start:n,end:r,height:t,width:a,highlightedInterval:k?null:E,jumpToTarget:x,summaryBuckets:e,summaryHighlightBuckets:$.length>0?$[0].buckets:[],target:y}))))))))},xs=It.euiStyled.div`
  flex: 1 0 0%;
  overflow: hidden;
  min-width: 100px;
  max-width: 100px;
  display: flex;
  flex-direction: column;
`,_s=(e,t)=>({kind:"logEntry",logEntry:e,highlights:t}),Ms=f.i18n.translate("xpack.infra.logs.streamPageTitle",{defaultMessage:"Stream"}),Ss=()=>{const{hasFailedLoading:e,isLoading:t,isUninitialized:a,latestLoadLogViewFailures:n,load:r,logViewStatus:o}=Object(Mt.c)();return t||a?i.a.createElement(Tn.a,null):e?i.a.createElement(_n,{errors:n,onRetry:r}):i.a.createElement(Ts,{className:Eo.APP_WRAPPER_CLASS},i.a.createElement(St,{hasData:"missing"!==(null==o?void 0:o.index),pageHeader:{pageTitle:Ms}},i.a.createElement(vs,null)))},Ts=It.euiStyled.div`
  .euiPage .euiPageContentBody {
    display: flex;
    flex-direction: column;
    flex: 1 0 auto;
    width: 100%;
    height: 100%;
  }
`,Cs=()=>i.a.createElement(i.a.Fragment,null,i.a.createElement(y.a,{title:e=>f.i18n.translate("xpack.infra.logs.streamPage.documentTitle",{defaultMessage:"{previousTitle} | Stream",values:{previousTitle:e}})})),Os=({children:e})=>{const{derivedDataView:t}=Object(Mt.c)();return i.a.createElement($o.a.Provider,{indexPattern:t},i.a.createElement($o.b,null),e)},js=({children:e})=>{const{startTimestamp:t,endTimestamp:a}=Object(n.useContext)(Zo.a.Context),{logViewId:r}=Object(Mt.c)();return t&&a?i.a.createElement($t.Provider,{startTimestamp:t,endTimestamp:a,sourceId:r},e):null},ws=({children:e})=>{const{logViewId:t}=Object(Mt.c)(),{startTimestamp:a,endTimestamp:r,targetPosition:o,isInitialized:s}=Object(n.useContext)(Zo.a.Context),{filterQuery:l}=Object(n.useContext)($o.a.Context);return a&&r&&s?i.a.createElement(Ko.a,{sourceId:t,startTimestamp:a,endTimestamp:r,query:null==l?void 0:l.parsedQuery,center:null!=o?o:void 0},e):null},ks=({children:e})=>{var t;const{logViewId:a,logView:r}=Object(Mt.c)(),{topCursor:o,bottomCursor:s,entries:l}=Object(Ko.c)(),{filterQuery:c}=Object(n.useContext)($o.a.Context),u={sourceId:a,sourceVersion:null==r?void 0:r.version,entriesStart:o,entriesEnd:s,centerCursor:l.length>0?l[Math.floor(l.length/2)].cursor:null,size:l.length,filterQuery:null!==(t=null==c?void 0:c.serializedQuery)&&void 0!==t?t:null};return i.a.createElement(Xo.Provider,u,e)},Is=({children:e})=>{const{logViewStatus:t}=Object(Mt.c)();return"missing"===(null==t?void 0:t.index)?i.a.createElement(i.a.Fragment,null,e):i.a.createElement(ts.Provider,null,i.a.createElement(di.Provider,null,i.a.createElement(Zo.a.Provider,null,i.a.createElement(Zo.b,null),i.a.createElement(js,null,i.a.createElement(Os,null,i.a.createElement(ws,null,i.a.createElement(ks,null,e)))))))},Fs=()=>(Object(p.useTrackPageview)({app:"infra_logs",path:"stream"}),Object(p.useTrackPageview)({app:"infra_logs",path:"stream",delay:15e3}),C([{text:T.i}]),i.a.createElement(d.EuiErrorBoundary,null,i.a.createElement(Is,null,i.a.createElement(Cs,null),i.a.createElement(Ss,null)))),Ls=()=>{var e,t,a,r;const o=null===(e=Object(h.useKibana)().services.application)||void 0===e?void 0:e.capabilities,{setHeaderActionMenu:l,theme$:c}=Object(n.useContext)(x.a),u=Object(h.useKibana)();Object(v.a)(!(null!=o&&null!==(t=o.logs)&&void 0!==t&&t.save));const m="/stream",f="/anomalies",M=Object(p.useLinkProps)({app:"logs",pathname:"settings"});return i.a.createElement(i.a.Fragment,null,i.a.createElement(y.a,{title:Ds}),i.a.createElement(E.a,{feedbackLink:Rs,appName:Ds}),l&&c&&i.a.createElement(p.HeaderMenuPortal,{setHeaderActionMenu:l,theme$:c},i.a.createElement(d.EuiHeaderLinks,{gutterSize:"xs"},i.a.createElement(d.EuiHeaderLink,g()({color:"text"},M),Ps),i.a.createElement(b.a,null),i.a.createElement(d.EuiHeaderLink,{href:null===(a=u.services)||void 0===a||null===(r=a.application)||void 0===r?void 0:r.getUrlForApp("/integrations/browse"),color:"primary",iconType:"indexOpen"},Ns))),i.a.createElement(s.Switch,null,i.a.createElement(s.Route,{path:m,component:Fs}),i.a.createElement(s.Route,{path:f,component:Tr}),i.a.createElement(s.Route,{path:"/log-categories",component:jn}),i.a.createElement(s.Route,{path:"/settings",component:bo}),i.a.createElement(_.a,{from:"/analysis",to:f,exact:!0}),i.a.createElement(_.a,{from:"/log-rate",to:f,exact:!0}),i.a.createElement(_.a,{from:"/",to:m,exact:!0})))},Ds=f.i18n.translate("xpack.infra.header.logsTitle",{defaultMessage:"Logs"}),Ps=(f.i18n.translate("xpack.infra.logs.index.streamTabTitle",{defaultMessage:"Stream"}),f.i18n.translate("xpack.infra.logs.index.anomaliesTabTitle",{defaultMessage:"Anomalies"}),f.i18n.translate("xpack.infra.logs.index.logCategoriesBetaBadgeTitle",{defaultMessage:"Categories"}),f.i18n.translate("xpack.infra.logs.index.settingsTabTitle",{defaultMessage:"Settings"})),Rs="https://discuss.elastic.co/c/logs",Ns=f.i18n.translate("xpack.infra.logsHeaderAddDataButtonLabel",{defaultMessage:"Add data"});var As=a(98);const Hs=({children:e})=>{const[t]=Object(As.b)(),{services:a}=Object(Se.b)();return i.a.createElement(Mt.a,{fetch:a.http.fetch,logViewId:t,logViews:a.logViews.client},i.a.createElement(lt,null,e))},Us=()=>i.a.createElement(d.EuiErrorBoundary,null,i.a.createElement(Hs,null,i.a.createElement(Ls,null)));var Vs=a(35),zs=a(173);const Js=(e,t,a,{element:n,history:r,setHeaderActionMenu:s,theme$:c})=>{const u=new l.Storage(window.localStorage);return Object(zs.b)(n,"infraLogsPage"),o.a.render(i.a.createElement(Ys,{core:e,storage:u,history:r,plugins:t,pluginStart:a,setHeaderActionMenu:s,theme$:c}),n),()=>{o.a.unmountComponentAtNode(n)}},Ys=({core:e,history:t,pluginStart:a,plugins:n,setHeaderActionMenu:r,storage:o,theme$:l})=>{var d;const m=e.application.capabilities;return i.a.createElement(Vs.b,{core:e,pluginStart:a,plugins:n,theme$:l},i.a.createElement(Vs.a,{appName:"Logs UI",setHeaderActionMenu:r,storage:o,theme$:l,triggersActionsUI:n.triggersActionsUi},i.a.createElement(s.Router,{history:t},i.a.createElement(s.Switch,null,i.a.createElement(s.Route,{path:"/link-to",component:u.a}),(null==m||null===(d=m.logs)||void 0===d?void 0:d.show)&&i.a.createElement(s.Route,{path:"/",component:Us}),i.a.createElement(s.Route,{component:c.a})))))}},90:function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return l}));var n=a(12),i=a(2),r=a.n(i),o=a(127);const s=({message:e,"data-test-subj":t="loadingPage"})=>r.a.createElement(o.a,{isEmptyState:!0,"data-test-subj":t},r.a.createElement(l,{message:e})),l=({message:e})=>r.a.createElement(n.EuiEmptyPrompt,{body:r.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiLoadingSpinner,{size:"xl",style:{marginRight:"8px"}})),r.a.createElement(n.EuiFlexItem,null,e))})},92:function(e,t,a){"use strict";a.d(t,"a",(function(){return m})),a.d(t,"b",(function(){return h})),a.d(t,"c",(function(){return b}));var n=a(106),i=a(67),r=a.n(i),o=a(2),s=a.n(o),l=a(121),c=a.n(l),u=a(159);const d={filterQuery:null,filterQueryDraft:{language:"kuery",query:""},validationErrors:[]},m=r()((({indexPattern:e})=>{const[t,a]=Object(o.useState)(d),i=Object(u.a)(),r=Object(o.useCallback)((t=>Object(n.b)(e,t,[],i)),[e,i]),s=Object(o.useCallback)((e=>{a((t=>({...t,filterQueryDraft:e,validationErrors:[]})))}),[]),[,l]=c()((()=>{a((e=>{try{return r(t.filterQueryDraft),{...e,validationErrors:[]}}catch(t){return{...e,validationErrors:[`${t}`]}}}))}),1e3,[t.filterQueryDraft,r]),m=Object(o.useCallback)((e=>{l();try{const t=r(e);a((a=>({...a,filterQuery:{parsedQuery:t,serializedQuery:JSON.stringify(t),originalQuery:e},filterQueryDraft:e,validationErrors:[]})))}catch(e){a((t=>({...t,validationErrors:[`${e}`]})))}}),[l,r]);return{filterQuery:t.filterQuery,filterQueryDraft:t.filterQueryDraft,isFilterQueryDraftValid:0===t.validationErrors.length,setLogFilterQueryDraft:s,applyLogFilterQuery:m}}));var g=a(0),f=a(89);const h=()=>{const{filterQuery:e,applyLogFilterQuery:t}=Object(o.useContext)(m.Context);return s.a.createElement(f.a,{urlState:null==e?void 0:e.originalQuery,urlStateKey:"logFilter",mapToUrlState:p,onChange:e=>{e&&t(e)},onInitialize:e=>{e&&t(e)}})},p=e=>E.is(e)?{language:e.kind,query:e.expression}:y.is(e)?e:void 0,b=e=>Object(f.d)("logFilter",e),y=g.type({language:g.string,query:g.string}),E=g.type({kind:g.literal("kuery"),expression:g.string})},98:function(e,t,a){"use strict";a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return u}));var n=a(0),i=a(24),r=a(18),o=a(19),s=a(81);const l="sourceId",c=()=>Object(s.b)({defaultState:"default",decodeUrlState:g,encodeUrlState:m,urlStateKey:l}),u=e=>Object(s.a)(l,e),d=n.union([n.string,n[void 0]]),m=d.encode,g=e=>Object(i.pipe)(d.decode(e),Object(r.fold)(Object(o.constant)(void 0),o.identity))},99:function(e,t,a){"use strict";a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){return r})),a.d(t,"d",(function(){return o})),a.d(t,"b",(function(){return s}));var n=a(89);const i=e=>{const t=Object(n.b)(Object(n.c)(e),"time");return t?parseFloat(t):NaN},r=e=>Object(n.b)(Object(n.c)(e),"filter")||"",o=e=>{const t=Object(n.b)(Object(n.c)(e),"to");return t?parseFloat(t):NaN},s=e=>{const t=Object(n.b)(Object(n.c)(e),"from");return t?parseFloat(t):NaN}}}]);