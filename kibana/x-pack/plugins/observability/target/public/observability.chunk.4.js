/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.observability_bundle_jsonpfunction=window.observability_bundle_jsonpfunction||[]).push([[4],{104:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(0),l=a(46),s=a(14);function i(){const[e,t]=Object(n.useState)(null),a=Object(l.a)().services.application.capabilities;return Object(n.useEffect)((()=>{var e,n;const l="boolean"==typeof(null===(e=a[s.casesFeatureId])||void 0===e?void 0:e.crud_cases)&&a[s.casesFeatureId].crud_cases,i="boolean"==typeof(null===(n=a[s.casesFeatureId])||void 0===n?void 0:n.read_cases)&&a[s.casesFeatureId].read_cases;t({crud:l,read:i})}),[a]),e}},106:function(e,t,a){"use strict";a.d(t,"b",(function(){return v})),a.d(t,"a",(function(){return p}));var n=a(7),l=a(0),s=a.n(l),i=a(97),r=a(110),o=a(55);function u({time:e,timeUnit:t="milliseconds"}){const a=Object(o.a)(e,t);return s.a.createElement(n.EuiToolTip,{content:a},s.a.createElement(s.a.Fragment,null,a))}var c=a(49),d=a(113),b=a(103),m=a(96);const p=({data:e,fieldName:t})=>{const a=e.find((e=>e.field===t));if(null!=a&&null!=a.value)return a.value},v=({setFlyoutAlert:e})=>({columnId:t,data:a})=>{var l;if(!a)return null;const{observabilityRuleTypeRegistry:o}=Object(m.a)(),v=null===(l=p({data:a,fieldName:t}))||void 0===l?void 0:l.reduce((e=>e[0]));switch(t){case i.K:return v!==i.L&&v!==i.M?null:s.a.createElement(r.a,{alertStatus:v});case i.X:return s.a.createElement(u,{time:new Date(null!=v?v:"").getTime(),timeUnit:"milliseconds"});case i.b:return Object(c.a)(Number(v));case i.I:return s.a.createElement(d.a,{severityLevel:null!=v?v:void 0});case i.g:const t=a.reduce(((e,t)=>({...e,[t.field]:t.value})),{}),l=Object(b.a)(o)(t);return s.a.createElement(n.EuiLink,{href:"",onClick:()=>e&&e(l)},l.reason);default:return s.a.createElement(s.a.Fragment,null,v)}}},112:function(e,t,a){"use strict";a.d(t,"b",(function(){return w})),a.d(t,"a",(function(){return M}));var n=a(18),l=a.n(n),s=a(97),i=a(7),r=a(22),o=a.n(r),u=a(0),c=a.n(u),d=a(2),b=a(10),m=a(86);const p=(e,t)=>t&&e[t]?{crud:"apm"===t?e[t]["alerting:save"]:e[t].save,read:"apm"===t?e[t]["alerting:show"]:e[t].show,loading:!1,featureId:t}:{crud:!1,read:!1,loading:!1,featureId:t};var v=a(106),y=a(14),g=a(104),f=a(96),T=a(36),h=a(103),C=a(100),E=a(116),j=a(1);const x=j.i18n.translate("xpack.observability.alerts.actions.addToCase",{defaultMessage:"Add to existing case"}),O=j.i18n.translate("xpack.observability.alerts.actions.addToNewCase",{defaultMessage:"Add to new case"}),k=j.i18n.translate("xpack.observability.alerts.actions.addToCaseDisabled",{defaultMessage:"Add to case is not supported for this selection"}),A=o.a.div.attrs((({className:e=""})=>({className:`siemEventsTable__thContent ${e}`}))).withConfig({displayName:"EventsThContent",componentId:"sc-9d5m0f-0"})(["font-size:",";font-weight:",";line-height:",";min-width:0;padding:",";text-align:",";width:",";> button.euiButtonIcon,> .euiToolTipAnchor > button.euiButtonIcon{margin-left:",";}"],(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.euiFontWeightBold),(({theme:e})=>e.eui.euiLineHeight),(({theme:e})=>e.eui.paddingSizes.xs),(({textAlign:e})=>e),(({width:e})=>null!=e?`${e}px`:"100%"),(({theme:e})=>`-${e.eui.paddingSizes.xs}`)),w=[{columnHeaderType:"not-filtered",displayAsText:C.c.alertsTable.statusColumnDescription,id:s.K,initialWidth:110},{columnHeaderType:"not-filtered",displayAsText:C.c.alertsTable.lastUpdatedColumnDescription,id:s.X,initialWidth:230},{columnHeaderType:"not-filtered",displayAsText:C.c.alertsTable.durationColumnDescription,id:s.b,initialWidth:116},{columnHeaderType:"not-filtered",displayAsText:C.c.alertsTable.reasonColumnDescription,id:s.g,linkField:"*"}],I=[],F=[];function R({data:e,eventId:t,ecsData:a,setFlyoutAlert:n}){var l,s;const{observabilityRuleTypeRegistry:r}=Object(f.a)(),o=e.reduce(((e,t)=>({...e,[t.field]:t.value})),{}),[d,p]=Object(u.useState)(null),{cases:v,http:T}=Object(b.useKibana)().services,E=Object(u.useMemo)((()=>Object(h.a)(r)),[r])(o),j=Object(u.useCallback)((()=>{p(null)}),[]),k=Object(u.useCallback)((e=>{p((t=>t?null:e))}),[]),A=Object(g.a)(),w=null!==(l=E.fields["kibana.alert.rule.uuid"])&&void 0!==l?l:null,I=w?T.basePath.prepend(C.b.observability.ruleDetails(w)):null,F=Object(u.useMemo)((()=>{var t,n;return null!=a&&a._id?[{alertId:null!==(t=null==a?void 0:a._id)&&void 0!==t?t:"",index:null!==(n=null==a?void 0:a._index)&&void 0!==n?n:"",owner:y.observabilityFeatureId,type:m.CommentType.alert,rule:v.helpers.getRuleIdFromEvent({ecs:a,data:null!=e?e:[]})}]:[]}),[a,v.helpers,e]),R=v.hooks.getUseCasesAddToNewCaseFlyout(),D=v.hooks.getUseCasesAddToExistingCaseModal(),M=Object(u.useCallback)((()=>{R.open({attachments:F}),j()}),[R,F,j]),S=Object(u.useCallback)((()=>{D.open({attachments:F}),j()}),[F,j,D]),P=Object(u.useMemo)((()=>[...null!=A&&A.crud?[c.a.createElement(i.EuiContextMenuItem,{"data-test-subj":"add-to-existing-case-action",onClick:S,size:"s"},x),c.a.createElement(i.EuiContextMenuItem,{"data-test-subj":"add-to-new-case-action",onClick:M,size:"s"},O)]:[],...I?[c.a.createElement(i.EuiContextMenuItem,{key:"viewRuleDetails","data-test-subj":"viewRuleDetails",href:I},C.c.alertsTable.viewRuleDetailsButtonText)]:[],c.a.createElement(i.EuiContextMenuItem,{key:"viewAlertDetails","data-test-subj":"viewAlertDetails",onClick:()=>{j(),n(E)}},C.c.alertsTable.viewAlertDetailsButtonText)]),[null==A?void 0:A.crud,S,M,I,E,n,j]),z=P.length<=0?C.c.alertsTable.notEnoughPermissions:C.c.alertsTable.moreActionsTextLabel;return c.a.createElement(c.a.Fragment,null,c.a.createElement(i.EuiFlexGroup,{gutterSize:"none",responsive:!1},c.a.createElement(i.EuiFlexItem,null,c.a.createElement(i.EuiToolTip,{content:C.c.alertsTable.viewInAppTextLabel},c.a.createElement(i.EuiButtonIcon,{size:"s",href:T.basePath.prepend(null!==(s=E.link)&&void 0!==s?s:""),iconType:"eye",color:"text","aria-label":C.c.alertsTable.viewInAppTextLabel}))),c.a.createElement(i.EuiFlexItem,null,c.a.createElement(i.EuiPopover,{button:c.a.createElement(i.EuiToolTip,{content:z},c.a.createElement(i.EuiButtonIcon,{display:"empty",size:"s",color:"text",iconType:"boxesHorizontal","aria-label":z,onClick:()=>k(t),"data-test-subj":"alertsTableRowActionMore"})),isOpen:d===t,closePopover:j,panelPaddingSize:"none",anchorPosition:"downLeft"},c.a.createElement(i.EuiContextMenuPanel,{size:"s",items:P})))))}const D=["@timestamp","signal.rule.risk_score","signal.reason","kibana.alert.duration.us","kibana.alert.reason"];function M(e){const{indexNames:t,rangeFrom:a,rangeTo:n,kuery:i,setRefetch:r,stateStorageKey:o,storage:m,itemsPerPage:h}=e,{timelines:j,application:{capabilities:M}}=Object(b.useKibana)().services,[S,P]=Object(u.useState)(void 0),[z,L]=Object(u.useState)(m.get(o)),_=Object(g.a)(),N=Object(u.useCallback)((({ruleConsumer:e,ruleProducer:t})=>"alerts"===e&&t?p(M,t).crud:p(M,e).crud),[M]),[B,K]=Object(u.useState)([]);Object(u.useEffect)((()=>{if(z){var e;const t={...z,columns:null===(e=z.columns)||void 0===e?void 0:e.map((e=>Object(d.pick)(e,["columnHeaderType","displayAsText","id","initialWidth","linkField"])))};t!==m.get(o)&&m.set(o,t)}}),[z,o,m]);const U=Object(u.useCallback)((e=>{e.isDeleted&&K((t=>[...t,...e.eventIds]))}),[]),H=Object(u.useMemo)((()=>[{id:"expand",width:120,headerCellRender:()=>c.a.createElement(A,null,C.c.alertsTable.actionsTextLabel),rowCellRender:e=>c.a.createElement(R,l()({},e,{setEventsDeleted:U,setFlyoutAlert:P}))}]),[U]),W=Object(u.useCallback)((e=>{const t=Object(d.pick)(e.timelineById["standalone-t-grid"],["columns","sort","selectedEventIds"]);JSON.stringify(t)!==JSON.stringify(z)&&L(t)}),[z]),X=(({onClose:e,onSuccess:t}={})=>{var a;const{cases:n}=Object(b.useKibana)().services,l=Object(g.a)(),s=null!==(a=null==l?void 0:l.crud)&&void 0!==a&&a,i=n.hooks.getUseCasesAddToNewCaseFlyout({onClose:e,onSuccess:t}),r=n.hooks.getUseCasesAddToExistingCaseModal({onClose:e,onRowClick:t});return Object(u.useMemo)((()=>s?[{label:O,key:"attach-new-case","data-test-subj":"attach-new-case",disableOnQuery:!0,disabledLabel:k,onClick:e=>{const t=e?n.helpers.groupAlertsByRule(e,y.observabilityFeatureId):[];i.open({attachments:t})}},{label:x,key:"attach-existing-case",disableOnQuery:!0,disabledLabel:k,"data-test-subj":"attach-existing-case",onClick:e=>{const t=e?n.helpers.groupAlertsByRule(e,y.observabilityFeatureId):[];r.open({attachments:t})}}]:[]),[n.helpers,i,s,r])})(),q=Object(u.useMemo)((()=>({alertStatusActions:!1,customBulkActions:X})),[X]),J=Object(u.useMemo)((()=>{var e,l;return{appId:y.observabilityAppId,casesOwner:y.observabilityFeatureId,casePermissions:_,type:"standalone",columns:(null!==(e=null==z?void 0:z.columns)&&void 0!==e?e:w).map(E.a),deletedEventIds:B,disabledCellActions:D,end:n,filters:[],hasAlertsCrudPermissions:N,indexNames:t,itemsPerPage:h,itemsPerPageOptions:[10,25,50],loadingText:C.c.alertsTable.loadingTextLabel,footerText:C.c.alertsTable.footerTextLabel,onStateChange:W,query:{query:null!=i?i:"",language:"kuery"},renderCellValue:Object(v.b)({setFlyoutAlert:P}),rowRenderers:I,runtimeMappings:{},start:a,setRefetch:r,bulkActions:q,sort:null!==(l=null==z?void 0:z.sort)&&void 0!==l?l:[{columnId:"@timestamp",columnType:"date",sortDirection:"desc"}],queryFields:[s.b,s.d,s.e,s.g,s.j,s.t,s.K,s.O,s.J,s.X],leadingControlColumns:H,trailingControlColumns:F,unit:e=>C.c.alertsTable.showingAlertsTitle(e)}}),[_,null==z?void 0:z.columns,null==z?void 0:z.sort,B,n,N,t,h,W,i,a,r,q,H]),{observabilityRuleTypeRegistry:$}=Object(f.a)();return c.a.createElement(c.a.Fragment,null,S&&c.a.createElement(u.Suspense,{fallback:null},c.a.createElement(T.LazyAlertsFlyout,{alert:S,observabilityRuleTypeRegistry:$,onClose:()=>P(void 0)})),j.getTGrid(J))}},113:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(7),l=a(0),s=a.n(l);const i={critical:"danger",warning:"warning"};function r({severityLevel:e}){return e?s.a.createElement(n.EuiBadge,{color:e?i[e]:"default"},e):null}},115:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(0);const l=Object(n.createContext)({})},116:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(97),l=a(100);const s=e=>e.id===n.g?{...e,displayAsText:l.c.alertsTable.reasonColumnDescription}:e.id===n.b?{...e,displayAsText:l.c.alertsTable.durationColumnDescription}:e.id===n.K?{...e,displayAsText:l.c.alertsTable.statusColumnDescription}:e.id===n.X?{...e,displayAsText:l.c.alertsTable.lastUpdatedColumnDescription}:e},170:function(e,t,a){"use strict";a.r(t),a.d(t,"registerAlertsTableConfiguration",(function(){return d}));var n=a(0),l=a(14),s=a(106),i=a(116),r=a(112);const o=Object(n.lazy)((()=>a.e(10).then(a.bind(null,167)))),u=Object(n.lazy)((()=>a.e(15).then(a.bind(null,168)))),c=Object(n.lazy)((()=>a.e(16).then(a.bind(null,169)))),d=e=>{e.has(l.observabilityFeatureId)||e.register({id:l.observabilityFeatureId,columns:r.b.map(i.a),externalFlyout:{header:o,body:u,footer:c},getRenderCellValue:s.b})}},96:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(0),l=a(115);function s(){return Object(n.useContext)(l.a)}}}]);