/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.transform_bundle_jsonpfunction=window.transform_bundle_jsonpfunction||[]).push([[3],{106:function(e,t,l){"use strict";l.r(t);var s=l(16),n=l(2),r=l.n(n),a=l(18),o=l(0),c=l(6),i=l(3),u=l(15);const d=r.a.memo((({config:e,onChange:t,errors:l})=>{const o=Object(c.a)(e),d=Object(n.useCallback)((l=>{t({...null!=e?e:{},...l})}),[t,e]);return Object(u.jsx)(r.a.Fragment,null,Object(u.jsx)(s.EuiForm,{component:"div",isInvalid:!(null==l||!l.length),error:l},Object.entries(o).map((([e,t],l)=>{var n,r;return Object(u.jsx)(s.EuiDescribedFormGroup,{key:e,title:Object(u.jsx)("h4",null,null===(n=i.l[e])||void 0===n?void 0:n.name),description:null===(r=i.l[e])||void 0===r?void 0:r.description,fullWidth:!0,gutterSize:"s"},Object(u.jsx)(s.EuiFormRow,null,Object(u.jsx)(s.EuiSwitch,{label:Object(u.jsx)(a.FormattedMessage,{id:"xpack.transform.alertTypes.transformHealth.testsSelection.enableTestLabel",defaultMessage:"Enable"}),onChange:d.bind(null,{[e]:{...o[e],enabled:!o[e].enabled}}),checked:o[e].enabled})))}))),Object(u.jsx)(s.EuiSpacer,{size:"l"}))}));var b=l(58);function m(e){return e.map((e=>({value:e,label:e})))}const j=({label:e,errors:t,onChange:l,selectedOptions:r,options:a,allowSelectAll:o=!1})=>{const c=Object(n.useMemo)((()=>m(r)),[r]),d=Object(n.useMemo)((()=>m(o?[i.a,...a]:a)),[a,o]);return Object(u.jsx)(s.EuiFormRow,{fullWidth:!0,label:e,isInvalid:!(null==t||!t.length),error:t},Object(u.jsx)(s.EuiComboBox,{singleSelection:!1,selectedOptions:c,options:d,onChange:e=>{null!=e&&e.length?e[e.length-1].value!==i.a?l(e.slice(e[0].value===i.a?1:0).map((e=>e.value)).filter(b.b)):l([i.a]):l([])},fullWidth:!0,"data-test-subj":"transformSelection",isInvalid:!(null==t||!t.length)}))};var f=l(52),g=l(41);t.default=({ruleParams:e,setRuleParams:t,errors:l})=>{var c,b,m;const O=Object.values(l).flat(),h=O.length>0,p=Object(f.a)(),x=Object(g.b)(),[v,T]=Object(n.useState)([]),C=Object(n.useCallback)((e=>l=>{t(e,l)}),[t]);Object(n.useEffect)((function(){let e=!1;return p.getTransforms().then((t=>{e||T(t.transforms.filter((e=>e.sync)).map((e=>e.id)))})).catch((e=>{x.addError(e,{title:o.i18n.translate("xpack.transform.alertingRuleTypes.transformHealth.fetchErrorMessage",{defaultMessage:"Unable to fetch transforms"})})})),()=>{e=!0}}),[p,x]);const E=Object(n.useMemo)((()=>{var t;return null!==(t=e.includeTransforms)&&void 0!==t&&t.some((e=>e===i.a))?v:null}),[v,e.includeTransforms]);return Object(u.jsx)(s.EuiForm,{"data-test-subj":"transformHealthAlertingRuleForm",invalidCallout:"none",error:O,isInvalid:h},Object(u.jsx)(j,{label:Object(u.jsx)(a.FormattedMessage,{id:"xpack.transform.alertTypes.transformHealth.includeTransformsLabel",defaultMessage:"Include transforms"}),options:v,selectedOptions:null!==(c=e.includeTransforms)&&void 0!==c?c:[],onChange:C("includeTransforms"),allowSelectAll:!0,errors:l.includeTransforms}),Object(u.jsx)(s.EuiSpacer,{size:"m"}),null!=E&&E.length||null!==(b=e.excludeTransforms)&&void 0!==b&&b.length?Object(u.jsx)(r.a.Fragment,null,Object(u.jsx)(j,{label:Object(u.jsx)(a.FormattedMessage,{id:"xpack.transform.alertTypes.transformHealth.excludeTransformsLabel",defaultMessage:"Exclude transforms"}),options:null!=E?E:[],selectedOptions:null!==(m=e.excludeTransforms)&&void 0!==m?m:[],onChange:C("excludeTransforms")}),Object(u.jsx)(s.EuiSpacer,{size:"m"})):null,Object(u.jsx)(d,{config:e.testsConfig,onChange:C("testsConfig"),errors:Array.isArray(l.testsConfig)?l.testsConfig:[]}))}}}]);