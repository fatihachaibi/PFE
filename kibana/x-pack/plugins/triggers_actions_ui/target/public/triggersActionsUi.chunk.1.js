/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.triggersActionsUi_bundle_jsonpfunction=window.triggersActionsUi_bundle_jsonpfunction||[]).push([[1],{124:function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a(1);var r=a(15),n=a(3);const s=({children:e})=>Object(n.jsx)(r.EuiEmptyPrompt,{title:Object(n.jsx)(r.EuiLoadingSpinner,{size:"xl"}),body:Object(n.jsx)(r.EuiText,{color:"subdued"},e),"data-test-subj":"sectionLoading"})},137:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var r=a(125);async function n({http:e}){return await e.get(`${r.a}/_config`)}},146:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var r=a(5);const n=(e,t)=>{const{rule:a}=e;switch(t.command.type){case"setRule":{const{key:a,value:r}=t.payload;return"rule"===a?{...e,rule:r}:e}case"setProperty":{const{key:n,value:s}=t.payload;return Object(r.isEqual)(a[n],s)?e:{...e,rule:{...a,[n]:s}}}case"setScheduleProperty":{const{key:n,value:s}=t.payload;return a.schedule&&Object(r.isEqual)(a.schedule[n],s)?e:{...e,rule:{...a,schedule:{...a.schedule,[n]:s}}}}case"setRuleParams":{const{key:n,value:s}=t.payload;return Object(r.isEqual)(a.params[n],s)?e:{...e,rule:{...a,params:{...a.params,[n]:s}}}}case"setRuleActionParams":{const{key:n,value:s,index:l}=t.payload;if(void 0===l||null==a.actions[l]||a.actions[l][n]&&Object(r.isEqual)(a.actions[l][n],s))return e;{const t=a.actions.splice(l,1)[0],r={...t,params:{...t.params,[n]:s}};return a.actions.splice(l,0,r),{...e,rule:{...a,actions:[...a.actions]}}}}case"setRuleActionProperty":{const{key:n,value:s,index:l}=t.payload;if(void 0===l||Object(r.isEqual)(a.actions[l][n],s))return e;{const t={...a.actions.splice(l,1)[0],[n]:s};return a.actions.splice(l,0,t),{...e,rule:{...a,actions:[...a.actions]}}}}}}},168:function(e,t,a){"use strict";a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return i}));var r=a(0),n=a(5),s=a(16);function l(e,t){const a=t?"all"===t?Object(n.pick)(e,s.j):Object(n.pick)(e,[...s.j,...s.g]):e,l=function(){const e=[];return e.push({name:i.ruleId,description:r.i18n.translate("xpack.triggersActionsUI.actionVariables.ruleIdLabel",{defaultMessage:"The ID of the rule."})}),e.push({name:i.ruleName,description:r.i18n.translate("xpack.triggersActionsUI.actionVariables.ruleNameLabel",{defaultMessage:"The name of the rule."})}),e.push({name:i.ruleSpaceId,description:r.i18n.translate("xpack.triggersActionsUI.actionVariables.ruleSpaceIdLabel",{defaultMessage:"The space ID of the rule."})}),e.push({name:i.ruleTags,description:r.i18n.translate("xpack.triggersActionsUI.actionVariables.ruleTagsLabel",{defaultMessage:"The tags of the rule."})}),e.push({name:i.ruleType,description:r.i18n.translate("xpack.triggersActionsUI.actionVariables.ruleTypeLabel",{defaultMessage:"The type of rule."})}),e.push({name:i.date,description:r.i18n.translate("xpack.triggersActionsUI.actionVariables.dateLabel",{defaultMessage:"The date the rule scheduled the action."})}),e.push({name:i.alertId,description:r.i18n.translate("xpack.triggersActionsUI.actionVariables.alertIdLabel",{defaultMessage:"The ID of the alert that scheduled actions for the rule."})}),e.push({name:i.alertActionGroup,description:r.i18n.translate("xpack.triggersActionsUI.actionVariables.alertActionGroupLabel",{defaultMessage:"The action group of the alert that scheduled actions for the rule."})}),e.push({name:i.alertActionSubgroup,description:r.i18n.translate("xpack.triggersActionsUI.actionVariables.alertActionSubgroupLabel",{defaultMessage:"The action subgroup of the alert that scheduled actions for the rule."})}),e.push({name:i.alertActionGroupName,description:r.i18n.translate("xpack.triggersActionsUI.actionVariables.alertActionGroupNameLabel",{defaultMessage:"The human readable name of the action group of the alert that scheduled actions for the rule."})}),e.push({name:"kibanaBaseUrl",description:r.i18n.translate("xpack.triggersActionsUI.actionVariables.kibanaBaseUrlLabel",{defaultMessage:"The configured server.publicBaseUrl value or empty string if not configured."})}),e.push({name:o.alertId,deprecated:!0,description:r.i18n.translate("xpack.triggersActionsUI.actionVariables.legacyAlertIdLabel",{defaultMessage:"This has been deprecated in favor of {variable}.",values:{variable:i.ruleId}})}),e.push({name:o.alertName,deprecated:!0,description:r.i18n.translate("xpack.triggersActionsUI.actionVariables.legacyAlertNameLabel",{defaultMessage:"This has been deprecated in favor of {variable}.",values:{variable:i.ruleName}})}),e.push({name:o.alertInstanceId,deprecated:!0,description:r.i18n.translate("xpack.triggersActionsUI.actionVariables.legacyAlertInstanceIdLabel",{defaultMessage:"This has been deprecated in favor of {variable}.",values:{variable:i.alertId}})}),e.push({name:o.alertActionGroup,deprecated:!0,description:r.i18n.translate("xpack.triggersActionsUI.actionVariables.legacyAlertActionGroupLabel",{defaultMessage:"This has been deprecated in favor of {variable}.",values:{variable:i.alertActionGroup}})}),e.push({name:o.alertActionGroupName,deprecated:!0,description:r.i18n.translate("xpack.triggersActionsUI.actionVariables.legacyAlertActionGroupNameLabel",{defaultMessage:"This has been deprecated in favor of {variable}.",values:{variable:i.alertActionGroupName}})}),e.push({name:o.alertActionSubgroup,deprecated:!0,description:r.i18n.translate("xpack.triggersActionsUI.actionVariables.legacyAlertActionSubGroupLabel",{defaultMessage:"This has been deprecated in favor of {variable}.",values:{variable:i.alertActionSubgroup}})}),e.push({name:o.spaceId,deprecated:!0,description:r.i18n.translate("xpack.triggersActionsUI.actionVariables.legacySpaceIdLabel",{defaultMessage:"This has been deprecated in favor of {variable}.",values:{variable:i.ruleSpaceId}})}),e.push({name:o.tags,deprecated:!0,description:r.i18n.translate("xpack.triggersActionsUI.actionVariables.legacyTagsLabel",{defaultMessage:"This has been deprecated in favor of {variable}.",values:{variable:i.ruleTags}})}),e}(),c=u(a.params,"params."),d=a.context?u(a.context,"context."):[],p=a.state?u(a.state,"state."):[];return l.concat(d,c,p)}let i,o;function u(e,t){return e.map((e=>({...e,name:`${t}${e.name}`})))}!function(e){e.ruleId="rule.id",e.ruleName="rule.name",e.ruleSpaceId="rule.spaceId",e.ruleTags="rule.tags",e.ruleType="rule.type",e.date="date",e.alertId="alert.id",e.alertActionGroup="alert.actionGroup",e.alertActionGroupName="alert.actionGroupName",e.alertActionSubgroup="alert.actionSubgroup"}(i||(i={})),function(e){e.alertId="alertId",e.alertName="alertName",e.alertInstanceId="alertInstanceId",e.alertActionGroup="alertActionGroup",e.alertActionGroupName="alertActionGroupName",e.alertActionSubgroup="alertActionSubgroup",e.tags="tags",e.spaceId="spaceId"}(o||(o={}))},169:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var r=a(5),n=a(0);function s(e){return!1===(null==e?void 0:e.enabledInLicense)?(e=>({isEnabled:!1,message:n.i18n.translate("xpack.triggersActionsUI.checkRuleTypeEnabled.ruleTypeDisabledByLicenseMessage",{defaultMessage:"This rule type requires a {minimumLicenseRequired} license.",values:{minimumLicenseRequired:Object(r.upperFirst)(e.minimumLicenseRequired)}})}))(e):{isEnabled:!0}}},170:function(e,t,a){"use strict";e.exports=function e(t,a){if(t===a)return!0;if(t&&a&&"object"==typeof t&&"object"==typeof a){if(t.constructor!==a.constructor)return!1;var r,n,s;if(Array.isArray(t)){if((r=t.length)!=a.length)return!1;for(n=r;0!=n--;)if(!e(t[n],a[n]))return!1;return!0}if(t.constructor===RegExp)return t.source===a.source&&t.flags===a.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===a.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===a.toString();if((r=(s=Object.keys(t)).length)!==Object.keys(a).length)return!1;for(n=r;0!=n--;)if(!Object.prototype.hasOwnProperty.call(a,s[n]))return!1;for(n=r;0!=n--;){var l=s[n];if(!e(t[l],a[l]))return!1}return!0}return t!=t&&a!=a}},186:function(e,t,a){"use strict";a.r(t),a.d(t,"NOTIFY_WHEN_OPTIONS",(function(){return p})),a.d(t,"RuleNotifyWhen",(function(){return b}));var r=a(1),n=a.n(r),s=a(0),l=a(76),i=a(15),o=a(122),u=a(47),c=a(41),d=a(3);const p=[{value:"onActionGroupChange",inputDisplay:s.i18n.translate("xpack.triggersActionsUI.sections.ruleForm.ruleNotifyWhen.onActionGroupChange.display",{defaultMessage:"Only on status change"}),"data-test-subj":"onActionGroupChange",dropdownDisplay:Object(d.jsx)(n.a.Fragment,null,Object(d.jsx)("strong",null,Object(d.jsx)(l.FormattedMessage,{defaultMessage:"Only on status change",id:"xpack.triggersActionsUI.sections.ruleForm.ruleNotifyWhen.onActionGroupChange.label"})),Object(d.jsx)(i.EuiText,{size:"s",color:"subdued"},Object(d.jsx)("p",null,Object(d.jsx)(l.FormattedMessage,{defaultMessage:"Actions run when the rule status changes.",id:"xpack.triggersActionsUI.sections.ruleForm.ruleNotifyWhen.onActionGroupChange.description"}))))},{value:"onActiveAlert",inputDisplay:s.i18n.translate("xpack.triggersActionsUI.sections.ruleForm.ruleNotifyWhen.onActiveAlert.display",{defaultMessage:"Every time rule is active"}),"data-test-subj":"onActiveAlert",dropdownDisplay:Object(d.jsx)(n.a.Fragment,null,Object(d.jsx)("strong",null,Object(d.jsx)(l.FormattedMessage,{defaultMessage:"Every time rule is active",id:"xpack.triggersActionsUI.sections.ruleForm.ruleNotifyWhen.onActiveAlert.label"})),Object(d.jsx)(i.EuiText,{size:"s",color:"subdued"},Object(d.jsx)("p",null,Object(d.jsx)(l.FormattedMessage,{defaultMessage:"Actions repeat at the rule interval when the rule is active.",id:"xpack.triggersActionsUI.sections.ruleForm.ruleNotifyWhen.onActiveAlert.description"}))))},{value:"onThrottleInterval",inputDisplay:s.i18n.translate("xpack.triggersActionsUI.sections.ruleForm.ruleNotifyWhen.onThrottleInterval.display",{defaultMessage:"On a custom action interval"}),"data-test-subj":"onThrottleInterval",dropdownDisplay:Object(d.jsx)(n.a.Fragment,null,Object(d.jsx)("strong",null,Object(d.jsx)(l.FormattedMessage,{defaultMessage:"On a custom action interval",id:"xpack.triggersActionsUI.sections.ruleForm.ruleNotifyWhen.onThrottleInterval.label"})),Object(d.jsx)(i.EuiText,{size:"s",color:"subdued"},Object(d.jsx)("p",null,Object(d.jsx)(l.FormattedMessage,{defaultMessage:"Actions run using the interval you set.",id:"xpack.triggersActionsUI.sections.ruleForm.ruleNotifyWhen.onThrottleInterval.description"}))))}],b=({rule:e,throttle:t,throttleUnit:a,onNotifyWhenChange:b,onThrottleChange:g})=>{const[j,m]=Object(r.useState)(t||1),[h,f]=Object(r.useState)(!1),[x,O]=Object(r.useState)("onActionGroupChange");Object(r.useEffect)((()=>{e.notifyWhen?O(e.notifyWhen):O(e.throttle?"onThrottleInterval":"onActiveAlert")}),[e]),Object(r.useEffect)((()=>{f("onThrottleInterval"===x)}),[x]);const y=Object(r.useCallback)((e=>{g("onThrottleInterval"===e?j:null,a),b(e),O(e)}),[]),v=Object(d.jsx)(n.a.Fragment,null,Object(d.jsx)(l.FormattedMessage,{id:"xpack.triggersActionsUI.sections.ruleForm.renotifyFieldLabel",defaultMessage:"Notify"})," ",Object(d.jsx)(i.EuiIconTip,{position:"right",type:"questionInCircle",content:s.i18n.translate("xpack.triggersActionsUI.sections.ruleForm.renotifyWithTooltip",{defaultMessage:"Define how often to repeat the action while the rule is active."})}));return Object(d.jsx)(n.a.Fragment,null,Object(d.jsx)(i.EuiFormRow,{fullWidth:!0,label:v},Object(d.jsx)(i.EuiFlexGroup,{gutterSize:"s"},Object(d.jsx)(i.EuiFlexItem,null,Object(d.jsx)(i.EuiSuperSelect,{"data-test-subj":"notifyWhenSelect",options:p,valueOfSelected:x,onChange:y}),h&&Object(d.jsx)(n.a.Fragment,null,Object(d.jsx)(i.EuiSpacer,null),Object(d.jsx)(i.EuiFormRow,{fullWidth:!0},Object(d.jsx)(i.EuiFlexGroup,{gutterSize:"s"},Object(d.jsx)(i.EuiFlexItem,null,Object(d.jsx)(i.EuiFieldNumber,{fullWidth:!0,min:1,value:j,name:"throttle","data-test-subj":"throttleInput",prepend:s.i18n.translate("xpack.triggersActionsUI.sections.ruleForm.ruleNotifyWhen.label",{defaultMessage:"Every"}),onChange:e=>{Object(u.pipe)(Object(o.some)(e.target.value.trim()),Object(o.filter)((e=>""!==e)),Object(o.map)((e=>parseInt(e,10))),Object(o.filter)((e=>!isNaN(e))),Object(o.map)((e=>{m(e),g(e,a)})))}})),Object(d.jsx)(i.EuiFlexItem,{grow:!1},Object(d.jsx)(i.EuiSelect,{"data-test-subj":"throttleUnitInput",value:a,options:Object(c.b)(null!=t?t:1),onChange:e=>{g(t,e.target.value)}})))))))))}},187:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var r=a(20),n=a(2);function s(e){return e&&Object(r.parseDuration)(e)>Object(r.parseDuration)(n.c)?e:n.c}},188:function(e,t,a){"use strict";a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return i})),a.d(t,"c",(function(){return u}));var r=a(5),n=a(0),s=a(89);function l(e,t,a){const r=t?t.validate(e.params).errors:[],l=function(e,t){const a={errors:{}},r={name:new Array,"schedule.interval":new Array,ruleTypeId:new Array,actionConnectors:new Array};a.errors=r,e.name||r.name.push(n.i18n.translate("xpack.triggersActionsUI.sections.ruleForm.error.requiredNameText",{defaultMessage:"Name is required."})),e.schedule.interval.length<2?r["schedule.interval"].push(n.i18n.translate("xpack.triggersActionsUI.sections.ruleForm.error.requiredIntervalText",{defaultMessage:"Check interval is required."})):t.minimumScheduleInterval&&t.minimumScheduleInterval.enforce&&Object(s.parseDuration)(e.schedule.interval)<Object(s.parseDuration)(t.minimumScheduleInterval.value)&&r["schedule.interval"].push(n.i18n.translate("xpack.triggersActionsUI.sections.ruleForm.error.belowMinimumText",{defaultMessage:"Interval must be at least {minimum}.",values:{minimum:Object(s.formatDuration)(t.minimumScheduleInterval.value,!0)}})),e.ruleTypeId||r.ruleTypeId.push(n.i18n.translate("xpack.triggersActionsUI.sections.ruleForm.error.requiredRuleTypeIdText",{defaultMessage:"Rule type is required."}));const l=e.actions.find((e=>/^\d+$/.test(e.id)&&Object.keys(e.params).length>0));return void 0!==l&&r.actionConnectors.push(n.i18n.translate("xpack.triggersActionsUI.sections.ruleForm.error.requiredActionConnector",{defaultMessage:"Action for {actionTypeId} connector is required.",values:{actionTypeId:l.actionTypeId}})),a}(e,a).errors;return{ruleParamsErrors:r,ruleBaseErrors:l,ruleErrors:{...r,...l}}}async function i(e,t){return await Promise.all(e.actions.map((async e=>{var a;return(await(null===(a=t.get(e.actionTypeId))||void 0===a?void 0:a.validateParams(e.params))).errors})))}const o=e=>!!Object.values(e).find((e=>Object(r.isObject)(e)?o(e):e.length>=1));function u(e,t,a){return!o(t)&&a.every((e=>!o(e)))}},189:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a(1);var r=a(15),n=a(76),s=a(0),l=a(3);const i=({onConfirm:e,onCancel:t})=>Object(l.jsx)(r.EuiConfirmModal,{title:s.i18n.translate("xpack.triggersActionsUI.sections.confirmRuleClose.confirmRuleCloseTitle",{defaultMessage:"Discard unsaved changes to rule?"}),onCancel:t,onConfirm:e,confirmButtonText:s.i18n.translate("xpack.triggersActionsUI.sections.confirmRuleClose.confirmRuleCloseConfirmButtonText",{defaultMessage:"Discard changes"}),cancelButtonText:s.i18n.translate("xpack.triggersActionsUI.sections.confirmRuleClose.confirmRuleCloseCancelButtonText",{defaultMessage:"Cancel"}),defaultFocusedButton:"confirm","data-test-subj":"confirmRuleCloseModal"},Object(l.jsx)("p",null,Object(l.jsx)(n.FormattedMessage,{id:"xpack.triggersActionsUI.sections.confirmRuleClose.confirmRuleCloseMessage",defaultMessage:"You can't recover unsaved changes."})))},190:function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return u}));var r=a(170),n=a.n(r),s=a(5);const l=["tags","schedule","actions","notifyWhen"];function i(e){const{name:t,ruleTypeId:a,throttle:r}=e;return{...t&&t.length>0?{name:t}:{},...a&&a.length>0?{ruleTypeId:a}:{},...r&&r.length>0?{throttle:r}:{}}}function o(e,t,a){let r=n()(Object(s.pick)(e,l),Object(s.pick)(t,l));a&&(r=r&&n()(e.params,t.params));const o=n()(i(e),i(t));return!r||!o}function u(e,t){return!n()(e,t)}},193:function(e,t,a){"use strict";a.d(t,"a",(function(){return k}));var r=a(1),n=a.n(r),s=a(0),l=a(76),i=a(15),o=a(5),u=a(89),c=a(20),d=a(41),p=a(13),b=a(112),g=a(3);const j=({solutions:e,onChange:t})=>{const[a,n]=Object(r.useState)([]),[s,o]=Object(r.useState)(!1);return Object(r.useEffect)((()=>{t&&t(a)}),[a]),Object(g.jsx)(i.EuiFilterGroup,null,Object(g.jsx)(i.EuiPopover,{isOpen:s,closePopover:()=>o(!1),button:Object(g.jsx)(i.EuiFilterButton,{iconType:"arrowDown",hasActiveFilters:a.length>0,numActiveFilters:a.length,numFilters:a.length,onClick:()=>o(!s),"data-test-subj":"solutionsFilterButton"},Object(g.jsx)(l.FormattedMessage,{id:"xpack.triggersActionsUI.sections.ruleForm.solutionFilterLabel",defaultMessage:"Filter by use case"}))},Object(g.jsx)("div",{className:"euiFilterSelect__items"},[...e.entries()].map((([e,t])=>Object(g.jsx)(i.EuiFilterSelectItem,{key:e,onClick:()=>{const t=a.includes(e);n(t?a.filter((t=>t!==e)):[...a,e])},checked:a.includes(e)?"on":void 0,"data-test-subj":`solution${e}FilterOption`},t))))))};a(201);var m=a(43),h=a(2),f=a(51),x=a(168),O=a(186),y=a(169),v=a(10),I=a(124),T=a(53),A=a(187);function E(e,t){var a;return null===(a=t.find((t=>t.id===e)))||void 0===a?void 0:a.name}const k=({rule:e,config:t,canChangeTrigger:a=!0,dispatch:k,errors:M,setHasActionsDisabled:S,setHasActionsWithBrokenConnector:U,operation:C,ruleTypeRegistry:R,actionTypeRegistry:N,metadata:G,filteredSolutions:L})=>{var w,D,W;const{notifications:{toasts:z},docLinks:_,application:{capabilities:P},kibanaFeatures:V,charts:$,data:B,unifiedSearch:q,dataViews:H}=Object(m.b)().services,K=Object(b.f)(P),[Y,J]=Object(r.useState)(null),Q=Object(A.a)(null===(w=t.minimumScheduleInterval)||void 0===w?void 0:w.value),X=Object(u.getDurationNumberInItsUnit)(Q),Z=Object(u.getDurationUnitValue)(Q),[ee,te]=Object(r.useState)(e.schedule.interval?Object(u.getDurationNumberInItsUnit)(e.schedule.interval):X),[ae,re]=Object(r.useState)(e.schedule.interval?Object(u.getDurationUnitValue)(e.schedule.interval):Z),[ne,se]=Object(r.useState)(e.throttle?Object(u.getDurationNumberInItsUnit)(e.throttle):null),[le,ie]=Object(r.useState)(e.throttle?Object(u.getDurationUnitValue)(e.throttle):"h"),[oe,ue]=Object(r.useState)(void 0),[ce,de]=Object(r.useState)([]),[pe,be]=Object(r.useState)([]),[ge,je]=Object(r.useState)(),[me,he]=Object(r.useState)(),[fe,xe]=Object(r.useState)(void 0),[Oe,ye]=Object(r.useState)([]);let ve=!1;const{ruleTypes:Ie,error:Te,ruleTypeIndex:Ae}=Object(T.a)({filteredSolutions:L});Object(r.useEffect)((()=>{e.ruleTypeId&&null!=Ae&&Ae.has(e.ruleTypeId)&&ue(Ae.get(e.ruleTypeId).defaultActionGroupId);const t=(a=Ie,R.list().reduce(((e,t)=>{const r=a.find((e=>t.id===e.id));return r&&e.push({ruleType:r,ruleTypeModel:t}),e}),[]).filter((t=>t.ruleType&&Object(b.a)(e,t.ruleType))).filter((t=>e.consumer===c.ALERTS_FEATURE_ID?!t.ruleTypeModel.requiresAppContext:t.ruleType.producer===e.consumer)));var a;de(t);const r=t.reduce(((e,t)=>{var a;return e.has(t.ruleType.producer)||e.set(t.ruleType.producer,null!==(a=V?E(t.ruleType.producer,V):Object(o.capitalize)(t.ruleType.producer))&&void 0!==a?a:Object(o.capitalize)(t.ruleType.producer)),e}),new Map);xe(new Map([...r.entries()].sort((([,e],[,t])=>e.localeCompare(t)))))}),[Ie,Ae,e.ruleTypeId,V,e,R]),Object(r.useEffect)((()=>{Te&&z.addDanger({title:s.i18n.translate("xpack.triggersActionsUI.sections.ruleForm.unableToLoadRuleTypesMessage",{defaultMessage:"Unable to load rule types"})})}),[Te,z]),Object(r.useEffect)((()=>{J(e.ruleTypeId?R.get(e.ruleTypeId):null),e.ruleTypeId&&Ae&&Ae.has(e.ruleTypeId)&&ue(Ae.get(e.ruleTypeId).defaultActionGroupId)}),[e,e.ruleTypeId,Ae,R]),Object(r.useEffect)((()=>{if(e.schedule.interval){const t=Object(u.getDurationNumberInItsUnit)(e.schedule.interval),a=Object(u.getDurationUnitValue)(e.schedule.interval);te(t),re(a)}}),[e.schedule.interval,X,Z]);const Ee=Object(r.useCallback)(((e,t)=>{k({command:{type:"setProperty"},payload:{key:e,value:t}})}),[k]),ke=Object(r.useCallback)((e=>Ee("actions",e)),[Ee]),Fe=(e,t)=>{k({command:{type:"setScheduleProperty"},payload:{key:e,value:t}})},Me=(e,t,a)=>{k({command:{type:"setRuleActionProperty"},payload:{key:e,value:t,index:a}})},Se=Object(r.useCallback)(((e,t,a)=>{k({command:{type:"setRuleActionParams"},payload:{key:e,value:t,index:a}})}),[k]);Object(r.useEffect)((()=>{const e=ge?ge.trim().toLocaleLowerCase():null;be(ce.filter((e=>Oe.length>0?Oe.find((t=>e.ruleType.producer===t)):e)).filter((t=>e?t.ruleType.name.toString().toLocaleLowerCase().includes(e)||t.ruleType.producer.toLocaleLowerCase().includes(e)||t.ruleTypeModel.description.toLocaleLowerCase().includes(e):t)))}),[R,ce,ge,JSON.stringify(Oe)]);const Ue=null!=e&&e.ruleTypeId?null==Ae?void 0:Ae.get(null==e?void 0:e.ruleTypeId):void 0,Ce=null==Ue||null===(D=Ue.recoveryActionGroup)||void 0===D?void 0:D.id,Re=Object(r.useCallback)(((e,t)=>((e,t,a)=>{switch(e){case".pagerduty":const e={dedupKey:`{{${x.a.ruleId}}}:{{${x.a.alertId}}}`,eventAction:f.a.TRIGGER};return a&&(e.eventAction=f.a.RESOLVE),e;case".xmatters":return{alertActionGroupName:`{{${x.a.alertActionGroupName}}}`,signalId:`{{${x.a.ruleId}}}:{{${x.a.alertId}}}`,ruleName:`{{${x.a.ruleName}}}`,date:`{{${x.a.date}}}`,spaceId:`{{${x.a.ruleSpaceId}}}`}}})(e,0,t===Ce)),[Ce]),Ne=e.tags?e.tags.map((e=>({label:e}))):[],Ge=Object(r.useCallback)(((e,t,a)=>{var r;return Object(c.isActionGroupDisabledForActionTypeId)(t===(null==e||null===(r=e.recoveryActionGroup)||void 0===r?void 0:r.id)?c.RecoveredActionGroup.id:t,a)}),[]),Le=Y?Y.ruleParamsExpression:null,we=pe.reduce(((e,t)=>{const a=t.ruleType.producer;if(a){const r=Object(y.a)(t.ruleType);r.isEnabled||(ve=!0),(e[a]=e[a]||[]).push({name:t.ruleType.name,id:t.ruleTypeModel.id,checkEnabledResult:r,ruleTypeItem:t.ruleTypeModel})}return e}),{}),De=Object.entries(we).sort(((e,t)=>function(e,t,a){const r=e[0],n=t[0],s=e[1],l=t[1],i=void 0!==s.find((e=>e.checkEnabledResult.isEnabled)),o=void 0!==l.find((e=>e.checkEnabledResult.isEnabled));return i&&!o?-1:!i&&o?1:a?a.get(r).localeCompare(a.get(n)):r.localeCompare(n)}(e,t,fe))).map((([e,t],a)=>{var n;return Object(g.jsx)(r.Fragment,{key:`group${a}`},Object(g.jsx)(i.EuiFlexGroup,{gutterSize:"none",alignItems:"center",className:"triggersActionsUI__ruleTypeNodeHeading"},Object(g.jsx)(i.EuiFlexItem,null,Object(g.jsx)(i.EuiTitle,{"data-test-subj":`ruleType${a}Group`,size:"xxxs",textTransform:"uppercase"},Object(g.jsx)(i.EuiTextColor,{color:"subdued"},null!==(n=V?E(e,V):Object(o.capitalize)(e))&&void 0!==n?n:Object(o.capitalize)(e)))),Object(g.jsx)(i.EuiFlexItem,{grow:!1},Object(g.jsx)(i.EuiNotificationBadge,{color:"subdued"},t.length))),Object(g.jsx)(i.EuiHorizontalRule,{size:"full",margin:"xs"}),Object(g.jsx)(i.EuiListGroup,{flush:!0,gutterSize:"m",size:"l",maxWidth:!1},t.sort(((e,t)=>function(e,t){return!0===e.checkEnabledResult.isEnabled&&!1===t.checkEnabledResult.isEnabled?-1:!1===e.checkEnabledResult.isEnabled&&!0===t.checkEnabledResult.isEnabled?1:e.name.localeCompare(t.name)}(e,t))).map(((e,t)=>{const a=Object(g.jsx)("span",null,Object(g.jsx)("strong",null,e.name),Object(g.jsx)(i.EuiText,{color:"subdued",size:"s"},Object(g.jsx)("p",null,e.ruleTypeItem.description)));return Object(g.jsx)(i.EuiListGroupItem,{wrapText:!0,key:t,"data-test-subj":`${e.id}-SelectOption`,color:"primary",label:e.checkEnabledResult.isEnabled?a:Object(g.jsx)(i.EuiToolTip,{position:"top","data-test-subj":`${e.id}-disabledTooltip`,content:e.checkEnabledResult.message},a),isDisabled:!e.checkEnabledResult.isEnabled,onClick:()=>{Ee("ruleTypeId",e.id),ke([]),J(e.ruleTypeItem),Ee("params",{}),Ae&&Ae.has(e.id)&&ue(Ae.get(e.id).defaultActionGroupId)}})}))),Object(g.jsx)(i.EuiSpacer,null))})),We=Object(g.jsx)(n.a.Fragment,null,Object(g.jsx)(i.EuiHorizontalRule,null),Object(g.jsx)(i.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},Object(g.jsx)(i.EuiFlexItem,null,Object(g.jsx)(i.EuiTitle,{size:"s","data-test-subj":"selectedRuleTypeTitle"},Object(g.jsx)("h5",{id:"selectedRuleTypeTitle"},e.ruleTypeId&&Ae&&Ae.has(e.ruleTypeId)?Ae.get(e.ruleTypeId).name:""))),a?Object(g.jsx)(i.EuiFlexItem,{grow:!1},Object(g.jsx)(i.EuiButtonIcon,{iconType:"cross",color:"danger","aria-label":s.i18n.translate("xpack.triggersActionsUI.sections.ruleForm.changeRuleTypeAriaLabel",{defaultMessage:"Delete"}),onClick:()=>{Ee("ruleTypeId",null),J(null),Ee("params",{})}})):null),(null==Y?void 0:Y.description)&&Object(g.jsx)(i.EuiFlexGroup,null,Object(g.jsx)(i.EuiFlexItem,null,Object(g.jsx)(i.EuiText,{color:"subdued",size:"s","data-test-subj":"ruleDescription"},Y.description," ",(null==Y?void 0:Y.documentationUrl)&&Object(g.jsx)(i.EuiLink,{external:!0,target:"_blank","data-test-subj":"ruleDocumentationLink",href:"function"==typeof Y.documentationUrl?Y.documentationUrl(_):Y.documentationUrl},Object(g.jsx)(l.FormattedMessage,{id:"xpack.triggersActionsUI.sections.ruleForm.documentationLabel",defaultMessage:"Learn more"}))))),Object(g.jsx)(i.EuiHorizontalRule,null),Le&&oe&&e.ruleTypeId&&Ue?Object(g.jsx)(i.EuiErrorBoundary,null,Object(g.jsx)(r.Suspense,{fallback:Object(g.jsx)(I.a,null,Object(g.jsx)(l.FormattedMessage,{id:"xpack.triggersActionsUI.sections.ruleForm.loadingRuleTypeParamsDescription",defaultMessage:"Loading rule type params…"}))},Object(g.jsx)(Le,{ruleParams:e.params,ruleInterval:`${null!=ee?ee:1}${ae}`,ruleThrottle:`${null!=ne?ne:1}${le}`,alertNotifyWhen:null!==(W=e.notifyWhen)&&void 0!==W?W:"onActionGroupChange",errors:M,setRuleParams:(e,t)=>{k({command:{type:"setRuleParams"},payload:{key:e,value:t}})},setRuleProperty:Ee,defaultActionGroupId:oe,actionGroups:Ue.actionGroups,metadata:G,charts:$,data:B,dataViews:H,unifiedSearch:q}))):null,K&&oe&&Y&&e.ruleTypeId&&Ue?Object(g.jsx)(n.a.Fragment,null,M.actionConnectors.length>=1?Object(g.jsx)(n.a.Fragment,null,Object(g.jsx)(i.EuiSpacer,null),Object(g.jsx)(i.EuiCallOut,{color:"danger",size:"s",title:M.actionConnectors}),Object(g.jsx)(i.EuiSpacer,null)):null,Object(g.jsx)(p.a,{actions:e.actions,setHasActionsDisabled:S,setHasActionsWithBrokenConnector:U,messageVariables:Ue.actionVariables,defaultActionGroupId:oe,isActionGroupDisabledForActionType:(e,t)=>Ge(Ue,e,t),actionGroups:Ue.actionGroups.map((e=>e.id===Ue.recoveryActionGroup.id?{...e,omitMessageVariables:Ue.doesSetRecoveryContext?"keepContext":"all",defaultActionMessage:(null==Y?void 0:Y.defaultRecoveryMessage)||h.l}:{...e,defaultActionMessage:null==Y?void 0:Y.defaultActionMessage})),getDefaultActionParams:Re,setActionIdByIndex:(e,t)=>Me("id",e,t),setActionGroupIdByIndex:(e,t)=>Me("group",e,t),setActions:ke,setActionParamsProperty:Se,actionTypeRegistry:N})):null),ze=Object(g.jsx)(n.a.Fragment,null,Object(g.jsx)(l.FormattedMessage,{id:"xpack.triggersActionsUI.sections.ruleForm.checkFieldLabel",defaultMessage:"Check every"})," ",Object(g.jsx)(i.EuiIconTip,{position:"right",type:"questionInCircle",content:s.i18n.translate("xpack.triggersActionsUI.sections.ruleForm.checkWithTooltip",{defaultMessage:"Define how often to evaluate the condition. Checks are queued; they run as close to the defined value as capacity allows."})}));return Object(g.jsx)(i.EuiForm,null,Object(g.jsx)(i.EuiFlexGrid,{columns:2},Object(g.jsx)(i.EuiFlexItem,null,Object(g.jsx)(i.EuiFormRow,{fullWidth:!0,id:"ruleName",label:Object(g.jsx)(l.FormattedMessage,{id:"xpack.triggersActionsUI.sections.ruleForm.ruleNameLabel",defaultMessage:"Name"}),isInvalid:M.name.length>0&&void 0!==e.name,error:M.name},Object(g.jsx)(i.EuiFieldText,{fullWidth:!0,autoFocus:!0,isInvalid:M.name.length>0&&void 0!==e.name,name:"name","data-test-subj":"ruleNameInput",value:e.name||"",onChange:e=>{Ee("name",e.target.value)},onBlur:()=>{e.name||Ee("name","")}}))),Object(g.jsx)(i.EuiFlexItem,null,Object(g.jsx)(i.EuiFormRow,{fullWidth:!0,label:s.i18n.translate("xpack.triggersActionsUI.sections.ruleForm.tagsFieldLabel",{defaultMessage:"Tags (optional)"})},Object(g.jsx)(i.EuiComboBox,{noSuggestions:!0,fullWidth:!0,"data-test-subj":"tagsComboBox",selectedOptions:Ne,onCreateOption:e=>{const t=[...Ne,{label:e}];Ee("tags",t.map((e=>e.label)))},onChange:e=>{Ee("tags",e.map((e=>e.label)))},onBlur:()=>{e.tags||Ee("tags",[])}})))),Object(g.jsx)(i.EuiSpacer,{size:"m"}),Object(g.jsx)(i.EuiFlexGrid,{columns:2},Object(g.jsx)(i.EuiFlexItem,null,Object(g.jsx)(i.EuiFormRow,{fullWidth:!0,"data-test-subj":"intervalFormRow",display:"rowCompressed",helpText:t&&t.minimumScheduleInterval?M["schedule.interval"].length>0?"":t.minimumScheduleInterval.enforce?s.i18n.translate("xpack.triggersActionsUI.sections.ruleForm.checkEveryHelpText",{defaultMessage:"Interval must be at least {minimum}.",values:{minimum:Object(u.formatDuration)(t.minimumScheduleInterval.value,!0)}}):e.schedule.interval&&Object(u.parseDuration)(e.schedule.interval)<Object(u.parseDuration)(t.minimumScheduleInterval.value)?s.i18n.translate("xpack.triggersActionsUI.sections.ruleForm.checkEveryHelpSuggestionText",{defaultMessage:"Intervals less than {minimum} are not recommended due to performance considerations.",values:{minimum:Object(u.formatDuration)(t.minimumScheduleInterval.value,!0)}}):"":"",label:ze,isInvalid:M["schedule.interval"].length>0,error:M["schedule.interval"]},Object(g.jsx)(i.EuiFlexGroup,{gutterSize:"s"},Object(g.jsx)(i.EuiFlexItem,null,Object(g.jsx)(i.EuiFieldNumber,{fullWidth:!0,min:1,isInvalid:M["schedule.interval"].length>0,value:ee||"",name:"interval","data-test-subj":"intervalInput",onChange:e=>{const t=e.target.value,a=""!==t?parseInt(t,10):void 0;te(a),Fe("interval",`${t}${ae}`)}})),Object(g.jsx)(i.EuiFlexItem,{grow:!1},Object(g.jsx)(i.EuiSelect,{fullWidth:!0,value:ae,options:Object(d.b)(null!=ee?ee:1),onChange:e=>{re(e.target.value),Fe("interval",`${ee}${e.target.value}`)},"data-test-subj":"intervalInputUnit"}))))),Object(g.jsx)(i.EuiFlexItem,null,Object(g.jsx)(O.RuleNotifyWhen,{rule:e,throttle:ne,throttleUnit:le,onNotifyWhenChange:Object(r.useCallback)((e=>{Ee("notifyWhen",e)}),[Ee]),onThrottleChange:Object(r.useCallback)(((e,t)=>{se(e),ie(t),Ee("throttle",e?`${e}${t}`:null)}),[Ee])}))),Object(g.jsx)(i.EuiSpacer,{size:"m"}),Y?Object(g.jsx)(n.a.Fragment,null,We):ce.length?Object(g.jsx)(n.a.Fragment,null,Object(g.jsx)(i.EuiHorizontalRule,null),Object(g.jsx)(i.EuiFormRow,{fullWidth:!0,labelAppend:ve&&Object(g.jsx)(i.EuiTitle,{size:"xxs"},Object(g.jsx)(i.EuiLink,{href:v.VIEW_LICENSE_OPTIONS_LINK,target:"_blank",external:!0,className:"actActionForm__getMoreActionsLink"},Object(g.jsx)(l.FormattedMessage,{defaultMessage:"Get more rule types",id:"xpack.triggersActionsUI.sections.actionForm.getMoreRuleTypesTitle"}))),label:Object(g.jsx)(i.EuiTitle,{size:"xxs"},Object(g.jsx)("h5",null,Object(g.jsx)(l.FormattedMessage,{id:"xpack.triggersActionsUI.sections.ruleForm.ruleTypeSelectLabel",defaultMessage:"Select rule type"})))},Object(g.jsx)(i.EuiFlexGroup,{gutterSize:"s"},Object(g.jsx)(i.EuiFlexItem,null,Object(g.jsx)(i.EuiFieldSearch,{fullWidth:!0,"data-test-subj":"ruleSearchField",onChange:e=>{he(e.target.value),""===e.target.value&&je("")},onKeyUp:e=>{13===e.keyCode&&je(me)},placeholder:s.i18n.translate("xpack.triggersActionsUI.sections.ruleForm.searchPlaceholderTitle",{defaultMessage:"Search"})})),fe?Object(g.jsx)(i.EuiFlexItem,{grow:!1},Object(g.jsx)(j,{key:"solution-filter",solutions:fe,onChange:e=>ye(e)})):null)),Object(g.jsx)(i.EuiSpacer,null),M.ruleTypeId.length>=1&&void 0!==e.ruleTypeId?Object(g.jsx)(n.a.Fragment,null,Object(g.jsx)(i.EuiSpacer,null),Object(g.jsx)(i.EuiCallOut,{color:"danger",size:"s",title:M.ruleTypeId}),Object(g.jsx)(i.EuiSpacer,null)):null,De):Ae?Object(g.jsx)(F,{operation:C}):Object(g.jsx)(I.a,null,Object(g.jsx)(l.FormattedMessage,{id:"xpack.triggersActionsUI.sections.ruleForm.loadingRuleTypesDescription",defaultMessage:"Loading rule types…"})))},F=({operation:e})=>Object(g.jsx)(i.EuiEmptyPrompt,{iconType:"lock","data-test-subj":"noAuthorizedRuleTypesPrompt",titleSize:"xs",title:Object(g.jsx)("h2",null,Object(g.jsx)(l.FormattedMessage,{id:"xpack.triggersActionsUI.sections.ruleForm.error.noAuthorizedRuleTypesTitle",defaultMessage:"You have not been authorized to {operation} any Rule types",values:{operation:e}})),body:Object(g.jsx)("div",null,Object(g.jsx)("p",{role:"banner"},Object(g.jsx)(l.FormattedMessage,{id:"xpack.triggersActionsUI.sections.ruleForm.error.noAuthorizedRuleTypes",defaultMessage:"In order to {operation} a Rule you need to have been granted the appropriate privileges.",values:{operation:e}})))})},201:function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(202);case"v8light":return a(204)}},202:function(e,t,a){var r=a(107),n=a(203);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);r(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}},203:function(e,t,a){(t=a(108)(!1)).push([e.i,".triggersActionsUI__ruleTypeNodeHeading{margin-left:8px;margin-right:8px}\n",""]),e.exports=t},204:function(e,t,a){var r=a(107),n=a(205);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);r(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}},205:function(e,t,a){(t=a(108)(!1)).push([e.i,".triggersActionsUI__ruleTypeNodeHeading{margin-left:8px;margin-right:8px}\n",""]),e.exports=t}}]);