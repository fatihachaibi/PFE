/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.triggersActionsUi_bundle_jsonpfunction=window.triggersActionsUi_bundle_jsonpfunction||[]).push([[74],{284:function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return g}));var s=i(1),n=i.n(s),c=i(15),l=i(76),o=i(43),a=i(120),r=i(121),u=i(156),b=i(21),d=i(118),j=i(3);const m=["urgency","severity","impact","category","subcategory"],O={category:[],subcategory:[],urgency:[],severity:[],impact:[],priority:[]},g=({actionConnector:e,actionParams:t,editAction:i,index:g,errors:p,messageVariables:x})=>{var E,v,h,y,A,f,S,_,I,L;const{docLinks:F,http:P,notifications:{toasts:C}}=Object(o.b)().services,R=null==e?void 0:e.isDeprecated,T=Object(s.useRef)(null!==(E=null==e?void 0:e.id)&&void 0!==E?E:""),{incident:N,comments:w}=Object(s.useMemo)((()=>{var e;return null!==(e=t.subActionParams)&&void 0!==e?e:{incident:{},comments:[]}}),[t.subActionParams]),[W,V]=Object(s.useState)(O),M=Object(s.useCallback)(((e,t)=>{const s="comments"!==e?{incident:{...N,[e]:t},comments:w}:{incident:N,[e]:t};i("subActionParams",s,g)}),[w,i,N,g]),B=Object(s.useCallback)(((e,t)=>{M(e,[{commentId:"1",comment:t}])}),[M]),k=Object(s.useCallback)((e=>{V(e.reduce(((e,t)=>({...e,[t.element]:[...null!=e[t.element]?e[t.element]:[],t]})),O))}),[]),z=Object(s.useMemo)((()=>Object(b.b)(W.category)),[W.category]),D=Object(s.useMemo)((()=>Object(b.b)(W.urgency)),[W.urgency]),G=Object(s.useMemo)((()=>Object(b.b)(W.severity)),[W.severity]),U=Object(s.useMemo)((()=>Object(b.b)(W.impact)),[W.impact]),Y=Object(s.useMemo)((()=>Object(b.b)(W.subcategory.filter((e=>e.dependent_value===N.category)))),[W.subcategory,N.category]),{isLoading:H}=Object(u.a)({http:P,toastNotifications:C,actionConnector:e,fields:m,onSuccess:k});return Object(s.useEffect)((()=>{null!=e&&T.current!==e.id&&(T.current=e.id,i("subActionParams",{incident:{correlation_id:b.a},comments:[]},g))}),[e]),Object(s.useEffect)((()=>{t.subAction||i("subAction","pushToService",g),t.subActionParams||i("subActionParams",{incident:{correlation_id:b.a},comments:[]},g)}),[t]),Object(j.jsx)(n.a.Fragment,null,Object(j.jsx)(c.EuiTitle,{size:"s"},Object(j.jsx)("h3",null,d.INCIDENT)),Object(j.jsx)(c.EuiSpacer,{size:"m"}),Object(j.jsx)(c.EuiFormRow,{fullWidth:!0,label:d.URGENCY_LABEL},Object(j.jsx)(c.EuiSelect,{fullWidth:!0,"data-test-subj":"urgencySelect",hasNoInitialSelection:!0,isLoading:H,disabled:H,options:D,value:null!==(v=N.urgency)&&void 0!==v?v:"",onChange:e=>M("urgency",e.target.value)})),Object(j.jsx)(c.EuiSpacer,{size:"m"}),Object(j.jsx)(c.EuiFlexGroup,null,Object(j.jsx)(c.EuiFlexItem,null,Object(j.jsx)(c.EuiFormRow,{fullWidth:!0,label:d.SEVERITY_LABEL},Object(j.jsx)(c.EuiSelect,{fullWidth:!0,"data-test-subj":"severitySelect",hasNoInitialSelection:!0,isLoading:H,disabled:H,options:G,value:null!==(h=N.severity)&&void 0!==h?h:"",onChange:e=>M("severity",e.target.value)}))),Object(j.jsx)(c.EuiFlexItem,null,Object(j.jsx)(c.EuiFormRow,{fullWidth:!0,label:d.IMPACT_LABEL},Object(j.jsx)(c.EuiSelect,{fullWidth:!0,"data-test-subj":"impactSelect",hasNoInitialSelection:!0,isLoading:H,disabled:H,options:U,value:null!==(y=N.impact)&&void 0!==y?y:"",onChange:e=>M("impact",e.target.value)})))),Object(j.jsx)(c.EuiSpacer,{size:"m"}),Object(j.jsx)(c.EuiFlexGroup,null,Object(j.jsx)(c.EuiFlexItem,null,Object(j.jsx)(c.EuiFormRow,{fullWidth:!0,label:d.CATEGORY_LABEL},Object(j.jsx)(c.EuiSelect,{fullWidth:!0,"data-test-subj":"categorySelect",hasNoInitialSelection:!0,isLoading:H,disabled:H,options:z,value:null!==(A=N.category)&&void 0!==A?A:void 0,onChange:e=>{i("subActionParams",{incident:{...N,category:e.target.value,subcategory:null},comments:w},g)}}))),Object(j.jsx)(c.EuiFlexItem,null,(null==Y?void 0:Y.length)>0?Object(j.jsx)(c.EuiFormRow,{fullWidth:!0,label:d.SUBCATEGORY_LABEL},Object(j.jsx)(c.EuiSelect,{fullWidth:!0,"data-test-subj":"subcategorySelect",hasNoInitialSelection:!0,isLoading:H,disabled:H,options:Y,value:null!==(f=N.subcategory)&&void 0!==f?f:"",onChange:e=>M("subcategory",e.target.value)})):null)),Object(j.jsx)(c.EuiSpacer,{size:"m"}),!R&&Object(j.jsx)(n.a.Fragment,null,Object(j.jsx)(c.EuiFlexGroup,null,Object(j.jsx)(c.EuiFlexItem,null,Object(j.jsx)(c.EuiFormRow,{fullWidth:!0,label:d.CORRELATION_ID,helpText:Object(j.jsx)(c.EuiLink,{href:F.links.alerting.serviceNowAction,target:"_blank"},Object(j.jsx)(l.FormattedMessage,{id:"xpack.triggersActionsUI.components.builtinActionTypes.serviceNowAction.correlationIDHelpLabel",defaultMessage:"Identifier for updating incidents"}))},Object(j.jsx)(r.a,{index:g,editAction:M,messageVariables:x,paramsProperty:"correlation_id",inputTargetValue:null!==(S=null==N?void 0:N.correlation_id)&&void 0!==S?S:void 0}))),Object(j.jsx)(c.EuiFlexItem,null,Object(j.jsx)(c.EuiFormRow,{fullWidth:!0,label:d.CORRELATION_DISPLAY},Object(j.jsx)(r.a,{index:g,editAction:M,messageVariables:x,paramsProperty:"correlation_display",inputTargetValue:null!==(_=null==N?void 0:N.correlation_display)&&void 0!==_?_:void 0})))),Object(j.jsx)(c.EuiSpacer,{size:"m"})),Object(j.jsx)(c.EuiFlexGroup,null,Object(j.jsx)(c.EuiFlexItem,null,Object(j.jsx)(c.EuiFormRow,{fullWidth:!0,error:p["subActionParams.incident.short_description"],isInvalid:void 0!==p["subActionParams.incident.short_description"]&&p["subActionParams.incident.short_description"].length>0&&void 0!==N.short_description,label:d.SHORT_DESCRIPTION_LABEL},Object(j.jsx)(r.a,{index:g,editAction:M,messageVariables:x,paramsProperty:"short_description",inputTargetValue:null!==(I=null==N?void 0:N.short_description)&&void 0!==I?I:void 0,errors:p["subActionParams.incident.short_description"]})))),Object(j.jsx)(c.EuiSpacer,{size:"m"}),Object(j.jsx)(a.a,{index:g,editAction:M,messageVariables:x,paramsProperty:"description",inputTargetValue:null!==(L=N.description)&&void 0!==L?L:void 0,label:d.DESCRIPTION_LABEL}),Object(j.jsx)(a.a,{index:g,editAction:B,messageVariables:x,paramsProperty:"comments",inputTargetValue:w&&w.length>0?w[0].comment:void 0,label:d.COMMENTS_LABEL}))}}}]);